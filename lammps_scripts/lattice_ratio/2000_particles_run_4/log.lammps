LAMMPS (23 Jun 2022 - Update 1)
  using 1 OpenMP thread(s) per MPI task
variable num index 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99

label startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 0

#variable lat0 equal 1                    #
variable lat1 equal 3+((300)*0.01)+(v_ind*0.01)        # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 1000*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 6                                                               
Lattice spacing in x,y,z = 6 6 6

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -9000 ${n1e1} -100 100 -100 100 units box
region box block -9000 9000 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -9000 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -9000 9000 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-9000 -100 -100) to (9000 100 100)
  2 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 3000 atoms
  using lattice units in orthogonal box = (-9000 -100 -100) to (9000 100 100)
  create_atoms CPU = 0.002 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 3000 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 2001 atoms
  using lattice units in orthogonal box = (-9000 -100 -100) to (9000 100 100)
  create_atoms CPU = 0.002 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  3000 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  3000 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  2001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  2001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
3000 atoms in group substrate
group slider1 region slider1
2001 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 2001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_0_*.dump id type diameter mass xu yu zu fx fy fz
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 11613 130 130
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 417.1 | 417.1 | 417.1 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   18000          200            200            0              0              0              0              0              0              0              1.1971759e-13  0              6            
    100000   18000          200            200            0.00229385    -1.7950951e-35  0              0.0068815499   1196854.7      0              5.7791832e+10  1.1971759e-13  0              3.3177117    
    200000   18000          200            200            0.00088501655  5.4679519e-41  0              0.0026550497   333342.6       0              1.6095921e+10  1.1971759e-13  0              3.0561683    
    300000   18000          200            200            0.00021344295 -3.5901885e-35  0              0.00064032884  33730.854      0              1.6287422e+09  1.1971759e-13  0              3.0379284    
    400000   18000          200            200            9.2395985e-05  1.7951032e-35  0              0.00027718795  7560.4207      0              3.6506566e+08  1.1971759e-13  0              3.0083579    
    500000   18000          200            200           -3.0271267e-05  5.0759102e-41  0             -9.08138e-05    1009.3443      0              48737623       1.1971759e-13  0              3.0014131    
    600000   18000          200            200            0.0047631131  -1.7950949e-35  0              0.014289339    484.64727      0              23401882       1.1971759e-13  0              2.9985754    
    700000   18000          200            200            0.0017338771   4.4877431e-35  0              0.0052016312   0.083289265    0              4021.7405      1.1971759e-13  0              2.9992716    
    800000   18000          200            200            0.0024002859   1.7950978e-35  0              0.0072008576   1.0244052      0              49464.861      1.1971759e-13  0              2.9990949    
    900000   18000          200            200            0.0026428568  -4.4877337e-36  0              0.0079285705   0.21264486     0              10267.859      1.1971759e-13  0              2.999035     
   1000000   18000          200            200            0.0027297054   1.7950975e-35  0              0.0081891161   0.034553785    0              1668.4786      1.1971759e-13  0              2.999014     
   1100000   18000          200            200            0.0027608771  -1.7950964e-35  0              0.0082826314   0.0053717728   0              259.38368      1.1971759e-13  0              2.9990066    
   1200000   18000          200            200            0.0027720417  -2.24387e-36    0              0.0083161251   0.00081977449  0              39.583976      1.1971759e-13  0              2.9990039    
   1300000   18000          200            200            0.0027760321  -7.8535485e-36  0              0.0083280964   0.00012346965  0              5.9619078      1.1971759e-13  0              2.999003     
   1400000   18000          200            200            0.0027774559   7.0120969e-37  0              0.0083323677   1.8393817e-05  0              0.88817157     1.1971759e-13  0              2.9990026    
   1500000   18000          200            200            0.002777963    8.5145732e-45  0              0.0083338891   2.7142069e-06  0              0.13105934     1.1971759e-13  0              2.9990025    
   1600000   18000          200            200            0.0027781434  -2.8048387e-37  0              0.0083344302   3.9713634e-07  0              0.019176293    1.1971759e-13  0              2.9990025    
   1700000   18000          200            200            0.0027782074   1.0292667e-44  0              0.0083346223   5.7668191e-08  0              0.0027845906   1.1971759e-13  0              2.9990024    
   1800000   18000          200            200            0.0027782301  -3.0853226e-36  0              0.0083346904   8.3167811e-09  0              0.00040158759  1.1971759e-13  0              2.9990024    
   1900000   18000          200            200            0.0027782382  -1.9633871e-36  0              0.0083347145   1.1918357e-09  0              5.754948e-05   1.1971759e-13  0              2.9990024    
   2000000   18000          200            200            0.002778241   -3.6462904e-36  0              0.008334723    1.6982624e-10  0              8.2003014e-06  1.1971759e-13  0              2.9990024    
   2100000   18000          200            200            0.002778242    1.4024194e-36  0              0.008334726    2.4073673e-11  0              1.1624315e-06  1.1971759e-13  0              2.9990024    
   2200000   18000          200            200            0.0027782423   8.4145164e-37  0              0.008334727    3.3945963e-12  0              1.6391291e-07  1.1971759e-13  0              2.9990024    
   2300000   18000          200            200            0.0027782425   2.8048389e-37  0              0.0083347274   4.7590157e-13  0              2.2979584e-08  1.1971759e-13  0              2.9990024    
   2400000   18000          200            200            0.0027782425   2.8048389e-37  0              0.0083347275   6.6501708e-14  0              3.2111295e-09  1.1971759e-13  0              2.9990024    
   2500000   18000          200            200            0.0027782425   2.8048389e-37  0              0.0083347276   9.4018142e-15  0              4.5397996e-10  1.1971759e-13  0              2.9990024    
   2600000   18000          200            200            0.0027782425   1.6829033e-36  0              0.0083347276   1.2164432e-15  0              5.8737688e-11  1.1971759e-13  0              2.9990024    
   2700000   18000          200            200            0.0027782425  -1.1219355e-36  0              0.0083347276   2.3974505e-16  0              1.1576431e-11  1.1971759e-13  0              2.9990024    
   2800000   18000          200            200            0.0027782425   1.0303807e-44  0              0.0083347276   9.0660267e-18  0              4.3776598e-13  1.1971759e-13  0              2.9990024    
   2900000   18000          200            200            0.0027782425  -2.8048387e-37  0              0.0083347276   1.047127e-17   0              5.0562014e-13  1.1971759e-13  0              2.9990024    
   3000000   18000          200            200            0.0027782425  -8.4145162e-37  0              0.0083347276   7.7245363e-18  0              3.7299021e-13  1.1971759e-13  0              2.9990024    
Loop time of 876.462 on 2 procs for 3000000 steps with 5001 atoms

Performance: 2957343.985 ns/day, 0.000 hours/ns, 3422.852 timesteps/s
99.9% CPU use with 2 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 296.76     | 300.05     | 303.35     |  19.0 | 34.23
Neigh   | 23.111     | 23.113     | 23.115     |   0.1 |  2.64
Comm    | 54.871     | 58.329     | 61.786     |  45.3 |  6.66
Output  | 0.61614    | 0.61618    | 0.61623    |   0.0 |  0.07
Modify  | 435.76     | 435.86     | 435.97     |   0.5 | 49.73
Other   |            | 58.48      |            |       |  6.67

Nlocal:         2500.5 ave        2501 max        2500 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Nghost:            2.5 ave           3 max           2 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Neighs:         1500.5 ave        1501 max        1500 min
Histogram: 1 0 0 0 0 0 0 0 0 1

Total # of neighbors = 3001
Ave neighs/atom = 0.60007998
Neighbor list builds = 172
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 1

#variable lat0 equal 1                    #
variable lat1 equal 3+((300)*0.01)+(v_ind*0.01)        # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 1000*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 6.01                                                               
Lattice spacing in x,y,z = 6.01 6.01 6.01

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -9015 ${n1e1} -100 100 -100 100 units box
region box block -9015 9015 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -9015 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -9015 9015 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-9015 -100 -100) to (9015 100 100)
  2 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 3000 atoms
  using lattice units in orthogonal box = (-9015 -100 -100) to (9015 100 100)
  create_atoms CPU = 0.002 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 3000 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 2001 atoms
  using lattice units in orthogonal box = (-9015 -100 -100) to (9015 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  3000 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  3000 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  2001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  2001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
3000 atoms in group substrate
group slider1 region slider1
2001 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 2001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_1_*.dump id type diameter mass xu yu zu fx fy fz
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 11633 130 130
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 417.8 | 417.8 | 417.8 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   18030          200            200            0              0              0              0              0              0              0              1.1971759e-13  0              6            
    100000   18030          200            200            0.0022346916   7.1684694e-35  0              0.0067040747   1154410.8      0              5.5742365e+10  1.1971759e-13  0              3.332187     
    200000   18030          200            200            0.00075331684 -3.584206e-35   0              0.0022599505   260100.82      0              1.2559338e+10  1.1971759e-13  0              3.0839073    
    300000   18030          200            200           -1.1582316e-05 -8.9605436e-36  0             -3.4746948e-05  137.84776      0              6656174.9      1.1971759e-13  0              3.043419     
    400000   18030          200            200           -2.1334226e-05 -3.5842013e-35  0             -6.4002677e-05  491.76887      0              23745759       1.1971759e-13  0              3.0050448    
    500000   18030          200            200            0.0034973404   0.0032587103   0              0.0072333109   2745.4496      0              1.3256793e+08  1.1971759e-13  0              2.9943083    
    600000   18030          200            200            0.0025677734   0.0021321901   0              0.00557113     2.4096396      0              116352.87      1.1971759e-13  0              2.9950533    
    700000   18030          200            200            0.004070639    0.0030896124   0              0.0091223046   22.130038      0              1068580.3      1.1971759e-13  0              2.9936763    
    800000   18030          200            200            0.0037150306   0.0029706769   0              0.0081744149   5.9447061      0              287048.58      1.1971759e-13  0              2.9940068    
    900000   18030          200            200            0.0037499719   0.002974465    0              0.0082754507   0.85052455     0              41068.787      1.1971759e-13  0              2.9939733    
   1000000   18030          200            200            0.0037751364   0.0029815366   0              0.0083438726   0.059601659    0              2877.9508      1.1971759e-13  0              2.9939471    
   1100000   18030          200            200            0.0037547197   0.0029759649   0              0.0082881942   0.00083492919  0              40.315743      1.1971759e-13  0              2.9939677    
   1200000   18030          200            200            0.0037639947   0.0029783877   0              0.0083135964   0.00021149731  0              10.212448      1.1971759e-13  0              2.9939584    
   1300000   18030          200            200            0.00376093     0.0029776237   0              0.0083051663   0.00016898288  0              8.1595787      1.1971759e-13  0              2.9939615    
   1400000   18030          200            200            0.0037616086   0.0029777891   0              0.0083070368   3.8454654e-05  0              1.8568376      1.1971759e-13  0              2.9939608    
   1500000   18030          200            200            0.0037615949   0.0029777877   0              0.0083069969   4.5899237e-06  0              0.22163099     1.1971759e-13  0              2.9939608    
   1600000   18030          200            200            0.0037615122   0.0029777663   0              0.0083067704   2.602632e-07   0              0.012567178    1.1971759e-13  0              2.9939609    
   1700000   18030          200            200            0.0037615659   0.0029777799   0              0.0083069179   1.019271e-09   0              4.9216951e-05  1.1971759e-13  0              2.9939608    
   1800000   18030          200            200            0.0037615434   0.0029777743   0              0.0083068558   2.3613179e-09  0              0.00011401959  1.1971759e-13  0              2.9939609    
   1900000   18030          200            200            0.0037615503   0.002977776    0              0.0083068749   1.2101243e-09  0              5.8432573e-05  1.1971759e-13  0              2.9939608    
   2000000   18030          200            200            0.003761549    0.0029777757   0              0.0083068713   2.338223e-10   0              1.1290442e-05  1.1971759e-13  0              2.9939608    
   2100000   18030          200            200            0.0037615489   0.0029777756   0              0.008306871    2.4170673e-11  0              1.1671153e-06  1.1971759e-13  0              2.9939608    
   2200000   18030          200            200            0.0037615491   0.0029777757   0              0.0083068717   1.0552642e-12  0              5.0954934e-08  1.1971759e-13  0              2.9939608    
   2300000   18030          200            200            0.003761549    0.0029777757   0              0.0083068713   2.4195861e-16  0              1.1683315e-11  1.1971759e-13  0              2.9939608    
   2400000   18030          200            200            0.003761549    0.0029777757   0              0.0083068714   2.1681931e-14  0              1.0469429e-09  1.1971759e-13  0              2.9939608    
   2500000   18030          200            200            0.003761549    0.0029777757   0              0.0083068714   8.0977066e-15  0              3.9100927e-10  1.1971759e-13  0              2.9939608    
   2600000   18030          200            200            0.003761549    0.0029777757   0              0.0083068714   1.3794376e-15  0              6.6608102e-11  1.1971759e-13  0              2.9939608    
   2700000   18030          200            200            0.003761549    0.0029777757   0              0.0083068714   1.6525591e-16  0              7.9796162e-12  1.1971759e-13  0              2.9939608    
   2800000   18030          200            200            0.003761549    0.0029777757   0              0.0083068714   1.628496e-17   0              7.8634243e-13  1.1971759e-13  0              2.9939608    
   2900000   18030          200            200            0.003761549    0.0029777757   0              0.0083068714   1.0280784e-18  0              4.9642227e-14  1.1971759e-13  0              2.9939608    
   3000000   18030          200            200            0.003761549    0.0029777757   0              0.0083068714   9.1621907e-18  0              4.424094e-13   1.1971759e-13  0              2.9939608    
Loop time of 720.437 on 2 procs for 3000000 steps with 5001 atoms

Performance: 3597813.889 ns/day, 0.000 hours/ns, 4164.136 timesteps/s
99.9% CPU use with 2 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 157.3      | 158.42     | 159.54     |   8.9 | 21.99
Neigh   | 22.187     | 22.189     | 22.19      |   0.0 |  3.08
Comm    | 51.516     | 52.639     | 53.762     |  15.5 |  7.31
Output  | 0.654      | 0.65407    | 0.65414    |   0.0 |  0.09
Modify  | 428.79     | 428.9      | 429.01     |   0.5 | 59.53
Other   |            | 57.64      |            |       |  8.00

Nlocal:         2500.5 ave        2501 max        2500 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Nghost:            2.5 ave           3 max           2 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Neighs:         1235.5 ave        1236 max        1235 min
Histogram: 1 0 0 0 0 0 0 0 0 1

Total # of neighbors = 2471
Ave neighs/atom = 0.49410118
Neighbor list builds = 166
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 2

#variable lat0 equal 1                    #
variable lat1 equal 3+((300)*0.01)+(v_ind*0.01)        # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 1000*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 6.02                                                               
Lattice spacing in x,y,z = 6.02 6.02 6.02

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -9030 ${n1e1} -100 100 -100 100 units box
region box block -9030 9030 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -9030 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -9030 9030 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-9030 -100 -100) to (9030 100 100)
  2 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 3000 atoms
  using lattice units in orthogonal box = (-9030 -100 -100) to (9030 100 100)
  create_atoms CPU = 0.002 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 3000 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 2001 atoms
  using lattice units in orthogonal box = (-9030 -100 -100) to (9030 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  3000 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  3000 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  2001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  2001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
3000 atoms in group substrate
group slider1 region slider1
2001 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 2001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_2_*.dump id type diameter mass xu yu zu fx fy fz
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 11652 130 130
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 418.4 | 418.4 | 418.4 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   18060          200            200            0              0              0              0              0              0              0              1.1971759e-13  0              6            
    100000   18060          200            200            0.0022368449  -1.0734777e-34  0              0.0067105346   1158959.9      0              5.5962026e+10  1.1971759e-13  0              3.3303974    
    200000   18060          200            200            0.00076590289 -1.7891261e-35  0              0.0022977087   267652.65      0              1.2923988e+10  1.1971759e-13  0              3.0808634    
    300000   18060          200            200            9.0458065e-06  2.3573789e-40  0              2.7137419e-05  82.905414      0              4003205.7      1.1971759e-13  0              3.0444573    
    400000   18060          200            200            2.968829e-05  -3.5782567e-34  0              8.9064871e-05  874.42711      0              42222956       1.1971759e-13  0              3.0055102    
    500000   18060          200            200            0.0023387518   0.00067152683  0              0.0063447285   2714.4928      0              1.3107314e+08  1.1971759e-13  0              2.9951746    
    600000   18060          200            200            0.0022730722   0.00096982128  0              0.0058493954   112.48735      0              5431611.4      1.1971759e-13  0              2.9953187    
    700000   18060          200            200            0.0029565797   0.0012945977   0              0.0075751415   29.496512      0              1424281        1.1971759e-13  0              2.9946625    
    800000   18060          200            200            0.003196504    0.0013583337   0              0.0082311782   6.7740725      0              327095.72      1.1971759e-13  0              2.9944317    
    900000   18060          200            200            0.0032455051   0.0013670709   0              0.0083694445   0.71287425     0              34422.146      1.1971759e-13  0              2.9943836    
   1000000   18060          200            200            0.0032374784   0.0013662451   0              0.0083461899   0.017295547    0              835.14007      1.1971759e-13  0              2.9943907    
   1100000   18060          200            200            0.003226214    0.0013649161   0              0.0083137258   0.0014958625   0              72.229849      1.1971759e-13  0              2.9944014    
   1200000   18060          200            200            0.0032208842   0.0013642679   0              0.0082983848   0.0015738117   0              75.993734      1.1971759e-13  0              2.9944065    
   1300000   18060          200            200            0.0032193663   0.0013640793   0              0.0082940196   0.00030177904  0              14.57183       1.1971759e-13  0              2.994408     
   1400000   18060          200            200            0.0032192191   0.0013640597   0              0.0082935975   2.0706934e-05  0              0.99986372     1.1971759e-13  0              2.9944082    
   1500000   18060          200            200            0.0032193394   0.0013640739   0              0.0082939442   6.4219741e-08  0              0.0031009414   1.1971759e-13  0              2.994408     
   1600000   18060          200            200            0.0032194276   0.0013640847   0              0.0082941982   2.1868608e-07  0              0.010559568    1.1971759e-13  0              2.994408     
   1700000   18060          200            200            0.0032194617   0.0013640889   0              0.0082942961   9.0084056e-08  0              0.0043498367   1.1971759e-13  0              2.9944079    
   1800000   18060          200            200            0.0032194692   0.0013640898   0              0.0082943177   1.1640947e-08  0              0.00056209968  1.1971759e-13  0              2.9944079    
   1900000   18060          200            200            0.0032194689   0.0013640898   0              0.0082943168   4.4236525e-10  0              2.1360235e-05  1.1971759e-13  0              2.9944079    
   2000000   18060          200            200            0.0032194677   0.0013640896   0              0.0082943134   6.4519268e-12  0              3.1154046e-07  1.1971759e-13  0              2.9944079    
   2100000   18060          200            200            0.003219467    0.0013640896   0              0.0082943116   1.8259818e-11  0              8.8170128e-07  1.1971759e-13  0              2.9944079    
   2200000   18060          200            200            0.0032194668   0.0013640895   0              0.008294311    4.3674788e-12  0              2.1088992e-07  1.1971759e-13  0              2.9944079    
   2300000   18060          200            200            0.0032194668   0.0013640895   0              0.0082943109   3.78662e-13    0              1.8284233e-08  1.1971759e-13  0              2.9944079    
   2400000   18060          200            200            0.0032194668   0.0013640895   0              0.0082943109   4.8982e-15     0              2.3651655e-10  1.1971759e-13  0              2.9944079    
   2500000   18060          200            200            0.0032194668   0.0013640895   0              0.008294311    1.7087129e-15  0              8.2507633e-11  1.1971759e-13  0              2.9944079    
   2600000   18060          200            200            0.0032194668   0.0013640895   0              0.008294311    1.1284789e-15  0              5.4490206e-11  1.1971759e-13  0              2.9944079    
   2700000   18060          200            200            0.0032194668   0.0013640895   0              0.008294311    1.5424991e-16  0              7.448176e-12   1.1971759e-13  0              2.9944079    
   2800000   18060          200            200            0.0032194668   0.0013640895   0              0.008294311    1.8478358e-19  0              8.9225377e-15  1.1971759e-13  0              2.9944079    
   2900000   18060          200            200            0.0032194668   0.0013640895   0              0.008294311    2.7578083e-18  0              1.3316469e-13  1.1971759e-13  0              2.9944079    
   3000000   18060          200            200            0.0032194668   0.0013640895   0              0.008294311    4.6493868e-18  0              2.2450225e-13  1.1971759e-13  0              2.9944079    
Loop time of 727.822 on 2 procs for 3000000 steps with 5001 atoms

Performance: 3561309.801 ns/day, 0.000 hours/ns, 4121.886 timesteps/s
99.9% CPU use with 2 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 162.88     | 163        | 163.12     |   0.9 | 22.40
Neigh   | 22.372     | 22.375     | 22.379     |   0.1 |  3.07
Comm    | 52.924     | 52.937     | 52.95      |   0.2 |  7.27
Output  | 0.65738    | 0.65743    | 0.65749    |   0.0 |  0.09
Modify  | 430.24     | 430.26     | 430.29     |   0.1 | 59.12
Other   |            | 58.59      |            |       |  8.05

Nlocal:         2500.5 ave        2501 max        2500 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Nghost:            2.5 ave           3 max           2 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Neighs:         1276.5 ave        1277 max        1276 min
Histogram: 1 0 0 0 0 0 0 0 0 1

Total # of neighbors = 2553
Ave neighs/atom = 0.5104979
Neighbor list builds = 166
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 3

#variable lat0 equal 1                    #
variable lat1 equal 3+((300)*0.01)+(v_ind*0.01)        # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 1000*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 6.03                                                               
Lattice spacing in x,y,z = 6.03 6.03 6.03

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -9045 ${n1e1} -100 100 -100 100 units box
region box block -9045 9045 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -9045 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -9045 9045 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-9045 -100 -100) to (9045 100 100)
  2 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 3000 atoms
  using lattice units in orthogonal box = (-9045 -100 -100) to (9045 100 100)
  create_atoms CPU = 0.002 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 3000 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 2001 atoms
  using lattice units in orthogonal box = (-9045 -100 -100) to (9045 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  3000 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  3000 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  2001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  2001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
3000 atoms in group substrate
group slider1 region slider1
2001 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 2001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_3_*.dump id type diameter mass xu yu zu fx fy fz
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 11671 130 130
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 419.1 | 419.1 | 419.1 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   18090          200            200            0              0              0              0              0              0              0              1.1971759e-13  0              6            
    100000   18090          200            200            0.0022304815  -1.0716981e-34  0              0.0066914444   1156929.2      0              5.5863971e+10  1.1971759e-13  0              3.3310796    
    200000   18090          200            200            0.00075861068  3.5723625e-35  0              0.002275832    264368.16      0              1.2765392e+10  1.1971759e-13  0              3.0820167    
    300000   18090          200            200           -2.153366e-07   1.4126914e-40  0             -6.460098e-07   0.025903755    0              1250.7996      1.1971759e-13  0              3.0438962    
    400000   18090          200            200            4.6770539e-06  1.2056621e-34  0              1.4031162e-05  23.254027      0              1122853.8      1.1971759e-13  0              3.0055063    
    500000   18090          200            200            0.00019359515 -0.001179882    0              0.0017606674   54.845508      0              2648293.3      1.1971759e-13  0              2.9972244    
    600000   18090          200            200           -0.00066804326 -0.013422759    0              0.011418629    5.5629164      0              268613.33      1.1971759e-13  0              2.9930694    
    700000   18090          200            200           -0.00073181614 -0.010202059    0              0.0080066101   47.43272       0              2290356.3      1.1971759e-13  0              2.9941846    
    800000   18090          200            200           -0.00079912593 -0.010279153    0              0.0078817751   0.012388947    0              598.21793      1.1971759e-13  0              2.994222     
    900000   18090          200            200           -0.00074465959 -0.01045764     0              0.0082236611   0.78621104     0              37963.318      1.1971759e-13  0              2.9941       
   1000000   18090          200            200           -0.00072275644 -0.010488075    0              0.0083198059   0.053704039    0              2593.1758      1.1971759e-13  0              2.9940671    
   1100000   18090          200            200           -0.00072783545 -0.010480575    0              0.0082970686   0.0038572593   0              186.25325      1.1971759e-13  0              2.9940754    
   1200000   18090          200            200           -0.00073202915 -0.010474652    0              0.0082785649   0.0021633416   0              104.46002      1.1971759e-13  0              2.9940818    
   1300000   18090          200            200           -0.00073238687 -0.010474203    0              0.0082770423   1.0054796e-05  0              0.48551013     1.1971759e-13  0              2.9940823    
   1400000   18090          200            200           -0.00073191295 -0.010474891    0              0.0082791524   2.9916776e-05  0              1.4445741      1.1971759e-13  0              2.9940815    
   1500000   18090          200            200           -0.00073174736 -0.010475122    0              0.00827988     3.1727265e-06  0              0.15319961     1.1971759e-13  0              2.9940813    
   1600000   18090          200            200           -0.00073177011 -0.010475087    0              0.0082797764   8.6667872e-08  0              0.0041848813   1.1971759e-13  0              2.9940813    
   1700000   18090          200            200           -0.00073179801 -0.010475047    0              0.0082796529   9.7628783e-08  0              0.0047141445   1.1971759e-13  0              2.9940814    
   1800000   18090          200            200           -0.00073180186 -0.010475042    0              0.0082796363   1.4288019e-09  0              6.8991729e-05  1.1971759e-13  0              2.9940814    
   1900000   18090          200            200           -0.00073179907 -0.010475046    0              0.0082796487   1.0665054e-09  0              5.1497728e-05  1.1971759e-13  0              2.9940814    
   2000000   18090          200            200           -0.00073179785 -0.010475048    0              0.0082796541   1.734984e-10   0              8.3776166e-06  1.1971759e-13  0              2.9940814    
   2100000   18090          200            200           -0.00073179793 -0.010475047    0              0.0082796537   1.2755439e-12  0              6.159145e-08   1.1971759e-13  0              2.9940814    
   2200000   18090          200            200           -0.00073179811 -0.010475047    0              0.0082796529   4.2049012e-12  0              2.0303963e-07  1.1971759e-13  0              2.9940814    
   2300000   18090          200            200           -0.00073179815 -0.010475047    0              0.0082796528   1.2628711e-13  0              6.0979525e-09  1.1971759e-13  0              2.9940814    
   2400000   18090          200            200           -0.00073179813 -0.010475047    0              0.0082796528   3.5132129e-14  0              1.6964048e-09  1.1971759e-13  0              2.9940814    
   2500000   18090          200            200           -0.00073179812 -0.010475047    0              0.0082796529   8.9192026e-15  0              4.3067638e-10  1.1971759e-13  0              2.9940814    
   2600000   18090          200            200           -0.00073179812 -0.010475047    0              0.0082796529   1.2181026e-19  0              5.8817816e-15  1.1971759e-13  0              2.9940814    
   2700000   18090          200            200           -0.00073179812 -0.010475047    0              0.0082796529   1.2090688e-16  0              5.8381604e-12  1.1971759e-13  0              2.9940814    
   2800000   18090          200            200           -0.00073179812 -0.010475047    0              0.0082796529   2.4622869e-17  0              1.1889502e-12  1.1971759e-13  0              2.9940814    
   2900000   18090          200            200           -0.00073179812 -0.010475047    0              0.0082796529   6.7250589e-18  0              3.2472903e-13  1.1971759e-13  0              2.9940814    
   3000000   18090          200            200           -0.00073179813 -0.010475047    0              0.0082796529   1.4187824e-17  0              6.8507923e-13  1.1971759e-13  0              2.9940814    
Loop time of 727.965 on 2 procs for 3000000 steps with 5001 atoms

Performance: 3560609.484 ns/day, 0.000 hours/ns, 4121.076 timesteps/s
99.9% CPU use with 2 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 162.91     | 163.03     | 163.15     |   0.9 | 22.40
Neigh   | 22.497     | 22.499     | 22.501     |   0.0 |  3.09
Comm    | 53.771     | 53.948     | 54.125     |   2.4 |  7.41
Output  | 0.64716    | 0.6472     | 0.64724    |   0.0 |  0.09
Modify  | 430.01     | 430.05     | 430.09     |   0.2 | 59.08
Other   |            | 57.79      |            |       |  7.94

Nlocal:         2500.5 ave        2501 max        2500 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Nghost:            2.5 ave           3 max           2 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Neighs:         1262.5 ave        1263 max        1262 min
Histogram: 1 0 0 0 0 0 0 0 0 1

Total # of neighbors = 2525
Ave neighs/atom = 0.50489902
Neighbor list builds = 166
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 4

#variable lat0 equal 1                    #
variable lat1 equal 3+((300)*0.01)+(v_ind*0.01)        # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 1000*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 6.04                                                               
Lattice spacing in x,y,z = 6.04 6.04 6.04

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -9060 ${n1e1} -100 100 -100 100 units box
region box block -9060 9060 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -9060 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -9060 9060 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-9060 -100 -100) to (9060 100 100)
  2 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 3000 atoms
  using lattice units in orthogonal box = (-9060 -100 -100) to (9060 100 100)
  create_atoms CPU = 0.002 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 3000 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 2001 atoms
  using lattice units in orthogonal box = (-9060 -100 -100) to (9060 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  3000 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  3000 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  2001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  2001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
3000 atoms in group substrate
group slider1 region slider1
2001 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 2001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_4_*.dump id type diameter mass xu yu zu fx fy fz
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 11691 130 130
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 419.8 | 419.8 | 419.8 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   18120          200            200            0              0              0              0              0              0              0              1.1971759e-13  0              6            
    100000   18120          200            200            0.0022266645   8.470242e-35   0              0.0066799935   1156800.6      0              5.5857761e+10  1.1971759e-13  0              3.3312481    
    200000   18120          200            200            0.00075683829  1.3374068e-35  0              0.0022705149   264069.52      0              1.2750972e+10  1.1971759e-13  0              3.0823095    
    300000   18120          200            200           -7.7879723e-07 -3.5664135e-35  0             -2.3363917e-06  0.53609061     0              25885.897      1.1971759e-13  0              3.0440187    
    400000   18120          200            200            5.1436348e-06  3.5664272e-35  0              1.5430904e-05  28.129953      0              1358294.8      1.1971759e-13  0              3.0056224    
    500000   18120          200            200            0.0005945942   0.0001003777   0              0.0016834049   1.4447085      0              69759.802      1.1971759e-13  0              2.9973762    
    600000   18120          200            200            0.0040300249   0.00092938925  0              0.011160685    50.673422      0              2446838.2      1.1971759e-13  0              2.9932421    
    700000   18120          200            200            0.0030298048   0.00070481583  0              0.0083845985   50.298552      0              2428737.1      1.1971759e-13  0              2.9941711    
    800000   18120          200            200            0.002862441    0.00071744839  0              0.0078698745   0.014650329    0              707.41198      1.1971759e-13  0              2.9943462    
    900000   18120          200            200            0.0029971674   0.00072684309  0              0.008264659    0.91549516     0              44205.985      1.1971759e-13  0              2.9942048    
   1000000   18120          200            200            0.0030160119   0.0007279863   0              0.0083200494   0.00025403239  0              12.266315      1.1971759e-13  0              2.9941863    
   1100000   18120          200            200            0.0029971597   0.0007267738   0              0.0082647053   0.016425484    0              793.12786      1.1971759e-13  0              2.9942059    
   1200000   18120          200            200            0.0029952579   0.00072665944  0              0.0082591144   3.9551812e-05  0              1.9098155      1.1971759e-13  0              2.9942077    
   1300000   18120          200            200            0.0029978528   0.00072682774  0              0.0082667306   0.00029013323  0              14.009495      1.1971759e-13  0              2.994205     
   1400000   18120          200            200            0.0029980249   0.00072683768  0              0.0082672371   1.9515221e-06  0              0.094232018    1.1971759e-13  0              2.9942049    
   1500000   18120          200            200            0.0029976703   0.00072681475  0              0.0082661963   5.0425179e-06  0              0.24348514     1.1971759e-13  0              2.9942052    
   1600000   18120          200            200            0.0029976587   0.00072681416  0              0.0082661619   6.7868376e-08  0              0.003277121    1.1971759e-13  0              2.9942053    
   1700000   18120          200            200            0.0029977067   0.00072681726  0              0.0082663029   8.6184676e-08  0              0.0041615496   1.1971759e-13  0              2.9942052    
   1800000   18120          200            200            0.0029977067   0.00072681724  0              0.008266303    1.9833034e-09  0              9.5766623e-05  1.1971759e-13  0              2.9942052    
   1900000   18120          200            200            0.0029977003   0.00072681682  0              0.008266284    1.4471144e-09  0              6.9875977e-05  1.1971759e-13  0              2.9942052    
   2000000   18120          200            200            0.0029977005   0.00072681684  0              0.0082662846   5.2129221e-11  0              2.5171335e-06  1.1971759e-13  0              2.9942052    
   2100000   18120          200            200            0.0029977014   0.0007268169   0              0.0082662872   2.3834387e-11  0              1.1508773e-06  1.1971759e-13  0              2.9942052    
   2200000   18120          200            200            0.0029977013   0.00072681689  0              0.008266287    1.273913e-12   0              6.15127e-08    1.1971759e-13  0              2.9942052    
   2300000   18120          200            200            0.0029977012   0.00072681688  0              0.0082662867   3.8497487e-13  0              1.8589059e-08  1.1971759e-13  0              2.9942052    
   2400000   18120          200            200            0.0029977012   0.00072681688  0              0.0082662867   2.9525874e-14  0              1.4256988e-09  1.1971759e-13  0              2.9942052    
   2500000   18120          200            200            0.0029977012   0.00072681689  0              0.0082662867   6.1523355e-15  0              2.9707426e-10  1.1971759e-13  0              2.9942052    
   2600000   18120          200            200            0.0029977012   0.00072681689  0              0.0082662867   5.8342729e-16  0              2.8171616e-11  1.1971759e-13  0              2.9942052    
   2700000   18120          200            200            0.0029977012   0.00072681689  0              0.0082662867   1.3908244e-16  0              6.7157933e-12  1.1971759e-13  0              2.9942052    
   2800000   18120          200            200            0.0029977012   0.00072681689  0              0.0082662867   2.7467014e-19  0              1.3262838e-14  1.1971759e-13  0              2.9942052    
   2900000   18120          200            200            0.0029977012   0.00072681689  0              0.0082662867   1.1066172e-18  0              5.3434582e-14  1.1971759e-13  0              2.9942052    
   3000000   18120          200            200            0.0029977012   0.00072681688  0              0.0082662867   7.4947075e-19  0              3.618926e-14   1.1971759e-13  0              2.9942052    
Loop time of 732.446 on 2 procs for 3000000 steps with 5001 atoms

Performance: 3538828.178 ns/day, 0.000 hours/ns, 4095.866 timesteps/s
99.9% CPU use with 2 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 161.59     | 164.33     | 167.08     |  21.4 | 22.44
Neigh   | 22.359     | 22.361     | 22.363     |   0.0 |  3.05
Comm    | 51.908     | 54.616     | 57.324     |  36.6 |  7.46
Output  | 0.65134    | 0.6514     | 0.65145    |   0.0 |  0.09
Modify  | 432.01     | 432.38     | 432.75     |   1.8 | 59.03
Other   |            | 58.1       |            |       |  7.93

Nlocal:         2500.5 ave        2501 max        2500 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Nghost:            2.5 ave           3 max           2 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Neighs:         1253.5 ave        1254 max        1253 min
Histogram: 1 0 0 0 0 0 0 0 0 1

Total # of neighbors = 2507
Ave neighs/atom = 0.50129974
Neighbor list builds = 166
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 5

#variable lat0 equal 1                    #
variable lat1 equal 3+((300)*0.01)+(v_ind*0.01)        # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 1000*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 6.05                                                               
Lattice spacing in x,y,z = 6.05 6.05 6.05

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -9075 ${n1e1} -100 100 -100 100 units box
region box block -9075 9075 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -9075 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -9075 9075 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-9075 -100 -100) to (9075 100 100)
  2 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 3000 atoms
  using lattice units in orthogonal box = (-9075 -100 -100) to (9075 100 100)
  create_atoms CPU = 0.002 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 3000 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 2001 atoms
  using lattice units in orthogonal box = (-9075 -100 -100) to (9075 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  3000 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  3000 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  2001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  2001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
3000 atoms in group substrate
group slider1 region slider1
2001 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 2001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_5_*.dump id type diameter mass xu yu zu fx fy fz
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 11710 130 130
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 420.4 | 420.4 | 420.4 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   18150          200            200            0              0              0              0              0              0              0              1.1971759e-13  0              6            
    100000   18150          200            200            0.0022246768   3.5605362e-35  0              0.0066740304   1158120.5      0              5.5921495e+10  1.1971759e-13  0              3.3307278    
    200000   18150          200            200            0.00075956861 -3.5604972e-35  0              0.0022787058   266256.43      0              1.285657e+10   1.1971759e-13  0              3.0814276    
    300000   18150          200            200            5.2184613e-06  7.121105e-35   0              1.5655384e-05  28.317523      0              1367351.9      1.1971759e-13  0              3.0442979    
    400000   18150          200            200            2.0111092e-05  1.4242111e-34  0              6.0333277e-05  412.9275       0              19938791       1.1971759e-13  0              3.0056206    
    500000   18150          200            200            0.0011295805   0.00011700728  0              0.0032717341   1463.1984      0              70652613       1.1971759e-13  0              2.9964926    
    600000   18150          200            200            0.0022207858   0.00047506348  0              0.0061872939   195.66591      0              9448006.4      1.1971759e-13  0              2.9950794    
    700000   18150          200            200            0.0029682938   0.00058404451  0              0.0083208369   50.913763      0              2458443.4      1.1971759e-13  0              2.9943091    
    800000   18150          200            200            0.0030348433   0.00057713713  0              0.0085273927   3.6771762      0              177557.68      1.1971759e-13  0              2.9942435    
    900000   18150          200            200            0.0029914776   0.00057505092  0              0.0083993817   0.026150655    0              1262.7216      1.1971759e-13  0              2.9942891    
   1000000   18150          200            200            0.0029583583   0.000573444    0              0.0083016308   0.026132008    0              1261.8211      1.1971759e-13  0              2.9943231    
   1100000   18150          200            200            0.0029448794   0.00057278368  0              0.0082618544   0.013548588    0              654.21282      1.1971759e-13  0              2.9943368    
   1200000   18150          200            200            0.0029414237   0.00057261586  0              0.0082516553   0.002164989    0              104.53957      1.1971759e-13  0              2.9943402    
   1300000   18150          200            200            0.0029412081   0.00057260685  0              0.0082510175   0.00013543483  0              6.5396634      1.1971759e-13  0              2.9943404    
   1400000   18150          200            200            0.0029415463   0.00057262418  0              0.0082520149   3.2281306e-07  0              0.015587487    1.1971759e-13  0              2.9943401    
   1500000   18150          200            200            0.0029417737   0.00057263555  0              0.0082526856   1.5172528e-06  0              0.073262709    1.1971759e-13  0              2.9943398    
   1600000   18150          200            200            0.0029418616   0.00057263989  0              0.0082529449   6.3806407e-07  0              0.03080983     1.1971759e-13  0              2.9943397    
   1700000   18150          200            200            0.0029418826   0.0005726409   0              0.0082530068   9.1698585e-08  0              0.0044277965   1.1971759e-13  0              2.9943397    
   1800000   18150          200            200            0.002941883    0.00057264092  0              0.0082530082   4.9245146e-09  0              0.00023778719  1.1971759e-13  0              2.9943397    
   1900000   18150          200            200            0.0029418805   0.00057264079  0              0.0082530007   1.8807071e-13  0              9.0812613e-09  1.1971759e-13  0              2.9943397    
   2000000   18150          200            200            0.0029418789   0.00057264071  0              0.0082529961   8.4312479e-11  0              4.0711478e-06  1.1971759e-13  0              2.9943397    
   2100000   18150          200            200            0.0029418784   0.00057264068  0              0.0082529944   2.9632431e-11  0              1.430844e-06   1.1971759e-13  0              2.9943397    
   2200000   18150          200            200            0.0029418782   0.00057264067  0              0.0082529941   3.8326115e-12  0              1.8506309e-07  1.1971759e-13  0              2.9943397    
   2300000   18150          200            200            0.0029418782   0.00057264068  0              0.0082529941   1.734031e-13   0              8.3730152e-09  1.1971759e-13  0              2.9943397    
   2400000   18150          200            200            0.0029418783   0.00057264068  0              0.0082529941   3.7875922e-16  0              1.8288927e-11  1.1971759e-13  0              2.9943397    
   2500000   18150          200            200            0.0029418783   0.00057264068  0              0.0082529942   4.6456591e-15  0              2.2432225e-10  1.1971759e-13  0              2.9943397    
   2600000   18150          200            200            0.0029418783   0.00057264068  0              0.0082529942   1.3693061e-15  0              6.6118889e-11  1.1971759e-13  0              2.9943397    
   2700000   18150          200            200            0.0029418783   0.00057264068  0              0.0082529942   1.7725438e-16  0              8.5589797e-12  1.1971759e-13  0              2.9943397    
   2800000   18150          200            200            0.0029418783   0.00057264068  0              0.0082529942   1.8337453e-17  0              8.8544996e-13  1.1971759e-13  0              2.9943397    
   2900000   18150          200            200            0.0029418783   0.00057264068  0              0.0082529942   1.1912262e-18  0              5.7520048e-14  1.1971759e-13  0              2.9943397    
   3000000   18150          200            200            0.0029418783   0.00057264068  0              0.0082529942   5.6523845e-18  0              2.7293342e-13  1.1971759e-13  0              2.9943397    
Loop time of 733.817 on 2 procs for 3000000 steps with 5001 atoms

Performance: 3532214.315 ns/day, 0.000 hours/ns, 4088.211 timesteps/s
99.9% CPU use with 2 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 165.67     | 168.61     | 171.55     |  22.6 | 22.98
Neigh   | 22.462     | 22.464     | 22.467     |   0.1 |  3.06
Comm    | 51.741     | 54.809     | 57.878     |  41.4 |  7.47
Output  | 0.65009    | 0.65014    | 0.65018    |   0.0 |  0.09
Modify  | 428.59     | 428.72     | 428.85     |   0.6 | 58.42
Other   |            | 58.56      |            |       |  7.98

Nlocal:         2500.5 ave        2501 max        2500 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Nghost:            2.5 ave           3 max           2 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Neighs:         1263.5 ave        1264 max        1263 min
Histogram: 1 0 0 0 0 0 0 0 0 1

Total # of neighbors = 2527
Ave neighs/atom = 0.50529894
Neighbor list builds = 166
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 6

#variable lat0 equal 1                    #
variable lat1 equal 3+((300)*0.01)+(v_ind*0.01)        # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 1000*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 6.06                                                               
Lattice spacing in x,y,z = 6.06 6.06 6.06

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -9090 ${n1e1} -100 100 -100 100 units box
region box block -9090 9090 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -9090 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -9090 9090 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-9090 -100 -100) to (9090 100 100)
  2 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 3000 atoms
  using lattice units in orthogonal box = (-9090 -100 -100) to (9090 100 100)
  create_atoms CPU = 0.002 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 3000 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 2001 atoms
  using lattice units in orthogonal box = (-9090 -100 -100) to (9090 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  3000 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  3000 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  2001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  2001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
3000 atoms in group substrate
group slider1 region slider1
2001 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 2001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_6_*.dump id type diameter mass xu yu zu fx fy fz
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 11730 130 130
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 421.1 | 421.1 | 421.1 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   18180          200            200            0              0              0              0              0              0              0              1.1971759e-13  0              6            
    100000   18180          200            200            0.0022188916  -1.7773165e-35  0              0.0066566747   1156496.9      0              5.5843097e+10  1.1971759e-13  0              3.3312662    
    200000   18180          200            200            0.00075324795 -3.5546379e-35  0              0.0022597438   263478.82      0              1.2722449e+10  1.1971759e-13  0              3.0824439    
    300000   18180          200            200           -3.1165928e-06  4.7985463e-40  0             -9.3497785e-06  9.7218008      0              469430.97      1.1971759e-13  0              3.0438501    
    400000   18180          200            200           -2.1926469e-06  3.5546535e-34  0             -6.5779408e-06  4.8550577      0              234433.36      1.1971759e-13  0              3.0055228    
    500000   18180          200            200            0.00071360863  9.8194195e-05  0              0.0020426317   422.5466       0              20403263       1.1971759e-13  0              2.9970184    
    600000   18180          200            200            0.0037000118   0.00058298407  0              0.010517051    182.82696      0              8828059.7      1.1971759e-13  0              2.9933687    
    700000   18180          200            200            0.0025947859   0.00042974873  0              0.007354609    15.808692      0              763345.14      1.1971759e-13  0              2.9944245    
    800000   18180          200            200            0.0027847516   0.00045985476  0              0.0078944001   1.7679096      0              85366.029      1.1971759e-13  0              2.9942199    
    900000   18180          200            200            0.0029039763   0.00047153619  0              0.0082403926   0.91274626     0              44073.25       1.1971759e-13  0              2.9940979    
   1000000   18180          200            200            0.0029192851   0.00047222993  0              0.0082856253   0.028639093    0              1382.8793      1.1971759e-13  0              2.994083     
   1100000   18180          200            200            0.0029091636   0.00047173826  0              0.0082557526   0.0043423512   0              209.6766       1.1971759e-13  0              2.9940936    
   1200000   18180          200            200            0.002903393    0.00047146017  0              0.0082387187   0.0022206571   0              107.22758      1.1971759e-13  0              2.9940995    
   1300000   18180          200            200            0.0029026167   0.00047142422  0              0.0082364259   7.3920394e-05  0              3.5693513      1.1971759e-13  0              2.9941003    
   1400000   18180          200            200            0.0029031048   0.00047144855  0              0.0082378658   9.9351441e-06  0              0.47973255     1.1971759e-13  0              2.9940998    
   1500000   18180          200            200            0.0029033901   0.00047146239  0              0.0082387078   5.4005619e-06  0              0.2607738      1.1971759e-13  0              2.9940995    
   1600000   18180          200            200            0.0029034301   0.00047146425  0              0.008238826    1.9094795e-07  0              0.0092201932   1.1971759e-13  0              2.9940994    
   1700000   18180          200            200            0.0029034066   0.00047146307  0              0.0082387566   2.2694179e-08  0              0.0010958207   1.1971759e-13  0              2.9940995    
   1800000   18180          200            200            0.0029033925   0.00047146239  0              0.008238715    1.3125977e-08  0              0.00063380647  1.1971759e-13  0              2.9940995    
   1900000   18180          200            200            0.0029033904   0.00047146229  0              0.0082387089   4.9202361e-10  0              2.3758059e-05  1.1971759e-13  0              2.9940995    
   2000000   18180          200            200            0.0029033915   0.00047146235  0              0.0082387122   5.1697778e-11  0              2.4963007e-06  1.1971759e-13  0              2.9940995    
   2100000   18180          200            200            0.0029033922   0.00047146239  0              0.0082387143   3.1882583e-11  0              1.5394958e-06  1.1971759e-13  0              2.9940995    
   2200000   18180          200            200            0.0029033923   0.00047146239  0              0.0082387146   1.2668521e-12  0              6.1171756e-08  1.1971759e-13  0              2.9940995    
   2300000   18180          200            200            0.0029033923   0.00047146239  0              0.0082387144   1.1710171e-13  0              5.6544223e-09  1.1971759e-13  0              2.9940995    
   2400000   18180          200            200            0.0029033922   0.00047146239  0              0.0082387143   7.7290791e-14  0              3.7320957e-09  1.1971759e-13  0              2.9940995    
   2500000   18180          200            200            0.0029033922   0.00047146239  0              0.0082387143   3.195337e-15   0              1.5429139e-10  1.1971759e-13  0              2.9940995    
   2600000   18180          200            200            0.0029033922   0.00047146239  0              0.0082387143   2.5057967e-16  0              1.2099595e-11  1.1971759e-13  0              2.9940995    
   2700000   18180          200            200            0.0029033922   0.00047146239  0              0.0082387143   1.6292156e-16  0              7.866899e-12   1.1971759e-13  0              2.9940995    
   2800000   18180          200            200            0.0029033922   0.00047146239  0              0.0082387143   2.3321253e-17  0              1.1260999e-12  1.1971759e-13  0              2.9940995    
   2900000   18180          200            200            0.0029033922   0.00047146239  0              0.0082387143   9.0226673e-18  0              4.3567231e-13  1.1971759e-13  0              2.9940995    
   3000000   18180          200            200            0.0029033922   0.00047146239  0              0.0082387143   1.1547745e-17  0              5.575993e-13   1.1971759e-13  0              2.9940995    
Loop time of 734.312 on 2 procs for 3000000 steps with 5001 atoms

Performance: 3529835.811 ns/day, 0.000 hours/ns, 4085.458 timesteps/s
99.9% CPU use with 2 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 163.97     | 167.72     | 171.47     |  29.0 | 22.84
Neigh   | 22.56      | 22.563     | 22.566     |   0.1 |  3.07
Comm    | 51.281     | 55.165     | 59.049     |  52.3 |  7.51
Output  | 0.65824    | 0.6583     | 0.65836    |   0.0 |  0.09
Modify  | 429.35     | 429.39     | 429.43     |   0.2 | 58.48
Other   |            | 58.82      |            |       |  8.01

Nlocal:         2500.5 ave        2501 max        2500 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Nghost:            2.5 ave           3 max           2 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Neighs:         1265.5 ave        1266 max        1265 min
Histogram: 1 0 0 0 0 0 0 0 0 1

Total # of neighbors = 2531
Ave neighs/atom = 0.50609878
Neighbor list builds = 166
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 7

#variable lat0 equal 1                    #
variable lat1 equal 3+((300)*0.01)+(v_ind*0.01)        # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 1000*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 6.07                                                               
Lattice spacing in x,y,z = 6.07 6.07 6.07

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -9105 ${n1e1} -100 100 -100 100 units box
region box block -9105 9105 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -9105 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -9105 9105 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-9105 -100 -100) to (9105 100 100)
  2 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 3000 atoms
  using lattice units in orthogonal box = (-9105 -100 -100) to (9105 100 100)
  create_atoms CPU = 0.002 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 3000 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 2001 atoms
  using lattice units in orthogonal box = (-9105 -100 -100) to (9105 100 100)
  create_atoms CPU = 0.002 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  3000 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  3000 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  2001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  2001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
3000 atoms in group substrate
group slider1 region slider1
2001 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 2001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_7_*.dump id type diameter mass xu yu zu fx fy fz
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 11749 130 130
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 421.8 | 421.8 | 421.8 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   18210          200            200            0              0              0              0              0              0              0              1.1971759e-13  0              6            
    100000   18210          200            200            0.0022160732   4.4359964e-36  0              0.0066482197   1157124.2      0              5.5873387e+10  1.1971759e-13  0              3.3311204    
    200000   18210          200            200            0.00075405406  3.5488044e-35  0              0.0022621622   264595.87      0              1.2776387e+10  1.1971759e-13  0              3.0820993    
    300000   18210          200            200            6.5051112e-07 -1.7743865e-35  0              1.9515334e-06  0.51555972     0              24894.534      1.1971759e-13  0              3.0440905    
    400000   18210          200            200            8.6796935e-06  1.1906608e-41  0              2.603908e-05   79.65045       0              3846035.2      1.1971759e-13  0              3.0056434    
    500000   18210          200            200            0.00049421915 -0.00029481094  0              0.0017774684   111.97057      0              5406658.3      1.1971759e-13  0              2.9973428    
    600000   18210          200            200            0.003439816    0.00030864895  0              0.010010799    252.94572      0              12213844       1.1971759e-13  0              2.9936185    
    700000   18210          200            200            0.0030932284   4.0299785e-05  0              0.0092393855   9.2508246      0              446689.21      1.1971759e-13  0              2.9938854    
    800000   18210          200            200            0.0027207963  -6.6109007e-05  0              0.008228498    6.8396045      0              330260.02      1.1971759e-13  0              2.9942291    
    900000   18210          200            200            0.0026770881  -6.5092369e-05  0              0.0080963566   0.19679225     0              9502.3936      1.1971759e-13  0              2.9942733    
   1000000   18210          200            200            0.002706205   -6.2321554e-05  0              0.0081809365   0.039834734    0              1923.4768      1.1971759e-13  0              2.9942429    
   1100000   18210          200            200            0.0027221728  -6.1151786e-05  0              0.0082276702   0.016367164    0              790.31178      1.1971759e-13  0              2.9942266    
   1200000   18210          200            200            0.0027237284  -6.1048811e-05  0              0.008232234    0.00028311407  0              13.670565      1.1971759e-13  0              2.9942251    
   1300000   18210          200            200            0.0027221119  -6.1165753e-05  0              0.0082275014   0.00013128794  0              6.3394247      1.1971759e-13  0              2.9942268    
   1400000   18210          200            200            0.002721351   -6.1219776e-05  0              0.0082252727   3.8139119e-05  0              1.8416016      1.1971759e-13  0              2.9942276    
   1500000   18210          200            200            0.0027213085  -6.1222431e-05  0              0.0082251478   3.2312504e-07  0              0.015602552    1.1971759e-13  0              2.9942276    
   1600000   18210          200            200            0.0027213963  -6.1216062e-05  0              0.0082254049   4.0495111e-07  0              0.01955364     1.1971759e-13  0              2.9942275    
   1700000   18210          200            200            0.002721432   -6.121353e-05   0              0.0082255095   8.6310625e-08  0              0.0041676312   1.1971759e-13  0              2.9942275    
   1800000   18210          200            200            0.0027214324  -6.1213522e-05  0              0.0082255106   2.1791314e-10  0              1.0522246e-05  1.1971759e-13  0              2.9942275    
   1900000   18210          200            200            0.0027214277  -6.1213859e-05  0              0.0082254969   1.187899e-09   0              5.735939e-05   1.1971759e-13  0              2.9942275    
   2000000   18210          200            200            0.002721426   -6.1213976e-05  0              0.0082254921   1.8923494e-10  0              9.1374782e-06  1.1971759e-13  0              2.9942275    
   2100000   18210          200            200            0.0027214261  -6.121397e-05   0              0.0082254923   3.921819e-15   0              1.893706e-10   1.1971759e-13  0              2.9942275    
   2200000   18210          200            200            0.0027214264  -6.1213952e-05  0              0.008225493    3.3439003e-12  0              1.6146498e-07  1.1971759e-13  0              2.9942275    
   2300000   18210          200            200            0.0027214264  -6.1213947e-05  0              0.0082254932   4.0074999e-13  0              1.9350783e-08  1.1971759e-13  0              2.9942275    
   2400000   18210          200            200            0.0027214264  -6.1213948e-05  0              0.0082254932   8.4161926e-16  0              4.0638782e-11  1.1971759e-13  0              2.9942275    
   2500000   18210          200            200            0.0027214264  -6.1213949e-05  0              0.0082254932   9.0115468e-15  0              4.3513534e-10  1.1971759e-13  0              2.9942275    
   2600000   18210          200            200            0.0027214264  -6.1213949e-05  0              0.0082254932   8.43026e-16    0              4.0706708e-11  1.1971759e-13  0              2.9942275    
   2700000   18210          200            200            0.0027214264  -6.1213949e-05  0              0.0082254932   5.0451698e-19  0              2.4361319e-14  1.1971759e-13  0              2.9942275    
   2800000   18210          200            200            0.0027214264  -6.1213949e-05  0              0.0082254932   6.6785305e-18  0              3.2248234e-13  1.1971759e-13  0              2.9942275    
   2900000   18210          200            200            0.0027214264  -6.1213949e-05  0              0.0082254932   4.2157493e-18  0              2.0356345e-13  1.1971759e-13  0              2.9942275    
   3000000   18210          200            200            0.0027214264  -6.1213949e-05  0              0.0082254932   7.0948318e-18  0              3.4258404e-13  1.1971759e-13  0              2.9942275    
Loop time of 735.803 on 2 procs for 3000000 steps with 5001 atoms

Performance: 3522682.116 ns/day, 0.000 hours/ns, 4077.178 timesteps/s
99.9% CPU use with 2 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 168.33     | 169.43     | 170.54     |   8.5 | 23.03
Neigh   | 22.624     | 22.626     | 22.629     |   0.1 |  3.08
Comm    | 52.515     | 53.601     | 54.687     |  14.8 |  7.28
Output  | 0.64501    | 0.64506    | 0.6451     |   0.0 |  0.09
Modify  | 429.49     | 430.8      | 432.1      |   6.3 | 58.55
Other   |            | 58.7       |            |       |  7.98

Nlocal:         2500.5 ave        2501 max        2500 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Nghost:            2.5 ave           3 max           2 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Neighs:         1257.5 ave        1258 max        1257 min
Histogram: 1 0 0 0 0 0 0 0 0 1

Total # of neighbors = 2515
Ave neighs/atom = 0.50289942
Neighbor list builds = 166
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 8

#variable lat0 equal 1                    #
variable lat1 equal 3+((300)*0.01)+(v_ind*0.01)        # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 1000*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 6.08                                                               
Lattice spacing in x,y,z = 6.08 6.08 6.08

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -9120 ${n1e1} -100 100 -100 100 units box
region box block -9120 9120 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -9120 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -9120 9120 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-9120 -100 -100) to (9120 100 100)
  2 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 3000 atoms
  using lattice units in orthogonal box = (-9120 -100 -100) to (9120 100 100)
  create_atoms CPU = 0.002 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 3000 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 2001 atoms
  using lattice units in orthogonal box = (-9120 -100 -100) to (9120 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  3000 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  3000 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  2001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  2001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
3000 atoms in group substrate
group slider1 region slider1
2001 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 2001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_8_*.dump id type diameter mass xu yu zu fx fy fz
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 11768 130 130
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 422.5 | 422.5 | 422.5 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   18240          200            200            0              0              0              0              0              0              0              1.1971759e-13  0              6            
    100000   18240          200            200            0.0022134126   1.2447272e-41  0              0.0066402379   1157894        0              5.5910556e+10  1.1971759e-13  0              3.3308226    
    200000   18240          200            200            0.00075517452  7.6624709e-42  0              0.0022655236   265899.25      0              1.2839323e+10  1.1971759e-13  0              3.0815726    
    300000   18240          200            200            4.1961034e-06 -1.7714743e-35  0              1.258831e-05   18.619433      0              899065.79      1.1971759e-13  0              3.0442554    
    400000   18240          200            200            1.7477956e-05 -8.8573665e-36  0              5.2433868e-05  316.70237      0              15292424       1.1971759e-13  0              3.0056383    
    500000   18240          200            200            0.00093948441  6.421952e-05   0              0.0027542337   1081.7275      0              52232747       1.1971759e-13  0              2.9967687    
    600000   18240          200            200            0.002368738    0.00032860492  0              0.006777609    296.58928      0              14321235       1.1971759e-13  0              2.9948132    
    700000   18240          200            200            0.0029530888   0.00036720094  0              0.0084920654   47.787884      0              2307505.9      1.1971759e-13  0              2.9942109    
    800000   18240          200            200            0.0029549989   0.00035697378  0              0.0085080229   3.1433978      0              151783.43      1.1971759e-13  0              2.9942106    
    900000   18240          200            200            0.0029040507   0.00035542646  0              0.0083567255   0.041345465    0              1996.4245      1.1971759e-13  0              2.9942641    
   1000000   18240          200            200            0.0028728242   0.0003544531   0              0.0082640194   0.011589492    0              559.6151       1.1971759e-13  0              2.9942964    
   1100000   18240          200            200            0.0028599223   0.00035404544  0              0.0082257215   0.0091433934   0              441.50175      1.1971759e-13  0              2.9943096    
   1200000   18240          200            200            0.0028559174   0.00035391916  0              0.0082138329   0.002144009    0              103.52652      1.1971759e-13  0              2.9943137    
   1300000   18240          200            200            0.0028551051   0.00035389409  0              0.0082114212   0.0002747817   0              13.268225      1.1971759e-13  0              2.9943145    
   1400000   18240          200            200            0.0028551272   0.00035389518  0              0.0082114864   1.8582487e-05  0              0.89728178     1.1971759e-13  0              2.9943145    
   1500000   18240          200            200            0.0028552505   0.00035389925  0              0.0082118523   2.6120735e-07  0              0.012612768    1.1971759e-13  0              2.9943143    
   1600000   18240          200            200            0.0028553259   0.00035390169  0              0.008212076    6.4922125e-08  0              0.0031348571   1.1971759e-13  0              2.9943143    
   1700000   18240          200            200            0.0028553573   0.00035390269  0              0.0082121691   5.3217516e-08  0              0.0025696834   1.1971759e-13  0              2.9943142    
   1800000   18240          200            200            0.002855367    0.000353903    0              0.0082121981   1.2628274e-08  0              0.00060977416  1.1971759e-13  0              2.9943142    
   1900000   18240          200            200            0.0028553691   0.00035390306  0              0.0082122041   1.6330508e-09  0              7.8854179e-05  1.1971759e-13  0              2.9943142    
   2000000   18240          200            200            0.002855369    0.00035390306  0              0.008212204    1.1186455e-10  0              5.401539e-06   1.1971759e-13  0              2.9943142    
   2100000   18240          200            200            0.0028553687   0.00035390305  0              0.0082122031   1.6624276e-12  0              8.0272679e-08  1.1971759e-13  0              2.9943142    
   2200000   18240          200            200            0.0028553685   0.00035390304  0              0.0082122026   3.6446316e-13  0              1.7598622e-08  1.1971759e-13  0              2.9943142    
   2300000   18240          200            200            0.0028553685   0.00035390304  0              0.0082122023   3.1122627e-13  0              1.5028003e-08  1.1971759e-13  0              2.9943142    
   2400000   18240          200            200            0.0028553684   0.00035390304  0              0.0082122023   7.4402192e-14  0              3.5926156e-09  1.1971759e-13  0              2.9943142    
   2500000   18240          200            200            0.0028553684   0.00035390304  0              0.0082122022   9.755627e-15   0              4.7106431e-10  1.1971759e-13  0              2.9943142    
   2600000   18240          200            200            0.0028553684   0.00035390304  0              0.0082122022   6.9620083e-16  0              3.3617046e-11  1.1971759e-13  0              2.9943142    
   2700000   18240          200            200            0.0028553684   0.00035390304  0              0.0082122022   4.3061947e-17  0              2.0793073e-12  1.1971759e-13  0              2.9943142    
   2800000   18240          200            200            0.0028553684   0.00035390304  0              0.0082122023   3.013757e-18   0              1.4552354e-13  1.1971759e-13  0              2.9943142    
   2900000   18240          200            200            0.0028553684   0.00035390304  0              0.0082122022   8.3573844e-18  0              4.0354818e-13  1.1971759e-13  0              2.9943142    
   3000000   18240          200            200            0.0028553684   0.00035390304  0              0.0082122022   1.0789349e-17  0              5.2097903e-13  1.1971759e-13  0              2.9943142    
Loop time of 734.006 on 2 procs for 3000000 steps with 5001 atoms

Performance: 3531304.400 ns/day, 0.000 hours/ns, 4087.158 timesteps/s
99.9% CPU use with 2 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 168.92     | 169.97     | 171.02     |   8.1 | 23.16
Neigh   | 22.599     | 22.602     | 22.605     |   0.1 |  3.08
Comm    | 52.424     | 53.567     | 54.71      |  15.6 |  7.30
Output  | 0.65288    | 0.65295    | 0.65302    |   0.0 |  0.09
Modify  | 429.38     | 429.53     | 429.69     |   0.8 | 58.52
Other   |            | 57.68      |            |       |  7.86

Nlocal:         2500.5 ave        2501 max        2500 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Nghost:            2.5 ave           3 max           2 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Neighs:         1259.5 ave        1260 max        1259 min
Histogram: 1 0 0 0 0 0 0 0 0 1

Total # of neighbors = 2519
Ave neighs/atom = 0.50369926
Neighbor list builds = 166
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 9

#variable lat0 equal 1                    #
variable lat1 equal 3+((300)*0.01)+(v_ind*0.01)        # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 1000*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 6.09                                                               
Lattice spacing in x,y,z = 6.09 6.09 6.09

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -9135 ${n1e1} -100 100 -100 100 units box
region box block -9135 9135 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -9135 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -9135 9135 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-9135 -100 -100) to (9135 100 100)
  2 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 3000 atoms
  using lattice units in orthogonal box = (-9135 -100 -100) to (9135 100 100)
  create_atoms CPU = 0.002 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 3000 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 2001 atoms
  using lattice units in orthogonal box = (-9135 -100 -100) to (9135 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  3000 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  3000 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  2001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  2001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
3000 atoms in group substrate
group slider1 region slider1
2001 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 2001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_9_*.dump id type diameter mass xu yu zu fx fy fz
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 11788 130 130
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 423.1 | 423.1 | 423.1 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   18270          200            200            0              0              0              0              0              0              0              1.1971759e-13  0              6            
    100000   18270          200            200            0.0022080615   1.4964078e-41  0              0.0066241846   1156548.1      0              5.584557e+10   1.1971759e-13  0              3.3313477    
    200000   18270          200            200            0.00074984383 -1.381694e-37   0              0.0022495315   263638.25      0              1.2730148e+10  1.1971759e-13  0              3.0824861    
    300000   18270          200            200           -1.9387293e-06  3.254356e-41   0             -5.8161878e-06  3.7081467      0              179053.13      1.1971759e-13  0              3.0439611    
    400000   18270          200            200            2.2688156e-06 -5.305697e-35   0              6.8064467e-06  5.7442129      0              277367.48      1.1971759e-13  0              3.005597     
    500000   18270          200            200            0.00048053333 -0.00027227858  0              0.0017138786   48.037233      0              2319546        1.1971759e-13  0              2.9973181    
    600000   18270          200            200            0.0037133825  -0.00019176412  0              0.011331912    0.0025604514   0              123.63503      1.1971759e-13  0              2.993152     
    700000   18270          200            200            0.002668851   -3.9518982e-05  0              0.0080460719   49.85159       0              2407154.9      1.1971759e-13  0              2.9942344    
    800000   18270          200            200            0.0025811951  -6.4894069e-05  0              0.0078084792   0.16594578     0              8012.9277      1.1971759e-13  0              2.9943126    
    900000   18270          200            200            0.002686808   -6.6398054e-05  0              0.0081268221   0.70283172     0              33937.228      1.1971759e-13  0              2.9941975    
   1000000   18270          200            200            0.0027218532  -6.7589642e-05  0              0.0082331492   0.06996903     0              3378.554       1.1971759e-13  0              2.9941607    
   1100000   18270          200            200            0.0027164484  -6.7393301e-05  0              0.0082167384   0.0021109867   0              101.93199      1.1971759e-13  0              2.9941667    
   1200000   18270          200            200            0.0027103769  -6.7184119e-05  0              0.0081983149   0.0022274263   0              107.55444      1.1971759e-13  0              2.9941732    
   1300000   18270          200            200            0.0027095651  -6.7157538e-05  0              0.0081958529   3.361627e-05   0              1.6232094      1.1971759e-13  0              2.9941741    
   1400000   18270          200            200            0.0027101752  -6.717895e-05   0              0.0081977045   2.3772389e-05  0              1.1478836      1.1971759e-13  0              2.9941734    
   1500000   18270          200            200            0.0027104392  -6.7187958e-05  0              0.0081985056   4.0677955e-06  0              0.19641928     1.1971759e-13  0              2.9941731    
   1600000   18270          200            200            0.0027104242  -6.7187364e-05  0              0.0081984598   2.0725268e-08  0              0.001000749    1.1971759e-13  0              2.9941731    
   1700000   18270          200            200            0.0027103848  -6.7186002e-05  0              0.0081983405   9.4715726e-08  0              0.0045734834   1.1971759e-13  0              2.9941732    
   1800000   18270          200            200            0.0027103769  -6.7185736e-05  0              0.0081983163   3.4487011e-09  0              0.00016652543  1.1971759e-13  0              2.9941732    
   1900000   18270          200            200            0.0027103801  -6.7185852e-05  0              0.0081983263   7.0156613e-10  0              3.3876118e-05  1.1971759e-13  0              2.9941732    
   2000000   18270          200            200            0.002710382   -6.7185917e-05  0              0.008198332    2.1369232e-10  0              1.0318437e-05  1.1971759e-13  0              2.9941732    
   2100000   18270          200            200            0.0027103821  -6.7185918e-05  0              0.0081983322   2.1763169e-14  0              1.0508656e-09  1.1971759e-13  0              2.9941732    
   2200000   18270          200            200            0.0027103818  -6.718591e-05   0              0.0081983314   3.7174501e-12  0              1.7950236e-07  1.1971759e-13  0              2.9941732    
   2300000   18270          200            200            0.0027103818  -6.7185907e-05  0              0.0081983312   2.5874083e-13  0              1.2493669e-08  1.1971759e-13  0              2.9941732    
   2400000   18270          200            200            0.0027103818  -6.7185908e-05  0              0.0081983313   1.7121803e-14  0              8.2675057e-10  1.1971759e-13  0              2.9941732    
   2500000   18270          200            200            0.0027103818  -6.7185908e-05  0              0.0081983313   1.0311072e-14  0              4.9788478e-10  1.1971759e-13  0              2.9941732    
   2600000   18270          200            200            0.0027103818  -6.7185908e-05  0              0.0081983313   9.3463898e-17  0              4.5130372e-12  1.1971759e-13  0              2.9941732    
   2700000   18270          200            200            0.0027103818  -6.7185908e-05  0              0.0081983313   7.9909176e-17  0              3.8585281e-12  1.1971759e-13  0              2.9941732    
   2800000   18270          200            200            0.0027103818  -6.7185908e-05  0              0.0081983313   2.5956984e-17  0              1.2533699e-12  1.1971759e-13  0              2.9941732    
   2900000   18270          200            200            0.0027103818  -6.7185908e-05  0              0.0081983313   5.864329e-19   0              2.8316746e-14  1.1971759e-13  0              2.9941732    
   3000000   18270          200            200            0.0027103818  -6.7185908e-05  0              0.0081983313   1.6247545e-18  0              7.8453579e-14  1.1971759e-13  0              2.9941732    
Loop time of 728.406 on 2 procs for 3000000 steps with 5001 atoms

Performance: 3558455.880 ns/day, 0.000 hours/ns, 4118.583 timesteps/s
99.9% CPU use with 2 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 164.85     | 164.92     | 164.98     |   0.5 | 22.64
Neigh   | 22.804     | 22.807     | 22.809     |   0.1 |  3.13
Comm    | 53.702     | 53.837     | 53.972     |   1.8 |  7.39
Output  | 0.65216    | 0.6522     | 0.65224    |   0.0 |  0.09
Modify  | 427.7      | 427.96     | 428.21     |   1.2 | 58.75
Other   |            | 58.24      |            |       |  8.00

Nlocal:         2500.5 ave        2501 max        2500 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Nghost:            2.5 ave           3 max           2 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Neighs:         1257.5 ave        1258 max        1257 min
Histogram: 1 0 0 0 0 0 0 0 0 1

Total # of neighbors = 2515
Ave neighs/atom = 0.50289942
Neighbor list builds = 166
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 10

#variable lat0 equal 1                    #
variable lat1 equal 3+((300)*0.01)+(v_ind*0.01)        # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 1000*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 6.1                                                               
Lattice spacing in x,y,z = 6.1 6.1 6.1

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -9150 ${n1e1} -100 100 -100 100 units box
region box block -9150 9150 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -9150 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -9150 9150 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-9150 -100 -100) to (9150 100 100)
  2 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 3000 atoms
  using lattice units in orthogonal box = (-9150 -100 -100) to (9150 100 100)
  create_atoms CPU = 0.002 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 3000 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 2001 atoms
  using lattice units in orthogonal box = (-9150 -100 -100) to (9150 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  3000 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  3000 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  2001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  2001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
3000 atoms in group substrate
group slider1 region slider1
2001 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 2001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_10_*.dump id type diameter mass xu yu zu fx fy fz
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 11807 130 130
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 423.8 | 423.8 | 423.8 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   18300          200            200            0              0              0              0              0              0              0              1.1971759e-13  0              6            
    100000   18300          200            200            0.0022053712  -1.7656677e-35  0              0.0066161135   1157283.7      0              5.5881086e+10  1.1971759e-13  0              3.3310397    
    200000   18300          200            200            0.00075074112 -9.1814669e-34  0              0.0022522234   264815.32      0              1.2786984e+10  1.1971759e-13  0              3.0820052    
    300000   18300          200            200            1.4238441e-06 -4.4141671e-36  0              4.2715322e-06  2.2809079      0              110136.88      1.1971759e-13  0              3.044114     
    400000   18300          200            200            1.1413923e-05 -7.0625762e-35  0              3.4241768e-05  137.94742      0              6660987        1.1971759e-13  0              3.0056341    
    500000   18300          200            200            0.00061231726  4.2477581e-05  0              0.0017944742   190.76262      0              9211244.4      1.1971759e-13  0              2.9973114    
    600000   18300          200            200            0.002720733    0.00026493315  0              0.0078972658   362.78894      0              17517779       1.1971759e-13  0              2.9943873    
    700000   18300          200            200            0.0030230893   0.00028367929  0              0.0087855885   33.299129      0              1607895.8      1.1971759e-13  0              2.9940336    
    800000   18300          200            200            0.0029471374   0.00028245344  0              0.0085589588   0.19479142     0              9405.7803      1.1971759e-13  0              2.9941129    
    900000   18300          200            200            0.0028592499   0.00028086264  0              0.008296887    0.30359366     0              14659.451      1.1971759e-13  0              2.9942112    
   1000000   18300          200            200            0.002824244    0.0002801906   0              0.0081925414   0.11756404     0              5676.7465      1.1971759e-13  0              2.9942513    
   1100000   18300          200            200            0.0028179963   0.0002800651   0              0.0081739237   0.010498492    0              506.9346       1.1971759e-13  0              2.9942587    
   1200000   18300          200            200            0.002819481    0.00028009209  0              0.008178351    4.3841238e-05  0              2.1169365      1.1971759e-13  0              2.9942571    
   1300000   18300          200            200            0.0028210869   0.00028012289  0              0.0081831378   0.00010773225  0              5.2020048      1.1971759e-13  0              2.9942553    
   1400000   18300          200            200            0.0028217139   0.00028013511  0              0.0081850066   3.8860852e-05  0              1.8764515      1.1971759e-13  0              2.9942545    
   1500000   18300          200            200            0.0028218206   0.00028013726  0              0.0081853245   3.2843199e-06  0              0.15858806     1.1971759e-13  0              2.9942544    
   1600000   18300          200            200            0.0028217911   0.00028013672  0              0.0081852366   8.8539354e-09  0              0.00042752485  1.1971759e-13  0              2.9942545    
   1700000   18300          200            200            0.0028217616   0.00028013615  0              0.0081851486   3.818187e-08   0              0.0018436659   1.1971759e-13  0              2.9942545    
   1800000   18300          200            200            0.0028217504   0.00028013593  0              0.0081851152   1.2823784e-08  0              0.00061921464  1.1971759e-13  0              2.9942545    
   1900000   18300          200            200            0.0028217486   0.0002801359   0              0.0081851098   1.0239793e-09  0              4.9444294e-05  1.1971759e-13  0              2.9942545    
   2000000   18300          200            200            0.0028217491   0.00028013591  0              0.0081851115   1.5249981e-12  0              7.36367e-08    1.1971759e-13  0              2.9942545    
   2100000   18300          200            200            0.0028217497   0.00028013592  0              0.0081851131   1.346764e-11   0              6.5030416e-07  1.1971759e-13  0              2.9942545    
   2200000   18300          200            200            0.0028217499   0.00028013592  0              0.0081851137   4.2232331e-12  0              2.0392481e-07  1.1971759e-13  0              2.9942545    
   2300000   18300          200            200            0.0028217499   0.00028013592  0              0.0081851138   3.1789929e-13  0              1.5350219e-08  1.1971759e-13  0              2.9942545    
   2400000   18300          200            200            0.0028217499   0.00028013592  0              0.0081851138   1.8082652e-16  0              8.7314656e-12  1.1971759e-13  0              2.9942545    
   2500000   18300          200            200            0.0028217499   0.00028013592  0              0.0081851137   4.8588453e-15  0              2.3461625e-10  1.1971759e-13  0              2.9942545    
   2600000   18300          200            200            0.0028217499   0.00028013592  0              0.0081851137   1.3893539e-15  0              6.7086929e-11  1.1971759e-13  0              2.9942545    
   2700000   18300          200            200            0.0028217499   0.00028013592  0              0.0081851137   4.6016215e-17  0              2.2219583e-12  1.1971759e-13  0              2.9942545    
   2800000   18300          200            200            0.0028217499   0.00028013592  0              0.0081851137   4.8153622e-18  0              2.3251661e-13  1.1971759e-13  0              2.9942545    
   2900000   18300          200            200            0.0028217499   0.00028013592  0              0.0081851137   1.0782112e-17  0              5.2062958e-13  1.1971759e-13  0              2.9942545    
   3000000   18300          200            200            0.0028217499   0.00028013592  0              0.0081851137   1.5977197e-18  0              7.7148164e-14  1.1971759e-13  0              2.9942545    
Loop time of 723.453 on 2 procs for 3000000 steps with 5001 atoms

Performance: 3582815.387 ns/day, 0.000 hours/ns, 4146.777 timesteps/s
99.9% CPU use with 2 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 158.19     | 158.65     | 159.12     |   3.7 | 21.93
Neigh   | 22.818     | 22.821     | 22.824     |   0.1 |  3.15
Comm    | 52.838     | 53.36      | 53.881     |   7.1 |  7.38
Output  | 0.64652    | 0.64655    | 0.64657    |   0.0 |  0.09
Modify  | 429.46     | 429.56     | 429.65     |   0.5 | 59.38
Other   |            | 58.41      |            |       |  8.07

Nlocal:         2500.5 ave        2501 max        2500 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Nghost:            2.5 ave           3 max           2 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Neighs:         1247.5 ave        1248 max        1247 min
Histogram: 1 0 0 0 0 0 0 0 0 1

Total # of neighbors = 2495
Ave neighs/atom = 0.49890022
Neighbor list builds = 166
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 11

#variable lat0 equal 1                    #
variable lat1 equal 3+((300)*0.01)+(v_ind*0.01)        # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 1000*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 6.11                                                               
Lattice spacing in x,y,z = 6.11 6.11 6.11

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -9165 ${n1e1} -100 100 -100 100 units box
region box block -9165 9165 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -9165 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -9165 9165 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-9165 -100 -100) to (9165 100 100)
  2 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 3000 atoms
  using lattice units in orthogonal box = (-9165 -100 -100) to (9165 100 100)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 3000 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 2001 atoms
  using lattice units in orthogonal box = (-9165 -100 -100) to (9165 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  3000 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  3000 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  2001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  2001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
3000 atoms in group substrate
group slider1 region slider1
2001 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 2001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_11_*.dump id type diameter mass xu yu zu fx fy fz
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 11826 130 130
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 424.5 | 424.5 | 424.5 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   18330          200            200            0              0              0              0              0              0              0              1.1971759e-13  0              6            
    100000   18330          200            200            0.0022016144   1.7627821e-35  0              0.0066048432   1157155        0              5.5874874e+10  1.1971759e-13  0              3.331137     
    200000   18330          200            200            0.00074917009 -1.3220836e-35  0              0.0022475103   264621.07      0              1.2777604e+10  1.1971759e-13  0              3.0821322    
    300000   18330          200            200            7.7549519e-07 -5.2883251e-35  0              2.3264856e-06  0.72278914     0              34900.901      1.1971759e-13  0              3.0441343    
    400000   18330          200            200            9.28954e-06    1.7627839e-35  0              2.786862e-05   92.239943      0              4453936.7      1.1971759e-13  0              3.0056759    
    500000   18330          200            200            0.00040596032 -0.00061945949  0              0.0018373404   195.90163      0              9459388.6      1.1971759e-13  0              2.9973251    
    600000   18330          200            200            0.0017556533  -0.0042433184   0              0.0095102783   307.21617      0              14834369       1.1971759e-13  0              2.9937925    
    700000   18330          200            200            0.0016685484  -0.004243292    0              0.0092489371   3.2231701      0              155635.35      1.1971759e-13  0              2.9938965    
    800000   18330          200            200            0.0013827771  -0.0041125579   0              0.0082608893   6.536636       0              315630.76      1.1971759e-13  0              2.9942343    
    900000   18330          200            200            0.0013221098  -0.0040987876   0              0.0080651171   0.41839311     0              20202.706      1.1971759e-13  0              2.9943013    
   1000000   18330          200            200            0.0013384279  -0.0041052466   0              0.0081205302   0.010966756    0              529.54538      1.1971759e-13  0              2.994281     
   1100000   18330          200            200            0.0013524002  -0.0041099908   0              0.0081671913   0.015806594    0              763.24386      1.1971759e-13  0              2.9942645    
   1200000   18330          200            200            0.0013553374  -0.0041109461   0              0.0081769583   0.0010410212   0              50.26719       1.1971759e-13  0              2.9942611    
   1300000   18330          200            200            0.0013545367  -0.0041106654   0              0.0081742756   2.5123549e-05  0              1.2131263      1.1971759e-13  0              2.9942621    
   1400000   18330          200            200            0.0013538468  -0.0041104335   0              0.0081719738   3.827585e-05   0              1.8482038      1.1971759e-13  0              2.9942629    
   1500000   18330          200            200            0.0013537     -0.0041103857   0              0.0081714858   2.5836163e-06  0              0.12475358     1.1971759e-13  0              2.9942631    
   1600000   18330          200            200            0.0013537387  -0.0041103993   0              0.0081716154   5.724266e-08   0              0.0027640432   1.1971759e-13  0              2.9942631    
   1700000   18330          200            200            0.0013537727  -0.0041104107   0              0.0081717288   9.2649245e-08  0              0.0044737005   1.1971759e-13  0              2.994263     
   1800000   18330          200            200            0.00135378    -0.0041104131   0              0.0081717532   6.4109276e-09  0              0.00030956075  1.1971759e-13  0              2.994263     
   1900000   18330          200            200            0.0013537781  -0.0041104125   0              0.0081717469   1.3013626e-10  0              6.2838143e-06  1.1971759e-13  0              2.994263     
   2000000   18330          200            200            0.0013537765  -0.0041104119   0              0.0081717413   2.2420833e-10  0              1.0826218e-05  1.1971759e-13  0              2.994263     
   2100000   18330          200            200            0.0013537761  -0.0041104118   0              0.0081717401   1.5898727e-11  0              7.6769263e-07  1.1971759e-13  0              2.994263     
   2200000   18330          200            200            0.0013537762  -0.0041104118   0              0.0081717404   2.9501705e-13  0              1.4245318e-08  1.1971759e-13  0              2.994263     
   2300000   18330          200            200            0.0013537763  -0.0041104118   0              0.0081717407   5.4222028e-13  0              2.6181877e-08  1.1971759e-13  0              2.994263     
   2400000   18330          200            200            0.0013537763  -0.0041104118   0              0.0081717407   3.9394176e-14  0              1.9022038e-09  1.1971759e-13  0              2.994263     
   2500000   18330          200            200            0.0013537763  -0.0041104118   0              0.0081717407   7.543921e-16   0              3.6426895e-11  1.1971759e-13  0              2.994263     
   2600000   18330          200            200            0.0013537763  -0.0041104118   0              0.0081717407   1.3302268e-15  0              6.423189e-11   1.1971759e-13  0              2.994263     
   2700000   18330          200            200            0.0013537763  -0.0041104118   0              0.0081717407   1.3052709e-16  0              6.3026861e-12  1.1971759e-13  0              2.994263     
   2800000   18330          200            200            0.0013537763  -0.0041104118   0              0.0081717407   2.4748345e-18  0              1.195009e-13   1.1971759e-13  0              2.994263     
   2900000   18330          200            200            0.0013537763  -0.0041104118   0              0.0081717407   1.17247e-17    0              5.661438e-13   1.1971759e-13  0              2.994263     
   3000000   18330          200            200            0.0013537763  -0.0041104118   0              0.0081717407   1.2962631e-17  0              6.2591904e-13  1.1971759e-13  0              2.994263     
Loop time of 723.624 on 2 procs for 3000000 steps with 5001 atoms

Performance: 3581972.058 ns/day, 0.000 hours/ns, 4145.801 timesteps/s
100.0% CPU use with 2 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 161.78     | 162.36     | 162.94     |   4.6 | 22.44
Neigh   | 22.894     | 22.897     | 22.9       |   0.1 |  3.16
Comm    | 52.552     | 53.09      | 53.628     |   7.4 |  7.34
Output  | 0.64056    | 0.64058    | 0.6406     |   0.0 |  0.09
Modify  | 427.25     | 427.4      | 427.55     |   0.7 | 59.06
Other   |            | 57.23      |            |       |  7.91

Nlocal:         2500.5 ave        2501 max        2500 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Nghost:            2.5 ave           3 max           2 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Neighs:         1257.5 ave        1258 max        1257 min
Histogram: 1 0 0 0 0 0 0 0 0 1

Total # of neighbors = 2515
Ave neighs/atom = 0.50289942
Neighbor list builds = 166
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 12

#variable lat0 equal 1                    #
variable lat1 equal 3+((300)*0.01)+(v_ind*0.01)        # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 1000*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 6.12                                                               
Lattice spacing in x,y,z = 6.12 6.12 6.12

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -9180 ${n1e1} -100 100 -100 100 units box
region box block -9180 9180 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -9180 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -9180 9180 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-9180 -100 -100) to (9180 100 100)
  2 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 3000 atoms
  using lattice units in orthogonal box = (-9180 -100 -100) to (9180 100 100)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 3000 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 2001 atoms
  using lattice units in orthogonal box = (-9180 -100 -100) to (9180 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  3000 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  3000 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  2001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  2001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
3000 atoms in group substrate
group slider1 region slider1
2001 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 2001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_12_*.dump id type diameter mass xu yu zu fx fy fz
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 11846 130 130
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 425.2 | 425.2 | 425.2 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   18360          200            200            0              0              0              0              0              0              0              1.1971759e-13  0              6            
    100000   18360          200            200            0.0021976216   9.2447883e-42  0              0.0065928648   1156858.4      0              5.5860554e+10  1.1971759e-13  0              3.3311975    
    200000   18360          200            200            0.00074715413  1.759904e-35   0              0.0022414624   264188.14      0              1.27567e+10    1.1971759e-13  0              3.0822337    
    300000   18360          200            200           -6.4444068e-07  2.4713622e-40  0             -1.9333221e-06  0.36560198     0              17653.611      1.1971759e-13  0              3.0440219    
    400000   18360          200            200            4.8766264e-06  1.7599073e-35  0              1.4629879e-05  25.992315      0              1255075.9      1.1971759e-13  0              3.0056146    
    500000   18360          200            200            0.00046824274  6.275522e-06   0              0.0013984527   12.568759      0              606900.41      1.1971759e-13  0              2.9973889    
    600000   18360          200            200            0.0027394513   0.00032928148  0              0.0078890724   380.74634      0              18384878       1.1971759e-13  0              2.9943742    
    700000   18360          200            200            0.0029496704   0.00029814055  0              0.0085508706   44.426392      0              2145191.5      1.1971759e-13  0              2.9941579    
    800000   18360          200            200            0.0029027221   0.00029703879  0              0.0084111275   4.1252993      0              199195.94      1.1971759e-13  0              2.9942103    
    900000   18360          200            200            0.0028586831   0.00029602803  0              0.0082800213   0.2906619      0              14035.023      1.1971759e-13  0              2.994257     
   1000000   18360          200            200            0.0028351135   0.00029548097  0              0.0082098596   0.011499875    0              555.28781      1.1971759e-13  0              2.9942817    
   1100000   18360          200            200            0.0028245114   0.00029523371  0              0.0081783006   9.5591928e-06  0              0.46157921     1.1971759e-13  0              2.9942928    
   1200000   18360          200            200            0.0028202205   0.00029513369  0              0.0081655277   0.00014964875  0              7.2260026      1.1971759e-13  0              2.9942972    
   1300000   18360          200            200            0.0028186254   0.00029509662  0              0.0081607795   8.1468423e-05  0              3.9338186      1.1971759e-13  0              2.9942989    
   1400000   18360          200            200            0.0028180795   0.000295084    0              0.0081591545   2.2170329e-05  0              1.0705258      1.1971759e-13  0              2.9942994    
   1500000   18360          200            200            0.0028179097   0.0002950801   0              0.008158649    4.4129622e-06  0              0.21308615     1.1971759e-13  0              2.9942996    
   1600000   18360          200            200            0.0028178636   0.00029507906  0              0.0081585117   7.1498678e-07  0              0.034524153    1.1971759e-13  0              2.9942996    
   1700000   18360          200            200            0.002817854    0.00029507885  0              0.008158483    9.7799648e-08  0              0.004722395    1.1971759e-13  0              2.9942996    
   1800000   18360          200            200            0.0028178534   0.00029507884  0              0.0081584813   1.1327804e-08  0              0.00054697909  1.1971759e-13  0              2.9942996    
   1900000   18360          200            200            0.0028178543   0.00029507886  0              0.008158484    1.0802346e-09  0              5.2160662e-05  1.1971759e-13  0              2.9942996    
   2000000   18360          200            200            0.002817855    0.00029507888  0              0.008158486    7.7863173e-11  0              3.7597339e-06  1.1971759e-13  0              2.9942996    
   2100000   18360          200            200            0.0028178553   0.00029507889  0              0.0081584872   3.210485e-12   0              1.5502283e-07  1.1971759e-13  0              2.9942996    
   2200000   18360          200            200            0.0028178555   0.00029507889  0              0.0081584877   5.5521811e-15  0              2.6809496e-10  1.1971759e-13  0              2.9942996    
   2300000   18360          200            200            0.0028178556   0.00029507889  0              0.0081584879   3.5467623e-14  0              1.7126046e-09  1.1971759e-13  0              2.9942996    
   2400000   18360          200            200            0.0028178556   0.00029507889  0              0.0081584879   2.0608196e-14  0              9.9509602e-10  1.1971759e-13  0              2.9942996    
   2500000   18360          200            200            0.0028178556   0.00029507889  0              0.008158488    5.7498024e-15  0              2.7763738e-10  1.1971759e-13  0              2.9942996    
   2600000   18360          200            200            0.0028178556   0.00029507889  0              0.008158488    1.133641e-15   0              5.4739466e-11  1.1971759e-13  0              2.9942996    
   2700000   18360          200            200            0.0028178556   0.00029507889  0              0.008158488    1.5731653e-16  0              7.5962522e-12  1.1971759e-13  0              2.9942996    
   2800000   18360          200            200            0.0028178556   0.00029507889  0              0.008158488    1.9180919e-17  0              9.2617793e-13  1.1971759e-13  0              2.9942996    
   2900000   18360          200            200            0.0028178556   0.00029507889  0              0.008158488    1.2287353e-17  0              5.9331229e-13  1.1971759e-13  0              2.9942996    
   3000000   18360          200            200            0.0028178556   0.00029507889  0              0.008158488    1.3263417e-17  0              6.4044292e-13  1.1971759e-13  0              2.9942996    
Loop time of 722.305 on 2 procs for 3000000 steps with 5001 atoms

Performance: 3588510.431 ns/day, 0.000 hours/ns, 4153.369 timesteps/s
99.9% CPU use with 2 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 159.83     | 160.59     | 161.35     |   6.0 | 22.23
Neigh   | 22.804     | 22.805     | 22.807     |   0.0 |  3.16
Comm    | 52.394     | 53.161     | 53.928     |  10.5 |  7.36
Output  | 0.66899    | 0.66901    | 0.66903    |   0.0 |  0.09
Modify  | 426.56     | 426.7      | 426.83     |   0.7 | 59.07
Other   |            | 58.38      |            |       |  8.08

Nlocal:         2500.5 ave        2501 max        2500 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Nghost:            2.5 ave           3 max           2 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Neighs:         1253.5 ave        1254 max        1253 min
Histogram: 1 0 0 0 0 0 0 0 0 1

Total # of neighbors = 2507
Ave neighs/atom = 0.50129974
Neighbor list builds = 166
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 13

#variable lat0 equal 1                    #
variable lat1 equal 3+((300)*0.01)+(v_ind*0.01)        # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 1000*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 6.13                                                               
Lattice spacing in x,y,z = 6.13 6.13 6.13

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -9195 ${n1e1} -100 100 -100 100 units box
region box block -9195 9195 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -9195 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -9195 9195 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-9195 -100 -100) to (9195 100 100)
  2 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 3000 atoms
  using lattice units in orthogonal box = (-9195 -100 -100) to (9195 100 100)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 3000 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 2001 atoms
  using lattice units in orthogonal box = (-9195 -100 -100) to (9195 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  3000 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  3000 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  2001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  2001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
3000 atoms in group substrate
group slider1 region slider1
2001 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 2001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_13_*.dump id type diameter mass xu yu zu fx fy fz
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 11865 130 130
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 425.9 | 425.9 | 425.9 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   18390          200            200            0              0              0              0              0              0              0              1.1971759e-13  0              6            
    100000   18390          200            200            0.0021946331  -8.7851251e-36  0              0.0065838993   1157322.5      0              5.5882962e+10  1.1971759e-13  0              3.3310411    
    200000   18390          200            200            0.00074726256 -1.7570246e-35  0              0.0022417877   264923.66      0              1.2792215e+10  1.1971759e-13  0              3.0819665    
    300000   18390          200            200            1.4445725e-06  7.0281307e-35  0              4.3337176e-06  2.367391       0              114312.84      1.1971759e-13  0              3.044133     
    400000   18390          200            200            1.1185854e-05  1.7570375e-35  0              3.3557563e-05  133.85859      0              6463552.5      1.1971759e-13  0              3.0056446    
    500000   18390          200            200            0.00068545629  0.00018800505  0              0.0018683638   224.03557      0              10817876       1.1971759e-13  0              2.9972915    
    600000   18390          200            200            0.0039534156   0.0016938495   0              0.010166397    213.16074      0              10292769       1.1971759e-13  0              2.9935497    
    700000   18390          200            200            0.003798946    0.002603896    0              0.0087929421   33.423098      0              1613881.8      1.1971759e-13  0              2.9940217    
    800000   18390          200            200            0.0034596209   0.002546625    0              0.0078322376   2.4205289      0              116878.68      1.1971759e-13  0              2.9943569    
    900000   18390          200            200            0.0035392256   0.0025650044   0              0.0080526724   0.54983129     0              26549.385      1.1971759e-13  0              2.994275     
   1000000   18390          200            200            0.0035836554   0.00256673     0              0.0081842362   0.054781016    0              2645.1792      1.1971759e-13  0              2.9942286    
   1100000   18390          200            200            0.0035749784   0.0025661485   0              0.0081587867   0.0084346852   0              407.28076      1.1971759e-13  0              2.994238     
   1200000   18390          200            200            0.0035686606   0.0025657504   0              0.0081402313   0.0012006775   0              57.976418      1.1971759e-13  0              2.9942445    
   1300000   18390          200            200            0.0035696064   0.0025658132   0              0.0081430061   0.00012406099  0              5.9904613      1.1971759e-13  0              2.9942435    
   1400000   18390          200            200            0.003570489    0.0025658687   0              0.0081455983   2.5495114e-05  0              1.2310678      1.1971759e-13  0              2.9942426    
   1500000   18390          200            200            0.0035703926   0.0025658622   0              0.0081453157   1.747125e-06   0              0.084362413    1.1971759e-13  0              2.9942427    
   1600000   18390          200            200            0.0035702705   0.0025658545   0              0.0081449572   5.2588719e-07  0              0.02539321     1.1971759e-13  0              2.9942428    
   1700000   18390          200            200            0.0035702792   0.0025658551   0              0.0081449827   2.3241928e-08  0              0.0011222695   1.1971759e-13  0              2.9942428    
   1800000   18390          200            200            0.003570296    0.0025658561   0              0.0081450318   1.0577483e-08  0              0.00051074878  1.1971759e-13  0              2.9942428    
   1900000   18390          200            200            0.0035702954   0.0025658561   0              0.0081450301   2.8606708e-10  0              1.3813156e-05  1.1971759e-13  0              2.9942428    
   2000000   18390          200            200            0.0035702931   0.0025658559   0              0.0081450234   2.079902e-10   0              1.0043103e-05  1.1971759e-13  0              2.9942428    
   2100000   18390          200            200            0.0035702931   0.0025658559   0              0.0081450234   3.1357844e-12  0              1.5141581e-07  1.1971759e-13  0              2.9942428    
   2200000   18390          200            200            0.0035702934   0.002565856    0              0.0081450243   4.0068466e-12  0              1.9347628e-07  1.1971759e-13  0              2.9942428    
   2300000   18390          200            200            0.0035702934   0.002565856    0              0.0081450243   2.8269846e-14  0              1.3650497e-09  1.1971759e-13  0              2.9942428    
   2400000   18390          200            200            0.0035702934   0.002565856    0              0.0081450242   7.5793883e-14  0              3.6598154e-09  1.1971759e-13  0              2.9942428    
   2500000   18390          200            200            0.0035702934   0.002565856    0              0.0081450242   1.7018256e-16  0              8.2175068e-12  1.1971759e-13  0              2.9942428    
   2600000   18390          200            200            0.0035702934   0.002565856    0              0.0081450242   1.3992586e-15  0              6.7565188e-11  1.1971759e-13  0              2.9942428    
   2700000   18390          200            200            0.0035702934   0.002565856    0              0.0081450242   8.4248257e-18  0              4.0680468e-13  1.1971759e-13  0              2.9942428    
   2800000   18390          200            200            0.0035702934   0.002565856    0              0.0081450242   1.3328935e-17  0              6.4360655e-13  1.1971759e-13  0              2.9942428    
   2900000   18390          200            200            0.0035702934   0.002565856    0              0.0081450242   1.0256802e-18  0              4.9526426e-14  1.1971759e-13  0              2.9942428    
   3000000   18390          200            200            0.0035702934   0.002565856    0              0.0081450242   2.0811148e-18  0              1.0048959e-13  1.1971759e-13  0              2.9942428    
Loop time of 723.422 on 2 procs for 3000000 steps with 5001 atoms

Performance: 3582970.159 ns/day, 0.000 hours/ns, 4146.956 timesteps/s
99.9% CPU use with 2 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 161.68     | 162.74     | 163.8      |   8.3 | 22.50
Neigh   | 22.727     | 22.731     | 22.734     |   0.1 |  3.14
Comm    | 52.684     | 53.709     | 54.733     |  14.0 |  7.42
Output  | 0.64674    | 0.64676    | 0.64678    |   0.0 |  0.09
Modify  | 426.75     | 426.81     | 426.88     |   0.3 | 59.00
Other   |            | 56.79      |            |       |  7.85

Nlocal:         2500.5 ave        2501 max        2500 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Nghost:            2.5 ave           3 max           2 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Neighs:         1258.5 ave        1259 max        1258 min
Histogram: 1 0 0 0 0 0 0 0 0 1

Total # of neighbors = 2517
Ave neighs/atom = 0.50329934
Neighbor list builds = 166
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 14

#variable lat0 equal 1                    #
variable lat1 equal 3+((300)*0.01)+(v_ind*0.01)        # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 1000*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 6.14                                                               
Lattice spacing in x,y,z = 6.14 6.14 6.14

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -9210 ${n1e1} -100 100 -100 100 units box
region box block -9210 9210 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -9210 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -9210 9210 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-9210 -100 -100) to (9210 100 100)
  2 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 3000 atoms
  using lattice units in orthogonal box = (-9210 -100 -100) to (9210 100 100)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 3000 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 2001 atoms
  using lattice units in orthogonal box = (-9210 -100 -100) to (9210 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  3000 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  3000 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  2001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  2001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
3000 atoms in group substrate
group slider1 region slider1
2001 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 2001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_14_*.dump id type diameter mass xu yu zu fx fy fz
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 11884 130 130
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 426.5 | 426.5 | 426.5 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   18420          200            200            0              0              0              0              0              0              0              1.1971759e-13  0              6            
    100000   18420          200            200            0.0021899897  -8.7708132e-36  0              0.0065699691   1156476.6      0              5.5842114e+10  1.1971759e-13  0              3.3313747    
    200000   18420          200            200            0.00074352904  1.2848606e-41  0              0.0022305871   263522.33      0              1.272455e+10   1.1971759e-13  0              3.0825314    
    300000   18420          200            200           -2.2424804e-06 -4.2099987e-34  0             -6.7274411e-06  5.0886062      0              245710.58      1.1971759e-13  0              3.0439442    
    400000   18420          200            200            1.5457756e-06 -3.5083267e-35  0              4.6373267e-06  2.7728458      0              133890.8       1.1971759e-13  0              3.0055875    
    500000   18420          200            200            0.00062194321  0.00011926678  0              0.0017465629   95.53942       0              4613256.7      1.1971759e-13  0              2.9972797    
    600000   18420          200            200            0.0040980126   0.0011759117   0              0.011118126    24.8607        0              1200434.2      1.1971759e-13  0              2.9931775    
    700000   18420          200            200            0.0028798108   0.0012334079   0              0.0074060245   26.339105      0              1271821.1      1.1971759e-13  0              2.994439     
    800000   18420          200            200            0.0030267275   0.0011865654   0              0.0078936171   4.349931       0              210042.6       1.1971759e-13  0              2.9942512    
    900000   18420          200            200            0.0031522495   0.0011995313   0              0.0082572173   0.21288364     0              10279.389      1.1971759e-13  0              2.9941222    
   1000000   18420          200            200            0.0031159743   0.0011966756   0              0.0081512472   0.10656496     0              5145.6406      1.1971759e-13  0              2.9941608    
   1100000   18420          200            200            0.0031028332   0.0011956662   0              0.0081128335   0.00097563697  0              47.110017      1.1971759e-13  0              2.9941743    
   1200000   18420          200            200            0.0031089356   0.0011961528   0              0.0081306539   0.002191466    0              105.81805      1.1971759e-13  0              2.9941678    
   1300000   18420          200            200            0.0031101335   0.0011962432   0              0.0081341573   3.295073e-08   0              0.0015910728   1.1971759e-13  0              2.9941666    
   1400000   18420          200            200            0.0031092004   0.0011961695   0              0.0081314316   3.9425089e-05  0              1.9036964      1.1971759e-13  0              2.9941676    
   1500000   18420          200            200            0.0031091267   0.0011961642   0              0.0081312158   3.7494712e-07  0              0.018104855    1.1971759e-13  0              2.9941677    
   1600000   18420          200            200            0.0031092591   0.0011961746   0              0.0081316026   6.1955233e-07  0              0.029915965    1.1971759e-13  0              2.9941675    
   1700000   18420          200            200            0.0031092566   0.0011961744   0              0.0081315954   2.4352745e-08  0              0.0011759069   1.1971759e-13  0              2.9941675    
   1800000   18420          200            200            0.003109239    0.001196173    0              0.008131544    8.3258638e-09  0              0.00040202617  1.1971759e-13  0              2.9941675    
   1900000   18420          200            200            0.003109241    0.0011961732   0              0.0081315498   8.7207528e-10  0              4.2109394e-05  1.1971759e-13  0              2.9941675    
   2000000   18420          200            200            0.0031092432   0.0011961733   0              0.0081315562   9.0374059e-11  0              4.3638399e-06  1.1971759e-13  0              2.9941675    
   2100000   18420          200            200            0.0031092427   0.0011961733   0              0.0081315548   2.3633605e-11  0              1.1411822e-06  1.1971759e-13  0              2.9941675    
   2200000   18420          200            200            0.0031092425   0.0011961733   0              0.0081315541   6.7736018e-13  0              3.2707299e-08  1.1971759e-13  0              2.9941675    
   2300000   18420          200            200            0.0031092425   0.0011961733   0              0.0081315543   5.3447462e-13  0              2.5807867e-08  1.1971759e-13  0              2.9941675    
   2400000   18420          200            200            0.0031092426   0.0011961733   0              0.0081315544   1.6959639e-15  0              8.1892028e-11  1.1971759e-13  0              2.9941675    
   2500000   18420          200            200            0.0031092425   0.0011961733   0              0.0081315544   1.046654e-14   0              5.0539175e-10  1.1971759e-13  0              2.9941675    
   2600000   18420          200            200            0.0031092425   0.0011961733   0              0.0081315544   1.0753498e-17  0              5.1924791e-13  1.1971759e-13  0              2.9941675    
   2700000   18420          200            200            0.0031092425   0.0011961733   0              0.0081315544   1.881608e-16   0              9.0856118e-12  1.1971759e-13  0              2.9941675    
   2800000   18420          200            200            0.0031092425   0.0011961733   0              0.0081315544   1.3213931e-18  0              6.3805343e-14  1.1971759e-13  0              2.9941675    
   2900000   18420          200            200            0.0031092425   0.0011961733   0              0.0081315544   1.3493493e-17  0              6.5155248e-13  1.1971759e-13  0              2.9941675    
   3000000   18420          200            200            0.0031092425   0.0011961733   0              0.0081315544   1.0720925e-17  0              5.1767508e-13  1.1971759e-13  0              2.9941675    
Loop time of 724.982 on 2 procs for 3000000 steps with 5001 atoms

Performance: 3575260.752 ns/day, 0.000 hours/ns, 4138.033 timesteps/s
99.9% CPU use with 2 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 158.98     | 161        | 163.02     |  15.9 | 22.21
Neigh   | 22.643     | 22.646     | 22.649     |   0.1 |  3.12
Comm    | 51.974     | 53.956     | 55.939     |  27.0 |  7.44
Output  | 0.64919    | 0.6492     | 0.64922    |   0.0 |  0.09
Modify  | 429.53     | 429.55     | 429.57     |   0.1 | 59.25
Other   |            | 57.18      |            |       |  7.89

Nlocal:         2500.5 ave        2501 max        2500 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Nghost:            2.5 ave           3 max           2 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Neighs:         1255.5 ave        1256 max        1255 min
Histogram: 1 0 0 0 0 0 0 0 0 1

Total # of neighbors = 2511
Ave neighs/atom = 0.50209958
Neighbor list builds = 166
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 15

#variable lat0 equal 1                    #
variable lat1 equal 3+((300)*0.01)+(v_ind*0.01)        # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 1000*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 6.15                                                               
Lattice spacing in x,y,z = 6.15 6.15 6.15

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -9225 ${n1e1} -100 100 -100 100 units box
region box block -9225 9225 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -9225 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -9225 9225 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-9225 -100 -100) to (9225 100 100)
  2 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 3000 atoms
  using lattice units in orthogonal box = (-9225 -100 -100) to (9225 100 100)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 3000 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 2001 atoms
  using lattice units in orthogonal box = (-9225 -100 -100) to (9225 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  3000 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  3000 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  2001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  2001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
3000 atoms in group substrate
group slider1 region slider1
2001 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 2001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_15_*.dump id type diameter mass xu yu zu fx fy fz
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 11904 130 130
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 427.2 | 427.2 | 427.2 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   18450          200            200            0              0              0              0              0              0              0              1.1971759e-13  0              6            
    100000   18450          200            200            0.0021871399   2.1891428e-36  0              0.0065614197   1157051.2      0              5.586986e+10   1.1971759e-13  0              3.3311077    
    200000   18450          200            200            0.0007437122  -3.5026014e-35  0              0.0022311366   264297.61      0              1.2761986e+10  1.1971759e-13  0              3.0822291    
    300000   18450          200            200           -5.0382641e-07  1.313486e-35   0             -1.5114792e-06  0.21418935     0              10342.437      1.1971759e-13  0              3.0440411    
    400000   18450          200            200            5.9362545e-06  1.7513176e-35  0              1.7808763e-05  38.654142      0              1866470.2      1.1971759e-13  0              3.0056629    
    500000   18450          200            200            0.0013072524   2.2451874e-05  0              0.0038993052   2091.2555      0              1.0097924e+08  1.1971759e-13  0              2.9957565    
    600000   18450          200            200            0.0033501012   0.00034507254  0              0.0097052311   307.39701      0              14843101       1.1971759e-13  0              2.9936369    
    700000   18450          200            200            0.0031868629   0.00025552169  0              0.0093050671   2.0757703e-05  0              1.0023152      1.1971759e-13  0              2.9937696    
    800000   18450          200            200            0.0028917651   0.00024650979  0              0.0084287854   3.4191453      0              165098.29      1.1971759e-13  0              2.9940365    
    900000   18450          200            200            0.0027912551   0.00024388933  0              0.0081298759   0.94350597     0              45558.527      1.1971759e-13  0              2.9941288    
   1000000   18450          200            200            0.0027755636   0.0002434714   0              0.0080832195   0.078682691    0              3799.3056      1.1971759e-13  0              2.9941428    
   1100000   18450          200            200            0.0027803929   0.00024361341  0              0.0080975654   0.00050089427  0              24.186392      1.1971759e-13  0              2.994138     
   1200000   18450          200            200            0.0027851407   0.0002437468   0              0.0081116754   0.00065093997  0              31.431561      1.1971759e-13  0              2.9941336    
   1300000   18450          200            200            0.0027870799   0.00024380034  0              0.0081174395   0.00028587642  0              13.803949      1.1971759e-13  0              2.9941318    
   1400000   18450          200            200            0.0027874982   0.00024381163  0              0.008118683    3.3431994e-05  0              1.6143114      1.1971759e-13  0              2.9941314    
   1500000   18450          200            200            0.0027874654   0.00024381059  0              0.0081185857   7.7053298e-07  0              0.03720628     1.1971759e-13  0              2.9941314    
   1600000   18450          200            200            0.0027873914   0.0002438085   0              0.0081183657   8.9249478e-08  0              0.0043095379   1.1971759e-13  0              2.9941315    
   1700000   18450          200            200            0.0027873555   0.00024380751  0              0.0081182589   7.8786936e-08  0              0.0038043392   1.1971759e-13  0              2.9941315    
   1800000   18450          200            200            0.0027873458   0.00024380725  0              0.0081182303   1.2715515e-08  0              0.00061398673  1.1971759e-13  0              2.9941315    
   1900000   18450          200            200            0.0027873454   0.00024380724  0              0.008118229    5.6221581e-10  0              2.7147389e-05  1.1971759e-13  0              2.9941315    
   2000000   18450          200            200            0.0027873465   0.00024380727  0              0.0081182322   5.0016324e-12  0              2.4151093e-07  1.1971759e-13  0              2.9941315    
   2100000   18450          200            200            0.0027873471   0.00024380729  0              0.0081182341   1.9393775e-11  0              9.3645599e-07  1.1971759e-13  0              2.9941315    
   2200000   18450          200            200            0.0027873473   0.00024380729  0              0.0081182347   4.4049432e-12  0              2.1269894e-07  1.1971759e-13  0              2.9941315    
   2300000   18450          200            200            0.0027873474   0.00024380729  0              0.0081182348   3.0371897e-13  0              1.4665502e-08  1.1971759e-13  0              2.9941315    
   2400000   18450          200            200            0.0027873473   0.00024380729  0              0.0081182347   3.8516682e-16  0              1.8598327e-11  1.1971759e-13  0              2.9941315    
   2500000   18450          200            200            0.0027873473   0.00024380729  0              0.0081182347   3.9724129e-15  0              1.918136e-10   1.1971759e-13  0              2.9941315    
   2600000   18450          200            200            0.0027873473   0.00024380729  0              0.0081182347   1.3716299e-15  0              6.6231097e-11  1.1971759e-13  0              2.9941315    
   2700000   18450          200            200            0.0027873473   0.00024380729  0              0.0081182347   1.6777106e-16  0              8.1010641e-12  1.1971759e-13  0              2.9941315    
   2800000   18450          200            200            0.0027873473   0.00024380729  0              0.0081182347   1.6908403e-17  0              8.1644626e-13  1.1971759e-13  0              2.9941315    
   2900000   18450          200            200            0.0027873473   0.00024380729  0              0.0081182347   8.1289295e-18  0              3.9251691e-13  1.1971759e-13  0              2.9941315    
   3000000   18450          200            200            0.0027873473   0.00024380729  0              0.0081182347   1.5020609e-17  0              7.2529143e-13  1.1971759e-13  0              2.9941315    
Loop time of 728.682 on 2 procs for 3000000 steps with 5001 atoms

Performance: 3557106.531 ns/day, 0.000 hours/ns, 4117.021 timesteps/s
99.9% CPU use with 2 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 162.2      | 163.02     | 163.85     |   6.5 | 22.37
Neigh   | 22.741     | 22.743     | 22.746     |   0.0 |  3.12
Comm    | 52.26      | 53.276     | 54.291     |  13.9 |  7.31
Output  | 0.6338     | 0.6338     | 0.63381    |   0.0 |  0.09
Modify  | 428.52     | 428.6      | 428.67     |   0.3 | 58.82
Other   |            | 60.41      |            |       |  8.29

Nlocal:         2500.5 ave        2501 max        2500 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Nghost:            2.5 ave           3 max           2 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Neighs:         1269.5 ave        1270 max        1269 min
Histogram: 1 0 0 0 0 0 0 0 0 1

Total # of neighbors = 2539
Ave neighs/atom = 0.50769846
Neighbor list builds = 166
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 16

#variable lat0 equal 1                    #
variable lat1 equal 3+((300)*0.01)+(v_ind*0.01)        # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 1000*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 6.16                                                               
Lattice spacing in x,y,z = 6.16 6.16 6.16

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -9240 ${n1e1} -100 100 -100 100 units box
region box block -9240 9240 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -9240 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -9240 9240 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-9240 -100 -100) to (9240 100 100)
  2 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 3000 atoms
  using lattice units in orthogonal box = (-9240 -100 -100) to (9240 100 100)
  create_atoms CPU = 0.002 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 3000 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 2001 atoms
  using lattice units in orthogonal box = (-9240 -100 -100) to (9240 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  3000 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  3000 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  2001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  2001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
3000 atoms in group substrate
group slider1 region slider1
2001 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 2001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_16_*.dump id type diameter mass xu yu zu fx fy fz
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 11923 130 130
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 427.9 | 427.9 | 427.9 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   18480          200            200            0              0              0              0              0              0              0              1.1971759e-13  0              6            
    100000   18480          200            200            0.0021832879   1.4632688e-41  0              0.0065498638   1156800.6      0              5.5857761e+10  1.1971759e-13  0              3.3312481    
    200000   18480          200            200            0.00074209469 -3.4969383e-35  0              0.0022262841   264069.52      0              1.2750972e+10  1.1971759e-13  0              3.0823095    
    300000   18480          200            200           -7.6362586e-07  8.7423629e-36  0             -2.2908776e-06  0.53609062     0              25885.897      1.1971759e-13  0              3.0440187    
    400000   18480          200            200            5.0434341e-06 -3.4969343e-35  0              1.5130302e-05  28.129954      0              1358294.8      1.1971759e-13  0              3.0056224    
    500000   18480          200            200            0.00035577755 -0.00058327865  0              0.0016506113   1.4447085      0              69759.802      1.1971759e-13  0              2.9973762    
    600000   18480          200            200            0.0018537724  -0.0053819523   0              0.01094327     50.673422      0              2446838.2      1.1971759e-13  0              2.9932421    
    700000   18480          200            200            0.0010820342  -0.0049751596   0              0.0082212622   50.298552      0              2428737.1      1.1971759e-13  0              2.9941711    
    800000   18480          200            200            0.00093477674 -0.0049122351   0              0.0077165653   0.014650329    0              707.41198      1.1971759e-13  0              2.9943462    
    900000   18480          200            200            0.0010483721  -0.004958543    0              0.0081036592   0.91549516     0              44205.985      1.1971759e-13  0              2.9942048    
   1000000   18480          200            200            0.0010645328  -0.0049643721   0              0.0081579705   0.00025403239  0              12.266315      1.1971759e-13  0              2.9941863    
   1100000   18480          200            200            0.0010485048  -0.0049581902   0              0.0081037045   0.016425484    0              793.12786      1.1971759e-13  0              2.9942059    
   1200000   18480          200            200            0.0010468709  -0.0049576099   0              0.0080982225   3.9551814e-05  0              1.9098155      1.1971759e-13  0              2.9942077    
   1300000   18480          200            200            0.0010490754  -0.0049584643   0              0.0081056904   0.00029013323  0              14.009495      1.1971759e-13  0              2.994205     
   1400000   18480          200            200            0.0010492241  -0.0049585147   0              0.008106187    1.951522e-06   0              0.094232015    1.1971759e-13  0              2.9942049    
   1500000   18480          200            200            0.0010489227  -0.0049583983   0              0.0081051665   5.0425187e-06  0              0.24348518     1.1971759e-13  0              2.9942052    
   1600000   18480          200            200            0.0010489125  -0.0049583952   0              0.0081051327   6.7868652e-08  0              0.0032771343   1.1971759e-13  0              2.9942053    
   1700000   18480          200            200            0.0010489534  -0.004958411    0              0.0081052711   8.6184655e-08  0              0.0041615485   1.1971759e-13  0              2.9942052    
   1800000   18480          200            200            0.0010489534  -0.0049584109   0              0.0081052711   1.983299e-09   0              9.5766411e-05  1.1971759e-13  0              2.9942052    
   1900000   18480          200            200            0.0010489479  -0.0049584088   0              0.0081052525   1.4470809e-09  0              6.9874358e-05  1.1971759e-13  0              2.9942052    
   2000000   18480          200            200            0.0010489481  -0.0049584089   0              0.0081052531   5.21314e-11    0              2.5172387e-06  1.1971759e-13  0              2.9942052    
   2100000   18480          200            200            0.0010489488  -0.0049584091   0              0.0081052556   2.383655e-11   0              1.1509817e-06  1.1971759e-13  0              2.9942052    
   2200000   18480          200            200            0.0010489488  -0.0049584091   0              0.0081052554   1.2741033e-12  0              6.1521887e-08  1.1971759e-13  0              2.9942052    
   2300000   18480          200            200            0.0010489487  -0.0049584091   0              0.0081052551   3.8487502e-13  0              1.8584237e-08  1.1971759e-13  0              2.9942052    
   2400000   18480          200            200            0.0010489487  -0.0049584091   0              0.0081052551   2.9498173e-14  0              1.4243612e-09  1.1971759e-13  0              2.9942052    
   2500000   18480          200            200            0.0010489487  -0.0049584091   0              0.0081052552   6.1545741e-15  0              2.9718236e-10  1.1971759e-13  0              2.9942052    
   2600000   18480          200            200            0.0010489487  -0.0049584091   0              0.0081052552   5.8775824e-16  0              2.8380742e-11  1.1971759e-13  0              2.9942052    
   2700000   18480          200            200            0.0010489487  -0.0049584091   0              0.0081052552   1.4047292e-16  0              6.7829348e-12  1.1971759e-13  0              2.9942052    
   2800000   18480          200            200            0.0010489487  -0.0049584091   0              0.0081052552   2.892813e-19   0              1.3968359e-14  1.1971759e-13  0              2.9942052    
   2900000   18480          200            200            0.0010489487  -0.0049584091   0              0.0081052552   6.0463076e-18  0              2.9195455e-13  1.1971759e-13  0              2.9942052    
   3000000   18480          200            200            0.0010489487  -0.0049584091   0              0.0081052552   7.7758111e-18  0              3.7546609e-13  1.1971759e-13  0              2.9942052    
Loop time of 726.423 on 2 procs for 3000000 steps with 5001 atoms

Performance: 3568170.337 ns/day, 0.000 hours/ns, 4129.827 timesteps/s
100.0% CPU use with 2 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 159.38     | 160.87     | 162.35     |  11.7 | 22.15
Neigh   | 22.849     | 22.851     | 22.854     |   0.1 |  3.15
Comm    | 52.339     | 53.913     | 55.487     |  21.4 |  7.42
Output  | 0.6437     | 0.64371    | 0.64372    |   0.0 |  0.09
Modify  | 428.62     | 428.65     | 428.68     |   0.2 | 59.01
Other   |            | 59.5       |            |       |  8.19

Nlocal:         2500.5 ave        2501 max        2500 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Nghost:            2.5 ave           3 max           2 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Neighs:         1253.5 ave        1254 max        1253 min
Histogram: 1 0 0 0 0 0 0 0 0 1

Total # of neighbors = 2507
Ave neighs/atom = 0.50129974
Neighbor list builds = 166
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 17

#variable lat0 equal 1                    #
variable lat1 equal 3+((300)*0.01)+(v_ind*0.01)        # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 1000*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 6.17                                                               
Lattice spacing in x,y,z = 6.17 6.17 6.17

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -9255 ${n1e1} -100 100 -100 100 units box
region box block -9255 9255 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -9255 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -9255 9255 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-9255 -100 -100) to (9255 100 100)
  2 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 3000 atoms
  using lattice units in orthogonal box = (-9255 -100 -100) to (9255 100 100)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 3000 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 2001 atoms
  using lattice units in orthogonal box = (-9255 -100 -100) to (9255 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  3000 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  3000 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  2001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  2001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
3000 atoms in group substrate
group slider1 region slider1
2001 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 2001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_17_*.dump id type diameter mass xu yu zu fx fy fz
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 11942 130 130
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 428.5 | 428.5 | 428.5 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   18510          200            200            0              0              0              0              0              0              0              1.1971759e-13  0              6            
    100000   18510          200            200            0.0021795853  -2.2693277e-34  0              0.0065387558   1156670.4      0              5.5851476e+10  1.1971759e-13  0              3.3312982    
    200000   18510          200            200            0.00074046895  3.4912778e-35  0              0.0022214068   263832.57      0              1.273953e+10   1.1971759e-13  0              3.0824085    
    300000   18510          200            200           -1.3227101e-06  1.7456403e-35  0             -3.9681303e-06  1.7232886      0              83211.438      1.1971759e-13  0              3.0439882    
    400000   18510          200            200            3.271384e-06   1.7456466e-35  0              9.814152e-06   12.05189       0              581942.62      1.1971759e-13  0              3.0056109    
    500000   18510          200            200            0.00034730741 -0.0006201051   0              0.0016620273   12.147154      0              586542.59      1.1971759e-13  0              2.9973574    
    600000   18510          200            200            0.0033238934  -0.0011639714   0              0.011135651    9.3049146      0              449301.02      1.1971759e-13  0              2.9931776    
    700000   18510          200            200            0.0022852289  -0.0010479742   0              0.0079036609   49.023576      0              2367173.1      1.1971759e-13  0              2.9942668    
    800000   18510          200            200            0.0021847306  -0.001172591    0              0.0077267828   0.81807953     0              39502.133      1.1971759e-13  0              2.9943232    
    900000   18510          200            200            0.0023277697  -0.0011785986   0              0.0081619077   0.68996658     0              33316.017      1.1971759e-13  0              2.9941653    
   1000000   18510          200            200            0.0023188376  -0.001176773    0              0.0081332858   0.048535972    0              2343.6284      1.1971759e-13  0              2.9941766    
   1100000   18510          200            200            0.002301432   -0.0011736107   0              0.0080779065   0.0074187874   0              358.22669      1.1971759e-13  0              2.9941964    
   1200000   18510          200            200            0.0023046508  -0.0011742215   0              0.0080881738   0.0015629306   0              75.468323      1.1971759e-13  0              2.9941926    
   1300000   18510          200            200            0.0023066205  -0.001174576    0              0.0080944374   4.944106e-05   0              2.3873318      1.1971759e-13  0              2.9941903    
   1400000   18510          200            200            0.0023059606  -0.001174453    0              0.0080923346   3.7545691e-05  0              1.8129471      1.1971759e-13  0              2.9941911    
   1500000   18510          200            200            0.0023057717  -0.0011744195   0              0.0080917346   5.7407115e-08  0              0.0027719841   1.1971759e-13  0              2.9941913    
   1600000   18510          200            200            0.0023058822  -0.0011744399   0              0.0080920865   7.2536163e-07  0              0.035025117    1.1971759e-13  0              2.9941912    
   1700000   18510          200            200            0.0023058949  -0.001174442    0              0.0080921267   4.3441213e-09  0              0.00020976207  1.1971759e-13  0              2.9941912    
   1800000   18510          200            200            0.0023058786  -0.001174439    0              0.0080920747   1.1437771e-08  0              0.00055228903  1.1971759e-13  0              2.9941912    
   1900000   18510          200            200            0.0023058787  -0.0011744391   0              0.0080920753   4.4888445e-10  0              2.1675023e-05  1.1971759e-13  0              2.9941912    
   2000000   18510          200            200            0.0023058809  -0.0011744395   0              0.0080920822   1.4261267e-10  0              6.8862555e-06  1.1971759e-13  0              2.9941912    
   2100000   18510          200            200            0.0023058806  -0.0011744394   0              0.0080920813   1.7859236e-11  0              8.6235857e-07  1.1971759e-13  0              2.9941912    
   2200000   18510          200            200            0.0023058804  -0.0011744394   0              0.0080920805   1.2532403e-12  0              6.0514489e-08  1.1971759e-13  0              2.9941912    
   2300000   18510          200            200            0.0023058804  -0.0011744394   0              0.0080920807   4.8629647e-13  0              2.3481516e-08  1.1971759e-13  0              2.9941912    
   2400000   18510          200            200            0.0023058805  -0.0011744394   0              0.0080920808   4.7378122e-15  0              2.2877199e-10  1.1971759e-13  0              2.9941912    
   2500000   18510          200            200            0.0023058805  -0.0011744394   0              0.0080920808   1.0391852e-14  0              5.0178535e-10  1.1971759e-13  0              2.9941912    
   2600000   18510          200            200            0.0023058805  -0.0011744394   0              0.0080920808   2.21773e-18    0              1.0708624e-13  1.1971759e-13  0              2.9941912    
   2700000   18510          200            200            0.0023058805  -0.0011744394   0              0.0080920808   1.8722102e-16  0              9.0402331e-12  1.1971759e-13  0              2.9941912    
   2800000   18510          200            200            0.0023058805  -0.0011744394   0              0.0080920808   1.2595348e-18  0              6.0818428e-14  1.1971759e-13  0              2.9941912    
   2900000   18510          200            200            0.0023058805  -0.0011744394   0              0.0080920808   8.3139602e-18  0              4.0145138e-13  1.1971759e-13  0              2.9941912    
   3000000   18510          200            200            0.0023058805  -0.0011744394   0              0.0080920808   4.3705299e-18  0              2.1103725e-13  1.1971759e-13  0              2.9941912    
Loop time of 722.387 on 2 procs for 3000000 steps with 5001 atoms

Performance: 3588106.762 ns/day, 0.000 hours/ns, 4152.901 timesteps/s
99.9% CPU use with 2 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 160.82     | 162.03     | 163.24     |   9.5 | 22.43
Neigh   | 22.889     | 22.893     | 22.896     |   0.1 |  3.17
Comm    | 52.742     | 53.913     | 55.083     |  15.9 |  7.46
Output  | 0.64816    | 0.64817    | 0.64818    |   0.0 |  0.09
Modify  | 425.31     | 425.36     | 425.42     |   0.3 | 58.88
Other   |            | 57.54      |            |       |  7.97

Nlocal:         2500.5 ave        2501 max        2500 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Nghost:            2.5 ave           3 max           2 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Neighs:         1254.5 ave        1255 max        1254 min
Histogram: 1 0 0 0 0 0 0 0 0 1

Total # of neighbors = 2509
Ave neighs/atom = 0.50169966
Neighbor list builds = 166
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 18

#variable lat0 equal 1                    #
variable lat1 equal 3+((300)*0.01)+(v_ind*0.01)        # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 1000*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 6.18                                                               
Lattice spacing in x,y,z = 6.18 6.18 6.18

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -9270 ${n1e1} -100 100 -100 100 units box
region box block -9270 9270 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -9270 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -9270 9270 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-9270 -100 -100) to (9270 100 100)
  2 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 3000 atoms
  using lattice units in orthogonal box = (-9270 -100 -100) to (9270 100 100)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 3000 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 2001 atoms
  using lattice units in orthogonal box = (-9270 -100 -100) to (9270 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  3000 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  3000 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  2001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  2001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
3000 atoms in group substrate
group slider1 region slider1
2001 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 2001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_18_*.dump id type diameter mass xu yu zu fx fy fz
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 11962 130 130
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 429.2 | 429.2 | 429.2 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   18540          200            200            0              0              0              0              0              0              0              1.1971759e-13  0              6            
    100000   18540          200            200            0.0021765012   3.48563e-35    0              0.0065295035   1157020.3      0              5.5868368e+10  1.1971759e-13  0              3.3311704    
    200000   18540          200            200            0.00074038356  8.7140774e-36  0              0.0022211507   264456.09      0              1.2769638e+10  1.1971759e-13  0              3.0821585    
    300000   18540          200            200            4.235654e-07  -1.7428006e-35  0              1.2706962e-06  0.24523115     0              11841.334      1.1971759e-13  0              3.0440731    
    400000   18540          200            200            7.831e-06      1.2199699e-34  0              2.3493e-05     67.372426      0              3253173.3      1.1971759e-13  0              3.0056389    
    500000   18540          200            200            0.00041869542 -0.00042863697  0              0.0016847232   94.457814      0              4561029.8      1.1971759e-13  0              2.9973495    
    600000   18540          200            200            0.0035748938   0.0006900554   0              0.010034626    226.47333      0              10935587       1.1971759e-13  0              2.9935461    
    700000   18540          200            200            0.0031874731   0.00048202179  0              0.0090803975   10.189844      0              492031.12      1.1971759e-13  0              2.9938681    
    800000   18540          200            200            0.0029205239   0.00045679459  0              0.008304777    4.7557884      0              229640         1.1971759e-13  0              2.9941284    
    900000   18540          200            200            0.0028528485   0.00045131415  0              0.0081072312   0.88821066     0              42888.514      1.1971759e-13  0              2.994196     
   1000000   18540          200            200            0.0028397119   0.00045035546  0              0.0080687804   0.11863046     0              5728.2402      1.1971759e-13  0              2.9942089    
   1100000   18540          200            200            0.0028395492   0.00045036061  0              0.0080682869   0.011454795    0              553.11106      1.1971759e-13  0              2.9942088    
   1200000   18540          200            200            0.0028412017   0.00045049357  0              0.0080731117   0.00069213507  0              33.420725      1.1971759e-13  0              2.994207     
   1300000   18540          200            200            0.0028423462   0.00045058303  0              0.0080764556   1.1953001e-05  0              0.57716765     1.1971759e-13  0              2.9942058    
   1400000   18540          200            200            0.0028429007   0.00045062586  0              0.0080780762   1.4213352e-06  0              0.068631189    1.1971759e-13  0              2.9942053    
   1500000   18540          200            200            0.002843123    0.0004506429   0              0.0080787263   1.6226824e-06  0              0.078353528    1.1971759e-13  0              2.994205     
   1600000   18540          200            200            0.0028431993   0.0004506487   0              0.0080789494   4.9561177e-07  0              0.023931318    1.1971759e-13  0              2.994205     
   1700000   18540          200            200            0.0028432212   0.00045065034  0              0.0080790133   9.3863409e-08  0              0.0045323281   1.1971759e-13  0              2.9942049    
   1800000   18540          200            200            0.0028432258   0.00045065068  0              0.0080790267   1.2816122e-08  0              0.00061884469  1.1971759e-13  0              2.9942049    
   1900000   18540          200            200            0.002843226    0.00045065068  0              0.0080790272   1.268381e-09   0              6.124558e-05   1.1971759e-13  0              2.9942049    
   2000000   18540          200            200            0.0028432255   0.00045065064  0              0.0080790257   7.9963725e-11  0              3.8611621e-06  1.1971759e-13  0              2.9942049    
   2100000   18540          200            200            0.0028432251   0.00045065062  0              0.0080790247   1.6337185e-12  0              7.8886418e-08  1.1971759e-13  0              2.9942049    
   2200000   18540          200            200            0.0028432249   0.0004506506   0              0.0080790242   1.1191127e-13  0              5.4037948e-09  1.1971759e-13  0              2.9942049    
   2300000   18540          200            200            0.0028432248   0.0004506506   0              0.0080790239   1.595645e-13   0              7.7047988e-09  1.1971759e-13  0              2.9942049    
   2400000   18540          200            200            0.0028432248   0.00045065059  0              0.0080790239   5.0857359e-14  0              2.4557198e-09  1.1971759e-13  0              2.9942049    
   2500000   18540          200            200            0.0028432248   0.00045065059  0              0.0080790238   9.8455429e-15  0              4.7540603e-10  1.1971759e-13  0              2.9942049    
   2600000   18540          200            200            0.0028432248   0.00045065059  0              0.0080790238   1.3847801e-15  0              6.6866075e-11  1.1971759e-13  0              2.9942049    
   2700000   18540          200            200            0.0028432248   0.00045065059  0              0.0080790238   1.7333367e-16  0              8.3696623e-12  1.1971759e-13  0              2.9942049    
   2800000   18540          200            200            0.0028432248   0.00045065059  0              0.0080790238   2.4564285e-17  0              1.1861214e-12  1.1971759e-13  0              2.9942049    
   2900000   18540          200            200            0.0028432248   0.00045065059  0              0.0080790238   2.0815817e-19  0              1.0051213e-14  1.1971759e-13  0              2.9942049    
   3000000   18540          200            200            0.0028432248   0.0004506506   0              0.0080790238   1.2162156e-18  0              5.87267e-14    1.1971759e-13  0              2.9942049    
Loop time of 724.315 on 2 procs for 3000000 steps with 5001 atoms

Performance: 3578553.780 ns/day, 0.000 hours/ns, 4141.845 timesteps/s
99.9% CPU use with 2 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 163.68     | 163.79     | 163.89     |   0.8 | 22.61
Neigh   | 22.957     | 22.961     | 22.964     |   0.1 |  3.17
Comm    | 53.055     | 53.227     | 53.399     |   2.4 |  7.35
Output  | 0.65365    | 0.6537     | 0.65375    |   0.0 |  0.09
Modify  | 426.55     | 426.56     | 426.58     |   0.1 | 58.89
Other   |            | 57.12      |            |       |  7.89

Nlocal:         2500.5 ave        2501 max        2500 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Nghost:            2.5 ave           3 max           2 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Neighs:         1263.5 ave        1264 max        1263 min
Histogram: 1 0 0 0 0 0 0 0 0 1

Total # of neighbors = 2527
Ave neighs/atom = 0.50529894
Neighbor list builds = 166
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 19

#variable lat0 equal 1                    #
variable lat1 equal 3+((300)*0.01)+(v_ind*0.01)        # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 1000*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 6.19                                                               
Lattice spacing in x,y,z = 6.19 6.19 6.19

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -9285 ${n1e1} -100 100 -100 100 units box
region box block -9285 9285 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -9285 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -9285 9285 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-9285 -100 -100) to (9285 100 100)
  2 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 3000 atoms
  using lattice units in orthogonal box = (-9285 -100 -100) to (9285 100 100)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 3000 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 2001 atoms
  using lattice units in orthogonal box = (-9285 -100 -100) to (9285 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  3000 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  3000 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  2001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  2001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
3000 atoms in group substrate
group slider1 region slider1
2001 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 2001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_19_*.dump id type diameter mass xu yu zu fx fy fz
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 11981 130 130
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 429.9 | 429.9 | 429.9 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   18570          200            200            0              0              0              0              0              0              0              1.1971759e-13  0              6            
    100000   18570          200            200            0.0021722545   2.174997e-36   0              0.0065167636   1156439.9      0              5.5840346e+10  1.1971759e-13  0              3.3313906    
    200000   18570          200            200            0.00073740976  1.7400075e-35  0              0.0022122293   263458.6       0              1.2721473e+10  1.1971759e-13  0              3.0825585    
    300000   18570          200            200           -2.3729922e-06 -1.0439956e-34  0             -7.1189765e-06  5.8113372      0              280608.68      1.1971759e-13  0              3.0439366    
    400000   18570          200            200            1.2789657e-06  1.392001e-34   0              3.836897e-06   1.9564486      0              94469.903      1.1971759e-13  0              3.0055825    
    500000   18570          200            200            0.00095774455  0.0011164694   0              0.0017567643   119.59164      0              5774652.3      1.1971759e-13  0              2.9972575    
    600000   18570          200            200            0.0033335096  -0.0010480773   0              0.011048606    22.635982      0              1093010.6      1.1971759e-13  0              2.9931669    
    700000   18570          200            200            0.0024164127  -0.00016166154  0              0.0074108995   30.419634      0              1468855.3      1.1971759e-13  0              2.9944071    
    800000   18570          200            200            0.0025477809  -0.00020382592  0              0.0078471687   4.6828769      0              226119.37      1.1971759e-13  0              2.9942367    
    900000   18570          200            200            0.0026561319  -0.00023410374  0              0.0082024996   0.071861134    0              3469.917       1.1971759e-13  0              2.9941097    
   1000000   18570          200            200            0.0026132976  -0.0002257721   0              0.0080656649   0.12267411     0              5923.4938      1.1971759e-13  0              2.9941597    
   1100000   18570          200            200            0.0026076205  -0.00022468252  0              0.008047544    0.0015108294   0              72.952545      1.1971759e-13  0              2.9941659    
   1200000   18570          200            200            0.002614557   -0.00022610497  0              0.0080697758   0.0015061126   0              72.724787      1.1971759e-13  0              2.9941578    
   1300000   18570          200            200            0.0026138414  -0.00022594925  0              0.0080674734   0.00018260812  0              8.8174925      1.1971759e-13  0              2.9941587    
   1400000   18570          200            200            0.0026130606  -0.0002257924   0              0.0080649742   5.4508403e-06  0              0.26320157     1.1971759e-13  0              2.9941596    
   1500000   18570          200            200            0.0026133235  -0.00022584691  0              0.0080658173   5.3625349e-06  0              0.25893762     1.1971759e-13  0              2.9941593    
   1600000   18570          200            200            0.0026133724  -0.00022585638  0              0.0080659735   3.2503682e-08  0              0.0015694865   1.1971759e-13  0              2.9941592    
   1700000   18570          200            200            0.0026133266  -0.00022584703  0              0.0080658268   7.4508158e-08  0              0.0035977323   1.1971759e-13  0              2.9941593    
   1800000   18570          200            200            0.0026133298  -0.00022584775  0              0.0080658371   6.8080441e-09  0              0.00032873608  1.1971759e-13  0              2.9941593    
   1900000   18570          200            200            0.0026133353  -0.00022584885  0              0.0080658546   3.6477228e-10  0              1.7613548e-05  1.1971759e-13  0              2.9941593    
   2000000   18570          200            200            0.0026133337  -0.00022584852  0              0.0080658495   2.3025304e-10  0              1.1118095e-05  1.1971759e-13  0              2.9941593    
   2100000   18570          200            200            0.0026133333  -0.00022584844  0              0.0080658482   4.4877144e-13  0              2.1669567e-08  1.1971759e-13  0              2.9941593    
   2200000   18570          200            200            0.0026133336  -0.0002258485   0              0.0080658492   3.6007103e-12  0              1.7386542e-07  1.1971759e-13  0              2.9941593    
   2300000   18570          200            200            0.0026133336  -0.0002258485   0              0.0080658492   2.4499251e-13  0              1.1829811e-08  1.1971759e-13  0              2.9941593    
   2400000   18570          200            200            0.0026133335  -0.00022584849  0              0.008065849    2.2203316e-14  0              1.0721187e-09  1.1971759e-13  0              2.9941593    
   2500000   18570          200            200            0.0026133335  -0.0002258485   0              0.0080658491   9.7539832e-15  0              4.7098494e-10  1.1971759e-13  0              2.9941593    
   2600000   18570          200            200            0.0026133335  -0.0002258485   0              0.0080658491   6.5300201e-20  0              3.153113e-15   1.1971759e-13  0              2.9941593    
   2700000   18570          200            200            0.0026133335  -0.0002258485   0              0.0080658491   1.869602e-16   0              9.027639e-12   1.1971759e-13  0              2.9941593    
   2800000   18570          200            200            0.0026133335  -0.0002258485   0              0.0080658491   1.1625333e-19  0              5.6134575e-15  1.1971759e-13  0              2.9941593    
   2900000   18570          200            200            0.0026133335  -0.0002258485   0              0.0080658491   3.7685187e-18  0              1.8196828e-13  1.1971759e-13  0              2.9941593    
   3000000   18570          200            200            0.0026133335  -0.00022584849  0              0.0080658491   1.6982174e-18  0              8.200084e-14   1.1971759e-13  0              2.9941593    
Loop time of 725.879 on 2 procs for 3000000 steps with 5001 atoms

Performance: 3570841.847 ns/day, 0.000 hours/ns, 4132.919 timesteps/s
100.0% CPU use with 2 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 161.73     | 162.45     | 163.18     |   5.7 | 22.38
Neigh   | 22.99      | 22.993     | 22.996     |   0.1 |  3.17
Comm    | 52.924     | 53.743     | 54.563     |  11.2 |  7.40
Output  | 0.64122    | 0.64123    | 0.64124    |   0.0 |  0.09
Modify  | 428.25     | 428.39     | 428.52     |   0.7 | 59.02
Other   |            | 57.66      |            |       |  7.94

Nlocal:         2500.5 ave        2501 max        2500 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Nghost:            2.5 ave           3 max           2 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Neighs:         1252.5 ave        1253 max        1252 min
Histogram: 1 0 0 0 0 0 0 0 0 1

Total # of neighbors = 2505
Ave neighs/atom = 0.50089982
Neighbor list builds = 166
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 20

#variable lat0 equal 1                    #
variable lat1 equal 3+((300)*0.01)+(v_ind*0.01)        # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 1000*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 6.2                                                               
Lattice spacing in x,y,z = 6.2 6.2 6.2

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -9300 ${n1e1} -100 100 -100 100 units box
region box block -9300 9300 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -9300 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -9300 9300 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-9300 -100 -100) to (9300 100 100)
  2 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 3000 atoms
  using lattice units in orthogonal box = (-9300 -100 -100) to (9300 100 100)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 3000 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 2001 atoms
  using lattice units in orthogonal box = (-9300 -100 -100) to (9300 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  3000 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  3000 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  2001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  2001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
3000 atoms in group substrate
group slider1 region slider1
2001 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 2001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_20_*.dump id type diameter mass xu yu zu fx fy fz
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 12000 130 130
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 430.6 | 430.6 | 430.6 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   18600          200            200            0              0              0              0              0              0              0              1.1971759e-13  0              6            
    100000   18600          200            200            0.0021693989   1.3028931e-35  0              0.0065081968   1156971.4      0              5.586601e+10   1.1971759e-13  0              3.3311304    
    200000   18600          200            200            0.00073636494  9.8683288e-41  0              0.0022090948   263529.58      0              1.27249e+10    1.1971759e-13  0              3.082642     
    300000   18600          200            200            1.7977156e-06 -1.7371843e-35  0              5.3931469e-06  3.6915952      0              178253.92      1.1971759e-13  0              3.0440495    
    400000   18600          200            200            1.9357664e-05  1.7371938e-35  0              5.8072991e-05  402.07287      0              19414660       1.1971759e-13  0              3.0053559    
    500000   18600          200            200            0.0051607361   0.00037452797  0              0.01510768     897.89597      0              43356183       1.1971759e-13  0              2.9915859    
    600000   18600          200            200            0.003590939    5.4155441e-05  0              0.010718661    13.477718      0              650790.76      1.1971759e-13  0              2.9927465    
    700000   18600          200            200            0.0027799458  -2.605782e-35   0              0.0083398374   38.516646      0              1859831        1.1971759e-13  0              2.9936698    
    800000   18600          200            200            0.002679717   -1.7371875e-35  0              0.0080391509   5.9338363      0              286523.72      1.1971759e-13  0              2.9938282    
    900000   18600          200            200            0.0026678844  -8.6859274e-36  0              0.0080036531   0.65856531     0              31799.762      1.1971759e-13  0              2.9938487    
   1000000   18600          200            200            0.0026736625   1.7371934e-35  0              0.0080209874   0.047960338    0              2315.8331      1.1971759e-13  0              2.9938407    
   1100000   18600          200            200            0.0026791895  -8.6859175e-36  0              0.0080375685   0.0014624681   0              70.61735       1.1971759e-13  0              2.9938325    
   1200000   18600          200            200            0.0026821412  -1.3028892e-35  0              0.0080464236   1.3983796e-05  0              0.67522744     1.1971759e-13  0              2.993828     
   1300000   18600          200            200            0.0026833863   8.6859886e-36  0              0.0080501589   5.8891254e-05  0              2.8436479      1.1971759e-13  0              2.9938261    
   1400000   18600          200            200            0.0026838278  -8.6859159e-36  0              0.0080514834   2.1794919e-05  0              1.0523986      1.1971759e-13  0              2.9938254    
   1500000   18600          200            200            0.0026839576  -8.6859154e-36  0              0.0080518727   4.4629561e-06  0              0.21550018     1.1971759e-13  0              2.9938252    
   1600000   18600          200            200            0.0026839856   4.3430131e-36  0              0.0080519567   6.3178104e-07  0              0.030506445    1.1971759e-13  0              2.9938252    
   1700000   18600          200            200            0.0026839869   5.42909e-37    0              0.0080519608   6.3043285e-08  0              0.0030441346   1.1971759e-13  0              2.9938252    
   1800000   18600          200            200            0.0026839841   5.42909e-37    0              0.0080519523   3.8608098e-09  0              0.00018642469  1.1971759e-13  0              2.9938252    
   1900000   18600          200            200            0.002683982    3.6938869e-41  0              0.008051946    6.4783355e-11  0              3.1281564e-06  1.1971759e-13  0              2.9938252    
   2000000   18600          200            200            0.002683981   -6.5144273e-36  0              0.0080519429   8.6844034e-12  0              4.1933876e-07  1.1971759e-13  0              2.9938252    
   2100000   18600          200            200            0.0026839806   8.6859893e-36  0              0.0080519417   9.4301404e-12  0              4.5534773e-07  1.1971759e-13  0              2.9938252    
   2200000   18600          200            200            0.0026839804  -3.4743772e-35  0              0.0080519413   2.7967832e-12  0              1.3504665e-07  1.1971759e-13  0              2.9938252    
   2300000   18600          200            200            0.0026839804   3.697292e-41   0              0.0080519411   5.0919378e-13  0              2.4587145e-08  1.1971759e-13  0              2.9938252    
   2400000   18600          200            200            0.0026839804  -1.7371868e-35  0              0.0080519411   6.5234527e-14  0              3.1499418e-09  1.1971759e-13  0              2.9938252    
   2500000   18600          200            200            0.0026839804   8.6859892e-36  0              0.0080519411   6.0689956e-15  0              2.9305008e-10  1.1971759e-13  0              2.9938252    
   2600000   18600          200            200            0.0026839804   2.6057894e-35  0              0.0080519411   2.6757718e-16  0              1.2920345e-11  1.1971759e-13  0              2.9938252    
   2700000   18600          200            200            0.0026839804   8.6859891e-36  0              0.0080519411   7.2390462e-18  0              3.4954763e-13  1.1971759e-13  0              2.9938252    
   2800000   18600          200            200            0.0026839804   3.7024859e-41  0              0.0080519411   5.3794547e-18  0              2.5975462e-13  1.1971759e-13  0              2.9938252    
   2900000   18600          200            200            0.0026839804   3.4743846e-35  0              0.0080519411   1.0648124e-18  0              5.1415979e-14  1.1971759e-13  0              2.9938252    
   3000000   18600          200            200            0.0026839804   3.7322507e-41  0              0.0080519411   4.2141918e-19  0              2.0348824e-14  1.1971759e-13  0              2.9938252    
Loop time of 717.188 on 2 procs for 3000000 steps with 5001 atoms

Performance: 3614113.489 ns/day, 0.000 hours/ns, 4183.002 timesteps/s
100.0% CPU use with 2 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 152.57     | 154.06     | 155.55     |  12.0 | 21.48
Neigh   | 22.978     | 22.98      | 22.982     |   0.0 |  3.20
Comm    | 52.175     | 53.787     | 55.4       |  22.0 |  7.50
Output  | 0.63381    | 0.63381    | 0.63382    |   0.0 |  0.09
Modify  | 426.94     | 426.95     | 426.97     |   0.1 | 59.53
Other   |            | 58.77      |            |       |  8.19

Nlocal:         2500.5 ave        2501 max        2500 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Nghost:            2.5 ave           3 max           2 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Neighs:         1227.5 ave        1228 max        1227 min
Histogram: 1 0 0 0 0 0 0 0 0 1

Total # of neighbors = 2455
Ave neighs/atom = 0.49090182
Neighbor list builds = 166
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 21

#variable lat0 equal 1                    #
variable lat1 equal 3+((300)*0.01)+(v_ind*0.01)        # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 1000*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 6.21                                                               
Lattice spacing in x,y,z = 6.21 6.21 6.21

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -9315 ${n1e1} -100 100 -100 100 units box
region box block -9315 9315 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -9315 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -9315 9315 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-9315 -100 -100) to (9315 100 100)
  2 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 3000 atoms
  using lattice units in orthogonal box = (-9315 -100 -100) to (9315 100 100)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 3000 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 2001 atoms
  using lattice units in orthogonal box = (-9315 -100 -100) to (9315 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  3000 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  3000 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  2001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  2001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
3000 atoms in group substrate
group slider1 region slider1
2001 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 2001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_21_*.dump id type diameter mass xu yu zu fx fy fz
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 12020 130 130
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 431.2 | 431.2 | 431.2 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   18630          200            200            0              0              0              0              0              0              0              1.1971759e-13  0              6            
    100000   18630          200            200            0.0021650245  -5.203175e-35   0              0.0064950734   1156252.5      0              5.5831297e+10  1.1971759e-13  0              3.3314648    
    200000   18630          200            200            0.00073450275  2.1334003e-42  0              0.0022035083   263159.4       0              1.2707026e+10  1.1971759e-13  0              3.0826771    
    300000   18630          200            200           -3.2220418e-06 -2.167991e-35   0             -9.6661255e-06  10.937461      0              528130.83      1.1971759e-13  0              3.0438922    
    400000   18630          200            200           -9.981367e-07   6.4172549e-34  0             -2.9944101e-06  0.99280729     0              47939.111      1.1971759e-13  0              3.0055576    
    500000   18630          200            200            0.00030957791 -0.00087469542  0              0.0018034292   196.36103      0              9481571.5      1.1971759e-13  0              2.9971919    
    600000   18630          200            200            0.0037909638   0.00049139311  0              0.010881498    54.209082      0              2617562.6      1.1971759e-13  0              2.9931987    
    700000   18630          200            200            0.0023828673  -0.00023395884  0              0.0073825607   30.452143      0              1470425        1.1971759e-13  0              2.9943911    
    800000   18630          200            200            0.0025092441  -0.00017681206  0              0.0077045443   1.7633408      0              85145.415      1.1971759e-13  0              2.9942637    
    900000   18630          200            200            0.0026454102  -0.00015076828  0              0.0080869988   0.80918663     0              39072.726      1.1971759e-13  0              2.9941251    
   1000000   18630          200            200            0.0026470142  -0.0001506851   0              0.0080917277   0.0027678777   0              133.65091      1.1971759e-13  0              2.9941244    
   1100000   18630          200            200            0.0026293576  -0.00015286666  0              0.0080409394   0.016496562    0              796.55993      1.1971759e-13  0              2.9941427    
   1200000   18630          200            200            0.0026266075  -0.00015319717  0              0.0080330198   0.00013402695  0              6.4716818      1.1971759e-13  0              2.9941454    
   1300000   18630          200            200            0.0026285808  -0.00015294644  0              0.008038689    0.00024307103  0              11.73703       1.1971759e-13  0              2.9941434    
   1400000   18630          200            200            0.0026292377  -0.0001528657   0              0.0080405787   1.4603006e-05  0              0.70512689     1.1971759e-13  0              2.9941427    
   1500000   18630          200            200            0.0026290677  -0.0001528876   0              0.0080400906   2.3771734e-06  0              0.11478519     1.1971759e-13  0              2.9941429    
   1600000   18630          200            200            0.0026289546  -0.00015290164  0              0.0080397655   5.4437006e-07  0              0.026285682    1.1971759e-13  0              2.994143     
   1700000   18630          200            200            0.0026289611  -0.00015290073  0              0.008039784    1.0039726e-08  0              0.00048478244  1.1971759e-13  0              2.994143     
   1800000   18630          200            200            0.0026289772  -0.00015289871  0              0.0080398304   1.2944803e-08  0              0.00062505823  1.1971759e-13  0              2.994143     
   1900000   18630          200            200            0.0026289787  -0.00015289854  0              0.0080398346   9.2879597e-12  0              4.4848233e-07  1.1971759e-13  0              2.994143     
   2000000   18630          200            200            0.0026289767  -0.00015289879  0              0.008039829    2.2078148e-10  0              1.0660747e-05  1.1971759e-13  0              2.994143     
   2100000   18630          200            200            0.0026289763  -0.00015289885  0              0.0080398276   6.5964981e-12  0              3.1852128e-07  1.1971759e-13  0              2.994143     
   2200000   18630          200            200            0.0026289765  -0.00015289882  0              0.0080398282   2.6434178e-12  0              1.2764119e-07  1.1971759e-13  0              2.994143     
   2300000   18630          200            200            0.0026289765  -0.00015289881  0              0.0080398284   3.3743819e-13  0              1.6293683e-08  1.1971759e-13  0              2.994143     
   2400000   18630          200            200            0.0026289765  -0.00015289881  0              0.0080398284   1.8184714e-14  0              8.7807476e-10  1.1971759e-13  0              2.994143     
   2500000   18630          200            200            0.0026289765  -0.00015289882  0              0.0080398284   9.5951448e-15  0              4.633152e-10   1.1971759e-13  0              2.994143     
   2600000   18630          200            200            0.0026289765  -0.00015289882  0              0.0080398284   7.4549076e-18  0              3.5997081e-13  1.1971759e-13  0              2.994143     
   2700000   18630          200            200            0.0026289765  -0.00015289882  0              0.0080398284   1.6082354e-16  0              7.7655932e-12  1.1971759e-13  0              2.994143     
   2800000   18630          200            200            0.0026289765  -0.00015289882  0              0.0080398284   1.5793383e-17  0              7.6260593e-13  1.1971759e-13  0              2.994143     
   2900000   18630          200            200            0.0026289765  -0.00015289882  0              0.0080398284   6.7790475e-18  0              3.2733594e-13  1.1971759e-13  0              2.994143     
   3000000   18630          200            200            0.0026289765  -0.00015289882  0              0.0080398284   1.4018998e-17  0              6.7692722e-13  1.1971759e-13  0              2.994143     
Loop time of 725.241 on 2 procs for 3000000 steps with 5001 atoms

Performance: 3573985.652 ns/day, 0.000 hours/ns, 4136.557 timesteps/s
99.9% CPU use with 2 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 161.48     | 162.54     | 163.59     |   8.3 | 22.41
Neigh   | 22.998     | 23.001     | 23.005     |   0.1 |  3.17
Comm    | 52.965     | 54.021     | 55.076     |  14.4 |  7.45
Output  | 0.64658    | 0.64659    | 0.64661    |   0.0 |  0.09
Modify  | 427.15     | 427.17     | 427.18     |   0.1 | 58.90
Other   |            | 57.87      |            |       |  7.98

Nlocal:         2500.5 ave        2501 max        2500 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Nghost:            2.5 ave           3 max           2 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Neighs:         1255.5 ave        1256 max        1255 min
Histogram: 1 0 0 0 0 0 0 0 0 1

Total # of neighbors = 2511
Ave neighs/atom = 0.50209958
Neighbor list builds = 166
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 22

#variable lat0 equal 1                    #
variable lat1 equal 3+((300)*0.01)+(v_ind*0.01)        # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 1000*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 6.22                                                               
Lattice spacing in x,y,z = 6.22 6.22 6.22

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -9330 ${n1e1} -100 100 -100 100 units box
region box block -9330 9330 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -9330 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -9330 9330 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-9330 -100 -100) to (9330 100 100)
  2 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 3000 atoms
  using lattice units in orthogonal box = (-9330 -100 -100) to (9330 100 100)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 3000 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 2001 atoms
  using lattice units in orthogonal box = (-9330 -100 -100) to (9330 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  3000 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  3000 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  2001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  2001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
3000 atoms in group substrate
group slider1 region slider1
2001 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 2001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_22_*.dump id type diameter mass xu yu zu fx fy fz
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 12039 130 130
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 431.9 | 431.9 | 431.9 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   18660          200            200            0              0              0              0              0              0              0              1.1971759e-13  0              6            
    100000   18660          200            200            0.0021619697   5.1948207e-35  0              0.006485909    1156594.2      0              5.5847793e+10  1.1971759e-13  0              3.3313293    
    200000   18660          200            200            0.00073432664 -2.1645042e-36  0              0.0022029799   263725.79      0              1.2734375e+10  1.1971759e-13  0              3.0824478    
    300000   18660          200            200           -1.7135896e-06  3.4632214e-35  0             -5.1407688e-06  3.0016302      0              144937.98      1.1971759e-13  0              3.0439717    
    400000   18660          200            200            2.7512042e-06 -2.0779226e-34  0              8.2536127e-06  8.7218599      0              421147.4       1.1971759e-13  0              3.0056031    
    500000   18660          200            200            0.00044755616 -0.00031390394  0              0.0016565724   12.504929      0              603818.27      1.1971759e-13  0              2.997346     
    600000   18660          200            200            0.0037721119   0.00034882129  0              0.010967515    27.959411      0              1350059.9      1.1971759e-13  0              2.9931908    
    700000   18660          200            200            0.0027046439  -0.00013011975  0              0.0082440514   49.070586      0              2369443        1.1971759e-13  0              2.9941084    
    800000   18660          200            200            0.0025411095  -6.6137011e-05  0              0.0076894656   1.5902598      0              76787.955      1.1971759e-13  0              2.9943028    
    900000   18660          200            200            0.0026187282  -6.2992465e-05  0              0.0079191772   0.40117891     0              19371.494      1.1971759e-13  0              2.994217     
   1000000   18660          200            200            0.0026623048  -5.8986909e-05  0              0.0080459012   0.10641054     0              5138.1843      1.1971759e-13  0              2.9941717    
   1100000   18660          200            200            0.0026624044  -5.9007077e-05  0              0.0080462203   1.7878619e-05  0              0.86329455     1.1971759e-13  0              2.9941719    
   1200000   18660          200            200            0.0026565641  -5.9544517e-05  0              0.0080292367   0.002016457    0              97.367494      1.1971759e-13  0              2.994178     
   1300000   18660          200            200            0.0026550989  -5.9675722e-05  0              0.0080249725   0.00011274501  0              5.4440532      1.1971759e-13  0              2.9941795    
   1400000   18660          200            200            0.0026555189  -5.9635976e-05  0              0.0080261927   1.1512872e-05  0              0.5559154      1.1971759e-13  0              2.9941791    
   1500000   18660          200            200            0.0026558206  -5.9608427e-05  0              0.0080270703   5.168171e-06   0              0.24955248     1.1971759e-13  0              2.9941788    
   1600000   18660          200            200            0.0026558393  -5.9606907e-05  0              0.0080271249   1.2115744e-08  0              0.00058502594  1.1971759e-13  0              2.9941788    
   1700000   18660          200            200            0.0026558034  -5.9610233e-05  0              0.0080270204   7.7452128e-08  0              0.0037398861   1.1971759e-13  0              2.9941788    
   1800000   18660          200            200            0.0026557919  -5.9611266e-05  0              0.0080269871   7.0791357e-09  0              0.00034182613  1.1971759e-13  0              2.9941788    
   1900000   18660          200            200            0.0026557939  -5.9611076e-05  0              0.0080269928   2.7108153e-10  0              1.3089557e-05  1.1971759e-13  0              2.9941788    
   2000000   18660          200            200            0.0026557959  -5.961089e-05   0              0.0080269987   2.3766831e-10  0              1.1476152e-05  1.1971759e-13  0              2.9941788    
   2100000   18660          200            200            0.0026557962  -5.9610869e-05  0              0.0080269994   2.6483021e-12  0              1.2787703e-07  1.1971759e-13  0              2.9941788    
   2200000   18660          200            200            0.002655796   -5.9610889e-05  0              0.0080269988   2.7817008e-12  0              1.3431838e-07  1.1971759e-13  0              2.9941788    
   2300000   18660          200            200            0.0026557959  -5.9610896e-05  0              0.0080269986   4.023443e-13   0              1.9427766e-08  1.1971759e-13  0              2.9941788    
   2400000   18660          200            200            0.0026557959  -5.9610896e-05  0              0.0080269986   4.3794024e-15  0              2.1146567e-10  1.1971759e-13  0              2.9941788    
   2500000   18660          200            200            0.0026557959  -5.9610894e-05  0              0.0080269986   1.0352359e-14  0              4.9987838e-10  1.1971759e-13  0              2.9941788    
   2600000   18660          200            200            0.0026557959  -5.9610894e-05  0              0.0080269986   3.0899551e-16  0              1.4920287e-11  1.1971759e-13  0              2.9941788    
   2700000   18660          200            200            0.0026557959  -5.9610894e-05  0              0.0080269986   4.4319806e-17  0              2.1400448e-12  1.1971759e-13  0              2.9941788    
   2800000   18660          200            200            0.0026557959  -5.9610894e-05  0              0.0080269986   2.5065867e-17  0              1.210341e-12   1.1971759e-13  0              2.9941788    
   2900000   18660          200            200            0.0026557959  -5.9610894e-05  0              0.0080269986   1.4734855e-19  0              7.114934e-15   1.1971759e-13  0              2.9941788    
   3000000   18660          200            200            0.0026557959  -5.9610894e-05  0              0.0080269986   7.0141743e-19  0              3.3868937e-14  1.1971759e-13  0              2.9941788    
Loop time of 724.848 on 2 procs for 3000000 steps with 5001 atoms

Performance: 3575920.746 ns/day, 0.000 hours/ns, 4138.797 timesteps/s
100.0% CPU use with 2 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 161.31     | 162.87     | 164.43     |  12.2 | 22.47
Neigh   | 22.979     | 22.982     | 22.986     |   0.1 |  3.17
Comm    | 52.661     | 54.34      | 56.019     |  22.8 |  7.50
Output  | 0.65485    | 0.65488    | 0.6549     |   0.0 |  0.09
Modify  | 426.53     | 426.67     | 426.81     |   0.7 | 58.86
Other   |            | 57.33      |            |       |  7.91

Nlocal:         2500.5 ave        2501 max        2500 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Nghost:            2.5 ave           3 max           2 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Neighs:         1254.5 ave        1255 max        1254 min
Histogram: 1 0 0 0 0 0 0 0 0 1

Total # of neighbors = 2509
Ave neighs/atom = 0.50169966
Neighbor list builds = 166
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 23

#variable lat0 equal 1                    #
variable lat1 equal 3+((300)*0.01)+(v_ind*0.01)        # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 1000*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 6.23                                                               
Lattice spacing in x,y,z = 6.23 6.23 6.23

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -9345 ${n1e1} -100 100 -100 100 units box
region box block -9345 9345 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -9345 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -9345 9345 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-9345 -100 -100) to (9345 100 100)
  2 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 3000 atoms
  using lattice units in orthogonal box = (-9345 -100 -100) to (9345 100 100)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 3000 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 2001 atoms
  using lattice units in orthogonal box = (-9345 -100 -100) to (9345 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  3000 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  3000 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  2001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  2001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
3000 atoms in group substrate
group slider1 region slider1
2001 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 2001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_23_*.dump id type diameter mass xu yu zu fx fy fz
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 12059 130 130
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 432.6 | 432.6 | 432.6 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   18690          200            200            0              0              0              0              0              0              0              1.1971759e-13  0              6            
    100000   18690          200            200            0.0021580331  -8.6441237e-36  0              0.0064740993   1156227.3      0              5.5830081e+10  1.1971759e-13  0              3.3314462    
    200000   18690          200            200            0.00073208131  1.7847012e-41  0              0.0021962439   263127.47      0              1.2705484e+10  1.1971759e-13  0              3.0826471    
    300000   18690          200            200           -4.000518e-06  -1.7288167e-35  0             -1.2001554e-05  17.112121      0              826283.06      1.1971759e-13  0              3.0438584    
    400000   18690          200            200           -1.3260751e-06  2.4087597e-40  0             -3.9782253e-06  1.8154261      0              87660.431      1.1971759e-13  0              3.0055387    
    500000   18690          200            200           -0.00079868147 -0.0040455629   0              0.0016495185   43.04913       0              2078688.4      1.1971759e-13  0              2.9972721    
    600000   18690          200            200            0.0030766253  -0.0017420243   0              0.0109719      22.845327      0              1103119.1      1.1971759e-13  0              2.9931383    
    700000   18690          200            200            0.00097306103 -0.0052032678   0              0.0081224509   50.33318       0              2430409.1      1.1971759e-13  0              2.9941008    
    800000   18690          200            200            0.00086423564 -0.0050385849   0              0.0076312918   0.054422591    0              2627.8722      1.1971759e-13  0              2.9942733    
    900000   18690          200            200            0.0010136143  -0.0049616478   0              0.0080024906   0.90884762     0              43884.999      1.1971759e-13  0              2.9941359    
   1000000   18690          200            200            0.0010370908  -0.0049547346   0              0.0080660069   0.00033936235  0              16.386593      1.1971759e-13  0              2.9941139    
   1100000   18690          200            200            0.0010180979  -0.0049605726   0              0.0080148663   0.01650126     0              796.78681      1.1971759e-13  0              2.9941325    
   1200000   18690          200            200            0.0010151824  -0.0049614454   0              0.0080069925   9.6418544e-07  0              0.046557064    1.1971759e-13  0              2.9941353    
   1300000   18690          200            200            0.0010177747  -0.0049606294   0              0.0080139533   0.00029884028  0              14.429928      1.1971759e-13  0              2.9941327    
   1400000   18690          200            200            0.001018137   -0.0049605217   0              0.0080149326   4.6887226e-09  0              0.00022640163  1.1971759e-13  0              2.9941324    
   1500000   18690          200            200            0.0010177842  -0.0049606323   0              0.008013985    5.4013802e-06  0              0.26081332     1.1971759e-13  0              2.9941327    
   1600000   18690          200            200            0.0010177396  -0.0049606455   0              0.0080138643   1.3079521e-09  0              6.3156328e-05  1.1971759e-13  0              2.9941328    
   1700000   18690          200            200            0.0010177876  -0.0049606305   0              0.0080139931   9.7432227e-08  0              0.0047046535   1.1971759e-13  0              2.9941327    
   1800000   18690          200            200            0.001017793   -0.0049606289   0              0.0080140079   7.1992519e-11  0              3.4762611e-06  1.1971759e-13  0              2.9941327    
   1900000   18690          200            200            0.0010177865  -0.0049606309   0              0.0080139904   1.7539345e-09  0              8.4691219e-05  1.1971759e-13  0              2.9941327    
   2000000   18690          200            200            0.0010177858  -0.0049606311   0              0.0080139886   2.6479219e-12  0              1.2785867e-07  1.1971759e-13  0              2.9941327    
   2100000   18690          200            200            0.0010177867  -0.0049606308   0              0.008013991    3.1511453e-11  0              1.5215753e-06  1.1971759e-13  0              2.9941327    
   2200000   18690          200            200            0.0010177868  -0.0049606308   0              0.0080139912   8.0625328e-14  0              3.8931085e-09  1.1971759e-13  0              2.9941327    
   2300000   18690          200            200            0.0010177867  -0.0049606308   0              0.0080139909   5.6530349e-13  0              2.7296482e-08  1.1971759e-13  0              2.9941327    
   2400000   18690          200            200            0.0010177867  -0.0049606308   0              0.0080139908   2.1546962e-15  0              1.0404257e-10  1.1971759e-13  0              2.9941327    
   2500000   18690          200            200            0.0010177867  -0.0049606308   0              0.0080139909   1.0137039e-14  0              4.8948132e-10  1.1971759e-13  0              2.9941327    
   2600000   18690          200            200            0.0010177867  -0.0049606308   0              0.0080139909   3.7696299e-17  0              1.8202194e-12  1.1971759e-13  0              2.9941327    
   2700000   18690          200            200            0.0010177867  -0.0049606308   0              0.0080139909   1.8657228e-16  0              9.0089077e-12  1.1971759e-13  0              2.9941327    
   2800000   18690          200            200            0.0010177867  -0.0049606308   0              0.0080139909   3.5833068e-18  0              1.7302506e-13  1.1971759e-13  0              2.9941327    
   2900000   18690          200            200            0.0010177867  -0.0049606308   0              0.0080139909   9.0858755e-18  0              4.3872441e-13  1.1971759e-13  0              2.9941327    
   3000000   18690          200            200            0.0010177867  -0.0049606308   0              0.0080139909   7.2022448e-18  0              3.4777063e-13  1.1971759e-13  0              2.9941327    
Loop time of 725.312 on 2 procs for 3000000 steps with 5001 atoms

Performance: 3573634.677 ns/day, 0.000 hours/ns, 4136.151 timesteps/s
99.9% CPU use with 2 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 159.39     | 161.7      | 164.02     |  18.2 | 22.29
Neigh   | 23.022     | 23.025     | 23.028     |   0.1 |  3.17
Comm    | 52.591     | 54.852     | 57.113     |  30.5 |  7.56
Output  | 0.64005    | 0.64006    | 0.64007    |   0.0 |  0.09
Modify  | 427.39     | 427.49     | 427.58     |   0.5 | 58.94
Other   |            | 57.6       |            |       |  7.94

Nlocal:         2500.5 ave        2501 max        2500 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Nghost:            2.5 ave           3 max           2 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Neighs:         1249.5 ave        1250 max        1249 min
Histogram: 1 0 0 0 0 0 0 0 0 1

Total # of neighbors = 2499
Ave neighs/atom = 0.49970006
Neighbor list builds = 166
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 24

#variable lat0 equal 1                    #
variable lat1 equal 3+((300)*0.01)+(v_ind*0.01)        # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 1000*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 6.24                                                               
Lattice spacing in x,y,z = 6.24 6.24 6.24

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -9360 ${n1e1} -100 100 -100 100 units box
region box block -9360 9360 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -9360 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -9360 9360 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-9360 -100 -100) to (9360 100 100)
  2 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 3000 atoms
  using lattice units in orthogonal box = (-9360 -100 -100) to (9360 100 100)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 3000 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 2001 atoms
  using lattice units in orthogonal box = (-9360 -100 -100) to (9360 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  3000 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  3000 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  2001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  2001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
3000 atoms in group substrate
group slider1 region slider1
2001 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 2001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_24_*.dump id type diameter mass xu yu zu fx fy fz
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 12078 130 130
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 433.2 | 433.2 | 433.2 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   18720          200            200            0              0              0              0              0              0              0              1.1971759e-13  0              6            
    100000   18720          200            200            0.0021548823   1.2082389e-34  0              0.006464647    1156474.4      0              5.584201e+10   1.1971759e-13  0              3.3313499    
    200000   18720          200            200            0.00073166216 -8.6302496e-36  0              0.0021949865   263552.34      0              1.2725999e+10  1.1971759e-13  0              3.0824918    
    300000   18720          200            200           -2.2524863e-06  3.4521263e-35  0             -6.757459e-06   5.3086834      0              256337.32      1.1971759e-13  0              3.0439335    
    400000   18720          200            200            3.2514003e-07  6.9042395e-35  0              9.7542009e-07  0.16077201     0              7763.1048      1.1971759e-13  0              3.0055712    
    500000   18720          200            200            0.00056537476  1.0716219e-05  0              0.0016854081   390.70186      0              18865595       1.1971759e-13  0              2.9971145    
    600000   18720          200            200            0.003484284    0.00017203184  0              0.01028082     158.80316      0              7668036.3      1.1971759e-13  0              2.9934731    
    700000   18720          200            200            0.0030569495   0.00014994969  0              0.0090208988   6.0057213      0              289994.79      1.1971759e-13  0              2.99391      
    800000   18720          200            200            0.0027583365   0.00014687523  0              0.0081281342   6.182897       0              298549.97      1.1971759e-13  0              2.9942224    
    900000   18720          200            200            0.0026907977   0.000146096    0              0.0079262972   0.66037109     0              31886.956      1.1971759e-13  0              2.994293     
   1000000   18720          200            200            0.002698546    0.00014619842  0              0.0079494395   0.0019794508   0              95.580595      1.1971759e-13  0              2.9942839    
   1100000   18720          200            200            0.0027112351   0.00014635195  0              0.0079873534   0.0078576847   0              379.41947      1.1971759e-13  0              2.9942701    
   1200000   18720          200            200            0.0027161106   0.00014640949  0              0.0080019223   0.0022327735   0              107.81264      1.1971759e-13  0              2.994265     
   1300000   18720          200            200            0.0027166721   0.00014641574  0              0.0080036006   0.00010140923  0              4.8966888      1.1971759e-13  0              2.9942644    
   1400000   18720          200            200            0.0027162777   0.00014641092  0              0.0080024221   2.7799332e-06  0              0.13423303     1.1971759e-13  0              2.9942648    
   1500000   18720          200            200            0.0027160186   0.00014640784  0              0.0080016479   4.5377043e-06  0              0.2191095      1.1971759e-13  0              2.9942651    
   1600000   18720          200            200            0.0027159511   0.00014640705  0              0.0080014461   5.8869499e-07  0              0.028425974    1.1971759e-13  0              2.9942652    
   1700000   18720          200            200            0.0027159545   0.0001464071   0              0.0080014563   4.9925786e-09  0              0.00024107375  1.1971759e-13  0              2.9942652    
   1800000   18720          200            200            0.0027159651   0.00014640723  0              0.0080014881   4.9409007e-09  0              0.00023857841  1.1971759e-13  0              2.9942652    
   1900000   18720          200            200            0.0027159696   0.00014640728  0              0.0080015016   1.7823674e-09  0              8.6064143e-05  1.1971759e-13  0              2.9942652    
   2000000   18720          200            200            0.0027159703   0.00014640729  0              0.0080015036   1.039915e-10   0              5.0213772e-06  1.1971759e-13  0              2.9942652    
   2100000   18720          200            200            0.00271597     0.00014640729  0              0.0080015027   8.6710271e-13  0              4.1869287e-08  1.1971759e-13  0              2.9942652    
   2200000   18720          200            200            0.0027159698   0.00014640728  0              0.008001502    3.2583664e-12  0              1.5733485e-07  1.1971759e-13  0              2.9942652    
   2300000   18720          200            200            0.0027159697   0.00014640728  0              0.0080015018   5.1072375e-13  0              2.4661022e-08  1.1971759e-13  0              2.9942652    
   2400000   18720          200            200            0.0027159697   0.00014640728  0              0.0080015018   8.0459342e-15  0              3.8850937e-10  1.1971759e-13  0              2.9942652    
   2500000   18720          200            200            0.0027159697   0.00014640728  0              0.0080015019   3.1191794e-15  0              1.5061401e-10  1.1971759e-13  0              2.9942652    
   2600000   18720          200            200            0.0027159697   0.00014640728  0              0.0080015019   1.4020021e-15  0              6.7697665e-11  1.1971759e-13  0              2.9942652    
   2700000   18720          200            200            0.0027159697   0.00014640728  0              0.0080015019   1.3174225e-16  0              6.3613618e-12  1.1971759e-13  0              2.9942652    
   2800000   18720          200            200            0.0027159697   0.00014640728  0              0.0080015019   4.9292614e-18  0              2.3801639e-13  1.1971759e-13  0              2.9942652    
   2900000   18720          200            200            0.0027159697   0.00014640728  0              0.0080015019   3.4322985e-18  0              1.6573341e-13  1.1971759e-13  0              2.9942652    
   3000000   18720          200            200            0.0027159697   0.00014640728  0              0.0080015019   4.0467534e-18  0              1.9540324e-13  1.1971759e-13  0              2.9942652    
Loop time of 725.281 on 2 procs for 3000000 steps with 5001 atoms

Performance: 3573785.113 ns/day, 0.000 hours/ns, 4136.325 timesteps/s
99.9% CPU use with 2 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 158.47     | 160.68     | 162.89     |  17.4 | 22.15
Neigh   | 23.124     | 23.128     | 23.131     |   0.1 |  3.19
Comm    | 52.186     | 54.386     | 56.585     |  29.8 |  7.50
Output  | 0.64423    | 0.64424    | 0.64424    |   0.0 |  0.09
Modify  | 428.4      | 428.45     | 428.5      |   0.2 | 59.07
Other   |            | 57.99      |            |       |  8.00

Nlocal:         2500.5 ave        2501 max        2500 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Nghost:            2.5 ave           3 max           2 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Neighs:         1250.5 ave        1251 max        1250 min
Histogram: 1 0 0 0 0 0 0 0 0 1

Total # of neighbors = 2501
Ave neighs/atom = 0.50009998
Neighbor list builds = 166
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 25

#variable lat0 equal 1                    #
variable lat1 equal 3+((300)*0.01)+(v_ind*0.01)        # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 1000*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 6.25                                                               
Lattice spacing in x,y,z = 6.25 6.25 6.25

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -9375 ${n1e1} -100 100 -100 100 units box
region box block -9375 9375 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -9375 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -9375 9375 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-9375 -100 -100) to (9375 100 100)
  2 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 3000 atoms
  using lattice units in orthogonal box = (-9375 -100 -100) to (9375 100 100)
  create_atoms CPU = 0.002 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 3000 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 2001 atoms
  using lattice units in orthogonal box = (-9375 -100 -100) to (9375 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  3000 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  3000 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  2001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  2001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
3000 atoms in group substrate
group slider1 region slider1
2001 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 2001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_25_*.dump id type diameter mass xu yu zu fx fy fz
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 12097 130 130
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 433.9 | 433.9 | 433.9 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   18750          200            200            0              0              0              0              0              0              0              1.1971759e-13  0              6            
    100000   18750          200            200            0.0021510311   6.7316132e-38  0              0.0064530934   1156088.9      0              5.5823397e+10  1.1971759e-13  0              3.3317251    
    200000   18750          200            200            0.00073101873 -1.723292e-35   0              0.0021930562   263845         0              1.2740131e+10  1.1971759e-13  0              3.0824397    
    300000   18750          200            200            2.2321289e-06  5.4196749e-41  0              6.6963866e-06  5.7108571      0              275756.85      1.1971759e-13  0              3.0438572    
    400000   18750          200            200           -5.1398665e-05  3.4465928e-35  0             -0.00015419599  3322.0986      0              1.6041225e+08  1.1971759e-13  0              3.0039469    
    500000   18750          200            200            0.00096216991 -6.8931678e-35  0              0.0028865097   892.63761      0              43102275       1.1971759e-13  0              2.9972457    
    600000   18750          200            200            0.0019176294   1.7232968e-35  0              0.0057528883   60.004531      0              2897404        1.1971759e-13  0              2.9957066    
    700000   18750          200            200            0.0023756459   6.8931758e-35  0              0.0071269376   5.092925       0              245919.12      1.1971759e-13  0              2.9950623    
    800000   18750          200            200            0.0026204255  -3.4465821e-35  0              0.0078612766   5.4956656      0              265366.02      1.1971759e-13  0              2.9947281    
    900000   18750          200            200            0.002681931    2.5849424e-35  0              0.0080457929   0.70344538     0              33966.86       1.1971759e-13  0              2.9946439    
   1000000   18750          200            200            0.0026780546   3.446589e-35   0              0.0080341639   0.007990738    0              385.84414      1.1971759e-13  0              2.9946481    
   1100000   18750          200            200            0.002667891    4.3082356e-35  0              0.0080036731   0.0048522133   0              234.29602      1.1971759e-13  0              2.9946615    
   1200000   18750          200            200            0.002663507    1.7232962e-35  0              0.0079905209   0.002089389    0              100.88912      1.1971759e-13  0              2.9946674    
   1300000   18750          200            200            0.0026627547   1.292473e-35   0              0.007988264    0.00016200343  0              7.8225657      1.1971759e-13  0              2.9946684    
   1400000   18750          200            200            0.002662981   -1.2924664e-35  0              0.0079889429   1.3174167e-12  0              6.3613339e-08  1.1971759e-13  0              2.9946681    
   1500000   18750          200            200            0.0026631917  -1.7232897e-35  0              0.0079895751   2.9350393e-06  0              0.14172255     1.1971759e-13  0              2.9946679    
   1600000   18750          200            200            0.0026632632   4.3082649e-36  0              0.0079897895   6.8669438e-07  0              0.033158014    1.1971759e-13  0              2.9946678    
   1700000   18750          200            200            0.0026632693   2.1541487e-36  0              0.007989808    2.8928123e-08  0              0.0013968355   1.1971759e-13  0              2.9946677    
   1800000   18750          200            200            0.0026632627   3.2603593e-41  0              0.0079897881   8.5963858e-10  0              4.150887e-05   1.1971759e-13  0              2.9946678    
   1900000   18750          200            200            0.0026632587  -2.1540837e-36  0              0.007989776    1.3748705e-09  0              6.6387578e-05  1.1971759e-13  0              2.9946678    
   2000000   18750          200            200            0.0026632576  -2.5579805e-36  0              0.0079897728   1.9556393e-10  0              9.443082e-06   1.1971759e-13  0              2.9946678    
   2100000   18750          200            200            0.0026632576   2.1541487e-36  0              0.0079897729   3.135337e-12   0              1.513942e-07   1.1971759e-13  0              2.9946678    
   2200000   18750          200            200            0.0026632578   1.0770906e-36  0              0.0079897734   1.0530368e-12  0              5.084738e-08   1.1971759e-13  0              2.9946678    
   2300000   18750          200            200            0.0026632579   1.0770613e-35  0              0.0079897736   5.3960228e-13  0              2.6055463e-08  1.1971759e-13  0              2.9946678    
   2400000   18750          200            200            0.0026632579   1.7232962e-35  0              0.0079897736   4.7301524e-14  0              2.2840213e-09  1.1971759e-13  0              2.9946678    
   2500000   18750          200            200            0.0026632579  -2.3264451e-34  0              0.0079897736   5.8504884e-17  0              2.8249915e-12  1.1971759e-13  0              2.9946678    
   2600000   18750          200            200            0.0026632579   2.1541194e-35  0              0.0079897736   6.9622069e-16  0              3.3618005e-11  1.1971759e-13  0              2.9946678    
   2700000   18750          200            200            0.0026632579  -4.3081998e-36  0              0.0079897736   1.6094063e-16  0              7.7712472e-12  1.1971759e-13  0              2.9946678    
   2800000   18750          200            200            0.0026632579  -2.5849362e-35  0              0.0079897736   8.57017e-19    0              4.1382284e-14  1.1971759e-13  0              2.9946678    
   2900000   18750          200            200            0.0026632579   8.6164968e-36  0              0.0079897736   6.3519929e-18  0              3.06715e-13    1.1971759e-13  0              2.9946678    
   3000000   18750          200            200            0.0026632579   8.6164972e-36  0              0.0079897736   1.8071911e-18  0              8.726279e-14   1.1971759e-13  0              2.9946678    
Loop time of 720.561 on 2 procs for 3000000 steps with 5001 atoms

Performance: 3597198.256 ns/day, 0.000 hours/ns, 4163.424 timesteps/s
100.0% CPU use with 2 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 156.94     | 158.05     | 159.17     |   8.9 | 21.93
Neigh   | 23.11      | 23.112     | 23.114     |   0.0 |  3.21
Comm    | 52.528     | 53.721     | 54.913     |  16.3 |  7.46
Output  | 0.60108    | 0.6011     | 0.60112    |   0.0 |  0.08
Modify  | 426.58     | 426.72     | 426.86     |   0.7 | 59.22
Other   |            | 58.35      |            |       |  8.10

Nlocal:         2500.5 ave        2501 max        2500 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Nghost:            2.5 ave           3 max           2 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Neighs:         1280.5 ave        1281 max        1280 min
Histogram: 1 0 0 0 0 0 0 0 0 1

Total # of neighbors = 2561
Ave neighs/atom = 0.51209758
Neighbor list builds = 166
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 26

#variable lat0 equal 1                    #
variable lat1 equal 3+((300)*0.01)+(v_ind*0.01)        # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 1000*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 6.26                                                               
Lattice spacing in x,y,z = 6.26 6.26 6.26

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -9390 ${n1e1} -100 100 -100 100 units box
region box block -9390 9390 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -9390 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -9390 9390 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-9390 -100 -100) to (9390 100 100)
  2 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 3000 atoms
  using lattice units in orthogonal box = (-9390 -100 -100) to (9390 100 100)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 3000 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 2001 atoms
  using lattice units in orthogonal box = (-9390 -100 -100) to (9390 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  3000 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  3000 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  2001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  2001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
3000 atoms in group substrate
group slider1 region slider1
2001 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 2001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_26_*.dump id type diameter mass xu yu zu fx fy fz
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 12117 130 130
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 434.6 | 434.6 | 434.6 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   18780          200            200            0              0              0              0              0              0              0              1.1971759e-13  0              6            
    100000   18780          200            200            0.0021477487   1.3942726e-41  0              0.0064432462   1156265.6      0              5.5831925e+10  1.1971759e-13  0              3.3314616    
    200000   18780          200            200            0.0007286908  -1.0323203e-34  0              0.0021860724   263190.41      0              1.2708523e+10  1.1971759e-13  0              3.0826646    
    300000   18780          200            200           -3.0183202e-06 -1.7205323e-35  0             -9.0549607e-06  9.7300572      0              469829.64      1.1971759e-13  0              3.0438952    
    400000   18780          200            200           -1.6746285e-06  2.908978e-43   0             -5.0238856e-06  2.9776972      0              143782.34      1.1971759e-13  0              3.0055586    
    500000   18780          200            200            0.00058999504 -0.00011567659  0              0.0018856617   309.09508      0              14925095       1.1971759e-13  0              2.9971228    
    600000   18780          200            200            0.0034515501  -0.00029353244  0              0.010648183    83.03941       0              4009675.9      1.1971759e-13  0              2.9932499    
    700000   18780          200            200            0.0019990229  -0.0011340312   0              0.0071311      16.361432      0              790034.98      1.1971759e-13  0              2.9944763    
    800000   18780          200            200            0.0022792056  -0.00096718797  0              0.0078048047   5.5097401      0              266045.63      1.1971759e-13  0              2.9942151    
    900000   18780          200            200            0.0023828783  -0.00096097376  0              0.0081096086   0.08950261     0              4321.7607      1.1971759e-13  0              2.9941058    
   1000000   18780          200            200            0.0023410136  -0.00096319366  0              0.0079862345   0.11813725     0              5704.4251      1.1971759e-13  0              2.9941514    
   1100000   18780          200            200            0.0023309901  -0.00096377247  0              0.0079567427   0.00010031755  0              4.8439753      1.1971759e-13  0              2.9941618    
   1200000   18780          200            200            0.0023374953  -0.00096337816  0              0.0079758642   0.00221764     0              107.0819       1.1971759e-13  0              2.9941547    
   1300000   18780          200            200            0.0023382777  -0.00096333479  0              0.007978168    7.644602e-06   0              0.36913047     1.1971759e-13  0              2.9941539    
   1400000   18780          200            200            0.0023373345  -0.0009633907   0              0.0079753941   3.7110707e-05  0              1.7919432      1.1971759e-13  0              2.994155     
   1500000   18780          200            200            0.0023373116  -0.00096339165  0              0.0079753266   8.1673445e-07  0              0.039437184    1.1971759e-13  0              2.994155     
   1600000   18780          200            200            0.0023374405  -0.00096338403  0              0.0079757055   5.4816511e-07  0              0.026468931    1.1971759e-13  0              2.9941548    
   1700000   18780          200            200            0.0023374323  -0.00096338457  0              0.0079756815   3.4667004e-08  0              0.0016739456   1.1971759e-13  0              2.9941549    
   1800000   18780          200            200            0.0023374157  -0.00096338555  0              0.0079756326   6.9413935e-09  0              0.00033517505  1.1971759e-13  0              2.9941549    
   1900000   18780          200            200            0.0023374182  -0.00096338539  0              0.0079756401   1.0442878e-09  0              5.042492e-05   1.1971759e-13  0              2.9941549    
   2000000   18780          200            200            0.0023374203  -0.00096338527  0              0.007975646    7.0278336e-11  0              3.3934893e-06  1.1971759e-13  0              2.9941549    
   2100000   18780          200            200            0.0023374197  -0.0009633853   0              0.0079756445   2.5784755e-11  0              1.2450535e-06  1.1971759e-13  0              2.9941549    
   2200000   18780          200            200            0.0023374195  -0.00096338532  0              0.0079756439   4.6795732e-13  0              2.2595984e-08  1.1971759e-13  0              2.9941549    
   2300000   18780          200            200            0.0023374196  -0.00096338531  0              0.0079756441   5.5146826e-13  0              2.6628429e-08  1.1971759e-13  0              2.9941549    
   2400000   18780          200            200            0.0023374196  -0.00096338531  0              0.0079756442   7.3368493e-16  0              3.5427019e-11  1.1971759e-13  0              2.9941549    
   2500000   18780          200            200            0.0023374196  -0.00096338531  0              0.0079756441   1.0433274e-14  0              5.0378546e-10  1.1971759e-13  0              2.9941549    
   2600000   18780          200            200            0.0023374196  -0.00096338531  0              0.0079756441   1.5492818e-17  0              7.4809275e-13  1.1971759e-13  0              2.9941549    
   2700000   18780          200            200            0.0023374196  -0.00096338531  0              0.0079756441   1.8696574e-16  0              9.0279065e-12  1.1971759e-13  0              2.9941549    
   2800000   18780          200            200            0.0023374196  -0.00096338531  0              0.0079756441   1.7811816e-18  0              8.6006885e-14  1.1971759e-13  0              2.9941549    
   2900000   18780          200            200            0.0023374196  -0.00096338531  0              0.0079756441   9.4030771e-18  0              4.5404094e-13  1.1971759e-13  0              2.9941549    
   3000000   18780          200            200            0.0023374196  -0.00096338531  0              0.0079756441   7.5905303e-18  0              3.6651954e-13  1.1971759e-13  0              2.9941549    
Loop time of 725.312 on 2 procs for 3000000 steps with 5001 atoms

Performance: 3573633.537 ns/day, 0.000 hours/ns, 4136.150 timesteps/s
100.0% CPU use with 2 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 161.02     | 163.65     | 166.28     |  20.6 | 22.56
Neigh   | 23.185     | 23.188     | 23.192     |   0.1 |  3.20
Comm    | 52.3       | 54.854     | 57.408     |  34.5 |  7.56
Output  | 0.65093    | 0.65095    | 0.65096    |   0.0 |  0.09
Modify  | 425.1      | 425.12     | 425.15     |   0.1 | 58.61
Other   |            | 57.85      |            |       |  7.98

Nlocal:         2500.5 ave        2501 max        2500 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Nghost:            2.5 ave           3 max           2 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Neighs:         1252.5 ave        1253 max        1252 min
Histogram: 1 0 0 0 0 0 0 0 0 1

Total # of neighbors = 2505
Ave neighs/atom = 0.50089982
Neighbor list builds = 166
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 27

#variable lat0 equal 1                    #
variable lat1 equal 3+((300)*0.01)+(v_ind*0.01)        # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 1000*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 6.27                                                               
Lattice spacing in x,y,z = 6.27 6.27 6.27

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -9405 ${n1e1} -100 100 -100 100 units box
region box block -9405 9405 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -9405 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -9405 9405 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-9405 -100 -100) to (9405 100 100)
  2 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 3000 atoms
  using lattice units in orthogonal box = (-9405 -100 -100) to (9405 100 100)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 3000 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 2001 atoms
  using lattice units in orthogonal box = (-9405 -100 -100) to (9405 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  3000 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  3000 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  2001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  2001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
3000 atoms in group substrate
group slider1 region slider1
2001 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 2001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_27_*.dump id type diameter mass xu yu zu fx fy fz
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 12136 130 130
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 435.2 | 435.2 | 435.2 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   18810          200            200            0              0              0              0              0              0              0              1.1971759e-13  0              6            
    100000   18810          200            200            0.0021445034  -3.4355521e-35  0              0.0064335101   1156407.1      0              5.5838759e+10  1.1971759e-13  0              3.3314204    
    200000   18810          200            200            0.00072776535 -3.4355496e-35  0              0.002183296    263320.33      0              1.2714796e+10  1.1971759e-13  0              3.0826622    
    300000   18810          200            200           -2.2032075e-06  1.3742385e-34  0             -6.6096225e-06  5.1229879      0              247370.75      1.1971759e-13  0              3.0439621    
    400000   18810          200            200            4.2985901e-06  1.7177971e-34  0              1.289577e-05   21.26802       0              1026956.6      1.1971759e-13  0              3.0055847    
    500000   18810          200            200            0.00091545179  0.0011068895   0              0.0016394658   8.5067242      0              410759.27      1.1971759e-13  0              2.9973283    
    600000   18810          200            200            0.0045067364   0.0029897695   0              0.01053044     106.72734      0              5153481.2      1.1971759e-13  0              2.9932788    
    700000   18810          200            200            0.0039890343   0.003272979    0              0.0086941239   28.079128      0              1355840.6      1.1971759e-13  0              2.9938992    
    800000   18810          200            200            0.0037360459   0.0033026817   0              0.007905456    6.6768629      0              322401.82      1.1971759e-13  0              2.9941747    
    900000   18810          200            200            0.0037089339   0.0032822199   0              0.0078445817   0.27228011     0              13147.432      1.1971759e-13  0              2.9941946    
   1000000   18810          200            200            0.0037323747   0.0032847885   0              0.0079123355   0.0078982275   0              381.37714      1.1971759e-13  0              2.9941695    
   1100000   18810          200            200            0.0037467523   0.0032863764   0              0.0079538806   0.013022834    0              628.82603      1.1971759e-13  0              2.9941545    
   1200000   18810          200            200            0.0037506921   0.0032868092   0              0.007965267    0.0019666498   0              94.96248       1.1971759e-13  0              2.9941505    
   1300000   18810          200            200            0.0037506986   0.003286806    0              0.0079652899   4.2653065e-05  0              2.0595638      1.1971759e-13  0              2.9941505    
   1400000   18810          200            200            0.003750172    0.003286746    0              0.00796377     7.5134662e-06  0              0.3627984      1.1971759e-13  0              2.994151     
   1500000   18810          200            200            0.0037499114   0.0032867169   0              0.0079630172   4.9757398e-06  0              0.24026067     1.1971759e-13  0              2.9941513    
   1600000   18810          200            200            0.0037498536   0.0032867106   0              0.0079628501   5.3582651e-07  0              0.025873145    1.1971759e-13  0              2.9941514    
   1700000   18810          200            200            0.0037498601   0.0032867114   0              0.0079628689   3.746451e-09   0              0.00018090271  1.1971759e-13  0              2.9941514    
   1800000   18810          200            200            0.0037498711   0.0032867126   0              0.0079629007   4.6561329e-09  0              0.00022482799  1.1971759e-13  0              2.9941514    
   1900000   18810          200            200            0.0037498756   0.0032867131   0              0.0079629138   1.7555319e-09  0              8.4768353e-05  1.1971759e-13  0              2.9941514    
   2000000   18810          200            200            0.0037498764   0.0032867132   0              0.007962916    1.3217318e-10  0              6.38217e-06    1.1971759e-13  0              2.9941514    
   2100000   18810          200            200            0.0037498762   0.0032867132   0              0.0079629153   1.462214e-15   0              7.060508e-11   1.1971759e-13  0              2.9941514    
   2200000   18810          200            200            0.003749876    0.0032867132   0              0.0079629147   2.3323804e-12  0              1.126223e-07   1.1971759e-13  0              2.9941514    
   2300000   18810          200            200            0.0037498759   0.0032867132   0              0.0079629145   5.7608356e-13  0              2.7817013e-08  1.1971759e-13  0              2.9941514    
   2400000   18810          200            200            0.0037498759   0.0032867132   0              0.0079629145   2.8609209e-14  0              1.3814363e-09  1.1971759e-13  0              2.9941514    
   2500000   18810          200            200            0.0037498759   0.0032867132   0              0.0079629145   4.1840867e-16  0              2.0203457e-11  1.1971759e-13  0              2.9941514    
   2600000   18810          200            200            0.0037498759   0.0032867132   0              0.0079629145   1.0434934e-15  0              5.0386562e-11  1.1971759e-13  0              2.9941514    
   2700000   18810          200            200            0.0037498759   0.0032867132   0              0.0079629145   1.8680082e-16  0              9.0199431e-12  1.1971759e-13  0              2.9941514    
   2800000   18810          200            200            0.0037498759   0.0032867132   0              0.0079629145   1.7827808e-17  0              8.6084105e-13  1.1971759e-13  0              2.9941514    
   2900000   18810          200            200            0.0037498759   0.0032867132   0              0.0079629145   2.6564119e-18  0              1.2826863e-13  1.1971759e-13  0              2.9941514    
   3000000   18810          200            200            0.0037498759   0.0032867132   0              0.0079629145   6.0825682e-18  0              2.9370545e-13  1.1971759e-13  0              2.9941514    
Loop time of 728.572 on 2 procs for 3000000 steps with 5001 atoms

Performance: 3557643.044 ns/day, 0.000 hours/ns, 4117.642 timesteps/s
100.0% CPU use with 2 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 163.42     | 164.54     | 165.66     |   8.7 | 22.58
Neigh   | 23.082     | 23.086     | 23.089     |   0.1 |  3.17
Comm    | 52.81      | 53.928     | 55.047     |  15.2 |  7.40
Output  | 0.65431    | 0.65433    | 0.65435    |   0.0 |  0.09
Modify  | 428.8      | 428.83     | 428.87     |   0.2 | 58.86
Other   |            | 57.53      |            |       |  7.90

Nlocal:         2500.5 ave        2501 max        2500 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Nghost:            2.5 ave           3 max           2 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Neighs:         1254.5 ave        1255 max        1254 min
Histogram: 1 0 0 0 0 0 0 0 0 1

Total # of neighbors = 2509
Ave neighs/atom = 0.50169966
Neighbor list builds = 166
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 28

#variable lat0 equal 1                    #
variable lat1 equal 3+((300)*0.01)+(v_ind*0.01)        # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 1000*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 6.28                                                               
Lattice spacing in x,y,z = 6.28 6.28 6.28

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -9420 ${n1e1} -100 100 -100 100 units box
region box block -9420 9420 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -9420 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -9420 9420 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-9420 -100 -100) to (9420 100 100)
  2 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 3000 atoms
  using lattice units in orthogonal box = (-9420 -100 -100) to (9420 100 100)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 3000 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 2001 atoms
  using lattice units in orthogonal box = (-9420 -100 -100) to (9420 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  3000 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  3000 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  2001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  2001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
3000 atoms in group substrate
group slider1 region slider1
2001 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 2001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_28_*.dump id type diameter mass xu yu zu fx fy fz
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 12155 130 130
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 435.9 | 435.9 | 435.9 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   18840          200            200            0              0              0              0              0              0              0              1.1971759e-13  0              6            
    100000   18840          200            200            0.0021407633   8.5753041e-36  0              0.0064222898   1156150        0              5.5826345e+10  1.1971759e-13  0              3.3314992    
    200000   18840          200            200            0.00072595455  4.2876581e-36  0              0.0021778637   262953.65      0              1.2697091e+10  1.1971759e-13  0              3.0827642    
    300000   18840          200            200           -3.5035681e-06 -3.4300924e-35  0             -1.0510704e-05  13.275292      0              641016.36      1.1971759e-13  0              3.043868     
    400000   18840          200            200           -8.8174918e-07  3.4301265e-35  0             -2.6452475e-06  0.78144268     0              37733.07       1.1971759e-13  0              3.0055374    
    500000   18840          200            200            0.00074000795  0.00045040122  0              0.0017696226   175.36323      0              8467662.6      1.1971759e-13  0              2.9971823    
    600000   18840          200            200            0.0037583842   0.00053978253  0              0.01073537     50.808639      0              2453367.3      1.1971759e-13  0              2.9931703    
    700000   18840          200            200            0.0023441156  -3.6036533e-07  0              0.007032707    9.5961207      0              463362.33      1.1971759e-13  0              2.9944791    
    800000   18840          200            200            0.0027162906   0.00015081274  0              0.0079980592   6.6464796      0              320934.72      1.1971759e-13  0              2.9941079    
    900000   18840          200            200            0.0027360032   0.00015180727  0              0.0080562023   0.39778713     0              19207.717      1.1971759e-13  0              2.9940899    
   1000000   18840          200            200            0.0026831702   0.00014854382  0              0.0079009669   0.0089630375   0              432.793        1.1971759e-13  0              2.9941466    
   1100000   18840          200            200            0.002701784    0.00014976746  0              0.0079555845   0.015020465    0              725.2845       1.1971759e-13  0              2.9941261    
   1200000   18840          200            200            0.002701457    0.00014973718  0              0.0079546337   0.0013104731   0              63.278055      1.1971759e-13  0              2.9941267    
   1300000   18840          200            200            0.0026990839   0.00014958789  0              0.0079476638   4.1077285e-06  0              0.19834751     1.1971759e-13  0              2.9941292    
   1400000   18840          200            200            0.0027000758   0.00014965172  0              0.0079505757   3.2238338e-05  0              1.556674       1.1971759e-13  0              2.9941281    
   1500000   18840          200            200            0.0026999989   0.00014964635  0              0.0079503503   3.9792057e-06  0              0.1921416      1.1971759e-13  0              2.9941282    
   1600000   18840          200            200            0.0026998962   0.00014963992  0              0.0079500487   1.0857272e-09  0              5.2425881e-05  1.1971759e-13  0              2.9941283    
   1700000   18840          200            200            0.0026999475   0.00014964321  0              0.0079501994   6.509272e-08   0              0.0031430945   1.1971759e-13  0              2.9941283    
   1800000   18840          200            200            0.0026999409   0.00014964276  0              0.0079501798   1.1303067e-08  0              0.00054578466  1.1971759e-13  0              2.9941283    
   1900000   18840          200            200            0.0026999366   0.0001496425   0              0.0079501674   6.629022e-11   0              3.2009175e-06  1.1971759e-13  0              2.9941283    
   2000000   18840          200            200            0.0026999392   0.00014964266  0              0.007950175    1.2206566e-10  0              5.8941137e-06  1.1971759e-13  0              2.9941283    
   2100000   18840          200            200            0.0026999387   0.00014964263  0              0.0079501736   3.0331631e-11  0              1.4646059e-06  1.1971759e-13  0              2.9941283    
   2200000   18840          200            200            0.0026999386   0.00014964262  0              0.0079501731   5.0852122e-13  0              2.455467e-08   1.1971759e-13  0              2.9941283    
   2300000   18840          200            200            0.0026999387   0.00014964263  0              0.0079501735   2.0781932e-13  0              1.0034851e-08  1.1971759e-13  0              2.9941283    
   2400000   18840          200            200            0.0026999387   0.00014964263  0              0.0079501734   7.7193689e-14  0              3.727407e-09   1.1971759e-13  0              2.9941283    
   2500000   18840          200            200            0.0026999387   0.00014964263  0              0.0079501734   2.4505938e-15  0              1.1833041e-10  1.1971759e-13  0              2.9941283    
   2600000   18840          200            200            0.0026999387   0.00014964263  0              0.0079501734   3.2225897e-16  0              1.5560732e-11  1.1971759e-13  0              2.9941283    
   2700000   18840          200            200            0.0026999387   0.00014964263  0              0.0079501734   1.7973675e-16  0              8.6788443e-12  1.1971759e-13  0              2.9941283    
   2800000   18840          200            200            0.0026999387   0.00014964263  0              0.0079501734   2.342053e-21   0              1.1308936e-16  1.1971759e-13  0              2.9941283    
   2900000   18840          200            200            0.0026999387   0.00014964263  0              0.0079501734   6.9093937e-19  0              3.3362989e-14  1.1971759e-13  0              2.9941283    
   3000000   18840          200            200            0.0026999387   0.00014964263  0              0.0079501734   1.7400569e-19  0              8.4021121e-15  1.1971759e-13  0              2.9941283    
Loop time of 726.151 on 2 procs for 3000000 steps with 5001 atoms

Performance: 3569507.120 ns/day, 0.000 hours/ns, 4131.374 timesteps/s
99.9% CPU use with 2 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 162.03     | 163.45     | 164.88     |  11.1 | 22.51
Neigh   | 23.303     | 23.305     | 23.306     |   0.0 |  3.21
Comm    | 52.694     | 54.125     | 55.556     |  19.5 |  7.45
Output  | 0.64234    | 0.64235    | 0.64235    |   0.0 |  0.09
Modify  | 426.62     | 426.65     | 426.68     |   0.1 | 58.76
Other   |            | 57.97      |            |       |  7.98

Nlocal:         2500.5 ave        2501 max        2500 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Nghost:            2.5 ave           3 max           2 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Neighs:         1248.5 ave        1249 max        1248 min
Histogram: 1 0 0 0 0 0 0 0 0 1

Total # of neighbors = 2497
Ave neighs/atom = 0.49930014
Neighbor list builds = 166
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 29

#variable lat0 equal 1                    #
variable lat1 equal 3+((300)*0.01)+(v_ind*0.01)        # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 1000*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 6.29                                                               
Lattice spacing in x,y,z = 6.29 6.29 6.29

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -9435 ${n1e1} -100 100 -100 100 units box
region box block -9435 9435 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -9435 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -9435 9435 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-9435 -100 -100) to (9435 100 100)
  2 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 3000 atoms
  using lattice units in orthogonal box = (-9435 -100 -100) to (9435 100 100)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 3000 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 2001 atoms
  using lattice units in orthogonal box = (-9435 -100 -100) to (9435 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  3000 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  3000 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  2001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  2001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
3000 atoms in group substrate
group slider1 region slider1
2001 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 2001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_29_*.dump id type diameter mass xu yu zu fx fy fz
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 12175 130 130
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 436.6 | 436.6 | 436.6 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   18870          200            200            0              0              0              0              0              0              0              1.1971759e-13  0              6            
    100000   18870          200            200            0.002137678   -3.4246583e-35  0              0.006413034    1156406.3      0              5.583872e+10   1.1971759e-13  0              3.3314041    
    200000   18870          200            200            0.00072559879 -6.4212516e-36  0              0.0021767964   263408.86      0              1.2719071e+10  1.1971759e-13  0              3.0825774    
    300000   18870          200            200           -2.5226045e-06 -1.7123303e-35  0             -7.5678135e-06  6.8074578      0              328707.77      1.1971759e-13  0              3.0439279    
    400000   18870          200            200            3.9112684e-07  6.8493756e-35  0              1.1733805e-06  0.22478705     0              10854.162      1.1971759e-13  0              3.00558      
    500000   18870          200            200            0.0012982384   0.0021544643   0              0.0017402509   139.11614      0              6717420.7      1.1971759e-13  0              2.9972457    
    600000   18870          200            200            0.0047511412   0.0033134449   0              0.010939979    6.9545811      0              335811.83      1.1971759e-13  0              2.9931497    
    700000   18870          200            200            0.0031412205   0.0019536108   0              0.0074700506   40.010734      0              1931975.2      1.1971759e-13  0              2.9943447    
    800000   18870          200            200            0.0032989358   0.0022595198   0              0.0076372877   2.6321361      0              127096.43      1.1971759e-13  0              2.9942734    
    900000   18870          200            200            0.0034516763   0.0023103545   0              0.0080446744   0.37556258     0              18134.573      1.1971759e-13  0              2.9941239    
   1000000   18870          200            200            0.0034218489   0.0023028545   0              0.0079626923   0.094713906    0              4573.3956      1.1971759e-13  0              2.9941549    
   1100000   18870          200            200            0.0034062057   0.002298933    0              0.007919684    0.0014903115   0              71.961808      1.1971759e-13  0              2.9941704    
   1200000   18870          200            200            0.0034124515   0.0023005588   0              0.0079367957   0.0021941311   0              105.94674      1.1971759e-13  0              2.994164     
   1300000   18870          200            200            0.003413673    0.0023008589   0              0.0079401601   2.077366e-06   0              0.10030857     1.1971759e-13  0              2.9941629    
   1400000   18870          200            200            0.0034126602   0.0023005993   0              0.0079373814   3.7157043e-05  0              1.7941806      1.1971759e-13  0              2.9941639    
   1500000   18870          200            200            0.0034126394   0.0023005957   0              0.0079373226   1.1176508e-06  0              0.053967358    1.1971759e-13  0              2.9941639    
   1600000   18870          200            200            0.0034127786   0.0023006312   0              0.0079377046   4.489983e-07   0              0.021680521    1.1971759e-13  0              2.9941638    
   1700000   18870          200            200            0.0034127617   0.0023006266   0              0.0079376584   5.6211372e-08  0              0.002714246    1.1971759e-13  0              2.9941638    
   1800000   18870          200            200            0.0034127454   0.0023006225   0              0.0079376136   3.1964299e-09  0              0.00015434416  1.1971759e-13  0              2.9941638    
   1900000   18870          200            200            0.00341275     0.0023006237   0              0.0079376262   1.591514e-09   0              7.6848514e-05  1.1971759e-13  0              2.9941638    
   2000000   18870          200            200            0.0034127515   0.0023006241   0              0.0079376304   3.8152845e-12  0              1.8422643e-07  1.1971759e-13  0              2.9941638    
   2100000   18870          200            200            0.0034127507   0.0023006239   0              0.0079376281   3.1836043e-11  0              1.5372486e-06  1.1971759e-13  0              2.9941638    
   2200000   18870          200            200            0.0034127506   0.0023006239   0              0.0079376279   2.882286e-13   0              1.3917528e-08  1.1971759e-13  0              2.9941638    
   2300000   18870          200            200            0.0034127507   0.0023006239   0              0.0079376282   4.6660475e-13  0              2.2530674e-08  1.1971759e-13  0              2.9941638    
   2400000   18870          200            200            0.0034127507   0.0023006239   0              0.0079376282   2.8630039e-14  0              1.3824421e-09  1.1971759e-13  0              2.9941638    
   2500000   18870          200            200            0.0034127507   0.0023006239   0              0.0079376282   4.5840045e-15  0              2.2134517e-10  1.1971759e-13  0              2.9941638    
   2600000   18870          200            200            0.0034127507   0.0023006239   0              0.0079376282   1.0189515e-15  0              4.920152e-11   1.1971759e-13  0              2.9941638    
   2700000   18870          200            200            0.0034127507   0.0023006239   0              0.0079376282   5.7431637e-17  0              2.7731682e-12  1.1971759e-13  0              2.9941638    
   2800000   18870          200            200            0.0034127507   0.0023006239   0              0.0079376282   9.596517e-18   0              4.6338146e-13  1.1971759e-13  0              2.9941638    
   2900000   18870          200            200            0.0034127507   0.0023006239   0              0.0079376282   7.8894498e-19  0              3.8095329e-14  1.1971759e-13  0              2.9941638    
   3000000   18870          200            200            0.0034127507   0.0023006239   0              0.0079376282   5.6058466e-18  0              2.7068627e-13  1.1971759e-13  0              2.9941638    
Loop time of 724.071 on 2 procs for 3000000 steps with 5001 atoms

Performance: 3579760.515 ns/day, 0.000 hours/ns, 4143.241 timesteps/s
99.9% CPU use with 2 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 162.28     | 162.85     | 163.41     |   4.4 | 22.49
Neigh   | 23.277     | 23.279     | 23.281     |   0.0 |  3.22
Comm    | 53.337     | 53.948     | 54.558     |   8.3 |  7.45
Output  | 0.64469    | 0.64471    | 0.64473    |   0.0 |  0.09
Modify  | 426.14     | 426.16     | 426.17     |   0.1 | 58.86
Other   |            | 57.2       |            |       |  7.90

Nlocal:         2500.5 ave        2501 max        2500 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Nghost:            2.5 ave           3 max           2 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Neighs:         1250.5 ave        1251 max        1250 min
Histogram: 1 0 0 0 0 0 0 0 0 1

Total # of neighbors = 2501
Ave neighs/atom = 0.50009998
Neighbor list builds = 166
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 30

#variable lat0 equal 1                    #
variable lat1 equal 3+((300)*0.01)+(v_ind*0.01)        # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 1000*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 6.3                                                               
Lattice spacing in x,y,z = 6.3 6.3 6.3

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -9450 ${n1e1} -100 100 -100 100 units box
region box block -9450 9450 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -9450 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -9450 9450 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-9450 -100 -100) to (9450 100 100)
  2 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 3000 atoms
  using lattice units in orthogonal box = (-9450 -100 -100) to (9450 100 100)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 3000 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 2001 atoms
  using lattice units in orthogonal box = (-9450 -100 -100) to (9450 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  3000 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  3000 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  2001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  2001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
3000 atoms in group substrate
group slider1 region slider1
2001 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 2001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_30_*.dump id type diameter mass xu yu zu fx fy fz
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 12194 130 130
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 437.3 | 437.3 | 437.3 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   18900          200            200            0              0              0              0              0              0              0              1.1971759e-13  0              6            
    100000   18900          200            200            0.0021340523   1.6468651e-41  0              0.0064021569   1156191.2      0              5.5828333e+10  1.1971759e-13  0              3.3315858    
    200000   18900          200            200            0.00072678245 -1.0685098e-36  0              0.0021803474   264789.39      0              1.2785732e+10  1.1971759e-13  0              3.0815142    
    300000   18900          200            200           -1.8551037e-05  3.4192388e-35  0             -5.5653111e-05  396.14238      0              19128298       1.1971759e-13  0              3.0435622    
    400000   18900          200            200            0.00038417792 -1.7096094e-35  0              0.0011525338   15391.532      0              7.43202e+08    1.1971759e-13  0              2.9984494    
    500000   18900          200            200            0.0019881138   3.4192363e-35  0              0.0059643415   2557.9042      0              1.2351204e+08  1.1971759e-13  0              2.9961009    
    600000   18900          200            200            0.0018386365  -1.709612e-35   0              0.0055159096   54.01391       0              2608138.4      1.1971759e-13  0              2.9962456    
    700000   18900          200            200            0.0023154821  -1.7096122e-35  0              0.0069464463   0.21846476     0              10548.881      1.1971759e-13  0              2.9956107    
    800000   18900          200            200            0.0025230013   4.2740434e-35  0              0.007569004    0.2346423      0              11330.037      1.1971759e-13  0              2.9953508    
    900000   18900          200            200            0.002601752   -2.5644213e-35  0              0.0078052559   0.15930286     0              7692.1649      1.1971759e-13  0              2.9952546    
   1000000   18900          200            200            0.0026296274   1.9553083e-41  0              0.0078888823   0.04782093     0              2309.1016      1.1971759e-13  0              2.9952209    
   1100000   18900          200            200            0.0026388565  -8.5480662e-36  0              0.0079165696   0.010413951    0              502.85241      1.1971759e-13  0              2.9952098    
   1200000   18900          200            200            0.0026416769  -4.2740274e-36  0              0.0079250306   0.0018727249   0              90.427186      1.1971759e-13  0              2.9952065    
   1300000   18900          200            200            0.002642444    1.2041894e-41  0              0.0079273321   0.00029240785  0              14.119328      1.1971759e-13  0              2.9952056    
   1400000   18900          200            200            0.0026426111   8.5480923e-36  0              0.0079278333   4.0452179e-05  0              1.9532909      1.1971759e-13  0              2.9952054    
   1500000   18900          200            200            0.0026426269  -4.2740277e-36  0              0.0079278807   4.9753806e-06  0              0.24024332     1.1971759e-13  0              2.9952054    
   1600000   18900          200            200            0.0026426157  -1.2822108e-35  0              0.007927847    5.3788065e-07  0              0.025972332    1.1971759e-13  0              2.9952054    
   1700000   18900          200            200            0.0026426055   1.2342491e-41  0              0.0079278166   4.9458614e-08  0              0.0023881795   1.1971759e-13  0              2.9952054    
   1800000   18900          200            200            0.0026425998  -3.2055177e-36  0              0.0079277995   3.5717117e-09  0              0.00017246518  1.1971759e-13  0              2.9952054    
   1900000   18900          200            200            0.0026425971  -5.3424262e-37  0              0.0079277914   1.6017517e-10  0              7.7342858e-06  1.1971759e-13  0              2.9952054    
   2000000   18900          200            200            0.002642596   -3.3378594e-38  0              0.007927788    9.5096991e-13  0              4.5918933e-08  1.1971759e-13  0              2.9952054    
   2100000   18900          200            200            0.0026425955   1.0685224e-36  0              0.0079277866   1.016671e-12   0              4.9091406e-08  1.1971759e-13  0              2.9952054    
   2200000   18900          200            200            0.0026425953  -1.0684976e-36  0              0.007927786    7.2166522e-13  0              3.4846631e-08  1.1971759e-13  0              2.9952054    
   2300000   18900          200            200            0.0026425953   5.3425624e-36  0              0.0079277859   2.2097408e-13  0              1.0670048e-08  1.1971759e-13  0              2.9952054    
   2400000   18900          200            200            0.0026425953   1.2358371e-41  0              0.0079277858   4.861369e-14   0              2.3473811e-09  1.1971759e-13  0              2.9952054    
   2500000   18900          200            200            0.0026425953  -2.1370077e-36  0              0.0079277858   8.7916927e-15  0              4.2451938e-10  1.1971759e-13  0              2.9952054    
   2600000   18900          200            200            0.0026425953   3.2055313e-35  0              0.0079277858   1.3699491e-15  0              6.614994e-11   1.1971759e-13  0              2.9952054    
   2700000   18900          200            200            0.0026425953  -4.2740277e-36  0              0.0079277858   1.8255484e-16  0              8.8149198e-12  1.1971759e-13  0              2.9952054    
   2800000   18900          200            200            0.0026425953  -2.1370188e-35  0              0.0079277858   2.5095416e-17  0              1.2117678e-12  1.1971759e-13  0              2.9952054    
   2900000   18900          200            200            0.0026425953   2.1370212e-35  0              0.0079277858   3.6660684e-20  0              1.7702132e-15  1.1971759e-13  0              2.9952054    
   3000000   18900          200            200            0.0026425953  -7.6932708e-35  0              0.0079277858   1.6533518e-18  0              7.983444e-14   1.1971759e-13  0              2.9952054    
Loop time of 721.405 on 2 procs for 3000000 steps with 5001 atoms

Performance: 3592987.322 ns/day, 0.000 hours/ns, 4158.550 timesteps/s
99.9% CPU use with 2 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 157.28     | 158.16     | 159.04     |   7.0 | 21.92
Neigh   | 23.163     | 23.166     | 23.169     |   0.1 |  3.21
Comm    | 52.775     | 53.609     | 54.442     |  11.4 |  7.43
Output  | 0.64217    | 0.64218    | 0.64219    |   0.0 |  0.09
Modify  | 426.7      | 426.81     | 426.92     |   0.5 | 59.16
Other   |            | 59.02      |            |       |  8.18

Nlocal:         2500.5 ave        2501 max        2500 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Nghost:            2.5 ave           3 max           2 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Neighs:         1237.5 ave        1238 max        1237 min
Histogram: 1 0 0 0 0 0 0 0 0 1

Total # of neighbors = 2475
Ave neighs/atom = 0.49490102
Neighbor list builds = 166
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 31

#variable lat0 equal 1                    #
variable lat1 equal 3+((300)*0.01)+(v_ind*0.01)        # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 1000*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 6.31                                                               
Lattice spacing in x,y,z = 6.31 6.31 6.31

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -9465 ${n1e1} -100 100 -100 100 units box
region box block -9465 9465 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -9465 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -9465 9465 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-9465 -100 -100) to (9465 100 100)
  2 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 3000 atoms
  using lattice units in orthogonal box = (-9465 -100 -100) to (9465 100 100)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 3000 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 2001 atoms
  using lattice units in orthogonal box = (-9465 -100 -100) to (9465 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  3000 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  3000 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  2001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  2001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
3000 atoms in group substrate
group slider1 region slider1
2001 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 2001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_31_*.dump id type diameter mass xu yu zu fx fy fz
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 12213 130 130
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 438 | 438 | 438 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   18930          200            200            0              0              0              0              0              0              0              1.1971759e-13  0              6            
    100000   18930          200            200            0.0021307472   1.1271774e-41  0              0.0063922417   1156280        0              5.5832622e+10  1.1971759e-13  0              3.3314541    
    200000   18930          200            200            0.00072292895 -1.8775969e-34  0              0.0021687868   263197.19      0              1.270885e+10   1.1971759e-13  0              3.0826643    
    300000   18930          200            200           -2.9435028e-06  3.4138256e-35  0             -8.8305084e-06  9.3951693      0              453659.1       1.1971759e-13  0              3.0438995    
    400000   18930          200            200           -4.7763939e-07  2.0331735e-45  0             -1.4329182e-06  0.20710277     0              10000.252      1.1971759e-13  0              3.0055595    
    500000   18930          200            200            0.00072279813  0.00038554735  0              0.001782847    190.6415       0              9205395.8      1.1971759e-13  0              2.9971941    
    600000   18930          200            200            0.0034730442  -0.0004229044   0              0.010842037    22.425745      0              1082859        1.1971759e-13  0              2.9931521    
    700000   18930          200            200            0.0020354249  -0.0012289741   0              0.0073352487   34.325541      0              1657457.5      1.1971759e-13  0              2.9943672    
    800000   18930          200            200            0.0022236489  -0.00098256878  0              0.0076535155   3.6963012      0              178481.16      1.1971759e-13  0              2.9942386    
    900000   18930          200            200            0.0023591203  -0.0009575041   0              0.008034865    0.20827847     0              10057.022      1.1971759e-13  0              2.9940989    
   1000000   18930          200            200            0.0023220124  -0.00096014716  0              0.0079261845   0.11446007     0              5526.8671      1.1971759e-13  0              2.9941396    
   1100000   18930          200            200            0.0023108747  -0.00096101312  0              0.0078936373   1.4735572e-05  0              0.71152801     1.1971759e-13  0              2.9941513    
   1200000   18930          200            200            0.0023177645  -0.00096045119  0              0.0079137446   0.0021290809   0              102.8057       1.1971759e-13  0              2.9941438    
   1300000   18930          200            200            0.0023180969  -0.00096042898  0              0.0079147198   5.3347966e-05  0              2.5759823      1.1971759e-13  0              2.9941435    
   1400000   18930          200            200            0.0023171141  -0.00096050696  0              0.0079118493   2.4677683e-05  0              1.191597       1.1971759e-13  0              2.9941446    
   1500000   18930          200            200            0.002317236   -0.00096049671  0              0.0079122047   3.3275873e-06  0              0.16067728     1.1971759e-13  0              2.9941444    
   1600000   18930          200            200            0.0023173475  -0.00096048794  0              0.0079125306   1.288525e-07   0              0.0062218259   1.1971759e-13  0              2.9941443    
   1700000   18930          200            200            0.0023173122  -0.0009604908   0              0.0079124275   9.3740657e-08  0              0.0045264008   1.1971759e-13  0              2.9941444    
   1800000   18930          200            200            0.0023173032  -0.0009604915   0              0.0079124012   1.3044915e-11  0              6.2989228e-07  1.1971759e-13  0              2.9941444    
   1900000   18930          200            200            0.0023173095  -0.000960491    0              0.0079124195   1.6455664e-09  0              7.945851e-05   1.1971759e-13  0              2.9941444    
   2000000   18930          200            200            0.0023173096  -0.00096049099  0              0.0079124199   5.4185356e-11  0              2.6164169e-06  1.1971759e-13  0              2.9941444    
   2100000   18930          200            200            0.0023173088  -0.00096049106  0              0.0079124174   1.7706554e-11  0              8.5498614e-07  1.1971759e-13  0              2.9941444    
   2200000   18930          200            200            0.0023173089  -0.00096049105  0              0.0079124178   2.8995367e-12  0              1.4000825e-07  1.1971759e-13  0              2.9941444    
   2300000   18930          200            200            0.002317309   -0.00096049104  0              0.007912418    7.6915133e-14  0              3.7139565e-09  1.1971759e-13  0              2.9941444    
   2400000   18930          200            200            0.002317309   -0.00096049104  0              0.007912418    7.6035084e-14  0              3.6714621e-09  1.1971759e-13  0              2.9941444    
   2500000   18930          200            200            0.002317309   -0.00096049104  0              0.0079124179   8.9041269e-17  0              4.2994842e-12  1.1971759e-13  0              2.9941444    
   2600000   18930          200            200            0.002317309   -0.00096049104  0              0.0079124179   1.2510661e-15  0              6.0409503e-11  1.1971759e-13  0              2.9941444    
   2700000   18930          200            200            0.002317309   -0.00096049104  0              0.0079124179   2.114533e-17   0              1.0210323e-12  1.1971759e-13  0              2.9941444    
   2800000   18930          200            200            0.002317309   -0.00096049104  0              0.0079124179   2.4112647e-17  0              1.1643134e-12  1.1971759e-13  0              2.9941444    
   2900000   18930          200            200            0.002317309   -0.00096049104  0              0.0079124179   8.6173013e-18  0              4.1609864e-13  1.1971759e-13  0              2.9941444    
   3000000   18930          200            200            0.002317309   -0.00096049104  0              0.0079124179   1.2958282e-17  0              6.2570904e-13  1.1971759e-13  0              2.9941444    
Loop time of 726.039 on 2 procs for 3000000 steps with 5001 atoms

Performance: 3570058.604 ns/day, 0.000 hours/ns, 4132.012 timesteps/s
99.9% CPU use with 2 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 163.08     | 164.28     | 165.49     |   9.4 | 22.63
Neigh   | 23.257     | 23.259     | 23.261     |   0.0 |  3.20
Comm    | 53.375     | 54.514     | 55.653     |  15.4 |  7.51
Output  | 0.65677    | 0.65678    | 0.6568     |   0.0 |  0.09
Modify  | 426.59     | 426.61     | 426.64     |   0.1 | 58.76
Other   |            | 56.71      |            |       |  7.81

Nlocal:         2500.5 ave        2501 max        2500 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Nghost:            2.5 ave           3 max           2 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Neighs:         1250.5 ave        1251 max        1250 min
Histogram: 1 0 0 0 0 0 0 0 0 1

Total # of neighbors = 2501
Ave neighs/atom = 0.50009998
Neighbor list builds = 166
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 32

#variable lat0 equal 1                    #
variable lat1 equal 3+((300)*0.01)+(v_ind*0.01)        # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 1000*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 6.32                                                               
Lattice spacing in x,y,z = 6.32 6.32 6.32

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -9480 ${n1e1} -100 100 -100 100 units box
region box block -9480 9480 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -9480 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -9480 9480 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-9480 -100 -100) to (9480 100 100)
  2 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 3000 atoms
  using lattice units in orthogonal box = (-9480 -100 -100) to (9480 100 100)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 3000 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 2001 atoms
  using lattice units in orthogonal box = (-9480 -100 -100) to (9480 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  3000 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  3000 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  2001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  2001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
3000 atoms in group substrate
group slider1 region slider1
2001 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 2001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_32_*.dump id type diameter mass xu yu zu fx fy fz
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 12233 130 130
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 438.7 | 438.7 | 438.7 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   18960          200            200            0              0              0              0              0              0              0              1.1971759e-13  0              6            
    100000   18960          200            200            0.0021269454   2.5563105e-35  0              0.0063808361   1155929.7      0              5.5815707e+10  1.1971759e-13  0              3.3315915    
    200000   18960          200            200            0.00072078172  1.704207e-35   0              0.0021623452   262623.07      0              1.2681128e+10  1.1971759e-13  0              3.0828943    
    300000   18960          200            200           -4.3672561e-06  1.3633665e-34  0             -1.3101768e-05  21.061338      0              1016976.6      1.1971759e-13  0              3.0438153    
    400000   18960          200            200           -3.7990305e-06  6.8168419e-35  0             -1.1397092e-05  16.276126      0              785915.89      1.1971759e-13  0              3.0054989    
    500000   18960          200            200            0.0010580595   0.0010603759   0              0.0021138026   564.47694      0              27256571       1.1971759e-13  0              2.9969056    
    600000   18960          200            200            0.0036170003   0.0015097411   0              0.0093412599   286.23631      0              13821327       1.1971759e-13  0              2.9936097    
    700000   18960          200            200            0.0028429232   0.0014236278   0              0.0071051418   19.884274      0              960140.43      1.1971759e-13  0              2.9944161    
    800000   18960          200            200            0.0032367111   0.001440089    0              0.0082700443   0.3301677      0              15942.617      1.1971759e-13  0              2.9939791    
    900000   18960          200            200            0.0030670566   0.0014338455   0              0.0077673243   0.063804735    0              3080.9023      1.1971759e-13  0              2.9941664    
   1000000   18960          200            200            0.0031240609   0.0014360493   0              0.0079361335   0.058243528    0              2812.3715      1.1971759e-13  0              2.9941024    
   1100000   18960          200            200            0.003109909    0.0014355022   0              0.0078942249   0.014836782    0              716.41509      1.1971759e-13  0              2.9941185    
   1200000   18960          200            200            0.0031113725   0.0014355636   0              0.007898554    0.0021395946   0              103.31337      1.1971759e-13  0              2.9941167    
   1300000   18960          200            200            0.0031123315   0.0014355978   0              0.0079013967   0.00018219517  0              8.7975527      1.1971759e-13  0              2.9941157    
   1400000   18960          200            200            0.0031115155   0.0014355675   0              0.007898979    6.2395816e-06  0              0.30128706     1.1971759e-13  0              2.9941166    
   1500000   18960          200            200            0.0031119137   0.0014355825   0              0.0079001586   4.0709836e-08  0              0.0019657323   1.1971759e-13  0              2.9941161    
   1600000   18960          200            200            0.0031117662   0.0014355769   0              0.0078997217   2.1746188e-07  0              0.010500456    1.1971759e-13  0              2.9941163    
   1700000   18960          200            200            0.0031118079   0.0014355785   0              0.0078998453   7.5140562e-08  0              0.0036282688   1.1971759e-13  0              2.9941162    
   1800000   18960          200            200            0.0031118008   0.0014355782   0              0.0078998242   1.3078509e-08  0              0.00063151439  1.1971759e-13  0              2.9941163    
   1900000   18960          200            200            0.0031117998   0.0014355781   0              0.0078998212   1.3696789e-09  0              6.6136892e-05  1.1971759e-13  0              2.9941163    
   2000000   18960          200            200            0.0031118014   0.0014355782   0              0.007899826    7.2698309e-11  0              3.5103412e-06  1.1971759e-13  0              2.9941163    
   2100000   18960          200            200            0.0031118005   0.0014355782   0              0.0078998233   2.8115231e-13  0              1.3575839e-08  1.1971759e-13  0              2.9941163    
   2200000   18960          200            200            0.0031118009   0.0014355782   0              0.0078998244   6.4730541e-13  0              3.1256062e-08  1.1971759e-13  0              2.9941163    
   2300000   18960          200            200            0.0031118007   0.0014355782   0              0.0078998241   3.4887807e-13  0              1.6846073e-08  1.1971759e-13  0              2.9941163    
   2400000   18960          200            200            0.0031118008   0.0014355782   0              0.0078998241   7.4863801e-14  0              3.614905e-09   1.1971759e-13  0              2.9941163    
   2500000   18960          200            200            0.0031118008   0.0014355782   0              0.0078998241   9.4732424e-15  0              4.5742897e-10  1.1971759e-13  0              2.9941163    
   2600000   18960          200            200            0.0031118008   0.0014355782   0              0.0078998241   6.122656e-16   0              2.9564114e-11  1.1971759e-13  0              2.9941163    
   2700000   18960          200            200            0.0031118008   0.0014355782   0              0.0078998241   5.6407129e-20  0              2.7236984e-15  1.1971759e-13  0              2.9941163    
   2800000   18960          200            200            0.0031118008   0.0014355782   0              0.0078998241   1.193356e-17   0              5.762289e-13   1.1971759e-13  0              2.9941163    
   2900000   18960          200            200            0.0031118008   0.0014355782   0              0.0078998241   7.6766949e-18  0              3.7068012e-13  1.1971759e-13  0              2.9941163    
   3000000   18960          200            200            0.0031118008   0.0014355782   0              0.0078998241   5.0166155e-18  0              2.4223441e-13  1.1971759e-13  0              2.9941163    
Loop time of 727.565 on 2 procs for 3000000 steps with 5001 atoms

Performance: 3562569.716 ns/day, 0.000 hours/ns, 4123.345 timesteps/s
99.9% CPU use with 2 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 159.63     | 161.92     | 164.2      |  18.0 | 22.25
Neigh   | 23.234     | 23.237     | 23.24      |   0.1 |  3.19
Comm    | 52.895     | 55.231     | 57.567     |  31.4 |  7.59
Output  | 0.64396    | 0.64397    | 0.64399    |   0.0 |  0.09
Modify  | 426.9      | 428.3      | 429.71     |   6.8 | 58.87
Other   |            | 58.24      |            |       |  8.00

Nlocal:         2500.5 ave        2501 max        2500 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Nghost:            2.5 ave           3 max           2 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Neighs:         1246.5 ave        1247 max        1246 min
Histogram: 1 0 0 0 0 0 0 0 0 1

Total # of neighbors = 2493
Ave neighs/atom = 0.4985003
Neighbor list builds = 166
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 33

#variable lat0 equal 1                    #
variable lat1 equal 3+((300)*0.01)+(v_ind*0.01)        # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 1000*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 6.33                                                               
Lattice spacing in x,y,z = 6.33 6.33 6.33

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -9495 ${n1e1} -100 100 -100 100 units box
region box block -9495 9495 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -9495 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -9495 9495 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-9495 -100 -100) to (9495 100 100)
  2 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 3000 atoms
  using lattice units in orthogonal box = (-9495 -100 -100) to (9495 100 100)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 3000 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 2001 atoms
  using lattice units in orthogonal box = (-9495 -100 -100) to (9495 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  3000 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  3000 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  2001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  2001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
3000 atoms in group substrate
group slider1 region slider1
2001 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 2001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_33_*.dump id type diameter mass xu yu zu fx fy fz
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 12252 130 130
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 439.3 | 439.3 | 439.3 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   18990          200            200            0              0              0              0              0              0              0              1.1971759e-13  0              6            
    100000   18990          200            200            0.0021238463   2.0640812e-42  0              0.0063715388   1156139.8      0              5.5825854e+10  1.1971759e-13  0              3.3315187    
    200000   18990          200            200            0.0007202964  -8.50755e-36    0              0.0021608892   262996.51      0              1.269916e+10   1.1971759e-13  0              3.0827552    
    300000   18990          200            200           -2.5113539e-06 -3.4030186e-35  0             -7.5340616e-06  6.8338438      0              329981.86      1.1971759e-13  0              3.0438697    
    400000   18990          200            200            2.3215823e-06  3.4030334e-35  0              6.9647468e-06  6.4781211      0              312805.28      1.1971759e-13  0              3.0055111    
    500000   18990          200            200            0.00056196468 -8.7385449e-06  0              0.0016946326   80.836279      0              3903294.6      1.1971759e-13  0              2.9972073    
    600000   18990          200            200            0.0044904157   0.002609333    0              0.010861914    9.6889278      0              467843.65      1.1971759e-13  0              2.993075     
    700000   18990          200            200            0.0033014638   0.0023138195   0              0.0075905719   46.455399      0              2243165        1.1971759e-13  0              2.9941982    
    800000   18990          200            200            0.0032731367   0.0023117192   0              0.0075076908   0.00024806099  0              11.977977      1.1971759e-13  0              2.9942221    
    900000   18990          200            200            0.0033892915   0.0023291617   0              0.0078387128   0.80886698     0              39057.292      1.1971759e-13  0              2.9940982    
   1000000   18990          200            200            0.0034205054   0.0023347603   0              0.0079267559   0.049244636    0              2377.8472      1.1971759e-13  0              2.9940667    
   1100000   18990          200            200            0.0034122356   0.0023332036   0              0.0079035032   0.0043867388   0              211.81992      1.1971759e-13  0              2.9940755    
   1200000   18990          200            200            0.003406011    0.002332069    0              0.007885964    0.002135488    0              103.11507      1.1971759e-13  0              2.9940819    
   1300000   18990          200            200            0.0034055822   0.0023319981   0              0.0078847486   6.461411e-06   0              0.31199841     1.1971759e-13  0              2.9940823    
   1400000   18990          200            200            0.0034063128   0.0023321332   0              0.0078868052   3.1192898e-05  0              1.5061934      1.1971759e-13  0              2.9940815    
   1500000   18990          200            200            0.0034065515   0.0023321763   0              0.0078874782   2.9763593e-06  0              0.14371774     1.1971759e-13  0              2.9940813    
   1600000   18990          200            200            0.0034065124   0.0023321687   0              0.0078873683   1.0483935e-07  0              0.005062317    1.1971759e-13  0              2.9940813    
   1700000   18990          200            200            0.0034064706   0.0023321611   0              0.0078872506   9.7472337e-08  0              0.0047065903   1.1971759e-13  0              2.9940814    
   1800000   18990          200            200            0.0034064655   0.0023321602   0              0.0078872362   1.1413765e-09  0              5.5112985e-05  1.1971759e-13  0              2.9940814    
   1900000   18990          200            200            0.0034064698   0.002332161    0              0.0078872485   1.1302113e-09  0              5.4573861e-05  1.1971759e-13  0              2.9940814    
   2000000   18990          200            200            0.0034064716   0.0023321613   0              0.0078872535   1.6563367e-10  0              7.9978572e-06  1.1971759e-13  0              2.9940814    
   2100000   18990          200            200            0.0034064715   0.0023321613   0              0.0078872531   1.7758722e-12  0              8.5750513e-08  1.1971759e-13  0              2.9940814    
   2200000   18990          200            200            0.0034064712   0.0023321613   0              0.0078872523   4.2472239e-12  0              2.0508324e-07  1.1971759e-13  0              2.9940814    
   2300000   18990          200            200            0.0034064711   0.0023321612   0              0.0078872521   1.0918511e-13  0              5.2721584e-09  1.1971759e-13  0              2.9940814    
   2400000   18990          200            200            0.0034064712   0.0023321613   0              0.0078872522   3.8206264e-14  0              1.8448438e-09  1.1971759e-13  0              2.9940814    
   2500000   18990          200            200            0.0034064712   0.0023321613   0              0.0078872523   8.7115455e-15  0              4.2064936e-10  1.1971759e-13  0              2.9940814    
   2600000   18990          200            200            0.0034064712   0.0023321613   0              0.0078872523   2.8584578e-18  0              1.380247e-13   1.1971759e-13  0              2.9940814    
   2700000   18990          200            200            0.0034064712   0.0023321613   0              0.0078872522   1.3071426e-16  0              6.3117239e-12  1.1971759e-13  0              2.9940814    
   2800000   18990          200            200            0.0034064712   0.0023321613   0              0.0078872522   2.3952284e-17  0              1.1565701e-12  1.1971759e-13  0              2.9940814    
   2900000   18990          200            200            0.0034064712   0.0023321613   0              0.0078872522   7.4446589e-18  0              3.5947594e-13  1.1971759e-13  0              2.9940814    
   3000000   18990          200            200            0.0034064712   0.0023321613   0              0.0078872522   1.3764054e-17  0              6.646169e-13   1.1971759e-13  0              2.9940814    
Loop time of 733.124 on 2 procs for 3000000 steps with 5001 atoms

Performance: 3535553.115 ns/day, 0.000 hours/ns, 4092.075 timesteps/s
99.9% CPU use with 2 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 165.05     | 165.74     | 166.44     |   5.4 | 22.61
Neigh   | 23.58      | 23.582     | 23.585     |   0.0 |  3.22
Comm    | 53.968     | 54.62      | 55.271     |   8.8 |  7.45
Output  | 0.64841    | 0.64842    | 0.64842    |   0.0 |  0.09
Modify  | 429.43     | 429.61     | 429.78     |   0.8 | 58.60
Other   |            | 58.92      |            |       |  8.04

Nlocal:         2500.5 ave        2501 max        2500 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Nghost:            2.5 ave           3 max           2 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Neighs:         1251.5 ave        1252 max        1251 min
Histogram: 1 0 0 0 0 0 0 0 0 1

Total # of neighbors = 2503
Ave neighs/atom = 0.5004999
Neighbor list builds = 166
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 34

#variable lat0 equal 1                    #
variable lat1 equal 3+((300)*0.01)+(v_ind*0.01)        # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 1000*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 6.34                                                               
Lattice spacing in x,y,z = 6.34 6.34 6.34

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -9510 ${n1e1} -100 100 -100 100 units box
region box block -9510 9510 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -9510 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -9510 9510 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-9510 -100 -100) to (9510 100 100)
  2 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 3000 atoms
  using lattice units in orthogonal box = (-9510 -100 -100) to (9510 100 100)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 3000 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 2001 atoms
  using lattice units in orthogonal box = (-9510 -100 -100) to (9510 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  3000 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  3000 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  2001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  2001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
3000 atoms in group substrate
group slider1 region slider1
2001 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 2001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_34_*.dump id type diameter mass xu yu zu fx fy fz
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 12271 130 130
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 440 | 440 | 440 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   19020          200            200            0              0              0              0              0              0              0              1.1971759e-13  0              6            
    100000   19020          200            200            0.0021201441  -1.6988284e-35  0              0.0063604324   1155855.9      0              5.5812146e+10  1.1971759e-13  0              3.3316165    
    200000   19020          200            200            0.00071825169 -1.6988287e-35  0              0.0021547551   262476.09      0              1.2674031e+10  1.1971759e-13  0              3.0829526    
    300000   19020          200            200           -5.0445671e-06  2.7181378e-34  0             -1.5133701e-05  28.414809      0              1372049.4      1.1971759e-13  0              3.0437949    
    400000   19020          200            200           -6.1030243e-06 -3.057891e-34   0             -1.8309073e-05  42.929565      0              2072915        1.1971759e-13  0              3.0054834    
    500000   19020          200            200            0.00124361     0.00137332     0              0.0023575099   819.86525      0              39588359       1.1971759e-13  0              2.9967318    
    600000   19020          200            200            0.004326489    0.0041206274   0              0.0088588396   336.88326      0              16266887       1.1971759e-13  0              2.9937803    
    700000   19020          200            200            0.0037436872   0.0042151482   0              0.0070159133   14.675189      0              708612.38      1.1971759e-13  0              2.9944449    
    800000   19020          200            200            0.0041680172   0.0042702636   0              0.008233788    0.70803107     0              34188.286      1.1971759e-13  0              2.9939859    
    900000   19020          200            200            0.0040343448   0.0042673315   0              0.0078357029   0.83186889     0              40167.972      1.1971759e-13  0              2.994135     
   1000000   19020          200            200            0.0040372459   0.0042684002   0              0.0078433375   0.076122465    0              3675.6814      1.1971759e-13  0              2.9941309    
   1100000   19020          200            200            0.0040555783   0.0042732268   0              0.0078935083   3.5986294e-05  0              1.7376494      1.1971759e-13  0              2.9941124    
   1200000   19020          200            200            0.0040474458   0.0042710416   0              0.0078712957   0.0015734962   0              75.978498      1.1971759e-13  0              2.9941207    
   1300000   19020          200            200            0.0040484185   0.0042713153   0              0.0078739401   0.00025491488  0              12.308927      1.1971759e-13  0              2.9941197    
   1400000   19020          200            200            0.0040491007   0.0042714932   0              0.0078758088   2.0028396e-06  0              0.096709954    1.1971759e-13  0              2.994119     
   1500000   19020          200            200            0.0040486814   0.0042713812   0              0.0078746631   2.3995986e-06  0              0.11586803     1.1971759e-13  0              2.9941194    
   1600000   19020          200            200            0.0040487669   0.0042714046   0              0.0078748962   7.1452606e-07  0              0.034501906    1.1971759e-13  0              2.9941194    
   1700000   19020          200            200            0.0040487872   0.0042714098   0              0.0078749517   2.2216926e-08  0              0.0010727758   1.1971759e-13  0              2.9941193    
   1800000   19020          200            200            0.0040487671   0.0042714044   0              0.0078748969   2.5673454e-09  0              0.00012396792  1.1971759e-13  0              2.9941194    
   1900000   19020          200            200            0.0040487729   0.004271406    0              0.0078749126   1.7198046e-09  0              8.3043208e-05  1.1971759e-13  0              2.9941194    
   2000000   19020          200            200            0.0040487731   0.0042714061   0              0.0078749133   1.1489609e-10  0              5.547921e-06   1.1971759e-13  0              2.9941194    
   2100000   19020          200            200            0.0040487722   0.0042714058   0              0.0078749109   1.0923086e-12  0              5.2743671e-08  1.1971759e-13  0              2.9941194    
   2200000   19020          200            200            0.0040487726   0.0042714059   0              0.0078749118   3.5489855e-12  0              1.7136781e-07  1.1971759e-13  0              2.9941194    
   2300000   19020          200            200            0.0040487726   0.0042714059   0              0.0078749118   4.3014464e-13  0              2.0770145e-08  1.1971759e-13  0              2.9941194    
   2400000   19020          200            200            0.0040487725   0.0042714059   0              0.0078749117   5.6717683e-16  0              2.7386939e-11  1.1971759e-13  0              2.9941194    
   2500000   19020          200            200            0.0040487725   0.0042714059   0              0.0078749117   6.074708e-15   0              2.9332591e-10  1.1971759e-13  0              2.9941194    
   2600000   19020          200            200            0.0040487725   0.0042714059   0              0.0078749117   1.3136197e-15  0              6.3429993e-11  1.1971759e-13  0              2.9941194    
   2700000   19020          200            200            0.0040487725   0.0042714059   0              0.0078749117   2.0147383e-18  0              9.72845e-14    1.1971759e-13  0              2.9941194    
   2800000   19020          200            200            0.0040487725   0.0042714059   0              0.0078749117   2.0808579e-17  0              1.0047718e-12  1.1971759e-13  0              2.9941194    
   2900000   19020          200            200            0.0040487725   0.0042714059   0              0.0078749117   8.4711584e-18  0              4.0904192e-13  1.1971759e-13  0              2.9941194    
   3000000   19020          200            200            0.0040487725   0.0042714059   0              0.0078749117   1.4151909e-17  0              6.8334503e-13  1.1971759e-13  0              2.9941194    
Loop time of 726.166 on 2 procs for 3000000 steps with 5001 atoms

Performance: 3569433.676 ns/day, 0.000 hours/ns, 4131.289 timesteps/s
100.0% CPU use with 2 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 161.86     | 163.4      | 164.94     |  12.0 | 22.50
Neigh   | 23.578     | 23.58      | 23.582     |   0.0 |  3.25
Comm    | 53.675     | 55.227     | 56.779     |  20.9 |  7.61
Output  | 0.66372    | 0.66374    | 0.66375    |   0.0 |  0.09
Modify  | 426.38     | 426.49     | 426.6      |   0.5 | 58.73
Other   |            | 56.8       |            |       |  7.82

Nlocal:         2500.5 ave        2501 max        2500 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Nghost:            2.5 ave           3 max           2 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Neighs:         1248.5 ave        1249 max        1248 min
Histogram: 1 0 0 0 0 0 0 0 0 1

Total # of neighbors = 2497
Ave neighs/atom = 0.49930014
Neighbor list builds = 166
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 35

#variable lat0 equal 1                    #
variable lat1 equal 3+((300)*0.01)+(v_ind*0.01)        # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 1000*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 6.35                                                               
Lattice spacing in x,y,z = 6.35 6.35 6.35

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -9525 ${n1e1} -100 100 -100 100 units box
region box block -9525 9525 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -9525 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -9525 9525 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-9525 -100 -100) to (9525 100 100)
  2 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 3000 atoms
  using lattice units in orthogonal box = (-9525 -100 -100) to (9525 100 100)
  create_atoms CPU = 0.002 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 3000 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 2001 atoms
  using lattice units in orthogonal box = (-9525 -100 -100) to (9525 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  3000 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  3000 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  2001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  2001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
3000 atoms in group substrate
group slider1 region slider1
2001 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 2001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_35_*.dump id type diameter mass xu yu zu fx fy fz
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 12291 130 130
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 440.7 | 440.7 | 440.7 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   19050          200            200            0              0              0              0              0              0              0              1.1971759e-13  0              6            
    100000   19050          200            200            0.0021170625  -1.6961542e-35  0              0.0063511874   1156064.3      0              5.5822208e+10  1.1971759e-13  0              3.3315417    
    200000   19050          200            200            0.000717807    1.6961567e-34  0              0.002153421    262870.76      0              1.2693088e+10  1.1971759e-13  0              3.0827929    
    300000   19050          200            200           -3.4886664e-06  4.2403917e-36  0             -1.0465999e-05  13.461366      0              650001.21      1.1971759e-13  0              3.0438465    
    400000   19050          200            200           -1.6707978e-06  1.3046251e-40  0             -5.0123933e-06  3.0525335      0              147395.92      1.1971759e-13  0              3.0055182    
    500000   19050          200            200            0.0008378207   0.00060743233  0              0.0019060298   323.65502      0              15628143       1.1971759e-13  0              2.9970713    
    600000   19050          200            200            0.0027106065  -0.0016836777   0              0.0098154972   206.32575      0              9962731.9      1.1971759e-13  0              2.9934263    
    700000   19050          200            200            0.0019506282  -0.0012175846   0              0.0070694693   19.432436      0              938322.78      1.1971759e-13  0              2.994423     
    800000   19050          200            200            0.0023085118  -0.0012778521   0              0.0082033875   1.2424084      0              59991.457      1.1971759e-13  0              2.9939942    
    900000   19050          200            200            0.002161991   -0.0012417867   0              0.0077277597   0.02948956     0              1423.9453      1.1971759e-13  0              2.9941722    
   1000000   19050          200            200            0.0022186595  -0.001256645    0              0.0079126235   0.00077428983  0              37.387685      1.1971759e-13  0              2.9941022    
   1100000   19050          200            200            0.0021979639  -0.0012513169   0              0.0078452086   0.0018393899   0              88.817557      1.1971759e-13  0              2.9941278    
   1200000   19050          200            200            0.0022049662  -0.001253147    0              0.0078680455   0.00071062897  0              34.31373       1.1971759e-13  0              2.9941191    
   1300000   19050          200            200            0.0022027838  -0.0012525741   0              0.0078609255   0.00017199531  0              8.3050378      1.1971759e-13  0              2.9941218    
   1400000   19050          200            200            0.0022033876  -0.0012527347   0              0.0078628975   3.2566024e-05  0              1.5724967      1.1971759e-13  0              2.994121     
   1500000   19050          200            200            0.0022032533  -0.001252698    0              0.007862458    5.1941089e-06  0              0.25080493     1.1971759e-13  0              2.9941212    
   1600000   19050          200            200            0.0022032672  -0.0012527024   0              0.0078625041   7.176203e-07   0              0.034651316    1.1971759e-13  0              2.9941212    
   1700000   19050          200            200            0.0022032754  -0.0012527042   0              0.0078625306   8.6221817e-08  0              0.004163343    1.1971759e-13  0              2.9941212    
   1800000   19050          200            200            0.0022032678  -0.0012527024   0              0.0078625056   8.8538813e-09  0              0.00042752224  1.1971759e-13  0              2.9941212    
   1900000   19050          200            200            0.0022032721  -0.0012527034   0              0.0078625198   7.3818094e-10  0              3.5644116e-05  1.1971759e-13  0              2.9941212    
   2000000   19050          200            200            0.0022032701  -0.0012527029   0              0.0078625131   4.3474438e-11  0              2.099225e-06   1.1971759e-13  0              2.9941212    
   2100000   19050          200            200            0.0022032709  -0.0012527031   0              0.0078625159   1.033674e-12   0              4.9912418e-08  1.1971759e-13  0              2.9941212    
   2200000   19050          200            200            0.0022032706  -0.0012527031   0              0.0078625148   2.7761323e-14  0              1.3404949e-09  1.1971759e-13  0              2.9941212    
   2300000   19050          200            200            0.0022032707  -0.0012527031   0              0.0078625152   6.5060317e-14  0              3.1415299e-09  1.1971759e-13  0              2.9941212    
   2400000   19050          200            200            0.0022032707  -0.0012527031   0              0.0078625151   2.5056497e-14  0              1.2098886e-09  1.1971759e-13  0              2.9941212    
   2500000   19050          200            200            0.0022032707  -0.0012527031   0              0.0078625151   5.998979e-15   0              2.8966923e-10  1.1971759e-13  0              2.9941212    
   2600000   19050          200            200            0.0022032707  -0.0012527031   0              0.0078625151   1.1339853e-15  0              5.4756089e-11  1.1971759e-13  0              2.9941212    
   2700000   19050          200            200            0.0022032707  -0.0012527031   0              0.0078625151   1.8531308e-16  0              8.9481055e-12  1.1971759e-13  0              2.9941212    
   2800000   19050          200            200            0.0022032707  -0.0012527031   0              0.0078625151   1.1598617e-17  0              5.6005573e-13  1.1971759e-13  0              2.9941212    
   2900000   19050          200            200            0.0022032707  -0.0012527031   0              0.0078625151   7.8202643e-18  0              3.7761258e-13  1.1971759e-13  0              2.9941212    
   3000000   19050          200            200            0.0022032707  -0.0012527031   0              0.0078625151   1.5044421e-17  0              7.2644125e-13  1.1971759e-13  0              2.9941212    
Loop time of 729.381 on 2 procs for 3000000 steps with 5001 atoms

Performance: 3553699.772 ns/day, 0.000 hours/ns, 4113.078 timesteps/s
99.9% CPU use with 2 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 165.28     | 165.48     | 165.68     |   1.6 | 22.69
Neigh   | 23.651     | 23.655     | 23.659     |   0.1 |  3.24
Comm    | 54.494     | 54.715     | 54.936     |   3.0 |  7.50
Output  | 0.6463     | 0.64633    | 0.64636    |   0.0 |  0.09
Modify  | 427.02     | 427.07     | 427.12     |   0.2 | 58.55
Other   |            | 57.81      |            |       |  7.93

Nlocal:         2500.5 ave        2501 max        2500 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Nghost:            2.5 ave           3 max           2 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Neighs:         1244.5 ave        1245 max        1244 min
Histogram: 1 0 0 0 0 0 0 0 0 1

Total # of neighbors = 2489
Ave neighs/atom = 0.49770046
Neighbor list builds = 166
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 36

#variable lat0 equal 1                    #
variable lat1 equal 3+((300)*0.01)+(v_ind*0.01)        # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 1000*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 6.36                                                               
Lattice spacing in x,y,z = 6.36 6.36 6.36

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -9540 ${n1e1} -100 100 -100 100 units box
region box block -9540 9540 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -9540 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -9540 9540 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-9540 -100 -100) to (9540 100 100)
  2 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 3000 atoms
  using lattice units in orthogonal box = (-9540 -100 -100) to (9540 100 100)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 3000 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 2001 atoms
  using lattice units in orthogonal box = (-9540 -100 -100) to (9540 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  3000 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  3000 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  2001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  2001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
3000 atoms in group substrate
group slider1 region slider1
2001 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 2001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_36_*.dump id type diameter mass xu yu zu fx fy fz
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 12310 130 130
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 441.3 | 441.3 | 441.3 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   19080          200            200            0              0              0              0              0              0              0              1.1971759e-13  0              6            
    100000   19080          200            200            0.0021134212   4.5429825e-40  0              0.0063402635   1155815.4      0              5.5810189e+10  1.1971759e-13  0              3.3316132    
    200000   19080          200            200            0.00071602411 -5.0804589e-35  0              0.0021480723   262496.85      0              1.2675034e+10  1.1971759e-13  0              3.0829126    
    300000   19080          200            200           -4.7453909e-06  4.5226516e-40  0             -1.4236173e-05  25.256896      0              1219565.1      1.1971759e-13  0              3.0437746    
    400000   19080          200            200           -4.9177963e-06  1.6934965e-35  0             -1.4753389e-05  27.868147      0              1345653.1      1.1971759e-13  0              3.0054514    
    500000   19080          200            200            0.00092874553  0.00031942377  0              0.0024668128   1132.4648      0              54682674       1.1971759e-13  0              2.9965224    
    600000   19080          200            200            0.0041096125   0.0015936858   0              0.010735152    16.787701      0              810618         1.1971759e-13  0              2.9931826    
    700000   19080          200            200            0.0029905375   0.00135471     0              0.0076169026   47.907114      0              2313263.1      1.1971759e-13  0              2.9942788    
    800000   19080          200            200            0.0029414558   0.0013497878   0              0.0074745795   0.1081868      0              5223.9536      1.1971759e-13  0              2.9943246    
    900000   19080          200            200            0.0030718894   0.0013645767   0              0.0078510916   0.9171012      0              44283.535      1.1971759e-13  0              2.9941837    
   1000000   19080          200            200            0.0030891961   0.0013663364   0              0.007901252    0.0011073284   0              53.468927      1.1971759e-13  0              2.9941661    
   1100000   19080          200            200            0.0030729778   0.0013645849   0              0.0078543485   0.0158914      0              767.33885      1.1971759e-13  0              2.9941836    
   1200000   19080          200            200            0.003069337    0.0013642036   0              0.0078438075   0.00021993877  0              10.620056      1.1971759e-13  0              2.9941874    
   1300000   19080          200            200            0.0030712171   0.0013644095   0              0.0078492419   0.00024752637  0              11.952162      1.1971759e-13  0              2.9941853    
   1400000   19080          200            200            0.0030718616   0.0013644777   0              0.0078511071   1.0810273e-05  0              0.52198938     1.1971759e-13  0              2.9941846    
   1500000   19080          200            200            0.0030716617   0.0013644556   0              0.0078505295   3.4063765e-06  0              0.16448173     1.1971759e-13  0              2.9941849    
   1600000   19080          200            200            0.0030715586   0.0013644446   0              0.0078502311   3.5268479e-07  0              0.017029886    1.1971759e-13  0              2.994185     
   1700000   19080          200            200            0.003071577    0.0013644467   0              0.0078502843   3.9758602e-08  0              0.0019198006   1.1971759e-13  0              2.994185     
   1800000   19080          200            200            0.0030715924   0.0013644484   0              0.0078503288   9.2653104e-09  0              0.00044738868  1.1971759e-13  0              2.9941849    
   1900000   19080          200            200            0.0030715912   0.0013644482   0              0.0078503253   3.5736831e-10  0              1.7256037e-05  1.1971759e-13  0              2.9941849    
   2000000   19080          200            200            0.003071589    0.001364448    0              0.007850319    2.1020169e-10  0              1.0149887e-05  1.1971759e-13  0              2.9941849    
   2100000   19080          200            200            0.003071589    0.001364448    0              0.007850319    1.822685e-12   0              8.8010933e-08  1.1971759e-13  0              2.9941849    
   2200000   19080          200            200            0.0030715893   0.001364448    0              0.0078503198   4.2497031e-12  0              2.0520295e-07  1.1971759e-13  0              2.9941849    
   2300000   19080          200            200            0.0030715893   0.001364448    0              0.0078503199   1.3723044e-16  0              6.6263668e-12  1.1971759e-13  0              2.9941849    
   2400000   19080          200            200            0.0030715893   0.001364448    0              0.0078503198   7.7319988e-14  0              3.7335055e-09  1.1971759e-13  0              2.9941849    
   2500000   19080          200            200            0.0030715893   0.001364448    0              0.0078503198   4.1890577e-16  0              2.022746e-11   1.1971759e-13  0              2.9941849    
   2600000   19080          200            200            0.0030715893   0.001364448    0              0.0078503198   1.2667894e-15  0              6.1168725e-11  1.1971759e-13  0              2.9941849    
   2700000   19080          200            200            0.0030715893   0.001364448    0              0.0078503198   6.877676e-17   0              3.3209836e-12  1.1971759e-13  0              2.9941849    
   2800000   19080          200            200            0.0030715893   0.001364448    0              0.0078503198   2.4515427e-18  0              1.1837623e-13  1.1971759e-13  0              2.9941849    
   2900000   19080          200            200            0.0030715893   0.001364448    0              0.0078503198   2.8181871e-18  0              1.3608017e-13  1.1971759e-13  0              2.9941849    
   3000000   19080          200            200            0.0030715893   0.001364448    0              0.0078503198   2.2177751e-18  0              1.0708842e-13  1.1971759e-13  0              2.9941849    
Loop time of 727.071 on 2 procs for 3000000 steps with 5001 atoms

Performance: 3564989.193 ns/day, 0.000 hours/ns, 4126.145 timesteps/s
100.0% CPU use with 2 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 161.88     | 163.24     | 164.61     |  10.7 | 22.45
Neigh   | 23.457     | 23.46      | 23.463     |   0.1 |  3.23
Comm    | 53.838     | 55.1       | 56.363     |  17.0 |  7.58
Output  | 0.64117    | 0.64119    | 0.64121    |   0.0 |  0.09
Modify  | 426.01     | 426.18     | 426.35     |   0.8 | 58.62
Other   |            | 58.45      |            |       |  8.04

Nlocal:         2500.5 ave        2501 max        2500 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Nghost:            2.5 ave           3 max           2 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Neighs:         1244.5 ave        1245 max        1244 min
Histogram: 1 0 0 0 0 0 0 0 0 1

Total # of neighbors = 2489
Ave neighs/atom = 0.49770046
Neighbor list builds = 166
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 37

#variable lat0 equal 1                    #
variable lat1 equal 3+((300)*0.01)+(v_ind*0.01)        # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 1000*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 6.37                                                               
Lattice spacing in x,y,z = 6.37 6.37 6.37

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -9555 ${n1e1} -100 100 -100 100 units box
region box block -9555 9555 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -9555 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -9555 9555 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-9555 -100 -100) to (9555 100 100)
  2 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 3000 atoms
  using lattice units in orthogonal box = (-9555 -100 -100) to (9555 100 100)
  create_atoms CPU = 0.002 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 3000 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 2001 atoms
  using lattice units in orthogonal box = (-9555 -100 -100) to (9555 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  3000 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  3000 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  2001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  2001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
3000 atoms in group substrate
group slider1 region slider1
2001 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 2001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_37_*.dump id type diameter mass xu yu zu fx fy fz
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 12330 130 130
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 442 | 442 | 442 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   19110          200            200            0              0              0              0              0              0              0              1.1971759e-13  0              6            
    100000   19110          200            200            0.0021103555   4.2270791e-36  0              0.0063310665   1156020.2      0              5.5820078e+10  1.1971759e-13  0              3.3315402    
    200000   19110          200            200            0.00071513385 -2.5362417e-35  0              0.0021454016   262627.25      0              1.268133e+10   1.1971759e-13  0              3.0829087    
    300000   19110          200            200           -5.1736001e-06  1.0567685e-36  0             -1.55208e-05    30.197971      0              1458151.9      1.1971759e-13  0              3.0438411    
    400000   19110          200            200           -6.6149628e-06  2.3671622e-34  0             -1.9844888e-05  51.04042       0              2464559.2      1.1971759e-13  0              3.0055298    
    500000   19110          200            200            0.00034282079 -0.0011270827   0              0.0021555451   643.62246      0              31078225       1.1971759e-13  0              2.9969113    
    600000   19110          200            200            0.0024853111  -0.0020618932   0              0.0095178266   256.04253      0              12363377       1.1971759e-13  0              2.9935868    
    700000   19110          200            200            0.0014372081  -0.0025395558   0              0.0068511801   2.0621079      0              99571.809      1.1971759e-13  0              2.9945535    
    800000   19110          200            200            0.0019212626  -0.0023801785   0              0.0081439665   2.2740175      0              109804.17      1.1971759e-13  0              2.9940569    
    900000   19110          200            200            0.0018000417  -0.0024228577   0              0.0078229829   0.89826576     0              43374.039      1.1971759e-13  0              2.9941791    
   1000000   19110          200            200            0.0017936728  -0.0024228963   0              0.0078039146   0.067960435    0              3281.5662      1.1971759e-13  0              2.994185     
   1100000   19110          200            200            0.001811222   -0.0024228268   0              0.0078564928   5.2992287e-07  0              0.025588079    1.1971759e-13  0              2.9941656    
   1200000   19110          200            200            0.0018035682  -0.0024228359   0              0.0078335406   0.0012559421   0              60.644949      1.1971759e-13  0              2.9941742    
   1300000   19110          200            200            0.0018049298  -0.0024228316   0              0.0078376211   0.00029325154  0              14.160067      1.1971759e-13  0              2.9941726    
   1400000   19110          200            200            0.0018052979  -0.0024228307   0              0.0078387245   1.2635115e-05  0              0.61010447     1.1971759e-13  0              2.9941722    
   1500000   19110          200            200            0.001804936   -0.0024228316   0              0.0078376395   3.3174614e-07  0              0.016018834    1.1971759e-13  0              2.9941726    
   1600000   19110          200            200            0.0018050624  -0.0024228313   0              0.0078380184   5.7451422e-07  0              0.027741236    1.1971759e-13  0              2.9941725    
   1700000   19110          200            200            0.0018050496  -0.0024228313   0              0.0078379802   8.4595539e-08  0              0.0040848158   1.1971759e-13  0              2.9941725    
   1800000   19110          200            200            0.0018050388  -0.0024228313   0              0.0078379478   1.5515776e-09  0              7.4920131e-05  1.1971759e-13  0              2.9941725    
   1900000   19110          200            200            0.0018050458  -0.0024228313   0              0.0078379687   3.9913107e-10  0              1.9272611e-05  1.1971759e-13  0              2.9941725    
   2000000   19110          200            200            0.0018050439  -0.0024228313   0              0.0078379629   2.2516901e-10  0              1.0872606e-05  1.1971759e-13  0              2.9941725    
   2100000   19110          200            200            0.0018050439  -0.0024228313   0              0.0078379629   2.1202041e-11  0              1.0237707e-06  1.1971759e-13  0              2.9941725    
   2200000   19110          200            200            0.0018050441  -0.0024228313   0              0.0078379637   4.8110953e-14  0              2.3231057e-09  1.1971759e-13  0              2.9941725    
   2300000   19110          200            200            0.001805044   -0.0024228313   0              0.0078379633   2.6254934e-13  0              1.2677568e-08  1.1971759e-13  0              2.9941725    
   2400000   19110          200            200            0.001805044   -0.0024228313   0              0.0078379634   7.7653521e-14  0              3.7496106e-09  1.1971759e-13  0              2.9941725    
   2500000   19110          200            200            0.001805044   -0.0024228313   0              0.0078379634   4.3952353e-15  0              2.1223018e-10  1.1971759e-13  0              2.9941725    
   2600000   19110          200            200            0.001805044   -0.0024228313   0              0.0078379634   3.4369387e-17  0              1.6595747e-12  1.1971759e-13  0              2.9941725    
   2700000   19110          200            200            0.001805044   -0.0024228313   0              0.0078379634   1.6840631e-16  0              8.1317381e-12  1.1971759e-13  0              2.9941725    
   2800000   19110          200            200            0.001805044   -0.0024228313   0              0.0078379634   6.16941e-18    0              2.9789873e-13  1.1971759e-13  0              2.9941725    
   2900000   19110          200            200            0.001805044   -0.0024228313   0              0.0078379634   1.1243071e-18  0              5.4288768e-14  1.1971759e-13  0              2.9941725    
   3000000   19110          200            200            0.001805044   -0.0024228313   0              0.0078379634   4.8412428e-18  0              2.3376629e-13  1.1971759e-13  0              2.9941725    
Loop time of 728.169 on 2 procs for 3000000 steps with 5001 atoms

Performance: 3559613.543 ns/day, 0.000 hours/ns, 4119.923 timesteps/s
99.9% CPU use with 2 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 162.74     | 164.19     | 165.64     |  11.3 | 22.55
Neigh   | 23.702     | 23.703     | 23.704     |   0.0 |  3.26
Comm    | 53.203     | 54.644     | 56.085     |  19.5 |  7.50
Output  | 0.65141    | 0.65142    | 0.65144    |   0.0 |  0.09
Modify  | 426.49     | 426.5      | 426.5      |   0.0 | 58.57
Other   |            | 58.49      |            |       |  8.03

Nlocal:         2500.5 ave        2501 max        2500 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Nghost:            2.5 ave           3 max           2 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Neighs:         1247.5 ave        1248 max        1247 min
Histogram: 1 0 0 0 0 0 0 0 0 1

Total # of neighbors = 2495
Ave neighs/atom = 0.49890022
Neighbor list builds = 166
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 38

#variable lat0 equal 1                    #
variable lat1 equal 3+((300)*0.01)+(v_ind*0.01)        # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 1000*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 6.38                                                               
Lattice spacing in x,y,z = 6.38 6.38 6.38

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -9570 ${n1e1} -100 100 -100 100 units box
region box block -9570 9570 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -9570 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -9570 9570 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-9570 -100 -100) to (9570 100 100)
  2 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 3000 atoms
  using lattice units in orthogonal box = (-9570 -100 -100) to (9570 100 100)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 3000 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 2001 atoms
  using lattice units in orthogonal box = (-9570 -100 -100) to (9570 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  3000 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  3000 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  2001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  2001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
3000 atoms in group substrate
group slider1 region slider1
2001 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 2001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_38_*.dump id type diameter mass xu yu zu fx fy fz
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 12349 130 130
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 442.7 | 442.7 | 442.7 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   19140          200            200            0              0              0              0              0              0              0              1.1971759e-13  0              6            
    100000   19140          200            200            0.0021066921   5.064546e-35   0              0.0063200763   1155728        0              5.580597e+10   1.1971759e-13  0              3.3316548    
    200000   19140          200            200            0.00071310683  6.752742e-35   0              0.0021393205   262103.13      0              1.2656022e+10  1.1971759e-13  0              3.0831301    
    300000   19140          200            200           -6.5938482e-06  2.0127294e-40  0             -1.9781545e-05  49.574592      0              2393779.6      1.1971759e-13  0              3.0437739    
    400000   19140          200            200           -9.6395639e-06  3.5039625e-41  0             -2.8918692e-05  109.97635      0              5310364.2      1.1971759e-13  0              3.0054669    
    500000   19140          200            200            0.001172551    0.00088084253  0              0.0026368105   1083.4379      0              52315337       1.1971759e-13  0              2.996567     
    600000   19140          200            200            0.0029878151   0.00070001483  0              0.0082634304   371.18786      0              17923333       1.1971759e-13  0              2.9940077    
    700000   19140          200            200            0.0024919794   0.00033231444  0              0.0071436238   28.060045      0              1354919.2      1.1971759e-13  0              2.9944068    
    800000   19140          200            200            0.0028659682   0.00039414344  0              0.0082037611   0.0040457263   0              195.35364      1.1971759e-13  0              2.9940096    
    900000   19140          200            200            0.0027027898   0.00037232752  0              0.0077360419   0.51413414     0              24825.697      1.1971759e-13  0              2.9941848    
   1000000   19140          200            200            0.0027294482   0.00037150635  0              0.0078168382   0.11914518     0              5753.0945      1.1971759e-13  0              2.9941532    
   1100000   19140          200            200            0.0027376602   0.00037124178  0              0.0078417387   0.0041084933   0              198.38444      1.1971759e-13  0              2.9941442    
   1200000   19140          200            200            0.0027302627   0.00037149086  0              0.0078192973   0.00027630092  0              13.341583      1.1971759e-13  0              2.9941526    
   1300000   19140          200            200            0.002732602    0.00037141186  0              0.007826394    0.00026740091  0              12.911833      1.1971759e-13  0              2.9941499    
   1400000   19140          200            200            0.0027325086   0.00037141569  0              0.0078261102   2.8851923e-05  0              1.3931561      1.1971759e-13  0              2.9941501    
   1500000   19140          200            200            0.0027322374   0.0003714246   0              0.0078252877   8.9701341e-08  0              0.0043313567   1.1971759e-13  0              2.9941504    
   1600000   19140          200            200            0.0027323762   0.00037141994  0              0.0078257085   3.4000734e-07  0              0.016417738    1.1971759e-13  0              2.9941502    
   1700000   19140          200            200            0.0027323481   0.00037142091  0              0.0078256234   9.7063527e-08  0              0.0046868503   1.1971759e-13  0              2.9941502    
   1800000   19140          200            200            0.0027323425   0.00037142109  0              0.0078256064   4.4238988e-09  0              0.00021361424  1.1971759e-13  0              2.9941502    
   1900000   19140          200            200            0.0027323489   0.00037142087  0              0.0078256258   1.2012388e-10  0              5.8003523e-06  1.1971759e-13  0              2.9941502    
   2000000   19140          200            200            0.0027323467   0.00037142095  0              0.007825619    1.9725064e-10  0              9.5245274e-06  1.1971759e-13  0              2.9941502    
   2100000   19140          200            200            0.0027323468   0.00037142094  0              0.0078256196   2.5603032e-11  0              1.2362788e-06  1.1971759e-13  0              2.9941502    
   2200000   19140          200            200            0.002732347    0.00037142093  0              0.0078256202   2.1650321e-13  0              1.0454165e-08  1.1971759e-13  0              2.9941502    
   2300000   19140          200            200            0.0027323469   0.00037142094  0              0.0078256198   2.151174e-13   0              1.0387249e-08  1.1971759e-13  0              2.9941502    
   2400000   19140          200            200            0.002732347    0.00037142094  0              0.0078256199   7.7554595e-14  0              3.7448338e-09  1.1971759e-13  0              2.9941502    
   2500000   19140          200            200            0.002732347    0.00037142094  0              0.0078256199   4.4992016e-15  0              2.1725034e-10  1.1971759e-13  0              2.9941502    
   2600000   19140          200            200            0.002732347    0.00037142094  0              0.0078256199   4.2474957e-17  0              2.0509637e-12  1.1971759e-13  0              2.9941502    
   2700000   19140          200            200            0.002732347    0.00037142094  0              0.0078256199   1.7452459e-16  0              8.4271679e-12  1.1971759e-13  0              2.9941502    
   2800000   19140          200            200            0.002732347    0.00037142094  0              0.0078256199   4.1901996e-18  0              2.0232974e-13  1.1971759e-13  0              2.9941502    
   2900000   19140          200            200            0.002732347    0.00037142094  0              0.0078256199   2.0518749e-20  0              9.9077697e-16  1.1971759e-13  0              2.9941502    
   3000000   19140          200            200            0.002732347    0.00037142094  0              0.0078256199   6.7716303e-19  0              3.2697779e-14  1.1971759e-13  0              2.9941502    
Loop time of 729.062 on 2 procs for 3000000 steps with 5001 atoms

Performance: 3555253.959 ns/day, 0.000 hours/ns, 4114.877 timesteps/s
99.9% CPU use with 2 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 160.62     | 162.25     | 163.87     |  12.7 | 22.25
Neigh   | 23.668     | 23.671     | 23.674     |   0.1 |  3.25
Comm    | 53.696     | 55.36      | 57.024     |  22.4 |  7.59
Output  | 0.65163    | 0.65165    | 0.65167    |   0.0 |  0.09
Modify  | 429.02     | 429.1      | 429.17     |   0.4 | 58.86
Other   |            | 58.04      |            |       |  7.96

Nlocal:         2500.5 ave        2501 max        2500 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Nghost:            2.5 ave           3 max           2 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Neighs:         1247.5 ave        1248 max        1247 min
Histogram: 1 0 0 0 0 0 0 0 0 1

Total # of neighbors = 2495
Ave neighs/atom = 0.49890022
Neighbor list builds = 166
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 39

#variable lat0 equal 1                    #
variable lat1 equal 3+((300)*0.01)+(v_ind*0.01)        # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 1000*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 6.39                                                               
Lattice spacing in x,y,z = 6.39 6.39 6.39

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -9585 ${n1e1} -100 100 -100 100 units box
region box block -9585 9585 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -9585 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -9585 9585 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-9585 -100 -100) to (9585 100 100)
  2 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 3000 atoms
  using lattice units in orthogonal box = (-9585 -100 -100) to (9585 100 100)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 3000 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 2001 atoms
  using lattice units in orthogonal box = (-9585 -100 -100) to (9585 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  3000 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  3000 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  2001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  2001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
3000 atoms in group substrate
group slider1 region slider1
2001 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 2001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_39_*.dump id type diameter mass xu yu zu fx fy fz
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 12368 130 130
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 443.3 | 443.3 | 443.3 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   19170          200            200            0              0              0              0              0              0              0              1.1971759e-13  0              6            
    100000   19170          200            200            0.002103402    6.7421638e-35  0              0.0063102061   1155722.2      0              5.5805689e+10  1.1971759e-13  0              3.3316992    
    200000   19170          200            200            0.00071227541 -6.7421171e-35  0              0.0021368262   262266.65      0              1.2663918e+10  1.1971759e-13  0              3.0830752    
    300000   19170          200            200           -5.0234078e-06 -1.6855303e-35  0             -1.5070224e-05  28.626407      0              1382266.7      1.1971759e-13  0              3.0437953    
    400000   19170          200            200           -4.5269955e-06 -1.0113215e-34  0             -1.3580987e-05  23.777748      0              1148142.3      1.1971759e-13  0              3.0054863    
    500000   19170          200            200            0.00053587389 -0.00055457459  0              0.0021621963   625.05025      0              30181439       1.1971759e-13  0              2.9968539    
    600000   19170          200            200            0.0024871424  -0.0015809581   0              0.0090423855   313.31233      0              15128731       1.1971759e-13  0              2.9936701    
    700000   19170          200            200            0.001751421   -0.0015834094   0              0.0068376725   3.0993711      0              149657.54      1.1971759e-13  0              2.9944721    
    800000   19170          200            200            0.0021537249  -0.0015555663   0              0.0080167409   4.7671552      0              230188.86      1.1971759e-13  0              2.9940182    
    900000   19170          200            200            0.0021121778  -0.0015677124   0              0.0079042457   0.52387769     0              25296.179      1.1971759e-13  0              2.9940628    
   1000000   19170          200            200            0.0020675348  -0.0015652548   0              0.0077678591   0.022727272    0              1097.4186      1.1971759e-13  0              2.9941131    
   1100000   19170          200            200            0.0020812361  -0.0015660151   0              0.0078097233   0.015937506    0              769.5651       1.1971759e-13  0              2.9940971    
   1200000   19170          200            200            0.0020846062  -0.0015661947   0              0.0078200133   1.5939895e-05  0              0.76968048     1.1971759e-13  0              2.9940934    
   1300000   19170          200            200            0.002082114   -0.0015660564   0              0.0078123984   0.00026282998  0              12.691119      1.1971759e-13  0              2.9940963    
   1400000   19170          200            200            0.0020821404  -0.0015660589   0              0.0078124799   1.3356075e-05  0              0.64491704     1.1971759e-13  0              2.9940962    
   1500000   19170          200            200            0.0020824704  -0.001566077    0              0.0078134883   2.1832882e-06  0              0.10542317     1.1971759e-13  0              2.9940959    
   1600000   19170          200            200            0.0020824034  -0.0015660731   0              0.0078132834   6.0167298e-07  0              0.029052635    1.1971759e-13  0              2.9940959    
   1700000   19170          200            200            0.0020823719  -0.0015660714   0              0.0078131872   2.4554051e-09  0              0.00011856273  1.1971759e-13  0              2.994096     
   1800000   19170          200            200            0.002082387   -0.0015660723   0              0.0078132332   1.2961896e-08  0              0.00062588355  1.1971759e-13  0              2.994096     
   1900000   19170          200            200            0.0020823883  -0.0015660724   0              0.0078132373   2.3196024e-10  0              1.120053e-05   1.1971759e-13  0              2.994096     
   2000000   19170          200            200            0.002082386   -0.0015660722   0              0.0078132303   1.5331809e-10  0              7.4031816e-06  1.1971759e-13  0              2.994096     
   2100000   19170          200            200            0.0020823863  -0.0015660722   0              0.0078132311   1.9625032e-11  0              9.4762257e-07  1.1971759e-13  0              2.994096     
   2200000   19170          200            200            0.0020823866  -0.0015660723   0              0.0078132319   6.6133127e-13  0              3.193332e-08   1.1971759e-13  0              2.994096     
   2300000   19170          200            200            0.0020823865  -0.0015660723   0              0.0078132317   5.6589812e-13  0              2.7325195e-08  1.1971759e-13  0              2.994096     
   2400000   19170          200            200            0.0020823864  -0.0015660723   0              0.0078132316   1.1989943e-15  0              5.7895143e-11  1.1971759e-13  0              2.994096     
   2500000   19170          200            200            0.0020823865  -0.0015660723   0              0.0078132316   8.9847996e-15  0              4.3384382e-10  1.1971759e-13  0              2.994096     
   2600000   19170          200            200            0.0020823865  -0.0015660723   0              0.0078132316   4.5316057e-16  0              2.1881502e-11  1.1971759e-13  0              2.994096     
   2700000   19170          200            200            0.0020823865  -0.0015660723   0              0.0078132316   1.1732869e-16  0              5.6653827e-12  1.1971759e-13  0              2.994096     
   2800000   19170          200            200            0.0020823865  -0.0015660723   0              0.0078132316   4.0867732e-18  0              1.9733565e-13  1.1971759e-13  0              2.994096     
   2900000   19170          200            200            0.0020823865  -0.0015660723   0              0.0078132316   3.5696354e-21  0              1.7236492e-16  1.1971759e-13  0              2.994096     
   3000000   19170          200            200            0.0020823865  -0.0015660722   0              0.0078132316   6.859616e-19   0              3.3122631e-14  1.1971759e-13  0              2.994096     
Loop time of 731.784 on 2 procs for 3000000 steps with 5001 atoms

Performance: 3542029.930 ns/day, 0.000 hours/ns, 4099.572 timesteps/s
100.0% CPU use with 2 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 165.46     | 165.85     | 166.25     |   3.1 | 22.66
Neigh   | 23.653     | 23.656     | 23.659     |   0.1 |  3.23
Comm    | 54.621     | 55.072     | 55.523     |   6.1 |  7.53
Output  | 0.65005    | 0.65006    | 0.65008    |   0.0 |  0.09
Modify  | 427.76     | 427.84     | 427.92     |   0.4 | 58.47
Other   |            | 58.71      |            |       |  8.02

Nlocal:         2500.5 ave        2501 max        2500 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Nghost:            2.5 ave           3 max           2 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Neighs:         1248.5 ave        1249 max        1248 min
Histogram: 1 0 0 0 0 0 0 0 0 1

Total # of neighbors = 2497
Ave neighs/atom = 0.49930014
Neighbor list builds = 166
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 40

#variable lat0 equal 1                    #
variable lat1 equal 3+((300)*0.01)+(v_ind*0.01)        # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 1000*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 6.4                                                               
Lattice spacing in x,y,z = 6.4 6.4 6.4

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -9600 ${n1e1} -100 100 -100 100 units box
region box block -9600 9600 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -9600 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -9600 9600 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-9600 -100 -100) to (9600 100 100)
  2 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 3000 atoms
  using lattice units in orthogonal box = (-9600 -100 -100) to (9600 100 100)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 3000 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 2001 atoms
  using lattice units in orthogonal box = (-9600 -100 -100) to (9600 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  3000 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  3000 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  2001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  2001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
3000 atoms in group substrate
group slider1 region slider1
2001 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 2001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_40_*.dump id type diameter mass xu yu zu fx fy fz
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 12388 130 130
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 444 | 444 | 444 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   19200          200            200            0              0              0              0              0              0              0              1.1971759e-13  0              6            
    100000   19200          200            200            0.0021001705   3.3658105e-35  0              0.0063005115   1155786.1      0              5.5808774e+10  1.1971759e-13  0              3.3316058    
    200000   19200          200            200            0.00070998632  4.6102561e-41  0              0.0021299589   261578.69      0              1.2630699e+10  1.1971759e-13  0              3.0834306    
    300000   19200          200            200           -3.8097028e-06 -1.682897e-35   0             -1.1429108e-05  16.364988      0              790206.72      1.1971759e-13  0              3.0437972    
    400000   19200          200            200            6.0640846e-06  6.7316299e-35  0              1.8192254e-05  43.612176      0              2105875.9      1.1971759e-13  0              3.0053862    
    500000   19200          200            200            0.0055312209   0.00019760977  0              0.016396053    80.051652      0              3865407.8      1.1971759e-13  0              2.9910774    
    600000   19200          200            200            0.0029985697   4.9501783e-06  0              0.0089907588   251.26498      0              12132686       1.1971759e-13  0              2.993133     
    700000   19200          200            200            0.0028410304   1.9094247e-07  0              0.0085229004   7.9264465      0              382739.73      1.1971759e-13  0              2.993308     
    800000   19200          200            200            0.002697224   -3.3658035e-35  0              0.0080916719   0.034917395    0              1686.036       1.1971759e-13  0              2.993539     
    900000   19200          200            200            0.0026299163   2.6654354e-41  0              0.007889749    0.24285062     0              11726.387      1.1971759e-13  0              2.9936476    
   1000000   19200          200            200            0.0026061161  -8.4144856e-36  0              0.0078183484   0.08430814     0              4070.9384      1.1971759e-13  0              2.9936857    
   1100000   19200          200            200            0.0025998925  -8.414482e-36   0              0.0077996775   0.014359491    0              693.36843      1.1971759e-13  0              2.9936955    
   1200000   19200          200            200            0.0025991035   3.5805652e-41  0              0.0077973105   0.0014237258   0              68.746623      1.1971759e-13  0              2.9936967    
   1300000   19200          200            200            0.0025994361   2.1036327e-35  0              0.0077983082   6.482954e-05   0              3.1303865      1.1971759e-13  0              2.9936961    
   1400000   19200          200            200            0.0025997557   4.207294e-36   0              0.0077992672   6.2715184e-09  0              0.00030282918  1.1971759e-13  0              2.9936956    
   1500000   19200          200            200            0.0025999159  -4.2072223e-36  0              0.0077997478   1.0695262e-06  0              0.051643594    1.1971759e-13  0              2.9936953    
   1600000   19200          200            200            0.0025999756   3.5897917e-41  0              0.0077999267   4.541403e-07   0              0.02192881     1.1971759e-13  0              2.9936952    
   1700000   19200          200            200            0.0025999923  -2.6291773e-37  0              0.0077999768   8.574549e-08   0              0.0041403428   1.1971759e-13  0              2.9936952    
   1800000   19200          200            200            0.0025999949   3.586446e-41   0              0.0077999847   9.4057887e-09  0              0.00045417188  1.1971759e-13  0              2.9936952    
   1900000   19200          200            200            0.0025999944  -8.4144805e-36  0              0.0077999831   5.1706345e-10  0              2.4967144e-05  1.1971759e-13  0              2.9936952    
   2000000   19200          200            200            0.0025999937   3.5842528e-41  0              0.007799981    2.2920644e-12  0              1.1067559e-07  1.1971759e-13  0              2.9936952    
   2100000   19200          200            200            0.0025999933   8.4145522e-36  0              0.0077999798   4.3815063e-12  0              2.1156726e-07  1.1971759e-13  0              2.9936952    
   2200000   19200          200            200            0.0025999931   8.4145522e-36  0              0.0077999794   2.392034e-12   0              1.1550276e-07  1.1971759e-13  0              2.9936952    
   2300000   19200          200            200            0.0025999931   3.5861799e-41  0              0.0077999793   5.0340505e-13  0              2.4307628e-08  1.1971759e-13  0              2.9936952    
   2400000   19200          200            200            0.0025999931  -1.6828997e-35  0              0.0077999792   6.0770329e-14  0              2.9343817e-09  1.1971759e-13  0              2.9936952    
   2500000   19200          200            200            0.0025999931   1.6829036e-34  0              0.0077999792   4.0232575e-15  0              1.942687e-10   1.1971759e-13  0              2.9936952    
   2600000   19200          200            200            0.0025999931  -1.6828997e-35  0              0.0077999792   8.3131469e-17  0              4.0141211e-12  1.1971759e-13  0              2.9936952    
   2700000   19200          200            200            0.0025999931   1.6829069e-35  0              0.0077999792   5.411477e-19   0              2.6130086e-14  1.1971759e-13  0              2.9936952    
   2800000   19200          200            200            0.0025999931   3.5961075e-41  0              0.0077999793   3.0911965e-18  0              1.4926282e-13  1.1971759e-13  0              2.9936952    
   2900000   19200          200            200            0.0025999931  -6.7316095e-35  0              0.0077999793   1.5685274e-19  0              7.5738574e-15  1.1971759e-13  0              2.9936952    
   3000000   19200          200            200            0.0025999931   6.7316166e-35  0              0.0077999793   1.9976863e-19  0              9.6461124e-15  1.1971759e-13  0              2.9936952    
Loop time of 718.298 on 2 procs for 3000000 steps with 5001 atoms

Performance: 3608528.444 ns/day, 0.000 hours/ns, 4176.538 timesteps/s
99.9% CPU use with 2 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 153.42     | 154.8      | 156.18     |  11.1 | 21.55
Neigh   | 23.69      | 23.691     | 23.693     |   0.0 |  3.30
Comm    | 53.263     | 54.656     | 56.049     |  18.8 |  7.61
Output  | 0.63114    | 0.63114    | 0.63115    |   0.0 |  0.09
Modify  | 426.1      | 426.12     | 426.14     |   0.1 | 59.32
Other   |            | 58.4       |            |       |  8.13

Nlocal:         2500.5 ave        2501 max        2500 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Nghost:            2.5 ave           3 max           2 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Neighs:         1218.5 ave        1219 max        1218 min
Histogram: 1 0 0 0 0 0 0 0 0 1

Total # of neighbors = 2437
Ave neighs/atom = 0.48730254
Neighbor list builds = 166
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 41

#variable lat0 equal 1                    #
variable lat1 equal 3+((300)*0.01)+(v_ind*0.01)        # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 1000*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 6.41                                                               
Lattice spacing in x,y,z = 6.41 6.41 6.41

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -9615 ${n1e1} -100 100 -100 100 units box
region box block -9615 9615 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -9615 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -9615 9615 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-9615 -100 -100) to (9615 100 100)
  2 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 3000 atoms
  using lattice units in orthogonal box = (-9615 -100 -100) to (9615 100 100)
  create_atoms CPU = 0.002 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 3000 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 2001 atoms
  using lattice units in orthogonal box = (-9615 -100 -100) to (9615 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  3000 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  3000 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  2001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  2001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
3000 atoms in group substrate
group slider1 region slider1
2001 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 2001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_41_*.dump id type diameter mass xu yu zu fx fy fz
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 12407 130 130
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 444.7 | 444.7 | 444.7 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   19230          200            200            0              0              0              0              0              0              0              1.1971759e-13  0              6            
    100000   19230          200            200            0.0020967431   8.3072894e-41  0              0.0062902294   1155643.8      0              5.5801903e+10  1.1971759e-13  0              3.3317269    
    200000   19230          200            200            0.00070971426 -4.2006888e-36  0              0.0021291428   262069.01      0              1.2654375e+10  1.1971759e-13  0              3.0831678    
    300000   19230          200            200           -5.6950887e-06 -2.1003465e-36  0             -1.7085266e-05  37.171675      0              1794887.2      1.1971759e-13  0              3.0437826    
    400000   19230          200            200           -6.4596289e-06 -1.6802671e-35  0             -1.9378887e-05  49.260709      0              2378623.3      1.1971759e-13  0              3.0054783    
    500000   19230          200            200            0.00068789649 -0.00010329286  0              0.0021669823   664.27405      0              32075417       1.1971759e-13  0              2.9968377    
    600000   19230          200            200            0.0028952855  -0.00095319627  0              0.0096390527   228.2545       0              11021593       1.1971759e-13  0              2.9934671    
    700000   19230          200            200            0.0022371912  -7.8398753e-05  0              0.0067899723   0.028469993    0              1374.7141      1.1971759e-13  0              2.9945033    
    800000   19230          200            200            0.0025330882  -0.00042340349  0              0.008022668    4.0741494      0              196726.1       1.1971759e-13  0              2.9940245    
    900000   19230          200            200            0.0024812237  -0.00037473436  0              0.0078184055   0.87082742     0              42049.14       1.1971759e-13  0              2.9941041    
   1000000   19230          200            200            0.0024577798  -0.00037036995  0              0.0077437092   0.023871567    0              1152.6725      1.1971759e-13  0              2.9941312    
   1100000   19230          200            200            0.0024771004  -0.00037413647  0              0.0078054377   0.0030524925   0              147.39394      1.1971759e-13  0              2.994108     
   1200000   19230          200            200            0.0024714749  -0.0003730505   0              0.0077874752   0.00210498     0              101.64195      1.1971759e-13  0              2.9941149    
   1300000   19230          200            200            0.0024714244  -0.00037305129  0              0.0077873245   0.00017966319  0              8.6752923      1.1971759e-13  0              2.9941149    
   1400000   19230          200            200            0.0024722033  -0.00037319853  0              0.0077898086   7.1590107e-09  0              0.00034568301  1.1971759e-13  0              2.9941139    
   1500000   19230          200            200            0.0024718565  -0.00037313163  0              0.007788701    3.3902065e-06  0              0.16370094     1.1971759e-13  0              2.9941144    
   1600000   19230          200            200            0.0024719092  -0.00037314223  0              0.0077888698   6.8006132e-07  0              0.032837727    1.1971759e-13  0              2.9941143    
   1700000   19230          200            200            0.0024719319  -0.00037314642  0              0.0077889421   1.6078087e-08  0              0.00077635327  1.1971759e-13  0              2.9941143    
   1800000   19230          200            200            0.0024719145  -0.00037314309  0              0.0077888866   2.8451728e-09  0              0.00013738321  1.1971759e-13  0              2.9941143    
   1900000   19230          200            200            0.0024719193  -0.00037314404  0              0.0077889021   1.7035079e-09  0              8.2256298e-05  1.1971759e-13  0              2.9941143    
   2000000   19230          200            200            0.0024719195  -0.00037314406  0              0.0077889025   1.3379144e-10  0              6.4603099e-06  1.1971759e-13  0              2.9941143    
   2100000   19230          200            200            0.0024719188  -0.00037314392  0              0.0077889002   8.9552056e-14  0              4.3241483e-09  1.1971759e-13  0              2.9941143    
   2200000   19230          200            200            0.0024719191  -0.00037314398  0              0.0077889012   2.8609662e-12  0              1.3814582e-07  1.1971759e-13  0              2.9941143    
   2300000   19230          200            200            0.002471919   -0.00037314397  0              0.0077889011   5.3030158e-13  0              2.5606365e-08  1.1971759e-13  0              2.9941143    
   2400000   19230          200            200            0.002471919   -0.00037314397  0              0.007788901    1.0489735e-14  0              5.0651174e-10  1.1971759e-13  0              2.9941143    
   2500000   19230          200            200            0.002471919   -0.00037314397  0              0.007788901    2.6244336e-15  0              1.2672451e-10  1.1971759e-13  0              2.9941143    
   2600000   19230          200            200            0.002471919   -0.00037314397  0              0.007788901    1.3737481e-15  0              6.6333379e-11  1.1971759e-13  0              2.9941143    
   2700000   19230          200            200            0.002471919   -0.00037314397  0              0.007788901    5.5078654e-17  0              2.6595511e-12  1.1971759e-13  0              2.9941143    
   2800000   19230          200            200            0.002471919   -0.00037314397  0              0.007788901    6.6079632e-18  0              3.1907489e-13  1.1971759e-13  0              2.9941143    
   2900000   19230          200            200            0.002471919   -0.00037314397  0              0.007788901    1.3452455e-17  0              6.4957089e-13  1.1971759e-13  0              2.9941143    
   3000000   19230          200            200            0.002471919   -0.00037314397  0              0.007788901    1.2811188e-17  0              6.1860643e-13  1.1971759e-13  0              2.9941143    
Loop time of 731.851 on 2 procs for 3000000 steps with 5001 atoms

Performance: 3541702.862 ns/day, 0.000 hours/ns, 4099.193 timesteps/s
100.0% CPU use with 2 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 164.42     | 165.41     | 166.39     |   7.6 | 22.60
Neigh   | 23.818     | 23.822     | 23.825     |   0.1 |  3.26
Comm    | 54.965     | 55.929     | 56.892     |  12.9 |  7.64
Output  | 0.64707    | 0.64709    | 0.64711    |   0.0 |  0.09
Modify  | 426.87     | 426.92     | 426.97     |   0.2 | 58.33
Other   |            | 59.12      |            |       |  8.08

Nlocal:         2500.5 ave        2501 max        2500 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Nghost:            2.5 ave           3 max           2 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Neighs:         1244.5 ave        1245 max        1244 min
Histogram: 1 0 0 0 0 0 0 0 0 1

Total # of neighbors = 2489
Ave neighs/atom = 0.49770046
Neighbor list builds = 166
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 42

#variable lat0 equal 1                    #
variable lat1 equal 3+((300)*0.01)+(v_ind*0.01)        # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 1000*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 6.42                                                               
Lattice spacing in x,y,z = 6.42 6.42 6.42

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -9630 ${n1e1} -100 100 -100 100 units box
region box block -9630 9630 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -9630 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -9630 9630 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-9630 -100 -100) to (9630 100 100)
  2 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 3000 atoms
  using lattice units in orthogonal box = (-9630 -100 -100) to (9630 100 100)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 3000 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 2001 atoms
  using lattice units in orthogonal box = (-9630 -100 -100) to (9630 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  3000 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  3000 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  2001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  2001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
3000 atoms in group substrate
group slider1 region slider1
2001 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 2001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_42_*.dump id type diameter mass xu yu zu fx fy fz
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 12426 130 130
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 445.3 | 445.3 | 445.3 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   19260          200            200            0              0              0              0              0              0              0              1.1971759e-13  0              6            
    100000   19260          200            200            0.0020933869   4.1941567e-36  0              0.0062801607   1155576.5      0              5.5798654e+10  1.1971759e-13  0              3.3317262    
    200000   19260          200            200            0.00070833281 -6.7106286e-35  0              0.0021249984   261910.57      0              1.2646724e+10  1.1971759e-13  0              3.0832115    
    300000   19260          200            200           -6.5461655e-06 -1.0065946e-34  0             -1.9638497e-05  49.47425       0              2388934.4      1.1971759e-13  0              3.0437456    
    400000   19260          200            200           -8.8248152e-06  4.1941574e-36  0             -2.6474446e-05  93.096072      0              4495276.1      1.1971759e-13  0              3.0054462    
    500000   19260          200            200            0.00048288726 -0.0010501526   0              0.0024988144   975.40472      0              47098803       1.1971759e-13  0              2.9966195    
    600000   19260          200            200            0.0019722905  -0.0027354955   0              0.0086523669   347.27138      0              16768492       1.1971759e-13  0              2.9937999    
    700000   19260          200            200            0.001278716   -0.0029470602   0              0.0067832083   0.95080117     0              45910.786      1.1971759e-13  0              2.9944833    
    800000   19260          200            200            0.0015986745  -0.0029770916   0              0.0077731152   6.8233391      0              329474.63      1.1971759e-13  0              2.9940961    
    900000   19260          200            200            0.0016395737  -0.002993267    0              0.0079119881   0.03827191     0              1848.0136      1.1971759e-13  0              2.9940472    
   1000000   19260          200            200            0.0016040197  -0.0029863347   0              0.0077983939   0.10111311     0              4882.3901      1.1971759e-13  0              2.9940897    
   1100000   19260          200            200            0.0015926788  -0.0029841777   0              0.0077622141   0.0062516114   0              301.86794      1.1971759e-13  0              2.9941029    
   1200000   19260          200            200            0.0015955432  -0.0029847536   0              0.0077713832   0.0008721399   0              42.112514      1.1971759e-13  0              2.9940994    
   1300000   19260          200            200            0.0015975482  -0.0029851402   0              0.0077777848   0.00024240516  0              11.704878      1.1971759e-13  0              2.9940971    
   1400000   19260          200            200            0.0015974977  -0.0029851273   0              0.0077776205   1.8832661e-06  0              0.090936182    1.1971759e-13  0              2.9940971    
   1500000   19260          200            200            0.0015972196  -0.0029850732   0              0.0077767321   5.3959559e-06  0              0.2605514      1.1971759e-13  0              2.9940975    
   1600000   19260          200            200            0.00159718    -0.0029850659   0              0.0077766059   4.1352911e-08  0              0.0019967841   1.1971759e-13  0              2.9940975    
   1700000   19260          200            200            0.0015972108  -0.002985072    0              0.0077767043   7.7526632e-08  0              0.0037434836   1.1971759e-13  0              2.9940975    
   1800000   19260          200            200            0.0015972212  -0.002985074    0              0.0077767377   5.4528606e-09  0              0.00026329912  1.1971759e-13  0              2.9940975    
   1900000   19260          200            200            0.0015972188  -0.0029850735   0              0.00777673     6.3067287e-10  0              3.0452936e-05  1.1971759e-13  0              2.9940975    
   2000000   19260          200            200            0.001597217   -0.0029850731   0              0.0077767242   1.9949977e-10  0              9.6331297e-06  1.1971759e-13  0              2.9940975    
   2100000   19260          200            200            0.0015972171  -0.0029850731   0              0.0077767243   1.0387629e-12  0              5.0158145e-08  1.1971759e-13  0              2.9940975    
   2200000   19260          200            200            0.0015972173  -0.0029850732   0              0.0077767251   4.2809044e-12  0              2.0670955e-07  1.1971759e-13  0              2.9940975    
   2300000   19260          200            200            0.0015972173  -0.0029850732   0              0.0077767252   4.3743729e-14  0              2.1122281e-09  1.1971759e-13  0              2.9940975    
   2400000   19260          200            200            0.0015972173  -0.0029850732   0              0.0077767251   5.891889e-14   0              2.8449824e-09  1.1971759e-13  0              2.9940975    
   2500000   19260          200            200            0.0015972173  -0.0029850732   0              0.0077767251   4.6955382e-15  0              2.2673074e-10  1.1971759e-13  0              2.9940975    
   2600000   19260          200            200            0.0015972173  -0.0029850732   0              0.0077767251   4.2650778e-16  0              2.0594534e-11  1.1971759e-13  0              2.9940975    
   2700000   19260          200            200            0.0015972173  -0.0029850732   0              0.0077767251   1.8503853e-16  0              8.9348485e-12  1.1971759e-13  0              2.9940975    
   2800000   19260          200            200            0.0015972173  -0.0029850732   0              0.0077767251   4.8506239e-18  0              2.3421927e-13  1.1971759e-13  0              2.9940975    
   2900000   19260          200            200            0.0015972173  -0.0029850732   0              0.0077767251   1.2307921e-17  0              5.9430544e-13  1.1971759e-13  0              2.9940975    
   3000000   19260          200            200            0.0015972173  -0.0029850732   0              0.0077767251   1.5234579e-17  0              7.3562332e-13  1.1971759e-13  0              2.9940975    
Loop time of 729.114 on 2 procs for 3000000 steps with 5001 atoms

Performance: 3554999.156 ns/day, 0.000 hours/ns, 4114.582 timesteps/s
99.9% CPU use with 2 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 162.84     | 165.08     | 167.32     |  17.4 | 22.64
Neigh   | 23.859     | 23.862     | 23.865     |   0.1 |  3.27
Comm    | 53.358     | 55.566     | 57.774     |  29.6 |  7.62
Output  | 0.65055    | 0.65055    | 0.65056    |   0.0 |  0.09
Modify  | 425.94     | 426.06     | 426.17     |   0.6 | 58.43
Other   |            | 57.9       |            |       |  7.94

Nlocal:         2500.5 ave        2501 max        2500 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Nghost:            2.5 ave           3 max           2 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Neighs:         1252.5 ave        1253 max        1252 min
Histogram: 1 0 0 0 0 0 0 0 0 1

Total # of neighbors = 2505
Ave neighs/atom = 0.50089982
Neighbor list builds = 166
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 43

#variable lat0 equal 1                    #
variable lat1 equal 3+((300)*0.01)+(v_ind*0.01)        # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 1000*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 6.43                                                               
Lattice spacing in x,y,z = 6.43 6.43 6.43

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -9645 ${n1e1} -100 100 -100 100 units box
region box block -9645 9645 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -9645 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -9645 9645 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-9645 -100 -100) to (9645 100 100)
  2 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 3000 atoms
  using lattice units in orthogonal box = (-9645 -100 -100) to (9645 100 100)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 3000 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 2001 atoms
  using lattice units in orthogonal box = (-9645 -100 -100) to (9645 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  3000 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  3000 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  2001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  2001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
3000 atoms in group substrate
group slider1 region slider1
2001 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 2001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_43_*.dump id type diameter mass xu yu zu fx fy fz
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 12446 130 130
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 446 | 446 | 446 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   19290          200            200            0              0              0              0              0              0              0              1.1971759e-13  0              6            
    100000   19290          200            200            0.002089878    1.0469073e-35  0              0.006269634    1155368.7      0              5.5788619e+10  1.1971759e-13  0              3.331801     
    200000   19290          200            200            0.00070727742  8.3752605e-35  0              0.0021218322   261947.95      0              1.2648529e+10  1.1971759e-13  0              3.0830806    
    300000   19290          200            200           -5.3552923e-06 -1.3400203e-34  0             -1.6065877e-05  33.018443      0              1594342.5      1.1971759e-13  0              3.0436194    
    400000   19290          200            200           -7.8129672e-06 -6.7001467e-35  0             -2.3438902e-05  72.940877      0              3522053.9      1.1971759e-13  0              3.0053063    
    500000   19290          200            200            0.0054827055   0.012199855    0              0.0042482619   2072.8968      0              1.0009277e+08  1.1971759e-13  0              2.995472     
    600000   19290          200            200            0.0068004839   0.015017867    0              0.0053835847   51.142081      0              2469468.1      1.1971759e-13  0              2.9949816    
    700000   19290          200            200            0.010276853    0.022073312    0              0.0087572478   2.553402       0              123294.64      1.1971759e-13  0              2.993588     
    800000   19290          200            200            0.0093785752   0.020640077    0              0.0074956484   3.0623792      0              147871.33      1.1971759e-13  0              2.9940648    
    900000   19290          200            200            0.0095557177   0.020867313    0              0.0077998402   0.83791242     0              40459.792      1.1971759e-13  0              2.993948     
   1000000   19290          200            200            0.0095444454   0.020855009    0              0.0077783269   0.11008847     0              5315.7784      1.1971759e-13  0              2.993955     
   1100000   19290          200            200            0.0095281275   0.020833499    0              0.0077508839   0.0070468255   0              340.26598      1.1971759e-13  0              2.9939662    
   1200000   19290          200            200            0.0095395744   0.020847968    0              0.0077707548   6.5912155e-05  0              3.1826621      1.1971759e-13  0              2.9939583    
   1300000   19290          200            200            0.0095346582   0.02084196     0              0.007762015    3.8348967e-05  0              1.8517344      1.1971759e-13  0              2.9939617    
   1400000   19290          200            200            0.0095362271   0.020843857    0              0.0077648242   2.4778109e-05  0              1.1964462      1.1971759e-13  0              2.9939606    
   1500000   19290          200            200            0.0095359024   0.02084347     0              0.0077642369   5.2456324e-06  0              0.25329282     1.1971759e-13  0              2.9939609    
   1600000   19290          200            200            0.0095358952   0.020843458    0              0.0077642275   5.8916517e-07  0              0.028448678    1.1971759e-13  0              2.9939609    
   1700000   19290          200            200            0.0095359434   0.020843518    0              0.0077643124   3.0118891e-08  0              0.0014543335   1.1971759e-13  0              2.9939608    
   1800000   19290          200            200            0.0095359141   0.020843482    0              0.0077642604   3.1871401e-11  0              1.5389559e-06  1.1971759e-13  0              2.9939609    
   1900000   19290          200            200            0.009535926    0.020843496    0              0.0077642816   3.9215517e-10  0              1.893577e-05   1.1971759e-13  0              2.9939608    
   2000000   19290          200            200            0.0095359225   0.020843492    0              0.0077642753   1.7385694e-10  0              8.3949293e-06  1.1971759e-13  0              2.9939608    
   2100000   19290          200            200            0.0095359231   0.020843493    0              0.0077642764   3.1472337e-11  0              1.5196865e-06  1.1971759e-13  0              2.9939608    
   2200000   19290          200            200            0.0095359232   0.020843493    0              0.0077642765   3.0509691e-12  0              1.4732038e-07  1.1971759e-13  0              2.9939608    
   2300000   19290          200            200            0.0095359231   0.020843493    0              0.0077642763   1.1557517e-13  0              5.5807115e-09  1.1971759e-13  0              2.9939608    
   2400000   19290          200            200            0.0095359231   0.020843493    0              0.0077642764   4.5157139e-16  0              2.1804766e-11  1.1971759e-13  0              2.9939608    
   2500000   19290          200            200            0.0095359231   0.020843493    0              0.0077642764   3.416013e-15   0              1.6494704e-10  1.1971759e-13  0              2.9939608    
   2600000   19290          200            200            0.0095359231   0.020843493    0              0.0077642764   1.1125988e-15  0              5.3723414e-11  1.1971759e-13  0              2.9939608    
   2700000   19290          200            200            0.0095359231   0.020843493    0              0.0077642764   1.7844019e-16  0              8.6162382e-12  1.1971759e-13  0              2.9939608    
   2800000   19290          200            200            0.0095359231   0.020843493    0              0.0077642764   2.5401475e-17  0              1.2265463e-12  1.1971759e-13  0              2.9939608    
   2900000   19290          200            200            0.0095359231   0.020843493    0              0.0077642764   3.773278e-19   0              1.8219809e-14  1.1971759e-13  0              2.9939608    
   3000000   19290          200            200            0.0095359231   0.020843493    0              0.0077642764   2.8171638e-18  0              1.3603076e-13  1.1971759e-13  0              2.9939608    
Loop time of 725.226 on 2 procs for 3000000 steps with 5001 atoms

Performance: 3574056.761 ns/day, 0.000 hours/ns, 4136.640 timesteps/s
100.0% CPU use with 2 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 161.89     | 162.61     | 163.33     |   5.7 | 22.42
Neigh   | 23.703     | 23.704     | 23.705     |   0.0 |  3.27
Comm    | 54.263     | 55.006     | 55.749     |  10.0 |  7.58
Output  | 0.6517     | 0.65175    | 0.65179    |   0.0 |  0.09
Modify  | 426.01     | 426.1      | 426.19     |   0.4 | 58.75
Other   |            | 57.15      |            |       |  7.88

Nlocal:         2500.5 ave        2501 max        2500 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Nghost:            2.5 ave           3 max           2 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Neighs:         1244.5 ave        1245 max        1244 min
Histogram: 1 0 0 0 0 0 0 0 0 1

Total # of neighbors = 2489
Ave neighs/atom = 0.49770046
Neighbor list builds = 166
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 44

#variable lat0 equal 1                    #
variable lat1 equal 3+((300)*0.01)+(v_ind*0.01)        # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 1000*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 6.44                                                               
Lattice spacing in x,y,z = 6.44 6.44 6.44

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -9660 ${n1e1} -100 100 -100 100 units box
region box block -9660 9660 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -9660 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -9660 9660 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-9660 -100 -100) to (9660 100 100)
  2 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 3000 atoms
  using lattice units in orthogonal box = (-9660 -100 -100) to (9660 100 100)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 3000 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 2001 atoms
  using lattice units in orthogonal box = (-9660 -100 -100) to (9660 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  3000 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  3000 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  2001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  2001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
3000 atoms in group substrate
group slider1 region slider1
2001 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 2001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_44_*.dump id type diameter mass xu yu zu fx fy fz
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 12465 130 130
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 446.7 | 446.7 | 446.7 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   19320          200            200            0              0              0              0              0              0              0              1.1971759e-13  0              6            
    100000   19320          200            200            0.0020868225   3.3449122e-35  0              0.0062604674   1155522.8      0              5.5796061e+10  1.1971759e-13  0              3.3317519    
    200000   19320          200            200            0.00070613622 -3.3448698e-35  0              0.0021184087   261914.31      0              1.2646905e+10  1.1971759e-13  0              3.0831893    
    300000   19320          200            200           -6.3058293e-06  3.3449028e-34  0             -1.8917488e-05  46.148396      0              2228340.9      1.1971759e-13  0              3.0437211    
    400000   19320          200            200           -8.7479187e-06 -1.6724476e-35  0             -2.6243756e-05  92.037608      0              4444166.7      1.1971759e-13  0              3.0054167    
    500000   19320          200            200            0.001153993    0.00079254625  0              0.0026694327   1107.1786      0              53461693       1.1971759e-13  0              2.9964813    
    600000   19320          200            200            0.0034979437   0.0023729479   0              0.0081208832   371.99841      0              17962472       1.1971759e-13  0              2.9939703    
    700000   19320          200            200            0.003314765    0.0026083066   0              0.0073359884   41.89894       0              2023149.8      1.1971759e-13  0              2.9942442    
    800000   19320          200            200            0.0035417065   0.0026099719   0              0.0080151476   3.4207431      0              165175.44      1.1971759e-13  0              2.9939917    
    900000   19320          200            200            0.0034020428   0.0025790756   0              0.0076270528   0.12954244     0              6255.1408      1.1971759e-13  0              2.9941376    
   1000000   19320          200            200            0.0034653087   0.0025937141   0              0.0078022121   2.3056091e-05  0              1.1132961      1.1971759e-13  0              2.9940707    
   1100000   19320          200            200            0.0034414102   0.0025882471   0              0.0077359836   0.0026825501   0              129.53075      1.1971759e-13  0              2.9940961    
   1200000   19320          200            200            0.0034490273   0.0025900176   0              0.0077570644   0.001177768    0              56.870202      1.1971759e-13  0              2.994088     
   1300000   19320          200            200            0.0034471014   0.0025895651   0              0.0077517392   0.00026205896  0              12.653889      1.1971759e-13  0              2.9940901    
   1400000   19320          200            200            0.0034473766   0.002589633    0              0.0077524967   3.9796122e-05  0              1.9216123      1.1971759e-13  0              2.9940897    
   1500000   19320          200            200            0.00344745     0.0025896481   0              0.0077527018   4.3245061e-06  0              0.20881492     1.1971759e-13  0              2.9940897    
   1600000   19320          200            200            0.0034473634   0.0025896288   0              0.0077524615   3.0777222e-07  0              0.014861219    1.1971759e-13  0              2.9940898    
   1700000   19320          200            200            0.003447412    0.0025896398   0              0.0077525961   8.9598312e-09  0              0.00043263818  1.1971759e-13  0              2.9940897    
   1800000   19320          200            200            0.0034473909   0.002589635    0              0.0077525376   1.1544848e-10  0              5.5745938e-06  1.1971759e-13  0              2.9940897    
   1900000   19320          200            200            0.0034473986   0.0025896367   0              0.007752559    3.9930586e-10  0              1.9281051e-05  1.1971759e-13  0              2.9940897    
   2000000   19320          200            200            0.0034473962   0.0025896362   0              0.0077525524   1.4493739e-10  0              6.9985076e-06  1.1971759e-13  0              2.9940897    
   2100000   19320          200            200            0.0034473968   0.0025896363   0              0.007752554    2.9552997e-11  0              1.4270085e-06  1.1971759e-13  0              2.9940897    
   2200000   19320          200            200            0.0034473967   0.0025896363   0              0.0077525538   4.1980046e-12  0              2.0270662e-07  1.1971759e-13  0              2.9940897    
   2300000   19320          200            200            0.0034473967   0.0025896363   0              0.0077525537   4.2484004e-13  0              2.0514005e-08  1.1971759e-13  0              2.9940897    
   2400000   19320          200            200            0.0034473967   0.0025896363   0              0.0077525538   2.668691e-14   0              1.2886154e-09  1.1971759e-13  0              2.9940897    
   2500000   19320          200            200            0.0034473967   0.0025896363   0              0.0077525538   5.1609089e-16  0              2.4920182e-11  1.1971759e-13  0              2.9940897    
   2600000   19320          200            200            0.0034473967   0.0025896363   0              0.0077525538   4.3880521e-17  0              2.1188333e-12  1.1971759e-13  0              2.9940897    
   2700000   19320          200            200            0.0034473967   0.0025896363   0              0.0077525538   9.9097256e-17  0              4.7850519e-12  1.1971759e-13  0              2.9940897    
   2800000   19320          200            200            0.0034473967   0.0025896363   0              0.0077525538   2.5771411e-17  0              1.2444092e-12  1.1971759e-13  0              2.9940897    
   2900000   19320          200            200            0.0034473967   0.0025896363   0              0.0077525538   6.6651552e-18  0              3.2183649e-13  1.1971759e-13  0              2.9940897    
   3000000   19320          200            200            0.0034473967   0.0025896363   0              0.0077525538   1.530299e-17   0              7.389266e-13   1.1971759e-13  0              2.9940897    
Loop time of 725.392 on 2 procs for 3000000 steps with 5001 atoms

Performance: 3573242.017 ns/day, 0.000 hours/ns, 4135.697 timesteps/s
99.9% CPU use with 2 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 159.09     | 161.34     | 163.59     |  17.7 | 22.24
Neigh   | 23.819     | 23.822     | 23.825     |   0.1 |  3.28
Comm    | 53.349     | 55.63      | 57.911     |  30.6 |  7.67
Output  | 0.65612    | 0.65612    | 0.65613    |   0.0 |  0.09
Modify  | 425.32     | 425.37     | 425.42     |   0.3 | 58.64
Other   |            | 58.57      |            |       |  8.07

Nlocal:         2500.5 ave        2501 max        2500 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Nghost:            2.5 ave           3 max           2 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Neighs:         1242.5 ave        1243 max        1242 min
Histogram: 1 0 0 0 0 0 0 0 0 1

Total # of neighbors = 2485
Ave neighs/atom = 0.49690062
Neighbor list builds = 166
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 45

#variable lat0 equal 1                    #
variable lat1 equal 3+((300)*0.01)+(v_ind*0.01)        # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 1000*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 6.45                                                               
Lattice spacing in x,y,z = 6.45 6.45 6.45

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -9675 ${n1e1} -100 100 -100 100 units box
region box block -9675 9675 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -9675 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -9675 9675 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-9675 -100 -100) to (9675 100 100)
  2 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 3000 atoms
  using lattice units in orthogonal box = (-9675 -100 -100) to (9675 100 100)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 3000 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 2001 atoms
  using lattice units in orthogonal box = (-9675 -100 -100) to (9675 100 100)
  create_atoms CPU = 0.002 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  3000 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  3000 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  2001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  2001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
3000 atoms in group substrate
group slider1 region slider1
2001 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 2001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_45_*.dump id type diameter mass xu yu zu fx fy fz
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 12484 130 130
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 447.3 | 447.3 | 447.3 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   19350          200            200            0              0              0              0              0              0              0              1.1971759e-13  0              6            
    100000   19350          200            200            0.002083385   -8.3492595e-36  0              0.006250155    1155363.7      0              5.5788376e+10  1.1971759e-13  0              3.3317824    
    200000   19350          200            200            0.00070417077  5.0095757e-35  0              0.0021125123   261403.31      0              1.262223e+10   1.1971759e-13  0              3.0834304    
    300000   19350          200            200           -7.6048918e-06 -8.349258e-36   0             -2.2814675e-05  67.709513      0              3269450.1      1.1971759e-13  0              3.0436539    
    400000   19350          200            200           -1.2910074e-05  2.3742842e-40  0             -3.8730221e-05  203.67039      0              9834514        1.1971759e-13  0              3.005359     
    500000   19350          200            200            0.00058666119 -8.3492872e-36  0              0.0017599836   10.746142      0              518892.75      1.1971759e-13  0              2.9971562    
    600000   19350          200            200            0.0022730703  -0.00056008031  0              0.0073792912   390.07138      0              18835151       1.1971759e-13  0              2.9941503    
    700000   19350          200            200            0.0022355901  -0.00074326043  0              0.0074500306   48.245783      0              2329616.2      1.1971759e-13  0              2.9940996    
    800000   19350          200            200            0.0024237204  -0.00075297824  0              0.0080241395   3.5096645      0              169469.14      1.1971759e-13  0              2.9939124    
    900000   19350          200            200            0.0022856686  -0.00074104681  0              0.0075980527   0.043025067    0              2077.5265      1.1971759e-13  0              2.9940549    
   1000000   19350          200            200            0.0023478618  -0.00074671324  0              0.0077902987   0.015164885    0              732.25801      1.1971759e-13  0              2.9939894    
   1100000   19350          200            200            0.0023279238  -0.00074491752  0              0.007728689    0.010787945    0              520.91125      1.1971759e-13  0              2.9940106    
   1200000   19350          200            200            0.0023318316  -0.00074528148  0              0.0077407762   0.0022583677   0              109.04849      1.1971759e-13  0              2.9940063    
   1300000   19350          200            200            0.0023320998  -0.00074530033  0              0.0077415997   0.00023530234  0              11.361908      1.1971759e-13  0              2.9940061    
   1400000   19350          200            200            0.0023314094  -0.00074523991  0              0.0077394681   9.4310686e-06  0              0.45539255     1.1971759e-13  0              2.9940068    
   1500000   19350          200            200            0.0023317991  -0.00074527464  0              0.0077406719   2.8228964e-08  0              0.0013630757   1.1971759e-13  0              2.9940064    
   1600000   19350          200            200            0.0023316516  -0.00074526135  0              0.0077402162   2.6661318e-07  0              0.012873796    1.1971759e-13  0              2.9940066    
   1700000   19350          200            200            0.0023316902  -0.00074526488  0              0.0077403354   8.7494143e-08  0              0.0042247791   1.1971759e-13  0              2.9940065    
   1800000   19350          200            200            0.0023316862  -0.00074526449  0              0.0077403231   1.276603e-08   0              0.00061642591  1.1971759e-13  0              2.9940065    
   1900000   19350          200            200            0.0023316835  -0.00074526426  0              0.0077403147   8.9469823e-10  0              4.3201775e-05  1.1971759e-13  0              2.9940065    
   2000000   19350          200            200            0.0023316857  -0.00074526445  0              0.0077403215   1.0619185e-11  0              5.1276243e-07  1.1971759e-13  0              2.9940065    
   2100000   19350          200            200            0.0023316847  -0.00074526436  0              0.0077403184   4.0449976e-12  0              1.9531846e-07  1.1971759e-13  0              2.9940065    
   2200000   19350          200            200            0.002331685   -0.00074526439  0              0.0077403194   2.8176562e-12  0              1.3605453e-07  1.1971759e-13  0              2.9940065    
   2300000   19350          200            200            0.0023316849  -0.00074526439  0              0.0077403192   5.840477e-13   0              2.8201573e-08  1.1971759e-13  0              2.9940065    
   2400000   19350          200            200            0.0023316849  -0.00074526438  0              0.0077403192   6.0370633e-14  0              2.9150818e-09  1.1971759e-13  0              2.9940065    
   2500000   19350          200            200            0.002331685   -0.00074526439  0              0.0077403192   2.3576951e-15  0              1.1384466e-10  1.1971759e-13  0              2.9940065    
   2600000   19350          200            200            0.0023316849  -0.00074526439  0              0.0077403192   8.2817373e-18  0              3.9989546e-13  1.1971759e-13  0              2.9940065    
   2700000   19350          200            200            0.0023316849  -0.00074526439  0              0.0077403192   9.9556618e-17  0              4.8072328e-12  1.1971759e-13  0              2.9940065    
   2800000   19350          200            200            0.0023316849  -0.00074526439  0              0.0077403192   2.2637406e-17  0              1.0930793e-12  1.1971759e-13  0              2.9940065    
   2900000   19350          200            200            0.0023316849  -0.00074526439  0              0.0077403192   1.0133872e-17  0              4.8932842e-13  1.1971759e-13  0              2.9940065    
   3000000   19350          200            200            0.0023316849  -0.00074526439  0              0.0077403192   7.7308556e-18  0              3.7329535e-13  1.1971759e-13  0              2.9940065    
Loop time of 728.045 on 2 procs for 3000000 steps with 5001 atoms

Performance: 3560221.019 ns/day, 0.000 hours/ns, 4120.626 timesteps/s
100.0% CPU use with 2 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 163.88     | 164.95     | 166.03     |   8.4 | 22.66
Neigh   | 23.759     | 23.762     | 23.764     |   0.1 |  3.26
Comm    | 53.981     | 55.072     | 56.163     |  14.7 |  7.56
Output  | 0.63835    | 0.63836    | 0.63838    |   0.0 |  0.09
Modify  | 425.38     | 425.46     | 425.54     |   0.4 | 58.44
Other   |            | 58.16      |            |       |  7.99

Nlocal:         2500.5 ave        2501 max        2500 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Nghost:            2.5 ave           3 max           2 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Neighs:         1255.5 ave        1256 max        1255 min
Histogram: 1 0 0 0 0 0 0 0 0 1

Total # of neighbors = 2511
Ave neighs/atom = 0.50209958
Neighbor list builds = 166
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 46

#variable lat0 equal 1                    #
variable lat1 equal 3+((300)*0.01)+(v_ind*0.01)        # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 1000*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 6.46                                                               
Lattice spacing in x,y,z = 6.46 6.46 6.46

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -9690 ${n1e1} -100 100 -100 100 units box
region box block -9690 9690 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -9690 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -9690 9690 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-9690 -100 -100) to (9690 100 100)
  2 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 3000 atoms
  using lattice units in orthogonal box = (-9690 -100 -100) to (9690 100 100)
  create_atoms CPU = 0.002 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 3000 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 2001 atoms
  using lattice units in orthogonal box = (-9690 -100 -100) to (9690 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  3000 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  3000 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  2001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  2001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
3000 atoms in group substrate
group slider1 region slider1
2001 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 2001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_46_*.dump id type diameter mass xu yu zu fx fy fz
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 12504 130 130
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 448 | 448 | 448 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   19380          200            200            0              0              0              0              0              0              0              1.1971759e-13  0              6            
    100000   19380          200            200            0.0020802986   2.0840914e-36  0              0.0062408959   1155469.5      0              5.5793487e+10  1.1971759e-13  0              3.3317759    
    200000   19380          200            200            0.00070368175  7.7497937e-42  0              0.0021110453   261755.33      0              1.2639228e+10  1.1971759e-13  0              3.0832779    
    300000   19380          200            200           -6.4307844e-06 -1.6672694e-35  0             -1.9292353e-05  48.326745      0              2333525.5      1.1971759e-13  0              3.043717     
    400000   19380          200            200           -9.8088578e-06 -3.3345302e-35  0             -2.9426573e-05  116.86135      0              5642816.2      1.1971759e-13  0              3.0054032    
    500000   19380          200            200            0.0022674104   0.0032518459   0              0.0035503854   1737.7571      0              83910072       1.1971759e-13  0              2.995954     
    600000   19380          200            200            0.0031324178   0.0031152232   0              0.0062820301   261.0152       0              12603490       1.1971759e-13  0              2.9946989    
    700000   19380          200            200            0.003470516    0.0022053084   0              0.0082062396   38.797116      0              1873373.9      1.1971759e-13  0              2.9939043    
    800000   19380          200            200            0.0033733992   0.0024616427   0              0.0076585549   6.4779198      0              312795.56      1.1971759e-13  0              2.9941216    
    900000   19380          200            200            0.0033759007   0.002423379    0              0.0077043232   0.87951446     0              42468.606      1.1971759e-13  0              2.9941003    
   1000000   19380          200            200            0.0033919376   0.0024215749   0              0.0077542378   0.090039313    0              4347.6762      1.1971759e-13  0              2.9940824    
   1100000   19380          200            200            0.0033790861   0.0024230802   0              0.0077141779   0.006228377    0              300.74604      1.1971759e-13  0              2.9940974    
   1200000   19380          200            200            0.0033857386   0.0024222767   0              0.0077349392   0.00018663638  0              9.0120029      1.1971759e-13  0              2.9940895    
   1300000   19380          200            200            0.003382915    0.0024226173   0              0.0077261275   1.6248657e-06  0              0.078458951    1.1971759e-13  0              2.9940929    
   1400000   19380          200            200            0.0033839509   0.0024224908   0              0.007729362    7.3404762e-06  0              0.35444532     1.1971759e-13  0              2.9940916    
   1500000   19380          200            200            0.0033836219   0.0024225313   0              0.0077283345   2.8284906e-06  0              0.13657769     1.1971759e-13  0              2.994092     
   1600000   19380          200            200            0.0033837076   0.0024225206   0              0.0077286023   6.1783965e-07  0              0.029833266    1.1971759e-13  0              2.9940919    
   1700000   19380          200            200            0.0033836933   0.0024225224   0              0.0077285573   9.7009643e-08  0              0.0046842485   1.1971759e-13  0              2.9940919    
   1800000   19380          200            200            0.0033836915   0.0024225226   0              0.0077285521   1.1519934e-08  0              0.0005562564   1.1971759e-13  0              2.9940919    
   1900000   19380          200            200            0.0033836946   0.0024225222   0              0.0077285617   9.938515e-10   0              4.7989532e-05  1.1971759e-13  0              2.9940919    
   2000000   19380          200            200            0.0033836928   0.0024225225   0              0.0077285558   5.081175e-11   0              2.4535176e-06  1.1971759e-13  0              2.9940919    
   2100000   19380          200            200            0.0033836936   0.0024225224   0              0.0077285585   4.0391128e-13  0              1.950343e-08   1.1971759e-13  0              2.9940919    
   2200000   19380          200            200            0.0033836933   0.0024225224   0              0.0077285575   2.7416659e-13  0              1.3238523e-08  1.1971759e-13  0              2.9940919    
   2300000   19380          200            200            0.0033836934   0.0024225224   0              0.0077285578   1.973868e-13   0              9.5311022e-09  1.1971759e-13  0              2.9940919    
   2400000   19380          200            200            0.0033836934   0.0024225224   0              0.0077285577   5.4549238e-14  0              2.6339875e-09  1.1971759e-13  0              2.9940919    
   2500000   19380          200            200            0.0033836934   0.0024225224   0              0.0077285578   9.9737297e-15  0              4.8159571e-10  1.1971759e-13  0              2.9940919    
   2600000   19380          200            200            0.0033836934   0.0024225224   0              0.0077285578   1.3490355e-15  0              6.5140098e-11  1.1971759e-13  0              2.9940919    
   2700000   19380          200            200            0.0033836934   0.0024225224   0              0.0077285577   8.7455374e-17  0              4.222907e-12   1.1971759e-13  0              2.9940919    
   2800000   19380          200            200            0.0033836934   0.0024225224   0              0.0077285577   1.3030629e-20  0              6.2920246e-16  1.1971759e-13  0              2.9940919    
   2900000   19380          200            200            0.0033836934   0.0024225224   0              0.0077285577   5.8536148e-19  0              2.8265011e-14  1.1971759e-13  0              2.9940919    
   3000000   19380          200            200            0.0033836934   0.0024225224   0              0.0077285577   6.2773158e-18  0              3.0310911e-13  1.1971759e-13  0              2.9940919    
Loop time of 729.082 on 2 procs for 3000000 steps with 5001 atoms

Performance: 3555154.989 ns/day, 0.000 hours/ns, 4114.763 timesteps/s
99.9% CPU use with 2 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 163.21     | 165.11     | 167.01     |  14.8 | 22.65
Neigh   | 23.796     | 23.8       | 23.804     |   0.1 |  3.26
Comm    | 53.836     | 55.854     | 57.872     |  27.0 |  7.66
Output  | 0.64642    | 0.64645    | 0.64647    |   0.0 |  0.09
Modify  | 425.96     | 426.02     | 426.08     |   0.3 | 58.43
Other   |            | 57.65      |            |       |  7.91

Nlocal:         2500.5 ave        2501 max        2500 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Nghost:            2.5 ave           3 max           2 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Neighs:         1245.5 ave        1246 max        1245 min
Histogram: 1 0 0 0 0 0 0 0 0 1

Total # of neighbors = 2491
Ave neighs/atom = 0.49810038
Neighbor list builds = 166
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 47

#variable lat0 equal 1                    #
variable lat1 equal 3+((300)*0.01)+(v_ind*0.01)        # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 1000*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 6.47                                                               
Lattice spacing in x,y,z = 6.47 6.47 6.47

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -9705 ${n1e1} -100 100 -100 100 units box
region box block -9705 9705 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -9705 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -9705 9705 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-9705 -100 -100) to (9705 100 100)
  2 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 3000 atoms
  using lattice units in orthogonal box = (-9705 -100 -100) to (9705 100 100)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 3000 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 2001 atoms
  using lattice units in orthogonal box = (-9705 -100 -100) to (9705 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  3000 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  3000 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  2001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  2001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
3000 atoms in group substrate
group slider1 region slider1
2001 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 2001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_47_*.dump id type diameter mass xu yu zu fx fy fz
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 12523 130 130
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 448.7 | 448.7 | 448.7 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   19410          200            200            0              0              0              0              0              0              0              1.1971759e-13  0              6            
    100000   19410          200            200            0.002076844    6.24261e-36    0              0.0062305319   1155273.7      0              5.5784033e+10  1.1971759e-13  0              3.3318395    
    200000   19410          200            200            0.00070233149  9.9881927e-35  0              0.0021069945   261607.94      0              1.2632111e+10  1.1971759e-13  0              3.083268     
    300000   19410          200            200           -6.8830663e-06 -3.3293644e-35  0             -2.0649199e-05  55.652653      0              2687267.4      1.1971759e-13  0              3.0436272    
    400000   19410          200            200           -1.0938744e-05 -1.6646937e-35  0             -3.2816233e-05  146.31368      0              7064964        1.1971759e-13  0              3.0053152    
    500000   19410          200            200            0.0011241621  -0.00027325866  0              0.0036457449   1793.4576      0              86599651       1.1971759e-13  0              2.9958294    
    600000   19410          200            200            0.0020290816  -7.1779272e-05  0              0.006159024    240.69907      0              11622497       1.1971759e-13  0              2.9946786    
    700000   19410          200            200            0.0028438547   0.00015917081  0              0.0083723932   28.572557      0              1379666.5      1.1971759e-13  0              2.9937669    
    800000   19410          200            200            0.0025185941   9.507449e-05   0              0.0074607078   3.3043663      0              159556.02      1.1971759e-13  0              2.9941238    
    900000   19410          200            200            0.0026405652   9.9963949e-05  0              0.0078217317   0.33459738     0              16156.51       1.1971759e-13  0              2.9939801    
   1000000   19410          200            200            0.0025901642   9.6930303e-05  0              0.0076735624   0.027221975    0              1314.4518      1.1971759e-13  0              2.9940385    
   1100000   19410          200            200            0.0026104925   9.8133043e-05  0              0.0077333445   0.0017617985   0              85.070943      1.1971759e-13  0              2.994015     
   1200000   19410          200            200            0.0026025393   9.766158e-05   0              0.0077099562   6.6937439e-05  0              3.2321693      1.1971759e-13  0              2.9940241    
   1300000   19410          200            200            0.0026055623   9.7839807e-05  0              0.0077188471   7.9380343e-08  0              0.0038329927   1.1971759e-13  0              2.9940207    
   1400000   19410          200            200            0.0026044423   9.7773928e-05  0              0.0077155529   8.0382835e-07  0              0.038813994    1.1971759e-13  0              2.994022     
   1500000   19410          200            200            0.0026048467   9.7797635e-05  0              0.0077167426   4.7231159e-07  0              0.022806236    1.1971759e-13  0              2.9940215    
   1600000   19410          200            200            0.0026047044   9.7789323e-05  0              0.007716324    1.4222798e-07  0              0.00686768     1.1971759e-13  0              2.9940217    
   1700000   19410          200            200            0.0026047531   9.7792153e-05  0              0.0077164671   3.2649886e-08  0              0.0015765461   1.1971759e-13  0              2.9940216    
   1800000   19410          200            200            0.002604737    9.7791221e-05  0              0.0077164198   6.4218414e-09  0              0.00031008774  1.1971759e-13  0              2.9940216    
   1900000   19410          200            200            0.0026047421   9.7791515e-05  0              0.0077164348   1.1378667e-09  0              5.4943513e-05  1.1971759e-13  0              2.9940216    
   2000000   19410          200            200            0.0026047406   9.7791428e-05  0              0.0077164303   1.8634436e-10  0              8.9979024e-06  1.1971759e-13  0              2.9940216    
   2100000   19410          200            200            0.002604741    9.7791452e-05  0              0.0077164315   2.8612993e-11  0              1.381619e-06   1.1971759e-13  0              2.9940216    
   2200000   19410          200            200            0.0026047409   9.7791446e-05  0              0.0077164312   4.1528365e-12  0              2.0052561e-07  1.1971759e-13  0              2.9940216    
   2300000   19410          200            200            0.0026047409   9.7791447e-05  0              0.0077164313   5.721539e-13   0              2.7627264e-08  1.1971759e-13  0              2.9940216    
   2400000   19410          200            200            0.0026047409   9.7791447e-05  0              0.0077164313   7.4855006e-14  0              3.6144803e-09  1.1971759e-13  0              2.9940216    
   2500000   19410          200            200            0.0026047409   9.7791447e-05  0              0.0077164313   9.2617757e-15  0              4.47218e-10    1.1971759e-13  0              2.9940216    
   2600000   19410          200            200            0.0026047409   9.7791447e-05  0              0.0077164313   1.0782139e-15  0              5.2063091e-11  1.1971759e-13  0              2.9940216    
   2700000   19410          200            200            0.0026047409   9.7791447e-05  0              0.0077164313   1.578296e-16   0              7.6210267e-12  1.1971759e-13  0              2.9940216    
   2800000   19410          200            200            0.0026047409   9.7791447e-05  0              0.0077164313   2.3682096e-17  0              1.1435237e-12  1.1971759e-13  0              2.9940216    
   2900000   19410          200            200            0.0026047409   9.7791447e-05  0              0.0077164313   3.9065526e-18  0              1.8863345e-13  1.1971759e-13  0              2.9940216    
   3000000   19410          200            200            0.0026047409   9.7791446e-05  0              0.0077164313   8.7093796e-19  0              4.2054477e-14  1.1971759e-13  0              2.9940216    
Loop time of 727.277 on 2 procs for 3000000 steps with 5001 atoms

Performance: 3563979.118 ns/day, 0.000 hours/ns, 4124.976 timesteps/s
99.9% CPU use with 2 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 162.64     | 163.57     | 164.5      |   7.3 | 22.49
Neigh   | 23.764     | 23.767     | 23.771     |   0.1 |  3.27
Comm    | 55.258     | 56.271     | 57.283     |  13.5 |  7.74
Output  | 0.65136    | 0.65137    | 0.65138    |   0.0 |  0.09
Modify  | 426        | 426.03     | 426.06     |   0.1 | 58.58
Other   |            | 56.98      |            |       |  7.83

Nlocal:         2500.5 ave        2501 max        2500 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Nghost:            2.5 ave           3 max           2 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Neighs:         1242.5 ave        1243 max        1242 min
Histogram: 1 0 0 0 0 0 0 0 0 1

Total # of neighbors = 2485
Ave neighs/atom = 0.49690062
Neighbor list builds = 166
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 48

#variable lat0 equal 1                    #
variable lat1 equal 3+((300)*0.01)+(v_ind*0.01)        # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 1000*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 6.48                                                               
Lattice spacing in x,y,z = 6.48 6.48 6.48

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -9720 ${n1e1} -100 100 -100 100 units box
region box block -9720 9720 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -9720 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -9720 9720 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-9720 -100 -100) to (9720 100 100)
  2 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 3000 atoms
  using lattice units in orthogonal box = (-9720 -100 -100) to (9720 100 100)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 3000 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 2001 atoms
  using lattice units in orthogonal box = (-9720 -100 -100) to (9720 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  3000 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  3000 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  2001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  2001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
3000 atoms in group substrate
group slider1 region slider1
2001 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 2001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_48_*.dump id type diameter mass xu yu zu fx fy fz
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 12542 130 130
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 449.4 | 449.4 | 449.4 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   19440          200            200            0              0              0              0              0              0              0              1.1971759e-13  0              6            
    100000   19440          200            200            0.0020739181  -4.9863733e-35  0              0.0062217544   1155514.1      0              5.5795641e+10  1.1971759e-13  0              3.3317175    
    200000   19440          200            200            0.0007019622   6.6485225e-35  0              0.0021058866   262029.14      0              1.2652449e+10  1.1971759e-13  0              3.0830716    
    300000   19440          200            200           -6.0722596e-06  1.6621284e-35  0             -1.8216779e-05  43.286829      0              2090166.1      1.1971759e-13  0              3.043677     
    400000   19440          200            200           -9.0599962e-06  1.3297027e-34  0             -2.7179989e-05  100.08214      0              4832608.3      1.1971759e-13  0              3.0053564    
    500000   19440          200            200            0.0010071033  -0.0010120361   0              0.004033346    2090.513       0              1.0094339e+08  1.1971759e-13  0              2.9956474    
    600000   19440          200            200            0.0023598191  -0.0016629112   0              0.0087423686   327.96318      0              15836168       1.1971759e-13  0              2.9937802    
    700000   19440          200            200            0.0016635836  -0.0017413743   0              0.0067321251   2.3511605      0              113529.12      1.1971759e-13  0              2.9945253    
    800000   19440          200            200            0.0020477202  -0.0018086239   0              0.0079517845   3.7292964      0              180074.38      1.1971759e-13  0              2.9940524    
    900000   19440          200            200            0.0019836372  -0.0017985338   0              0.0077494455   0.82008444     0              39598.942      1.1971759e-13  0              2.9941318    
   1000000   19440          200            200            0.0019539222  -0.0017939857   0              0.0076557524   0.003732546    0              180.23129      1.1971759e-13  0              2.9941665    
   1100000   19440          200            200            0.0019730455  -0.0017970212   0              0.0077161577   0.010033492    0              484.48142      1.1971759e-13  0              2.9941434    
   1200000   19440          200            200            0.0019702988  -0.0017965684   0              0.0077074649   0.0018975398   0              91.625405      1.1971759e-13  0              2.9941469    
   1300000   19440          200            200            0.0019686938  -0.001796322    0              0.0077024034   3.602205e-06   0              0.17393759     1.1971759e-13  0              2.9941488    
   1400000   19440          200            200            0.0019696295  -0.00179647     0              0.0077053585   2.6924451e-05  0              1.3000854      1.1971759e-13  0              2.9941476    
   1500000   19440          200            200            0.0019695153  -0.0017964509   0              0.0077049967   4.3510011e-06  0              0.21009427     1.1971759e-13  0              2.9941478    
   1600000   19440          200            200            0.0019694297  -0.0017964377   0              0.0077047269   1.446616e-09   0              6.9851908e-05  1.1971759e-13  0              2.9941479    
   1700000   19440          200            200            0.0019694753  -0.001796445    0              0.0077048707   7.1355528e-08  0              0.0034455031   1.1971759e-13  0              2.9941478    
   1800000   19440          200            200            0.0019694707  -0.0017964442   0              0.0077048563   9.8717819e-09  0              0.00047667302  1.1971759e-13  0              2.9941478    
   1900000   19440          200            200            0.0019694662  -0.0017964435   0              0.007704842    7.624527e-13   0              3.6816112e-08  1.1971759e-13  0              2.9941478    
   2000000   19440          200            200            0.0019694684  -0.0017964438   0              0.007704849    1.8690553e-10  0              9.0249991e-06  1.1971759e-13  0              2.9941478    
   2100000   19440          200            200            0.0019694682  -0.0017964438   0              0.0077048485   2.2141514e-11  0              1.0691345e-06  1.1971759e-13  0              2.9941478    
   2200000   19440          200            200            0.001969468   -0.0017964438   0              0.0077048477   3.1649871e-14  0              1.528259e-09   1.1971759e-13  0              2.9941478    
   2300000   19440          200            200            0.0019694681  -0.0017964438   0              0.0077048481   4.8428003e-13  0              2.338415e-08   1.1971759e-13  0              2.9941478    
   2400000   19440          200            200            0.0019694681  -0.0017964438   0              0.007704848    4.9154795e-14  0              2.3735091e-09  1.1971759e-13  0              2.9941478    
   2500000   19440          200            200            0.0019694681  -0.0017964438   0              0.007704848    2.222994e-16   0              1.0734043e-11  1.1971759e-13  0              2.9941478    
   2600000   19440          200            200            0.0019694681  -0.0017964438   0              0.007704848    1.2176316e-15  0              5.8795071e-11  1.1971759e-13  0              2.9941478    
   2700000   19440          200            200            0.0019694681  -0.0017964438   0              0.007704848    6.6812228e-17  0              3.2261234e-12  1.1971759e-13  0              2.9941478    
   2800000   19440          200            200            0.0019694681  -0.0017964438   0              0.007704848    8.8763992e-18  0              4.2860955e-13  1.1971759e-13  0              2.9941478    
   2900000   19440          200            200            0.0019694681  -0.0017964438   0              0.007704848    1.0208516e-17  0              4.9293271e-13  1.1971759e-13  0              2.9941478    
   3000000   19440          200            200            0.0019694681  -0.0017964438   0              0.007704848    8.3851281e-18  0              4.0488782e-13  1.1971759e-13  0              2.9941478    
Loop time of 726.973 on 2 procs for 3000000 steps with 5001 atoms

Performance: 3565467.893 ns/day, 0.000 hours/ns, 4126.699 timesteps/s
99.9% CPU use with 2 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 160.9      | 163.05     | 165.21     |  16.8 | 22.43
Neigh   | 23.871     | 23.874     | 23.877     |   0.1 |  3.28
Comm    | 54.076     | 56.194     | 58.312     |  28.3 |  7.73
Output  | 0.64271    | 0.64274    | 0.64276    |   0.0 |  0.09
Modify  | 425.98     | 426.08     | 426.18     |   0.5 | 58.61
Other   |            | 57.13      |            |       |  7.86

Nlocal:         2500.5 ave        2501 max        2500 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Nghost:            2.5 ave           3 max           2 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Neighs:         1241.5 ave        1242 max        1241 min
Histogram: 1 0 0 0 0 0 0 0 0 1

Total # of neighbors = 2483
Ave neighs/atom = 0.4965007
Neighbor list builds = 166
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 49

#variable lat0 equal 1                    #
variable lat1 equal 3+((300)*0.01)+(v_ind*0.01)        # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 1000*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 6.49                                                               
Lattice spacing in x,y,z = 6.49 6.49 6.49

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -9735 ${n1e1} -100 100 -100 100 units box
region box block -9735 9735 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -9735 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -9735 9735 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-9735 -100 -100) to (9735 100 100)
  2 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 3000 atoms
  using lattice units in orthogonal box = (-9735 -100 -100) to (9735 100 100)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 3000 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 2001 atoms
  using lattice units in orthogonal box = (-9735 -100 -100) to (9735 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  3000 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  3000 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  2001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  2001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
3000 atoms in group substrate
group slider1 region slider1
2001 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 2001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_49_*.dump id type diameter mass xu yu zu fx fy fz
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 12562 130 130
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 450.1 | 450.1 | 450.1 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   19470          200            200            0              0              0              0              0              0              0              1.1971759e-13  0              6            
    100000   19470          200            200            0.0020703098   2.0744586e-36  0              0.0062109294   1155150        0              5.577806e+10   1.1971759e-13  0              3.3319311    
    200000   19470          200            200            0.0006993968  -1.6595633e-35  0              0.0020981904   261144.38      0              1.2609728e+10  1.1971759e-13  0              3.0835832    
    300000   19470          200            200           -8.1191322e-06  3.3191365e-35  0             -2.4357397e-05  78.300865      0              3780868.6      1.1971759e-13  0              3.0436842    
    400000   19470          200            200           -1.2000514e-05 -8.2978017e-36  0             -3.6001542e-05  177.75134      0              8582976.3      1.1971759e-13  0              3.0053788    
    500000   19470          200            200            0.0004801374  -0.0016695366   0              0.0031099488   1477.1241      0              71325037       1.1971759e-13  0              2.9962026    
    600000   19470          200            200            0.0018704346  -0.0015925897   0              0.0072038934   364.42436      0              17596748       1.1971759e-13  0              2.9943182    
    700000   19470          200            200            0.0020560609  -0.0013669386   0              0.0075351213   49.249973      0              2378104.9      1.1971759e-13  0              2.9941589    
    800000   19470          200            200            0.0022049456  -0.0012467934   0              0.0078616303   5.374382       0              259509.67      1.1971759e-13  0              2.9940425    
    900000   19470          200            200            0.0021195282  -0.0012368602   0              0.0075954448   0.4357143      0              21039.084      1.1971759e-13  0              2.9941421    
   1000000   19470          200            200            0.0021650044  -0.0012427158   0              0.007737729    0.021669677    0              1046.3512      1.1971759e-13  0              2.9940879    
   1100000   19470          200            200            0.0021449014  -0.0012401943   0              0.0076748984   0.00016704007  0              8.065767       1.1971759e-13  0              2.994112     
   1200000   19470          200            200            0.002152699   -0.0012411962   0              0.0076992933   0.00011719436  0              5.6588961      1.1971759e-13  0              2.9941025    
   1300000   19470          200            200            0.0021499938  -0.0012408486   0              0.0076908301   8.5391759e-05  0              4.1232624      1.1971759e-13  0              2.9941058    
   1400000   19470          200            200            0.002150819   -0.0012409559   0              0.0076934129   2.4488283e-05  0              1.1824516      1.1971759e-13  0              2.9941048    
   1500000   19470          200            200            0.0021506109  -0.0012409284   0              0.0076927611   4.7809016e-06  0              0.23085263     1.1971759e-13  0              2.9941051    
   1600000   19470          200            200            0.0021506441  -0.001240933    0              0.0076928654   7.2207309e-07  0              0.034866325    1.1971759e-13  0              2.994105     
   1700000   19470          200            200            0.0021506491  -0.0012409335   0              0.0076928808   8.6911695e-08  0              0.0041966547   1.1971759e-13  0              2.994105     
   1800000   19470          200            200            0.0021506412  -0.0012409326   0              0.0076928561   8.1031587e-09  0              0.00039127253  1.1971759e-13  0              2.994105     
   1900000   19470          200            200            0.002150646   -0.0012409332   0              0.0076928712   5.1675139e-10  0              2.4952075e-05  1.1971759e-13  0              2.994105     
   2000000   19470          200            200            0.0021506437  -0.0012409329   0              0.0076928641   1.3295873e-11  0              6.4201011e-07  1.1971759e-13  0              2.994105     
   2100000   19470          200            200            0.0021506447  -0.001240933    0              0.007692867    2.8160023e-13  0              1.3597467e-08  1.1971759e-13  0              2.994105     
   2200000   19470          200            200            0.0021506443  -0.001240933    0              0.0076928659   7.3633107e-13  0              3.5554792e-08  1.1971759e-13  0              2.994105     
   2300000   19470          200            200            0.0021506444  -0.001240933    0              0.0076928662   2.7397885e-13  0              1.3229458e-08  1.1971759e-13  0              2.994105     
   2400000   19470          200            200            0.0021506444  -0.001240933    0              0.0076928661   6.1132731e-14  0              2.9518808e-09  1.1971759e-13  0              2.994105     
   2500000   19470          200            200            0.0021506444  -0.001240933    0              0.0076928662   1.0186343e-14  0              4.9186205e-10  1.1971759e-13  0              2.994105     
   2600000   19470          200            200            0.0021506444  -0.001240933    0              0.0076928662   1.3342666e-15  0              6.4426959e-11  1.1971759e-13  0              2.994105     
   2700000   19470          200            200            0.0021506444  -0.001240933    0              0.0076928662   9.0188e-17     0              4.3548558e-12  1.1971759e-13  0              2.994105     
   2800000   19470          200            200            0.0021506444  -0.001240933    0              0.0076928662   1.1900245e-19  0              5.7462023e-15  1.1971759e-13  0              2.994105     
   2900000   19470          200            200            0.0021506444  -0.001240933    0              0.0076928662   5.0612528e-20  0              2.4438978e-15  1.1971759e-13  0              2.994105     
   3000000   19470          200            200            0.0021506444  -0.001240933    0              0.0076928662   5.0523279e-19  0              2.4395883e-14  1.1971759e-13  0              2.994105     
Loop time of 726.729 on 2 procs for 3000000 steps with 5001 atoms

Performance: 3566668.405 ns/day, 0.000 hours/ns, 4128.088 timesteps/s
100.0% CPU use with 2 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 161.74     | 162.66     | 163.59     |   7.3 | 22.38
Neigh   | 23.875     | 23.877     | 23.88      |   0.0 |  3.29
Comm    | 54.385     | 55.4       | 56.415     |  13.6 |  7.62
Output  | 0.64314    | 0.64315    | 0.64316    |   0.0 |  0.09
Modify  | 426.4      | 426.49     | 426.59     |   0.5 | 58.69
Other   |            | 57.65      |            |       |  7.93

Nlocal:         2500.5 ave        2501 max        2500 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Nghost:            2.5 ave           3 max           2 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Neighs:         1241.5 ave        1242 max        1241 min
Histogram: 1 0 0 0 0 0 0 0 0 1

Total # of neighbors = 2483
Ave neighs/atom = 0.4965007
Neighbor list builds = 166
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 50

#variable lat0 equal 1                    #
variable lat1 equal 3+((300)*0.01)+(v_ind*0.01)        # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 1000*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 6.5                                                               
Lattice spacing in x,y,z = 6.5 6.5 6.5

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -9750 ${n1e1} -100 100 -100 100 units box
region box block -9750 9750 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -9750 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -9750 9750 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-9750 -100 -100) to (9750 100 100)
  2 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 3000 atoms
  using lattice units in orthogonal box = (-9750 -100 -100) to (9750 100 100)
  create_atoms CPU = 0.002 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 3000 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 2001 atoms
  using lattice units in orthogonal box = (-9750 -100 -100) to (9750 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  3000 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  3000 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  2001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  2001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
3000 atoms in group substrate
group slider1 region slider1
2001 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 2001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_50_*.dump id type diameter mass xu yu zu fx fy fz
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 12581 130 130
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 450.7 | 450.7 | 450.7 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   19500          200            200            0              0              0              0              0              0              0              1.1971759e-13  0              6            
    100000   19500          200            200            0.0020621428   4.1425375e-36  0              0.0061864285   1150359.3      0              5.5546734e+10  1.1971759e-13  0              3.3361189    
    200000   19500          200            200            0.00067278061  3.8111291e-34  0              0.0020183418   245827.36      0              1.1870123e+10  1.1971759e-13  0              3.0949362    
    300000   19500          200            200           -3.0435943e-05 -1.6570058e-35  0             -9.1307828e-05  1167.3989      0              56369513       1.1971759e-13  0              3.0458748    
    400000   19500          200            200            3.8166071e-06 -2.1541156e-34  0              1.1449821e-05  18.039697      0              871072.4       1.1971759e-13  0              3.00808      
    500000   19500          200            200            0.00032107831  8.2850664e-35  0              0.00096323494  776.16931      0              37478438       1.1971759e-13  0              2.9990826    
    600000   19500          200            200            0.0033593402  -1.6570086e-35  0              0.010078021    234.99216      0              11346930       1.1971759e-13  0              2.9958311    
    700000   19500          200            200            0.0021855222   3.5820791e-41  0              0.0065565667   7.0760421      0              341676.75      1.1971759e-13  0              2.9968641    
    800000   19500          200            200            0.0025478382   8.2850936e-36  0              0.0076435146   7.9454527      0              383657.48      1.1971759e-13  0              2.9965214    
    900000   19500          200            200            0.0026168216   3.3140276e-35  0              0.0078504648   0.031830256    0              1536.9691      1.1971759e-13  0              2.9964613    
   1000000   19500          200            200            0.0025542454  -4.1425288e-35  0              0.0076627363   0.11985134     0              5787.1924      1.1971759e-13  0              2.9965181    
   1100000   19500          200            200            0.0025565951   6.6280521e-35  0              0.0076697853   0.0075797339   0              365.99822      1.1971759e-13  0              2.9965156    
   1200000   19500          200            200            0.0025645526  -1.6570093e-35  0              0.0076936579   0.00093823996  0              45.30425       1.1971759e-13  0              2.9965085    
   1300000   19500          200            200            0.0025627879   3.6963494e-41  0              0.0076883637   0.00029847928  0              14.412496      1.1971759e-13  0              2.9965101    
   1400000   19500          200            200            0.002562041    3.3140287e-35  0              0.0076861231   9.284933e-07   0              0.044833619    1.1971759e-13  0              2.9965108    
   1500000   19500          200            200            0.0025624141  -3.3140211e-35  0              0.0076872423   6.2272846e-06  0              0.30069329     1.1971759e-13  0              2.9965104    
   1600000   19500          200            200            0.0025624464   3.3140287e-35  0              0.0076873392   1.0593154e-07  0              0.0051150547   1.1971759e-13  0              2.9965104    
   1700000   19500          200            200            0.0025623904   8.2851002e-36  0              0.0076871713   7.6041965e-08  0              0.0036717944   1.1971759e-13  0              2.9965104    
   1800000   19500          200            200            0.0025623963  -5.7995398e-35  0              0.0076871889   8.8297661e-09  0              0.0004263578   1.1971759e-13  0              2.9965104    
   1900000   19500          200            200            0.0025624027   3.7977261e-41  0              0.0076872082   3.9600702e-10  0              1.9121762e-05  1.1971759e-13  0              2.9965104    
   2000000   19500          200            200            0.0025624008   1.6570162e-35  0              0.0076872023   2.6391207e-10  0              1.2743369e-05  1.1971759e-13  0              2.9965104    
   2100000   19500          200            200            0.0025624003  -1.6570087e-35  0              0.0076872008   8.3848378e-14  0              4.0487381e-09  1.1971759e-13  0              2.9965104    
   2200000   19500          200            200            0.0025624006  -2.4855149e-35  0              0.0076872019   4.5302876e-12  0              2.1875137e-07  1.1971759e-13  0              2.9965104    
   2300000   19500          200            200            0.0025624006   3.799659e-41   0              0.0076872019   1.8161126e-13  0              8.7693579e-09  1.1971759e-13  0              2.9965104    
   2400000   19500          200            200            0.0025624006   1.2427631e-35  0              0.0076872017   4.3288949e-14  0              2.0902684e-09  1.1971759e-13  0              2.9965104    
   2500000   19500          200            200            0.0025624006  -2.0712618e-35  0              0.0076872018   9.140709e-15   0              4.4137212e-10  1.1971759e-13  0              2.9965104    
   2600000   19500          200            200            0.0025624006   3.7957449e-41  0              0.0076872018   7.9995198e-17  0              3.8626818e-12  1.1971759e-13  0              2.9965104    
   2700000   19500          200            200            0.0025624006  -2.0712618e-35  0              0.0076872018   2.1326708e-16  0              1.0297904e-11  1.1971759e-13  0              2.9965104    
   2800000   19500          200            200            0.0025624006  -3.3140211e-35  0              0.0076872018   1.874817e-19   0              9.0528204e-15  1.1971759e-13  0              2.9965104    
   2900000   19500          200            200            0.0025624006   8.2851002e-36  0              0.0076872018   1.3176574e-18  0              6.3624961e-14  1.1971759e-13  0              2.9965104    
   3000000   19500          200            200            0.0025624006  -4.1424931e-36  0              0.0076872018   2.3820849e-18  0              1.1502236e-13  1.1971759e-13  0              2.9965104    
Loop time of 729.498 on 2 procs for 3000000 steps with 5001 atoms

Performance: 3553127.848 ns/day, 0.000 hours/ns, 4112.416 timesteps/s
100.0% CPU use with 2 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 160.79     | 163.92     | 167.05     |  24.5 | 22.47
Neigh   | 24.014     | 24.018     | 24.021     |   0.1 |  3.29
Comm    | 54.218     | 57.373     | 60.528     |  41.7 |  7.86
Output  | 0.5995     | 0.59953    | 0.59955    |   0.0 |  0.08
Modify  | 426.37     | 426.44     | 426.5      |   0.3 | 58.46
Other   |            | 57.15      |            |       |  7.83

Nlocal:         2500.5 ave        2501 max        2500 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Nghost:            2.5 ave           3 max           2 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Neighs:         1230.5 ave        1231 max        1230 min
Histogram: 1 0 0 0 0 0 0 0 0 1

Total # of neighbors = 2461
Ave neighs/atom = 0.49210158
Neighbor list builds = 166
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 51

#variable lat0 equal 1                    #
variable lat1 equal 3+((300)*0.01)+(v_ind*0.01)        # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 1000*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 6.51                                                               
Lattice spacing in x,y,z = 6.51 6.51 6.51

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -9765 ${n1e1} -100 100 -100 100 units box
region box block -9765 9765 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -9765 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -9765 9765 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-9765 -100 -100) to (9765 100 100)
  2 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 3000 atoms
  using lattice units in orthogonal box = (-9765 -100 -100) to (9765 100 100)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 3000 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 2001 atoms
  using lattice units in orthogonal box = (-9765 -100 -100) to (9765 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  3000 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  3000 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  2001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  2001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
3000 atoms in group substrate
group slider1 region slider1
2001 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 2001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_51_*.dump id type diameter mass xu yu zu fx fy fz
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 12600 130 130
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 451.4 | 451.4 | 451.4 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   19530          200            200            0              0              0              0              0              0              0              1.1971759e-13  0              6            
    100000   19530          200            200            0.0020638999   1.6544736e-35  0              0.0061916996   1155105.5      0              5.577591e+10   1.1971759e-13  0              3.3319597    
    200000   19530          200            200            0.00069714514  1.6544708e-35  0              0.0020914354   261082.82      0              1.2606755e+10  1.1971759e-13  0              3.0836188    
    300000   19530          200            200           -8.1524493e-06 -3.3089309e-35  0             -2.4457348e-05  79.449137      0              3836314.5      1.1971759e-13  0              3.0436835    
    400000   19530          200            200           -1.2037735e-05 -3.3089304e-35  0             -3.6113205e-05  179.99829      0              8691473.2      1.1971759e-13  0              3.0053777    
    500000   19530          200            200            0.0013909885   0.001086832    0              0.0030861336   1471.9569      0              71075531       1.1971759e-13  0              2.9962068    
    600000   19530          200            200            0.002639766    0.00077988199  0              0.0071394159   363.04062      0              17529932       1.1971759e-13  0              2.9943313    
    700000   19530          200            200            0.0025940285   0.00049971782  0              0.0072823677   43.351681      0              2093297.5      1.1971759e-13  0              2.9942465    
    800000   19530          200            200            0.0028639541   0.00056787282  0              0.0080239896   0.61207633     0              29554.976      1.1971759e-13  0              2.9939696    
    900000   19530          200            200            0.0027054026   0.00055351155  0              0.0075626963   0.33039814     0              15953.744      1.1971759e-13  0              2.9941448    
   1000000   19530          200            200            0.002739906    0.00055282585  0              0.0076668922   0.12215844     0              5898.5939      1.1971759e-13  0              2.9941038    
   1100000   19530          200            200            0.0027457487   0.00055270256  0              0.0076845436   0.0048639628   0              234.86336      1.1971759e-13  0              2.9940975    
   1200000   19530          200            200            0.0027386504   0.00055286116  0              0.0076630901   0.00031213044  0              15.071662      1.1971759e-13  0              2.9941056    
   1300000   19530          200            200            0.0027408543   0.00055281166  0              0.0076697512   0.00028268733  0              13.649959      1.1971759e-13  0              2.994103     
   1400000   19530          200            200            0.0027408814   0.0005528115   0              0.0076698328   2.2082962e-05  0              1.0663072      1.1971759e-13  0              2.994103     
   1500000   19530          200            200            0.0027405736   0.00055281827  0              0.0076689025   8.0481427e-08  0              0.0038861601   1.1971759e-13  0              2.9941034    
   1600000   19530          200            200            0.0027406995   0.00055281544  0              0.0076692831   5.6462693e-07  0              0.027263814    1.1971759e-13  0              2.9941032    
   1700000   19530          200            200            0.0027406879   0.00055281572  0              0.007669248    7.7323739e-08  0              0.0037336866   1.1971759e-13  0              2.9941033    
   1800000   19530          200            200            0.0027406759   0.00055281599  0              0.0076692116   2.547742e-10   0              1.2302134e-05  1.1971759e-13  0              2.9941033    
   1900000   19530          200            200            0.0027406825   0.00055281584  0              0.0076692317   9.4138309e-10  0              4.545602e-05   1.1971759e-13  0              2.9941033    
   2000000   19530          200            200            0.0027406813   0.00055281586  0              0.0076692281   2.2676983e-10  0              1.0949904e-05  1.1971759e-13  0              2.9941033    
   2100000   19530          200            200            0.0027406809   0.00055281587  0              0.0076692269   4.8863269e-12  0              2.3594324e-07  1.1971759e-13  0              2.9941033    
   2200000   19530          200            200            0.0027406813   0.00055281587  0              0.0076692279   1.2004891e-12  0              5.7967321e-08  1.1971759e-13  0              2.9941033    
   2300000   19530          200            200            0.0027406812   0.00055281587  0              0.0076692276   5.7516088e-13  0              2.777246e-08   1.1971759e-13  0              2.9941033    
   2400000   19530          200            200            0.0027406812   0.00055281587  0              0.0076692276   2.9433309e-14  0              1.4212292e-09  1.1971759e-13  0              2.9941033    
   2500000   19530          200            200            0.0027406812   0.00055281587  0              0.0076692277   8.5397519e-16  0              4.1235405e-11  1.1971759e-13  0              2.9941033    
   2600000   19530          200            200            0.0027406812   0.00055281587  0              0.0076692276   1.2505058e-15  0              6.0382448e-11  1.1971759e-13  0              2.9941033    
   2700000   19530          200            200            0.0027406812   0.00055281587  0              0.0076692276   7.7879438e-17  0              3.7605193e-12  1.1971759e-13  0              2.9941033    
   2800000   19530          200            200            0.0027406812   0.00055281587  0              0.0076692276   5.353676e-18   0              2.5850985e-13  1.1971759e-13  0              2.9941033    
   2900000   19530          200            200            0.0027406812   0.00055281587  0              0.0076692276   9.6509118e-18  0              4.6600799e-13  1.1971759e-13  0              2.9941033    
   3000000   19530          200            200            0.0027406812   0.00055281587  0              0.0076692276   6.738765e-18   0              3.2539085e-13  1.1971759e-13  0              2.9941033    
Loop time of 728.893 on 2 procs for 3000000 steps with 5001 atoms

Performance: 3556079.746 ns/day, 0.000 hours/ns, 4115.833 timesteps/s
99.9% CPU use with 2 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 163.54     | 164.4      | 165.26     |   6.7 | 22.55
Neigh   | 24.134     | 24.136     | 24.137     |   0.0 |  3.31
Comm    | 55.539     | 56.387     | 57.235     |  11.3 |  7.74
Output  | 0.65318    | 0.6532     | 0.65323    |   0.0 |  0.09
Modify  | 426.26     | 426.39     | 426.51     |   0.6 | 58.50
Other   |            | 56.93      |            |       |  7.81

Nlocal:         2500.5 ave        2501 max        2500 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Nghost:            2.5 ave           3 max           2 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Neighs:         1244.5 ave        1245 max        1244 min
Histogram: 1 0 0 0 0 0 0 0 0 1

Total # of neighbors = 2489
Ave neighs/atom = 0.49770046
Neighbor list builds = 166
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 52

#variable lat0 equal 1                    #
variable lat1 equal 3+((300)*0.01)+(v_ind*0.01)        # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 1000*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 6.52                                                               
Lattice spacing in x,y,z = 6.52 6.52 6.52

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -9780 ${n1e1} -100 100 -100 100 units box
region box block -9780 9780 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -9780 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -9780 9780 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-9780 -100 -100) to (9780 100 100)
  2 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 3000 atoms
  using lattice units in orthogonal box = (-9780 -100 -100) to (9780 100 100)
  create_atoms CPU = 0.002 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 3000 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 2001 atoms
  using lattice units in orthogonal box = (-9780 -100 -100) to (9780 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  3000 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  3000 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  2001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  2001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
3000 atoms in group substrate
group slider1 region slider1
2001 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 2001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_52_*.dump id type diameter mass xu yu zu fx fy fz
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 12620 130 130
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 452.1 | 452.1 | 452.1 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   19560          200            200            0              0              0              0              0              0              0              1.1971759e-13  0              6            
    100000   19560          200            200            0.002060541   -8.2596474e-36  0              0.006181623    1154950.1      0              5.5768406e+10  1.1971759e-13  0              3.3319952    
    200000   19560          200            200            0.00069579033 -8.2596382e-36  0              0.002087371    260919.91      0              1.2598889e+10  1.1971759e-13  0              3.0836256    
    300000   19560          200            200           -8.5742029e-06 -9.9115496e-35  0             -2.5722609e-05  88.294528      0              4263426.8      1.1971759e-13  0              3.0436015    
    400000   19560          200            200           -1.346609e-05   3.7033547e-41  0             -4.0398271e-05  226.87534      0              10954998       1.1971759e-13  0              3.0052895    
    500000   19560          200            200            0.0012597763   0.00012397907  0              0.0036553498   1829.6634      0              88347899       1.1971759e-13  0              2.995819     
    600000   19560          200            200            0.0023360965   0.00064745062  0              0.0063608389   281.94408      0              13614070       1.1971759e-13  0              2.994599     
    700000   19560          200            200            0.003225632    0.0013723426   0              0.0083045533   28.562468      0              1379179.4      1.1971759e-13  0              2.9937975    
    800000   19560          200            200            0.0028756153   0.0012364589   0              0.0073903871   2.9631534      0              143080.07      1.1971759e-13  0              2.9941596    
    900000   19560          200            200            0.0030077954   0.0012599853   0              0.007763401    0.32051051     0              15476.305      1.1971759e-13  0              2.9940104    
   1000000   19560          200            200            0.0029557437   0.0012512568   0              0.0076159743   0.032665262    0              1577.2886      1.1971759e-13  0              2.9940689    
   1100000   19560          200            200            0.0029760103   0.0012547235   0              0.0076733076   0.0031524417   0              152.22013      1.1971759e-13  0              2.9940461    
   1200000   19560          200            200            0.0029682136   0.0012534042   0              0.0076512367   0.00027809142  0              13.428039      1.1971759e-13  0              2.9940549    
   1300000   19560          200            200            0.0029711832   0.0012539074   0              0.0076596423   2.1462008e-05  0              1.0363235      1.1971759e-13  0              2.9940515    
   1400000   19560          200            200            0.0029700627   0.0012537181   0              0.0076564701   1.3010889e-06  0              0.062824928    1.1971759e-13  0              2.9940528    
   1500000   19560          200            200            0.0029704818   0.0012537888   0              0.0076576566   4.4146498e-08  0              0.0021316764   1.1971759e-13  0              2.9940523    
   1600000   19560          200            200            0.0029703264   0.0012537626   0              0.0076572166   2.3464651e-15  0              1.133024e-10   1.1971759e-13  0              2.9940525    
   1700000   19560          200            200            0.0029703836   0.0012537723   0              0.0076573784   7.9679041e-10  0              3.8474157e-05  1.1971759e-13  0              2.9940524    
   1800000   19560          200            200            0.0029703627   0.0012537688   0              0.0076573194   4.2546183e-10  0              2.0544029e-05  1.1971759e-13  0              2.9940525    
   1900000   19560          200            200            0.0029703702   0.00125377     0              0.0076573407   1.2701173e-10  0              6.132942e-06   1.1971759e-13  0              2.9940525    
   2000000   19560          200            200            0.0029703675   0.0012537696   0              0.0076573331   2.9790726e-11  0              1.4384876e-06  1.1971759e-13  0              2.9940525    
   2100000   19560          200            200            0.0029703685   0.0012537697   0              0.0076573358   6.1056808e-12  0              2.9482147e-07  1.1971759e-13  0              2.9940525    
   2200000   19560          200            200            0.0029703682   0.0012537697   0              0.0076573348   1.147633e-12   0              5.5415092e-08  1.1971759e-13  0              2.9940525    
   2300000   19560          200            200            0.0029703683   0.0012537697   0              0.0076573352   2.0245976e-13  0              9.776057e-09   1.1971759e-13  0              2.9940525    
   2400000   19560          200            200            0.0029703682   0.0012537697   0              0.007657335    3.3790461e-14  0              1.6316204e-09  1.1971759e-13  0              2.9940525    
   2500000   19560          200            200            0.0029703683   0.0012537697   0              0.0076573351   5.3897341e-15  0              2.6025097e-10  1.1971759e-13  0              2.9940525    
   2600000   19560          200            200            0.0029703683   0.0012537697   0              0.0076573351   7.7947046e-16  0              3.7637839e-11  1.1971759e-13  0              2.9940525    
   2700000   19560          200            200            0.0029703683   0.0012537697   0              0.0076573351   7.4474534e-17  0              3.5961087e-12  1.1971759e-13  0              2.9940525    
   2800000   19560          200            200            0.0029703683   0.0012537697   0              0.0076573351   2.9618473e-18  0              1.4301701e-13  1.1971759e-13  0              2.9940525    
   2900000   19560          200            200            0.0029703683   0.0012537697   0              0.0076573351   2.4801672e-18  0              1.197584e-13   1.1971759e-13  0              2.9940525    
   3000000   19560          200            200            0.0029703683   0.0012537697   0              0.0076573351   8.1934733e-18  0              3.956335e-13   1.1971759e-13  0              2.9940525    
Loop time of 727.805 on 2 procs for 3000000 steps with 5001 atoms

Performance: 3561391.214 ns/day, 0.000 hours/ns, 4121.981 timesteps/s
99.9% CPU use with 2 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 163.33     | 164.82     | 166.31     |  11.6 | 22.65
Neigh   | 24.033     | 24.037     | 24.041     |   0.1 |  3.30
Comm    | 54.168     | 55.663     | 57.157     |  20.0 |  7.65
Output  | 0.65667    | 0.65669    | 0.6567     |   0.0 |  0.09
Modify  | 425.55     | 425.64     | 425.73     |   0.4 | 58.48
Other   |            | 56.99      |            |       |  7.83

Nlocal:         2500.5 ave        2501 max        2500 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Nghost:            2.5 ave           3 max           2 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Neighs:         1238.5 ave        1239 max        1238 min
Histogram: 1 0 0 0 0 0 0 0 0 1

Total # of neighbors = 2477
Ave neighs/atom = 0.49530094
Neighbor list builds = 166
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 53

#variable lat0 equal 1                    #
variable lat1 equal 3+((300)*0.01)+(v_ind*0.01)        # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 1000*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 6.53                                                               
Lattice spacing in x,y,z = 6.53 6.53 6.53

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -9795 ${n1e1} -100 100 -100 100 units box
region box block -9795 9795 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -9795 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -9795 9795 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-9795 -100 -100) to (9795 100 100)
  2 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 3000 atoms
  using lattice units in orthogonal box = (-9795 -100 -100) to (9795 100 100)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 3000 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 2001 atoms
  using lattice units in orthogonal box = (-9795 -100 -100) to (9795 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  3000 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  3000 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  2001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  2001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
3000 atoms in group substrate
group slider1 region slider1
2001 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 2001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_53_*.dump id type diameter mass xu yu zu fx fy fz
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 12639 130 130
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 452.8 | 452.8 | 452.8 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   19590          200            200            0              0              0              0              0              0              0              1.1971759e-13  0              6            
    100000   19590          200            200            0.0020576619   4.1235e-35     0              0.0061729857   1155193.2      0              5.5780147e+10  1.1971759e-13  0              3.33186      
    200000   19590          200            200            0.00069560887  9.8964095e-35  0              0.0020868266   261449.53      0              1.2624462e+10  1.1971759e-13  0              3.0833252    
    300000   19590          200            200           -7.2804752e-06  1.2157525e-40  0             -2.1841425e-05  63.548583      0              3068533.7      1.1971759e-13  0              3.0435957    
    400000   19590          200            200           -1.302679e-05  -7.4222965e-35  0             -3.9080371e-05  212.72255      0              10271611       1.1971759e-13  0              3.0052673    
    500000   19590          200            200            0.0021500323   0.0022527821   0              0.004197315    2099.6436      0              1.0138427e+08  1.1971759e-13  0              2.9955092    
    600000   19590          200            200            0.0017330973  -0.00058012837  0              0.0057794201   176.35048      0              8515333.5      1.1971759e-13  0              2.9948198    
    700000   19590          200            200            0.0017125883  -0.0032894249   0              0.0084271897   19.356129      0              934638.18      1.1971759e-13  0              2.9937186    
    800000   19590          200            200            0.0014434682  -0.0030202285   0              0.007350633    2.1195417      0              102345.08      1.1971759e-13  0              2.99414      
    900000   19590          200            200            0.0015466876  -0.0031229658   0              0.0077630286   0.18677288     0              9018.5937      1.1971759e-13  0              2.9939752    
   1000000   19590          200            200            0.001505487   -0.0030830582   0              0.0075995193   0.011397125    0              550.32637      1.1971759e-13  0              2.9940398    
   1100000   19590          200            200            0.0015214472  -0.0030987608   0              0.0076631026   0.00037703203  0              18.205527      1.1971759e-13  0              2.9940147    
   1200000   19590          200            200            0.0015153796  -0.0030928634   0              0.007639002    9.6026902e-08  0              0.0046367954   1.1971759e-13  0              2.9940242    
   1300000   19590          200            200            0.0015176192  -0.0030950377   0              0.0076478954   8.0415213e-06  0              0.38829629     1.1971759e-13  0              2.9940207    
   1400000   19590          200            200            0.0015168122  -0.0030942584   0              0.007644695    4.0478608e-06  0              0.19545671     1.1971759e-13  0              2.9940219    
   1500000   19590          200            200            0.0015170953  -0.0030945306   0              0.0076458164   1.1571978e-06  0              0.05587694     1.1971759e-13  0              2.9940215    
   1600000   19590          200            200            0.0015169988  -0.0030944383   0              0.0076454347   2.5852192e-07  0              0.012483098    1.1971759e-13  0              2.9940217    
   1700000   19590          200            200            0.0015170306  -0.0030944685   0              0.0076455603   4.997188e-08   0              0.0024129633   1.1971759e-13  0              2.9940216    
   1800000   19590          200            200            0.0015170206  -0.0030944591   0              0.0076455207   8.7434968e-09  0              0.00042219217  1.1971759e-13  0              2.9940216    
   1900000   19590          200            200            0.0015170236  -0.0030944619   0              0.0076455325   1.417619e-09   0              6.845175e-05   1.1971759e-13  0              2.9940216    
   2000000   19590          200            200            0.0015170227  -0.0030944611   0              0.0076455293   2.1582273e-10  0              1.0421307e-05  1.1971759e-13  0              2.9940216    
   2100000   19590          200            200            0.0015170229  -0.0030944613   0              0.00764553     3.108233e-11   0              1.5008545e-06  1.1971759e-13  0              2.9940216    
   2200000   19590          200            200            0.0015170229  -0.0030944613   0              0.0076455299   4.249797e-12   0              2.0520749e-07  1.1971759e-13  0              2.9940216    
   2300000   19590          200            200            0.0015170229  -0.0030944612   0              0.0076455299   5.5221804e-13  0              2.6664633e-08  1.1971759e-13  0              2.9940216    
   2400000   19590          200            200            0.0015170229  -0.0030944613   0              0.0076455299   6.799548e-14   0              3.2832584e-09  1.1971759e-13  0              2.9940216    
   2500000   19590          200            200            0.0015170229  -0.0030944613   0              0.0076455299   7.798765e-15   0              3.7657445e-10  1.1971759e-13  0              2.9940216    
   2600000   19590          200            200            0.0015170229  -0.0030944613   0              0.0076455299   8.452626e-16   0              4.0814706e-11  1.1971759e-13  0              2.9940216    
   2700000   19590          200            200            0.0015170229  -0.0030944613   0              0.0076455299   1.2758193e-16  0              6.1604749e-12  1.1971759e-13  0              2.9940216    
   2800000   19590          200            200            0.0015170229  -0.0030944613   0              0.0076455299   1.9625444e-17  0              9.4764243e-13  1.1971759e-13  0              2.9940216    
   2900000   19590          200            200            0.0015170229  -0.0030944613   0              0.0076455299   4.280603e-18   0              2.06695e-13    1.1971759e-13  0              2.9940216    
   3000000   19590          200            200            0.0015170229  -0.0030944613   0              0.0076455299   9.1084657e-19  0              4.3981521e-14  1.1971759e-13  0              2.9940216    
Loop time of 732.387 on 2 procs for 3000000 steps with 5001 atoms

Performance: 3539113.478 ns/day, 0.000 hours/ns, 4096.196 timesteps/s
99.9% CPU use with 2 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 164.79     | 167.16     | 169.53     |  18.3 | 22.82
Neigh   | 23.962     | 23.965     | 23.967     |   0.1 |  3.27
Comm    | 53.98      | 56.434     | 58.888     |  32.7 |  7.71
Output  | 0.64494    | 0.64495    | 0.64496    |   0.0 |  0.09
Modify  | 426.14     | 426.2      | 426.27     |   0.3 | 58.19
Other   |            | 57.98      |            |       |  7.92

Nlocal:         2500.5 ave        2501 max        2500 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Nghost:            2.5 ave           3 max           2 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Neighs:         1240.5 ave        1241 max        1240 min
Histogram: 1 0 0 0 0 0 0 0 0 1

Total # of neighbors = 2481
Ave neighs/atom = 0.49610078
Neighbor list builds = 166
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 54

#variable lat0 equal 1                    #
variable lat1 equal 3+((300)*0.01)+(v_ind*0.01)        # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 1000*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 6.54                                                               
Lattice spacing in x,y,z = 6.54 6.54 6.54

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -9810 ${n1e1} -100 100 -100 100 units box
region box block -9810 9810 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -9810 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -9810 9810 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-9810 -100 -100) to (9810 100 100)
  2 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 3000 atoms
  using lattice units in orthogonal box = (-9810 -100 -100) to (9810 100 100)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 3000 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 2001 atoms
  using lattice units in orthogonal box = (-9810 -100 -100) to (9810 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  3000 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  3000 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  2001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  2001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
3000 atoms in group substrate
group slider1 region slider1
2001 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 2001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_54_*.dump id type diameter mass xu yu zu fx fy fz
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 12659 130 130
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 453.5 | 453.5 | 453.5 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   19620          200            200            0              0              0              0              0              0              0              1.1971759e-13  0              6            
    100000   19620          200            200            0.0020542738  -8.2343639e-36  0              0.0061628213   1154988.7      0              5.5770272e+10  1.1971759e-13  0              3.3319434    
    200000   19620          200            200            0.00069402263 -6.5874935e-35  0              0.0020820679   261140.88      0              1.2609559e+10  1.1971759e-13  0              3.0834463    
    300000   19620          200            200           -8.1131344e-06  9.2878855e-41  0             -2.4339403e-05  79.418384      0              3834829.6      1.1971759e-13  0              3.0435456    
    400000   19620          200            200           -1.4970955e-05 -6.5874944e-35  0             -4.4912864e-05  283.33646      0              13681304       1.1971759e-13  0              3.0052079    
    500000   19620          200            200            0.002476073    0.0021478957   0              0.0052803231   2486.7763      0              1.2007753e+08  1.1971759e-13  0              2.9949568    
    600000   19620          200            200            0.002419681    0.0019284602   0              0.0053305829   54.965597      0              2654092        1.1971759e-13  0              2.9950054    
    700000   19620          200            200            0.0034003572   0.0019041179   0              0.0082969536   28.752427      0              1388351.8      1.1971759e-13  0              2.9937314    
    800000   19620          200            200            0.0032364668   0.0019921937   0              0.0077172068   6.4364854      0              310794.85      1.1971759e-13  0              2.9939566    
    900000   19620          200            200            0.0031609793   0.0019768892   0              0.0075060486   0.082217729    0              3969.9999      1.1971759e-13  0              2.994035     
   1000000   19620          200            200            0.0032162752   0.0019790105   0              0.0076698151   0.055073643    0              2659.3091      1.1971759e-13  0              2.9939718    
   1100000   19620          200            200            0.0032054111   0.0019785414   0              0.0076376918   0.015652595    0              755.80777      1.1971759e-13  0              2.9939846    
   1200000   19620          200            200            0.0032019503   0.0019784052   0              0.0076274456   0.00020985695  0              10.133241      1.1971759e-13  0              2.9939883    
   1300000   19620          200            200            0.0032046843   0.0019785166   0              0.0076355362   0.0001321555   0              6.3813159      1.1971759e-13  0              2.9939852    
   1400000   19620          200            200            0.0032041442   0.0019784939   0              0.0076339388   3.8159667e-05  0              1.8425938      1.1971759e-13  0              2.9939859    
   1500000   19620          200            200            0.0032039751   0.0019784872   0              0.0076334381   5.2746419e-07  0              0.025469358    1.1971759e-13  0              2.9939861    
   1600000   19620          200            200            0.0032041099   0.0019784927   0              0.0076338371   3.1771341e-07  0              0.015341244    1.1971759e-13  0              2.9939859    
   1700000   19620          200            200            0.0032040831   0.0019784916   0              0.0076337577   9.3040099e-08  0              0.0044925734   1.1971759e-13  0              2.9939859    
   1800000   19620          200            200            0.0032040748   0.0019784912   0              0.0076337333   1.324636e-09   0              6.3961932e-05  1.1971759e-13  0              2.9939859    
   1900000   19620          200            200            0.0032040815   0.0019784915   0              0.0076337529   7.6373455e-10  0              3.6878008e-05  1.1971759e-13  0              2.9939859    
   2000000   19620          200            200            0.0032040801   0.0019784915   0              0.007633749    2.2684043e-10  0              1.0953313e-05  1.1971759e-13  0              2.9939859    
   2100000   19620          200            200            0.0032040797   0.0019784914   0              0.0076337478   3.3273918e-12  0              1.6066784e-07  1.1971759e-13  0              2.9939859    
   2200000   19620          200            200            0.0032040801   0.0019784915   0              0.0076337488   1.8359708e-12  0              8.8652458e-08  1.1971759e-13  0              2.9939859    
   2300000   19620          200            200            0.00320408     0.0019784915   0              0.0076337486   5.5266625e-13  0              2.6686275e-08  1.1971759e-13  0              2.9939859    
   2400000   19620          200            200            0.00320408     0.0019784915   0              0.0076337485   8.3743112e-15  0              4.0436552e-10  1.1971759e-13  0              2.9939859    
   2500000   19620          200            200            0.00320408     0.0019784915   0              0.0076337486   4.3803533e-15  0              2.1151159e-10  1.1971759e-13  0              2.9939859    
   2600000   19620          200            200            0.00320408     0.0019784915   0              0.0076337485   1.3416453e-15  0              6.4783251e-11  1.1971759e-13  0              2.9939859    
   2700000   19620          200            200            0.00320408     0.0019784915   0              0.0076337485   1.2620435e-18  0              6.0939564e-14  1.1971759e-13  0              2.9939859    
   2800000   19620          200            200            0.00320408     0.0019784915   0              0.0076337485   2.4105484e-17  0              1.1639675e-12  1.1971759e-13  0              2.9939859    
   2900000   19620          200            200            0.00320408     0.0019784915   0              0.0076337485   5.8720921e-18  0              2.8354231e-13  1.1971759e-13  0              2.9939859    
   3000000   19620          200            200            0.00320408     0.0019784915   0              0.0076337485   2.2819225e-18  0              1.1018587e-13  1.1971759e-13  0              2.9939859    
Loop time of 732.156 on 2 procs for 3000000 steps with 5001 atoms

Performance: 3540230.491 ns/day, 0.000 hours/ns, 4097.489 timesteps/s
99.9% CPU use with 2 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 164.69     | 166.85     | 169.01     |  16.7 | 22.79
Neigh   | 24.069     | 24.072     | 24.074     |   0.0 |  3.29
Comm    | 54.199     | 56.329     | 58.46      |  28.4 |  7.69
Output  | 0.64633    | 0.64636    | 0.64639    |   0.0 |  0.09
Modify  | 424.88     | 424.99     | 425.1      |   0.5 | 58.05
Other   |            | 59.27      |            |       |  8.10

Nlocal:         2500.5 ave        2501 max        2500 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Nghost:            2.5 ave           3 max           2 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Neighs:         1247.5 ave        1248 max        1247 min
Histogram: 1 0 0 0 0 0 0 0 0 1

Total # of neighbors = 2495
Ave neighs/atom = 0.49890022
Neighbor list builds = 166
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 55

#variable lat0 equal 1                    #
variable lat1 equal 3+((300)*0.01)+(v_ind*0.01)        # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 1000*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 6.55                                                               
Lattice spacing in x,y,z = 6.55 6.55 6.55

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -9825 ${n1e1} -100 100 -100 100 units box
region box block -9825 9825 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -9825 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -9825 9825 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-9825 -100 -100) to (9825 100 100)
  2 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 3000 atoms
  using lattice units in orthogonal box = (-9825 -100 -100) to (9825 100 100)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 3000 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 2001 atoms
  using lattice units in orthogonal box = (-9825 -100 -100) to (9825 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  3000 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  3000 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  2001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  2001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
3000 atoms in group substrate
group slider1 region slider1
2001 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 2001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_55_*.dump id type diameter mass xu yu zu fx fy fz
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 12678 130 130
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 454.1 | 454.1 | 454.1 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   19650          200            200            0              0              0              0              0              0              0              1.1971759e-13  0              6            
    100000   19650          200            200            0.0020512346   1.0780959e-40  0              0.0061537038   1155059.3      0              5.5773681e+10  1.1971759e-13  0              3.3319575    
    200000   19650          200            200            0.00069300943  1.3154911e-34  0              0.0020790283   261161.05      0              1.2610532e+10  1.1971759e-13  0              3.0835186    
    300000   19650          200            200           -7.6935225e-06 -8.2218011e-36  0             -2.3080567e-05  71.520625      0              3453475        1.1971759e-13  0              3.0436286    
    400000   19650          200            200           -1.0701473e-05 -3.288719e-35   0             -3.210442e-05   143.47237      0              6927767.5      1.1971759e-13  0              3.0053328    
    500000   19650          200            200            0.0010303922   0.00019163863  0              0.0028995378   1358.4133      0              65592918       1.1971759e-13  0              2.9962288    
    600000   19650          200            200            0.0023129147  -0.00013884692  0              0.007077591    357.53415      0              17264045       1.1971759e-13  0              2.9942834    
    700000   19650          200            200            0.0026934283  -9.5195043e-05  0              0.0081754801   33.780028      0              1631116.7      1.1971759e-13  0              2.9938219    
    800000   19650          200            200            0.0024122121  -9.484613e-05   0              0.0073314823   2.206829       0              106559.88      1.1971759e-13  0              2.9941611    
    900000   19650          200            200            0.0025503811  -9.7184573e-05  0              0.0077483278   0.074619622    0              3603.1145      1.1971759e-13  0              2.9939938    
   1000000   19650          200            200            0.0024925916  -9.6186772e-05  0              0.0075739617   0.00010726407  0              5.1793979      1.1971759e-13  0              2.9940628    
   1100000   19650          200            200            0.0025141329  -9.6552023e-05  0              0.0076389508   0.0019247691   0              92.940211      1.1971759e-13  0              2.9940372    
   1200000   19650          200            200            0.0025068939  -9.642958e-05   0              0.0076171113   0.00084869691  0              40.980536      1.1971759e-13  0              2.9940457    
   1300000   19650          200            200            0.0025090332  -9.6465357e-05  0              0.007623565    0.00020685614  0              9.9883425      1.1971759e-13  0              2.9940432    
   1400000   19650          200            200            0.0025085175  -9.6456888e-05  0              0.0076220095   3.7122941e-05  0              1.792534       1.1971759e-13  0              2.9940438    
   1500000   19650          200            200            0.0025085888  -9.6457969e-05  0              0.0076222242   5.3216234e-06  0              0.25696215     1.1971759e-13  0              2.9940437    
   1600000   19650          200            200            0.0025086085  -9.6458355e-05  0              0.007622284    6.1828291e-07  0              0.029854669    1.1971759e-13  0              2.9940437    
   1700000   19650          200            200            0.0025085852  -9.6457941e-05  0              0.0076222135   5.6201943e-08  0              0.0027137907   1.1971759e-13  0              2.9940437    
   1800000   19650          200            200            0.0025085988  -9.6458177e-05  0              0.0076222545   3.5120318e-09  0              0.00016958345  1.1971759e-13  0              2.9940437    
   1900000   19650          200            200            0.0025085925  -9.6458068e-05  0              0.0076222355   8.7704602e-11  0              4.2349413e-06  1.1971759e-13  0              2.9940437    
   2000000   19650          200            200            0.002508595   -9.6458112e-05  0              0.0076222432   2.1067028e-12  0              1.0172514e-07  1.1971759e-13  0              2.9940437    
   2100000   19650          200            200            0.0025085941  -9.6458096e-05  0              0.0076222404   5.1556531e-12  0              2.4894804e-07  1.1971759e-13  0              2.9940437    
   2200000   19650          200            200            0.0025085944  -9.6458102e-05  0              0.0076222413   1.9188082e-12  0              9.265238e-08   1.1971759e-13  0              2.9940437    
   2300000   19650          200            200            0.0025085943  -9.64581e-05    0              0.007622241    4.3420807e-13  0              2.0966354e-08  1.1971759e-13  0              2.9940437    
   2400000   19650          200            200            0.0025085943  -9.6458101e-05  0              0.0076222411   7.424543e-14   0              3.5850461e-09  1.1971759e-13  0              2.9940437    
   2500000   19650          200            200            0.0025085943  -9.6458101e-05  0              0.0076222411   1.0193009e-14  0              4.9218392e-10  1.1971759e-13  0              2.9940437    
   2600000   19650          200            200            0.0025085943  -9.6458101e-05  0              0.0076222411   1.1312375e-15  0              5.4623412e-11  1.1971759e-13  0              2.9940437    
   2700000   19650          200            200            0.0025085943  -9.6458101e-05  0              0.0076222411   1.3849808e-16  0              6.6875768e-12  1.1971759e-13  0              2.9940437    
   2800000   19650          200            200            0.0025085943  -9.6458101e-05  0              0.0076222411   1.7130228e-17  0              8.271574e-13   1.1971759e-13  0              2.9940437    
   2900000   19650          200            200            0.0025085943  -9.6458101e-05  0              0.0076222411   1.111681e-18   0              5.3679099e-14  1.1971759e-13  0              2.9940437    
   3000000   19650          200            200            0.0025085943  -9.6458101e-05  0              0.0076222411   3.4772268e-19  0              1.6790284e-14  1.1971759e-13  0              2.9940437    
Loop time of 729.342 on 2 procs for 3000000 steps with 5001 atoms

Performance: 3553887.820 ns/day, 0.000 hours/ns, 4113.296 timesteps/s
99.9% CPU use with 2 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 161.59     | 163.51     | 165.43     |  15.0 | 22.42
Neigh   | 24.074     | 24.077     | 24.08      |   0.1 |  3.30
Comm    | 54.04      | 56.034     | 58.029     |  26.6 |  7.68
Output  | 0.64131    | 0.64133    | 0.64135    |   0.0 |  0.09
Modify  | 426.74     | 426.83     | 426.91     |   0.4 | 58.52
Other   |            | 58.25      |            |       |  7.99

Nlocal:         2500.5 ave        2501 max        2500 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Nghost:            2.5 ave           3 max           2 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Neighs:         1237.5 ave        1238 max        1237 min
Histogram: 1 0 0 0 0 0 0 0 0 1

Total # of neighbors = 2475
Ave neighs/atom = 0.49490102
Neighbor list builds = 166
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 56

#variable lat0 equal 1                    #
variable lat1 equal 3+((300)*0.01)+(v_ind*0.01)        # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 1000*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 6.56                                                               
Lattice spacing in x,y,z = 6.56 6.56 6.56

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -9840 ${n1e1} -100 100 -100 100 units box
region box block -9840 9840 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -9840 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -9840 9840 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-9840 -100 -100) to (9840 100 100)
  2 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 3000 atoms
  using lattice units in orthogonal box = (-9840 -100 -100) to (9840 100 100)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 3000 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 2001 atoms
  using lattice units in orthogonal box = (-9840 -100 -100) to (9840 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  3000 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  3000 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  2001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  2001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
3000 atoms in group substrate
group slider1 region slider1
2001 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 2001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_56_*.dump id type diameter mass xu yu zu fx fy fz
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 12697 130 130
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 454.8 | 454.8 | 454.8 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   19680          200            200            0              0              0              0              0              0              0              1.1971759e-13  0              6            
    100000   19680          200            200            0.0020479669  -4.104641e-35   0              0.0061439006   1154948        0              5.5768307e+10  1.1971759e-13  0              3.3319729    
    200000   19680          200            200            0.00069170953  1.6418587e-35  0              0.0020751286   261021.29      0              1.2603784e+10  1.1971759e-13  0              3.0835244    
    300000   19680          200            200           -8.3940653e-06 -4.1046348e-36  0             -2.5182196e-05  85.628649      0              4134701        1.1971759e-13  0              3.0435572    
    400000   19680          200            200           -1.4227415e-05  9.8511426e-35  0             -4.2682246e-05  256.97268      0              12408291       1.1971759e-13  0              3.0052326    
    500000   19680          200            200            0.0016786466   0.00033923013  0              0.0046967096   2313.1264      0              1.1169259e+08  1.1971759e-13  0              2.9952296    
    600000   19680          200            200            0.0018027343   0.00012805789  0              0.0052801451   56.577969      0              2731947.7      1.1971759e-13  0              2.9950201    
    700000   19680          200            200            0.0024677972  -0.0011107802   0              0.0085141718   8.4950347      0              410194.82      1.1971759e-13  0              2.9936623    
    800000   19680          200            200            0.0021683595  -0.0009518741   0              0.0074569525   5.4842975      0              264817.1       1.1971759e-13  0              2.9940708    
    900000   19680          200            200            0.0022046684  -0.00096246116  0              0.0075764665   0.83294893     0              40220.123      1.1971759e-13  0              2.9940264    
   1000000   19680          200            200            0.0022268032  -0.00096949067  0              0.0076499004   0.038570406    0              1862.4269      1.1971759e-13  0              2.9939959    
   1100000   19680          200            200            0.0022095928  -0.00096423678  0              0.0075930151   0.00016020812  0              7.7358765      1.1971759e-13  0              2.9940188    
   1200000   19680          200            200            0.0022162758  -0.00096626146  0              0.007615089    0.001123005    0              54.225892      1.1971759e-13  0              2.99401      
   1300000   19680          200            200            0.0022148357  -0.00096583821  0              0.0076103455   0.00029266672  0              14.131828      1.1971759e-13  0              2.9940118    
   1400000   19680          200            200            0.0022147446  -0.00096580436  0              0.0076100383   2.5970377e-05  0              1.2540166      1.1971759e-13  0              2.994012     
   1500000   19680          200            200            0.0022149895  -0.00096588036  0              0.0076108489   3.1306627e-07  0              0.01511685     1.1971759e-13  0              2.9940117    
   1600000   19680          200            200            0.0022148643  -0.00096584225  0              0.0076104352   1.3797245e-07  0              0.0066621959   1.1971759e-13  0              2.9940118    
   1700000   19680          200            200            0.0022149017  -0.00096585342  0              0.0076105584   8.0537586e-08  0              0.0038888718   1.1971759e-13  0              2.9940118    
   1800000   19680          200            200            0.0022148975  -0.00096585228  0              0.0076105449   1.1956744e-08  0              0.0005773484   1.1971759e-13  0              2.9940118    
   1900000   19680          200            200            0.0022148948  -0.00096585142  0              0.0076105359   5.3863254e-10  0              2.6008637e-05  1.1971759e-13  0              2.9940118    
   2000000   19680          200            200            0.0022148969  -0.00096585205  0              0.0076105427   2.8248621e-12  0              1.3640248e-07  1.1971759e-13  0              2.9940118    
   2100000   19680          200            200            0.0022148961  -0.00096585181  0              0.0076105401   1.6531748e-11  0              7.9825894e-07  1.1971759e-13  0              2.9940118    
   2200000   19680          200            200            0.0022148963  -0.00096585186  0              0.0076105407   4.2285193e-12  0              2.0418006e-07  1.1971759e-13  0              2.9940118    
   2300000   19680          200            200            0.0022148963  -0.00096585187  0              0.0076105407   3.687598e-13   0              1.7806091e-08  1.1971759e-13  0              2.9940118    
   2400000   19680          200            200            0.0022148962  -0.00096585186  0              0.0076105406   4.0279248e-15  0              1.9449407e-10  1.1971759e-13  0              2.9940118    
   2500000   19680          200            200            0.0022148963  -0.00096585186  0              0.0076105406   2.0686304e-15  0              9.988676e-11   1.1971759e-13  0              2.9940118    
   2600000   19680          200            200            0.0022148963  -0.00096585186  0              0.0076105406   1.1229403e-15  0              5.4222766e-11  1.1971759e-13  0              2.9940118    
   2700000   19680          200            200            0.0022148963  -0.00096585186  0              0.0076105406   1.8460227e-16  0              8.9137829e-12  1.1971759e-13  0              2.9940118    
   2800000   19680          200            200            0.0022148963  -0.00096585186  0              0.0076105406   2.0951868e-17  0              1.0116907e-12  1.1971759e-13  0              2.9940118    
   2900000   19680          200            200            0.0022148963  -0.00096585186  0              0.0076105406   9.7490623e-19  0              4.7074733e-14  1.1971759e-13  0              2.9940118    
   3000000   19680          200            200            0.0022148963  -0.00096585186  0              0.0076105406   1.0311061e-19  0              4.9788425e-15  1.1971759e-13  0              2.9940118    
Loop time of 727.8 on 2 procs for 3000000 steps with 5001 atoms

Performance: 3561415.535 ns/day, 0.000 hours/ns, 4122.009 timesteps/s
99.9% CPU use with 2 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 161.14     | 163.14     | 165.13     |  15.6 | 22.42
Neigh   | 24.071     | 24.074     | 24.078     |   0.1 |  3.31
Comm    | 54.083     | 56.134     | 58.185     |  27.4 |  7.71
Output  | 0.65265    | 0.65267    | 0.65268    |   0.0 |  0.09
Modify  | 425.16     | 425.28     | 425.4      |   0.6 | 58.43
Other   |            | 58.52      |            |       |  8.04

Nlocal:         2500.5 ave        2501 max        2500 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Nghost:            2.5 ave           3 max           2 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Neighs:         1238.5 ave        1239 max        1238 min
Histogram: 1 0 0 0 0 0 0 0 0 1

Total # of neighbors = 2477
Ave neighs/atom = 0.49530094
Neighbor list builds = 166
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 57

#variable lat0 equal 1                    #
variable lat1 equal 3+((300)*0.01)+(v_ind*0.01)        # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 1000*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 6.57                                                               
Lattice spacing in x,y,z = 6.57 6.57 6.57

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -9855 ${n1e1} -100 100 -100 100 units box
region box block -9855 9855 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -9855 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -9855 9855 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-9855 -100 -100) to (9855 100 100)
  2 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 3000 atoms
  using lattice units in orthogonal box = (-9855 -100 -100) to (9855 100 100)
  create_atoms CPU = 0.002 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 3000 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 2001 atoms
  using lattice units in orthogonal box = (-9855 -100 -100) to (9855 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  3000 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  3000 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  2001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  2001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
3000 atoms in group substrate
group slider1 region slider1
2001 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 2001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_57_*.dump id type diameter mass xu yu zu fx fy fz
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 12717 130 130
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 455.5 | 455.5 | 455.5 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   19710          200            200            0              0              0              0              0              0              0              1.1971759e-13  0              6            
    100000   19710          200            200            0.0020446721   4.9180815e-35  0              0.0061340163   1154805.6      0              5.5761429e+10  1.1971759e-13  0              3.3320001    
    200000   19710          200            200            0.00069029405  4.287556e-40   0              0.0020708822   260810.05      0              1.2593584e+10  1.1971759e-13  0              3.0835651    
    300000   19710          200            200           -8.9726746e-06 -6.5573124e-35  0             -2.6918024e-05  98.346505      0              4748800.8      1.1971759e-13  0              3.0434802    
    400000   19710          200            200           -1.6161048e-05  3.2787573e-35  0             -4.8483145e-05  334.33329      0              16143758       1.1971759e-13  0              3.0051381    
    500000   19710          200            200            0.0024927036   0.0017015226   0              0.0057765881   2615.2972      0              1.2628334e+08  1.1971759e-13  0              2.9946739    
    600000   19710          200            200            0.0020871524   0.0011612106   0              0.0051002466   0.29706716     0              14344.31       1.1971759e-13  0              2.9950574    
    700000   19710          200            200            0.003214427    0.00108305     0              0.0085602311   4.1530397      0              200535.43      1.1971759e-13  0              2.993595     
    800000   19710          200            200            0.002821574    0.0012108274   0              0.0072538947   0.47614375     0              22991.278      1.1971759e-13  0              2.9940975    
    900000   19710          200            200            0.0029745105   0.0011954407   0              0.0077280908   0.041903989    0              2023.3937      1.1971759e-13  0              2.9939105    
   1000000   19710          200            200            0.0029141893   0.0011914991   0              0.0075510687   0.0029183249   0              140.91547      1.1971759e-13  0              2.9939797    
   1100000   19710          200            200            0.0029364415   0.0011928316   0              0.0076164928   0.00014571553  0              7.0360814      1.1971759e-13  0              2.993954     
   1200000   19710          200            200            0.0029282172   0.0011923208   0              0.0075923307   2.4158689e-06  0              0.11665366     1.1971759e-13  0              2.9939635    
   1300000   19710          200            200            0.0029312388   0.0011925063   0              0.0076012101   2.3515165e-07  0              0.011354631    1.1971759e-13  0              2.99396      
   1400000   19710          200            200            0.002930132    0.001192438    0              0.0075979579   3.1826494e-07  0              0.015367875    1.1971759e-13  0              2.9939613    
   1500000   19710          200            200            0.0029305358   0.0011924629   0              0.0075991444   1.2097186e-07  0              0.0058412983   1.1971759e-13  0              2.9939608    
   1600000   19710          200            200            0.002930389    0.0011924538   0              0.0075987131   3.1953258e-08  0              0.0015429085   1.1971759e-13  0              2.993961     
   1700000   19710          200            200            0.0029304421   0.0011924571   0              0.0075988693   7.0707204e-09  0              0.00034141978  1.1971759e-13  0              2.9939609    
   1800000   19710          200            200            0.002930423    0.0011924559   0              0.007598813    1.4075388e-09  0              6.7965013e-05  1.1971759e-13  0              2.993961     
   1900000   19710          200            200            0.0029304299   0.0011924564   0              0.0075988332   2.6103185e-10  0              1.2604294e-05  1.1971759e-13  0              2.993961     
   2000000   19710          200            200            0.0029304274   0.0011924562   0              0.007598826    4.5996025e-11  0              2.2209834e-06  1.1971759e-13  0              2.993961     
   2100000   19710          200            200            0.0029304283   0.0011924563   0              0.0075988285   7.7973713e-12  0              3.7650715e-07  1.1971759e-13  0              2.993961     
   2200000   19710          200            200            0.002930428    0.0011924562   0              0.0075988276   1.2818638e-12  0              6.1896616e-08  1.1971759e-13  0              2.993961     
   2300000   19710          200            200            0.0029304281   0.0011924563   0              0.0075988279   2.0583191e-13  0              9.9388862e-09  1.1971759e-13  0              2.993961     
   2400000   19710          200            200            0.002930428    0.0011924563   0              0.0075988278   3.2073739e-14  0              1.5487261e-09  1.1971759e-13  0              2.993961     
   2500000   19710          200            200            0.002930428    0.0011924563   0              0.0075988279   4.8830426e-15  0              2.3578465e-10  1.1971759e-13  0              2.993961     
   2600000   19710          200            200            0.002930428    0.0011924563   0              0.0075988279   7.4595725e-16  0              3.6019606e-11  1.1971759e-13  0              2.993961     
   2700000   19710          200            200            0.002930428    0.0011924563   0              0.0075988279   1.5298807e-16  0              7.3872463e-12  1.1971759e-13  0              2.993961     
   2800000   19710          200            200            0.002930428    0.0011924563   0              0.0075988279   2.5551616e-17  0              1.2337961e-12  1.1971759e-13  0              2.993961     
   2900000   19710          200            200            0.002930428    0.0011924563   0              0.0075988279   8.99664e-18    0              4.3441555e-13  1.1971759e-13  0              2.993961     
   3000000   19710          200            200            0.002930428    0.0011924563   0              0.0075988279   5.07325e-18    0              2.4496908e-13  1.1971759e-13  0              2.993961     
Loop time of 731.992 on 2 procs for 3000000 steps with 5001 atoms

Performance: 3541020.538 ns/day, 0.000 hours/ns, 4098.403 timesteps/s
100.0% CPU use with 2 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 162.47     | 164.45     | 166.44     |  15.5 | 22.47
Neigh   | 24.095     | 24.098     | 24.101     |   0.1 |  3.29
Comm    | 54.489     | 56.391     | 58.293     |  25.3 |  7.70
Output  | 0.64362    | 0.64363    | 0.64364    |   0.0 |  0.09
Modify  | 426.5      | 426.5      | 426.5      |   0.0 | 58.27
Other   |            | 59.91      |            |       |  8.18

Nlocal:         2500.5 ave        2501 max        2500 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Nghost:            2.5 ave           3 max           2 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Neighs:         1241.5 ave        1242 max        1241 min
Histogram: 1 0 0 0 0 0 0 0 0 1

Total # of neighbors = 2483
Ave neighs/atom = 0.4965007
Neighbor list builds = 166
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 58

#variable lat0 equal 1                    #
variable lat1 equal 3+((300)*0.01)+(v_ind*0.01)        # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 1000*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 6.58                                                               
Lattice spacing in x,y,z = 6.58 6.58 6.58

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -9870 ${n1e1} -100 100 -100 100 units box
region box block -9870 9870 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -9870 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -9870 9870 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-9870 -100 -100) to (9870 100 100)
  2 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 3000 atoms
  using lattice units in orthogonal box = (-9870 -100 -100) to (9870 100 100)
  create_atoms CPU = 0.002 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 3000 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 2001 atoms
  using lattice units in orthogonal box = (-9870 -100 -100) to (9870 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  3000 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  3000 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  2001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  2001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
3000 atoms in group substrate
group slider1 region slider1
2001 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 2001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_58_*.dump id type diameter mass xu yu zu fx fy fz
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 12736 130 130
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 456.1 | 456.1 | 456.1 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   19740          200            200            0              0              0              0              0              0              0              1.1971759e-13  0              6            
    100000   19740          200            200            0.0020416609  -3.2737301e-35  0              0.0061249826   1154865.4      0              5.5764318e+10  1.1971759e-13  0              3.3320563    
    200000   19740          200            200            0.00068921778  3.2460599e-42  0              0.0020676533   260781.25      0              1.2592193e+10  1.1971759e-13  0              3.0837165    
    300000   19740          200            200           -8.6807624e-06  3.273752e-35   0             -2.6042287e-05  92.235467      0              4453720.6      1.1971759e-13  0              3.0436101    
    400000   19740          200            200           -1.3598579e-05 -3.2736993e-35  0             -4.0795738e-05  235.80452      0              11386156       1.1971759e-13  0              3.0052965    
    500000   19740          200            200            0.00063216714 -0.0017684421   0              0.0036649435   1850.6721      0              89362335       1.1971759e-13  0              2.9958129    
    600000   19740          200            200            0.0015115112  -0.001765133    0              0.0062996667   282.51051      0              13641422       1.1971759e-13  0              2.9946074    
    700000   19740          200            200            0.0019241722  -0.0021216312   0              0.0078941479   45.280645      0              2186440.3      1.1971759e-13  0              2.993934     
    800000   19740          200            200            0.0019147742  -0.0018723582   0              0.0076166807   6.7133087      0              324161.65      1.1971759e-13  0              2.9940511    
    900000   19740          200            200            0.0018741674  -0.0018960468   0              0.0075185489   0.66726513     0              32219.845      1.1971759e-13  0              2.9940859    
   1000000   19740          200            200            0.0019075083  -0.0019061634   0              0.0076286882   0.03559949     0              1718.972       1.1971759e-13  0              2.9940439    
   1100000   19740          200            200            0.0018896727  -0.0019007834   0              0.0075698015   0.00018396386  0              8.8829565      1.1971759e-13  0              2.9940667    
   1200000   19740          200            200            0.0018968714  -0.0019030138   0              0.0075936279   0.00027101048  0              13.086126      1.1971759e-13  0              2.9940574    
   1300000   19740          200            200            0.0018945423  -0.0019022898   0              0.0075859165   0.00015926004  0              7.6900974      1.1971759e-13  0              2.9940604    
   1400000   19740          200            200            0.0018951003  -0.001902467    0              0.0075877677   3.6753344e-05  0              1.7746874      1.1971759e-13  0              2.9940597    
   1500000   19740          200            200            0.0018950475  -0.0019024484   0              0.0075875908   5.1906498e-06  0              0.2506379      1.1971759e-13  0              2.9940597    
   1600000   19740          200            200            0.001895007   -0.0019024368   0              0.0075874579   4.6063012e-07  0              0.02224218     1.1971759e-13  0              2.9940598    
   1700000   19740          200            200            0.0018950407  -0.0019024469   0              0.0075875689   1.9224941e-08  0              0.00092830362  1.1971759e-13  0              2.9940597    
   1800000   19740          200            200            0.001895024   -0.0019024418   0              0.0075875139   1.278608e-13   0              6.1739405e-09  1.1971759e-13  0              2.9940598    
   1900000   19740          200            200            0.0018950304  -0.0019024438   0              0.007587535    3.5662393e-10  0              1.7220093e-05  1.1971759e-13  0              2.9940598    
   2000000   19740          200            200            0.0018950285  -0.0019024432   0              0.0075875286   1.5218092e-10  0              7.3482718e-06  1.1971759e-13  0              2.9940598    
   2100000   19740          200            200            0.0018950289  -0.0019024433   0              0.00758753     3.0808724e-11  0              1.487643e-06   1.1971759e-13  0              2.9940598    
   2200000   19740          200            200            0.0018950289  -0.0019024433   0              0.0075875299   3.9228656e-12  0              1.8942114e-07  1.1971759e-13  0              2.9940598    
   2300000   19740          200            200            0.0018950288  -0.0019024433   0              0.0075875298   3.0596684e-13  0              1.4774044e-08  1.1971759e-13  0              2.9940598    
   2400000   19740          200            200            0.0018950289  -0.0019024433   0              0.0075875299   9.0047085e-15  0              4.3480515e-10  1.1971759e-13  0              2.9940598    
   2500000   19740          200            200            0.0018950288  -0.0019024433   0              0.0075875298   1.2117455e-16  0              5.8510853e-12  1.1971759e-13  0              2.9940598    
   2600000   19740          200            200            0.0018950289  -0.0019024433   0              0.0075875299   4.089334e-16   0              1.974593e-11   1.1971759e-13  0              2.9940598    
   2700000   19740          200            200            0.0018950288  -0.0019024433   0              0.0075875298   1.7218507e-16  0              8.3142009e-12  1.1971759e-13  0              2.9940598    
   2800000   19740          200            200            0.0018950288  -0.0019024433   0              0.0075875298   1.5028823e-17  0              7.2568806e-13  1.1971759e-13  0              2.9940598    
   2900000   19740          200            200            0.0018950288  -0.0019024433   0              0.0075875298   4.2394863e-18  0              2.0470962e-13  1.1971759e-13  0              2.9940598    
   3000000   19740          200            200            0.0018950289  -0.0019024433   0              0.0075875298   7.4347624e-18  0              3.5899807e-13  1.1971759e-13  0              2.9940598    
Loop time of 729.369 on 2 procs for 3000000 steps with 5001 atoms

Performance: 3553758.936 ns/day, 0.000 hours/ns, 4113.147 timesteps/s
99.9% CPU use with 2 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 162.01     | 163.54     | 165.08     |  12.0 | 22.42
Neigh   | 24.334     | 24.338     | 24.342     |   0.1 |  3.34
Comm    | 54.562     | 56.039     | 57.515     |  19.7 |  7.68
Output  | 0.64528    | 0.64531    | 0.64533    |   0.0 |  0.09
Modify  | 427.46     | 427.5      | 427.54     |   0.2 | 58.61
Other   |            | 57.3       |            |       |  7.86

Nlocal:         2500.5 ave        2501 max        2500 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Nghost:            2.5 ave           3 max           2 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Neighs:         1241.5 ave        1242 max        1241 min
Histogram: 1 0 0 0 0 0 0 0 0 1

Total # of neighbors = 2483
Ave neighs/atom = 0.4965007
Neighbor list builds = 166
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 59

#variable lat0 equal 1                    #
variable lat1 equal 3+((300)*0.01)+(v_ind*0.01)        # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 1000*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 6.59                                                               
Lattice spacing in x,y,z = 6.59 6.59 6.59

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -9885 ${n1e1} -100 100 -100 100 units box
region box block -9885 9885 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -9885 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -9885 9885 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-9885 -100 -100) to (9885 100 100)
  2 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 3000 atoms
  using lattice units in orthogonal box = (-9885 -100 -100) to (9885 100 100)
  create_atoms CPU = 0.002 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 3000 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 2001 atoms
  using lattice units in orthogonal box = (-9885 -100 -100) to (9885 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  3000 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  3000 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  2001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  2001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
3000 atoms in group substrate
group slider1 region slider1
2001 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 2001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_59_*.dump id type diameter mass xu yu zu fx fy fz
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 12755 130 130
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 456.8 | 456.8 | 456.8 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   19770          200            200            0              0              0              0              0              0              0              1.1971759e-13  0              6            
    100000   19770          200            200            0.0020384656  -4.0859522e-36  0              0.0061153969   1154808.9      0              5.576159e+10   1.1971759e-13  0              3.331983     
    200000   19770          200            200            0.00068826363 -6.5375169e-35  0              0.0020647909   260851.26      0              1.2595574e+10  1.1971759e-13  0              3.0835178    
    300000   19770          200            200           -9.094773e-06  -8.1719e-36     0             -2.7284319e-05  101.71047      0              4911234.7      1.1971759e-13  0              3.0434556    
    400000   19770          200            200           -1.800592e-05   8.171915e-36   0             -5.4017761e-05  419.61536      0              20261724       1.1971759e-13  0              3.0050836    
    500000   19770          200            200            0.0011830394  -0.002868405    0              0.006417523    2724.5359      0              1.3155809e+08  1.1971759e-13  0              2.9943847    
    600000   19770          200            200            0.0011212216  -0.0017141723   0              0.0050778372   1.1608459      0              56053.096      1.1971759e-13  0              2.9950553    
    700000   19770          200            200            0.0017617914  -0.0030512916   0              0.0083366659   20.811744      0              1004924.6      1.1971759e-13  0              2.9936696    
    800000   19770          200            200            0.0014893364  -0.0029783595   0              0.0074463686   5.8310257      0              281559.36      1.1971759e-13  0              2.9940103    
    900000   19770          200            200            0.0015125128  -0.0030129004   0              0.0075504387   0.86026319     0              41539.031      1.1971759e-13  0              2.993972     
   1000000   19770          200            200            0.0015301685  -0.0030180998   0              0.0076086054   0.062749194    0              3029.934       1.1971759e-13  0              2.9939475    
   1100000   19770          200            200            0.0015149934  -0.0030138683   0              0.0075588483   0.0010320608   0              49.834524      1.1971759e-13  0              2.9939676    
   1200000   19770          200            200            0.0015219676  -0.0030160443   0              0.007581947    0.00017888655  0              8.6377912      1.1971759e-13  0              2.9939584    
   1300000   19770          200            200            0.001519635   -0.0030152601   0              0.0075741652   0.0001613241   0              7.7897633      1.1971759e-13  0              2.9939615    
   1400000   19770          200            200            0.0015201672  -0.0030154375   0              0.007575939    3.8084907e-05  0              1.8389839      1.1971759e-13  0              2.9939608    
   1500000   19770          200            200            0.0015201465  -0.003015433    0              0.0075758726   4.6817772e-06  0              0.22606627     1.1971759e-13  0              2.9939608    
   1600000   19770          200            200            0.0015200879  -0.0030154119   0              0.0075756756   2.7832611e-07  0              0.013439372    1.1971759e-13  0              2.9939609    
   1700000   19770          200            200            0.0015201275  -0.0030154257   0              0.0075758082   1.5982642e-09  0              7.7174459e-05  1.1971759e-13  0              2.9939608    
   1800000   19770          200            200            0.0015201105  -0.0030154199   0              0.0075757515   2.1052917e-09  0              0.000101657    1.1971759e-13  0              2.9939609    
   1900000   19770          200            200            0.0015201158  -0.0030154217   0              0.0075757692   1.1675354e-09  0              5.6376105e-05  1.1971759e-13  0              2.9939608    
   2000000   19770          200            200            0.0015201148  -0.0030154214   0              0.0075757657   2.3313895e-10  0              1.1257446e-05  1.1971759e-13  0              2.9939608    
   2100000   19770          200            200            0.0015201147  -0.0030154213   0              0.0075757655   2.4847679e-11  0              1.1998055e-06  1.1971759e-13  0              2.9939608    
   2200000   19770          200            200            0.0015201149  -0.0030154214   0              0.0075757661   1.1528303e-12  0              5.566605e-08   1.1971759e-13  0              2.9939608    
   2300000   19770          200            200            0.0015201148  -0.0030154214   0              0.0075757658   1.8110311e-17  0              8.7448209e-13  1.1971759e-13  0              2.9939608    
   2400000   19770          200            200            0.0015201148  -0.0030154214   0              0.0075757659   1.9956249e-14  0              9.6361585e-10  1.1971759e-13  0              2.9939608    
   2500000   19770          200            200            0.0015201148  -0.0030154214   0              0.0075757659   7.8783695e-15  0              3.8041827e-10  1.1971759e-13  0              2.9939608    
   2600000   19770          200            200            0.0015201148  -0.0030154214   0              0.0075757659   1.3849277e-15  0              6.6873201e-11  1.1971759e-13  0              2.9939608    
   2700000   19770          200            200            0.0015201148  -0.0030154214   0              0.0075757659   1.6926596e-16  0              8.1732474e-12  1.1971759e-13  0              2.9939608    
   2800000   19770          200            200            0.0015201148  -0.0030154214   0              0.0075757659   1.6890797e-17  0              8.1559614e-13  1.1971759e-13  0              2.9939608    
   2900000   19770          200            200            0.0015201148  -0.0030154214   0              0.0075757659   2.3128853e-19  0              1.1168095e-14  1.1971759e-13  0              2.9939608    
   3000000   19770          200            200            0.0015201148  -0.0030154214   0              0.0075757659   1.9807663e-18  0              9.5644114e-14  1.1971759e-13  0              2.9939608    
Loop time of 726.813 on 2 procs for 3000000 steps with 5001 atoms

Performance: 3566255.000 ns/day, 0.000 hours/ns, 4127.610 timesteps/s
99.9% CPU use with 2 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 157.68     | 160.62     | 163.55     |  23.2 | 22.10
Neigh   | 24.056     | 24.058     | 24.061     |   0.1 |  3.31
Comm    | 54.082     | 57.083     | 60.084     |  39.7 |  7.85
Output  | 0.65118    | 0.65119    | 0.6512     |   0.0 |  0.09
Modify  | 426.16     | 426.21     | 426.25     |   0.2 | 58.64
Other   |            | 58.2       |            |       |  8.01

Nlocal:         2500.5 ave        2501 max        2500 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Nghost:            2.5 ave           3 max           2 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Neighs:         1237.5 ave        1238 max        1237 min
Histogram: 1 0 0 0 0 0 0 0 0 1

Total # of neighbors = 2475
Ave neighs/atom = 0.49490102
Neighbor list builds = 166
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 60

#variable lat0 equal 1                    #
variable lat1 equal 3+((300)*0.01)+(v_ind*0.01)        # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 1000*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 6.6                                                               
Lattice spacing in x,y,z = 6.6 6.6 6.6

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -9900 ${n1e1} -100 100 -100 100 units box
region box block -9900 9900 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -9900 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -9900 9900 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-9900 -100 -100) to (9900 100 100)
  2 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 3000 atoms
  using lattice units in orthogonal box = (-9900 -100 -100) to (9900 100 100)
  create_atoms CPU = 0.002 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 3000 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 2001 atoms
  using lattice units in orthogonal box = (-9900 -100 -100) to (9900 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  3000 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  3000 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  2001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  2001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
3000 atoms in group substrate
group slider1 region slider1
2001 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 2001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_60_*.dump id type diameter mass xu yu zu fx fy fz
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 12775 130 130
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 457.5 | 457.5 | 457.5 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   19800          200            200            0              0              0              0              0              0              0              1.1971759e-13  0              6            
    100000   19800          200            200            0.0020306189   2.4478605e-35  0              0.0060918567   1149446.2      0              5.5502642e+10  1.1971759e-13  0              3.3389807    
    200000   19800          200            200            0.00067343782  3.2638163e-35  0              0.0020203134   252149.97      0              1.2175419e+10  1.1971759e-13  0              3.0929615    
    300000   19800          200            200           -9.5074204e-06  6.6692256e-41  0             -2.8522261e-05  111.33979      0              5376200.2      1.1971759e-13  0              3.0475174    
    400000   19800          200            200            5.8654678e-05  1.6319125e-35  0              0.00017596403  3857.2386      0              1.8625225e+08  1.1971759e-13  0              3.0068116    
    500000   19800          200            200            0.0061075156  -1.142334e-34   0              0.018322547    39.113801      0              1888665.5      1.1971759e-13  0              2.9943773    
    600000   19800          200            200            0.0014137838   8.1595343e-35  0              0.0042413514   14.774363      0              713401.12      1.1971759e-13  0              2.9978771    
    700000   19800          200            200            0.0025899911   3.0840714e-41  0              0.0077699733   61.269652      0              2958492.2      1.1971759e-13  0              2.9968203    
    800000   19800          200            200            0.002685441   -1.6319031e-35  0              0.0080563231   0.0084808295   0              409.5089       1.1971759e-13  0              2.9967484    
    900000   19800          200            200            0.0025397376   8.15956e-36    0              0.0076192127   1.0540394      0              50895.788      1.1971759e-13  0              2.996868     
   1000000   19800          200            200            0.0025051427  -4.8957165e-35  0              0.0075154282   0.035605229    0              1719.2491      1.1971759e-13  0              2.9968959    
   1100000   19800          200            200            0.0025184892  -2.4478573e-35  0              0.0075554675   0.010988076    0              530.57485      1.1971759e-13  0              2.9968847    
   1200000   19800          200            200            0.002525466   -4.079763e-35   0              0.0075763979   0.0018967577   0              91.587643      1.1971759e-13  0              2.996879     
   1300000   19800          200            200            0.0025248863   3.1969137e-41  0              0.0075746589   4.2241465e-05  0              2.0396892      1.1971759e-13  0              2.9968795    
   1400000   19800          200            200            0.0025238496   2.4478626e-35  0              0.0075715487   4.8600899e-05  0              2.3467635      1.1971759e-13  0              2.9968803    
   1500000   19800          200            200            0.0025237472  -1.6319029e-35  0              0.0075712417   1.1524469e-07  0              0.0055647535   1.1971759e-13  0              2.9968804    
   1600000   19800          200            200            0.0025238685   8.1595643e-36  0              0.0075716056   7.6781682e-07  0              0.037075126    1.1971759e-13  0              2.9968803    
   1700000   19800          200            200            0.0025239033  -1.6319029e-35  0              0.00757171     3.9124011e-08  0              0.0018891585   1.1971759e-13  0              2.9968803    
   1800000   19800          200            200            0.0025238931   3.3310992e-41  0              0.0075716793   6.919504e-09   0              0.00033411808  1.1971759e-13  0              2.9968803    
   1900000   19800          200            200            0.0025238867  -8.1595277e-35  0              0.00757166     1.6800414e-09  0              8.1123186e-05  1.1971759e-13  0              2.9968803    
   2000000   19800          200            200            0.0025238869   3.2638157e-35  0              0.0075716607   1.629502e-11   0              7.8682818e-07  1.1971759e-13  0              2.9968803    
   2100000   19800          200            200            0.0025238878  -8.1594977e-36  0              0.0075716635   3.8432437e-11  0              1.8557649e-06  1.1971759e-13  0              2.9968803    
   2200000   19800          200            200            0.0025238879   4.0797688e-35  0              0.0075716638   2.8675733e-13  0              1.3846485e-08  1.1971759e-13  0              2.9968803    
   2300000   19800          200            200            0.0025238878   2.4478626e-35  0              0.0075716635   5.4607337e-13  0              2.6367929e-08  1.1971759e-13  0              2.9968803    
   2400000   19800          200            200            0.0025238878   3.3256738e-41  0              0.0075716634   4.0663399e-14  0              1.96349e-09    1.1971759e-13  0              2.9968803    
   2500000   19800          200            200            0.0025238878   1.6319095e-35  0              0.0075716635   4.1964401e-15  0              2.0263107e-10  1.1971759e-13  0              2.9968803    
   2600000   19800          200            200            0.0025238878  -8.1594977e-36  0              0.0075716635   1.423846e-15   0              6.8752427e-11  1.1971759e-13  0              2.9968803    
   2700000   19800          200            200            0.0025238878   4.0797987e-36  0              0.0075716635   4.0750616e-18  0              1.9677014e-13  1.1971759e-13  0              2.9968803    
   2800000   19800          200            200            0.0025238878   3.3325311e-41  0              0.0075716635   1.9239875e-17  0              9.290247e-13   1.1971759e-13  0              2.9968803    
   2900000   19800          200            200            0.0025238878  -8.1594976e-36  0              0.0075716635   4.5614661e-18  0              2.2025687e-13  1.1971759e-13  0              2.9968803    
   3000000   19800          200            200            0.0025238878   3.3344754e-41  0              0.0075716635   5.0275781e-18  0              2.4276375e-13  1.1971759e-13  0              2.9968803    
Loop time of 734.727 on 2 procs for 3000000 steps with 5001 atoms

Performance: 3527842.968 ns/day, 0.000 hours/ns, 4083.152 timesteps/s
100.0% CPU use with 2 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 165.85     | 168.45     | 171.05     |  20.0 | 22.93
Neigh   | 24.117     | 24.119     | 24.12      |   0.0 |  3.28
Comm    | 54.487     | 57.104     | 59.722     |  34.6 |  7.77
Output  | 0.64601    | 0.64603    | 0.64605    |   0.0 |  0.09
Modify  | 425.82     | 425.83     | 425.83     |   0.0 | 57.96
Other   |            | 58.58      |            |       |  7.97

Nlocal:         2500.5 ave        2501 max        2500 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Nghost:            2.5 ave           3 max           2 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Neighs:         1272.5 ave        1273 max        1272 min
Histogram: 1 0 0 0 0 0 0 0 0 1

Total # of neighbors = 2545
Ave neighs/atom = 0.50889822
Neighbor list builds = 166
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 61

#variable lat0 equal 1                    #
variable lat1 equal 3+((300)*0.01)+(v_ind*0.01)        # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 1000*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 6.61                                                               
Lattice spacing in x,y,z = 6.61 6.61 6.61

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -9915 ${n1e1} -100 100 -100 100 units box
region box block -9915 9915 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -9915 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -9915 9915 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-9915 -100 -100) to (9915 100 100)
  2 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 3000 atoms
  using lattice units in orthogonal box = (-9915 -100 -100) to (9915 100 100)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 3000 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 2001 atoms
  using lattice units in orthogonal box = (-9915 -100 -100) to (9915 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  3000 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  3000 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  2001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  2001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
3000 atoms in group substrate
group slider1 region slider1
2001 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 2001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_61_*.dump id type diameter mass xu yu zu fx fy fz
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 12794 130 130
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 458.1 | 458.1 | 458.1 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   19830          200            200            0              0              0              0              0              0              0              1.1971759e-13  0              6            
    100000   19830          200            200            0.0020322811   3.6328105e-41  0              0.0060968434   1154795.7      0              5.5760953e+10  1.1971759e-13  0              3.3319845    
    200000   19830          200            200            0.00068612117 -1.62943e-35    0              0.0020583635   260815.54      0              1.2593849e+10  1.1971759e-13  0              3.0835311    
    300000   19830          200            200           -9.242602e-06   2.036797e-36   0             -2.7727806e-05  105.74493      0              5106044.3      1.1971759e-13  0              3.0434498    
    400000   19830          200            200           -1.8242472e-05 -6.5177218e-35  0             -5.4727417e-05  433.65628      0              20939710       1.1971759e-13  0              3.0050758    
    500000   19830          200            200            0.0032899337   0.0034377671   0              0.0064320341   2728.7461      0              1.3176139e+08  1.1971759e-13  0              2.9943701    
    600000   19830          200            200            0.0025363199   0.0025460066   0              0.0050629532   1.3636123      0              65843.957      1.1971759e-13  0              2.995055     
    700000   19830          200            200            0.0038148619   0.0031363765   0              0.0083082091   21.060917      0              1016956.3      1.1971759e-13  0              2.9936709    
    800000   19830          200            200            0.0034622457   0.0029612761   0              0.0074254611   5.8530167      0              282621.23      1.1971759e-13  0              2.9940096    
    900000   19830          200            200            0.0034879216   0.0029368033   0              0.0075269616   0.85847947     0              41452.901      1.1971759e-13  0              2.9939722    
   1000000   19830          200            200            0.0035102419   0.0029449691   0              0.0075857567   0.062150136    0              3001.0076      1.1971759e-13  0              2.9939474    
   1100000   19830          200            200            0.0034913968   0.0029382356   0              0.0075359547   0.00099308524  0              47.952532      1.1971759e-13  0              2.9939677    
   1200000   19830          200            200            0.0034999643   0.0029408955   0              0.0075589973   0.00018488734  0              8.927548       1.1971759e-13  0              2.9939584    
   1300000   19830          200            200            0.00349713     0.0029401335   0              0.0075512565   0.00016277892  0              7.8600114      1.1971759e-13  0              2.9939615    
   1400000   19830          200            200            0.0034977705   0.0029402994   0              0.0075530121   3.8158184e-05  0              1.8425222      1.1971759e-13  0              2.9939608    
   1500000   19830          200            200            0.0034977491   0.0029402957   0              0.0075529516   4.6646415e-06  0              0.22523885     1.1971759e-13  0              2.9939608    
   1600000   19830          200            200            0.0034976764   0.0029402758   0              0.0075527534   2.7487026e-07  0              0.013272501    1.1971759e-13  0              2.9939609    
   1700000   19830          200            200            0.0034977249   0.0029402888   0              0.0075528859   1.478338e-09   0              7.1383654e-05  1.1971759e-13  0              2.9939608    
   1800000   19830          200            200            0.0034977042   0.0029402833   0              0.0075528294   2.1529407e-09  0              0.0001039578   1.1971759e-13  0              2.9939609    
   1900000   19830          200            200            0.0034977107   0.002940285    0              0.0075528471   1.1756469e-09  0              5.6767783e-05  1.1971759e-13  0              2.9939608    
   2000000   19830          200            200            0.0034977094   0.0029402847   0              0.0075528436   2.3326907e-10  0              1.1263728e-05  1.1971759e-13  0              2.9939608    
   2100000   19830          200            200            0.0034977093   0.0029402846   0              0.0075528434   2.4713296e-11  0              1.1933166e-06  1.1971759e-13  0              2.9939608    
   2200000   19830          200            200            0.0034977096   0.0029402847   0              0.007552844    1.1338032e-12  0              5.4747299e-08  1.1971759e-13  0              2.9939608    
   2300000   19830          200            200            0.0034977094   0.0029402847   0              0.0075528436   2.0398398e-19  0              9.8496564e-15  1.1971759e-13  0              2.9939608    
   2400000   19830          200            200            0.0034977095   0.0029402847   0              0.0075528438   2.0203812e-14  0              9.7556978e-10  1.1971759e-13  0              2.9939608    
   2500000   19830          200            200            0.0034977095   0.0029402847   0              0.0075528437   7.9071649e-15  0              3.8180869e-10  1.1971759e-13  0              2.9939608    
   2600000   19830          200            200            0.0034977095   0.0029402847   0              0.0075528437   1.3850306e-15  0              6.687817e-11   1.1971759e-13  0              2.9939608    
   2700000   19830          200            200            0.0034977095   0.0029402847   0              0.0075528437   1.6777152e-16  0              8.1010862e-12  1.1971759e-13  0              2.9939608    
   2800000   19830          200            200            0.0034977095   0.0029402847   0              0.0075528437   1.4617195e-17  0              7.0581205e-13  1.1971759e-13  0              2.9939608    
   2900000   19830          200            200            0.0034977095   0.0029402847   0              0.0075528437   1.0305085e-19  0              4.9759568e-15  1.1971759e-13  0              2.9939608    
   3000000   19830          200            200            0.0034977095   0.0029402847   0              0.0075528437   6.5027043e-18  0              3.1399232e-13  1.1971759e-13  0              2.9939608    
Loop time of 727.005 on 2 procs for 3000000 steps with 5001 atoms

Performance: 3565314.902 ns/day, 0.000 hours/ns, 4126.522 timesteps/s
99.9% CPU use with 2 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 160.67     | 162.5      | 164.33     |  14.4 | 22.35
Neigh   | 24.076     | 24.08      | 24.083     |   0.1 |  3.31
Comm    | 54.681     | 56.522     | 58.362     |  24.5 |  7.77
Output  | 0.64163    | 0.64164    | 0.64164    |   0.0 |  0.09
Modify  | 426.21     | 426.21     | 426.22     |   0.0 | 58.63
Other   |            | 57.05      |            |       |  7.85

Nlocal:         2500.5 ave        2501 max        2500 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Nghost:            2.5 ave           3 max           2 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Neighs:         1237.5 ave        1238 max        1237 min
Histogram: 1 0 0 0 0 0 0 0 0 1

Total # of neighbors = 2475
Ave neighs/atom = 0.49490102
Neighbor list builds = 166
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 62

#variable lat0 equal 1                    #
variable lat1 equal 3+((300)*0.01)+(v_ind*0.01)        # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 1000*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 6.62                                                               
Lattice spacing in x,y,z = 6.62 6.62 6.62

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -9930 ${n1e1} -100 100 -100 100 units box
region box block -9930 9930 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -9930 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -9930 9930 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-9930 -100 -100) to (9930 100 100)
  2 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 3000 atoms
  using lattice units in orthogonal box = (-9930 -100 -100) to (9930 100 100)
  create_atoms CPU = 0.002 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 3000 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 2001 atoms
  using lattice units in orthogonal box = (-9930 -100 -100) to (9930 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  3000 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  3000 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  2001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  2001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
3000 atoms in group substrate
group slider1 region slider1
2001 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 2001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_62_*.dump id type diameter mass xu yu zu fx fy fz
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 12813 130 130
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 458.8 | 458.8 | 458.8 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   19860          200            200            0              0              0              0              0              0              0              1.1971759e-13  0              6            
    100000   19860          200            200            0.0020289466   3.2539553e-35  0              0.0060868399   1154548.9      0              5.5749034e+10  1.1971759e-13  0              3.3321602    
    200000   19860          200            200            0.00068425033  3.2539534e-34  0              0.002052751    260304.99      0              1.2569196e+10  1.1971759e-13  0              3.0838664    
    300000   19860          200            200           -9.9755738e-06 -8.1348624e-36  0             -2.9926721e-05  123.85132      0              5980336.8      1.1971759e-13  0              3.0434922    
    400000   19860          200            200           -1.7734683e-05 -1.9523661e-34  0             -5.3204048e-05  410.56792      0              19824855       1.1971759e-13  0              3.0051379    
    500000   19860          200            200            0.00055473323 -0.0039495489   0              0.0056137486   2595.3829      0              1.2532175e+08  1.1971759e-13  0              2.9947728    
    600000   19860          200            200            0.00060168201 -0.0033084481   0              0.0051134942   18.864288      0              910888.95      1.1971759e-13  0              2.9950757    
    700000   19860          200            200            0.0017067575  -0.0034036465   0              0.008523919    1.0940609      0              52828.285      1.1971759e-13  0              2.9936275    
    800000   19860          200            200            0.0013575043  -0.0031260573   0              0.0071985702   0.44350632     0              21415.333      1.1971759e-13  0              2.9941436    
    900000   19860          200            200            0.0014901852  -0.0031947066   0              0.0076652623   0.10271269     0              4959.6283      1.1971759e-13  0              2.9939578    
   1000000   19860          200            200            0.0014392532  -0.003179873    0              0.0074976325   0.020103152    0              970.70928      1.1971759e-13  0              2.9940238    
   1100000   19860          200            200            0.0014572711  -0.0031852806   0              0.0075570939   0.0036914614   0              178.24746      1.1971759e-13  0              2.9940004    
   1200000   19860          200            200            0.0014508999  -0.0031833946   0              0.0075360944   0.00064152682  0              30.977034      1.1971759e-13  0              2.9940086    
   1300000   19860          200            200            0.0014531311  -0.0031840563   0              0.0075434495   0.00010728743  0              5.1805258      1.1971759e-13  0              2.9940058    
   1400000   19860          200            200            0.0014523556  -0.0031838272   0              0.0075408939   1.7374188e-05  0              0.83893735     1.1971759e-13  0              2.9940068    
   1500000   19860          200            200            0.0014526226  -0.0031839059   0              0.0075417737   2.7408081e-06  0              0.13234381     1.1971759e-13  0              2.9940064    
   1600000   19860          200            200            0.0014525316  -0.0031838791   0              0.0075414739   4.2275073e-07  0              0.02041312     1.1971759e-13  0              2.9940065    
   1700000   19860          200            200            0.0014525622  -0.0031838881   0              0.0075415748   6.3944239e-08  0              0.0030876385   1.1971759e-13  0              2.9940065    
   1800000   19860          200            200            0.0014525521  -0.0031838852   0              0.0075415414   9.5052512e-09  0              0.00045897456  1.1971759e-13  0              2.9940065    
   1900000   19860          200            200            0.0014525554  -0.0031838861   0              0.0075415523   1.3909367e-09  0              6.7163357e-05  1.1971759e-13  0              2.9940065    
   2000000   19860          200            200            0.0014525543  -0.0031838858   0              0.0075415488   2.0058649e-10  0              9.6856036e-06  1.1971759e-13  0              2.9940065    
   2100000   19860          200            200            0.0014525547  -0.0031838859   0              0.0075415499   2.8541178e-11  0              1.3781513e-06  1.1971759e-13  0              2.9940065    
   2200000   19860          200            200            0.0014525546  -0.0031838859   0              0.0075415495   4.0098908e-12  0              1.9362328e-07  1.1971759e-13  0              2.9940065    
   2300000   19860          200            200            0.0014525546  -0.0031838859   0              0.0075415496   5.5626086e-13  0              2.6859846e-08  1.1971759e-13  0              2.9940065    
   2400000   19860          200            200            0.0014525546  -0.0031838859   0              0.0075415496   7.6331346e-14  0              3.6857675e-09  1.1971759e-13  0              2.9940065    
   2500000   19860          200            200            0.0014525546  -0.0031838859   0              0.0075415496   1.0353947e-14  0              4.9995505e-10  1.1971759e-13  0              2.9940065    
   2600000   19860          200            200            0.0014525546  -0.0031838859   0              0.0075415496   1.3888993e-15  0              6.7064974e-11  1.1971759e-13  0              2.9940065    
   2700000   19860          200            200            0.0014525546  -0.0031838859   0              0.0075415496   1.8179993e-16  0              8.7784678e-12  1.1971759e-13  0              2.9940065    
   2800000   19860          200            200            0.0014525546  -0.0031838859   0              0.0075415496   1.8926651e-17  0              9.1390026e-13  1.1971759e-13  0              2.9940065    
   2900000   19860          200            200            0.0014525546  -0.0031838859   0              0.0075415496   8.0141434e-18  0              3.8697431e-13  1.1971759e-13  0              2.9940065    
   3000000   19860          200            200            0.0014525546  -0.0031838859   0              0.0075415496   4.5603278e-18  0              2.2020191e-13  1.1971759e-13  0              2.9940065    
Loop time of 727.982 on 2 procs for 3000000 steps with 5001 atoms

Performance: 3560529.825 ns/day, 0.000 hours/ns, 4120.984 timesteps/s
99.9% CPU use with 2 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 162        | 164.16     | 166.32     |  16.8 | 22.55
Neigh   | 24.169     | 24.173     | 24.177     |   0.1 |  3.32
Comm    | 54.196     | 56.393     | 58.589     |  29.2 |  7.75
Output  | 0.64468    | 0.6447     | 0.64472    |   0.0 |  0.09
Modify  | 425.52     | 425.57     | 425.63     |   0.3 | 58.46
Other   |            | 57.04      |            |       |  7.84

Nlocal:         2500.5 ave        2501 max        2500 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Nghost:            2.5 ave           3 max           2 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Neighs:         1238.5 ave        1239 max        1238 min
Histogram: 1 0 0 0 0 0 0 0 0 1

Total # of neighbors = 2477
Ave neighs/atom = 0.49530094
Neighbor list builds = 166
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 63

#variable lat0 equal 1                    #
variable lat1 equal 3+((300)*0.01)+(v_ind*0.01)        # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 1000*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 6.63                                                               
Lattice spacing in x,y,z = 6.63 6.63 6.63

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -9945 ${n1e1} -100 100 -100 100 units box
region box block -9945 9945 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -9945 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -9945 9945 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-9945 -100 -100) to (9945 100 100)
  2 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 3000 atoms
  using lattice units in orthogonal box = (-9945 -100 -100) to (9945 100 100)
  create_atoms CPU = 0.002 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 3000 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 2001 atoms
  using lattice units in orthogonal box = (-9945 -100 -100) to (9945 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  3000 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  3000 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  2001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  2001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
3000 atoms in group substrate
group slider1 region slider1
2001 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 2001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_63_*.dump id type diameter mass xu yu zu fx fy fz
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 12833 130 130
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 459.5 | 459.5 | 459.5 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   19890          200            200            0              0              0              0              0              0              0              1.1971759e-13  0              6            
    100000   19890          200            200            0.0020259835  -4.0613044e-34  0              0.0060779505   1154641.9      0              5.5753523e+10  1.1971759e-13  0              3.3320864    
    200000   19890          200            200            0.00068362366  4.400573e-41   0              0.002050871    260554.3       0              1.2581235e+10  1.1971759e-13  0              3.0836925    
    300000   19890          200            200           -9.2916613e-06 -1.6245202e-34  0             -2.7874984e-05  107.54501      0              5192963.4      1.1971759e-13  0              3.0434598    
    400000   19890          200            200           -1.728082e-05  -1.6245197e-35  0             -5.1842459e-05  390.58034      0              18859727       1.1971759e-13  0              3.0051016    
    500000   19890          200            200            0.0034381558   0.0040805818   0              0.0062338856   2706.5386      0              1.3068906e+08  1.1971759e-13  0              2.9944432    
    600000   19890          200            200            0.0025463818   0.0025846062   0              0.0050545393   1.2586883      0              60777.554      1.1971759e-13  0              2.995055     
    700000   19890          200            200            0.0038784329   0.0031830309   0              0.0084522678   7.0935672      0              342522.97      1.1971759e-13  0              2.9936071    
    800000   19890          200            200            0.0034514887   0.0031566076   0              0.0071978583   0.83671834     0              40402.134      1.1971759e-13  0              2.9940934    
    900000   19890          200            200            0.0036138081   0.0031862998   0              0.0076551244   0.08359886     0              4036.6898      1.1971759e-13  0              2.9939118    
   1000000   19890          200            200            0.0035514742   0.003170855    0              0.0074835676   0.0072808655   0              351.56694      1.1971759e-13  0              2.9939794    
   1100000   19890          200            200            0.0035746563   0.0031766134   0              0.0075473553   0.00056122614  0              27.099602      1.1971759e-13  0              2.9939541    
   1200000   19890          200            200            0.0035660451   0.0031744728   0              0.0075236625   3.4132562e-05  0              1.6481392      1.1971759e-13  0              2.9939635    
   1300000   19890          200            200            0.0035692281   0.0031752651   0              0.0075324193   1.1938496e-06  0              0.057646726    1.1971759e-13  0              2.99396      
   1400000   19890          200            200            0.0035680556   0.0031749729   0              0.0075291938   1.9317145e-10  0              9.3275579e-06  1.1971759e-13  0              2.9939613    
   1500000   19890          200            200            0.0035684858   0.0031750802   0              0.0075303772   1.8709866e-08  0              0.00090343246  1.1971759e-13  0              2.9939608    
   1600000   19890          200            200            0.0035683285   0.003175041    0              0.0075299446   1.0406567e-08  0              0.00050249587  1.1971759e-13  0              2.993961     
   1700000   19890          200            200            0.0035683858   0.0031750553   0              0.0075301021   3.1682312e-09  0              0.00015298254  1.1971759e-13  0              2.9939609    
   1800000   19890          200            200            0.003568365    0.0031750501   0              0.007530045    7.555817e-10   0              3.6484336e-05  1.1971759e-13  0              2.993961     
   1900000   19890          200            200            0.0035683725   0.003175052    0              0.0075300657   1.5757395e-10  0              7.6086823e-06  1.1971759e-13  0              2.993961     
   2000000   19890          200            200            0.0035683698   0.0031750513   0              0.0075300582   3.018172e-11   0              1.4573672e-06  1.1971759e-13  0              2.993961     
   2100000   19890          200            200            0.0035683708   0.0031750515   0              0.0075300609   5.4428953e-12  0              2.6281794e-07  1.1971759e-13  0              2.993961     
   2200000   19890          200            200            0.0035683705   0.0031750514   0              0.0075300599   9.3947791e-13  0              4.5364026e-08  1.1971759e-13  0              2.993961     
   2300000   19890          200            200            0.0035683706   0.0031750515   0              0.0075300603   1.5659126e-13  0              7.5612315e-09  1.1971759e-13  0              2.993961     
   2400000   19890          200            200            0.0035683705   0.0031750515   0              0.0075300602   2.5191387e-14  0              1.2164019e-09  1.1971759e-13  0              2.993961     
   2500000   19890          200            200            0.0035683706   0.0031750515   0              0.0075300602   3.9509435e-15  0              1.9077692e-10  1.1971759e-13  0              2.993961     
   2600000   19890          200            200            0.0035683705   0.0031750515   0              0.0075300602   6.0515869e-16  0              2.9220947e-11  1.1971759e-13  0              2.993961     
   2700000   19890          200            200            0.0035683705   0.0031750515   0              0.0075300602   1.3694368e-16  0              6.6125202e-12  1.1971759e-13  0              2.993961     
   2800000   19890          200            200            0.0035683705   0.0031750515   0              0.0075300602   2.4758579e-17  0              1.1955032e-12  1.1971759e-13  0              2.993961     
   2900000   19890          200            200            0.0035683705   0.0031750515   0              0.0075300602   2.3744918e-18  0              1.1465571e-13  1.1971759e-13  0              2.993961     
   3000000   19890          200            200            0.0035683705   0.0031750515   0              0.0075300602   5.5085881e-20  0              2.6599e-15     1.1971759e-13  0              2.993961     
Loop time of 730.626 on 2 procs for 3000000 steps with 5001 atoms

Performance: 3547643.148 ns/day, 0.000 hours/ns, 4106.068 timesteps/s
99.9% CPU use with 2 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 163.5      | 165.06     | 166.61     |  12.1 | 22.59
Neigh   | 24.354     | 24.358     | 24.362     |   0.1 |  3.33
Comm    | 55.148     | 56.677     | 58.207     |  20.3 |  7.76
Output  | 0.64815    | 0.64817    | 0.64819    |   0.0 |  0.09
Modify  | 425.97     | 426.07     | 426.17     |   0.5 | 58.32
Other   |            | 57.81      |            |       |  7.91

Nlocal:         2500.5 ave        2501 max        2500 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Nghost:            2.5 ave           3 max           2 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Neighs:         1239.5 ave        1240 max        1239 min
Histogram: 1 0 0 0 0 0 0 0 0 1

Total # of neighbors = 2479
Ave neighs/atom = 0.49570086
Neighbor list builds = 166
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 64

#variable lat0 equal 1                    #
variable lat1 equal 3+((300)*0.01)+(v_ind*0.01)        # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 1000*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 6.64                                                               
Lattice spacing in x,y,z = 6.64 6.64 6.64

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -9960 ${n1e1} -100 100 -100 100 units box
region box block -9960 9960 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -9960 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -9960 9960 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-9960 -100 -100) to (9960 100 100)
  2 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 3000 atoms
  using lattice units in orthogonal box = (-9960 -100 -100) to (9960 100 100)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 3000 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 2001 atoms
  using lattice units in orthogonal box = (-9960 -100 -100) to (9960 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  3000 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  3000 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  2001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  2001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
3000 atoms in group substrate
group slider1 region slider1
2001 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 2001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_64_*.dump id type diameter mass xu yu zu fx fy fz
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 12852 130 130
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 460.1 | 460.1 | 460.1 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   19920          200            200            0              0              0              0              0              0              0              1.1971759e-13  0              6            
    100000   19920          200            200            0.0020228354  -1.2976588e-34  0              0.0060685062   1154549.1      0              5.5749043e+10  1.1971759e-13  0              3.3321596    
    200000   19920          200            200            0.00068220017  3.2441634e-35  0              0.0020466005   260311.63      0              1.2569517e+10  1.1971759e-13  0              3.083862     
    300000   19920          200            200           -9.926584e-06   3.2441524e-35  0             -2.9779752e-05  123.37255      0              5957218.9      1.1971759e-13  0              3.0434922    
    400000   19920          200            200           -1.7677489e-05 -6.4882864e-35  0             -5.3032466e-05  410.38856      0              19816195       1.1971759e-13  0              3.0051379    
    500000   19920          200            200            0.0022424624   0.0011675575   0              0.0055598296   2587.1423      0              1.2492384e+08  1.1971759e-13  0              2.9947922    
    600000   19920          200            200            0.0020804583   0.001169178    0              0.0050721968   14.747723      0              712114.76      1.1971759e-13  0              2.995084     
    700000   19920          200            200            0.0029197722   0.00045392461  0              0.0083053921   17.820093      0              860468.51      1.1971759e-13  0              2.9937048    
    800000   19920          200            200            0.0026502545   0.00051362991  0              0.0074371335   6.3494944      0              306594.36      1.1971759e-13  0              2.9940421    
    900000   19920          200            200            0.0026575629   0.00051300643  0              0.0074596823   0.70294444     0              33942.671      1.1971759e-13  0              2.9940366    
   1000000   19920          200            200            0.0026902846   0.00050824958  0              0.0075626042   0.017284629    0              834.61287      1.1971759e-13  0              2.993994     
   1100000   19920          200            200            0.0026710657   0.00051095029  0              0.0075022469   0.0015306103   0              73.907693      1.1971759e-13  0              2.9940184    
   1200000   19920          200            200            0.002677448    0.00051005792  0              0.007522286    0.0015715857   0              75.886249      1.1971759e-13  0              2.9940104    
   1300000   19920          200            200            0.0026764473   0.00051019157  0              0.0075191505   0.00028862274  0              13.936559      1.1971759e-13  0              2.9940116    
   1400000   19920          200            200            0.0026761502   0.00051023614  0              0.0075182146   1.767788e-05   0              0.85360154     1.1971759e-13  0              2.994012     
   1500000   19920          200            200            0.0026764517   0.00051019312  0              0.0075191618   5.6195072e-09  0              0.00027134589  1.1971759e-13  0              2.9940117    
   1600000   19920          200            200            0.0026763224   0.00051021127  0              0.007518756    2.740795e-07   0              0.013234318    1.1971759e-13  0              2.9940118    
   1700000   19920          200            200            0.0026763544   0.00051020687  0              0.0075188564   9.2404672e-08  0              0.0044618909   1.1971759e-13  0              2.9940118    
   1800000   19920          200            200            0.0026763538   0.0005102069   0              0.0075188546   1.0044404e-08  0              0.0004850083   1.1971759e-13  0              2.9940118    
   1900000   19920          200            200            0.0026763499   0.00051020747  0              0.0075188421   2.3622489e-10  0              1.1406454e-05  1.1971759e-13  0              2.9940118    
   2000000   19920          200            200            0.0026763522   0.00051020715  0              0.0075188494   2.3559742e-11  0              1.1376156e-06  1.1971759e-13  0              2.9940118    
   2100000   19920          200            200            0.0026763514   0.00051020725  0              0.007518847    2.2966377e-11  0              1.1089641e-06  1.1971759e-13  0              2.9940118    
   2200000   19920          200            200            0.0026763515   0.00051020724  0              0.0075188473   4.1497139e-12  0              2.0037483e-07  1.1971759e-13  0              2.9940118    
   2300000   19920          200            200            0.0026763516   0.00051020723  0              0.0075188475   2.492326e-13   0              1.203455e-08   1.1971759e-13  0              2.9940118    
   2400000   19920          200            200            0.0026763515   0.00051020724  0              0.0075188473   3.3946144e-17  0              1.6391378e-12  1.1971759e-13  0              2.9940118    
   2500000   19920          200            200            0.0026763515   0.00051020724  0              0.0075188474   4.0382756e-15  0              1.9499388e-10  1.1971759e-13  0              2.9940118    
   2600000   19920          200            200            0.0026763515   0.00051020724  0              0.0075188474   1.3125351e-15  0              6.3377624e-11  1.1971759e-13  0              2.9940118    
   2700000   19920          200            200            0.0026763515   0.00051020724  0              0.0075188474   1.7772029e-16  0              8.5814768e-12  1.1971759e-13  0              2.9940118    
   2800000   19920          200            200            0.0026763515   0.00051020724  0              0.0075188474   1.541613e-17   0              7.4438975e-13  1.1971759e-13  0              2.9940118    
   2900000   19920          200            200            0.0026763515   0.00051020724  0              0.0075188474   2.1239556e-19  0              1.0255821e-14  1.1971759e-13  0              2.9940118    
   3000000   19920          200            200            0.0026763515   0.00051020724  0              0.0075188474   3.9693809e-18  0              1.916672e-13   1.1971759e-13  0              2.9940118    
Loop time of 731.08 on 2 procs for 3000000 steps with 5001 atoms

Performance: 3545439.419 ns/day, 0.000 hours/ns, 4103.518 timesteps/s
100.0% CPU use with 2 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 162.7      | 164.6      | 166.51     |  14.8 | 22.52
Neigh   | 24.289     | 24.293     | 24.297     |   0.1 |  3.32
Comm    | 54.376     | 56.277     | 58.177     |  25.3 |  7.70
Output  | 0.65019    | 0.65021    | 0.65022    |   0.0 |  0.09
Modify  | 427.23     | 427.28     | 427.33     |   0.3 | 58.44
Other   |            | 57.98      |            |       |  7.93

Nlocal:         2500.5 ave        2501 max        2500 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Nghost:            2.5 ave           3 max           2 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Neighs:         1235.5 ave        1236 max        1235 min
Histogram: 1 0 0 0 0 0 0 0 0 1

Total # of neighbors = 2471
Ave neighs/atom = 0.49410118
Neighbor list builds = 166
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 65

#variable lat0 equal 1                    #
variable lat1 equal 3+((300)*0.01)+(v_ind*0.01)        # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 1000*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 6.65                                                               
Lattice spacing in x,y,z = 6.65 6.65 6.65

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -9975 ${n1e1} -100 100 -100 100 units box
region box block -9975 9975 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -9975 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -9975 9975 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-9975 -100 -100) to (9975 100 100)
  2 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 3000 atoms
  using lattice units in orthogonal box = (-9975 -100 -100) to (9975 100 100)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 3000 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 2001 atoms
  using lattice units in orthogonal box = (-9975 -100 -100) to (9975 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  3000 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  3000 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  2001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  2001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
3000 atoms in group substrate
group slider1 region slider1
2001 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 2001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_65_*.dump id type diameter mass xu yu zu fx fy fz
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 12871 130 130
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 460.8 | 460.8 | 460.8 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   19950          200            200            0              0              0              0              0              0              0              1.1971759e-13  0              6            
    100000   19950          200            200            0.0020196262   3.2392741e-35  0              0.0060588787   1154413.7      0              5.5742508e+10  1.1971759e-13  0              3.3321835    
    200000   19950          200            200            0.00068083273 -9.0699552e-34  0              0.0020424982   260110.42      0              1.2559801e+10  1.1971759e-13  0              3.0839006    
    300000   19950          200            200           -1.0440184e-05 -3.2392495e-35  0             -3.1320551e-05  137.11432      0              6620759.9      1.1971759e-13  0              3.0434189    
    400000   19950          200            200           -1.9106553e-05  4.0490963e-36  0             -5.7319658e-05  482.69453      0              23307592       1.1971759e-13  0              3.0050489    
    500000   19950          200            200            0.0021183269  -9.5080755e-05  0              0.0064500616   2729.6535      0              1.318052e+08   1.1971759e-13  0              2.9943578    
    600000   19950          200            200            0.0016298638  -0.00020598951  0              0.005095581    21.722649      0              1048909        1.1971759e-13  0              2.995027     
    700000   19950          200            200            0.0022374074  -0.00051556983  0              0.0072277921   44.740054      0              2160337.1      1.1971759e-13  0              2.9940915    
    800000   19950          200            200            0.002437751   -0.00053284513  0              0.0078460982   0.45513585     0              21976.881      1.1971759e-13  0              2.9938311    
    900000   19950          200            200            0.0023342638  -0.00053045469  0              0.0075332461   0.8532114      0              41198.525      1.1971759e-13  0              2.9939568    
   1000000   19950          200            200            0.0023104836  -0.00052975351  0              0.0074612042   0.0032547009   0              157.15786      1.1971759e-13  0              2.9939873    
   1100000   19950          200            200            0.0023251484  -0.00053017449  0              0.0075056198   0.015953013    0              770.31391      1.1971759e-13  0              2.9939693    
   1200000   19950          200            200            0.0023278233  -0.00053025313  0              0.0075137231   9.1821575e-06  0              0.44337352     1.1971759e-13  0              2.9939658    
   1300000   19950          200            200            0.0023257494  -0.00053019504  0              0.0075074432   0.0002925725   0              14.127279      1.1971759e-13  0              2.9939683    
   1400000   19950          200            200            0.0023254662  -0.00053018659  0              0.0075065853   4.9603539e-08  0              0.0023951774   1.1971759e-13  0              2.9939687    
   1500000   19950          200            200            0.0023257556  -0.00053019474  0              0.0075074616   5.2578143e-06  0              0.25388104     1.1971759e-13  0              2.9939684    
   1600000   19950          200            200            0.0023257831  -0.00053019558  0              0.0075075448   1.3102028e-08  0              0.00063265004  1.1971759e-13  0              2.9939683    
   1700000   19950          200            200            0.0023257431  -0.00053019445  0              0.0075074238   9.2581196e-08  0              0.0044704146   1.1971759e-13  0              2.9939684    
   1800000   19950          200            200            0.0023257409  -0.00053019438  0              0.0075074171   7.0817657e-10  0              3.4195312e-05  1.1971759e-13  0              2.9939684    
   1900000   19950          200            200            0.0023257464  -0.00053019453  0              0.0075074336   1.5963996e-09  0              7.7084424e-05  1.1971759e-13  0              2.9939684    
   2000000   19950          200            200            0.0023257465  -0.00053019454  0              0.0075074339   2.5530188e-11  0              1.2327614e-06  1.1971759e-13  0              2.9939684    
   2100000   19950          200            200            0.0023257457  -0.00053019452  0              0.0075074317   2.6921381e-11  0              1.2999371e-06  1.1971759e-13  0              2.9939684    
   2200000   19950          200            200            0.0023257457  -0.00053019452  0              0.0075074317   7.5844579e-13  0              3.6622633e-08  1.1971759e-13  0              2.9939684    
   2300000   19950          200            200            0.0023257458  -0.00053019452  0              0.007507432    4.4311059e-13  0              2.1396225e-08  1.1971759e-13  0              2.9939684    
   2400000   19950          200            200            0.0023257458  -0.00053019452  0              0.007507432    2.0325746e-14  0              9.8145752e-10  1.1971759e-13  0              2.9939684    
   2500000   19950          200            200            0.0023257458  -0.00053019452  0              0.007507432    6.9727427e-15  0              3.3668879e-10  1.1971759e-13  0              2.9939684    
   2600000   19950          200            200            0.0023257458  -0.00053019452  0              0.007507432    4.998598e-16   0              2.4136441e-11  1.1971759e-13  0              2.9939684    
   2700000   19950          200            200            0.0023257458  -0.00053019452  0              0.007507432    6.5673884e-17  0              3.1711568e-12  1.1971759e-13  0              2.9939684    
   2800000   19950          200            200            0.0023257458  -0.00053019452  0              0.007507432    2.3498869e-17  0              1.1346763e-12  1.1971759e-13  0              2.9939684    
   2900000   19950          200            200            0.0023257458  -0.00053019452  0              0.007507432    6.5601373e-19  0              3.1676555e-14  1.1971759e-13  0              2.9939684    
   3000000   19950          200            200            0.0023257458  -0.00053019452  0              0.007507432    8.4899975e-18  0              4.0995159e-13  1.1971759e-13  0              2.9939684    
Loop time of 726.743 on 2 procs for 3000000 steps with 5001 atoms

Performance: 3566598.201 ns/day, 0.000 hours/ns, 4128.007 timesteps/s
99.9% CPU use with 2 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 162.55     | 163.25     | 163.95     |   5.5 | 22.46
Neigh   | 24.235     | 24.238     | 24.242     |   0.1 |  3.34
Comm    | 55.484     | 56.32      | 57.155     |  11.1 |  7.75
Output  | 0.63224    | 0.63225    | 0.63225    |   0.0 |  0.09
Modify  | 425.36     | 425.5      | 425.64     |   0.7 | 58.55
Other   |            | 56.81      |            |       |  7.82

Nlocal:         2500.5 ave        2501 max        2500 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Nghost:            2.5 ave           3 max           2 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Neighs:         1232.5 ave        1233 max        1232 min
Histogram: 1 0 0 0 0 0 0 0 0 1

Total # of neighbors = 2465
Ave neighs/atom = 0.49290142
Neighbor list builds = 166
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 66

#variable lat0 equal 1                    #
variable lat1 equal 3+((300)*0.01)+(v_ind*0.01)        # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 1000*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 6.66                                                               
Lattice spacing in x,y,z = 6.66 6.66 6.66

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -9990 ${n1e1} -100 100 -100 100 units box
region box block -9990 9990 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -9990 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -9990 9990 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-9990 -100 -100) to (9990 100 100)
  2 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 3000 atoms
  using lattice units in orthogonal box = (-9990 -100 -100) to (9990 100 100)
  create_atoms CPU = 0.002 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 3000 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 2001 atoms
  using lattice units in orthogonal box = (-9990 -100 -100) to (9990 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  3000 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  3000 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  2001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  2001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
3000 atoms in group substrate
group slider1 region slider1
2001 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 2001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_66_*.dump id type diameter mass xu yu zu fx fy fz
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 12891 130 130
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 461.5 | 461.5 | 461.5 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   19980          200            200            0              0              0              0              0              0              0              1.1971759e-13  0              6            
    100000   19980          200            200            0.0020167669   8.0860345e-36  0              0.0060503008   1154555.4      0              5.5749349e+10  1.1971759e-13  0              3.332153     
    200000   19980          200            200            0.00068016385  3.234412e-35   0              0.0020404916   260319.3       0              1.2569887e+10  1.1971759e-13  0              3.0838561    
    300000   19980          200            200           -9.8315692e-06 -1.2937631e-34  0             -2.9494708e-05  121.72684      0              5877753.4      1.1971759e-13  0              3.0434924    
    400000   19980          200            200           -1.7281088e-05  7.3652192e-42  0             -5.1843264e-05  394.20322      0              19034662       1.1971759e-13  0              3.0051454    
    500000   19980          200            200            0.0028309388   0.003012005    0              0.0054808115   2570.3714      0              1.2411404e+08  1.1971759e-13  0              2.9948089    
    600000   19980          200            200            0.0026081934   0.0026313234   0              0.005193257    42.695197      0              2061598.3      1.1971759e-13  0              2.9950251    
    700000   19980          200            200            0.003712102    0.0029484338   0              0.0081878722   26.052602      0              1257986.9      1.1971759e-13  0              2.9937166    
    800000   19980          200            200            0.0035008474   0.0029429955   0              0.0075595466   6.5728054      0              317377.25      1.1971759e-13  0              2.9939639    
    900000   19980          200            200            0.0034344006   0.0029302397   0              0.0073729623   0.11153279     0              5385.5195      1.1971759e-13  0              2.9940341    
   1000000   19980          200            200            0.0034905926   0.0029384714   0              0.0075333063   0.048746881    0              2353.8124      1.1971759e-13  0              2.9939712    
   1100000   19980          200            200            0.0034786164   0.0029366871   0              0.0074991622   0.01596811     0              771.0429       1.1971759e-13  0              2.9939849    
   1200000   19980          200            200            0.0034754563   0.0029362449   0              0.0074901241   0.00028279842  0              13.655324      1.1971759e-13  0              2.9939883    
   1300000   19980          200            200            0.0034782299   0.0029366485   0              0.0074980413   0.00011680685  0              5.6401847      1.1971759e-13  0              2.9939852    
   1400000   19980          200            200            0.0034776349   0.0029365596   0              0.0074963453   3.8908102e-05  0              1.878733       1.1971759e-13  0              2.9939859    
   1500000   19980          200            200            0.0034774808   0.002936538    0              0.0074959042   7.0727361e-07  0              0.034151712    1.1971759e-13  0              2.9939861    
   1600000   19980          200            200            0.0034776175   0.0029365579   0              0.0074962946   2.8044062e-07  0              0.013541474    1.1971759e-13  0              2.9939859    
   1700000   19980          200            200            0.0034775879   0.0029365535   0              0.0074962103   9.4810925e-08  0              0.0045780803   1.1971759e-13  0              2.9939859    
   1800000   19980          200            200            0.0034775804   0.0029365525   0              0.0074961888   1.7676488e-09  0              8.5353435e-05  1.1971759e-13  0              2.9939859    
   1900000   19980          200            200            0.0034775872   0.0029365534   0              0.007496208    6.7327501e-10  0              3.2510041e-05  1.1971759e-13  0              2.9939859    
   2000000   19980          200            200            0.0034775857   0.0029365532   0              0.0074962039   2.3102422e-10  0              1.1155333e-05  1.1971759e-13  0              2.9939859    
   2100000   19980          200            200            0.0034775853   0.0029365532   0              0.0074962028   4.4174368e-12  0              2.1330221e-07  1.1971759e-13  0              2.9939859    
   2200000   19980          200            200            0.0034775857   0.0029365532   0              0.0074962038   1.6165989e-12  0              7.8059773e-08  1.1971759e-13  0              2.9939859    
   2300000   19980          200            200            0.0034775856   0.0029365532   0              0.0074962035   5.6264108e-13  0              2.7167924e-08  1.1971759e-13  0              2.9939859    
   2400000   19980          200            200            0.0034775856   0.0029365532   0              0.0074962035   1.1029533e-14  0              5.3257667e-10  1.1971759e-13  0              2.9939859    
   2500000   19980          200            200            0.0034775856   0.0029365532   0              0.0074962035   3.8414461e-15  0              1.8548968e-10  1.1971759e-13  0              2.9939859    
   2600000   19980          200            200            0.0034775856   0.0029365532   0              0.0074962035   1.3667019e-15  0              6.5993141e-11  1.1971759e-13  0              2.9939859    
   2700000   19980          200            200            0.0034775856   0.0029365532   0              0.0074962035   4.5373395e-18  0              2.1909189e-13  1.1971759e-13  0              2.9939859    
   2800000   19980          200            200            0.0034775856   0.0029365532   0              0.0074962035   2.2093374e-17  0              1.06681e-12    1.1971759e-13  0              2.9939859    
   2900000   19980          200            200            0.0034775856   0.0029365532   0              0.0074962035   1.4391503e-17  0              6.9491419e-13  1.1971759e-13  0              2.9939859    
   3000000   19980          200            200            0.0034775856   0.0029365532   0              0.0074962035   6.3228039e-18  0              3.0530557e-13  1.1971759e-13  0              2.9939859    
Loop time of 729.494 on 2 procs for 3000000 steps with 5001 atoms

Performance: 3553146.630 ns/day, 0.000 hours/ns, 4112.438 timesteps/s
99.9% CPU use with 2 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 165.82     | 165.91     | 166        |   0.7 | 22.74
Neigh   | 24.239     | 24.242     | 24.244     |   0.1 |  3.32
Comm    | 55.942     | 56.078     | 56.214     |   1.8 |  7.69
Output  | 0.6428     | 0.64282    | 0.64284    |   0.0 |  0.09
Modify  | 425.72     | 425.78     | 425.84     |   0.3 | 58.37
Other   |            | 56.85      |            |       |  7.79

Nlocal:         2500.5 ave        2501 max        2500 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Nghost:            2.5 ave           3 max           2 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Neighs:         1243.5 ave        1244 max        1243 min
Histogram: 1 0 0 0 0 0 0 0 0 1

Total # of neighbors = 2487
Ave neighs/atom = 0.49730054
Neighbor list builds = 166
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 67

#variable lat0 equal 1                    #
variable lat1 equal 3+((300)*0.01)+(v_ind*0.01)        # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 1000*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 6.67                                                               
Lattice spacing in x,y,z = 6.67 6.67 6.67

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -10005 ${n1e1} -100 100 -100 100 units box
region box block -10005 10005 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -10005 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -10005 10005 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-10005 -100 -100) to (10005 100 100)
  2 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 3000 atoms
  using lattice units in orthogonal box = (-10005 -100 -100) to (10005 100 100)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 3000 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 2001 atoms
  using lattice units in orthogonal box = (-10005 -100 -100) to (10005 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  3000 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  3000 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  2001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  2001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
3000 atoms in group substrate
group slider1 region slider1
2001 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 2001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_67_*.dump id type diameter mass xu yu zu fx fy fz
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 12910 130 130
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 462.2 | 462.2 | 462.2 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   20010          200            200            0              0              0              0              0              0              0              1.1971759e-13  0              6            
    100000   20010          200            200            0.0020135677  -2.0184734e-36  0              0.006040703    1154410.8      0              5.5742365e+10  1.1971759e-13  0              3.332187     
    200000   20010          200            200            0.00067877574 -8.8812878e-35  0              0.0020363272   260100.82      0              1.2559338e+10  1.1971759e-13  0              3.0839073    
    300000   20010          200            200           -1.043624e-05   4.8443441e-35  0             -3.1308719e-05  137.84776      0              6656174.9      1.1971759e-13  0              3.043419     
    400000   20010          200            200           -1.9223193e-05  1.0228126e-40  0             -5.7669578e-05  491.76887      0              23745759       1.1971759e-13  0              3.0050448    
    500000   20010          200            200            0.0055012136   0.0099860699   0              0.006517571    2745.4496      0              1.3256793e+08  1.1971759e-13  0              2.9943083    
    600000   20010          200            200            0.0039099365   0.0067099458   0              0.0050198638   2.4096396      0              116352.87      1.1971759e-13  0              2.9950533    
    700000   20010          200            200            0.0057837578   0.0091316258   0              0.0082196478   22.130038      0              1068580.3      1.1971759e-13  0              2.9936763    
    800000   20010          200            200            0.0054627622   0.0090227342   0              0.0073655523   5.9447061      0              287048.58      1.1971759e-13  0              2.9940068    
    900000   20010          200            200            0.005496463    0.0090327986   0              0.0074565905   0.85052455     0              41068.787      1.1971759e-13  0              2.9939733    
   1000000   20010          200            200            0.0055216331   0.0090466573   0              0.007518242    0.059601659    0              2877.9508      1.1971759e-13  0              2.9939471    
   1100000   20010          200            200            0.0055013761   0.0090360552   0              0.007468073    0.00083492919  0              40.315742      1.1971759e-13  0              2.9939677    
   1200000   20010          200            200            0.0055108687   0.0090416444   0              0.0074909616   0.00021149731  0              10.212448      1.1971759e-13  0              2.9939584    
   1300000   20010          200            200            0.0055076576   0.009039607    0              0.0074833657   0.00016898288  0              8.1595786      1.1971759e-13  0              2.9939615    
   1400000   20010          200            200            0.0055083692   0.0090400565   0              0.0074850512   3.8454656e-05  0              1.8568377      1.1971759e-13  0              2.9939608    
   1500000   20010          200            200            0.005508356    0.0090400527   0              0.0074850152   4.5899236e-06  0              0.22163098     1.1971759e-13  0              2.9939608    
   1600000   20010          200            200            0.0055082685   0.0090399945   0              0.0074848111   2.6026325e-07  0              0.012567181    1.1971759e-13  0              2.9939609    
   1700000   20010          200            200            0.0055083252   0.0090400315   0              0.007484944    1.0192642e-09  0              4.921662e-05   1.1971759e-13  0              2.9939608    
   1800000   20010          200            200            0.0055083014   0.0090400161   0              0.0074848881   2.3613297e-09  0              0.00011402016  1.1971759e-13  0              2.9939609    
   1900000   20010          200            200            0.0055083087   0.0090400208   0              0.0074849053   1.2101016e-09  0              5.8431474e-05  1.1971759e-13  0              2.9939608    
   2000000   20010          200            200            0.0055083073   0.00904002     0              0.007484902    2.3381942e-10  0              1.1290303e-05  1.1971759e-13  0              2.9939608    
   2100000   20010          200            200            0.0055083072   0.0090400199   0              0.0074849018   2.4170397e-11  0              1.167102e-06   1.1971759e-13  0              2.9939608    
   2200000   20010          200            200            0.0055083075   0.00904002     0              0.0074849024   1.0552257e-12  0              5.0953073e-08  1.1971759e-13  0              2.9939608    
   2300000   20010          200            200            0.0055083073   0.0090400199   0              0.007484902    2.3991082e-16  0              1.1584435e-11  1.1971759e-13  0              2.9939608    
   2400000   20010          200            200            0.0055083074   0.00904002     0              0.0074849022   2.1699982e-14  0              1.0478144e-09  1.1971759e-13  0              2.9939608    
   2500000   20010          200            200            0.0055083074   0.00904002     0              0.0074849021   8.1135374e-15  0              3.9177369e-10  1.1971759e-13  0              2.9939608    
   2600000   20010          200            200            0.0055083074   0.00904002     0              0.0074849021   1.3821584e-15  0              6.6739484e-11  1.1971759e-13  0              2.9939608    
   2700000   20010          200            200            0.0055083074   0.00904002     0              0.0074849021   1.6502605e-16  0              7.9685173e-12  1.1971759e-13  0              2.9939608    
   2800000   20010          200            200            0.0055083074   0.00904002     0              0.0074849021   1.493491e-17   0              7.2115334e-13  1.1971759e-13  0              2.9939608    
   2900000   20010          200            200            0.0055083074   0.00904002     0              0.0074849021   9.6794931e-20  0              4.6738808e-15  1.1971759e-13  0              2.9939608    
   3000000   20010          200            200            0.0055083074   0.00904002     0              0.0074849021   9.2570797e-19  0              4.4699125e-14  1.1971759e-13  0              2.9939608    
Loop time of 729.448 on 2 procs for 3000000 steps with 5001 atoms

Performance: 3553370.149 ns/day, 0.000 hours/ns, 4112.697 timesteps/s
99.9% CPU use with 2 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 162.61     | 164.07     | 165.53     |  11.4 | 22.49
Neigh   | 24.301     | 24.304     | 24.307     |   0.1 |  3.33
Comm    | 54.633     | 56.127     | 57.621     |  19.9 |  7.69
Output  | 0.6485     | 0.64851    | 0.64852    |   0.0 |  0.09
Modify  | 426.24     | 426.27     | 426.3      |   0.1 | 58.44
Other   |            | 58.03      |            |       |  7.96

Nlocal:         2500.5 ave        2501 max        2500 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Nghost:            2.5 ave           3 max           2 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Neighs:         1235.5 ave        1236 max        1235 min
Histogram: 1 0 0 0 0 0 0 0 0 1

Total # of neighbors = 2471
Ave neighs/atom = 0.49410118
Neighbor list builds = 166
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 68

#variable lat0 equal 1                    #
variable lat1 equal 3+((300)*0.01)+(v_ind*0.01)        # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 1000*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 6.68                                                               
Lattice spacing in x,y,z = 6.68 6.68 6.68

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -10020 ${n1e1} -100 100 -100 100 units box
region box block -10020 10020 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -10020 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -10020 10020 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-10020 -100 -100) to (10020 100 100)
  2 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 3000 atoms
  using lattice units in orthogonal box = (-10020 -100 -100) to (10020 100 100)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 3000 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 2001 atoms
  using lattice units in orthogonal box = (-10020 -100 -100) to (10020 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  3000 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  3000 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  2001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  2001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
3000 atoms in group substrate
group slider1 region slider1
2001 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 2001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_68_*.dump id type diameter mass xu yu zu fx fy fz
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 12930 130 130
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 462.8 | 462.8 | 462.8 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   20040          200            200            0              0              0              0              0              0              0              1.1971759e-13  0              6            
    100000   20040          200            200            0.0020103839  -1.6123582e-35  0              0.0060311516   1154272.7      0              5.5735699e+10  1.1971759e-13  0              3.3322129    
    200000   20040          200            200            0.00067742484  1.6123666e-35  0              0.0020322745   259902.93      0              1.2549782e+10  1.1971759e-13  0              3.0839434    
    300000   20040          200            200           -1.0932527e-05 -2.0154522e-36  0             -3.2797582e-05  151.96869      0              7338024.1      1.1971759e-13  0              3.0433449    
    400000   20040          200            200           -2.0807301e-05  2.5104448e-40  0             -6.2421903e-05  580.29675      0              28020453       1.1971759e-13  0              3.0049473    
    500000   20040          200            200            0.0015629213  -0.0028121426   0              0.0075009064   2783.2085      0              1.3439118e+08  1.1971759e-13  0              2.9938552    
    600000   20040          200            200            0.0010286685  -0.0021172338   0              0.0052032392   62.945124      0              3039394.8      1.1971759e-13  0              2.9949114    
    700000   20040          200            200            0.0017420701  -0.002026347    0              0.0072525574   46.511748      0              2245885.9      1.1971759e-13  0              2.99402      
    800000   20040          200            200            0.0019671078  -0.0019207764   0              0.0078220999   0.027805484    0              1342.6273      1.1971759e-13  0              2.9937791    
    900000   20040          200            200            0.0018383426  -0.0019102505   0              0.0074252785   0.77066873     0              37212.835      1.1971759e-13  0              2.99394      
   1000000   20040          200            200            0.0018424799  -0.0019104899   0              0.0074379295   0.048929224    0              2362.6171      1.1971759e-13  0              2.993936     
   1100000   20040          200            200            0.0018588101  -0.0019117576   0              0.0074881879   0.0046045756   0              222.33848      1.1971759e-13  0              2.9939152    
   1200000   20040          200            200            0.0018545473  -0.0019114346   0              0.0074750764   0.0020447398   0              98.733166      1.1971759e-13  0              2.9939205    
   1300000   20040          200            200            0.0018533208  -0.0019113365   0              0.0074712989   1.361358e-06   0              0.065735105    1.1971759e-13  0              2.9939221    
   1400000   20040          200            200            0.0018541734  -0.0019114021   0              0.0074739224   3.3844634e-05  0              1.6342363      1.1971759e-13  0              2.993921     
   1500000   20040          200            200            0.0018541444  -0.0019114004   0              0.0074738335   2.1942512e-06  0              0.10595254     1.1971759e-13  0              2.993921     
   1600000   20040          200            200            0.0018540363  -0.0019113919   0              0.0074735008   1.9842068e-07  0              0.0095810244   1.1971759e-13  0              2.9939212    
   1700000   20040          200            200            0.0018540648  -0.0019113941   0              0.0074735885   9.0409972e-08  0              0.004365574    1.1971759e-13  0              2.9939211    
   1800000   20040          200            200            0.0018540728  -0.0019113947   0              0.0074736133   7.259892e-11   0              3.505542e-06   1.1971759e-13  0              2.9939211    
   1900000   20040          200            200            0.0018540672  -0.0019113943   0              0.0074735958   1.4831559e-09  0              7.1616293e-05  1.1971759e-13  0              2.9939211    
   2000000   20040          200            200            0.0018540674  -0.0019113943   0              0.0074735965   9.8267183e-11  0              4.7449706e-06  1.1971759e-13  0              2.9939211    
   2100000   20040          200            200            0.0018540681  -0.0019113944   0              0.0074735987   8.5515148e-12  0              4.1292205e-07  1.1971759e-13  0              2.9939211    
   2200000   20040          200            200            0.0018540679  -0.0019113944   0              0.0074735981   3.9970504e-12  0              1.9300326e-07  1.1971759e-13  0              2.9939211    
   2300000   20040          200            200            0.0018540679  -0.0019113944   0              0.0074735979   3.8693291e-15  0              1.8683605e-10  1.1971759e-13  0              2.9939211    
   2400000   20040          200            200            0.0018540679  -0.0019113944   0              0.007473598    6.4832371e-14  0              3.1305232e-09  1.1971759e-13  0              2.9939211    
   2500000   20040          200            200            0.0018540679  -0.0019113944   0              0.007473598    4.233653e-15   0              2.0442795e-10  1.1971759e-13  0              2.9939211    
   2600000   20040          200            200            0.0018540679  -0.0019113944   0              0.007473598    3.4090641e-16  0              1.6461151e-11  1.1971759e-13  0              2.9939211    
   2700000   20040          200            200            0.0018540679  -0.0019113944   0              0.007473598    1.8306974e-16  0              8.8397826e-12  1.1971759e-13  0              2.9939211    
   2800000   20040          200            200            0.0018540679  -0.0019113944   0              0.007473598    6.268591e-18   0              3.0268783e-13  1.1971759e-13  0              2.9939211    
   2900000   20040          200            200            0.0018540679  -0.0019113944   0              0.007473598    8.5983035e-18  0              4.1518131e-13  1.1971759e-13  0              2.9939211    
   3000000   20040          200            200            0.0018540679  -0.0019113944   0              0.007473598    9.4684367e-18  0              4.5719692e-13  1.1971759e-13  0              2.9939211    
Loop time of 728.672 on 2 procs for 3000000 steps with 5001 atoms

Performance: 3557154.951 ns/day, 0.000 hours/ns, 4117.077 timesteps/s
99.9% CPU use with 2 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 160.94     | 162.12     | 163.3      |   9.3 | 22.25
Neigh   | 24.463     | 24.467     | 24.471     |   0.1 |  3.36
Comm    | 55.138     | 56.422     | 57.706     |  17.1 |  7.74
Output  | 0.65199    | 0.652      | 0.65202    |   0.0 |  0.09
Modify  | 426.12     | 426.21     | 426.31     |   0.5 | 58.49
Other   |            | 58.8       |            |       |  8.07

Nlocal:         2500.5 ave        2501 max        2500 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Nghost:            2.5 ave           3 max           2 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Neighs:         1233.5 ave        1234 max        1233 min
Histogram: 1 0 0 0 0 0 0 0 0 1

Total # of neighbors = 2467
Ave neighs/atom = 0.49330134
Neighbor list builds = 166
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 69

#variable lat0 equal 1                    #
variable lat1 equal 3+((300)*0.01)+(v_ind*0.01)        # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 1000*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 6.69                                                               
Lattice spacing in x,y,z = 6.69 6.69 6.69

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -10035 ${n1e1} -100 100 -100 100 units box
region box block -10035 10035 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -10035 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -10035 10035 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-10035 -100 -100) to (10035 100 100)
  2 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 3000 atoms
  using lattice units in orthogonal box = (-10035 -100 -100) to (10035 100 100)
  create_atoms CPU = 0.002 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 3000 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 2001 atoms
  using lattice units in orthogonal box = (-10035 -100 -100) to (10035 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  3000 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  3000 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  2001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  2001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
3000 atoms in group substrate
group slider1 region slider1
2001 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 2001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_69_*.dump id type diameter mass xu yu zu fx fy fz
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 12949 130 130
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 463.5 | 463.5 | 463.5 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   20070          200            200            0              0              0              0              0              0              0              1.1971759e-13  0              6            
    100000   20070          200            200            0.0020075473   1.6099555e-35  0              0.0060226419   1154410        0              5.5742328e+10  1.1971759e-13  0              3.3321879    
    200000   20070          200            200            0.0006767471   1.4852083e-41  0              0.0020302413   260101.17      0              1.2559355e+10  1.1971759e-13  0              3.0839073    
    300000   20070          200            200           -1.0407513e-05  5.1518525e-34  0             -3.1222538e-05  137.91433      0              6659389.6      1.1971759e-13  0              3.0434191    
    400000   20070          200            200           -1.9188926e-05  3.6234682e-40  0             -5.7566778e-05  492.98968      0              23804708       1.1971759e-13  0              3.0050442    
    500000   20070          200            200            0.0021865999   8.7398636e-05  0              0.006472401    2743.9139      0              1.3249378e+08  1.1971759e-13  0              2.9943154    
    600000   20070          200            200            0.0014081676  -0.0007907094   0              0.0050152123   3.6467056      0              176086.36      1.1971759e-13  0              2.995051     
    700000   20070          200            200            0.0031450929   0.0010759345   0              0.0083593442   8.7150829      0              420820.16      1.1971759e-13  0              2.9936139    
    800000   20070          200            200            0.002653055    0.00082040506  0              0.00713876     1.0379446      0              50118.629      1.1971759e-13  0              2.994091     
    900000   20070          200            200            0.0028282917   0.00090019309  0              0.0075846821   0.10782833     0              5206.6444      1.1971759e-13  0              2.9939125    
   1000000   20070          200            200            0.002765165    0.00087851889  0              0.007416976    0.0099887401   0              482.32051      1.1971759e-13  0              2.9939791    
   1100000   20070          200            200            0.0027887937   0.0008868634   0              0.0074795176   0.00084898761  0              40.994574      1.1971759e-13  0              2.9939542    
   1200000   20070          200            200            0.0027800035   0.00088378732  0              0.0074562231   6.1795896e-05  0              2.9839027      1.1971759e-13  0              2.9939635    
   1300000   20070          200            200            0.0027832634   0.00088493373  0              0.0074648565   3.3796527e-06  0              0.16319133     1.1971759e-13  0              2.99396      
   1400000   20070          200            200            0.0027820594   0.00088451047  0              0.0074616678   8.3102395e-08  0              0.0040127172   1.1971759e-13  0              2.9939613    
   1500000   20070          200            200            0.0027825024   0.00088466646  0              0.0074628409   1.3108922e-09  0              6.3298292e-05  1.1971759e-13  0              2.9939608    
   1600000   20070          200            200            0.0027823401   0.00088460923  0              0.0074624109   4.2621114e-09  0              0.00020580211  1.1971759e-13  0              2.993961     
   1700000   20070          200            200            0.0027823994   0.00088463016  0              0.0074625679   1.8426617e-09  0              8.8975537e-05  1.1971759e-13  0              2.9939609    
   1800000   20070          200            200            0.0027823778   0.00088462254  0              0.0074625108   5.1284272e-10  0              2.476334e-05   1.1971759e-13  0              2.993961     
   1900000   20070          200            200            0.0027823856   0.0008846253   0              0.0074625315   1.16769e-10    0              5.638357e-06   1.1971759e-13  0              2.993961     
   2000000   20070          200            200            0.0027823828   0.0008846243   0              0.007462524    2.3671971e-11  0              1.1430348e-06  1.1971759e-13  0              2.993961     
   2100000   20070          200            200            0.0027823838   0.00088462466  0              0.0074625267   4.4465085e-12  0              2.1470598e-07  1.1971759e-13  0              2.993961     
   2200000   20070          200            200            0.0027823834   0.00088462453  0              0.0074625258   7.9109829e-13  0              3.8199305e-08  1.1971759e-13  0              2.993961     
   2300000   20070          200            200            0.0027823836   0.00088462458  0              0.0074625261   1.3498985e-13  0              6.5181765e-09  1.1971759e-13  0              2.993961     
   2400000   20070          200            200            0.0027823835   0.00088462456  0              0.007462526    2.2075794e-14  0              1.0659611e-09  1.1971759e-13  0              2.993961     
   2500000   20070          200            200            0.0027823835   0.00088462457  0              0.007462526    3.5185268e-15  0              1.6989707e-10  1.1971759e-13  0              2.993961     
   2600000   20070          200            200            0.0027823835   0.00088462457  0              0.007462526    5.5713827e-16  0              2.6902213e-11  1.1971759e-13  0              2.993961     
   2700000   20070          200            200            0.0027823835   0.00088462457  0              0.007462526    1.3001481e-16  0              6.2779497e-12  1.1971759e-13  0              2.993961     
   2800000   20070          200            200            0.0027823835   0.00088462457  0              0.007462526    2.4126392e-17  0              1.1649771e-12  1.1971759e-13  0              2.993961     
   2900000   20070          200            200            0.0027823835   0.00088462457  0              0.007462526    1.1922167e-17  0              5.7567875e-13  1.1971759e-13  0              2.993961     
   3000000   20070          200            200            0.0027823835   0.00088462457  0              0.007462526    8.9267987e-18  0              4.3104316e-13  1.1971759e-13  0              2.993961     
Loop time of 731.384 on 2 procs for 3000000 steps with 5001 atoms

Performance: 3543964.176 ns/day, 0.000 hours/ns, 4101.810 timesteps/s
100.0% CPU use with 2 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 165.2      | 165.29     | 165.38     |   0.7 | 22.60
Neigh   | 24.181     | 24.184     | 24.187     |   0.1 |  3.31
Comm    | 55.844     | 55.931     | 56.018     |   1.2 |  7.65
Output  | 0.6419     | 0.64191    | 0.64193    |   0.0 |  0.09
Modify  | 426.54     | 426.6      | 426.66     |   0.3 | 58.33
Other   |            | 58.73      |            |       |  8.03

Nlocal:         2500.5 ave        2501 max        2500 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Nghost:            2.5 ave           3 max           2 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Neighs:         1238.5 ave        1239 max        1238 min
Histogram: 1 0 0 0 0 0 0 0 0 1

Total # of neighbors = 2477
Ave neighs/atom = 0.49530094
Neighbor list builds = 166
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 70

#variable lat0 equal 1                    #
variable lat1 equal 3+((300)*0.01)+(v_ind*0.01)        # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 1000*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 6.7                                                               
Lattice spacing in x,y,z = 6.7 6.7 6.7

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -10050 ${n1e1} -100 100 -100 100 units box
region box block -10050 10050 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -10050 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -10050 10050 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-10050 -100 -100) to (10050 100 100)
  2 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 3000 atoms
  using lattice units in orthogonal box = (-10050 -100 -100) to (10050 100 100)
  create_atoms CPU = 0.002 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 3000 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 2001 atoms
  using lattice units in orthogonal box = (-10050 -100 -100) to (10050 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  3000 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  3000 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  2001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  2001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
3000 atoms in group substrate
group slider1 region slider1
2001 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 2001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_70_*.dump id type diameter mass xu yu zu fx fy fz
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 12968 130 130
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 464.2 | 464.2 | 464.2 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   20100          200            200            0              0              0              0              0              0              0              1.1971759e-13  0              6            
    100000   20100          200            200            0.0020044147   1.6075558e-35  0              0.0060132442   1154304.9      0              5.5737251e+10  1.1971759e-13  0              3.3321836    
    200000   20100          200            200            0.00067543787 -3.2150975e-35  0              0.0020263136   259924.94      0              1.2550845e+10  1.1971759e-13  0              3.0839264    
    300000   20100          200            200           -1.0649167e-05  1.3457755e-40  0             -3.1947502e-05  144.94725      0              6998983.8      1.1971759e-13  0              3.043345     
    400000   20100          200            200           -2.0031598e-05  1.607557e-35   0             -6.0094794e-05  540.07401      0              26078241       1.1971759e-13  0              3.0049693    
    500000   20100          200            200            0.0021480674  -0.00080033324  0              0.0072445354   2718.4051      0              1.3126205e+08  1.1971759e-13  0              2.9939296    
    600000   20100          200            200            0.0031886261  -0.00039168281  0              0.0099575611   28.398216      0              1371248.2      1.1971759e-13  0              2.9928716    
    700000   20100          200            200            0.0021029916  -0.00056926423  0              0.0068782392   27.072651      0              1307241.4      1.1971759e-13  0              2.9941644    
    800000   20100          200            200            0.0023180702  -0.00057974481  0              0.0075339555   5.9943926      0              289447.76      1.1971759e-13  0              2.9938558    
    900000   20100          200            200            0.0022981771  -0.00057874637  0              0.0074732777   0.84072142     0              40595.429      1.1971759e-13  0              2.9938871    
   1000000   20100          200            200            0.0022823467  -0.00057809183  0              0.0074251318   0.076514226    0              3694.5982      1.1971759e-13  0              2.9939075    
   1100000   20100          200            200            0.0022956019  -0.00057866633  0              0.0074654719   0.0035383735   0              170.85539      1.1971759e-13  0              2.9938896    
   1200000   20100          200            200            0.0022889833  -0.00057837602  0              0.0074453261   4.1937089e-06  0              0.2024992      1.1971759e-13  0              2.9938987    
   1300000   20100          200            200            0.0022915724  -0.00057849089  0              0.0074532081   4.4245359e-05  0              2.13645        1.1971759e-13  0              2.9938951    
   1400000   20100          200            200            0.0022907523  -0.00057845414  0              0.007450711    2.1815814e-05  0              1.0534076      1.1971759e-13  0              2.9938962    
   1500000   20100          200            200            0.0022909457  -0.00057846297  0              0.0074512999   4.8003907e-06  0              0.23179368     1.1971759e-13  0              2.993896     
   1600000   20100          200            200            0.0022909283  -0.00057846208  0              0.0074512469   6.7080517e-07  0              0.032390781    1.1971759e-13  0              2.993896     
   1700000   20100          200            200            0.0022909137  -0.00057846148  0              0.0074512027   6.0651609e-08  0              0.0029286492   1.1971759e-13  0              2.993896     
   1800000   20100          200            200            0.0022909257  -0.000578462    0              0.007451239    2.7550396e-09  0              0.000133031    1.1971759e-13  0              2.993896     
   1900000   20100          200            200            0.0022909197  -0.00057846174  0              0.007451221    2.3510108e-12  0              1.135219e-07   1.1971759e-13  0              2.993896     
   2000000   20100          200            200            0.0022909221  -0.00057846184  0              0.007451228    3.6626397e-11  0              1.7685577e-06  1.1971759e-13  0              2.993896     
   2100000   20100          200            200            0.0022909213  -0.00057846181  0              0.0074512258   1.7684464e-11  0              8.5391947e-07  1.1971759e-13  0              2.993896     
   2200000   20100          200            200            0.0022909215  -0.00057846182  0              0.0074512263   3.8576314e-12  0              1.8627122e-07  1.1971759e-13  0              2.993896     
   2300000   20100          200            200            0.0022909215  -0.00057846182  0              0.0074512263   5.3603534e-13  0              2.5883228e-08  1.1971759e-13  0              2.993896     
   2400000   20100          200            200            0.0022909215  -0.00057846182  0              0.0074512262   4.8278992e-14  0              2.3312197e-09  1.1971759e-13  0              2.993896     
   2500000   20100          200            200            0.0022909215  -0.00057846182  0              0.0074512262   2.0854281e-15  0              1.0069786e-10  1.1971759e-13  0              2.993896     
   2600000   20100          200            200            0.0022909215  -0.00057846182  0              0.0074512262   8.6808011e-20  0              4.1916482e-15  1.1971759e-13  0              2.993896     
   2700000   20100          200            200            0.0022909215  -0.00057846182  0              0.0074512262   7.3333117e-17  0              3.5409938e-12  1.1971759e-13  0              2.993896     
   2800000   20100          200            200            0.0022909215  -0.00057846182  0              0.0074512262   2.4134696e-17  0              1.1653781e-12  1.1971759e-13  0              2.993896     
   2900000   20100          200            200            0.0022909215  -0.00057846182  0              0.0074512262   2.6274576e-18  0              1.2687052e-13  1.1971759e-13  0              2.993896     
   3000000   20100          200            200            0.0022909215  -0.00057846182  0              0.0074512262   9.4703199e-18  0              4.5728785e-13  1.1971759e-13  0              2.993896     
Loop time of 727.301 on 2 procs for 3000000 steps with 5001 atoms

Performance: 3563859.974 ns/day, 0.000 hours/ns, 4124.838 timesteps/s
99.9% CPU use with 2 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 158.59     | 159.72     | 160.84     |   8.9 | 21.96
Neigh   | 24.274     | 24.277     | 24.28      |   0.1 |  3.34
Comm    | 54.686     | 55.727     | 56.767     |  13.9 |  7.66
Output  | 0.6334     | 0.6334     | 0.6334     |   0.0 |  0.09
Modify  | 428.21     | 429.43     | 430.65     |   5.9 | 59.04
Other   |            | 57.51      |            |       |  7.91

Nlocal:         2500.5 ave        2501 max        2500 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Nghost:            2.5 ave           3 max           2 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Neighs:         1223.5 ave        1224 max        1223 min
Histogram: 1 0 0 0 0 0 0 0 0 1

Total # of neighbors = 2447
Ave neighs/atom = 0.48930214
Neighbor list builds = 166
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 71

#variable lat0 equal 1                    #
variable lat1 equal 3+((300)*0.01)+(v_ind*0.01)        # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 1000*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 6.71                                                               
Lattice spacing in x,y,z = 6.71 6.71 6.71

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -10065 ${n1e1} -100 100 -100 100 units box
region box block -10065 10065 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -10065 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -10065 10065 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-10065 -100 -100) to (10065 100 100)
  2 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 3000 atoms
  using lattice units in orthogonal box = (-10065 -100 -100) to (10065 100 100)
  create_atoms CPU = 0.002 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 3000 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 2001 atoms
  using lattice units in orthogonal box = (-10065 -100 -100) to (10065 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  3000 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  3000 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  2001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  2001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
3000 atoms in group substrate
group slider1 region slider1
2001 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 2001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_71_*.dump id type diameter mass xu yu zu fx fy fz
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 12988 130 130
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 464.9 | 464.9 | 464.9 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   20130          200            200            0              0              0              0              0              0              0              1.1971759e-13  0              6            
    100000   20130          200            200            0.0020012317   2.0764239e-41  0              0.0060036952   1154135.5      0              5.5729073e+10  1.1971759e-13  0              3.332251     
    200000   20130          200            200            0.00067399855  3.0096632e-35  0              0.0020219957   259663.89      0              1.253824e+10   1.1971759e-13  0              3.0840214    
    300000   20130          200            200           -1.160979e-05   3.2103229e-35  0             -3.4829371e-05  173.3041       0              8368234.8      1.1971759e-13  0              3.0432863    
    400000   20130          200            200           -2.302968e-05   2.9765731e-41  0             -6.908904e-05   721.52952      0              34840078       1.1971759e-13  0              3.0048457    
    500000   20130          200            200            0.0022261393  -0.0024672562   0              0.009145674    2619.2205      0              1.2647278e+08  1.1971759e-13  0              2.9931817    
    600000   20130          200            200            0.0013181755  -0.0018280446   0              0.0057825711   212.07624      0              10240403       1.1971759e-13  0              2.9945977    
    700000   20130          200            200            0.0016352977  -0.0021340424   0              0.0070399356   40.227659      0              1942449.7      1.1971759e-13  0              2.9940665    
    800000   20130          200            200            0.0019297932  -0.0019949801   0              0.0077843596   0.20341762     0              9822.3089      1.1971759e-13  0              2.993753     
    900000   20130          200            200            0.0017816112  -0.0019998754   0              0.0073447091   0.39915197     0              19273.62       1.1971759e-13  0              2.9939313    
   1000000   20130          200            200            0.0018125368  -0.0020006793   0              0.0074382899   0.11996091     0              5792.483       1.1971759e-13  0              2.9938939    
   1100000   20130          200            200            0.0018180761  -0.00199951     0              0.0074537382   0.00579671     0              279.90238      1.1971759e-13  0              2.9938871    
   1200000   20130          200            200            0.0018118133  -0.001998556    0              0.0074339961   0.00012220988  0              5.9010778      1.1971759e-13  0              2.9938952    
   1300000   20130          200            200            0.0018140829  -0.0019988883   0              0.0074411371   0.00023717524  0              11.452344      1.1971759e-13  0              2.9938923    
   1400000   20130          200            200            0.0018138666  -0.0019988588   0              0.0074404586   3.2514632e-05  0              1.5700152      1.1971759e-13  0              2.9938926    
   1500000   20130          200            200            0.0018136624  -0.0019988275   0              0.0074398146   3.4848646e-07  0              0.016827164    1.1971759e-13  0              2.9938929    
   1600000   20130          200            200            0.0018137868  -0.0019988461   0              0.0074402066   2.4155781e-07  0              0.011663962    1.1971759e-13  0              2.9938927    
   1700000   20130          200            200            0.0018137562  -0.0019988416   0              0.0074401102   9.5397612e-08  0              0.0046064093   1.1971759e-13  0              2.9938927    
   1800000   20130          200            200            0.0018137538  -0.0019988412   0              0.0074401025   6.0959022e-09  0              0.0002943493   1.1971759e-13  0              2.9938927    
   1900000   20130          200            200            0.001813759   -0.001998842    0              0.0074401191   2.6010227e-11  0              1.2559408e-06  1.1971759e-13  0              2.9938927    
   2000000   20130          200            200            0.0018137569  -0.0019988417   0              0.0074401124   1.6601161e-10  0              8.0161064e-06  1.1971759e-13  0              2.9938927    
   2100000   20130          200            200            0.0018137572  -0.0019988417   0              0.0074401133   2.8396397e-11  0              1.3711604e-06  1.1971759e-13  0              2.9938927    
   2200000   20130          200            200            0.0018137573  -0.0019988417   0              0.0074401137   5.6901091e-13  0              2.74755e-08    1.1971759e-13  0              2.9938927    
   2300000   20130          200            200            0.0018137572  -0.0019988417   0              0.0074401134   1.3337187e-13  0              6.4400504e-09  1.1971759e-13  0              2.9938927    
   2400000   20130          200            200            0.0018137573  -0.0019988417   0              0.0074401135   7.4054279e-14  0              3.5758161e-09  1.1971759e-13  0              2.9938927    
   2500000   20130          200            200            0.0018137573  -0.0019988417   0              0.0074401135   5.8330598e-15  0              2.8165758e-10  1.1971759e-13  0              2.9938927    
   2600000   20130          200            200            0.0018137573  -0.0019988417   0              0.0074401135   1.7211819e-19  0              8.3109713e-15  1.1971759e-13  0              2.9938927    
   2700000   20130          200            200            0.0018137573  -0.0019988417   0              0.0074401135   6.4048366e-17  0              3.0926664e-12  1.1971759e-13  0              2.9938927    
   2800000   20130          200            200            0.0018137573  -0.0019988417   0              0.0074401135   2.0051882e-17  0              9.682336e-13   1.1971759e-13  0              2.9938927    
   2900000   20130          200            200            0.0018137573  -0.0019988417   0              0.0074401135   5.9022428e-18  0              2.8499818e-13  1.1971759e-13  0              2.9938927    
   3000000   20130          200            200            0.0018137573  -0.0019988417   0              0.0074401135   2.6008253e-18  0              1.2558455e-13  1.1971759e-13  0              2.9938927    
Loop time of 729.974 on 2 procs for 3000000 steps with 5001 atoms

Performance: 3550813.183 ns/day, 0.000 hours/ns, 4109.737 timesteps/s
99.9% CPU use with 2 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 163.89     | 164.43     | 164.98     |   4.3 | 22.53
Neigh   | 24.344     | 24.346     | 24.349     |   0.1 |  3.34
Comm    | 55.411     | 55.94      | 56.469     |   7.1 |  7.66
Output  | 0.64595    | 0.64596    | 0.64598    |   0.0 |  0.09
Modify  | 426.5      | 426.51     | 426.53     |   0.1 | 58.43
Other   |            | 58.1       |            |       |  7.96

Nlocal:         2500.5 ave        2501 max        2500 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Nghost:            2.5 ave           3 max           2 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Neighs:         1234.5 ave        1235 max        1234 min
Histogram: 1 0 0 0 0 0 0 0 0 1

Total # of neighbors = 2469
Ave neighs/atom = 0.49370126
Neighbor list builds = 166
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 72

#variable lat0 equal 1                    #
variable lat1 equal 3+((300)*0.01)+(v_ind*0.01)        # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 1000*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 6.72                                                               
Lattice spacing in x,y,z = 6.72 6.72 6.72

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -10080 ${n1e1} -100 100 -100 100 units box
region box block -10080 10080 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -10080 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -10080 10080 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-10080 -100 -100) to (10080 100 100)
  2 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 3000 atoms
  using lattice units in orthogonal box = (-10080 -100 -100) to (10080 100 100)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 3000 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 2001 atoms
  using lattice units in orthogonal box = (-10080 -100 -100) to (10080 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  3000 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  3000 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  2001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  2001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
3000 atoms in group substrate
group slider1 region slider1
2001 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 2001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_72_*.dump id type diameter mass xu yu zu fx fy fz
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 13007 130 130
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 465.6 | 465.6 | 465.6 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   20160          200            200            0              0              0              0              0              0              0              1.1971759e-13  0              6            
    100000   20160          200            200            0.0019984669   3.6062216e-35  0              0.0059954006   1154321.8      0              5.573807e+10   1.1971759e-13  0              3.3321706    
    200000   20160          200            200            0.00067357624  8.0138392e-36  0              0.0020207287   260016.68      0              1.2555275e+10  1.1971759e-13  0              3.0838716    
    300000   20160          200            200           -1.0930368e-05 -6.4110455e-35  0             -3.2791103e-05  153.76239      0              7424635.3      1.1971759e-13  0              3.0433472    
    400000   20160          200            200           -2.0078083e-05  9.1609056e-41  0             -6.023425e-05   545.98071      0              26363454       1.1971759e-13  0              3.0049553    
    500000   20160          200            200            0.0045780553   0.0044852014   0              0.0092489645   2620.5212      0              1.2653559e+08  1.1971759e-13  0              2.9932671    
    600000   20160          200            200            0.0023166828   0.0020138474   0              0.0049362011   0.51839899     0              25031.632      1.1971759e-13  0              2.9951042    
    700000   20160          200            200            0.0036824911   0.0026730849   0              0.0083743883   2.8273625      0              136523.22      1.1971759e-13  0              2.993651     
    800000   20160          200            200            0.003231083    0.0025865432   0              0.0071067058   1.0303873      0              49753.714      1.1971759e-13  0              2.9941535    
    900000   20160          200            200            0.0033862014   0.0026193478   0              0.0075392565   0.25541311     0              12332.985      1.1971759e-13  0              2.9939794    
   1000000   20160          200            200            0.0033340266   0.0026087469   0              0.0073933328   0.051849689    0              2503.6359      1.1971759e-13  0              2.9940375    
   1100000   20160          200            200            0.0033509818   0.0026122182   0              0.0074407271   0.0094704274   0              457.29305      1.1971759e-13  0              2.9940187    
   1200000   20160          200            200            0.0033457081   0.0026111495   0              0.0074259748   0.0015912713   0              76.836795      1.1971759e-13  0              2.9940245    
   1300000   20160          200            200            0.0033472516   0.0026114599   0              0.0074302951   0.00025073966  0              12.107321      1.1971759e-13  0              2.9940228    
   1400000   20160          200            200            0.0033468421   0.0026113789   0              0.0074291475   3.7380195e-05  0              1.8049559      1.1971759e-13  0              2.9940232    
   1500000   20160          200            200            0.0033469314   0.0026113959   0              0.0074293984   5.3023532e-06  0              0.25603166     1.1971759e-13  0              2.9940231    
   1600000   20160          200            200            0.0033469218   0.0026113944   0              0.0074293709   7.1748329e-07  0              0.0346447      1.1971759e-13  0              2.9940231    
   1700000   20160          200            200            0.0033469168   0.0026113932   0              0.0074293571   9.26401e-08    0              0.0044732589   1.1971759e-13  0              2.9940232    
   1800000   20160          200            200            0.0033469217   0.0026113943   0              0.0074293708   1.1391149e-08  0              0.00055003781  1.1971759e-13  0              2.9940231    
   1900000   20160          200            200            0.0033469188   0.0026113937   0              0.0074293627   1.3276773e-09  0              6.4108785e-05  1.1971759e-13  0              2.9940231    
   2000000   20160          200            200            0.0033469202   0.002611394    0              0.0074293667   1.4545874e-10  0              7.0236821e-06  1.1971759e-13  0              2.9940231    
   2100000   20160          200            200            0.0033469196   0.0026113938   0              0.0074293649   1.4764127e-11  0              7.1290684e-07  1.1971759e-13  0              2.9940231    
   2200000   20160          200            200            0.0033469199   0.0026113939   0              0.0074293657   1.3542048e-12  0              6.5389704e-08  1.1971759e-13  0              2.9940231    
   2300000   20160          200            200            0.0033469197   0.0026113939   0              0.0074293654   1.0698525e-13  0              5.165935e-09   1.1971759e-13  0              2.9940231    
   2400000   20160          200            200            0.0033469198   0.0026113939   0              0.0074293655   6.317968e-15   0              3.0507206e-10  1.1971759e-13  0              2.9940231    
   2500000   20160          200            200            0.0033469198   0.0026113939   0              0.0074293655   1.7035023e-16  0              8.2256028e-12  1.1971759e-13  0              2.9940231    
   2600000   20160          200            200            0.0033469198   0.0026113939   0              0.0074293655   4.299756e-19   0              2.0761983e-14  1.1971759e-13  0              2.9940231    
   2700000   20160          200            200            0.0033469198   0.0026113939   0              0.0074293655   8.9048009e-19  0              4.2998097e-14  1.1971759e-13  0              2.9940231    
   2800000   20160          200            200            0.0033469198   0.0026113939   0              0.0074293655   1.1152266e-18  0              5.3850301e-14  1.1971759e-13  0              2.9940231    
   2900000   20160          200            200            0.0033469198   0.0026113939   0              0.0074293655   3.867274e-19   0              1.8673682e-14  1.1971759e-13  0              2.9940231    
   3000000   20160          200            200            0.0033469198   0.0026113939   0              0.0074293655   1.7536296e-19  0              8.4676498e-15  1.1971759e-13  0              2.9940231    
Loop time of 727.319 on 2 procs for 3000000 steps with 5001 atoms

Performance: 3563773.814 ns/day, 0.000 hours/ns, 4124.738 timesteps/s
99.9% CPU use with 2 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 162.66     | 163.13     | 163.59     |   3.6 | 22.43
Neigh   | 24.385     | 24.388     | 24.391     |   0.1 |  3.35
Comm    | 55.234     | 55.768     | 56.303     |   7.2 |  7.67
Output  | 0.65144    | 0.65149    | 0.65153    |   0.0 |  0.09
Modify  | 425.08     | 426.59     | 428.11     |   7.3 | 58.65
Other   |            | 56.79      |            |       |  7.81

Nlocal:         2500.5 ave        2501 max        2500 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Nghost:            2.5 ave           3 max           2 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Neighs:         1232.5 ave        1233 max        1232 min
Histogram: 1 0 0 0 0 0 0 0 0 1

Total # of neighbors = 2465
Ave neighs/atom = 0.49290142
Neighbor list builds = 166
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 73

#variable lat0 equal 1                    #
variable lat1 equal 3+((300)*0.01)+(v_ind*0.01)        # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 1000*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 6.73                                                               
Lattice spacing in x,y,z = 6.73 6.73 6.73

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -10095 ${n1e1} -100 100 -100 100 units box
region box block -10095 10095 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -10095 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -10095 10095 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-10095 -100 -100) to (10095 100 100)
  2 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 3000 atoms
  using lattice units in orthogonal box = (-10095 -100 -100) to (10095 100 100)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 3000 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 2001 atoms
  using lattice units in orthogonal box = (-10095 -100 -100) to (10095 100 100)
  create_atoms CPU = 0.002 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  3000 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  3000 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  2001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  2001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
3000 atoms in group substrate
group slider1 region slider1
2001 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 2001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_73_*.dump id type diameter mass xu yu zu fx fy fz
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 13026 130 130
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 466.2 | 466.2 | 466.2 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   20190          200            200            0              0              0              0              0              0              0              1.1971759e-13  0              6            
    100000   20190          200            200            0.0019952797   1.6003846e-35  0              0.005985839    1154133.7      0              5.5728985e+10  1.1971759e-13  0              3.3322429    
    200000   20190          200            200            0.00067202893  1.0163492e-41  0              0.0020160868   259685.68      0              1.2539292e+10  1.1971759e-13  0              3.0839955    
    300000   20190          200            200           -1.1445302e-05  9.6023207e-35  0             -3.4335907e-05  169.37029      0              8178285.3      1.1971759e-13  0              3.0432739    
    400000   20190          200            200           -2.2449027e-05 -3.5208424e-34  0             -6.7347081e-05  688.80734      0              33260041       1.1971759e-13  0              3.0048454    
    500000   20190          200            200            0.0037353851   0.0024756904   0              0.008730465    2680.9053      0              1.2945132e+08  1.1971759e-13  0              2.993309     
    600000   20190          200            200            0.0021342605   0.00082221212  0              0.0055805692   171.35924      0              8274324.2      1.1971759e-13  0              2.9946682    
    700000   20190          200            200            0.0024815969   0.00027271683  0              0.0071720739   45.996598      0              2221011.1      1.1971759e-13  0              2.993985     
    800000   20190          200            200            0.0027329623   0.00046477866  0              0.0077341084   1.152256       0              55638.319      1.1971759e-13  0              2.9937463    
    900000   20190          200            200            0.002563867    0.00039102474  0              0.0073005763   0.13343238     0              6442.9719      1.1971759e-13  0              2.9939236    
   1000000   20190          200            200            0.0026123814   0.00040203928  0              0.0074351051   0.10476553     0              5058.7525      1.1971759e-13  0              2.9938689    
   1100000   20190          200            200            0.0026094355   0.00040330698  0              0.0074249996   0.013309091    0              642.64838      1.1971759e-13  0              2.9938726    
   1200000   20190          200            200            0.0026050072   0.00040296166  0              0.0074120599   0.00023407675  0              11.302729      1.1971759e-13  0              2.993878     
   1300000   20190          200            200            0.0026077323   0.00040317355  0              0.0074200232   5.9485358e-05  0              2.872335       1.1971759e-13  0              2.9938748    
   1400000   20190          200            200            0.002606939    0.00040311422  0              0.0074177028   3.5902317e-05  0              1.7335944      1.1971759e-13  0              2.9938757    
   1500000   20190          200            200            0.0026069772   0.00040311661  0              0.0074178149   4.0745077e-06  0              0.19674339     1.1971759e-13  0              2.9938757    
   1600000   20190          200            200            0.0026070644   0.00040312343  0              0.0074180698   4.9934981e-08  0              0.0024111815   1.1971759e-13  0              2.9938756    
   1700000   20190          200            200            0.0026070148   0.00040311963  0              0.0074179247   2.482954e-08   0              0.0011989296   1.1971759e-13  0              2.9938756    
   1800000   20190          200            200            0.0026070284   0.00040312066  0              0.0074179644   1.2194127e-08  0              0.00058881077  1.1971759e-13  0              2.9938756    
   1900000   20190          200            200            0.0026070281   0.00040312065  0              0.0074179637   1.2336348e-09  0              5.9567812e-05  1.1971759e-13  0              2.9938756    
   2000000   20190          200            200            0.0026070264   0.00040312051  0              0.0074179587   9.3571842e-12  0              4.5182494e-07  1.1971759e-13  0              2.9938756    
   2100000   20190          200            200            0.0026070273   0.00040312058  0              0.0074179614   1.0018349e-11  0              4.8375023e-07  1.1971759e-13  0              2.9938756    
   2200000   20190          200            200            0.0026070271   0.00040312056  0              0.0074179607   4.102664e-12   0              1.9810296e-07  1.1971759e-13  0              2.9938756    
   2300000   20190          200            200            0.0026070271   0.00040312056  0              0.0074179607   3.6912244e-13  0              1.7823602e-08  1.1971759e-13  0              2.9938756    
   2400000   20190          200            200            0.0026070271   0.00040312057  0              0.0074179608   1.414226e-15   0              6.8287914e-11  1.1971759e-13  0              2.9938756    
   2500000   20190          200            200            0.0026070271   0.00040312057  0              0.0074179607   3.8133971e-15  0              1.841353e-10   1.1971759e-13  0              2.9938756    
   2600000   20190          200            200            0.0026070271   0.00040312057  0              0.0074179607   1.348532e-15   0              6.5115782e-11  1.1971759e-13  0              2.9938756    
   2700000   20190          200            200            0.0026070271   0.00040312057  0              0.0074179607   1.5691473e-16  0              7.5768507e-12  1.1971759e-13  0              2.9938756    
   2800000   20190          200            200            0.0026070271   0.00040312057  0              0.0074179607   7.2279123e-18  0              3.4901002e-13  1.1971759e-13  0              2.9938756    
   2900000   20190          200            200            0.0026070271   0.00040312057  0              0.0074179607   7.646615e-19   0              3.6922767e-14  1.1971759e-13  0              2.9938756    
   3000000   20190          200            200            0.0026070271   0.00040312056  0              0.0074179607   3.7714094e-18  0              1.8210786e-13  1.1971759e-13  0              2.9938756    
Loop time of 725.989 on 2 procs for 3000000 steps with 5001 atoms

Performance: 3570303.508 ns/day, 0.000 hours/ns, 4132.296 timesteps/s
99.9% CPU use with 2 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 160.62     | 161.94     | 163.26     |  10.4 | 22.31
Neigh   | 24.42      | 24.423     | 24.426     |   0.1 |  3.36
Comm    | 54.842     | 56.15      | 57.458     |  17.5 |  7.73
Output  | 0.63985    | 0.63987    | 0.63989    |   0.0 |  0.09
Modify  | 425.35     | 425.37     | 425.39     |   0.1 | 58.59
Other   |            | 57.46      |            |       |  7.92

Nlocal:         2500.5 ave        2501 max        2500 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Nghost:            2.5 ave           3 max           2 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Neighs:         1232.5 ave        1233 max        1232 min
Histogram: 1 0 0 0 0 0 0 0 0 1

Total # of neighbors = 2465
Ave neighs/atom = 0.49290142
Neighbor list builds = 166
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 74

#variable lat0 equal 1                    #
variable lat1 equal 3+((300)*0.01)+(v_ind*0.01)        # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 1000*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 6.74                                                               
Lattice spacing in x,y,z = 6.74 6.74 6.74

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -10110 ${n1e1} -100 100 -100 100 units box
region box block -10110 10110 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -10110 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -10110 10110 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-10110 -100 -100) to (10110 100 100)
  2 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 3000 atoms
  using lattice units in orthogonal box = (-10110 -100 -100) to (10110 100 100)
  create_atoms CPU = 0.002 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 3000 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 2001 atoms
  using lattice units in orthogonal box = (-10110 -100 -100) to (10110 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  3000 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  3000 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  2001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  2001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
3000 atoms in group substrate
group slider1 region slider1
2001 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 2001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_74_*.dump id type diameter mass xu yu zu fx fy fz
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 13046 130 130
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 466.9 | 466.9 | 466.9 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   20220          200            200            0              0              0              0              0              0              0              1.1971759e-13  0              6            
    100000   20220          200            200            0.0019921493   6.9507299e-43  0              0.0059764478   1153993.8      0              5.5722232e+10  1.1971759e-13  0              3.3322695    
    200000   20220          200            200            0.0006706895   2.355899e-40   0              0.0020120685   259481.43      0              1.252943e+10   1.1971759e-13  0              3.0840344    
    300000   20220          200            200           -1.1954716e-05 -1.2784046e-34  0             -3.5864149e-05  185.62723      0              8963274.8      1.1971759e-13  0              3.0431976    
    400000   20220          200            200           -2.4000915e-05 -3.196006e-35   0             -7.2002746e-05  792.89485      0              38286055       1.1971759e-13  0              3.0047391    
    500000   20220          200            200            0.0071098323   0.011499156    0              0.0098303406   2463.3574      0              1.1894671e+08  1.1971759e-13  0              2.9928544    
    600000   20220          200            200            0.0043454084   0.0068781952   0              0.0061580298   282.94194      0              13662254       1.1971759e-13  0              2.9943478    
    700000   20220          200            200            0.0045317469   0.0068362929   0              0.0067589478   24.965596      0              1205499.3      1.1971759e-13  0              2.9941088    
    800000   20220          200            200            0.004944784    0.0070908319   0              0.00774352     0.4222953      0              20391.129      1.1971759e-13  0              2.9936937    
    900000   20220          200            200            0.0047992696   0.007028746    0              0.0073690628   0.81660435     0              39430.901      1.1971759e-13  0              2.9938451    
   1000000   20220          200            200            0.0048019219   0.0070295482   0              0.0073762174   0.066393755    0              3205.9168      1.1971759e-13  0              2.9938434    
   1100000   20220          200            200            0.0048208385   0.0070389087   0              0.0074236068   0.00052973265  0              25.578894      1.1971759e-13  0              2.9938236    
   1200000   20220          200            200            0.0048132633   0.0070352414   0              0.0074045485   0.0018910489   0              91.311985      1.1971759e-13  0              2.9938314    
   1300000   20220          200            200            0.0048136192   0.0070353909   0              0.0074054668   0.00018357245  0              8.8640567      1.1971759e-13  0              2.9938311    
   1400000   20220          200            200            0.0048145022   0.0070358279   0              0.0074076787   4.4166929e-07  0              0.021326629    1.1971759e-13  0              2.9938301    
   1500000   20220          200            200            0.0048141164   0.0070356406   0              0.0074067087   4.3143624e-06  0              0.20832512     1.1971759e-13  0              2.9938305    
   1600000   20220          200            200            0.0048141453   0.0070356535   0              0.0074067824   4.9784806e-07  0              0.024039301    1.1971759e-13  0              2.9938305    
   1700000   20220          200            200            0.0048141861   0.0070356738   0              0.0074068846   8.7923112e-11  0              4.2454924e-06  1.1971759e-13  0              2.9938305    
   1800000   20220          200            200            0.0048141666   0.0070356643   0              0.0074068356   9.7041778e-09  0              0.00046858002  1.1971759e-13  0              2.9938305    
   1900000   20220          200            200            0.0048141686   0.0070356652   0              0.0074068406   1.3280234e-09  0              6.4125498e-05  1.1971759e-13  0              2.9938305    
   2000000   20220          200            200            0.0048141705   0.0070356661   0              0.0074068453   4.8400171e-13  0              2.337071e-08   1.1971759e-13  0              2.9938305    
   2100000   20220          200            200            0.0048141695   0.0070356656   0              0.0074068428   2.1497048e-11  0              1.0380155e-06  1.1971759e-13  0              2.9938305    
   2200000   20220          200            200            0.0048141696   0.0070356657   0              0.0074068431   3.4899134e-12  0              1.6851543e-07  1.1971759e-13  0              2.9938305    
   2300000   20220          200            200            0.0048141697   0.0070356657   0              0.0074068433   8.4998072e-15  0              4.1042527e-10  1.1971759e-13  0              2.9938305    
   2400000   20220          200            200            0.0048141696   0.0070356657   0              0.0074068432   4.6563599e-14  0              2.2483895e-09  1.1971759e-13  0              2.9938305    
   2500000   20220          200            200            0.0048141696   0.0070356657   0              0.0074068432   8.9236595e-15  0              4.3089158e-10  1.1971759e-13  0              2.9938305    
   2600000   20220          200            200            0.0048141697   0.0070356657   0              0.0074068432   5.0819691e-17  0              2.453901e-12   1.1971759e-13  0              2.9938305    
   2700000   20220          200            200            0.0048141696   0.0070356657   0              0.0074068432   5.1816828e-17  0              2.5020492e-12  1.1971759e-13  0              2.9938305    
   2800000   20220          200            200            0.0048141696   0.0070356657   0              0.0074068432   2.129893e-17   0              1.0284491e-12  1.1971759e-13  0              2.9938305    
   2900000   20220          200            200            0.0048141696   0.0070356657   0              0.0074068432   7.9388749e-19  0              3.8333986e-14  1.1971759e-13  0              2.9938305    
   3000000   20220          200            200            0.0048141696   0.0070356657   0              0.0074068432   1.8135843e-18  0              8.7571497e-14  1.1971759e-13  0              2.9938305    
Loop time of 727.379 on 2 procs for 3000000 steps with 5001 atoms

Performance: 3563477.142 ns/day, 0.000 hours/ns, 4124.395 timesteps/s
100.0% CPU use with 2 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 160        | 161.13     | 162.26     |   8.9 | 22.15
Neigh   | 24.65      | 24.652     | 24.655     |   0.1 |  3.39
Comm    | 55.217     | 56.378     | 57.54      |  15.5 |  7.75
Output  | 0.64151    | 0.64153    | 0.64155    |   0.0 |  0.09
Modify  | 426.52     | 426.59     | 426.66     |   0.3 | 58.65
Other   |            | 57.99      |            |       |  7.97

Nlocal:         2500.5 ave        2501 max        2500 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Nghost:            2.5 ave           3 max           2 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Neighs:         1233.5 ave        1234 max        1233 min
Histogram: 1 0 0 0 0 0 0 0 0 1

Total # of neighbors = 2467
Ave neighs/atom = 0.49330134
Neighbor list builds = 166
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 75

#variable lat0 equal 1                    #
variable lat1 equal 3+((300)*0.01)+(v_ind*0.01)        # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 1000*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 6.75                                                               
Lattice spacing in x,y,z = 6.75 6.75 6.75

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -10125 ${n1e1} -100 100 -100 100 units box
region box block -10125 10125 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -10125 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -10125 10125 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-10125 -100 -100) to (10125 100 100)
  2 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 3000 atoms
  using lattice units in orthogonal box = (-10125 -100 -100) to (10125 100 100)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 3000 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 2001 atoms
  using lattice units in orthogonal box = (-10125 -100 -100) to (10125 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  3000 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  3000 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  2001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  2001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
3000 atoms in group substrate
group slider1 region slider1
2001 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 2001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_75_*.dump id type diameter mass xu yu zu fx fy fz
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 13065 130 130
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 467.6 | 467.6 | 467.6 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   20250          200            200            0              0              0              0              0              0              0              1.1971759e-13  0              6            
    100000   20250          200            200            0.0019941801   1.1967313e-34  0              0.0059825404   1157082        0              5.587135e+10   1.1971759e-13  0              3.3356329    
    200000   20250          200            200            0.00067896091  4.7869288e-35  0              0.0020368827   264630.54      0              1.2778062e+10  1.1971759e-13  0              3.0875366    
    300000   20250          200            200            1.982079e-05   1.5956475e-35  0              5.946237e-05   483.86074      0              23363904       1.1971759e-13  0              3.0486232    
    400000   20250          200            200            0.00012855737  3.1912886e-35  0              0.00038567212  17242.738      0              8.3259008e+08  1.1971759e-13  0              3.0006597    
    500000   20250          200            200            0.00060133544 -1.5956368e-35  0              0.0018040063   2247.9817      0              1.0854699e+08  1.1971759e-13  0              2.9989928    
    600000   20250          200            200            0.0012769964   3.0863383e-41  0              0.0038309893   16.909794      0              816513.41      1.1971759e-13  0              2.9982476    
    700000   20250          200            200            0.0021550709   3.1912863e-35  0              0.0064652127   36.364924      0              1755932        1.1971759e-13  0              2.9975244    
    800000   20250          200            200            0.0025633172  -3.1912802e-35  0              0.0076899515   6.3585837      0              307033.25      1.1971759e-13  0              2.9972177    
    900000   20250          200            200            0.0025279669   7.9782325e-36  0              0.0075839006   0.13650099     0              6591.1442      1.1971759e-13  0              2.9972415    
   1000000   20250          200            200            0.0024652999   1.5956432e-35  0              0.0073958996   0.15891832     0              7673.5968      1.1971759e-13  0              2.9972873    
   1100000   20250          200            200            0.0024596727  -1.5956401e-35  0              0.007379018    0.00028378896  0              13.703153      1.1971759e-13  0              2.9972917    
   1200000   20250          200            200            0.0024671072   7.1803891e-35  0              0.0074013217   0.0025623119   0              123.72487      1.1971759e-13  0              2.9972862    
   1300000   20250          200            200            0.0024690989   2.0830975e-41  0              0.0074072967   0.00011349597  0              5.4803143      1.1971759e-13  0              2.9972848    
   1400000   20250          200            200            0.0024684326  -1.5956395e-35  0              0.0074052977   2.5156492e-05  0              1.2147169      1.1971759e-13  0              2.9972852    
   1500000   20250          200            200            0.0024680553   1.5956438e-35  0              0.0074041658   5.1030563e-06  0              0.24640832     1.1971759e-13  0              2.9972855    
   1600000   20250          200            200            0.002468082   -1.5956395e-35  0              0.0074042459   8.842103e-08   0              0.0042695351   1.1971759e-13  0              2.9972855    
   1700000   20250          200            200            0.002468137    3.9891062e-35  0              0.0074044109   1.238807e-07   0              0.0059817556   1.1971759e-13  0              2.9972855    
   1800000   20250          200            200            0.0024681425   2.3934646e-35  0              0.0074044275   3.4327326e-10  0              1.6575437e-05  1.1971759e-13  0              2.9972855    
   1900000   20250          200            200            0.002468136    2.1600213e-41  0              0.0074044081   1.9433409e-09  0              9.3836975e-05  1.1971759e-13  0              2.9972855    
   2000000   20250          200            200            0.0024681342   7.9782297e-36  0              0.0074044027   9.5878953e-11  0              4.6296515e-06  1.1971759e-13  0              2.9972855    
   2100000   20250          200            200            0.0024681348   7.9782297e-36  0              0.0074044044   1.8333814e-11  0              8.8527424e-07  1.1971759e-13  0              2.9972855    
   2200000   20250          200            200            0.0024681351   2.1618734e-41  0              0.0074044054   4.089721e-12   0              1.9747799e-07  1.1971759e-13  0              2.9972855    
   2300000   20250          200            200            0.0024681351   2.1600398e-41  0              0.0074044053   5.710378e-14   0              2.7573371e-09  1.1971759e-13  0              2.9972855    
   2400000   20250          200            200            0.0024681351  -3.9890824e-36  0              0.0074044052   9.6264916e-14  0              4.6482883e-09  1.1971759e-13  0              2.9972855    
   2500000   20250          200            200            0.0024681351   7.9782297e-36  0              0.0074044052   3.6128733e-16  0              1.7445272e-11  1.1971759e-13  0              2.9972855    
   2600000   20250          200            200            0.0024681351  -3.9890824e-36  0              0.0074044052   1.4920036e-15  0              7.2043513e-11  1.1971759e-13  0              2.9972855    
   2700000   20250          200            200            0.0024681351   1.9945542e-35  0              0.0074044052   9.1251399e-17  0              4.4062035e-12  1.1971759e-13  0              2.9972855    
   2800000   20250          200            200            0.0024681351  -3.9890825e-36  0              0.0074044052   2.3188855e-17  0              1.1197068e-12  1.1971759e-13  0              2.9972855    
   2900000   20250          200            200            0.0024681351   1.1967334e-35  0              0.0074044052   7.0512585e-21  0              3.4048004e-16  1.1971759e-13  0              2.9972855    
   3000000   20250          200            200            0.0024681351   3.9891257e-36  0              0.0074044052   4.8953734e-19  0              2.3638006e-14  1.1971759e-13  0              2.9972855    
Loop time of 743.012 on 2 procs for 3000000 steps with 5001 atoms

Performance: 3488502.210 ns/day, 0.000 hours/ns, 4037.618 timesteps/s
99.9% CPU use with 2 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 173.9      | 175.25     | 176.61     |  10.2 | 23.59
Neigh   | 24.729     | 24.732     | 24.735     |   0.1 |  3.33
Comm    | 56.431     | 57.896     | 59.362     |  19.3 |  7.79
Output  | 0.60566    | 0.60567    | 0.60569    |   0.0 |  0.08
Modify  | 425.87     | 425.87     | 425.88     |   0.0 | 57.32
Other   |            | 58.65      |            |       |  7.89

Nlocal:         2500.5 ave        2501 max        2500 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Nghost:            2.5 ave           3 max           2 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Neighs:         1333.5 ave        1334 max        1333 min
Histogram: 1 0 0 0 0 0 0 0 0 1

Total # of neighbors = 2667
Ave neighs/atom = 0.53329334
Neighbor list builds = 166
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 76

#variable lat0 equal 1                    #
variable lat1 equal 3+((300)*0.01)+(v_ind*0.01)        # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 1000*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 6.76                                                               
Lattice spacing in x,y,z = 6.76 6.76 6.76

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -10140 ${n1e1} -100 100 -100 100 units box
region box block -10140 10140 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -10140 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -10140 10140 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-10140 -100 -100) to (10140 100 100)
  2 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 3000 atoms
  using lattice units in orthogonal box = (-10140 -100 -100) to (10140 100 100)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 3000 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 2001 atoms
  using lattice units in orthogonal box = (-10140 -100 -100) to (10140 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  3000 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  3000 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  2001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  2001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
3000 atoms in group substrate
group slider1 region slider1
2001 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 2001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_76_*.dump id type diameter mass xu yu zu fx fy fz
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 13084 130 130
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 468.2 | 468.2 | 468.2 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   20280          200            200            0              0              0              0              0              0              0              1.1971759e-13  0              6            
    100000   20280          200            200            0.0019862562  -3.1865305e-35  0              0.0059587687   1153994.9      0              5.5722282e+10  1.1971759e-13  0              3.3322682    
    200000   20280          200            200            0.00066871282  4.9790048e-37  0              0.0020061385   259486.19      0              1.252966e+10   1.1971759e-13  0              3.0840312    
    300000   20280          200            200           -1.1899027e-05  8.2935732e-41  0             -3.569708e-05   184.98391      0              8932211        1.1971759e-13  0              3.0431977    
    400000   20280          200            200           -2.3943761e-05  1.8097228e-41  0             -7.1831282e-05  793.84125      0              38331753       1.1971759e-13  0              3.0047386    
    500000   20280          200            200           -0.00060072411 -0.011554417    0              0.0097522442   2471.4337      0              1.1933669e+08  1.1971759e-13  0              2.9928648    
    600000   20280          200            200           -0.00019827146 -0.006822497    0              0.0062276826   292.78515      0              14137547       1.1971759e-13  0              2.9943163    
    700000   20280          200            200           -7.6731411e-05 -0.0067108222   0              0.006480628    0.772716       0              37311.69       1.1971759e-13  0              2.9942242    
    800000   20280          200            200            0.00011085866 -0.0070010963   0              0.0073336723   6.4271644      0              310344.77      1.1971759e-13  0              2.9938579    
    900000   20280          200            200            0.00015445771 -0.0070361404   0              0.0074995136   0.14893915     0              7191.7386      1.1971759e-13  0              2.9937859    
   1000000   20280          200            200            0.00013145231 -0.0070191679   0              0.0074135248   0.071743356    0              3464.2299      1.1971759e-13  0              2.9938212    
   1100000   20280          200            200            0.00012127984 -0.0070111628   0              0.0073750024   0.010591428    0              511.42213      1.1971759e-13  0              2.9938375    
   1200000   20280          200            200            0.00012241021 -0.0070119643   0              0.0073791949   0.00026822271  0              12.951515      1.1971759e-13  0              2.9938359    
   1300000   20280          200            200            0.00012399307 -0.0070131984   0              0.0073851776   0.00028810486  0              13.911553      1.1971759e-13  0              2.9938334    
   1400000   20280          200            200            0.0001241431  -0.0070133261   0              0.0073857554   1.0705702e-06  0              0.051694004    1.1971759e-13  0              2.9938331    
   1500000   20280          200            200            0.00012395868 -0.0070131846   0              0.0073850607   4.3524073e-06  0              0.21016217     1.1971759e-13  0              2.9938334    
   1600000   20280          200            200            0.00012390331 -0.0070131404   0              0.0073848504   2.8861397e-07  0              0.013936136    1.1971759e-13  0              2.9938335    
   1700000   20280          200            200            0.00012391756 -0.007013151    0              0.0073849037   3.175106e-08   0              0.0015331451   1.1971759e-13  0              2.9938335    
   1800000   20280          200            200            0.00012392773 -0.007013159    0              0.0073849422   1.1294463e-08  0              0.0005453692   1.1971759e-13  0              2.9938335    
   1900000   20280          200            200            0.00012392775 -0.0070131591   0              0.0073849424   1.3666948e-11  0              6.5992801e-07  1.1971759e-13  0              2.9938335    
   2000000   20280          200            200            0.00012392639 -0.007013158    0              0.0073849372   2.2510138e-10  0              1.086934e-05   1.1971759e-13  0              2.9938335    
   2100000   20280          200            200            0.00012392613 -0.0070131578   0              0.0073849362   5.5949814e-12  0              2.7016163e-07  1.1971759e-13  0              2.9938335    
   2200000   20280          200            200            0.00012392626 -0.0070131579   0              0.0073849367   2.4558299e-12  0              1.1858324e-07  1.1971759e-13  0              2.9938335    
   2300000   20280          200            200            0.00012392632 -0.007013158    0              0.0073849369   3.8066346e-13  0              1.8380876e-08  1.1971759e-13  0              2.9938335    
   2400000   20280          200            200            0.00012392631 -0.007013158    0              0.0073849369   8.8961896e-15  0              4.2956516e-10  1.1971759e-13  0              2.9938335    
   2500000   20280          200            200            0.0001239263  -0.007013158    0              0.0073849369   1.0118743e-14  0              4.8859791e-10  1.1971759e-13  0              2.9938335    
   2600000   20280          200            200            0.0001239263  -0.007013158    0              0.0073849369   2.5694038e-17  0              1.2406731e-12  1.1971759e-13  0              2.9938335    
   2700000   20280          200            200            0.0001239263  -0.007013158    0              0.0073849369   1.814672e-16   0              8.7624015e-12  1.1971759e-13  0              2.9938335    
   2800000   20280          200            200            0.0001239263  -0.007013158    0              0.0073849369   3.1101637e-19  0              1.5017867e-14  1.1971759e-13  0              2.9938335    
   2900000   20280          200            200            0.00012392631 -0.007013158    0              0.0073849369   4.1776552e-18  0              2.0172402e-13  1.1971759e-13  0              2.9938335    
   3000000   20280          200            200            0.00012392631 -0.007013158    0              0.0073849369   1.6347004e-19  0              7.8933834e-15  1.1971759e-13  0              2.9938335    
Loop time of 724.752 on 2 procs for 3000000 steps with 5001 atoms

Performance: 3576396.125 ns/day, 0.000 hours/ns, 4139.347 timesteps/s
100.0% CPU use with 2 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 157.11     | 158.28     | 159.45     |   9.3 | 21.84
Neigh   | 24.59      | 24.593     | 24.596     |   0.1 |  3.39
Comm    | 55.091     | 56.379     | 57.667     |  17.2 |  7.78
Output  | 0.64957    | 0.64958    | 0.6496     |   0.0 |  0.09
Modify  | 426.62     | 426.71     | 426.8      |   0.4 | 58.88
Other   |            | 58.14      |            |       |  8.02

Nlocal:         2500.5 ave        2501 max        2500 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Nghost:            2.5 ave           3 max           2 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Neighs:         1230.5 ave        1231 max        1230 min
Histogram: 1 0 0 0 0 0 0 0 0 1

Total # of neighbors = 2461
Ave neighs/atom = 0.49210158
Neighbor list builds = 166
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 77

#variable lat0 equal 1                    #
variable lat1 equal 3+((300)*0.01)+(v_ind*0.01)        # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 1000*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 6.77                                                               
Lattice spacing in x,y,z = 6.77 6.77 6.77

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -10155 ${n1e1} -100 100 -100 100 units box
region box block -10155 10155 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -10155 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -10155 10155 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-10155 -100 -100) to (10155 100 100)
  2 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 3000 atoms
  using lattice units in orthogonal box = (-10155 -100 -100) to (10155 100 100)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 3000 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 2001 atoms
  using lattice units in orthogonal box = (-10155 -100 -100) to (10155 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  3000 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  3000 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  2001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  2001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
3000 atoms in group substrate
group slider1 region slider1
2001 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 2001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_77_*.dump id type diameter mass xu yu zu fx fy fz
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 13104 130 130
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 468.9 | 468.9 | 468.9 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   20310          200            200            0              0              0              0              0              0              0              1.1971759e-13  0              6            
    100000   20310          200            200            0.0019831671   3.1818616e-35  0              0.0059495013   1153860.6      0              5.57158e+10    1.1971759e-13  0              3.3323171    
    200000   20310          200            200            0.00066729436  1.055437e-40   0              0.0020018831   259222.84      0              1.2516943e+10  1.1971759e-13  0              3.0841416    
    300000   20310          200            200           -1.2744832e-05  2.5454849e-34  0             -3.8234495e-05  213.3777       0              10303246       1.1971759e-13  0              3.0431558    
    400000   20310          200            200           -2.6634542e-05  6.5167119e-40  0             -7.9903627e-05  992.06436      0              47903238       1.1971759e-13  0              3.0046312    
    500000   20310          200            200            0.004557888    0.0020433493   0              0.011630315    1873.1853      0              90449413       1.1971759e-13  0              2.9922207    
    600000   20310          200            200            0.0029763953   0.0014278777   0              0.0075013081   369.48786      0              17841246       1.1971759e-13  0              2.993758     
    700000   20310          200            200            0.0025632283   0.0012234529   0              0.0064662321   0.67004931     0              32354.283      1.1971759e-13  0              2.9942222    
    800000   20310          200            200            0.0029291924   0.0013977249   0              0.0073898523   6.6166586      0              319494.76      1.1971759e-13  0              2.9938275    
    900000   20310          200            200            0.002961161    0.0013891064   0              0.0074943766   0.070635058    0              3410.7142      1.1971759e-13  0              2.9937811    
   1000000   20310          200            200            0.0029091043   0.0013772051   0              0.0073501077   0.088320044    0              4264.6588      1.1971759e-13  0              2.9938409    
   1100000   20310          200            200            0.0029133145   0.0013776752   0              0.0073622682   0.0081200433   0              392.08783      1.1971759e-13  0              2.9938363    
   1200000   20310          200            200            0.0029193345   0.0013786016   0              0.0073794018   0.00054802243  0              26.462042      1.1971759e-13  0              2.9938291    
   1300000   20310          200            200            0.0029176557   0.0013783532   0              0.0073746138   0.00027019719  0              13.046855      1.1971759e-13  0              2.993831     
   1400000   20310          200            200            0.0029171553   0.0013782751   0              0.0073731908   1.4684573e-08  0              0.00070906548  1.1971759e-13  0              2.9938316    
   1500000   20310          200            200            0.0029174733   0.001378323    0              0.007374097    4.9894097e-06  0              0.24092074     1.1971759e-13  0              2.9938312    
   1600000   20310          200            200            0.0029174821   0.0013783247   0              0.0073741215   1.5614267e-07  0              0.0075395709   1.1971759e-13  0              2.9938312    
   1700000   20310          200            200            0.0029174377   0.001378318    0              0.0073739951   5.18556e-08    0              0.0025039214   1.1971759e-13  0              2.9938313    
   1800000   20310          200            200            0.0029174447   0.001378319    0              0.0073740151   9.0451434e-09  0              0.00043675761  1.1971759e-13  0              2.9938313    
   1900000   20310          200            200            0.0029174494   0.0013783197   0              0.0073740284   1.720595e-10   0              8.3081375e-06  1.1971759e-13  0              2.9938313    
   2000000   20310          200            200            0.0029174476   0.0013783194   0              0.0073740232   2.3136721e-10  0              1.1171895e-05  1.1971759e-13  0              2.9938313    
   2100000   20310          200            200            0.0029174473   0.0013783194   0              0.0073740224   1.0753201e-12  0              5.1923359e-08  1.1971759e-13  0              2.9938313    
   2200000   20310          200            200            0.0029174476   0.0013783194   0              0.0073740232   3.4426239e-12  0              1.6623199e-07  1.1971759e-13  0              2.9938313    
   2300000   20310          200            200            0.0029174475   0.0013783194   0              0.0073740232   2.3098008e-13  0              1.1153201e-08  1.1971759e-13  0              2.9938313    
   2400000   20310          200            200            0.0029174475   0.0013783194   0              0.0073740231   2.5821275e-14  0              1.246817e-09   1.1971759e-13  0              2.9938313    
   2500000   20310          200            200            0.0029174475   0.0013783194   0              0.0073740231   8.78331e-15    0              4.2411461e-10  1.1971759e-13  0              2.9938313    
   2600000   20310          200            200            0.0029174475   0.0013783194   0              0.0073740231   1.7817097e-17  0              8.6032385e-13  1.1971759e-13  0              2.9938313    
   2700000   20310          200            200            0.0029174475   0.0013783194   0              0.0073740231   1.5158376e-16  0              7.3194374e-12  1.1971759e-13  0              2.9938313    
   2800000   20310          200            200            0.0029174475   0.0013783194   0              0.0073740231   1.5615266e-17  0              7.5400532e-13  1.1971759e-13  0              2.9938313    
   2900000   20310          200            200            0.0029174475   0.0013783194   0              0.0073740231   1.7388794e-18  0              8.3964265e-14  1.1971759e-13  0              2.9938313    
   3000000   20310          200            200            0.0029174475   0.0013783194   0              0.0073740231   1.4073803e-17  0              6.7957357e-13  1.1971759e-13  0              2.9938313    
Loop time of 728.305 on 2 procs for 3000000 steps with 5001 atoms

Performance: 3558949.053 ns/day, 0.000 hours/ns, 4119.154 timesteps/s
99.9% CPU use with 2 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 161.54     | 162.25     | 162.95     |   5.5 | 22.28
Neigh   | 24.698     | 24.701     | 24.705     |   0.1 |  3.39
Comm    | 56.595     | 57.278     | 57.961     |   9.0 |  7.86
Output  | 0.65291    | 0.65293    | 0.65295    |   0.0 |  0.09
Modify  | 425.61     | 425.63     | 425.65     |   0.1 | 58.44
Other   |            | 57.8       |            |       |  7.94

Nlocal:         2500.5 ave        2501 max        2500 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Nghost:            2.5 ave           3 max           2 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Neighs:         1231.5 ave        1232 max        1231 min
Histogram: 1 0 0 0 0 0 0 0 0 1

Total # of neighbors = 2463
Ave neighs/atom = 0.4925015
Neighbor list builds = 166
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 78

#variable lat0 equal 1                    #
variable lat1 equal 3+((300)*0.01)+(v_ind*0.01)        # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 1000*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 6.78                                                               
Lattice spacing in x,y,z = 6.78 6.78 6.78

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -10170 ${n1e1} -100 100 -100 100 units box
region box block -10170 10170 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -10170 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -10170 10170 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-10170 -100 -100) to (10170 100 100)
  2 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 3000 atoms
  using lattice units in orthogonal box = (-10170 -100 -100) to (10170 100 100)
  create_atoms CPU = 0.002 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 3000 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 2001 atoms
  using lattice units in orthogonal box = (-10170 -100 -100) to (10170 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  3000 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  3000 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  2001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  2001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
3000 atoms in group substrate
group slider1 region slider1
2001 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 2001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_78_*.dump id type diameter mass xu yu zu fx fy fz
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 13123 130 130
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 469.6 | 469.6 | 469.6 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   20340          200            200            0              0              0              0              0              0              0              1.1971759e-13  0              6            
    100000   20340          200            200            0.0019804066  -9.9286288e-37  0              0.0059412199   1153997.5      0              5.5722408e+10  1.1971759e-13  0              3.3322883    
    200000   20340          200            200            0.00066668046  1.5885915e-35  0              0.0020000414   259446.18      0              1.2527727e+10  1.1971759e-13  0              3.0840858    
    300000   20340          200            200           -1.2078038e-05 -2.382871e-35   0             -3.6234115e-05  191.83608      0              9263077.6      1.1971759e-13  0              3.0432293    
    400000   20340          200            200           -2.4461564e-05  6.3543321e-35  0             -7.3384692e-05  834.68693      0              40304044       1.1971759e-13  0              3.0047576    
    500000   20340          200            200            0.0041051466   0.0019851159   0              0.010330324    2331.304       0              1.1257032e+08  1.1971759e-13  0              2.9927119    
    600000   20340          200            200            0.0023173265   0.00090467441  0              0.0060473051   275.89105      0              13321791       1.1971759e-13  0              2.9944001    
    700000   20340          200            200            0.0028648586   0.0010026614   0              0.0075919145   47.706274      0              2303565.3      1.1971759e-13  0              2.9937709    
    800000   20340          200            200            0.0027320706   0.0009997169   0              0.0071964948   5.2042156      0              251292.94      1.1971759e-13  0              2.9939208    
    900000   20340          200            200            0.0028182059   0.0010014999   0              0.0074531176   0.46376982     0              22393.785      1.1971759e-13  0              2.9938199    
   1000000   20340          200            200            0.0027728303   0.00099649501  0              0.0073219958   0.028155708    0              1359.5384      1.1971759e-13  0              2.9938719    
   1100000   20340          200            200            0.0027929482   0.00099878428  0              0.0073800602   0.00069668181  0              33.640271      1.1971759e-13  0              2.9938486    
   1200000   20340          200            200            0.0027849372   0.00099787752  0              0.007356934    1.6715603e-05  0              0.80713663     1.1971759e-13  0              2.9938579    
   1300000   20340          200            200            0.0027878507   0.00099821075  0              0.0073653415   4.1189503e-05  0              1.9888937      1.1971759e-13  0              2.9938545    
   1400000   20340          200            200            0.002786884    0.00099809969  0              0.0073625522   1.5621497e-05  0              0.75430617     1.1971759e-13  0              2.9938557    
   1500000   20340          200            200            0.0027871703   0.00099813289  0              0.007363378    3.6471917e-06  0              0.17610984     1.1971759e-13  0              2.9938553    
   1600000   20340          200            200            0.0027870994   0.00099812455  0              0.0073631738   6.5319821e-07  0              0.031540604    1.1971759e-13  0              2.9938554    
   1700000   20340          200            200            0.0027871106   0.00099812593  0              0.007363206    9.6190105e-08  0              0.0046446759   1.1971759e-13  0              2.9938554    
   1800000   20340          200            200            0.0027871123   0.00099812608  0              0.0073632109   1.1855166e-08  0              0.00057244354  1.1971759e-13  0              2.9938554    
   1900000   20340          200            200            0.0027871096   0.00099812579  0              0.0073632031   1.202167e-09   0              5.804834e-05   1.1971759e-13  0              2.9938554    
   2000000   20340          200            200            0.0027871113   0.00099812597  0              0.0073632079   9.3708067e-11  0              4.5248272e-06  1.1971759e-13  0              2.9938554    
   2100000   20340          200            200            0.0027871105   0.00099812588  0              0.0073632056   4.5267776e-12  0              2.1858189e-07  1.1971759e-13  0              2.9938554    
   2200000   20340          200            200            0.0027871108   0.00099812592  0              0.0073632066   3.6104907e-14  0              1.7433767e-09  1.1971759e-13  0              2.9938554    
   2300000   20340          200            200            0.0027871107   0.00099812591  0              0.0073632062   2.355422e-14   0              1.137349e-09   1.1971759e-13  0              2.9938554    
   2400000   20340          200            200            0.0027871107   0.00099812591  0              0.0073632063   1.7477148e-14  0              8.4390893e-10  1.1971759e-13  0              2.9938554    
   2500000   20340          200            200            0.0027871107   0.00099812591  0              0.0073632063   5.2123048e-15  0              2.5168354e-10  1.1971759e-13  0              2.9938554    
   2600000   20340          200            200            0.0027871107   0.00099812591  0              0.0073632063   1.0865258e-15  0              5.2464443e-11  1.1971759e-13  0              2.9938554    
   2700000   20340          200            200            0.0027871107   0.00099812591  0              0.0073632063   1.8315154e-16  0              8.8437325e-12  1.1971759e-13  0              2.9938554    
   2800000   20340          200            200            0.0027871107   0.00099812591  0              0.0073632063   9.6493749e-18  0              4.6593378e-13  1.1971759e-13  0              2.9938554    
   2900000   20340          200            200            0.0027871107   0.00099812591  0              0.0073632063   6.416226e-18   0              3.0981659e-13  1.1971759e-13  0              2.9938554    
   3000000   20340          200            200            0.0027871107   0.00099812591  0              0.0073632063   1.2867645e-17  0              6.2133251e-13  1.1971759e-13  0              2.9938554    
Loop time of 728.838 on 2 procs for 3000000 steps with 5001 atoms

Performance: 3556343.777 ns/day, 0.000 hours/ns, 4116.139 timesteps/s
99.9% CPU use with 2 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 160.62     | 162.83     | 165.04     |  17.3 | 22.34
Neigh   | 24.672     | 24.675     | 24.679     |   0.1 |  3.39
Comm    | 55.396     | 57.656     | 59.916     |  29.8 |  7.91
Output  | 0.63976    | 0.63976    | 0.63976    |   0.0 |  0.09
Modify  | 426.24     | 426.28     | 426.32     |   0.2 | 58.49
Other   |            | 56.75      |            |       |  7.79

Nlocal:         2500.5 ave        2501 max        2500 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Nghost:            2.5 ave           3 max           2 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Neighs:         1238.5 ave        1239 max        1238 min
Histogram: 1 0 0 0 0 0 0 0 0 1

Total # of neighbors = 2477
Ave neighs/atom = 0.49530094
Neighbor list builds = 166
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 79

#variable lat0 equal 1                    #
variable lat1 equal 3+((300)*0.01)+(v_ind*0.01)        # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 1000*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 6.79                                                               
Lattice spacing in x,y,z = 6.79 6.79 6.79

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -10185 ${n1e1} -100 100 -100 100 units box
region box block -10185 10185 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -10185 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -10185 10185 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-10185 -100 -100) to (10185 100 100)
  2 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 3000 atoms
  using lattice units in orthogonal box = (-10185 -100 -100) to (10185 100 100)
  create_atoms CPU = 0.002 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 3000 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 2001 atoms
  using lattice units in orthogonal box = (-10185 -100 -100) to (10185 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  3000 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  3000 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  2001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  2001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
3000 atoms in group substrate
group slider1 region slider1
2001 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 2001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_79_*.dump id type diameter mass xu yu zu fx fy fz
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 13142 130 130
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 470.2 | 470.2 | 470.2 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   20370          200            200            0              0              0              0              0              0              0              1.1971759e-13  0              6            
    100000   20370          200            200            0.0019773796   1.5862432e-35  0              0.0059321387   1153893        0              5.5717364e+10  1.1971759e-13  0              3.3323587    
    200000   20370          200            200            0.0006653014   9.9140135e-37  0              0.0019959042   259197.91      0              1.251574e+10   1.1971759e-13  0              3.0842419    
    300000   20370          200            200           -1.2686718e-05  3.1724973e-35  0             -3.8060154e-05  212.66279      0              10268725       1.1971759e-13  0              3.0432401    
    400000   20370          200            200           -2.4853401e-05  7.0157893e-40  0             -7.4560203e-05  865.11499      0              41773307       1.1971759e-13  0              3.0047677    
    500000   20370          200            200           -0.0004385919  -0.010712399    0              0.0093966229   2550.7799      0              1.2316803e+08  1.1971759e-13  0              2.9930505    
    600000   20370          200            200            0.00013291734 -0.0053951583   0              0.0057939103   228.31091      0              11024317       1.1971759e-13  0              2.9945598    
    700000   20370          200            200            0.00045307966 -0.005560508    0              0.006919747    38.409853      0              1854674.4      1.1971759e-13  0              2.9940823    
    800000   20370          200            200            0.00070063649 -0.0055933693   0              0.0076952788   0.11103807     0              5361.6311      1.1971759e-13  0              2.9937521    
    900000   20370          200            200            0.00057359944 -0.0055412488   0              0.0072620471   0.44004014     0              21247.963      1.1971759e-13  0              2.9939296    
   1000000   20370          200            200            0.00059725429 -0.0055567776   0              0.0073485405   0.11919527     0              5755.5128      1.1971759e-13  0              2.9938947    
   1100000   20370          200            200            0.00060231311 -0.0055594367   0              0.007366376    0.0050972085   0              246.12595      1.1971759e-13  0              2.9938869    
   1200000   20370          200            200            0.0005970917  -0.0055552039   0              0.007346479    0.00017213716  0              8.3118873      1.1971759e-13  0              2.9938952    
   1300000   20370          200            200            0.0005989106  -0.0055566391   0              0.0073533709   0.00024733899  0              11.943115      1.1971759e-13  0              2.9938924    
   1400000   20370          200            200            0.00059876423 -0.0055565368   0              0.0073528295   3.1100114e-05  0              1.5017132      1.1971759e-13  0              2.9938926    
   1500000   20370          200            200            0.00059858792 -0.0055563913   0              0.0073521551   2.3799539e-07  0              0.011491946    1.1971759e-13  0              2.9938929    
   1600000   20370          200            200            0.00059868993 -0.005556473    0              0.0073525428   2.7296103e-07  0              0.013180311    1.1971759e-13  0              2.9938927    
   1700000   20370          200            200            0.00059866602 -0.0055564544   0              0.0073524525   9.5813743e-08  0              0.0046265027   1.1971759e-13  0              2.9938927    
   1800000   20370          200            200            0.00059866346 -0.0055564521   0              0.0073524425   5.5092914e-09  0              0.00026602396  1.1971759e-13  0              2.9938927    
   1900000   20370          200            200            0.00059866787 -0.0055564557   0              0.0073524593   4.8853294e-11  0              2.3589507e-06  1.1971759e-13  0              2.9938927    
   2000000   20370          200            200            0.00059866616 -0.0055564543   0              0.0073524528   1.755296e-10   0              8.4756959e-06  1.1971759e-13  0              2.9938927    
   2100000   20370          200            200            0.00059866636 -0.0055564545   0              0.0073524536   2.7511315e-11  0              1.3284229e-06  1.1971759e-13  0              2.9938927    
   2200000   20370          200            200            0.0005986665  -0.0055564546   0              0.0073524541   4.4342146e-13  0              2.1411235e-08  1.1971759e-13  0              2.9938927    
   2300000   20370          200            200            0.00059866641 -0.0055564545   0              0.0073524537   1.5565445e-13  0              7.5159961e-09  1.1971759e-13  0              2.9938927    
   2400000   20370          200            200            0.00059866643 -0.0055564545   0              0.0073524538   7.5071727e-14  0              3.624945e-09   1.1971759e-13  0              2.9938927    
   2500000   20370          200            200            0.00059866643 -0.0055564545   0              0.0073524538   5.378918e-15   0              2.597287e-10   1.1971759e-13  0              2.9938927    
   2600000   20370          200            200            0.00059866643 -0.0055564545   0              0.0073524538   4.0225876e-18  0              1.9423636e-13  1.1971759e-13  0              2.9938927    
   2700000   20370          200            200            0.00059866643 -0.0055564545   0              0.0073524538   6.8991313e-17  0              3.3313436e-12  1.1971759e-13  0              2.9938927    
   2800000   20370          200            200            0.00059866643 -0.0055564545   0              0.0073524538   2.0742867e-17  0              1.0015988e-12  1.1971759e-13  0              2.9938927    
   2900000   20370          200            200            0.00059866643 -0.0055564545   0              0.0073524538   1.2067427e-19  0              5.8269287e-15  1.1971759e-13  0              2.9938927    
   3000000   20370          200            200            0.00059866643 -0.0055564545   0              0.0073524538   3.0755816e-18  0              1.4850883e-13  1.1971759e-13  0              2.9938927    
Loop time of 728.262 on 2 procs for 3000000 steps with 5001 atoms

Performance: 3559159.355 ns/day, 0.000 hours/ns, 4119.397 timesteps/s
99.9% CPU use with 2 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 163.14     | 164.31     | 165.49     |   9.1 | 22.56
Neigh   | 24.529     | 24.533     | 24.536     |   0.1 |  3.37
Comm    | 55.091     | 56.254     | 57.416     |  15.5 |  7.72
Output  | 0.64371    | 0.64374    | 0.64376    |   0.0 |  0.09
Modify  | 424.54     | 424.59     | 424.64     |   0.2 | 58.30
Other   |            | 57.93      |            |       |  7.95

Nlocal:         2500.5 ave        2501 max        2500 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Nghost:            2.5 ave           3 max           2 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Neighs:         1231.5 ave        1232 max        1231 min
Histogram: 1 0 0 0 0 0 0 0 0 1

Total # of neighbors = 2463
Ave neighs/atom = 0.4925015
Neighbor list builds = 166
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 80

#variable lat0 equal 1                    #
variable lat1 equal 3+((300)*0.01)+(v_ind*0.01)        # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 1000*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 6.8                                                               
Lattice spacing in x,y,z = 6.8 6.8 6.8

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -10200 ${n1e1} -100 100 -100 100 units box
region box block -10200 10200 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -10200 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -10200 10200 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-10200 -100 -100) to (10200 100 100)
  2 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 3000 atoms
  using lattice units in orthogonal box = (-10200 -100 -100) to (10200 100 100)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 3000 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 2001 atoms
  using lattice units in orthogonal box = (-10200 -100 -100) to (10200 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  3000 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  3000 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  2001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  2001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
3000 atoms in group substrate
group slider1 region slider1
2001 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 2001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_80_*.dump id type diameter mass xu yu zu fx fy fz
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 13162 130 130
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 470.9 | 470.9 | 470.9 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   20400          200            200            0              0              0              0              0              0              0              1.1971759e-13  0              6            
    100000   20400          200            200            0.0019744724   4.7517356e-35  0              0.0059234173   1153881.4      0              5.5716804e+10  1.1971759e-13  0              3.3324085    
    200000   20400          200            200            0.00066350042  9.5034895e-35  0              0.0019905013   258681.22      0              1.249079e+10   1.1971759e-13  0              3.0845891    
    300000   20400          200            200           -1.0605061e-05  7.9195534e-36  0             -3.1815183e-05  148.12441      0              7152397.9      1.1971759e-13  0              3.0433376    
    400000   20400          200            200           -9.7767415e-06  2.1806564e-41  0             -2.9330225e-05  128.86484      0              6222422        1.1971759e-13  0              3.005079     
    500000   20400          200            200            0.0033072717   0.00031567889  0              0.0096061363   2330.8655      0              1.1254915e+08  1.1971759e-13  0              2.9925305    
    600000   20400          200            200            0.0022634216  -4.7517232e-35  0              0.0067902648   308.66663      0              14904407       1.1971759e-13  0              2.9937757    
    700000   20400          200            200            0.0025482301   1.4291702e-05  0              0.0076303986   37.199179      0              1796215.2      1.1971759e-13  0              2.9932435    
    800000   20400          200            200            0.0025023094   9.4270025e-07  0              0.0075059854   3.477729       0              167927.09      1.1971759e-13  0              2.9933125    
    900000   20400          200            200            0.002454128   -3.1678155e-35  0              0.007362384    0.73576858     0              35527.631      1.1971759e-13  0              2.9934016    
   1000000   20400          200            200            0.0024370195   4.751729e-35   0              0.0073110584   0.034292337    0              1655.8542      1.1971759e-13  0              2.9934307    
   1100000   20400          200            200            0.0024511421  -7.9195238e-36  0              0.0073534263   0.00023243563  0              11.223485      1.1971759e-13  0              2.9934056    
   1200000   20400          200            200            0.0024458043   1.5839111e-35  0              0.007337413    0.0011037359   0              53.295455      1.1971759e-13  0              2.9934152    
   1300000   20400          200            200            0.0024467908   7.9195662e-36  0              0.0073403725   0.00025397812  0              12.263694      1.1971759e-13  0              2.9934134    
   1400000   20400          200            200            0.0024469759  -5.9396366e-36  0              0.0073409278   1.7240816e-05  0              0.83249731     1.1971759e-13  0              2.9934131    
   1500000   20400          200            200            0.0024467427  -1.9798641e-36  0              0.0073402282   1.0121797e-08  0              0.00048874538  1.1971759e-13  0              2.9934135    
   1600000   20400          200            200            0.0024468441  -9.8992093e-37  0              0.0073405322   2.5514629e-07  0              0.012320101    1.1971759e-13  0              2.9934133    
   1700000   20400          200            200            0.0024468206   2.2160782e-41  0              0.0073404619   8.2418361e-08  0              0.0039796877   1.1971759e-13  0              2.9934134    
   1800000   20400          200            200            0.0024468197   5.9396807e-36  0              0.007340459    7.6357863e-09  0              0.00036870479  1.1971759e-13  0              2.9934134    
   1900000   20400          200            200            0.0024468233   1.9799084e-36  0              0.00734047     7.4429479e-11  0              3.5939332e-06  1.1971759e-13  0              2.9934133    
   2000000   20400          200            200            0.0024468215   2.3758656e-35  0              0.0073404645   5.0487602e-11  0              2.4378656e-06  1.1971759e-13  0              2.9934133    
   2100000   20400          200            200            0.002446822    1.1879339e-35  0              0.007340466    2.5102597e-11  0              1.2121146e-06  1.1971759e-13  0              2.9934133    
   2200000   20400          200            200            0.002446822    1.5839112e-35  0              0.0073404659   3.0806548e-12  0              1.487538e-07   1.1971759e-13  0              2.9934133    
   2300000   20400          200            200            0.0024468219   5.5436836e-35  0              0.0073404657   7.5806103e-14  0              3.6604054e-09  1.1971759e-13  0              2.9934133    
   2400000   20400          200            200            0.0024468219   3.9597746e-35  0              0.0073404658   7.6819708e-15  0              3.7093488e-10  1.1971759e-13  0              2.9934133    
   2500000   20400          200            200            0.0024468219   3.9597746e-35  0              0.0073404658   7.1572733e-15  0              3.4559912e-10  1.1971759e-13  0              2.9934133    
   2600000   20400          200            200            0.0024468219   5.5436836e-35  0              0.0073404658   1.1567013e-15  0              5.5852964e-11  1.1971759e-13  0              2.9934133    
   2700000   20400          200            200            0.0024468219   7.9195669e-36  0              0.0073404658   7.0076432e-18  0              3.3837401e-13  1.1971759e-13  0              2.9934133    
   2800000   20400          200            200            0.0024468219   2.2253741e-41  0              0.0073404658   2.2433561e-18  0              1.0832364e-13  1.1971759e-13  0              2.9934133    
   2900000   20400          200            200            0.0024468219  -7.9195225e-36  0              0.0073404658   4.2219805e-18  0              2.0386433e-13  1.1971759e-13  0              2.9934133    
   3000000   20400          200            200            0.0024468219   1.5839112e-35  0              0.0073404658   1.3946662e-17  0              6.7343438e-13  1.1971759e-13  0              2.9934133    
Loop time of 717.696 on 2 procs for 3000000 steps with 5001 atoms

Performance: 3611556.826 ns/day, 0.000 hours/ns, 4180.043 timesteps/s
99.9% CPU use with 2 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 150.5      | 152.74     | 154.99     |  18.2 | 21.28
Neigh   | 24.614     | 24.618     | 24.621     |   0.1 |  3.43
Comm    | 54.289     | 56.535     | 58.781     |  29.9 |  7.88
Output  | 0.64225    | 0.64226    | 0.64227    |   0.0 |  0.09
Modify  | 425.65     | 425.77     | 425.89     |   0.6 | 59.32
Other   |            | 57.39      |            |       |  8.00

Nlocal:         2500.5 ave        2501 max        2500 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Nghost:            2.5 ave           3 max           2 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Neighs:         1205.5 ave        1206 max        1205 min
Histogram: 1 0 0 0 0 0 0 0 0 1

Total # of neighbors = 2411
Ave neighs/atom = 0.48210358
Neighbor list builds = 166
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 81

#variable lat0 equal 1                    #
variable lat1 equal 3+((300)*0.01)+(v_ind*0.01)        # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 1000*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 6.81                                                               
Lattice spacing in x,y,z = 6.81 6.81 6.81

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -10215 ${n1e1} -100 100 -100 100 units box
region box block -10215 10215 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -10215 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -10215 10215 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-10215 -100 -100) to (10215 100 100)
  2 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 3000 atoms
  using lattice units in orthogonal box = (-10215 -100 -100) to (10215 100 100)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 3000 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 2001 atoms
  using lattice units in orthogonal box = (-10215 -100 -100) to (10215 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  3000 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  3000 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  2001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  2001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
3000 atoms in group substrate
group slider1 region slider1
2001 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 2001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_81_*.dump id type diameter mass xu yu zu fx fy fz
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 13181 130 130
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 471.6 | 471.6 | 471.6 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   20430          200            200            0              0              0              0              0              0              0              1.1971759e-13  0              6            
    100000   20430          200            200            0.0019713189   3.1631866e-35  0              0.0059139567   1153655.4      0              5.570589e+10   1.1971759e-13  0              3.3325092    
    200000   20430          200            200            0.00066278617  8.2776714e-41  0              0.0019883585   258847.89      0              1.2498838e+10  1.1971759e-13  0              3.0844432    
    300000   20430          200            200           -1.3243985e-05  1.4716864e-41  0             -3.9731956e-05  233.51413      0              11275562       1.1971759e-13  0              3.0432344    
    400000   20430          200            200           -2.6500595e-05  6.3263521e-35  0             -7.9501784e-05  993.74613      0              47984444       1.1971759e-13  0              3.0047182    
    500000   20430          200            200            0.0037786911   0.00118459     0              0.010151483    2357.7095      0              1.1384535e+08  1.1971759e-13  0              2.992795     
    600000   20430          200            200            0.0024330331   0.0011503164   0              0.0061487828   293.4961       0              14171876       1.1971759e-13  0              2.9944083    
    700000   20430          200            200            0.0026985684   0.001151441    0              0.0069442642   40.970498      0              1978318.7      1.1971759e-13  0              2.9940875    
    800000   20430          200            200            0.0028969688   0.0010806886   0              0.0076102178   2.2752544      0              109863.89      1.1971759e-13  0              2.9938031    
    900000   20430          200            200            0.0027647623   0.0010880639   0              0.007206223    0.014005993    0              676.29929      1.1971759e-13  0              2.9939706    
   1000000   20430          200            200            0.0028222562   0.001092383    0              0.0073743857   0.015230733    0              735.43757      1.1971759e-13  0              2.9939011    
   1100000   20430          200            200            0.0028035048   0.0010909091   0              0.0073196052   0.0091669589   0              442.63964      1.1971759e-13  0              2.9939234    
   1200000   20430          200            200            0.0028078858   0.0010912408   0              0.0073324168   0.0020676376   0              99.838819      1.1971759e-13  0              2.9939183    
   1300000   20430          200            200            0.0028075666   0.0010912201   0              0.0073314797   0.00027497462  0              13.27754       1.1971759e-13  0              2.9939186    
   1400000   20430          200            200            0.0028071842   0.0010911887   0              0.0073303641   2.1425607e-05  0              1.0345659      1.1971759e-13  0              2.9939191    
   1500000   20430          200            200            0.002807475    0.0010912118   0              0.0073312132   5.9123235e-07  0              0.028548494    1.1971759e-13  0              2.9939187    
   1600000   20430          200            200            0.002807338    0.001091201    0              0.007330813    1.5476759e-08  0              0.00074731731  1.1971759e-13  0              2.9939189    
   1700000   20430          200            200            0.0028073877   0.0010912049   0              0.0073309581   3.3874919e-08  0              0.0016356986   1.1971759e-13  0              2.9939188    
   1800000   20430          200            200            0.0028073739   0.0010912038   0              0.0073309179   1.0512756e-08  0              0.00050762336  1.1971759e-13  0              2.9939188    
   1900000   20430          200            200            0.0028073762   0.001091204    0              0.0073309245   1.7375463e-09  0              8.3899892e-05  1.1971759e-13  0              2.9939188    
   2000000   20430          200            200            0.0028073766   0.001091204    0              0.0073309256   1.747284e-10   0              8.4370091e-06  1.1971759e-13  0              2.9939188    
   2100000   20430          200            200            0.002807376    0.001091204    0              0.007330924    8.7542881e-12  0              4.2271324e-07  1.1971759e-13  0              2.9939188    
   2200000   20430          200            200            0.0028073763   0.001091204    0              0.0073309249   1.9505427e-14  0              9.4184729e-10  1.1971759e-13  0              2.9939188    
   2300000   20430          200            200            0.0028073762   0.001091204    0              0.0073309245   9.5043721e-14  0              4.5893212e-09  1.1971759e-13  0              2.9939188    
   2400000   20430          200            200            0.0028073762   0.001091204    0              0.0073309247   4.7470344e-14  0              2.292173e-09   1.1971759e-13  0              2.9939188    
   2500000   20430          200            200            0.0028073762   0.001091204    0              0.0073309246   9.9751691e-15  0              4.8166522e-10  1.1971759e-13  0              2.9939188    
   2600000   20430          200            200            0.0028073762   0.001091204    0              0.0073309246   1.2453431e-15  0              6.0133162e-11  1.1971759e-13  0              2.9939188    
   2700000   20430          200            200            0.0028073762   0.001091204    0              0.0073309246   1.3192229e-16  0              6.3700552e-12  1.1971759e-13  0              2.9939188    
   2800000   20430          200            200            0.0028073762   0.001091204    0              0.0073309246   1.0791192e-17  0              5.2106806e-13  1.1971759e-13  0              2.9939188    
   2900000   20430          200            200            0.0028073762   0.001091204    0              0.0073309246   1.7053957e-19  0              8.2347456e-15  1.1971759e-13  0              2.9939188    
   3000000   20430          200            200            0.0028073762   0.001091204    0              0.0073309246   6.6008279e-19  0              3.1873035e-14  1.1971759e-13  0              2.9939188    
Loop time of 733.175 on 2 procs for 3000000 steps with 5001 atoms

Performance: 3535311.025 ns/day, 0.000 hours/ns, 4091.795 timesteps/s
99.9% CPU use with 2 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 164.38     | 165.42     | 166.46     |   8.1 | 22.56
Neigh   | 24.785     | 24.789     | 24.792     |   0.1 |  3.38
Comm    | 56.381     | 57.537     | 58.693     |  15.2 |  7.85
Output  | 0.65568    | 0.65571    | 0.65573    |   0.0 |  0.09
Modify  | 426.75     | 426.76     | 426.77     |   0.0 | 58.21
Other   |            | 58.02      |            |       |  7.91

Nlocal:         2500.5 ave        2501 max        2500 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Nghost:            2.5 ave           3 max           2 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Neighs:         1233.5 ave        1234 max        1233 min
Histogram: 1 0 0 0 0 0 0 0 0 1

Total # of neighbors = 2467
Ave neighs/atom = 0.49330134
Neighbor list builds = 166
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 82

#variable lat0 equal 1                    #
variable lat1 equal 3+((300)*0.01)+(v_ind*0.01)        # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 1000*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 6.82                                                               
Lattice spacing in x,y,z = 6.82 6.82 6.82

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -10230 ${n1e1} -100 100 -100 100 units box
region box block -10230 10230 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -10230 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -10230 10230 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-10230 -100 -100) to (10230 100 100)
  2 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 3000 atoms
  using lattice units in orthogonal box = (-10230 -100 -100) to (10230 100 100)
  create_atoms CPU = 0.002 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 3000 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 2001 atoms
  using lattice units in orthogonal box = (-10230 -100 -100) to (10230 100 100)
  create_atoms CPU = 0.002 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  3000 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  3000 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  2001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  2001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
3000 atoms in group substrate
group slider1 region slider1
2001 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 2001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_82_*.dump id type diameter mass xu yu zu fx fy fz
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 13200 130 130
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 472.3 | 472.3 | 472.3 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   20460          200            200            0              0              0              0              0              0              0              1.1971759e-13  0              6            
    100000   20460          200            200            0.0019686111  -7.8963162e-36  0              0.0059058334   1153818.5      0              5.5713767e+10  1.1971759e-13  0              3.3324351    
    200000   20460          200            200            0.00066211744 -3.9481555e-36  0              0.0019863523   259033.12      0              1.2507782e+10  1.1971759e-13  0              3.0843808    
    300000   20460          200            200           -1.26548e-05    1.2634139e-34  0             -3.7964399e-05  213.47607      0              10307996       1.1971759e-13  0              3.0432841    
    400000   20460          200            200           -2.2585538e-05  3.1585344e-35  0             -6.7756613e-05  716.75964      0              34609758       1.1971759e-13  0              3.0048743    
    500000   20460          200            200            0.00052019104 -0.0061175053   0              0.0076780784   2776.6881      0              1.3407633e+08  1.1971759e-13  0              2.9937176    
    600000   20460          200            200           -3.1009828e-05 -0.0052015371   0              0.0051085076   64.851396      0              3131441.8      1.1971759e-13  0              2.9949056    
    700000   20460          200            200            0.00083148873 -0.0051174676   0              0.0076119338   45.366156      0              2190569.3      1.1971759e-13  0              2.9938045    
    800000   20460          200            200            0.00077535871 -0.0050725504   0              0.0073986265   6.2973045      0              304074.3       1.1971759e-13  0              2.9938819    
    900000   20460          200            200            0.00071664616 -0.005082265    0              0.0072322034   0.44885529     0              21673.616      1.1971759e-13  0              2.9939541    
   1000000   20460          200            200            0.00075988955 -0.0050851179   0              0.0073647866   0.0077025536   0              371.92875      1.1971759e-13  0              2.9938984    
   1100000   20460          200            200            0.00074001448 -0.0050837911   0              0.0073038346   0.0012102133   0              58.436868      1.1971759e-13  0              2.9939236    
   1200000   20460          200            200            0.00074675786 -0.0050842313   0              0.0073245048   0.0011422709   0              55.156175      1.1971759e-13  0              2.9939152    
   1300000   20460          200            200            0.00074516669 -0.0050841287   0              0.0073196288   0.0002783336   0              13.439733      1.1971759e-13  0              2.9939171    
   1400000   20460          200            200            0.00074526541 -0.005084134    0              0.0073199303   3.6016223e-05  0              1.7390945      1.1971759e-13  0              2.993917     
   1500000   20460          200            200            0.00074541707 -0.0050841444   0              0.0073203957   2.4020329e-06  0              0.11598557     1.1971759e-13  0              2.9939168    
   1600000   20460          200            200            0.00074530792 -0.0050841371   0              0.0073200609   2.976058e-08   0              0.0014370319   1.1971759e-13  0              2.993917     
   1700000   20460          200            200            0.00074535652 -0.0050841404   0              0.0073202099   9.8849855e-09  0              0.00047731058  1.1971759e-13  0              2.9939169    
   1800000   20460          200            200            0.00074534048 -0.0050841393   0              0.0073201607   7.4067073e-09  0              0.00035764339  1.1971759e-13  0              2.9939169    
   1900000   20460          200            200            0.00074534408 -0.0050841395   0              0.0073201718   1.6838884e-09  0              8.1308945e-05  1.1971759e-13  0              2.9939169    
   2000000   20460          200            200            0.00074534396 -0.0050841395   0              0.0073201714   2.0637375e-10  0              9.9650497e-06  1.1971759e-13  0              2.9939169    
   2100000   20460          200            200            0.00074534356 -0.0050841395   0              0.0073201702   1.268568e-11   0              6.1254611e-07  1.1971759e-13  0              2.9939169    
   2200000   20460          200            200            0.00074534383 -0.0050841395   0              0.007320171    1.020516e-13   0              4.9277065e-09  1.1971759e-13  0              2.9939169    
   2300000   20460          200            200            0.00074534371 -0.0050841395   0              0.0073201706   7.7119904e-14  0              3.7238442e-09  1.1971759e-13  0              2.9939169    
   2400000   20460          200            200            0.00074534375 -0.0050841395   0              0.0073201708   4.7374404e-14  0              2.2875404e-09  1.1971759e-13  0              2.9939169    
   2500000   20460          200            200            0.00074534374 -0.0050841395   0              0.0073201707   1.0115971e-14  0              4.8846405e-10  1.1971759e-13  0              2.9939169    
   2600000   20460          200            200            0.00074534374 -0.0050841395   0              0.0073201707   1.1660704e-15  0              5.6305367e-11  1.1971759e-13  0              2.9939169    
   2700000   20460          200            200            0.00074534374 -0.0050841395   0              0.0073201707   1.100196e-16   0              5.3124529e-12  1.1971759e-13  0              2.9939169    
   2800000   20460          200            200            0.00074534374 -0.0050841395   0              0.0073201707   7.8243129e-18  0              3.7780807e-13  1.1971759e-13  0              2.9939169    
   2900000   20460          200            200            0.00074534374 -0.0050841395   0              0.0073201707   2.8716901e-18  0              1.3866364e-13  1.1971759e-13  0              2.9939169    
   3000000   20460          200            200            0.00074534374 -0.0050841395   0              0.0073201707   1.4619095e-17  0              7.0590377e-13  1.1971759e-13  0              2.9939169    
Loop time of 730.431 on 2 procs for 3000000 steps with 5001 atoms

Performance: 3548590.552 ns/day, 0.000 hours/ns, 4107.165 timesteps/s
100.0% CPU use with 2 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 162.42     | 163.81     | 165.21     |  10.9 | 22.43
Neigh   | 24.87      | 24.874     | 24.877     |   0.1 |  3.41
Comm    | 55.882     | 57.292     | 58.703     |  18.6 |  7.84
Output  | 0.64132    | 0.64134    | 0.64137    |   0.0 |  0.09
Modify  | 425.83     | 425.88     | 425.93     |   0.2 | 58.31
Other   |            | 57.93      |            |       |  7.93

Nlocal:         2500.5 ave        2501 max        2500 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Nghost:            2.5 ave           3 max           2 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Neighs:         1232.5 ave        1233 max        1232 min
Histogram: 1 0 0 0 0 0 0 0 0 1

Total # of neighbors = 2465
Ave neighs/atom = 0.49290142
Neighbor list builds = 166
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 83

#variable lat0 equal 1                    #
variable lat1 equal 3+((300)*0.01)+(v_ind*0.01)        # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 1000*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 6.83                                                               
Lattice spacing in x,y,z = 6.83 6.83 6.83

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -10245 ${n1e1} -100 100 -100 100 units box
region box block -10245 10245 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -10245 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -10245 10245 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-10245 -100 -100) to (10245 100 100)
  2 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 3000 atoms
  using lattice units in orthogonal box = (-10245 -100 -100) to (10245 100 100)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 3000 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 2001 atoms
  using lattice units in orthogonal box = (-10245 -100 -100) to (10245 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  3000 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  3000 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  2001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  2001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
3000 atoms in group substrate
group slider1 region slider1
2001 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 2001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_83_*.dump id type diameter mass xu yu zu fx fy fz
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 13220 130 130
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 472.9 | 472.9 | 472.9 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   20490          200            200            0              0              0              0              0              0              0              1.1971759e-13  0              6            
    100000   20490          200            200            0.0019655263  -3.1539018e-35  0              0.0058965789   1153650.9      0              5.5705675e+10  1.1971759e-13  0              3.3324624    
    200000   20490          200            200            0.00066091702 -1.9711896e-36  0              0.0019827511   258898.96      0              1.2501304e+10  1.1971759e-13  0              3.0843452    
    300000   20490          200            200           -1.3015007e-05  6.3078091e-35  0             -3.9045021e-05  226.72491      0              10947734       1.1971759e-13  0              3.0431695    
    400000   20490          200            200           -2.6504854e-05 -6.3077902e-35  0             -7.9514563e-05  1000.1701      0              48294635       1.1971759e-13  0              3.0046486    
    500000   20490          200            200            0.0030109409  -0.0019249719   0              0.010957795    2085.0918      0              1.0068162e+08  1.1971759e-13  0              2.9924374    
    600000   20490          200            200            0.0020385496  -0.00092372059  0              0.0070393693   367.43225      0              17741988       1.1971759e-13  0              2.9939511    
    700000   20490          200            200            0.0018058757  -0.00098917464  0              0.0064068017   0.29398621     0              14195.542      1.1971759e-13  0              2.9942508    
    800000   20490          200            200            0.0020338523  -0.0012977701   0              0.0073993269   6.202052       0              299474.9       1.1971759e-13  0              2.9938225    
    900000   20490          200            200            0.0020329629  -0.0013175061   0              0.0074163946   0.22734614     0              10977.732      1.1971759e-13  0              2.9938121    
   1000000   20490          200            200            0.001989089   -0.0013088606   0              0.0072761275   0.057555553    0              2779.1517      1.1971759e-13  0              2.9938712    
   1100000   20490          200            200            0.0019971013  -0.0013103054   0              0.0073016092   0.012578771    0              607.38383      1.1971759e-13  0              2.9938608    
   1200000   20490          200            200            0.0020013995  -0.0013111283   0              0.0073153268   9.2901805e-05  0              4.4858957      1.1971759e-13  0              2.9938549    
   1300000   20490          200            200            0.0019994525  -0.0013107692   0              0.0073091267   0.0002903239   0              14.018702      1.1971759e-13  0              2.9938575    
   1400000   20490          200            200            0.0019992678  -0.0013107314   0              0.0073085349   4.6119846e-06  0              0.22269623     1.1971759e-13  0              2.9938578    
   1500000   20490          200            200            0.001999567   -0.0013107875   0              0.0073094885   3.4529174e-06  0              0.16672902     1.1971759e-13  0              2.9938574    
   1600000   20490          200            200            0.0019995314  -0.0013107813   0              0.0073093754   4.4158643e-07  0              0.021322628    1.1971759e-13  0              2.9938574    
   1700000   20490          200            200            0.0019994983  -0.001310775    0              0.00730927     1.3379061e-08  0              0.00064602699  1.1971759e-13  0              2.9938575    
   1800000   20490          200            200            0.0019995098  -0.0013107771   0              0.0073093065   1.2719138e-08  0              0.00061416166  1.1971759e-13  0              2.9938575    
   1900000   20490          200            200            0.0019995119  -0.0013107775   0              0.0073093133   5.2344067e-11  0              2.5275076e-06  1.1971759e-13  0              2.9938575    
   2000000   20490          200            200            0.00199951    -0.0013107771   0              0.007309307    1.8794773e-10  0              9.0753231e-06  1.1971759e-13  0              2.9938575    
   2100000   20490          200            200            0.0019995101  -0.0013107772   0              0.0073093074   1.4020337e-11  0              6.7699191e-07  1.1971759e-13  0              2.9938575    
   2200000   20490          200            200            0.0019995103  -0.0013107772   0              0.0073093082   1.1827772e-12  0              5.7112078e-08  1.1971759e-13  0              2.9938575    
   2300000   20490          200            200            0.0019995103  -0.0013107772   0              0.007309308    5.2372952e-13  0              2.5289024e-08  1.1971759e-13  0              2.9938575    
   2400000   20490          200            200            0.0019995102  -0.0013107772   0              0.0073093079   5.884266e-21   0              2.8413015e-16  1.1971759e-13  0              2.9938575    
   2500000   20490          200            200            0.0019995102  -0.0013107772   0              0.0073093079   9.3601657e-15  0              4.519689e-10   1.1971759e-13  0              2.9938575    
   2600000   20490          200            200            0.0019995102  -0.0013107772   0              0.0073093079   3.9916389e-16  0              1.9274196e-11  1.1971759e-13  0              2.9938575    
   2700000   20490          200            200            0.0019995102  -0.0013107772   0              0.0073093079   4.2441588e-17  0              2.0493524e-12  1.1971759e-13  0              2.9938575    
   2800000   20490          200            200            0.0019995102  -0.0013107772   0              0.0073093079   2.506615e-17   0              1.2103547e-12  1.1971759e-13  0              2.9938575    
   2900000   20490          200            200            0.0019995102  -0.0013107772   0              0.0073093079   1.6850029e-18  0              8.136276e-14   1.1971759e-13  0              2.9938575    
   3000000   20490          200            200            0.0019995102  -0.0013107772   0              0.0073093079   3.6699491e-20  0              1.7720871e-15  1.1971759e-13  0              2.9938575    
Loop time of 729.281 on 2 procs for 3000000 steps with 5001 atoms

Performance: 3554185.714 ns/day, 0.000 hours/ns, 4113.641 timesteps/s
100.0% CPU use with 2 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 161.1      | 163.2      | 165.29     |  16.4 | 22.38
Neigh   | 24.89      | 24.892     | 24.894     |   0.0 |  3.41
Comm    | 55.367     | 57.647     | 59.928     |  30.0 |  7.90
Output  | 0.64716    | 0.64717    | 0.64719    |   0.0 |  0.09
Modify  | 425.55     | 425.71     | 425.87     |   0.8 | 58.37
Other   |            | 57.19      |            |       |  7.84

Nlocal:         2500.5 ave        2501 max        2500 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Nghost:            2.5 ave           3 max           2 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Neighs:         1230.5 ave        1231 max        1230 min
Histogram: 1 0 0 0 0 0 0 0 0 1

Total # of neighbors = 2461
Ave neighs/atom = 0.49210158
Neighbor list builds = 166
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 84

#variable lat0 equal 1                    #
variable lat1 equal 3+((300)*0.01)+(v_ind*0.01)        # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 1000*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 6.84                                                               
Lattice spacing in x,y,z = 6.84 6.84 6.84

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -10260 ${n1e1} -100 100 -100 100 units box
region box block -10260 10260 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -10260 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -10260 10260 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-10260 -100 -100) to (10260 100 100)
  2 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 3000 atoms
  using lattice units in orthogonal box = (-10260 -100 -100) to (10260 100 100)
  create_atoms CPU = 0.002 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 3000 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 2001 atoms
  using lattice units in orthogonal box = (-10260 -100 -100) to (10260 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  3000 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  3000 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  2001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  2001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
3000 atoms in group substrate
group slider1 region slider1
2001 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 2001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_84_*.dump id type diameter mass xu yu zu fx fy fz
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 13239 130 130
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 473.6 | 473.6 | 473.6 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   20520          200            200            0              0              0              0              0              0              0              1.1971759e-13  0              6            
    100000   20520          200            200            0.0019625952   9.8415405e-37  0              0.0058877855   1153600        0              5.5703216e+10  1.1971759e-13  0              3.3324833    
    200000   20520          200            200            0.00065979455 -3.1492873e-35  0              0.0019793837   258801.15      0              1.2496581e+10  1.1971759e-13  0              3.0844015    
    300000   20520          200            200           -1.3612126e-05  3.1492976e-35  0             -4.0836378e-05  249.16007      0              12031048       1.1971759e-13  0              3.0431762    
    400000   20520          200            200           -2.6188035e-05 -9.4478657e-35  0             -7.8564105e-05  978.55665      0              47250999       1.1971759e-13  0              3.0046704    
    500000   20520          200            200            0.0028015704  -0.0038727571   0              0.012277468    1519.8065      0              73386016       1.1971759e-13  0              2.992065     
    600000   20520          200            200            0.0012463664  -0.0021607347   0              0.0058998339   256.75386      0              12397725       1.1971759e-13  0              2.9945681    
    700000   20520          200            200            0.0016190102  -0.0021132252   0              0.0069702558   43.096093      0              2080956.1      1.1971759e-13  0              2.9941271    
    800000   20520          200            200            0.0018194452  -0.002154667    0              0.0076130027   1.0528237      0              50837.089      1.1971759e-13  0              2.993851     
    900000   20520          200            200            0.001684668   -0.0021284961   0              0.0071825002   0.12740358     0              6151.8627      1.1971759e-13  0              2.9940301    
   1000000   20520          200            200            0.0017266887  -0.002136861    0              0.0073169273   0.10326643     0              4986.3665      1.1971759e-13  0              2.9939747    
   1100000   20520          200            200            0.001723032   -0.0021362115   0              0.0073053075   0.013828676    0              667.73727      1.1971759e-13  0              2.9939791    
   1200000   20520          200            200            0.0017192566  -0.0021354369   0              0.0072932067   0.00030414648  0              14.686145      1.1971759e-13  0              2.9939843    
   1300000   20520          200            200            0.0017216973  -0.0021359247   0              0.0073010165   4.6516962e-05  0              2.2461376      1.1971759e-13  0              2.993981     
   1400000   20520          200            200            0.0017209461  -0.0021357775   0              0.0072986156   3.4393716e-05  0              1.6607495      1.1971759e-13  0              2.993982     
   1500000   20520          200            200            0.0017210052  -0.0021357879   0              0.0072988035   4.4436597e-06  0              0.21456842     1.1971759e-13  0              2.993982     
   1600000   20520          200            200            0.0017210757  -0.0021358023   0              0.0072990296   8.9129727e-08  0              0.0043037556   1.1971759e-13  0              2.9939819    
   1700000   20520          200            200            0.0017210314  -0.0021357935   0              0.0072988877   1.6786711e-08  0              0.00081057017  1.1971759e-13  0              2.9939819    
   1800000   20520          200            200            0.0017210448  -0.0021357961   0              0.0072989305   1.1449241e-08  0              0.00055284288  1.1971759e-13  0              2.9939819    
   1900000   20520          200            200            0.0017210439  -0.0021357959   0              0.0072989275   1.4266157e-09  0              6.8886167e-05  1.1971759e-13  0              2.9939819    
   2000000   20520          200            200            0.0017210425  -0.0021357957   0              0.0072989233   2.5915166e-11  0              1.2513506e-06  1.1971759e-13  0              2.9939819    
   2100000   20520          200            200            0.0017210433  -0.0021357958   0              0.0072989258   6.0254278e-12  0              2.9094634e-07  1.1971759e-13  0              2.9939819    
   2200000   20520          200            200            0.0017210431  -0.0021357958   0              0.0072989251   3.8055202e-12  0              1.8375495e-07  1.1971759e-13  0              2.9939819    
   2300000   20520          200            200            0.0017210431  -0.0021357958   0              0.0072989251   4.570777e-13   0              2.2070646e-08  1.1971759e-13  0              2.9939819    
   2400000   20520          200            200            0.0017210431  -0.0021357958   0              0.0072989252   7.2936025e-15  0              3.5218196e-10  1.1971759e-13  0              2.9939819    
   2500000   20520          200            200            0.0017210431  -0.0021357958   0              0.0072989252   2.1387669e-15  0              1.032734e-10   1.1971759e-13  0              2.9939819    
   2600000   20520          200            200            0.0017210431  -0.0021357958   0              0.0072989252   1.2259581e-15  0              5.9197131e-11  1.1971759e-13  0              2.9939819    
   2700000   20520          200            200            0.0017210431  -0.0021357958   0              0.0072989252   1.787097e-16   0              8.6292516e-12  1.1971759e-13  0              2.9939819    
   2800000   20520          200            200            0.0017210431  -0.0021357958   0              0.0072989252   1.2392264e-17  0              5.9837806e-13  1.1971759e-13  0              2.9939819    
   2900000   20520          200            200            0.0017210431  -0.0021357958   0              0.0072989252   2.3615104e-19  0              1.1402888e-14  1.1971759e-13  0              2.9939819    
   3000000   20520          200            200            0.0017210431  -0.0021357958   0              0.0072989252   5.7850011e-18  0              2.79337e-13    1.1971759e-13  0              2.9939819    
Loop time of 729.266 on 2 procs for 3000000 steps with 5001 atoms

Performance: 3554260.405 ns/day, 0.000 hours/ns, 4113.727 timesteps/s
99.9% CPU use with 2 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 162.77     | 163.38     | 163.99     |   4.8 | 22.40
Neigh   | 24.855     | 24.858     | 24.86      |   0.1 |  3.41
Comm    | 56.449     | 57.158     | 57.868     |   9.4 |  7.84
Output  | 0.67232    | 0.67234    | 0.67237    |   0.0 |  0.09
Modify  | 426.81     | 426.81     | 426.81     |   0.0 | 58.53
Other   |            | 56.39      |            |       |  7.73

Nlocal:         2500.5 ave        2501 max        2500 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Nghost:            2.5 ave           3 max           2 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Neighs:         1227.5 ave        1228 max        1227 min
Histogram: 1 0 0 0 0 0 0 0 0 1

Total # of neighbors = 2455
Ave neighs/atom = 0.49090182
Neighbor list builds = 166
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 85

#variable lat0 equal 1                    #
variable lat1 equal 3+((300)*0.01)+(v_ind*0.01)        # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 1000*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 6.85                                                               
Lattice spacing in x,y,z = 6.85 6.85 6.85

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -10275 ${n1e1} -100 100 -100 100 units box
region box block -10275 10275 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -10275 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -10275 10275 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-10275 -100 -100) to (10275 100 100)
  2 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 3000 atoms
  using lattice units in orthogonal box = (-10275 -100 -100) to (10275 100 100)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 3000 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 2001 atoms
  using lattice units in orthogonal box = (-10275 -100 -100) to (10275 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  3000 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  3000 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  2001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  2001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
3000 atoms in group substrate
group slider1 region slider1
2001 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 2001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_85_*.dump id type diameter mass xu yu zu fx fy fz
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 13259 130 130
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 474.3 | 474.3 | 474.3 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   20550          200            200            0              0              0              0              0              0              0              1.1971759e-13  0              6            
    100000   20550          200            200            0.0019598036   3.1447034e-35  0              0.0058794108   1153662.8      0              5.5706249e+10  1.1971759e-13  0              3.3324661    
    200000   20550          200            200            0.00065867204 -1.1006429e-34  0              0.0019760161   258697.8       0              1.2491591e+10  1.1971759e-13  0              3.0844987    
    300000   20550          200            200           -1.4077157e-05  9.4340985e-35  0             -4.2231472e-05  267.60636      0              12921753       1.1971759e-13  0              3.0432084    
    400000   20550          200            200           -2.7913437e-05  3.8797075e-41  0             -8.374031e-05   1120.022       0              54081852       1.1971759e-13  0              3.0046647    
    500000   20550          200            200            0.0027313364  -0.0018963484   0              0.010090358    2350.0134      0              1.1347374e+08  1.1971759e-13  0              2.9928029    
    600000   20550          200            200            0.00159659    -0.0017716725   0              0.0065614425   339.36859      0              16386895       1.1971759e-13  0              2.9942433    
    700000   20550          200            200            0.0015533551  -0.0017828105   0              0.0064428759   6.1603373      0              297460.64      1.1971759e-13  0              2.9943142    
    800000   20550          200            200            0.0017430868  -0.0017947672   0              0.0070240276   2.4088775      0              116316.07      1.1971759e-13  0              2.9940625    
    900000   20550          200            200            0.0018343065  -0.0018002844   0              0.0073032038   0.87890332     0              42439.096      1.1971759e-13  0              2.9939415    
   1000000   20550          200            200            0.0018429149  -0.0018008427   0              0.0073295875   0.019942493    0              962.95163      1.1971759e-13  0              2.9939293    
   1100000   20550          200            200            0.0018337636  -0.0018003039   0              0.0073015949   0.0053886508   0              260.19866      1.1971759e-13  0              2.9939411    
   1200000   20550          200            200            0.0018291991  -0.0018000282   0              0.0072876255   0.0021532488   0              103.97268      1.1971759e-13  0              2.9939471    
   1300000   20550          200            200            0.0018287247  -0.0017999977   0              0.0072861719   5.5650043e-05  0              2.6871414      1.1971759e-13  0              2.9939477    
   1400000   20550          200            200            0.0018291615  -0.0018000234   0              0.0072875078   1.1947382e-05  0              0.57689633     1.1971759e-13  0              2.9939472    
   1500000   20550          200            200            0.0018293885  -0.0018000371   0              0.0072882026   5.2667847e-06  0              0.25431419     1.1971759e-13  0              2.9939469    
   1600000   20550          200            200            0.0018294145  -0.0018000388   0              0.0072882823   1.5385282e-07  0              0.007429002    1.1971759e-13  0              2.9939468    
   1700000   20550          200            200            0.0018293937  -0.0018000375   0              0.0072882187   2.6324408e-08  0              0.0012711114   1.1971759e-13  0              2.9939469    
   1800000   20550          200            200            0.0018293824  -0.0018000369   0              0.0072881841   1.2855803e-08  0              0.0006207607   1.1971759e-13  0              2.9939469    
   1900000   20550          200            200            0.001829381   -0.0018000368   0              0.0072881798   4.2132853e-10  0              2.0344447e-05  1.1971759e-13  0              2.9939469    
   2000000   20550          200            200            0.001829382   -0.0018000368   0              0.0072881828   5.7565344e-11  0              2.7796244e-06  1.1971759e-13  0              2.9939469    
   2100000   20550          200            200            0.0018293826  -0.0018000369   0              0.0072881846   3.1311262e-11  0              1.5119088e-06  1.1971759e-13  0              2.9939469    
   2200000   20550          200            200            0.0018293826  -0.0018000369   0              0.0072881848   1.1430535e-12  0              5.5193964e-08  1.1971759e-13  0              2.9939469    
   2300000   20550          200            200            0.0018293826  -0.0018000369   0              0.0072881846   1.2508253e-13  0              6.0397879e-09  1.1971759e-13  0              2.9939469    
   2400000   20550          200            200            0.0018293826  -0.0018000369   0              0.0072881846   7.6081145e-14  0              3.6736862e-09  1.1971759e-13  0              2.9939469    
   2500000   20550          200            200            0.0018293826  -0.0018000369   0              0.0072881846   3.1372689e-15  0              1.5148749e-10  1.1971759e-13  0              2.9939469    
   2600000   20550          200            200            0.0018293826  -0.0018000369   0              0.0072881846   2.5381997e-16  0              1.2256058e-11  1.1971759e-13  0              2.9939469    
   2700000   20550          200            200            0.0018293826  -0.0018000369   0              0.0072881846   1.7976822e-16  0              8.6803638e-12  1.1971759e-13  0              2.9939469    
   2800000   20550          200            200            0.0018293826  -0.0018000369   0              0.0072881846   3.3671065e-19  0              1.6258552e-14  1.1971759e-13  0              2.9939469    
   2900000   20550          200            200            0.0018293826  -0.0018000369   0              0.0072881846   3.6852828e-18  0              1.7794912e-13  1.1971759e-13  0              2.9939469    
   3000000   20550          200            200            0.0018293826  -0.0018000369   0              0.0072881846   5.9781733e-20  0              2.8866459e-15  1.1971759e-13  0              2.9939469    
Loop time of 731.106 on 2 procs for 3000000 steps with 5001 atoms

Performance: 3545311.686 ns/day, 0.000 hours/ns, 4103.370 timesteps/s
99.9% CPU use with 2 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 161        | 162.01     | 163.02     |   7.9 | 22.16
Neigh   | 24.9       | 24.904     | 24.907     |   0.1 |  3.41
Comm    | 55.892     | 56.932     | 57.971     |  13.8 |  7.79
Output  | 0.72742    | 0.72744    | 0.72745    |   0.0 |  0.10
Modify  | 427.18     | 427.2      | 427.23     |   0.1 | 58.43
Other   |            | 59.33      |            |       |  8.12

Nlocal:         2500.5 ave        2501 max        2500 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Nghost:            2.5 ave           3 max           2 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Neighs:         1226.5 ave        1227 max        1226 min
Histogram: 1 0 0 0 0 0 0 0 0 1

Total # of neighbors = 2453
Ave neighs/atom = 0.4905019
Neighbor list builds = 166
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 86

#variable lat0 equal 1                    #
variable lat1 equal 3+((300)*0.01)+(v_ind*0.01)        # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 1000*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 6.86                                                               
Lattice spacing in x,y,z = 6.86 6.86 6.86

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -10290 ${n1e1} -100 100 -100 100 units box
region box block -10290 10290 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -10290 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -10290 10290 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-10290 -100 -100) to (10290 100 100)
  2 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 3000 atoms
  using lattice units in orthogonal box = (-10290 -100 -100) to (10290 100 100)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 3000 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 2001 atoms
  using lattice units in orthogonal box = (-10290 -100 -100) to (10290 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  3000 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  3000 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  2001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  2001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
3000 atoms in group substrate
group slider1 region slider1
2001 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 2001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_86_*.dump id type diameter mass xu yu zu fx fy fz
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 13278 130 130
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 474.9 | 474.9 | 474.9 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   20580          200            200            0              0              0              0              0              0              0              1.1971759e-13  0              6            
    100000   20580          200            200            0.0019569022   2.4532119e-37  0              0.0058707067   1153612.5      0              5.570382e+10   1.1971759e-13  0              3.3325264    
    200000   20580          200            200            0.00065835024  7.8502792e-36  0              0.0019750507   259099.93      0              1.2511008e+10  1.1971759e-13  0              3.0842543    
    300000   20580          200            200           -1.2041619e-05  9.4203705e-35  0             -3.6124858e-05  195.27228      0              9428999.7      1.1971759e-13  0              3.0431879    
    400000   20580          200            200           -2.371523e-05  -1.2560427e-34  0             -7.114569e-05   802.22288      0              38736472       1.1971759e-13  0              3.0047299    
    500000   20580          200            200           -0.0025993689  -0.017371055    0              0.0095729486   2484.317       0              1.1995878e+08  1.1971759e-13  0              2.9928809    
    600000   20580          200            200           -0.0018266851  -0.011469682    0              0.0059896262   273.52512      0              13207549       1.1971759e-13  0              2.9943713    
    700000   20580          200            200           -0.0016536915  -0.011632462    0              0.0066713875   27.27487       0              1317005.9      1.1971759e-13  0              2.9940911    
    800000   20580          200            200           -0.0014614741  -0.011997051    0              0.007612629    0.24475647     0              11818.414      1.1971759e-13  0              2.9936872    
    900000   20580          200            200           -0.0015535715  -0.011892046    0              0.0072313313   0.77537962     0              37440.307      1.1971759e-13  0              2.9938443    
   1000000   20580          200            200           -0.0015487367  -0.011896551    0              0.0072503405   0.076900209    0              3713.2359      1.1971759e-13  0              2.9938376    
   1100000   20580          200            200           -0.0015383122  -0.011908885    0              0.0072939483   9.9830115e-05  0              4.820439       1.1971759e-13  0              2.993819     
   1200000   20580          200            200           -0.001543044   -0.011903491    0              0.0072743591   0.0017000041   0              82.087116      1.1971759e-13  0              2.9938272    
   1300000   20580          200            200           -0.0015425969  -0.011903952    0              0.007276161    0.00021896211  0              10.572897      1.1971759e-13  0              2.9938265    
   1400000   20580          200            200           -0.0015421362  -0.011904499    0              0.0072780903   6.0367864e-08  0              0.0029149481   1.1971759e-13  0              2.9938256    
   1500000   20580          200            200           -0.0015423767  -0.011904223    0              0.0072770927   3.5891802e-06  0              0.17330867     1.1971759e-13  0              2.993826     
   1600000   20580          200            200           -0.0015423445  -0.011904257    0              0.0072772237   6.001415e-07   0              0.028978685    1.1971759e-13  0              2.993826     
   1700000   20580          200            200           -0.0015423248  -0.011904281    0              0.0072773066   2.342159e-09   0              0.00011309448  1.1971759e-13  0              2.993826     
   1800000   20580          200            200           -0.0015423368  -0.011904267    0              0.0072772565   7.2712161e-09  0              0.000351101    1.1971759e-13  0              2.993826     
   1900000   20580          200            200           -0.0015423348  -0.011904269    0              0.007277265    1.5913519e-09  0              7.6840686e-05  1.1971759e-13  0              2.993826     
   2000000   20580          200            200           -0.0015423339  -0.01190427     0              0.0072772684   1.717707e-11   0              8.2941924e-07  1.1971759e-13  0              2.993826     
   2100000   20580          200            200           -0.0015423345  -0.01190427     0              0.0072772659   1.4013996e-11  0              6.7668573e-07  1.1971759e-13  0              2.993826     
   2200000   20580          200            200           -0.0015423344  -0.01190427     0              0.0072772665   4.0925816e-12  0              1.9761612e-07  1.1971759e-13  0              2.993826     
   2300000   20580          200            200           -0.0015423344  -0.01190427     0              0.0072772666   8.3046935e-14  0              4.0100393e-09  1.1971759e-13  0              2.993826     
   2400000   20580          200            200           -0.0015423344  -0.01190427     0              0.0072772665   2.517742e-14   0              1.2157275e-09  1.1971759e-13  0              2.993826     
   2500000   20580          200            200           -0.0015423344  -0.01190427     0              0.0072772665   1.0211229e-14  0              4.930637e-10   1.1971759e-13  0              2.993826     
   2600000   20580          200            200           -0.0015423344  -0.01190427     0              0.0072772665   3.2385892e-16  0              1.5637988e-11  1.1971759e-13  0              2.993826     
   2700000   20580          200            200           -0.0015423344  -0.01190427     0              0.0072772665   1.2442808e-17  0              6.0081868e-13  1.1971759e-13  0              2.993826     
   2800000   20580          200            200           -0.0015423344  -0.01190427     0              0.0072772665   1.3297608e-17  0              6.420939e-13   1.1971759e-13  0              2.993826     
   2900000   20580          200            200           -0.0015423344  -0.01190427     0              0.0072772665   3.3109738e-18  0              1.5987507e-13  1.1971759e-13  0              2.993826     
   3000000   20580          200            200           -0.0015423344  -0.01190427     0              0.0072772665   5.6182865e-21  0              2.7128695e-16  1.1971759e-13  0              2.993826     
Loop time of 729.207 on 2 procs for 3000000 steps with 5001 atoms

Performance: 3554545.327 ns/day, 0.000 hours/ns, 4114.057 timesteps/s
99.9% CPU use with 2 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 163.25     | 163.71     | 164.17     |   3.6 | 22.45
Neigh   | 25.057     | 25.06      | 25.064     |   0.1 |  3.44
Comm    | 57.549     | 57.986     | 58.424     |   5.7 |  7.95
Output  | 0.64132    | 0.64135    | 0.64138    |   0.0 |  0.09
Modify  | 424.94     | 425.02     | 425.11     |   0.4 | 58.29
Other   |            | 56.78      |            |       |  7.79

Nlocal:         2500.5 ave        2501 max        2500 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Nghost:            2.5 ave           3 max           2 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Neighs:         1231.5 ave        1232 max        1231 min
Histogram: 1 0 0 0 0 0 0 0 0 1

Total # of neighbors = 2463
Ave neighs/atom = 0.4925015
Neighbor list builds = 166
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 87

#variable lat0 equal 1                    #
variable lat1 equal 3+((300)*0.01)+(v_ind*0.01)        # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 1000*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 6.87                                                               
Lattice spacing in x,y,z = 6.87 6.87 6.87

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -10305 ${n1e1} -100 100 -100 100 units box
region box block -10305 10305 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -10305 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -10305 10305 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-10305 -100 -100) to (10305 100 100)
  2 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 3000 atoms
  using lattice units in orthogonal box = (-10305 -100 -100) to (10305 100 100)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 3000 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 2001 atoms
  using lattice units in orthogonal box = (-10305 -100 -100) to (10305 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  3000 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  3000 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  2001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  2001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
3000 atoms in group substrate
group slider1 region slider1
2001 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 2001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_87_*.dump id type diameter mass xu yu zu fx fy fz
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 13297 130 130
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 475.6 | 475.6 | 475.6 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   20610          200            200            0              0              0              0              0              0              0              1.1971759e-13  0              6            
    100000   20610          200            200            0.0019538345   4.0159824e-42  0              0.0058615036   1153432.9      0              5.5695145e+10  1.1971759e-13  0              3.3325447    
    200000   20610          200            200            0.00065626623  3.9194319e-36  0              0.0019687987   258399.04      0              1.2477165e+10  1.1971759e-13  0              3.0845805    
    300000   20610          200            200           -1.4330963e-05  1.5677709e-35  0             -4.299289e-05   279.20767      0              13481939       1.1971759e-13  0              3.0431171    
    400000   20610          200            200           -2.8943449e-05 -1.5677621e-35  0             -8.6830346e-05  1214.7955      0              58658128       1.1971759e-13  0              3.0045393    
    500000   20610          200            200            0.0028575427  -0.0031068432   0              0.011679471    1784.2721      0              86156115       1.1971759e-13  0              2.9921739    
    600000   20610          200            200            0.0016856156  -0.0025012385   0              0.0075580853   366.30757      0              17687682       1.1971759e-13  0              2.9937203    
    700000   20610          200            200            0.0013354474  -0.0023597978   0              0.00636614     0.60677331     0              29298.911      1.1971759e-13  0              2.9942527    
    800000   20610          200            200            0.0017200076  -0.0023246432   0              0.0074846659   3.987454       0              192539.88      1.1971759e-13  0              2.9937729    
    900000   20610          200            200            0.0016600303  -0.0023178069   0              0.0072978978   0.832572       0              40201.922      1.1971759e-13  0              2.9938475    
   1000000   20610          200            200            0.0016361207  -0.0023158459   0              0.0072242081   0.014416333    0              696.11313      1.1971759e-13  0              2.9938796    
   1100000   20610          200            200            0.0016544608  -0.0023172974   0              0.0072806798   0.0051043623   0              246.47139      1.1971759e-13  0              2.9938558    
   1200000   20610          200            200            0.0016498714  -0.002316941    0              0.0072665552   0.0021726208   0              104.90808      1.1971759e-13  0              2.9938616    
   1300000   20610          200            200            0.0016493594  -0.0023168967   0              0.0072649749   0.00010532329  0              5.0856848      1.1971759e-13  0              2.9938623    
   1400000   20610          200            200            0.0016501951  -0.0023169635   0              0.0072675487   3.5915835e-06  0              0.17342471     1.1971759e-13  0              2.9938613    
   1500000   20610          200            200            0.0016499077  -0.002316941    0              0.0072666641   4.7899175e-06  0              0.23128798     1.1971759e-13  0              2.9938616    
   1600000   20610          200            200            0.0016499178  -0.0023169416   0              0.007266695    4.5982278e-07  0              0.022203197    1.1971759e-13  0              2.9938616    
   1700000   20610          200            200            0.0016499522  -0.0023169443   0              0.0072668008   2.8449287e-11  0              1.3737142e-06  1.1971759e-13  0              2.9938616    
   1800000   20610          200            200            0.0016499362  -0.0023169431   0              0.0072667515   8.7417642e-09  0              0.00042210851  1.1971759e-13  0              2.9938616    
   1900000   20610          200            200            0.0016499384  -0.0023169432   0              0.0072667583   1.5321254e-09  0              7.3980851e-05  1.1971759e-13  0              2.9938616    
   2000000   20610          200            200            0.0016499396  -0.0023169433   0              0.007266762    1.6886563e-11  0              8.1539168e-07  1.1971759e-13  0              2.9938616    
   2100000   20610          200            200            0.0016499388  -0.0023169433   0              0.0072667595   1.2340806e-11  0              5.9589335e-07  1.1971759e-13  0              2.9938616    
   2200000   20610          200            200            0.0016499389  -0.0023169433   0              0.0072667601   4.2050815e-12  0              2.0304833e-07  1.1971759e-13  0              2.9938616    
   2300000   20610          200            200            0.001649939   -0.0023169433   0              0.0072667602   1.6040711e-13  0              7.7454852e-09  1.1971759e-13  0              2.9938616    
   2400000   20610          200            200            0.0016499389  -0.0023169433   0              0.0072667601   1.0840607e-14  0              5.2345413e-10  1.1971759e-13  0              2.9938616    
   2500000   20610          200            200            0.0016499389  -0.0023169433   0              0.0072667601   9.621812e-15   0              4.6460287e-10  1.1971759e-13  0              2.9938616    
   2600000   20610          200            200            0.0016499389  -0.0023169433   0              0.0072667601   7.9583325e-16  0              3.8427939e-11  1.1971759e-13  0              2.9938616    
   2700000   20610          200            200            0.0016499389  -0.0023169433   0              0.0072667601   4.6346567e-18  0              2.2379099e-13  1.1971759e-13  0              2.9938616    
   2800000   20610          200            200            0.0016499389  -0.0023169433   0              0.0072667601   2.7802868e-18  0              1.342501e-13   1.1971759e-13  0              2.9938616    
   2900000   20610          200            200            0.0016499389  -0.0023169433   0              0.0072667601   8.0739309e-18  0              3.8986123e-13  1.1971759e-13  0              2.9938616    
   3000000   20610          200            200            0.0016499389  -0.0023169433   0              0.0072667601   3.098243e-18   0              1.4960307e-13  1.1971759e-13  0              2.9938616    
Loop time of 730.326 on 2 procs for 3000000 steps with 5001 atoms

Performance: 3549102.344 ns/day, 0.000 hours/ns, 4107.757 timesteps/s
99.9% CPU use with 2 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 162.69     | 163.36     | 164.03     |   5.2 | 22.37
Neigh   | 25.079     | 25.082     | 25.086     |   0.1 |  3.43
Comm    | 56.134     | 56.839     | 57.545     |   9.4 |  7.78
Output  | 0.64392    | 0.64394    | 0.64397    |   0.0 |  0.09
Modify  | 424.88     | 425.03     | 425.18     |   0.7 | 58.20
Other   |            | 59.37      |            |       |  8.13

Nlocal:         2500.5 ave        2501 max        2500 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Nghost:            2.5 ave           3 max           2 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Neighs:         1231.5 ave        1232 max        1231 min
Histogram: 1 0 0 0 0 0 0 0 0 1

Total # of neighbors = 2463
Ave neighs/atom = 0.4925015
Neighbor list builds = 166
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 88

#variable lat0 equal 1                    #
variable lat1 equal 3+((300)*0.01)+(v_ind*0.01)        # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 1000*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 6.88                                                               
Lattice spacing in x,y,z = 6.88 6.88 6.88

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -10320 ${n1e1} -100 100 -100 100 units box
region box block -10320 10320 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -10320 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -10320 10320 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-10320 -100 -100) to (10320 100 100)
  2 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 3000 atoms
  using lattice units in orthogonal box = (-10320 -100 -100) to (10320 100 100)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 3000 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 2001 atoms
  using lattice units in orthogonal box = (-10320 -100 -100) to (10320 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  3000 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  3000 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  2001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  2001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
3000 atoms in group substrate
group slider1 region slider1
2001 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 2001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_88_*.dump id type diameter mass xu yu zu fx fy fz
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 13317 130 130
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 476.3 | 476.3 | 476.3 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   20640          200            200            0              0              0              0              0              0              0              1.1971759e-13  0              6            
    100000   20640          200            200            0.0019511566   1.2851548e-41  0              0.0058534697   1153571.3      0              5.5701829e+10  1.1971759e-13  0              3.3325085    
    200000   20640          200            200            0.00065575161  2.4685638e-40  0              0.0019672548   258670.32      0              1.2490264e+10  1.1971759e-13  0              3.0844823    
    300000   20640          200            200           -1.3687625e-05 -3.1309804e-35  0             -4.1062875e-05  254.99682      0              12312884       1.1971759e-13  0              3.0431739    
    400000   20640          200            200           -2.8009574e-05 -1.5654902e-35  0             -8.4028723e-05  1138.3261      0              54965692       1.1971759e-13  0              3.0046121    
    500000   20640          200            200            0.0034515933  -0.00051506851  0              0.010869848    2093.7111      0              1.0109781e+08  1.1971759e-13  0              2.9924834    
    600000   20640          200            200            0.0022295245  -7.4748589e-05  0              0.0067633222   356.87198      0              17232071       1.1971759e-13  0              2.9940986    
    700000   20640          200            200            0.0021271833   1.2742464e-05  0              0.0063688074   1.3953524      0              67376.576      1.1971759e-13  0              2.9942936    
    800000   20640          200            200            0.0023842506   3.0246513e-05  0              0.0071225053   5.509061       0              266012.84      1.1971759e-13  0              2.993966     
    900000   20640          200            200            0.00246086     2.7161139e-05  0              0.0073554188   0.32154335     0              15526.177      1.1971759e-13  0              2.9938644    
   1000000   20640          200            200            0.0024394671   2.7993186e-05  0              0.0072904083   0.050135442    0              2420.8611      1.1971759e-13  0              2.9938912    
   1100000   20640          200            200            0.0024256959   2.854485e-05   0              0.0072485427   0.012694837    0              612.98824      1.1971759e-13  0              2.9939092    
   1200000   20640          200            200            0.0024263258   2.8524294e-05  0              0.0072504531   0.0001374789   0              6.6383641      1.1971759e-13  0              2.9939086    
   1300000   20640          200            200            0.0024282807   2.8447012e-05  0              0.007256395    0.00029150335  0              14.075654      1.1971759e-13  0              2.993906     
   1400000   20640          200            200            0.002428515    2.8437159e-05  0              0.0072571078   1.4567823e-06  0              0.070342805    1.1971759e-13  0              2.9939057    
   1500000   20640          200            200            0.0024282901   2.8445959e-05  0              0.0072564245   4.4109139e-06  0              0.21298724     1.1971759e-13  0              2.993906     
   1600000   20640          200            200            0.002428222    2.8448719e-05  0              0.0072562172   2.5494241e-07  0              0.012310257    1.1971759e-13  0              2.9939061    
   1700000   20640          200            200            0.0024282411   2.8447986e-05  0              0.0072562753   4.0085084e-08  0              0.0019355652   1.1971759e-13  0              2.9939061    
   1800000   20640          200            200            0.0024282534   2.8447495e-05  0              0.0072563126   1.0117603e-08  0              0.00048854282  1.1971759e-13  0              2.993906     
   1900000   20640          200            200            0.0024282528   2.8447513e-05  0              0.0072563109   1.1090215e-10  0              5.3550679e-06  1.1971759e-13  0              2.993906     
   2000000   20640          200            200            0.0024282511   2.8447582e-05  0              0.0072563056   2.3257801e-10  0              1.123036e-05   1.1971759e-13  0              2.993906     
   2100000   20640          200            200            0.0024282509   2.8447591e-05  0              0.007256305    1.1449976e-12  0              5.5287836e-08  1.1971759e-13  0              2.993906     
   2200000   20640          200            200            0.0024282511   2.8447583e-05  0              0.0072563056   3.5225845e-12  0              1.70093e-07    1.1971759e-13  0              2.993906     
   2300000   20640          200            200            0.0024282511   2.8447581e-05  0              0.0072563058   2.0243169e-13  0              9.7747016e-09  1.1971759e-13  0              2.993906     
   2400000   20640          200            200            0.0024282511   2.8447581e-05  0              0.0072563057   3.2290475e-14  0              1.5591915e-09  1.1971759e-13  0              2.993906     
   2500000   20640          200            200            0.0024282511   2.8447582e-05  0              0.0072563057   7.8898221e-15  0              3.8097127e-10  1.1971759e-13  0              2.993906     
   2600000   20640          200            200            0.0024282511   2.8447582e-05  0              0.0072563057   9.7681717e-17  0              4.7167005e-12  1.1971759e-13  0              2.993906     
   2700000   20640          200            200            0.0024282511   2.8447582e-05  0              0.0072563057   1.6486593e-16  0              7.9607859e-12  1.1971759e-13  0              2.993906     
   2800000   20640          200            200            0.0024282511   2.8447582e-05  0              0.0072563057   1.6845519e-18  0              8.1340981e-14  1.1971759e-13  0              2.993906     
   2900000   20640          200            200            0.0024282511   2.8447582e-05  0              0.0072563057   1.4648136e-17  0              7.0730604e-13  1.1971759e-13  0              2.993906     
   3000000   20640          200            200            0.0024282511   2.8447581e-05  0              0.0072563057   3.0090279e-18  0              1.4529519e-13  1.1971759e-13  0              2.993906     
Loop time of 732.211 on 2 procs for 3000000 steps with 5001 atoms

Performance: 3539963.811 ns/day, 0.000 hours/ns, 4097.180 timesteps/s
99.9% CPU use with 2 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 163.98     | 164.44     | 164.89     |   3.5 | 22.46
Neigh   | 25.236     | 25.24      | 25.243     |   0.1 |  3.45
Comm    | 57.822     | 58.217     | 58.612     |   5.2 |  7.95
Output  | 0.66845    | 0.66848    | 0.66851    |   0.0 |  0.09
Modify  | 424.78     | 424.81     | 424.83     |   0.1 | 58.02
Other   |            | 58.84      |            |       |  8.04

Nlocal:         2500.5 ave        2501 max        2500 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Nghost:            2.5 ave           3 max           2 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Neighs:         1226.5 ave        1227 max        1226 min
Histogram: 1 0 0 0 0 0 0 0 0 1

Total # of neighbors = 2453
Ave neighs/atom = 0.4905019
Neighbor list builds = 166
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 89

#variable lat0 equal 1                    #
variable lat1 equal 3+((300)*0.01)+(v_ind*0.01)        # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 1000*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 6.89                                                               
Lattice spacing in x,y,z = 6.89 6.89 6.89

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -10335 ${n1e1} -100 100 -100 100 units box
region box block -10335 10335 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -10335 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -10335 10335 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-10335 -100 -100) to (10335 100 100)
  2 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 3000 atoms
  using lattice units in orthogonal box = (-10335 -100 -100) to (10335 100 100)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 3000 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 2001 atoms
  using lattice units in orthogonal box = (-10335 -100 -100) to (10335 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  3000 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  3000 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  2001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  2001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
3000 atoms in group substrate
group slider1 region slider1
2001 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 2001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_89_*.dump id type diameter mass xu yu zu fx fy fz
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 13336 130 130
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 477 | 477 | 477 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   20670          200            200            0              0              0              0              0              0              0              1.1971759e-13  0              6            
    100000   20670          200            200            0.0019482329  -1.5632188e-35  0              0.0058446988   1153487        0              5.5697758e+10  1.1971759e-13  0              3.3325525    
    200000   20670          200            200            0.00065461985  1.990081e-41   0              0.0019638596   258557.94      0              1.2484837e+10  1.1971759e-13  0              3.0845346    
    300000   20670          200            200           -1.3698628e-05  3.9080507e-36  0             -4.1095885e-05  256.17417      0              12369734       1.1971759e-13  0              3.0431611    
    400000   20670          200            200           -2.6938757e-05  9.3793212e-35  0             -8.0816272e-05  1053.2163      0              50856048       1.1971759e-13  0              3.0046374    
    500000   20670          200            200            0.0043456465   0.0024166782   0              0.010620261    2172.2241      0              1.0488893e+08  1.1971759e-13  0              2.9925399    
    600000   20670          200            200            0.0020689764  -0.00032164357  0              0.0065285727   342.3537       0              16531035       1.1971759e-13  0              2.9941663    
    700000   20670          200            200            0.0019717249  -0.00050367721  0              0.0064188518   7.4781726      0              361094.19      1.1971759e-13  0              2.9942394    
    800000   20670          200            200            0.0023423308  -0.00043994099  0              0.0074669333   3.8740598      0              187064.48      1.1971759e-13  0              2.9937845    
    900000   20670          200            200            0.0022830219  -0.000454155    0              0.0073032208   0.69288562     0              33456.967      1.1971759e-13  0              2.99385      
   1000000   20670          200            200            0.0022445757  -0.00046693403  0              0.007200661    0.0014569179   0              70.349353      1.1971759e-13  0              2.9938942    
   1100000   20670          200            200            0.002262331   -0.00046340755  0              0.0072504006   0.014937684    0              721.2873       1.1971759e-13  0              2.9938734    
   1200000   20670          200            200            0.0022623569  -0.00046338695  0              0.0072504576   0.00082831774  0              39.996499      1.1971759e-13  0              2.9938732    
   1300000   20670          200            200            0.0022600141  -0.00046370262  0              0.0072437451   7.1379627e-05  0              3.4466667      1.1971759e-13  0              2.993876     
   1400000   20670          200            200            0.0022606617  -0.00046361707  0              0.0072456021   3.8660124e-05  0              1.866759       1.1971759e-13  0              2.9938753    
   1500000   20670          200            200            0.0022607971  -0.0004635981   0              0.0072459894   3.4815599e-07  0              0.016811207    1.1971759e-13  0              2.9938751    
   1600000   20670          200            200            0.0022606724  -0.00046361484  0              0.007245632    4.5241321e-07  0              0.021845415    1.1971759e-13  0              2.9938752    
   1700000   20670          200            200            0.0022606888  -0.00046361274  0              0.0072456792   7.0845434e-08  0              0.0034208724   1.1971759e-13  0              2.9938752    
   1800000   20670          200            200            0.002260701   -0.00046361107  0              0.0072457141   2.7462485e-10  0              1.3260651e-05  1.1971759e-13  0              2.9938752    
   1900000   20670          200            200            0.0022606954  -0.00046361182  0              0.0072456981   1.6329263e-09  0              7.8848165e-05  1.1971759e-13  0              2.9938752    
   2000000   20670          200            200            0.0022606953  -0.00046361183  0              0.0072456978   8.0857668e-11  0              3.9043274e-06  1.1971759e-13  0              2.9938752    
   2100000   20670          200            200            0.0022606961  -0.00046361173  0              0.0072457001   8.6385222e-12  0              4.1712332e-07  1.1971759e-13  0              2.9938752    
   2200000   20670          200            200            0.0022606959  -0.00046361176  0              0.0072456995   4.1044027e-12  0              1.9818692e-07  1.1971759e-13  0              2.9938752    
   2300000   20670          200            200            0.0022606959  -0.00046361176  0              0.0072456993   2.7944213e-14  0              1.3493261e-09  1.1971759e-13  0              2.9938752    
   2400000   20670          200            200            0.0022606959  -0.00046361176  0              0.0072456995   5.0946811e-14  0              2.4600392e-09  1.1971759e-13  0              2.9938752    
   2500000   20670          200            200            0.0022606959  -0.00046361176  0              0.0072456994   7.1015758e-15  0              3.4290968e-10  1.1971759e-13  0              2.9938752    
   2600000   20670          200            200            0.0022606959  -0.00046361176  0              0.0072456994   3.9869501e-17  0              1.9251555e-12  1.1971759e-13  0              2.9938752    
   2700000   20670          200            200            0.0022606959  -0.00046361176  0              0.0072456994   1.3689017e-16  0              6.6099363e-12  1.1971759e-13  0              2.9938752    
   2800000   20670          200            200            0.0022606959  -0.00046361176  0              0.0072456994   2.0589388e-17  0              9.9418788e-13  1.1971759e-13  0              2.9938752    
   2900000   20670          200            200            0.0022606959  -0.00046361176  0              0.0072456994   5.0284873e-18  0              2.4280766e-13  1.1971759e-13  0              2.9938752    
   3000000   20670          200            200            0.0022606959  -0.00046361176  0              0.0072456994   8.4251915e-18  0              4.0682234e-13  1.1971759e-13  0              2.9938752    
Loop time of 731.597 on 2 procs for 3000000 steps with 5001 atoms

Performance: 3542933.125 ns/day, 0.000 hours/ns, 4100.617 timesteps/s
99.9% CPU use with 2 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 165.45     | 165.86     | 166.27     |   3.2 | 22.67
Neigh   | 25.078     | 25.082     | 25.085     |   0.1 |  3.43
Comm    | 57.293     | 57.624     | 57.954     |   4.4 |  7.88
Output  | 0.66706    | 0.66708    | 0.6671     |   0.0 |  0.09
Modify  | 424.53     | 424.56     | 424.59     |   0.1 | 58.03
Other   |            | 57.81      |            |       |  7.90

Nlocal:         2500.5 ave        2501 max        2500 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Nghost:            2.5 ave           3 max           2 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Neighs:         1228.5 ave        1229 max        1228 min
Histogram: 1 0 0 0 0 0 0 0 0 1

Total # of neighbors = 2457
Ave neighs/atom = 0.49130174
Neighbor list builds = 166
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 90

#variable lat0 equal 1                    #
variable lat1 equal 3+((300)*0.01)+(v_ind*0.01)        # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 1000*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 6.9                                                               
Lattice spacing in x,y,z = 6.9 6.9 6.9

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -10350 ${n1e1} -100 100 -100 100 units box
region box block -10350 10350 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -10350 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -10350 10350 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-10350 -100 -100) to (10350 100 100)
  2 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 3000 atoms
  using lattice units in orthogonal box = (-10350 -100 -100) to (10350 100 100)
  create_atoms CPU = 0.002 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 3000 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 2001 atoms
  using lattice units in orthogonal box = (-10350 -100 -100) to (10350 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  3000 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  3000 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  2001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  2001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
3000 atoms in group substrate
group slider1 region slider1
2001 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 2001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_90_*.dump id type diameter mass xu yu zu fx fy fz
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 13355 130 130
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 477.7 | 477.7 | 477.7 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   20700          200            200            0              0              0              0              0              0              0              1.1971759e-13  0              6            
    100000   20700          200            200            0.0019453192   7.8047693e-36  0              0.0058359577   1153359.9      0              5.5691624e+10  1.1971759e-13  0              3.3327757    
    200000   20700          200            200            0.00065657199  2.3382935e-41  0              0.001969716    260408.27      0              1.2574183e+10  1.1971759e-13  0              3.0832905    
    300000   20700          200            200           -2.5232157e-05 -1.56095e-35    0             -7.5696471e-05  898.38598      0              43379844       1.1971759e-13  0              3.0426974    
    400000   20700          200            200            0.0035197533   1.5609593e-35  0              0.01055926     17425.579      0              8.4141885e+08  1.1971759e-13  0              2.9933362    
    500000   20700          200            200            0.00097860217  3.6583475e-41  0              0.0029358065   1306.62        0              63092005       1.1971759e-13  0              2.9971592    
    600000   20700          200            200            0.0024353683   1.5609578e-35  0              0.0073061048   366.953        0              17718847       1.1971759e-13  0              2.9949072    
    700000   20700          200            200            0.0024137384   7.0242951e-35  0              0.0072412153   49.427054      0              2386655.5      1.1971759e-13  0              2.9949058    
    800000   20700          200            200            0.002409253    7.0242954e-35  0              0.007227759    6.64479        0              320853.13      1.1971759e-13  0              2.9949236    
    900000   20700          200            200            0.0024134941  -2.3414283e-35  0              0.0072404822   0.89492305     0              43212.631      1.1971759e-13  0              2.9949134    
   1000000   20700          200            200            0.0024122292   1.5609558e-35  0              0.0072366875   0.12046354     0              5816.7533      1.1971759e-13  0              2.9949167    
   1100000   20700          200            200            0.0024126793   1.3808269e-41  0              0.0072380378   0.01621866     0              783.14102      1.1971759e-13  0              2.9949155    
   1200000   20700          200            200            0.0024125354   3.9023964e-36  0              0.0072376063   0.002183428    0              105.42992      1.1971759e-13  0              2.9949159    
   1300000   20700          200            200            0.0024125824   2.7316702e-35  0              0.0072377471   0.0002939464   0              14.193619      1.1971759e-13  0              2.9949158    
   1400000   20700          200            200            0.0024125676   7.8047804e-36  0              0.0072377027   3.9572091e-05  0              1.9107947      1.1971759e-13  0              2.9949158    
   1500000   20700          200            200            0.0024125721  -1.1707142e-35  0              0.0072377164   5.3272826e-06  0              0.25723541     1.1971759e-13  0              2.9949158    
   1600000   20700          200            200            0.0024125708   1.1630354e-41  0              0.0072377123   7.1716236e-07  0              0.034629204    1.1971759e-13  0              2.9949158    
   1700000   20700          200            200            0.0024125712  -9.7558448e-37  0              0.0072377135   9.6543879e-08  0              0.0046617584   1.1971759e-13  0              2.9949158    
   1800000   20700          200            200            0.0024125711  -2.4388742e-37  0              0.0072377132   1.2996519e-08  0              0.0006275554   1.1971759e-13  0              2.9949158    
   1900000   20700          200            200            0.0024125711  -2.438874e-37   0              0.0072377133   1.7495515e-09  0              8.4479578e-05  1.1971759e-13  0              2.9949158    
   2000000   20700          200            200            0.0024125711  -9.755845e-37   0              0.0072377133   2.3550785e-10  0              1.1371831e-05  1.1971759e-13  0              2.9949158    
   2100000   20700          200            200            0.0024125711  -9.7558446e-37  0              0.0072377133   3.1699332e-11  0              1.5306473e-06  1.1971759e-13  0              2.9949158    
   2200000   20700          200            200            0.0024125711   3.902396e-36   0              0.0072377133   4.267263e-12   0              2.0605086e-07  1.1971759e-13  0              2.9949158    
   2300000   20700          200            200            0.0024125711  -3.9023727e-36  0              0.0072377133   5.7435558e-13  0              2.7733576e-08  1.1971759e-13  0              2.9949158    
   2400000   20700          200            200            0.0024125711   5.8535882e-36  0              0.0072377133   7.7345083e-14  0              3.7347172e-09  1.1971759e-13  0              2.9949158    
   2500000   20700          200            200            0.0024125711   1.9512038e-36  0              0.0072377133   1.040118e-14   0              5.0223575e-10  1.1971759e-13  0              2.9949158    
   2600000   20700          200            200            0.0024125711  -3.9023727e-36  0              0.0072377133   1.3985893e-15  0              6.7532874e-11  1.1971759e-13  0              2.9949158    
   2700000   20700          200            200            0.0024125711   3.9023855e-35  0              0.0072377133   1.7811891e-16  0              8.6007246e-12  1.1971759e-13  0              2.9949158    
   2800000   20700          200            200            0.0024125711  -3.5121448e-35  0              0.0072377133   2.3588786e-17  0              1.1390181e-12  1.1971759e-13  0              2.9949158    
   2900000   20700          200            200            0.0024125711   1.1685915e-41  0              0.0072377133   6.218225e-18   0              3.0025583e-13  1.1971759e-13  0              2.9949158    
   3000000   20700          200            200            0.0024125711  -3.9023739e-36  0              0.0072377133   4.0700936e-21  0              1.9653025e-16  1.1971759e-13  0              2.9949158    
Loop time of 722.135 on 2 procs for 3000000 steps with 5001 atoms

Performance: 3589357.731 ns/day, 0.000 hours/ns, 4154.349 timesteps/s
99.9% CPU use with 2 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 154.2      | 155.67     | 157.13     |  11.7 | 21.56
Neigh   | 25.251     | 25.253     | 25.255     |   0.0 |  3.50
Comm    | 56.173     | 57.592     | 59.01      |  18.7 |  7.98
Output  | 0.66729    | 0.66731    | 0.66734    |   0.0 |  0.09
Modify  | 425.71     | 425.76     | 425.8      |   0.2 | 58.96
Other   |            | 57.2       |            |       |  7.92

Nlocal:         2500.5 ave        2501 max        2500 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Nghost:            2.5 ave           3 max           2 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Neighs:         1217.5 ave        1218 max        1217 min
Histogram: 1 0 0 0 0 0 0 0 0 1

Total # of neighbors = 2435
Ave neighs/atom = 0.48690262
Neighbor list builds = 166
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 91

#variable lat0 equal 1                    #
variable lat1 equal 3+((300)*0.01)+(v_ind*0.01)        # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 1000*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 6.91                                                               
Lattice spacing in x,y,z = 6.91 6.91 6.91

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -10365 ${n1e1} -100 100 -100 100 units box
region box block -10365 10365 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -10365 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -10365 10365 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-10365 -100 -100) to (10365 100 100)
  2 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 3000 atoms
  using lattice units in orthogonal box = (-10365 -100 -100) to (10365 100 100)
  create_atoms CPU = 0.002 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 3000 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 2001 atoms
  using lattice units in orthogonal box = (-10365 -100 -100) to (10365 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  3000 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  3000 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  2001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  2001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
3000 atoms in group substrate
group slider1 region slider1
2001 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 2001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_91_*.dump id type diameter mass xu yu zu fx fy fz
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 13375 130 130
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 478.4 | 478.4 | 478.4 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   20730          200            200            0              0              0              0              0              0              0              1.1971759e-13  0              6            
    100000   20730          200            200            0.0019423573   7.7934855e-36  0              0.0058270719   1153276        0              5.5687569e+10  1.1971759e-13  0              3.332637     
    200000   20730          200            200            0.00065220292  1.5586987e-35  0              0.0019566088   258233.41      0              1.2469167e+10  1.1971759e-13  0              3.0846593    
    300000   20730          200            200           -1.4530402e-05 -9.3521505e-35  0             -4.3591207e-05  290.61388      0              14032704       1.1971759e-13  0              3.0430966    
    400000   20730          200            200           -2.9516667e-05 -9.7418415e-37  0             -8.8550002e-05  1280.6162      0              61836374       1.1971759e-13  0              3.0044972    
    500000   20730          200            200            0.0057918017   0.0054738158   0              0.011901589    1665.7211      0              80431711       1.1971759e-13  0              2.9920778    
    600000   20730          200            200            0.0034712968   0.0029075988   0              0.0075062915   365.55981      0              17651575       1.1971759e-13  0              2.9937177    
    700000   20730          200            200            0.0029566089   0.0025264967   0              0.0063433301   1.6991619      0              82046.446      1.1971759e-13  0              2.9942433    
    800000   20730          200            200            0.0032360276   0.0025005805   0              0.0072075025   6.6079848      0              319075.94      1.1971759e-13  0              2.9938666    
    900000   20730          200            200            0.0032799915   0.0024937616   0              0.007346213    0.022787219    0              1100.3133      1.1971759e-13  0              2.9938048    
   1000000   20730          200            200            0.0032275253   0.0024753767   0              0.0072071991   0.10261976     0              4955.1409      1.1971759e-13  0              2.9938636    
   1100000   20730          200            200            0.0032286041   0.0024745135   0              0.0072112987   0.0053992322   0              260.7096       1.1971759e-13  0              2.9938623    
   1200000   20730          200            200            0.0032349871   0.0024756934   0              0.0072292678   0.00095018893  0              45.881223      1.1971759e-13  0              2.9938546    
   1300000   20730          200            200            0.0032337298   0.0024754731   0              0.0072257164   0.00022635752  0              10.929994      1.1971759e-13  0              2.993856     
   1400000   20730          200            200            0.003233082    0.0024753532   0              0.0072238928   2.6548558e-06  0              0.12819349     1.1971759e-13  0              2.9938568    
   1500000   20730          200            200            0.0032333596   0.0024754031   0              0.0072246757   5.274534e-06   0              0.25468837     1.1971759e-13  0              2.9938565    
   1600000   20730          200            200            0.0032334003   0.0024754109   0              0.00722479     2.7237625e-08  0              0.0013152074   1.1971759e-13  0              2.9938564    
   1700000   20730          200            200            0.0032333562   0.0024754029   0              0.0072246656   7.9164442e-08  0              0.0038225676   1.1971759e-13  0              2.9938565    
   1800000   20730          200            200            0.0032333581   0.0024754032   0              0.007224671    4.7992016e-09  0              0.00023173627  1.1971759e-13  0              2.9938565    
   1900000   20730          200            200            0.0032333637   0.0024754042   0              0.0072246868   6.8968749e-10  0              3.330254e-05   1.1971759e-13  0              2.9938565    
   2000000   20730          200            200            0.0032333625   0.002475404    0              0.0072246835   1.8807257e-10  0              9.0813513e-06  1.1971759e-13  0              2.9938565    
   2100000   20730          200            200            0.0032333619   0.0024754039   0              0.0072246819   1.5342786e-12  0              7.4084822e-08  1.1971759e-13  0              2.9938565    
   2200000   20730          200            200            0.0032333622   0.0024754039   0              0.0072246826   4.2107859e-12  0              2.0332378e-07  1.1971759e-13  0              2.9938565    
   2300000   20730          200            200            0.0032333622   0.002475404    0              0.0072246827   3.1490097e-14  0              1.5205441e-09  1.1971759e-13  0              2.9938565    
   2400000   20730          200            200            0.0032333622   0.0024754039   0              0.0072246826   6.0669052e-14  0              2.9294914e-09  1.1971759e-13  0              2.9938565    
   2500000   20730          200            200            0.0032333622   0.0024754039   0              0.0072246826   4.0634026e-15  0              1.9620717e-10  1.1971759e-13  0              2.9938565    
   2600000   20730          200            200            0.0032333622   0.0024754039   0              0.0072246826   4.6025259e-16  0              2.222395e-11   1.1971759e-13  0              2.9938565    
   2700000   20730          200            200            0.0032333622   0.0024754039   0              0.0072246826   1.8194286e-16  0              8.7853697e-12  1.1971759e-13  0              2.9938565    
   2800000   20730          200            200            0.0032333622   0.0024754039   0              0.0072246826   2.7032759e-18  0              1.3053152e-13  1.1971759e-13  0              2.9938565    
   2900000   20730          200            200            0.0032333622   0.0024754039   0              0.0072246826   1.3437249e-17  0              6.4883665e-13  1.1971759e-13  0              2.9938565    
   3000000   20730          200            200            0.0032333622   0.002475404    0              0.0072246826   5.9476923e-18  0              2.8719278e-13  1.1971759e-13  0              2.9938565    
Loop time of 732.756 on 2 procs for 3000000 steps with 5001 atoms

Performance: 3537330.864 ns/day, 0.000 hours/ns, 4094.133 timesteps/s
99.9% CPU use with 2 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 162.89     | 163.21     | 163.54     |   2.6 | 22.27
Neigh   | 25.3       | 25.304     | 25.308     |   0.1 |  3.45
Comm    | 57.512     | 57.797     | 58.082     |   3.8 |  7.89
Output  | 0.66977    | 0.6698     | 0.66982    |   0.0 |  0.09
Modify  | 427.39     | 427.45     | 427.5      |   0.3 | 58.33
Other   |            | 58.32      |            |       |  7.96

Nlocal:         2500.5 ave        2501 max        2500 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Nghost:            2.5 ave           3 max           2 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Neighs:         1226.5 ave        1227 max        1226 min
Histogram: 1 0 0 0 0 0 0 0 0 1

Total # of neighbors = 2453
Ave neighs/atom = 0.4905019
Neighbor list builds = 166
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 92

#variable lat0 equal 1                    #
variable lat1 equal 3+((300)*0.01)+(v_ind*0.01)        # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 1000*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 6.92                                                               
Lattice spacing in x,y,z = 6.92 6.92 6.92

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -10380 ${n1e1} -100 100 -100 100 units box
region box block -10380 10380 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -10380 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -10380 10380 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-10380 -100 -100) to (10380 100 100)
  2 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 3000 atoms
  using lattice units in orthogonal box = (-10380 -100 -100) to (10380 100 100)
  create_atoms CPU = 0.002 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 3000 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 2001 atoms
  using lattice units in orthogonal box = (-10380 -100 -100) to (10380 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  3000 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  3000 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  2001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  2001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
3000 atoms in group substrate
group slider1 region slider1
2001 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 2001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_92_*.dump id type diameter mass xu yu zu fx fy fz
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 13394 130 130
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 479 | 479 | 479 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   20760          200            200            0              0              0              0              0              0              0              1.1971759e-13  0              6            
    100000   20760          200            200            0.0019393923   7.9789016e-41  0              0.0058181768   1153139.2      0              5.5680967e+10  1.1971759e-13  0              3.3326756    
    200000   20760          200            200            0.00065086853 -7.7821986e-36  0              0.0019526056   257990.45      0              1.2457435e+10  1.1971759e-13  0              3.0847432    
    300000   20760          200            200           -1.5212902e-05  3.1128858e-35  0             -4.5638705e-05  320.10103      0              15456533       1.1971759e-13  0              3.0430419    
    400000   20760          200            200           -2.9882014e-05 -6.225761e-35   0             -8.9646042e-05  1317.7426      0              63629072       1.1971759e-13  0              3.0044503    
    500000   20760          200            200            0.0034012023  -0.0011188331   0              0.01132244     1907.3241      0              92097854       1.1971759e-13  0              2.9922427    
    600000   20760          200            200            0.0021750085  -0.00024979508  0              0.0067748206   359.14237      0              17341700       1.1971759e-13  0              2.9940038    
    700000   20760          200            200            0.0020809213  -9.3204287e-05  0              0.006335968    1.6926227      0              81730.695      1.1971759e-13  0              2.9942194    
    800000   20760          200            200            0.0022964654  -0.00017508993  0              0.0070644862   5.2027662      0              251222.96      1.1971759e-13  0              2.9939007    
    900000   20760          200            200            0.0023743527  -0.00018211818  0              0.0073051762   0.40411904     0              19513.462      1.1971759e-13  0              2.9937951    
   1000000   20760          200            200            0.0023569729  -0.0001807411   0              0.0072516597   0.034687608    0              1674.9404      1.1971759e-13  0              2.9938172    
   1100000   20760          200            200            0.002343179   -0.00017955765  0              0.0072090948   0.014621302    0              706.01035      1.1971759e-13  0              2.9938355    
   1200000   20760          200            200            0.0023428847  -0.00017952299  0              0.0072081771   3.8712295e-06  0              0.18692782     1.1971759e-13  0              2.9938361    
   1300000   20760          200            200            0.0023446823  -0.00017967772  0              0.0072137247   0.00027706297  0              13.378379      1.1971759e-13  0              2.9938337    
   1400000   20760          200            200            0.0023450652  -0.00017971184  0              0.0072149074   8.4740204e-06  0              0.40918012     1.1971759e-13  0              2.9938332    
   1500000   20760          200            200            0.0023448963  -0.00017969758  0              0.0072143865   2.8362203e-06  0              0.13695093     1.1971759e-13  0              2.9938334    
   1600000   20760          200            200            0.0023448126  -0.00017969027  0              0.0072141281   5.0829377e-07  0              0.024543687    1.1971759e-13  0              2.9938335    
   1700000   20760          200            200            0.0023448193  -0.00017969079  0              0.0072141488   8.2009204e-09  0              0.0003959931   1.1971759e-13  0              2.9938335    
   1800000   20760          200            200            0.0023448319  -0.00017969188  0              0.0072141875   1.2813774e-08  0              0.00061873128  1.1971759e-13  0              2.9938335    
   1900000   20760          200            200            0.0023448334  -0.00017969201  0              0.0072141921   8.8594326e-11  0              4.277903e-06   1.1971759e-13  0              2.9938335    
   2000000   20760          200            200            0.002344832   -0.0001796919   0              0.0072141878   1.8047995e-10  0              8.7147311e-06  1.1971759e-13  0              2.9938335    
   2100000   20760          200            200            0.0023448315  -0.00017969185  0              0.0072141864   1.4662903e-11  0              7.0801911e-07  1.1971759e-13  0              2.9938335    
   2200000   20760          200            200            0.0023448316  -0.00017969186  0              0.0072141867   1.1585525e-12  0              5.5942355e-08  1.1971759e-13  0              2.9938335    
   2300000   20760          200            200            0.0023448317  -0.00017969187  0              0.0072141869   5.1942683e-13  0              2.5081263e-08  1.1971759e-13  0              2.9938335    
   2400000   20760          200            200            0.0023448317  -0.00017969187  0              0.0072141869   3.9291098e-17  0              1.8972265e-12  1.1971759e-13  0              2.9938335    
   2500000   20760          200            200            0.0023448317  -0.00017969187  0              0.0072141869   9.6898733e-15  0              4.678893e-10   1.1971759e-13  0              2.9938335    
   2600000   20760          200            200            0.0023448317  -0.00017969187  0              0.0072141869   2.7679672e-16  0              1.3365523e-11  1.1971759e-13  0              2.9938335    
   2700000   20760          200            200            0.0023448317  -0.00017969187  0              0.0072141869   1.4791418e-16  0              7.1422464e-12  1.1971759e-13  0              2.9938335    
   2800000   20760          200            200            0.0023448317  -0.00017969187  0              0.0072141869   2.18863e-18    0              1.0568111e-13  1.1971759e-13  0              2.9938335    
   2900000   20760          200            200            0.0023448317  -0.00017969187  0              0.0072141869   1.9529176e-18  0              9.4299404e-14  1.1971759e-13  0              2.9938335    
   3000000   20760          200            200            0.0023448317  -0.00017969187  0              0.0072141869   1.2445188e-19  0              6.0093359e-15  1.1971759e-13  0              2.9938335    
Loop time of 731.339 on 2 procs for 3000000 steps with 5001 atoms

Performance: 3544184.739 ns/day, 0.000 hours/ns, 4102.066 timesteps/s
100.0% CPU use with 2 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 162.21     | 162.79     | 163.37     |   4.5 | 22.26
Neigh   | 25.332     | 25.336     | 25.339     |   0.1 |  3.46
Comm    | 57.266     | 57.81      | 58.355     |   7.2 |  7.90
Output  | 0.66598    | 0.66601    | 0.66603    |   0.0 |  0.09
Modify  | 426.5      | 426.58     | 426.66     |   0.4 | 58.33
Other   |            | 58.16      |            |       |  7.95

Nlocal:         2500.5 ave        2501 max        2500 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Nghost:            2.5 ave           3 max           2 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Neighs:         1225.5 ave        1226 max        1225 min
Histogram: 1 0 0 0 0 0 0 0 0 1

Total # of neighbors = 2451
Ave neighs/atom = 0.49010198
Neighbor list builds = 166
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 93

#variable lat0 equal 1                    #
variable lat1 equal 3+((300)*0.01)+(v_ind*0.01)        # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 1000*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 6.93                                                               
Lattice spacing in x,y,z = 6.93 6.93 6.93

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -10395 ${n1e1} -100 100 -100 100 units box
region box block -10395 10395 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -10395 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -10395 10395 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-10395 -100 -100) to (10395 100 100)
  2 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 3000 atoms
  using lattice units in orthogonal box = (-10395 -100 -100) to (10395 100 100)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 3000 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 2001 atoms
  using lattice units in orthogonal box = (-10395 -100 -100) to (10395 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  3000 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  3000 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  2001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  2001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
3000 atoms in group substrate
group slider1 region slider1
2001 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 2001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_93_*.dump id type diameter mass xu yu zu fx fy fz
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 13413 130 130
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 479.7 | 479.7 | 479.7 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   20790          200            200            0              0              0              0              0              0              0              1.1971759e-13  0              6            
    100000   20790          200            200            0.0019368432   3.8854923e-36  0              0.0058105295   1153352.3      0              5.5691256e+10  1.1971759e-13  0              3.3326265    
    200000   20790          200            200            0.00065060715 -2.9141182e-36  0              0.0019518214   258411.34      0              1.2477759e+10  1.1971759e-13  0              3.0845977    
    300000   20790          200            200           -1.3878671e-05  2.1618575e-40  0             -4.1636012e-05  266.21058      0              12854356       1.1971759e-13  0              3.0431371    
    400000   20790          200            200           -2.7649869e-05  6.7727608e-41  0             -8.2949606e-05  1125.0209      0              54323232       1.1971759e-13  0              3.0045883    
    500000   20790          200            200            0.0041882987   0.0011863267   0              0.011378569    1864.0859      0              90010036       1.1971759e-13  0              2.9922399    
    600000   20790          200            200            0.0024016289  -0.00021750842  0              0.0074223951   368.54314      0              17795629       1.1971759e-13  0              2.9937494    
    700000   20790          200            200            0.0019405754  -0.00049247236  0              0.0063141984   0.93398225     0              45098.66       1.1971759e-13  0              2.9942515    
    800000   20790          200            200            0.0023740904  -0.00030466587  0              0.007426937    3.8073991      0              183845.68      1.1971759e-13  0              2.9937699    
    900000   20790          200            200            0.0023071524  -0.00030997397  0              0.0072314313   0.84422705     0              40764.703      1.1971759e-13  0              2.9938489    
   1000000   20790          200            200            0.0022829022  -0.00031340898  0              0.0071621157   0.016617218    0              802.38598      1.1971759e-13  0              2.9938794    
   1100000   20790          200            200            0.0023023894  -0.0003107213   0              0.0072178895   0.0046976366   0              226.83206      1.1971759e-13  0              2.9938557    
   1200000   20790          200            200            0.0022973632  -0.00031138567  0              0.0072034752   0.0021681037   0              104.68997      1.1971759e-13  0              2.9938617    
   1300000   20790          200            200            0.002296885   -0.00031145739  0              0.0072021124   0.00011305882  0              5.4592059      1.1971759e-13  0              2.9938623    
   1400000   20790          200            200            0.0022977652  -0.00031133682  0              0.0072046324   2.9957404e-06  0              0.14465358     1.1971759e-13  0              2.9938613    
   1500000   20790          200            200            0.0022974543  -0.00031137854  0              0.0072037415   4.7016705e-06  0              0.22702684     1.1971759e-13  0              2.9938616    
   1600000   20790          200            200            0.0022974685  -0.00031137696  0              0.0072037823   4.7827382e-07  0              0.023094131    1.1971759e-13  0              2.9938616    
   1700000   20790          200            200            0.0022975043  -0.00031137202  0              0.0072038848   9.8164893e-12  0              4.7400314e-07  1.1971759e-13  0              2.9938616    
   1800000   20790          200            200            0.0022974871  -0.00031137434  0              0.0072038356   8.4088286e-09  0              0.00040603224  1.1971759e-13  0              2.9938616    
   1900000   20790          200            200            0.0022974896  -0.00031137401  0              0.0072038428   1.5614536e-09  0              7.5397009e-05  1.1971759e-13  0              2.9938616    
   2000000   20790          200            200            0.0022974908  -0.00031137384  0              0.0072038463   2.0341328e-11  0              9.8220991e-07  1.1971759e-13  0              2.9938616    
   2100000   20790          200            200            0.00229749    -0.00031137396  0              0.0072038439   1.1516792e-11  0              5.5610466e-07  1.1971759e-13  0              2.9938616    
   2200000   20790          200            200            0.0022974902  -0.00031137393  0              0.0072038444   4.2162892e-12  0              2.0358952e-07  1.1971759e-13  0              2.9938616    
   2300000   20790          200            200            0.0022974902  -0.00031137392  0              0.0072038445   1.7473955e-13  0              8.4375473e-09  1.1971759e-13  0              2.9938616    
   2400000   20790          200            200            0.0022974902  -0.00031137393  0              0.0072038444   9.3782286e-15  0              4.5284109e-10  1.1971759e-13  0              2.9938616    
   2500000   20790          200            200            0.0022974902  -0.00031137393  0              0.0072038444   9.4811583e-15  0              4.578112e-10   1.1971759e-13  0              2.9938616    
   2600000   20790          200            200            0.0022974902  -0.00031137393  0              0.0072038444   8.3766734e-16  0              4.0447958e-11  1.1971759e-13  0              2.9938616    
   2700000   20790          200            200            0.0022974902  -0.00031137393  0              0.0072038444   6.334797e-18   0              3.0588468e-13  1.1971759e-13  0              2.9938616    
   2800000   20790          200            200            0.0022974902  -0.00031137393  0              0.0072038444   2.6652469e-18  0              1.2869524e-13  1.1971759e-13  0              2.9938616    
   2900000   20790          200            200            0.0022974902  -0.00031137393  0              0.0072038444   1.2972894e-17  0              6.264146e-13   1.1971759e-13  0              2.9938616    
   3000000   20790          200            200            0.0022974902  -0.00031137393  0              0.0072038444   3.4790524e-18  0              1.6799099e-13  1.1971759e-13  0              2.9938616    
Loop time of 735.245 on 2 procs for 3000000 steps with 5001 atoms

Performance: 3525354.045 ns/day, 0.000 hours/ns, 4080.271 timesteps/s
99.9% CPU use with 2 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 163.16     | 163.74     | 164.32     |   4.5 | 22.27
Neigh   | 25.402     | 25.405     | 25.408     |   0.1 |  3.46
Comm    | 58.017     | 58.585     | 59.153     |   7.4 |  7.97
Output  | 0.67181    | 0.67182    | 0.67182    |   0.0 |  0.09
Modify  | 427.67     | 427.82     | 427.97     |   0.7 | 58.19
Other   |            | 59.02      |            |       |  8.03

Nlocal:         2500.5 ave        2501 max        2500 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Nghost:            2.5 ave           3 max           2 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Neighs:         1229.5 ave        1230 max        1229 min
Histogram: 1 0 0 0 0 0 0 0 0 1

Total # of neighbors = 2459
Ave neighs/atom = 0.49170166
Neighbor list builds = 166
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 94

#variable lat0 equal 1                    #
variable lat1 equal 3+((300)*0.01)+(v_ind*0.01)        # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 1000*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 6.94                                                               
Lattice spacing in x,y,z = 6.94 6.94 6.94

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -10410 ${n1e1} -100 100 -100 100 units box
region box block -10410 10410 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -10410 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -10410 10410 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-10410 -100 -100) to (10410 100 100)
  2 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 3000 atoms
  using lattice units in orthogonal box = (-10410 -100 -100) to (10410 100 100)
  create_atoms CPU = 0.002 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 3000 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 2001 atoms
  using lattice units in orthogonal box = (-10410 -100 -100) to (10410 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  3000 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  3000 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  2001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  2001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
3000 atoms in group substrate
group slider1 region slider1
2001 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 2001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_94_*.dump id type diameter mass xu yu zu fx fy fz
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 13433 130 130
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 480.4 | 480.4 | 480.4 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   20820          200            200            0              0              0              0              0              0              0              1.1971759e-13  0              6            
    100000   20820          200            200            0.0019338524   1.5519658e-35  0              0.0058015572   1153185.7      0              5.5683212e+10  1.1971759e-13  0              3.3326477    
    200000   20820          200            200            0.00064915199 -7.6045884e-34  0              0.001947456    258091.47      0              1.2462313e+10  1.1971759e-13  0              3.0846852    
    300000   20820          200            200           -1.4734819e-05 -3.1039073e-35  0             -4.4204457e-05  301.68073      0              14567083       1.1971759e-13  0              3.0430403    
    400000   20820          200            200           -3.0333451e-05  4.6558767e-35  0             -9.1000354e-05  1367.6517      0              66039007       1.1971759e-13  0              3.0044126    
    500000   20820          200            200            0.0052259004   0.0035727838   0              0.012104917    1548.5211      0              74772544       1.1971759e-13  0              2.9919587    
    600000   20820          200            200            0.0032218125   0.0022046404   0              0.0074607971   365.62374      0              17654662       1.1971759e-13  0              2.9936925    
    700000   20820          200            200            0.0027350421   0.0018926275   0              0.0063124986   1.5706135      0              75839.305      1.1971759e-13  0              2.9942126    
    800000   20820          200            200            0.0030322174   0.0019182583   0              0.007178394    6.5994907      0              318665.79      1.1971759e-13  0              2.9938356    
    900000   20820          200            200            0.0030797236   0.0019241969   0              0.0073149739   0.011545364    0              557.4843       1.1971759e-13  0              2.9937744    
   1000000   20820          200            200            0.0030326027   0.001917255    0              0.0071805531   0.11056225     0              5338.6552      1.1971759e-13  0              2.9938315    
   1100000   20820          200            200            0.0030319043   0.0019170999   0              0.0071786129   0.0029893939   0              144.34713      1.1971759e-13  0              2.9938328    
   1200000   20820          200            200            0.0030383197   0.0019180681   0              0.0071968911   0.0014528854   0              70.154636      1.1971759e-13  0              2.9938249    
   1300000   20820          200            200            0.0030376376   0.001917972    0              0.0071949409   0.00014351658  0              6.9299019      1.1971759e-13  0              2.9938257    
   1400000   20820          200            200            0.0030368572   0.0019178536   0              0.0071927179   1.3504882e-05  0              0.65210241     1.1971759e-13  0              2.9938267    
   1500000   20820          200            200            0.0030370436   0.0019178809   0              0.0071932499   4.2324124e-06  0              0.20436805     1.1971759e-13  0              2.9938264    
   1600000   20820          200            200            0.003037126    0.0019178936   0              0.0071934844   5.9991029e-08  0              0.0028967521   1.1971759e-13  0              2.9938263    
   1700000   20820          200            200            0.0030370909   0.0019178884   0              0.0071933844   9.3927958e-08  0              0.004535445    1.1971759e-13  0              2.9938264    
   1800000   20820          200            200            0.0030370841   0.0019178873   0              0.007193365    1.7743634e-11  0              8.567766e-07   1.1971759e-13  0              2.9938264    
   1900000   20820          200            200            0.0030370896   0.0019178881   0              0.0071933808   1.6581264e-09  0              8.0064989e-05  1.1971759e-13  0              2.9938264    
   2000000   20820          200            200            0.0030370899   0.0019178882   0              0.0071933815   3.030436e-11   0              1.4632891e-06  1.1971759e-13  0              2.9938264    
   2100000   20820          200            200            0.0030370891   0.001917888    0              0.0071933793   2.3148364e-11  0              1.1177516e-06  1.1971759e-13  0              2.9938264    
   2200000   20820          200            200            0.0030370892   0.0019178881   0              0.0071933795   1.7529209e-12  0              8.4642278e-08  1.1971759e-13  0              2.9938264    
   2300000   20820          200            200            0.0030370893   0.0019178881   0              0.0071933797   2.3566989e-13  0              1.1379656e-08  1.1971759e-13  0              2.9938264    
   2400000   20820          200            200            0.0030370893   0.0019178881   0              0.0071933797   5.6360756e-14  0              2.7214592e-09  1.1971759e-13  0              2.9938264    
   2500000   20820          200            200            0.0030370892   0.0019178881   0              0.0071933797   1.3699564e-15  0              6.6150293e-11  1.1971759e-13  0              2.9938264    
   2600000   20820          200            200            0.0030370892   0.0019178881   0              0.0071933797   1.3370817e-15  0              6.4562891e-11  1.1971759e-13  0              2.9938264    
   2700000   20820          200            200            0.0030370892   0.0019178881   0              0.0071933797   9.5784927e-18  0              4.6251113e-13  1.1971759e-13  0              2.9938264    
   2800000   20820          200            200            0.0030370892   0.0019178881   0              0.0071933797   9.0393649e-18  0              4.3647858e-13  1.1971759e-13  0              2.9938264    
   2900000   20820          200            200            0.0030370892   0.0019178881   0              0.0071933797   6.7114769e-19  0              3.240732e-14   1.1971759e-13  0              2.9938264    
   3000000   20820          200            200            0.0030370892   0.0019178881   0              0.0071933797   7.9737849e-19  0              3.8502554e-14  1.1971759e-13  0              2.9938264    
Loop time of 730.771 on 2 procs for 3000000 steps with 5001 atoms

Performance: 3546936.606 ns/day, 0.000 hours/ns, 4105.251 timesteps/s
99.9% CPU use with 2 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 162.85     | 163.59     | 164.34     |   5.8 | 22.39
Neigh   | 25.348     | 25.352     | 25.356     |   0.1 |  3.47
Comm    | 57.056     | 57.791     | 58.527     |   9.7 |  7.91
Output  | 0.69407    | 0.69409    | 0.69411    |   0.0 |  0.09
Modify  | 426.27     | 426.29     | 426.3      |   0.1 | 58.33
Other   |            | 57.05      |            |       |  7.81

Nlocal:         2500.5 ave        2501 max        2500 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Nghost:            2.5 ave           3 max           2 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Neighs:         1227.5 ave        1228 max        1227 min
Histogram: 1 0 0 0 0 0 0 0 0 1

Total # of neighbors = 2455
Ave neighs/atom = 0.49090182
Neighbor list builds = 166
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 95

#variable lat0 equal 1                    #
variable lat1 equal 3+((300)*0.01)+(v_ind*0.01)        # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 1000*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 6.95                                                               
Lattice spacing in x,y,z = 6.95 6.95 6.95

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -10425 ${n1e1} -100 100 -100 100 units box
region box block -10425 10425 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -10425 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -10425 10425 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-10425 -100 -100) to (10425 100 100)
  2 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 3000 atoms
  using lattice units in orthogonal box = (-10425 -100 -100) to (10425 100 100)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 3000 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 2001 atoms
  using lattice units in orthogonal box = (-10425 -100 -100) to (10425 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  3000 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  3000 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  2001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  2001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
3000 atoms in group substrate
group slider1 region slider1
2001 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 2001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_95_*.dump id type diameter mass xu yu zu fx fy fz
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 13452 130 130
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 481 | 481 | 481 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   20850          200            200            0              0              0              0              0              0              0              1.1971759e-13  0              6            
    100000   20850          200            200            0.0019309383   4.842888e-37   0              0.0057928148   1153067.3      0              5.5677492e+10  1.1971759e-13  0              3.332697     
    200000   20850          200            200            0.00064782958  1.5497353e-35  0              0.0019434887   257846.78      0              1.2450498e+10  1.1971759e-13  0              3.0848022    
    300000   20850          200            200           -1.5313733e-05  3.7185677e-41  0             -4.5941198e-05  327.33003      0              15805596       1.1971759e-13  0              3.0430159    
    400000   20850          200            200           -3.122993e-05   6.1989433e-35  0             -9.368979e-05   1457.4549      0              70375281       1.1971759e-13  0              3.0043663    
    500000   20850          200            200            0.0039601717  -0.00085579385  0              0.012736309    1248.9503      0              60307340       1.1971759e-13  0              2.9917505    
    600000   20850          200            200            0.0027868269  -6.0993412e-05  0              0.008421474    273.69668      0              13215833       1.1971759e-13  0              2.9932796    
    700000   20850          200            200            0.0024533857   2.7239151e-05  0              0.0073329179   47.21294       0              2279743.9      1.1971759e-13  0              2.9937518    
    800000   20850          200            200            0.0023850106   2.6311994e-05  0              0.0071287198   6.4000157      0              309033.85      1.1971759e-13  0              2.9938462    
    900000   20850          200            200            0.0023831591   2.6270715e-05  0              0.0071232067   0.67031241     0              32366.987      1.1971759e-13  0              2.9938506    
   1000000   20850          200            200            0.002391809    2.6370623e-05  0              0.0071490565   0.049048821    0              2368.392       1.1971759e-13  0              2.9938398    
   1100000   20850          200            200            0.0023980638   2.6446298e-05  0              0.0071677452   0.0017428055   0              84.153841      1.1971759e-13  0              2.9938318    
   1200000   20850          200            200            0.0024011986   2.6484966e-05  0              0.0071771109   1.361219e-06   0              0.065728396    1.1971759e-13  0              2.9938277    
   1300000   20850          200            200            0.0024025084   2.6501307e-05  0              0.0071810238   4.1207004e-05  0              1.9897388      1.1971759e-13  0              2.993826     
   1400000   20850          200            200            0.0024029852   2.6507308e-05  0              0.0071824484   1.8042571e-05  0              0.87121117     1.1971759e-13  0              2.9938254    
   1500000   20850          200            200            0.0024031362   2.6509225e-05  0              0.0071828993   4.2055676e-06  0              0.20307181     1.1971759e-13  0              2.9938252    
   1600000   20850          200            200            0.0024031756   2.6509733e-05  0              0.007183017    6.9816021e-07  0              0.033711658    1.1971759e-13  0              2.9938251    
   1700000   20850          200            200            0.0024031823   2.6509823e-05  0              0.0071830371   8.8431834e-08  0              0.0042700568   1.1971759e-13  0              2.9938251    
   1800000   20850          200            200            0.0024031816   2.6509817e-05  0              0.007183035    8.3930321e-09  0              0.00040526948  1.1971759e-13  0              2.9938251    
   1900000   20850          200            200            0.0024031802   2.65098e-05    0              0.0071830309   5.2195428e-10  0              2.5203304e-05  1.1971759e-13  0              2.9938251    
   2000000   20850          200            200            0.0024031794   2.650979e-05   0              0.0071830283   1.1213075e-11  0              5.4143928e-07  1.1971759e-13  0              2.9938251    
   2100000   20850          200            200            0.002403179    2.6509785e-05  0              0.0071830271   6.0266324e-13  0              2.9100451e-08  1.1971759e-13  0              2.9938251    
   2200000   20850          200            200            0.0024031788   2.6509783e-05  0              0.0071830267   9.6672082e-13  0              4.6679488e-08  1.1971759e-13  0              2.9938251    
   2300000   20850          200            200            0.0024031788   2.6509782e-05  0              0.0071830265   3.2547051e-13  0              1.5715806e-08  1.1971759e-13  0              2.9938251    
   2400000   20850          200            200            0.0024031787   2.6509782e-05  0              0.0071830265   6.6862172e-14  0              3.228535e-09   1.1971759e-13  0              2.9938251    
   2500000   20850          200            200            0.0024031787   2.6509782e-05  0              0.0071830264   1.0166391e-14  0              4.9089862e-10  1.1971759e-13  0              2.9938251    
   2600000   20850          200            200            0.0024031787   2.6509782e-05  0              0.0071830264   1.1407367e-15  0              5.5082094e-11  1.1971759e-13  0              2.9938251    
   2700000   20850          200            200            0.0024031787   2.6509782e-05  0              0.0071830264   5.8942664e-17  0              2.8461303e-12  1.1971759e-13  0              2.9938251    
   2800000   20850          200            200            0.0024031787   2.6509782e-05  0              0.0071830264   3.8658913e-20  0              1.8667005e-15  1.1971759e-13  0              2.9938251    
   2900000   20850          200            200            0.0024031787   2.6509782e-05  0              0.0071830264   6.1254944e-18  0              2.957782e-13   1.1971759e-13  0              2.9938251    
   3000000   20850          200            200            0.0024031787   2.6509782e-05  0              0.0071830264   8.084828e-19   0              3.9038741e-14  1.1971759e-13  0              2.9938251    
Loop time of 730.758 on 2 procs for 3000000 steps with 5001 atoms

Performance: 3547002.591 ns/day, 0.000 hours/ns, 4105.327 timesteps/s
99.9% CPU use with 2 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 158.28     | 160.24     | 162.2      |  15.5 | 21.93
Neigh   | 25.393     | 25.397     | 25.4       |   0.1 |  3.48
Comm    | 56.87      | 58.743     | 60.615     |  24.4 |  8.04
Output  | 0.67104    | 0.67104    | 0.67105    |   0.0 |  0.09
Modify  | 426.84     | 426.94     | 427.04     |   0.5 | 58.42
Other   |            | 58.77      |            |       |  8.04

Nlocal:         2500.5 ave        2501 max        2500 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Nghost:            2.5 ave           3 max           2 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Neighs:         1222.5 ave        1223 max        1222 min
Histogram: 1 0 0 0 0 0 0 0 0 1

Total # of neighbors = 2445
Ave neighs/atom = 0.48890222
Neighbor list builds = 166
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 96

#variable lat0 equal 1                    #
variable lat1 equal 3+((300)*0.01)+(v_ind*0.01)        # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 1000*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 6.96                                                               
Lattice spacing in x,y,z = 6.96 6.96 6.96

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -10440 ${n1e1} -100 100 -100 100 units box
region box block -10440 10440 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -10440 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -10440 10440 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-10440 -100 -100) to (10440 100 100)
  2 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 3000 atoms
  using lattice units in orthogonal box = (-10440 -100 -100) to (10440 100 100)
  create_atoms CPU = 0.002 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 3000 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 2001 atoms
  using lattice units in orthogonal box = (-10440 -100 -100) to (10440 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  3000 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  3000 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  2001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  2001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
3000 atoms in group substrate
group slider1 region slider1
2001 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 2001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_96_*.dump id type diameter mass xu yu zu fx fy fz
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 13471 130 130
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 481.7 | 481.7 | 481.7 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   20880          200            200            0              0              0              0              0              0              0              1.1971759e-13  0              6            
    100000   20880          200            200            0.0019285351   9.6718582e-37  0              0.0057856053   1153386.9      0              5.5692927e+10  1.1971759e-13  0              3.3326187    
    200000   20880          200            200            0.0006479634   3.2048304e-41  0              0.0019438902   258511.28      0              1.2482585e+10  1.1971759e-13  0              3.0845658    
    300000   20880          200            200           -1.3653869e-05  2.3212473e-35  0             -4.0961607e-05  259.76666      0              12543202       1.1971759e-13  0              3.0431694    
    400000   20880          200            200           -2.5962898e-05  2.3212475e-35  0             -7.7888694e-05  996.43698      0              48114376       1.1971759e-13  0              3.0046614    
    500000   20880          200            200            0.003478342   -0.0016604951   0              0.012095521    1505.5854      0              72699333       1.1971759e-13  0              2.9920546    
    600000   20880          200            200            0.0016264455  -0.00092798416  0              0.0058073207   258.37707      0              12476104       1.1971759e-13  0              2.9945638    
    700000   20880          200            200            0.0019801573  -0.00090555061  0              0.0068460224   42.937505      0              2073298.4      1.1971759e-13  0              2.9941289    
    800000   20880          200            200            0.0021863232  -0.00092344769  0              0.0074824173   1.0294802      0              49709.913      1.1971759e-13  0              2.9938507    
    900000   20880          200            200            0.0020488853  -0.00091222178  0              0.0070588775   0.130437       0              6298.3358      1.1971759e-13  0              2.9940301    
   1000000   20880          200            200            0.0020915929  -0.00091579504  0              0.0071905736   0.10368298     0              5006.4798      1.1971759e-13  0              2.9939748    
   1100000   20880          200            200            0.0020879679  -0.00091552409  0              0.0071794279   0.013773576    0              665.0767       1.1971759e-13  0              2.9939791    
   1200000   20880          200            200            0.0020840869  -0.00091518985  0              0.0071674504   0.00029692668  0              14.337527      1.1971759e-13  0              2.9939843    
   1300000   20880          200            200            0.0020865779  -0.00091539909  0              0.0071751328   4.7557678e-05  0              2.2963901      1.1971759e-13  0              2.993981     
   1400000   20880          200            200            0.002085815   -0.00091533619  0              0.0071727811   3.4524336e-05  0              1.6670566      1.1971759e-13  0              2.993982     
   1500000   20880          200            200            0.0020858734  -0.00091534051  0              0.0071729608   4.4248464e-06  0              0.21366        1.1971759e-13  0              2.993982     
   1600000   20880          200            200            0.0020859459  -0.00091534675  0              0.0071731844   8.6874595e-08  0              0.0041948633   1.1971759e-13  0              2.9939819    
   1700000   20880          200            200            0.0020859006  -0.00091534295  0              0.0071730449   1.7141047e-08  0              0.00082767982  1.1971759e-13  0              2.9939819    
   1800000   20880          200            200            0.0020859142  -0.00091534407  0              0.0071730868   1.1490017e-08  0              0.00055481182  1.1971759e-13  0              2.9939819    
   1900000   20880          200            200            0.0020859133  -0.000915344    0              0.0071730839   1.420222e-09   0              6.8577439e-05  1.1971759e-13  0              2.9939819    
   2000000   20880          200            200            0.002085912   -0.00091534389  0              0.0071730798   2.5211275e-11  0              1.2173622e-06  1.1971759e-13  0              2.9939819    
   2100000   20880          200            200            0.0020859128  -0.00091534396  0              0.0071730823   6.1462997e-12  0              2.9678281e-07  1.1971759e-13  0              2.9939819    
   2200000   20880          200            200            0.0020859125  -0.00091534394  0              0.0071730815   3.8207341e-12  0              1.8448958e-07  1.1971759e-13  0              2.9939819    
   2300000   20880          200            200            0.0020859126  -0.00091534394  0              0.0071730816   4.5572374e-13  0              2.2005269e-08  1.1971759e-13  0              2.9939819    
   2400000   20880          200            200            0.0020859126  -0.00091534394  0              0.0071730817   7.2772526e-15  0              3.5139248e-10  1.1971759e-13  0              2.9939819    
   2500000   20880          200            200            0.0020859126  -0.00091534394  0              0.0071730816   2.179051e-15   0              1.0521857e-10  1.1971759e-13  0              2.9939819    
   2600000   20880          200            200            0.0020859126  -0.00091534394  0              0.0071730816   1.2281533e-15  0              5.9303126e-11  1.1971759e-13  0              2.9939819    
   2700000   20880          200            200            0.0020859126  -0.00091534394  0              0.0071730816   1.7878308e-16  0              8.6327951e-12  1.1971759e-13  0              2.9939819    
   2800000   20880          200            200            0.0020859126  -0.00091534394  0              0.0071730816   1.3407573e-17  0              6.4740369e-13  1.1971759e-13  0              2.9939819    
   2900000   20880          200            200            0.0020859126  -0.00091534394  0              0.0071730816   5.3758888e-19  0              2.5958243e-14  1.1971759e-13  0              2.9939819    
   3000000   20880          200            200            0.0020859126  -0.00091534394  0              0.0071730816   5.6358614e-18  0              2.7213558e-13  1.1971759e-13  0              2.9939819    
Loop time of 727.917 on 2 procs for 3000000 steps with 5001 atoms

Performance: 3560843.932 ns/day, 0.000 hours/ns, 4121.347 timesteps/s
100.0% CPU use with 2 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 158.39     | 159.76     | 161.12     |  10.8 | 21.95
Neigh   | 25.417     | 25.42      | 25.422     |   0.0 |  3.49
Comm    | 56.784     | 58.082     | 59.379     |  17.0 |  7.98
Output  | 0.64666    | 0.64668    | 0.6467     |   0.0 |  0.09
Modify  | 425.96     | 426.04     | 426.12     |   0.4 | 58.53
Other   |            | 57.97      |            |       |  7.96

Nlocal:         2500.5 ave        2501 max        2500 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Nghost:            2.5 ave           3 max           2 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Neighs:         1223.5 ave        1224 max        1223 min
Histogram: 1 0 0 0 0 0 0 0 0 1

Total # of neighbors = 2447
Ave neighs/atom = 0.48930214
Neighbor list builds = 166
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 97

#variable lat0 equal 1                    #
variable lat1 equal 3+((300)*0.01)+(v_ind*0.01)        # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 1000*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 6.97                                                               
Lattice spacing in x,y,z = 6.97 6.97 6.97

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -10455 ${n1e1} -100 100 -100 100 units box
region box block -10455 10455 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -10455 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -10455 10455 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-10455 -100 -100) to (10455 100 100)
  2 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 3000 atoms
  using lattice units in orthogonal box = (-10455 -100 -100) to (10455 100 100)
  create_atoms CPU = 0.002 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 3000 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 2001 atoms
  using lattice units in orthogonal box = (-10455 -100 -100) to (10455 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  3000 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  3000 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  2001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  2001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
3000 atoms in group substrate
group slider1 region slider1
2001 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 2001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_97_*.dump id type diameter mass xu yu zu fx fy fz
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 13491 130 130
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 482.4 | 482.4 | 482.4 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   20910          200            200            0              0              0              0              0              0              0              1.1971759e-13  0              6            
    100000   20910          200            200            0.0019254103   4.6358362e-35  0              0.0057762308   1153083.4      0              5.5678273e+10  1.1971759e-13  0              3.3326731    
    200000   20910          200            200            0.00064611838  9.6579849e-37  0              0.0019383551   257943.48      0              1.2455168e+10  1.1971759e-13  0              3.0847185    
    300000   20910          200            200           -1.5057736e-05  1.8543344e-34  0             -4.5173207e-05  318.12442      0              15361090       1.1971759e-13  0              3.042989     
    400000   20910          200            200           -3.1031294e-05  4.6358346e-35  0             -9.3093881e-05  1446.8872      0              69865006       1.1971759e-13  0              3.0043382    
    500000   20910          200            200            0.0068398817   0.0074382102   0              0.013081435    1028.581       0              49666494       1.1971759e-13  0              2.991585     
    600000   20910          200            200            0.0040966965   0.0036019015   0              0.0086881879   234.26102      0              11311626       1.1971759e-13  0              2.9931455    
    700000   20910          200            200            0.0032506509   0.0030421978   0              0.0067097549   37.012373      0              1787195        1.1971759e-13  0              2.9939817    
    800000   20910          200            200            0.0032949551   0.0030348956   0              0.0068499698   0.5802146      0              28016.487      1.1971759e-13  0              2.993927     
    900000   20910          200            200            0.0034289994   0.0031030223   0              0.0071839758   0.86237253     0              41640.883      1.1971759e-13  0              2.9937813    
   1000000   20910          200            200            0.0034393566   0.0031113314   0              0.0072067384   0.00030705788  0              14.826726      1.1971759e-13  0              2.9937704    
   1100000   20910          200            200            0.0034235581   0.0031073789   0              0.0071632955   0.015978051    0              771.52291      1.1971759e-13  0              2.993789     
   1200000   20910          200            200            0.0034210469   0.003106693    0              0.0071564478   7.665122e-05   0              3.7012131      1.1971759e-13  0              2.9937921    
   1300000   20910          200            200            0.0034229575   0.0031071901   0              0.0071616825   0.00026361599  0              12.729073      1.1971759e-13  0              2.9937899    
   1400000   20910          200            200            0.0034234634   0.0031073255   0              0.0071630648   6.7835876e-06  0              0.32755517     1.1971759e-13  0              2.9937893    
   1500000   20910          200            200            0.0034232509   0.003107271    0              0.0071624818   3.824504e-06   0              0.18467161     1.1971759e-13  0              2.9937895    
   1600000   20910          200            200            0.0034231642   0.003107248    0              0.0071622447   2.7270005e-07  0              0.01316771     1.1971759e-13  0              2.9937896    
   1700000   20910          200            200            0.0034231852   0.0031072533   0              0.0071623023   4.7189038e-08  0              0.0022785898   1.1971759e-13  0              2.9937896    
   1800000   20910          200            200            0.0034231987   0.0031072569   0              0.0071623392   7.9817924e-09  0              0.00038541219  1.1971759e-13  0              2.9937896    
   1900000   20910          200            200            0.0034231971   0.0031072565   0              0.0071623347   4.5697868e-10  0              2.2065865e-05  1.1971759e-13  0              2.9937896    
   2000000   20910          200            200            0.0034231951   0.0031072559   0              0.0071623294   1.9314224e-10  0              9.3261475e-06  1.1971759e-13  0              2.9937896    
   2100000   20910          200            200            0.0034231952   0.003107256    0              0.0071623295   2.7363572e-12  0              1.321289e-07   1.1971759e-13  0              2.9937896    
   2200000   20910          200            200            0.0034231954   0.003107256    0              0.0071623302   4.0599178e-12  0              1.960389e-07   1.1971759e-13  0              2.9937896    
   2300000   20910          200            200            0.0034231954   0.003107256    0              0.0071623303   2.0771393e-15  0              1.0029762e-10  1.1971759e-13  0              2.9937896    
   2400000   20910          200            200            0.0034231954   0.003107256    0              0.0071623302   7.5694951e-14  0              3.6550383e-09  1.1971759e-13  0              2.9937896    
   2500000   20910          200            200            0.0034231954   0.003107256    0              0.0071623302   3.6454899e-16  0              1.7602766e-11  1.1971759e-13  0              2.9937896    
   2600000   20910          200            200            0.0034231954   0.003107256    0              0.0071623302   1.2661289e-15  0              6.1136832e-11  1.1971759e-13  0              2.9937896    
   2700000   20910          200            200            0.0034231954   0.003107256    0              0.0071623302   5.1538814e-18  0              2.4886249e-13  1.1971759e-13  0              2.9937896    
   2800000   20910          200            200            0.0034231954   0.003107256    0              0.0071623302   2.5463309e-17  0              1.229532e-12   1.1971759e-13  0              2.9937896    
   2900000   20910          200            200            0.0034231954   0.003107256    0              0.0071623302   5.5322038e-20  0              2.6713032e-15  1.1971759e-13  0              2.9937896    
   3000000   20910          200            200            0.0034231954   0.003107256    0              0.0071623302   2.0198235e-18  0              9.7530048e-14  1.1971759e-13  0              2.9937896    
Loop time of 731.742 on 2 procs for 3000000 steps with 5001 atoms

Performance: 3542234.059 ns/day, 0.000 hours/ns, 4099.808 timesteps/s
99.9% CPU use with 2 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 159.45     | 160.97     | 162.49     |  11.9 | 22.00
Neigh   | 25.58      | 25.586     | 25.591     |   0.1 |  3.50
Comm    | 57.094     | 58.69      | 60.285     |  20.8 |  8.02
Output  | 0.68852    | 0.68854    | 0.68855    |   0.0 |  0.09
Modify  | 426.78     | 426.79     | 426.81     |   0.1 | 58.33
Other   |            | 59.01      |            |       |  8.06

Nlocal:         2500.5 ave        2501 max        2500 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Nghost:            2.5 ave           3 max           2 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Neighs:         1226.5 ave        1227 max        1226 min
Histogram: 1 0 0 0 0 0 0 0 0 1

Total # of neighbors = 2453
Ave neighs/atom = 0.4905019
Neighbor list builds = 166
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 98

#variable lat0 equal 1                    #
variable lat1 equal 3+((300)*0.01)+(v_ind*0.01)        # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 1000*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 6.98                                                               
Lattice spacing in x,y,z = 6.98 6.98 6.98

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -10470 ${n1e1} -100 100 -100 100 units box
region box block -10470 10470 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -10470 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -10470 10470 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-10470 -100 -100) to (10470 100 100)
  2 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 3000 atoms
  using lattice units in orthogonal box = (-10470 -100 -100) to (10470 100 100)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 3000 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 2001 atoms
  using lattice units in orthogonal box = (-10470 -100 -100) to (10470 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  3000 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  3000 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  2001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  2001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
3000 atoms in group substrate
group slider1 region slider1
2001 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 2001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_98_*.dump id type diameter mass xu yu zu fx fy fz
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 13510 130 130
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 483 | 483 | 483 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   20940          200            200            0              0              0              0              0              0              0              1.1971759e-13  0              6            
    100000   20940          200            200            0.0019223764  -7.7152904e-36  0              0.0057671293   1152841.5      0              5.566659e+10   1.1971759e-13  0              3.3327481    
    200000   20940          200            200            0.00064430329 -9.2583685e-35  0              0.0019329099   257382.92      0              1.24281e+10    1.1971759e-13  0              3.0849645    
    300000   20940          200            200           -1.653378e-05   1.5430633e-35  0             -4.960134e-05   386.2257       0              18649457       1.1971759e-13  0              3.0429077    
    400000   20940          200            200           -3.4410238e-05 -1.9288286e-36  0             -0.00010323071  1800.4889      0              86939167       1.1971759e-13  0              3.0041449    
    500000   20940          200            200            0.0034621818  -0.0036892092   0              0.014075755    446.79773      0              21574263       1.1971759e-13  0              2.9912612    
    600000   20940          200            200            0.0025719407  -0.0016976861   0              0.0094135081   82.529234      0              3985041.4      1.1971759e-13  0              2.9928603    
    700000   20940          200            200            0.002000399   -0.0012479768   0              0.0072491738   48.464453      0              2340175        1.1971759e-13  0              2.9937383    
    800000   20940          200            200            0.0018802005  -0.0012427655   0              0.0068833668   2.1958755      0              106030.97      1.1971759e-13  0              2.9939044    
    900000   20940          200            200            0.0019323719  -0.0012495703   0              0.007046686    0.19811703     0              9566.3624      1.1971759e-13  0              2.9938346    
   1000000   20940          200            200            0.0019669108  -0.0012534769   0              0.0071542092   0.11897644     0              5744.9466      1.1971759e-13  0              2.9937876    
   1100000   20940          200            200            0.0019710071  -0.0012539529   0              0.0071669742   0.0025997561   0              125.53292      1.1971759e-13  0              2.9937817    
   1200000   20940          200            200            0.0019676573  -0.0012535937   0              0.0071565656   0.00090103761  0              43.507881      1.1971759e-13  0              2.9937861    
   1300000   20940          200            200            0.0019660311  -0.0012534138   0              0.0071515071   0.0002725793   0              13.161879      1.1971759e-13  0              2.9937883    
   1400000   20940          200            200            0.0019659587  -0.0012534044   0              0.0071512805   1.6155208e-06  0              0.078007718    1.1971759e-13  0              2.9937885    
   1500000   20940          200            200            0.0019661542  -0.0012534256   0              0.0071518881   3.2854603e-06  0              0.15864312     1.1971759e-13  0              2.9937882    
   1600000   20940          200            200            0.0019662268  -0.0012534337   0              0.007152114    5.683738e-07   0              0.027444737    1.1971759e-13  0              2.9937881    
   1700000   20940          200            200            0.0019662238  -0.0012534334   0              0.0071521049   2.0501123e-12  0              9.8992585e-08  1.1971759e-13  0              2.9937881    
   1800000   20940          200            200            0.0019662131  -0.0012534323   0              0.0071520716   1.0382341e-08  0              0.00050132608  1.1971759e-13  0              2.9937881    
   1900000   20940          200            200            0.0019662101  -0.0012534319   0              0.0071520621   1.0611181e-09  0              5.1237595e-05  1.1971759e-13  0              2.9937881    
   2000000   20940          200            200            0.0019662105  -0.001253432    0              0.0071520635   1.0453485e-11  0              5.0476139e-07  1.1971759e-13  0              2.9937881    
   2100000   20940          200            200            0.0019662111  -0.001253432    0              0.0071520653   2.9401068e-11  0              1.4196724e-06  1.1971759e-13  0              2.9937881    
   2200000   20940          200            200            0.0019662112  -0.0012534321   0              0.0071520656   1.7135124e-12  0              8.2739379e-08  1.1971759e-13  0              2.9937881    
   2300000   20940          200            200            0.0019662112  -0.0012534321   0              0.0071520655   9.5262937e-14  0              4.5999063e-09  1.1971759e-13  0              2.9937881    
   2400000   20940          200            200            0.0019662111  -0.0012534321   0              0.0071520654   7.576621e-14   0              3.6584791e-09  1.1971759e-13  0              2.9937881    
   2500000   20940          200            200            0.0019662111  -0.0012534321   0              0.0071520654   2.2466941e-15  0              1.0848482e-10  1.1971759e-13  0              2.9937881    
   2600000   20940          200            200            0.0019662111  -0.0012534321   0              0.0071520654   4.6250484e-16  0              2.2332703e-11  1.1971759e-13  0              2.9937881    
   2700000   20940          200            200            0.0019662111  -0.0012534321   0              0.0071520654   1.4481181e-16  0              6.9924441e-12  1.1971759e-13  0              2.9937881    
   2800000   20940          200            200            0.0019662111  -0.0012534321   0              0.0071520654   9.5283879e-19  0              4.6009175e-14  1.1971759e-13  0              2.9937881    
   2900000   20940          200            200            0.0019662111  -0.0012534321   0              0.0071520654   6.1842875e-18  0              2.9861711e-13  1.1971759e-13  0              2.9937881    
   3000000   20940          200            200            0.0019662111  -0.0012534321   0              0.0071520654   1.1255077e-19  0              5.434674e-15   1.1971759e-13  0              2.9937881    
Loop time of 731.974 on 2 procs for 3000000 steps with 5001 atoms

Performance: 3541107.549 ns/day, 0.000 hours/ns, 4098.504 timesteps/s
100.0% CPU use with 2 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 157.82     | 159.6      | 161.38     |  14.1 | 21.80
Neigh   | 25.915     | 25.919     | 25.923     |   0.1 |  3.54
Comm    | 57.548     | 59.374     | 61.2       |  23.7 |  8.11
Output  | 0.64047    | 0.64048    | 0.6405     |   0.0 |  0.09
Modify  | 428.66     | 428.66     | 428.67     |   0.0 | 58.56
Other   |            | 57.78      |            |       |  7.89

Nlocal:         2500.5 ave        2501 max        2500 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Nghost:            2.5 ave           3 max           2 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Neighs:         1227.5 ave        1228 max        1227 min
Histogram: 1 0 0 0 0 0 0 0 0 1

Total # of neighbors = 2455
Ave neighs/atom = 0.49090182
Neighbor list builds = 166
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 99

#variable lat0 equal 1                    #
variable lat1 equal 3+((300)*0.01)+(v_ind*0.01)        # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 1000*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 6.99                                                               
Lattice spacing in x,y,z = 6.99 6.99 6.99

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -10485 ${n1e1} -100 100 -100 100 units box
region box block -10485 10485 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -10485 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -10485 10485 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-10485 -100 -100) to (10485 100 100)
  2 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 3000 atoms
  using lattice units in orthogonal box = (-10485 -100 -100) to (10485 100 100)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 3000 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 2001 atoms
  using lattice units in orthogonal box = (-10485 -100 -100) to (10485 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  3000 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  3000 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  2001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  2001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
3000 atoms in group substrate
group slider1 region slider1
2001 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 2001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_99_*.dump id type diameter mass xu yu zu fx fy fz
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 13530 130 130
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 483.7 | 483.7 | 483.7 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   20970          200            200            0              0              0              0              0              0              0              1.1971759e-13  0              6            
    100000   20970          200            200            0.0019204056   1.4527639e-40  0              0.0057612169   1153470.8      0              5.5696977e+10  1.1971759e-13  0              3.332766     
    200000   20970          200            200            0.00064560492 -3.8521375e-35  0              0.0019368147   258760.6       0              1.2494623e+10  1.1971759e-13  0              3.0846521    
    300000   20970          200            200           -1.1585432e-05 -2.3112814e-35  0             -3.4756295e-05  187.5184       0              9054592.3      1.1971759e-13  0              3.0433815    
    400000   20970          200            200           -1.9682617e-05  1.0557763e-41  0             -5.904785e-05   568.24597      0              27438564       1.1971759e-13  0              3.0050052    
    500000   20970          200            200            0.0010062654  -0.003352713    0              0.006371509    2762.5021      0              1.3339134e+08  1.1971759e-13  0              2.9942369    
    600000   20970          200            200            0.00088781862 -0.0021416235   0              0.0048050793   5.7411338      0              277218.81      1.1971759e-13  0              2.9950477    
    700000   20970          200            200            0.0016197352  -0.0031304421   0              0.0079896477   9.7900538      0              472726.66      1.1971759e-13  0              2.9936184    
    800000   20970          200            200            0.0013035656  -0.0029251771   0              0.006835874    1.1721165      0              56597.311      1.1971759e-13  0              2.9940894    
    900000   20970          200            200            0.0014234987  -0.0029875023   0              0.0072579984   0.12424389     0              5999.2927      1.1971759e-13  0              2.993913     
   1000000   20970          200            200            0.0013761646  -0.002970506    0              0.0070989997   0.011868887    0              573.10609      1.1971759e-13  0              2.993979     
   1100000   20970          200            200            0.0013937857  -0.0029770493   0              0.0071584064   0.0010561565   0              50.998019      1.1971759e-13  0              2.9939542    
   1200000   20970          200            200            0.0013872032  -0.0029746313   0              0.0071362409   8.2976717e-05  0              4.0066487      1.1971759e-13  0              2.9939635    
   1300000   20970          200            200            0.0013896454  -0.0029755338   0              0.00714447     5.2915936e-06  0              0.25551212     1.1971759e-13  0              2.99396      
   1400000   20970          200            200            0.0013887419  -0.0029752      0              0.0071414255   2.1028216e-07  0              0.010153773    1.1971759e-13  0              2.9939613    
   1500000   20970          200            200            0.0013890747  -0.0029753232   0              0.0071425474   6.9345894e-10  0              3.348465e-05   1.1971759e-13  0              2.9939608    
   1600000   20970          200            200            0.0013889525  -0.0029752779   0              0.0071421355   1.7980347e-09  0              8.682066e-05   1.1971759e-13  0              2.993961     
   1700000   20970          200            200            0.0013889972  -0.0029752945   0              0.0071422862   1.1962693e-09  0              5.7763564e-05  1.1971759e-13  0              2.9939609    
   1800000   20970          200            200            0.001388981   -0.0029752884   0              0.0071422313   3.8489875e-10  0              1.8585383e-05  1.1971759e-13  0              2.993961     
   1900000   20970          200            200            0.0013889869  -0.0029752906   0              0.0071422512   9.4295828e-11  0              4.553208e-06   1.1971759e-13  0              2.993961     
   2000000   20970          200            200            0.0013889847  -0.0029752898   0              0.007142244    1.9984273e-11  0              9.6496904e-07  1.1971759e-13  0              2.993961     
   2100000   20970          200            200            0.0013889855  -0.0029752901   0              0.0071422466   3.8684378e-12  0              1.8679302e-07  1.1971759e-13  0              2.993961     
   2200000   20970          200            200            0.0013889852  -0.00297529     0              0.0071422457   7.0362294e-13  0              3.3975434e-08  1.1971759e-13  0              2.993961     
   2300000   20970          200            200            0.0013889853  -0.0029752901   0              0.007142246    1.2171361e-13  0              5.8771144e-09  1.1971759e-13  0              2.993961     
   2400000   20970          200            200            0.0013889853  -0.00297529     0              0.0071422459   2.0159227e-14  0              9.7341692e-10  1.1971759e-13  0              2.993961     
   2500000   20970          200            200            0.0013889853  -0.0029752901   0              0.0071422459   3.2504554e-15  0              1.5695286e-10  1.1971759e-13  0              2.993961     
   2600000   20970          200            200            0.0013889853  -0.00297529     0              0.0071422459   5.1548669e-16  0              2.4891007e-11  1.1971759e-13  0              2.993961     
   2700000   20970          200            200            0.0013889853  -0.00297529     0              0.0071422459   1.243221e-16   0              6.0030694e-12  1.1971759e-13  0              2.993961     
   2800000   20970          200            200            0.0013889853  -0.00297529     0              0.0071422459   2.4114415e-17  0              1.1643988e-12  1.1971759e-13  0              2.993961     
   2900000   20970          200            200            0.0013889853  -0.00297529     0              0.0071422459   2.5285732e-18  0              1.2209575e-13  1.1971759e-13  0              2.993961     
   3000000   20970          200            200            0.0013889853  -0.00297529     0              0.0071422459   8.6707075e-19  0              4.1867743e-14  1.1971759e-13  0              2.993961     
Loop time of 727.721 on 2 procs for 3000000 steps with 5001 atoms

Performance: 3561804.729 ns/day, 0.000 hours/ns, 4122.459 timesteps/s
99.9% CPU use with 2 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 156.17     | 158.73     | 161.29     |  20.3 | 21.81
Neigh   | 25.511     | 25.513     | 25.515     |   0.0 |  3.51
Comm    | 56.971     | 59.539     | 62.108     |  33.3 |  8.18
Output  | 0.64339    | 0.6434     | 0.64341    |   0.0 |  0.09
Modify  | 426.51     | 426.55     | 426.59     |   0.2 | 58.61
Other   |            | 56.75      |            |       |  7.80

Nlocal:         2500.5 ave        2501 max        2500 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Nghost:            2.5 ave           3 max           2 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Neighs:         1224.5 ave        1225 max        1224 min
Histogram: 1 0 0 0 0 0 0 0 0 1

Total # of neighbors = 2449
Ave neighs/atom = 0.48970206
Neighbor list builds = 166
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop
Total wall time: 20:17:37

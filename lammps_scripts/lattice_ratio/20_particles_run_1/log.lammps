LAMMPS (23 Jun 2022 - Update 1)
  using 1 OpenMP thread(s) per MPI task
variable num index 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50

label startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 0

#variable lat0 equal 1                    #
variable lat1 equal 3+(v_ind*0.01)  # .491+(v_ind*0.001)       # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 10*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 3                                                               
Lattice spacing in x,y,z = 3 3 3

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -45 ${n1e1} -100 100 -100 100 units box
region box block -45 45 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -45 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -45 45 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-45 -100 -100) to (45 100 100)
  1 by 2 by 2 MPI processor grid
create_atoms 1 region substrate
Created 30 atoms
  using lattice units in orthogonal box = (-45 -100 -100) to (45 100 100)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 30 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 21 atoms
  using lattice units in orthogonal box = (-45 -100 -100) to (45 100 100)
  create_atoms CPU = 0.007 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  30 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  30 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  21 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  21 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
30 atoms in group substrate
group slider1 region slider1
21 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 21 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 10000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 10000 Equi_0_*.dump id type diameter mass xu yu zu fx fy fz

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 59 130 130
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 13.88 | 17.35 | 18.51 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   90             200            200            0              0              0              0              0              0              0              2.6109412e-16  0              6            
    100000   90             200            200            0.0048446229  -2.7372937e-38  0              0.014533869    12676.586      0              6.1210699e+10  2.6109412e-16  0              3.3137688    
    200000   90             200            200            0.001916883    7.1799987e-40  0              0.0057506489   3672.3809      0              1.7732613e+10  2.6109412e-16  0              3.0495596    
    300000   90             200            200            0.00053811606  4.410565e-37   0              0.0016143482   487.01184      0              2.3516059e+09  2.6109412e-16  0              3.0333358    
    400000   90             200            200            0.00037161456 -3.2694301e-37  0              0.0011148437   259.67758      0              1.2538901e+09  2.6109412e-16  0              3.0006545    
    500000   90             200            200           -0.00011620589  1.4896396e-39  0             -0.00034861768  37.529584      0              1.8121693e+08  2.6109412e-16  0              3.0007132    
    600000   90             200            200            0.014933504    5.3781765e-37  0              0.044800512    2.169217       0              10474372       2.6109412e-16  0              2.9988249    
    700000   90             200            200            0.0082917729   1.0638897e-37  0              0.024875319    0.76870077     0              3711780.9      2.6109412e-16  0              2.9992063    
    800000   90             200            200            0.00649247    -1.6573933e-39  0              0.01947741     0.14707869     0              710190.37      2.6109412e-16  0              2.9993253    
    900000   90             200            200            0.0062175439  -3.1191839e-38  0              0.018652632    0.0084089664   0              40603.889      2.6109412e-16  0              2.9993441    
   1000000   90             200            200            0.0060010517  -2.5008165e-37  0              0.018003155    2.1144546e-05  0              102.09944      2.6109412e-16  0              2.9993593    
   1100000   90             200            200            0.0058881202   2.1593785e-37  0              0.017664361    9.2548923e-05  0              446.88563      2.6109412e-16  0              2.9993673    
   1200000   90             200            200            0.0058450162  -5.7431596e-38  0              0.017535049    4.5736881e-05  0              220.84703      2.6109412e-16  0              2.9993704    
   1300000   90             200            200            0.0058327694  -1.1210327e-37  0              0.017498308    9.0701767e-06  0              43.796637      2.6109412e-16  0              2.9993713    
   1400000   90             200            200            0.0058307853   1.3444812e-37  0              0.017492356    1.0112328e-06  0              4.8828811      2.6109412e-16  0              2.9993715    
   1500000   90             200            200            0.0058311765   1.0707519e-37  0              0.01749353     5.4658447e-08  0              0.26392608     2.6109412e-16  0              2.9993714    
   1600000   90             200            200            0.0058316945   2.4923852e-38  0              0.017495084    1.6990573e-10  0              0.00082041398  2.6109412e-16  0              2.9993714    
   1700000   90             200            200            0.0058319718   1.6190424e-37  0              0.017495916    5.4357809e-10  0              0.0026247441   2.6109412e-16  0              2.9993714    
   1800000   90             200            200            0.0058320786  -2.4150445e-39  0              0.017496236    2.7650472e-10  0              0.0013351423   2.6109412e-16  0              2.9993714    
   1900000   90             200            200            0.0058321092  -2.3880373e-39  0              0.017496327    5.5480824e-11  0              0.00026789704  2.6109412e-16  0              2.9993714    
   2000000   90             200            200            0.0058321142  -8.4533991e-38  0              0.017496343    6.2491814e-12  0              3.0175061e-05  2.6109412e-16  0              2.9993714    
   2100000   90             200            200            0.0058321133  -2.9724833e-38  0              0.01749634     3.4365306e-13  0              1.6593777e-06  2.6109412e-16  0              2.9993714    
   2200000   90             200            200            0.005832112   -2.3065371e-39  0              0.017496336    1.2680472e-15  0              6.122946e-09   2.6109412e-16  0              2.9993714    
   2300000   90             200            200            0.0058321113   5.2502919e-38  0              0.017496334    3.2034064e-15  0              1.5468103e-08  2.6109412e-16  0              2.9993714    
   2400000   90             200            200            0.0058321111   2.7165856e-37  0              0.017496333    1.6746994e-15  0              8.0865242e-09  2.6109412e-16  0              2.9993714    
   2500000   90             200            200            0.005832111   -1.2548323e-37  0              0.017496333    3.403734e-16   0              1.6435413e-09  2.6109412e-16  0              2.9993714    
   2600000   90             200            200            0.005832111   -7.0673304e-38  0              0.017496333    3.7381484e-17  0              1.8050181e-10  2.6109412e-16  0              2.9993714    
   2700000   90             200            200            0.005832111   -2.9558719e-38  0              0.017496333    3.3186033e-18  0              1.6024347e-11  2.6109412e-16  0              2.9993714    
   2800000   90             200            200            0.005832111    1.2112004e-37  0              0.017496333    1.5948212e-19  0              7.7008207e-13  2.6109412e-16  0              2.9993714    
   2900000   90             200            200            0.005832111    1.158442e-38   0              0.017496333    1.3742991e-19  0              6.6359986e-13  2.6109412e-16  0              2.9993714    
   3000000   90             200            200            0.005832111   -1.5778028e-38  0              0.017496333    6.2974931e-20  0              3.0408341e-13  2.6109412e-16  0              2.9993714    
Loop time of 74.1511 on 4 procs for 3000000 steps with 51 atoms

Performance: 34955659.596 ns/day, 0.000 hours/ns, 40457.939 timesteps/s
99.6% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 0.24351    | 2.7011     | 9.8433     | 250.9 |  3.64
Neigh   | 0.075477   | 0.077862   | 0.081706   |   0.9 |  0.11
Comm    | 31.111     | 37.806     | 45.703     |  86.6 | 50.98
Output  | 1.0032     | 1.0455     | 1.1682     |   6.9 |  1.41
Modify  | 16.18      | 23.099     | 31.827     | 144.0 | 31.15
Other   |            | 9.422      |            |       | 12.71

Nlocal:          12.75 ave          51 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1
Nghost:          41.25 ave          54 max           3 min
Histogram: 1 0 0 0 0 0 0 0 0 3
Neighs:          17.75 ave          71 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1

Total # of neighbors = 71
Ave neighs/atom = 1.3921569
Neighbor list builds = 174
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 1

#variable lat0 equal 1                    #
variable lat1 equal 3+(v_ind*0.01)  # .491+(v_ind*0.001)       # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 10*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 3.01                                                               
Lattice spacing in x,y,z = 3.01 3.01 3.01

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -45.15 ${n1e1} -100 100 -100 100 units box
region box block -45.15 45.15 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -45.15 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -45.15 45.15 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-45.15 -100 -100) to (45.15 100 100)
  1 by 2 by 2 MPI processor grid
create_atoms 1 region substrate
Created 30 atoms
  using lattice units in orthogonal box = (-45.15 -100 -100) to (45.15 100 100)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 30 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 21 atoms
  using lattice units in orthogonal box = (-45.15 -100 -100) to (45.15 100 100)
  create_atoms CPU = 0.003 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  30 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  30 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  21 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  21 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
30 atoms in group substrate
group slider1 region slider1
21 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 21 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 10000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 10000 Equi_1_*.dump id type diameter mass xu yu zu fx fy fz

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 59 130 130
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 13.88 | 17.35 | 18.51 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   90.3           200            200            0              0              0              0              0              0              0              2.6109412e-16  0              6            
    100000   90.3           200            200            0.0048269711   2.7320842e-37  0              0.014480913    12671.636      0              6.1186795e+10  2.6109412e-16  0              3.3135597    
    200000   90.3           200            200            0.0019100511  -7.6334048e-37  0              0.0057301534   3671.7818      0              1.772972e+10   2.6109412e-16  0              3.0489354    
    300000   90.3           200            200            0.00053788117 -1.0758027e-37  0              0.0016136435   489.59982      0              2.3641023e+09  2.6109412e-16  0              3.0325923    
    400000   90.3           200            200            0.0003674763  -2.1659866e-37  0              0.0011024289   256.13343      0              1.2367767e+09  2.6109412e-16  0              3.0002731    
    500000   90.3           200            200            0.014358976    0.0021740382   0              0.040902888    50.209416      0              2.424433e+08   2.6109412e-16  0              2.9983512    
    600000   90.3           200            200            0.00050005398  1.5442138e-05  0              0.0014847198   0.87890631     0              4243924        2.6109412e-16  0              2.9996817    
    700000   90.3           200            200            0.0039754278   0.00022807379  0              0.01169821     0.59900929     0              2892401.5      2.6109412e-16  0              2.9991243    
    800000   90.3           200            200            0.0049301237   0.00031248031  0              0.014477891    0.001726369    0              8336.0182      2.6109412e-16  0              2.9990245    
    900000   90.3           200            200            0.0056063843   0.00032555628  0              0.016493597    0.0067638092   0              32660.014      2.6109412e-16  0              2.9989581    
   1000000   90.3           200            200            0.0059111389   0.00032874024  0              0.017404677    0.0031784207   0              15347.456      2.6109412e-16  0              2.9989294    
   1100000   90.3           200            200            0.0059612866   0.00032929768  0              0.017554562    0.00016818623  0              812.1111       2.6109412e-16  0              2.9989248    
   1200000   90.3           200            200            0.0059399465   0.00032895779  0              0.017490882    1.7995455e-06  0              8.6893613      2.6109412e-16  0              2.9989268    
   1300000   90.3           200            200            0.0059251876   0.0003288175   0              0.017446745    5.6382431e-06  0              27.225058      2.6109412e-16  0              2.9989282    
   1400000   90.3           200            200            0.0059208282   0.00032877874  0              0.017433706    9.9871205e-07  0              4.8224231      2.6109412e-16  0              2.9989286    
   1500000   90.3           200            200            0.0059206486   0.00032877729  0              0.017433169    3.1304322e-08  0              0.15115737     2.6109412e-16  0              2.9989286    
   1600000   90.3           200            200            0.0059211486   0.00032878186  0              0.017434664    2.2088248e-09  0              0.010665624    2.6109412e-16  0              2.9989286    
   1700000   90.3           200            200            0.0059214221   0.00032878433  0              0.017435482    2.2434864e-09  0              0.010832993    2.6109412e-16  0              2.9989285    
   1800000   90.3           200            200            0.0059214908   0.00032878495  0              0.017435688    2.9767284e-10  0              0.0014373556   2.6109412e-16  0              2.9989285    
   1900000   90.3           200            200            0.0059214881   0.00032878492  0              0.017435679    4.8082469e-12  0              2.3217303e-05  2.6109412e-16  0              2.9989285    
   2000000   90.3           200            200            0.0059214774   0.00032878482  0              0.017435647    1.5400989e-12  0              7.4365865e-06  2.6109412e-16  0              2.9989285    
   2100000   90.3           200            200            0.0059214725   0.00032878478  0              0.017435633    8.3757259e-13  0              4.0443383e-06  2.6109412e-16  0              2.9989285    
   2200000   90.3           200            200            0.0059214714   0.00032878477  0              0.01743563     8.3069961e-14  0              4.0111511e-07  2.6109412e-16  0              2.9989285    
   2300000   90.3           200            200            0.0059214716   0.00032878477  0              0.01743563     3.9201879e-16  0              1.8929184e-09  2.6109412e-16  0              2.9989285    
   2400000   90.3           200            200            0.0059214718   0.00032878477  0              0.017435631    8.3900006e-16  0              4.051231e-09   2.6109412e-16  0              2.9989285    
   2500000   90.3           200            200            0.0059214719   0.00032878477  0              0.017435631    2.9699692e-16  0              1.4340918e-09  2.6109412e-16  0              2.9989285    
   2600000   90.3           200            200            0.0059214719   0.00032878477  0              0.017435631    2.0821827e-17  0              1.0054115e-10  2.6109412e-16  0              2.9989285    
   2700000   90.3           200            200            0.0059214719   0.00032878477  0              0.017435631    1.2597515e-20  0              6.0828892e-14  2.6109412e-16  0              2.9989285    
   2800000   90.3           200            200            0.0059214719   0.00032878477  0              0.017435631    8.7235016e-20  0              4.2122667e-13  2.6109412e-16  0              2.9989285    
   2900000   90.3           200            200            0.0059214719   0.00032878477  0              0.017435631    1.4831615e-20  0              7.1616561e-14  2.6109412e-16  0              2.9989285    
   3000000   90.3           200            200            0.0059214719   0.00032878477  0              0.017435631    3.1454385e-20  0              1.5188197e-13  2.6109412e-16  0              2.9989285    
Loop time of 73.1226 on 4 procs for 3000000 steps with 51 atoms

Performance: 35447303.325 ns/day, 0.000 hours/ns, 41026.971 timesteps/s
99.8% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 0.23734    | 2.4066     | 8.6711     | 233.2 |  3.29
Neigh   | 0.070519   | 0.07269    | 0.076151   |   0.9 |  0.10
Comm    | 31.096     | 38.024     | 45.691     |  87.4 | 52.00
Output  | 0.51615    | 0.55845    | 0.68252    |   9.6 |  0.76
Modify  | 15.936     | 22.749     | 31.414     | 144.6 | 31.11
Other   |            | 9.312      |            |       | 12.73

Nlocal:          12.75 ave          51 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1
Nghost:          41.25 ave          54 max           3 min
Histogram: 1 0 0 0 0 0 0 0 0 3
Neighs:          17.75 ave          71 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1

Total # of neighbors = 71
Ave neighs/atom = 1.3921569
Neighbor list builds = 174
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 2

#variable lat0 equal 1                    #
variable lat1 equal 3+(v_ind*0.01)  # .491+(v_ind*0.001)       # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 10*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 3.02                                                               
Lattice spacing in x,y,z = 3.02 3.02 3.02

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -45.3 ${n1e1} -100 100 -100 100 units box
region box block -45.3 45.3 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -45.3 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -45.3 45.3 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-45.3 -100 -100) to (45.3 100 100)
  1 by 2 by 2 MPI processor grid
create_atoms 1 region substrate
Created 30 atoms
  using lattice units in orthogonal box = (-45.3 -100 -100) to (45.3 100 100)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 30 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 21 atoms
  using lattice units in orthogonal box = (-45.3 -100 -100) to (45.3 100 100)
  create_atoms CPU = 0.004 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  30 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  30 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  21 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  21 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
30 atoms in group substrate
group slider1 region slider1
21 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 21 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 10000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 10000 Equi_2_*.dump id type diameter mass xu yu zu fx fy fz

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 59 130 130
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 13.88 | 17.35 | 18.51 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   90.6           200            200            0              0              0              0              0              0              0              2.6109412e-16  0              6            
    100000   90.6           200            200            0.0048061602   2.7226465e-38  0              0.014418481    12655.027      0              6.1106596e+10  2.6109412e-16  0              3.3133641    
    200000   90.6           200            200            0.0018962106  -3.2632495e-36  0              0.0056886318   3650.7596      0              1.7628211e+10  2.6109412e-16  0              3.048619     
    300000   90.6           200            200            0.00051363357  1.7464809e-39  0              0.0015409007   454.82115      0              2.1961686e+09  2.6109412e-16  0              3.0330815    
    400000   90.6           200            200            0.00026828373 -4.2236319e-37  0              0.00080485118  146.1394       0              7.0565485e+08  2.6109412e-16  0              3.0048008    
    500000   90.6           200            200           -5.046201e-05   6.9793248e-39  0             -0.00015138603  6.6804982      0              32257735       2.6109412e-16  0              3.0011558    
    600000   90.6           200            200            0.003195007    8.2769162e-05  0              0.0095022517   5.9702074      0              28827995       2.6109412e-16  0              2.9988863    
    700000   90.6           200            200            0.0077466843   0.00034232168  0              0.022897731    0.3348424      0              1616834.1      2.6109412e-16  0              2.9982576    
    800000   90.6           200            200            0.0055282021   0.00028040432  0              0.016304202    0.11404249     0              550670.38      2.6109412e-16  0              2.9985353    
    900000   90.6           200            200            0.0058182638   0.00028369989  0              0.017171092    0.018648283    0              90045.882      2.6109412e-16  0              2.9984953    
   1000000   90.6           200            200            0.0059739974   0.00028511529  0              0.017636877    0.00086532386  0              4178.3392      2.6109412e-16  0              2.9984752    
   1100000   90.6           200            200            0.0058480563   0.00028396038  0              0.017260209    6.8469984e-06  0              33.061705      2.6109412e-16  0              2.9984917    
   1200000   90.6           200            200            0.0058956034   0.00028441285  0              0.017402397    2.9110303e-05  0              140.56324      2.6109412e-16  0              2.9984854    
   1300000   90.6           200            200            0.0058868667   0.00028432957  0              0.017376271    6.5885361e-06  0              31.813683      2.6109412e-16  0              2.9984866    
   1400000   90.6           200            200            0.0058851607   0.00028431422  0              0.017371168    4.3556701e-07  0              2.1031972      2.6109412e-16  0              2.9984868    
   1500000   90.6           200            200            0.0058872669   0.00028433384  0              0.017377467    1.0160093e-10  0              0.00049059455  2.6109412e-16  0              2.9984865    
   1600000   90.6           200            200            0.0058863573   0.0002843253   0              0.017374747    7.0289315e-09  0              0.033940194    2.6109412e-16  0              2.9984866    
   1700000   90.6           200            200            0.0058865649   0.00028432727  0              0.017375367    2.1864638e-09  0              0.010557651    2.6109412e-16  0              2.9984866    
   1800000   90.6           200            200            0.0058865756   0.00028432736  0              0.017375399    1.9531239e-10  0              0.00094309363  2.6109412e-16  0              2.9984866    
   1900000   90.6           200            200            0.0058865417   0.00028432705  0              0.017375298    1.5394474e-12  0              7.4334405e-06  2.6109412e-16  0              2.9984866    
   2000000   90.6           200            200            0.0058865586   0.00028432721  0              0.017375349    1.486166e-12   0              7.1761636e-06  2.6109412e-16  0              2.9984866    
   2100000   90.6           200            200            0.005886554    0.00028432716  0              0.017375335    6.8549072e-13  0              3.3099893e-06  2.6109412e-16  0              2.9984866    
   2200000   90.6           200            200            0.0058865542   0.00028432716  0              0.017375335    8.034006e-14   0              3.879334e-07   2.6109412e-16  0              2.9984866    
   2300000   90.6           200            200            0.0058865547   0.00028432717  0              0.017375337    1.7060816e-15  0              8.2380573e-09  2.6109412e-16  0              2.9984866    
   2400000   90.6           200            200            0.0058865544   0.00028432717  0              0.017375336    2.5935519e-16  0              1.2523334e-09  2.6109412e-16  0              2.9984866    
   2500000   90.6           200            200            0.0058865545   0.00028432717  0              0.017375336    2.0339292e-16  0              9.8211161e-10  2.6109412e-16  0              2.9984866    
   2600000   90.6           200            200            0.0058865545   0.00028432717  0              0.017375336    3.0838374e-17  0              1.4890747e-10  2.6109412e-16  0              2.9984866    
   2700000   90.6           200            200            0.0058865545   0.00028432717  0              0.017375336    2.6492447e-19  0              1.2792255e-12  2.6109412e-16  0              2.9984866    
   2800000   90.6           200            200            0.0058865545   0.00028432717  0              0.017375336    1.7133153e-19  0              8.2729862e-13  2.6109412e-16  0              2.9984866    
   2900000   90.6           200            200            0.0058865545   0.00028432717  0              0.017375336    6.9466511e-21  0              3.3542892e-14  2.6109412e-16  0              2.9984866    
   3000000   90.6           200            200            0.0058865545   0.00028432717  0              0.017375336    6.674713e-20   0              3.22298e-13    2.6109412e-16  0              2.9984866    
Loop time of 73.256 on 4 procs for 3000000 steps with 51 atoms

Performance: 35382757.196 ns/day, 0.000 hours/ns, 40952.265 timesteps/s
99.8% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 0.24721    | 2.2034     | 7.8654     | 220.2 |  3.01
Neigh   | 0.07206    | 0.074173   | 0.077485   |   0.8 |  0.10
Comm    | 31.015     | 38.351     | 45.9       |  90.0 | 52.35
Output  | 0.45055    | 0.49265    | 0.61625    |  10.2 |  0.67
Modify  | 15.928     | 22.858     | 31.71      | 146.4 | 31.20
Other   |            | 9.276      |            |       | 12.66

Nlocal:          12.75 ave          51 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1
Nghost:          41.25 ave          54 max           3 min
Histogram: 1 0 0 0 0 0 0 0 0 3
Neighs:          17.75 ave          71 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1

Total # of neighbors = 71
Ave neighs/atom = 1.3921569
Neighbor list builds = 172
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 3

#variable lat0 equal 1                    #
variable lat1 equal 3+(v_ind*0.01)  # .491+(v_ind*0.001)       # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 10*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 3.03                                                               
Lattice spacing in x,y,z = 3.03 3.03 3.03

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -45.45 ${n1e1} -100 100 -100 100 units box
region box block -45.45 45.45 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -45.45 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -45.45 45.45 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-45.45 -100 -100) to (45.45 100 100)
  1 by 2 by 2 MPI processor grid
create_atoms 1 region substrate
Created 30 atoms
  using lattice units in orthogonal box = (-45.45 -100 -100) to (45.45 100 100)
  create_atoms CPU = 0.000 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 30 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 21 atoms
  using lattice units in orthogonal box = (-45.45 -100 -100) to (45.45 100 100)
  create_atoms CPU = 0.004 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  30 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  30 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  21 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  21 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
30 atoms in group substrate
group slider1 region slider1
21 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 21 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 10000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 10000 Equi_3_*.dump id type diameter mass xu yu zu fx fy fz

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 59 130 130
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 13.88 | 17.35 | 18.51 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   90.9           200            200            0              0              0              0              0              0              0              2.6109412e-16  0              6            
    100000   90.9           200            200            0.0047822126   1.622579e-40   0              0.014346638    12624.907      0              6.0961156e+10  2.6109412e-16  0              3.3138721    
    200000   90.9           200            200            0.0018685956  -6.4410789e-37  0              0.0056057868   3587.6159      0              1.7323313e+10  2.6109412e-16  0              3.0506934    
    300000   90.9           200            200            0.00046299543  6.5629321e-37  0              0.0013889863   381.84018      0              1.8437696e+09  2.6109412e-16  0              3.0356531    
    400000   90.9           200            200            0.00015407591  4.4188755e-37  0              0.00046222772  52.564514      0              2.5381522e+08  2.6109412e-16  0              3.0086569    
    500000   90.9           200            200            0.0028695832   3.6803377e-05  0              0.0085719463   46.035299      0              2.2228798e+08  2.6109412e-16  0              2.9987269    
    600000   90.9           200            200            0.0092777651   0.00046601253  0              0.027367283    4.3307525      0              20911654       2.6109412e-16  0              2.9976599    
    700000   90.9           200            200            0.0042282258   0.00018845251  0              0.012496225    0.16238946     0              784120.58      2.6109412e-16  0              2.9984227    
    800000   90.9           200            200            0.0054432362   0.00024993409  0              0.016079774    0.083381353    0              402618.71      2.6109412e-16  0              2.9982138    
    900000   90.9           200            200            0.0059713081   0.00025572238  0              0.017658202    0.014147927    0              68315.278      2.6109412e-16  0              2.99813      
   1000000   90.9           200            200            0.0059491273   0.0002554943   0              0.017591888    1.7743773e-07  0              0.85678328     2.6109412e-16  0              2.9981339    
   1100000   90.9           200            200            0.0058723989   0.0002547576   0              0.017362439    0.00026123609  0              1261.4156      2.6109412e-16  0              2.998146     
   1200000   90.9           200            200            0.0058497057   0.00025453515  0              0.017294582    2.9494231e-05  0              142.41708      2.6109412e-16  0              2.9981495    
   1300000   90.9           200            200            0.0058523417   0.00025456268  0              0.017302463    1.1520539e-07  0              0.55628558     2.6109412e-16  0              2.9981491    
   1400000   90.9           200            200            0.0058563091   0.00025460226  0              0.017314325    7.2307776e-07  0              3.4914837      2.6109412e-16  0              2.9981485    
   1500000   90.9           200            200            0.0058573017   0.00025461199  0              0.017317293    5.9138253e-08  0              0.28555746     2.6109412e-16  0              2.9981483    
   1600000   90.9           200            200            0.0058571023   0.00025460995  0              0.017316697    1.0482692e-09  0              0.0050617167   2.6109412e-16  0              2.9981484    
   1700000   90.9           200            200            0.0058569002   0.00025460794  0              0.017316093    1.928201e-09   0              0.0093105926   2.6109412e-16  0              2.9981484    
   1800000   90.9           200            200            0.0058568585   0.00025460753  0              0.017315968    1.1127413e-10  0              0.00053730297  2.6109412e-16  0              2.9981484    
   1900000   90.9           200            200            0.0058568716   0.00025460767  0              0.017316007    5.5456796e-12  0              2.6778102e-05  2.6109412e-16  0              2.9981484    
   2000000   90.9           200            200            0.0058568817   0.00025460777  0              0.017316037    4.9641508e-12  0              2.3970108e-05  2.6109412e-16  0              2.9981484    
   2100000   90.9           200            200            0.0058568834   0.00025460778  0              0.017316042    1.9252986e-13  0              9.2965779e-07  2.6109412e-16  0              2.9981484    
   2200000   90.9           200            200            0.0058568826   0.00025460778  0              0.01731604     2.3221109e-14  0              1.1212643e-07  2.6109412e-16  0              2.9981484    
   2300000   90.9           200            200            0.0058568821   0.00025460777  0              0.017316039    1.235214e-14   0              5.9644063e-08  2.6109412e-16  0              2.9981484    
   2400000   90.9           200            200            0.005856882    0.00025460777  0              0.017316038    2.9378553e-16  0              1.4185852e-09  2.6109412e-16  0              2.9981484    
   2500000   90.9           200            200            0.0058568821   0.00025460777  0              0.017316038    8.4017706e-17  0              4.0569143e-10  2.6109412e-16  0              2.9981484    
   2600000   90.9           200            200            0.0058568821   0.00025460777  0              0.017316039    2.9473571e-17  0              1.4231732e-10  2.6109412e-16  0              2.9981484    
   2700000   90.9           200            200            0.0058568821   0.00025460777  0              0.017316039    1.2948679e-18  0              6.2524535e-12  2.6109412e-16  0              2.9981484    
   2800000   90.9           200            200            0.0058568821   0.00025460777  0              0.017316039    3.9216362e-19  0              1.8936178e-12  2.6109412e-16  0              2.9981484    
   2900000   90.9           200            200            0.0058568821   0.00025460777  0              0.017316039    1.3781977e-20  0              6.6548236e-14  2.6109412e-16  0              2.9981484    
   3000000   90.9           200            200            0.0058568821   0.00025460777  0              0.017316039    1.2346889e-19  0              5.9618707e-13  2.6109412e-16  0              2.9981484    
Loop time of 73.5465 on 4 procs for 3000000 steps with 51 atoms

Performance: 35242999.249 ns/day, 0.000 hours/ns, 40790.508 timesteps/s
99.8% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 0.24495    | 2.0032     | 7.0762     | 207.0 |  2.72
Neigh   | 0.071892   | 0.073893   | 0.074645   |   0.4 |  0.10
Comm    | 31.449     | 38.683     | 45.977     |  89.0 | 52.60
Output  | 0.44996    | 0.4918     | 0.61449    |  10.1 |  0.67
Modify  | 16.055     | 22.959     | 31.644     | 144.6 | 31.22
Other   |            | 9.335      |            |       | 12.69

Nlocal:          12.75 ave          51 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1
Nghost:          41.25 ave          54 max           3 min
Histogram: 1 0 0 0 0 0 0 0 0 3
Neighs:          17.75 ave          71 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1

Total # of neighbors = 71
Ave neighs/atom = 1.3921569
Neighbor list builds = 172
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 4

#variable lat0 equal 1                    #
variable lat1 equal 3+(v_ind*0.01)  # .491+(v_ind*0.001)       # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 10*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 3.04                                                               
Lattice spacing in x,y,z = 3.04 3.04 3.04

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -45.6 ${n1e1} -100 100 -100 100 units box
region box block -45.6 45.6 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -45.6 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -45.6 45.6 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-45.6 -100 -100) to (45.6 100 100)
  1 by 2 by 2 MPI processor grid
create_atoms 1 region substrate
Created 30 atoms
  using lattice units in orthogonal box = (-45.6 -100 -100) to (45.6 100 100)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 30 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 21 atoms
  using lattice units in orthogonal box = (-45.6 -100 -100) to (45.6 100 100)
  create_atoms CPU = 0.003 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  30 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  30 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  21 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  21 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
30 atoms in group substrate
group slider1 region slider1
21 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 21 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 10000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 10000 Equi_4_*.dump id type diameter mass xu yu zu fx fy fz

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 59 130 130
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 13.88 | 17.35 | 18.51 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   91.2           200            200            0              0              0              0              0              0              0              2.6109412e-16  0              6            
    100000   91.2           200            200            0.0047563294   1.082095e-37   0              0.014268988    12585.032      0              6.0768617e+10  2.6109412e-16  0              3.3152512    
    200000   91.2           200            200            0.0018374604   3.2632114e-37  0              0.0055123813   3513.2462      0              1.6964208e+10  2.6109412e-16  0              3.0537019    
    300000   91.2           200            200            0.00041697502  2.1682598e-36  0              0.0012509251   319.55369      0              1.5430104e+09  2.6109412e-16  0              3.0378846    
    400000   91.2           200            200            6.2769699e-05 -1.282253e-36   0              0.0001883091   9.4611969      0              45684734       2.6109412e-16  0              3.0101461    
    500000   91.2           200            200           -3.3286079e-05 -4.283346e-36   0             -9.9858236e-05  20.760097      0              1.0024308e+08  2.6109412e-16  0              2.999789     
    600000   91.2           200            200            0.0058751988   0.00030949108  0              0.017316105    6.6529788      0              32124854       2.6109412e-16  0              2.9978479    
    700000   91.2           200            200            0.0051473725   0.00022665091  0              0.015215467    0.72743391     0              3512518        2.6109412e-16  0              2.9979927    
    800000   91.2           200            200            0.005496324    0.00022990467  0              0.016259067    0.081756585    0              394773.29      2.6109412e-16  0              2.9979253    
    900000   91.2           200            200            0.0056627993   0.00023129086  0              0.016757107    0.0065400764   0              31579.689      2.6109412e-16  0              2.9978935    
   1000000   91.2           200            200            0.0057564006   0.00023203152  0              0.01703717     0.00030963698  0              1495.1262      2.6109412e-16  0              2.9978755    
   1100000   91.2           200            200            0.0058009295   0.00023237432  0              0.017170414    1.8379393e-06  0              8.8747512      2.6109412e-16  0              2.9978669    
   1200000   91.2           200            200            0.0058195691   0.00023251621  0              0.017226191    2.0573223e-06  0              9.9340733      2.6109412e-16  0              2.9978633    
   1300000   91.2           200            200            0.00582662     0.00023256975  0              0.01724729     1.4161164e-06  0              6.8379192      2.6109412e-16  0              2.997862     
   1400000   91.2           200            200            0.0058290434   0.00023258818  0              0.017254542    4.1055958e-07  0              1.9824453      2.6109412e-16  0              2.9978615    
   1500000   91.2           200            200            0.0058297894   0.00023259388  0              0.017256774    8.3220064e-08  0              0.4018399      2.6109412e-16  0              2.9978614    
   1600000   91.2           200            200            0.0058299847   0.00023259538  0              0.017257359    1.3380653e-08  0              0.064610385    2.6109412e-16  0              2.9978613    
   1700000   91.2           200            200            0.0058300208   0.00023259567  0              0.017257467    1.7736505e-09  0              0.0085643237   2.6109412e-16  0              2.9978613    
   1800000   91.2           200            200            0.0058300197   0.00023259566  0              0.017257463    1.9300444e-10  0              0.00093194935  2.6109412e-16  0              2.9978613    
   1900000   91.2           200            200            0.005830014    0.00023259562  0              0.017257446    1.6382709e-11  0              7.910624e-05   2.6109412e-16  0              2.9978613    
   2000000   91.2           200            200            0.0058300102   0.00023259559  0              0.017257435    9.2098439e-13  0              4.447104e-06   2.6109412e-16  0              2.9978613    
   2100000   91.2           200            200            0.0058300083   0.00023259558  0              0.017257429    1.5777224e-14  0              7.6182567e-08  2.6109412e-16  0              2.9978613    
   2200000   91.2           200            200            0.0058300075   0.00023259557  0              0.017257427    1.7403628e-15  0              8.4035893e-09  2.6109412e-16  0              2.9978613    
   2300000   91.2           200            200            0.0058300072   0.00023259557  0              0.017257426    2.1388685e-15  0              1.0327831e-08  2.6109412e-16  0              2.9978613    
   2400000   91.2           200            200            0.005830007    0.00023259557  0              0.017257426    7.1490504e-16  0              3.4520206e-09  2.6109412e-16  0              2.9978613    
   2500000   91.2           200            200            0.005830007    0.00023259557  0              0.017257425    1.5601062e-16  0              7.5331943e-10  2.6109412e-16  0              2.9978613    
   2600000   91.2           200            200            0.005830007    0.00023259557  0              0.017257425    2.6979126e-17  0              1.3027254e-10  2.6109412e-16  0              2.9978613    
   2700000   91.2           200            200            0.005830007    0.00023259557  0              0.017257425    3.8182797e-18  0              1.8437106e-11  2.6109412e-16  0              2.9978613    
   2800000   91.2           200            200            0.005830007    0.00023259557  0              0.017257425    1.1892008e-19  0              5.7422252e-13  2.6109412e-16  0              2.9978613    
   2900000   91.2           200            200            0.005830007    0.00023259557  0              0.017257425    1.6986784e-19  0              8.2023099e-13  2.6109412e-16  0              2.9978613    
   3000000   91.2           200            200            0.005830007    0.00023259557  0              0.017257425    1.0278867e-19  0              4.963297e-13   2.6109412e-16  0              2.9978613    
Loop time of 73.4339 on 4 procs for 3000000 steps with 51 atoms

Performance: 35297057.215 ns/day, 0.000 hours/ns, 40853.075 timesteps/s
99.8% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 0.23681    | 2.0001     | 7.0617     | 206.7 |  2.72
Neigh   | 0.069717   | 0.071138   | 0.073756   |   0.6 |  0.10
Comm    | 31.266     | 38.747     | 46.123     |  90.6 | 52.76
Output  | 0.49993    | 0.54673    | 0.68412    |  10.7 |  0.74
Modify  | 15.758     | 22.765     | 31.657     | 147.9 | 31.00
Other   |            | 9.304      |            |       | 12.67

Nlocal:          12.75 ave          51 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1
Nghost:          41.25 ave          54 max           3 min
Histogram: 1 0 0 0 0 0 0 0 0 3
Neighs:          17.75 ave          71 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1

Total # of neighbors = 71
Ave neighs/atom = 1.3921569
Neighbor list builds = 168
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 5

#variable lat0 equal 1                    #
variable lat1 equal 3+(v_ind*0.01)  # .491+(v_ind*0.001)       # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 10*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 3.05                                                               
Lattice spacing in x,y,z = 3.05 3.05 3.05

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -45.75 ${n1e1} -100 100 -100 100 units box
region box block -45.75 45.75 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -45.75 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -45.75 45.75 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-45.75 -100 -100) to (45.75 100 100)
  1 by 2 by 2 MPI processor grid
create_atoms 1 region substrate
Created 30 atoms
  using lattice units in orthogonal box = (-45.75 -100 -100) to (45.75 100 100)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 30 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 21 atoms
  using lattice units in orthogonal box = (-45.75 -100 -100) to (45.75 100 100)
  create_atoms CPU = 0.004 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  30 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  30 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  21 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  21 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
30 atoms in group substrate
group slider1 region slider1
21 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 21 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 10000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 10000 Equi_5_*.dump id type diameter mass xu yu zu fx fy fz

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 60 130 130
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 13.9 | 17.37 | 18.53 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   91.5           200            200            0              0              0              0              0              0              0              2.6109412e-16  0              6            
    100000   91.5           200            200            0.0047315091  -2.6906133e-38  0              0.014194527    12548.382      0              6.0591646e+10  2.6109412e-16  0              3.3166315    
    200000   91.5           200            200            0.0018097487  -2.1118708e-37  0              0.005429246    3448.8472      0              1.6653249e+10  2.6109412e-16  0              3.056327     
    300000   91.5           200            200            0.00037801459 -4.182736e-37   0              0.0011340438   270.1717       0              1.3045625e+09  2.6109412e-16  0              3.0395914    
    400000   91.5           200            200           -1.1891831e-05 -4.189972e-37   0             -3.5675493e-05  0.35708273     0              1724224.7      2.6109412e-16  0              3.0100748    
    500000   91.5           200            200            0.015203185    0.00067491621  0              0.044934639    21.327979      0              1.0298518e+08  2.6109412e-16  0              2.9961209    
    600000   91.5           200            200            0.004152192    0.0001343808   0              0.012322195    5.3530539      0              25847982       2.6109412e-16  0              2.9979717    
    700000   91.5           200            200            0.0073471897   0.00026868401  0              0.021772885    0.068810215    0              332259.9       2.6109412e-16  0              2.9973171    
    800000   91.5           200            200            0.005356022    0.00022604469  0              0.015842021    0.039812683    0              192241.2       2.6109412e-16  0              2.9977032    
    900000   91.5           200            200            0.005896378    0.00023235342  0              0.01745678     0.013154714    0              63519.408      2.6109412e-16  0              2.9975921    
   1000000   91.5           200            200            0.0058176792   0.00023153405  0              0.017221504    0.0021375075   0              10321.259      2.6109412e-16  0              2.9976085    
   1100000   91.5           200            200            0.0057936909   0.00023129988  0              0.017149773    0.00019237026  0              928.88715      2.6109412e-16  0              2.9976131    
   1200000   91.5           200            200            0.0058198059   0.00023156521  0              0.017227853    6.5104341e-06  0              31.436556      2.6109412e-16  0              2.9976079    
   1300000   91.5           200            200            0.0058064965   0.00023142919  0              0.01718806     6.6899022e-08  0              0.32303143     2.6109412e-16  0              2.9976105    
   1400000   91.5           200            200            0.0058114095   0.00023147988  0              0.017202748    2.5943082e-07  0              1.2526986      2.6109412e-16  0              2.9976096    
   1500000   91.5           200            200            0.0058100921   0.00023146617  0              0.01719881     8.3075634e-08  0              0.4011425      2.6109412e-16  0              2.9976098    
   1600000   91.5           200            200            0.0058102633   0.00023146802  0              0.017199322    1.2995632e-08  0              0.062751257    2.6109412e-16  0              2.9976098    
   1700000   91.5           200            200            0.0058103329   0.0002314687   0              0.01719953     1.1119076e-09  0              0.0053690041   2.6109412e-16  0              2.9976098    
   1800000   91.5           200            200            0.0058102656   0.00023146802  0              0.017199329    3.2904864e-11  0              0.00015888581  2.6109412e-16  0              2.9976098    
   1900000   91.5           200            200            0.0058102989   0.00023146836  0              0.017199428    7.5950114e-13  0              3.6673592e-06  2.6109412e-16  0              2.9976098    
   2000000   91.5           200            200            0.0058102869   0.00023146824  0              0.017199392    1.7669779e-12  0              8.532104e-06   2.6109412e-16  0              2.9976098    
   2100000   91.5           200            200            0.00581029     0.00023146827  0              0.017199402    5.2666098e-13  0              2.5430574e-06  2.6109412e-16  0              2.9976098    
   2200000   91.5           200            200            0.0058102896   0.00023146827  0              0.017199401    7.8771846e-14  0              3.8036105e-07  2.6109412e-16  0              2.9976098    
   2300000   91.5           200            200            0.0058102894   0.00023146826  0              0.0171994      6.3961338e-15  0              3.0884641e-08  2.6109412e-16  0              2.9976098    
   2400000   91.5           200            200            0.0058102896   0.00023146827  0              0.017199401    1.6576828e-16  0              8.0043567e-10  2.6109412e-16  0              2.9976098    
   2500000   91.5           200            200            0.0058102895   0.00023146826  0              0.0171994      7.6679627e-18  0              3.7025848e-11  2.6109412e-16  0              2.9976098    
   2600000   91.5           200            200            0.0058102896   0.00023146826  0              0.0171994      1.3018111e-17  0              6.2859799e-11  2.6109412e-16  0              2.9976098    
   2700000   91.5           200            200            0.0058102895   0.00023146826  0              0.0171994      3.3044487e-18  0              1.5956e-11     2.6109412e-16  0              2.9976098    
   2800000   91.5           200            200            0.0058102895   0.00023146826  0              0.0171994      1.3934723e-19  0              6.7285789e-13  2.6109412e-16  0              2.9976098    
   2900000   91.5           200            200            0.0058102895   0.00023146826  0              0.0171994      1.5855791e-19  0              7.6561938e-13  2.6109412e-16  0              2.9976098    
   3000000   91.5           200            200            0.0058102895   0.00023146826  0              0.0171994      4.9471434e-20  0              2.3887985e-13  2.6109412e-16  0              2.9976098    
Loop time of 73.469 on 4 procs for 3000000 steps with 51 atoms

Performance: 35280168.559 ns/day, 0.000 hours/ns, 40833.528 timesteps/s
99.8% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 0.24452    | 1.9626     | 6.8831     | 202.8 |  2.67
Neigh   | 0.073153   | 0.075043   | 0.078187   |   0.7 |  0.10
Comm    | 31.501     | 38.878     | 46.163     |  90.0 | 52.92
Output  | 0.45006    | 0.49089    | 0.61047    |   9.9 |  0.67
Modify  | 15.749     | 22.742     | 31.52      | 147.0 | 30.95
Other   |            | 9.321      |            |       | 12.69

Nlocal:          12.75 ave          51 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1
Nghost:          41.25 ave          54 max           3 min
Histogram: 1 0 0 0 0 0 0 0 0 3
Neighs:          17.75 ave          71 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1

Total # of neighbors = 71
Ave neighs/atom = 1.3921569
Neighbor list builds = 168
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 6

#variable lat0 equal 1                    #
variable lat1 equal 3+(v_ind*0.01)  # .491+(v_ind*0.001)       # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 10*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 3.06                                                               
Lattice spacing in x,y,z = 3.06 3.06 3.06

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -45.9 ${n1e1} -100 100 -100 100 units box
region box block -45.9 45.9 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -45.9 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -45.9 45.9 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-45.9 -100 -100) to (45.9 100 100)
  1 by 2 by 2 MPI processor grid
create_atoms 1 region substrate
Created 30 atoms
  using lattice units in orthogonal box = (-45.9 -100 -100) to (45.9 100 100)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 30 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 21 atoms
  using lattice units in orthogonal box = (-45.9 -100 -100) to (45.9 100 100)
  create_atoms CPU = 0.004 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  30 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  30 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  21 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  21 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
30 atoms in group substrate
group slider1 region slider1
21 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 21 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 10000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 10000 Equi_6_*.dump id type diameter mass xu yu zu fx fy fz

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 60 130 130
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 13.9 | 17.37 | 18.53 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   91.8           200            200            0              0              0              0              0              0              0              2.6109412e-16  0              6            
    100000   91.8           200            200            0.0047079725  -2.6822578e-38  0              0.014123917    12516.22       0              6.0436348e+10  2.6109412e-16  0              3.3178456    
    200000   91.8           200            200            0.0017849034  -1.0706265e-36  0              0.0053547103   3392.7559      0              1.6382404e+10  2.6109412e-16  0              3.0586025    
    300000   91.8           200            200            0.00034442407 -1.696715e-36   0              0.0010332722   230.19147      0              1.1115122e+09  2.6109412e-16  0              3.040912     
    400000   91.8           200            200           -7.2491631e-05  4.7768294e-38  0             -0.00021747489  14.427143      0              69663512       2.6109412e-16  0              3.0089668    
    500000   91.8           200            200            3.44767e-05    4.3319931e-36  0              0.0001034301   2.9910633      0              14442774       2.6109412e-16  0              3.0001807    
    600000   91.8           200            200            0.0027177222   0.00012843772  0              0.0080247287   0.82467933     0              3982081.3      2.6109412e-16  0              2.998221     
    700000   91.8           200            200            0.0058953308   0.000201674    0              0.017484318    0.826652       0              3991606.6      2.6109412e-16  0              2.9973164    
    800000   91.8           200            200            0.0052714144   0.00016667035  0              0.015647573    0.0066847151   0              32278.097      2.6109412e-16  0              2.9974595    
    900000   91.8           200            200            0.0058204983   0.00018384389  0              0.017277651    0.014296246    0              69031.458      2.6109412e-16  0              2.997336     
   1000000   91.8           200            200            0.0058242289   0.00018391047  0              0.017288776    0.0010514822   0              5077.2311      2.6109412e-16  0              2.9973345    
   1100000   91.8           200            200            0.0057494613   0.00018314771  0              0.017065236    1.1354735e-05  0              54.827951      2.6109412e-16  0              2.9973511    
   1200000   91.8           200            200            0.0057785113   0.00018344935  0              0.017152084    3.2634883e-05  0              157.58217      2.6109412e-16  0              2.9973447    
   1300000   91.8           200            200            0.0057771142   0.00018343664  0              0.017147906    3.2712621e-06  0              15.795754      2.6109412e-16  0              2.997345     
   1400000   91.8           200            200            0.0057737353   0.00018340151  0              0.017137804    3.0934961e-09  0              0.014937386    2.6109412e-16  0              2.9973458    
   1500000   91.8           200            200            0.0057752648   0.0001834172   0              0.017142377    7.1169811e-08  0              0.34365355     2.6109412e-16  0              2.9973454    
   1600000   91.8           200            200            0.0057751154   0.00018341574  0              0.01714193     9.6588668e-09  0              0.046639211    2.6109412e-16  0              2.9973454    
   1700000   91.8           200            200            0.0057749677   0.00018341419  0              0.017141489    8.2986384e-12  0              4.0071155e-05  2.6109412e-16  0              2.9973455    
   1800000   91.8           200            200            0.0057750465   0.000183415    0              0.017141724    1.4776394e-10  0              0.0007134992   2.6109412e-16  0              2.9973455    
   1900000   91.8           200            200            0.0057750352   0.00018341489  0              0.017141691    2.7152812e-11  0              0.00013111121  2.6109412e-16  0              2.9973455    
   2000000   91.8           200            200            0.005775029    0.00018341483  0              0.017141672    1.7798398e-13  0              8.5942094e-07  2.6109412e-16  0              2.9973455    
   2100000   91.8           200            200            0.005775033    0.00018341487  0              0.017141684    2.8923472e-13  0              1.3966109e-06  2.6109412e-16  0              2.9973455    
   2200000   91.8           200            200            0.0057750322   0.00018341486  0              0.017141682    7.3084101e-14  0              3.5289697e-07  2.6109412e-16  0              2.9973455    
   2300000   91.8           200            200            0.005775032    0.00018341486  0              0.017141681    1.1937076e-15  0              5.7639869e-09  2.6109412e-16  0              2.9973455    
   2400000   91.8           200            200            0.0057750322   0.00018341486  0              0.017141682    5.169153e-16   0              2.495999e-09   2.6109412e-16  0              2.9973455    
   2500000   91.8           200            200            0.0057750322   0.00018341486  0              0.017141682    1.8932577e-16  0              9.141864e-10   2.6109412e-16  0              2.9973455    
   2600000   91.8           200            200            0.0057750321   0.00018341486  0              0.017141682    5.5891806e-18  0              2.6988153e-11  2.6109412e-16  0              2.9973455    
   2700000   91.8           200            200            0.0057750322   0.00018341486  0              0.017141682    1.5608324e-18  0              7.536701e-12   2.6109412e-16  0              2.9973455    
   2800000   91.8           200            200            0.0057750322   0.00018341486  0              0.017141682    3.2986298e-20  0              1.5927903e-13  2.6109412e-16  0              2.9973455    
   2900000   91.8           200            200            0.0057750322   0.00018341486  0              0.017141682    1.3628111e-19  0              6.5805271e-13  2.6109412e-16  0              2.9973455    
   3000000   91.8           200            200            0.0057750322   0.00018341486  0              0.017141682    2.8377786e-20  0              1.3702617e-13  2.6109412e-16  0              2.9973455    
Loop time of 73.4201 on 4 procs for 3000000 steps with 51 atoms

Performance: 35303667.710 ns/day, 0.000 hours/ns, 40860.727 timesteps/s
99.8% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 0.24164    | 1.9206     | 6.7656     | 201.9 |  2.62
Neigh   | 0.071934   | 0.073213   | 0.075716   |   0.6 |  0.10
Comm    | 31.638     | 38.865     | 46.064     |  88.9 | 52.93
Output  | 0.44979    | 0.49039    | 0.60936    |   9.8 |  0.67
Modify  | 15.876     | 22.771     | 31.353     | 145.5 | 31.01
Other   |            | 9.3        |            |       | 12.67

Nlocal:          12.75 ave          51 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1
Nghost:          41.25 ave          54 max           3 min
Histogram: 1 0 0 0 0 0 0 0 0 3
Neighs:          17.75 ave          71 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1

Total # of neighbors = 71
Ave neighs/atom = 1.3921569
Neighbor list builds = 168
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 7

#variable lat0 equal 1                    #
variable lat1 equal 3+(v_ind*0.01)  # .491+(v_ind*0.001)       # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 10*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 3.07                                                               
Lattice spacing in x,y,z = 3.07 3.07 3.07

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -46.05 ${n1e1} -100 100 -100 100 units box
region box block -46.05 46.05 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -46.05 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -46.05 46.05 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-46.05 -100 -100) to (46.05 100 100)
  1 by 2 by 2 MPI processor grid
create_atoms 1 region substrate
Created 30 atoms
  using lattice units in orthogonal box = (-46.05 -100 -100) to (46.05 100 100)
  create_atoms CPU = 0.000 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 30 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 21 atoms
  using lattice units in orthogonal box = (-46.05 -100 -100) to (46.05 100 100)
  create_atoms CPU = 0.004 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  30 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  30 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  21 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  21 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
30 atoms in group substrate
group slider1 region slider1
21 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 21 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 10000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 10000 Equi_7_*.dump id type diameter mass xu yu zu fx fy fz

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 60 130 130
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 13.9 | 17.37 | 18.53 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   92.1           200            200            0              0              0              0              0              0              0              2.6109412e-16  0              6            
    100000   92.1           200            200            0.0046854591   2.8040932e-42  0              0.014056377    12487.576      0              6.0298035e+10  2.6109412e-16  0              3.3189201    
    200000   92.1           200            200            0.0017622128  -3.1957864e-37  0              0.0052866383   3342.8336      0              1.6141347e+10  2.6109412e-16  0              3.0606181    
    300000   92.1           200            200            0.0003146664  -1.6871779e-36  0              0.00094399919  196.86074      0              9.5057007e+08  2.6109412e-16  0              3.0419654    
    400000   92.1           200            200           -0.00012762048 -1.6279635e-36  0             -0.00038286144  47.94515       0              2.3150997e+08  2.6109412e-16  0              3.0070055    
    500000   92.1           200            200            0.0020792308   9.5514303e-05  0              0.0061421782   33.554247      0              1.6202145e+08  2.6109412e-16  0              2.9982824    
    600000   92.1           200            200            0.0077649651   0.00022362633  0              0.023071269    3.7858053      0              18280299       2.6109412e-16  0              2.9966538    
    700000   92.1           200            200            0.0066450433   0.00019182931  0              0.019743301    0.37493193     0              1810412.1      2.6109412e-16  0              2.996933     
    800000   92.1           200            200            0.0061598522   0.00018968693  0              0.01828987     0.022811036    0              110146.33      2.6109412e-16  0              2.997062     
    900000   92.1           200            200            0.0059191244   0.00018846878  0              0.017568905    0.00092834993  0              4482.6696      2.6109412e-16  0              2.9971268    
   1000000   92.1           200            200            0.0058189524   0.00018792958  0              0.017268927    3.2205809e-06  0              15.551032      2.6109412e-16  0              2.9971539    
   1100000   92.1           200            200            0.0057797754   0.00018771374  0              0.017151612    7.8946715e-06  0              38.120543      2.6109412e-16  0              2.9971645    
   1200000   92.1           200            200            0.0057651803   0.00018763276  0              0.017107908    5.10548e-06    0              24.652536      2.6109412e-16  0              2.9971684    
   1300000   92.1           200            200            0.0057599946   0.00018760397  0              0.01709238     1.5444432e-06  0              7.4575633      2.6109412e-16  0              2.9971698    
   1400000   92.1           200            200            0.0057582441   0.00018759428  0              0.017087138    3.4447919e-07  0              1.6633667      2.6109412e-16  0              2.9971703    
   1500000   92.1           200            200            0.0057576883   0.00018759121  0              0.017085474    6.4222591e-08  0              0.31010791     2.6109412e-16  0              2.9971705    
   1600000   92.1           200            200            0.005757526    0.00018759032  0              0.017084988    1.0529171e-08  0              0.050841597    2.6109412e-16  0              2.9971705    
   1700000   92.1           200            200            0.0057574846   0.0001875901   0              0.017084864    1.5534126e-09  0              0.0075008735   2.6109412e-16  0              2.9971705    
   1800000   92.1           200            200            0.0057574768   0.00018759006  0              0.01708484     2.0808919e-10  0              0.0010047882   2.6109412e-16  0              2.9971705    
   1900000   92.1           200            200            0.0057574769   0.00018759006  0              0.017084841    2.5283537e-11  0              0.00012208515  2.6109412e-16  0              2.9971705    
   2000000   92.1           200            200            0.0057574779   0.00018759007  0              0.017084844    2.7549843e-12  0              1.3302833e-05  2.6109412e-16  0              2.9971705    
   2100000   92.1           200            200            0.0057574787   0.00018759007  0              0.017084846    2.6196306e-13  0              1.2649258e-06  2.6109412e-16  0              2.9971705    
   2200000   92.1           200            200            0.0057574791   0.00018759007  0              0.017084847    2.0484131e-14  0              9.8910539e-08  2.6109412e-16  0              2.9971705    
   2300000   92.1           200            200            0.0057574793   0.00018759008  0              0.017084848    1.1242541e-15  0              5.4286208e-09  2.6109412e-16  0              2.9971705    
   2400000   92.1           200            200            0.0057574794   0.00018759008  0              0.017084848    2.0239472e-17  0              9.7729169e-11  2.6109412e-16  0              2.9971705    
   2500000   92.1           200            200            0.0057574794   0.00018759008  0              0.017084848    1.2559044e-18  0              6.064313e-12   2.6109412e-16  0              2.9971705    
   2600000   92.1           200            200            0.0057574794   0.00018759008  0              0.017084848    2.3475194e-18  0              1.1335331e-11  2.6109412e-16  0              2.9971705    
   2700000   92.1           200            200            0.0057574794   0.00018759008  0              0.017084848    1.6682805e-18  0              8.0555294e-12  2.6109412e-16  0              2.9971705    
   2800000   92.1           200            200            0.0057574794   0.00018759008  0              0.017084848    2.6389753e-19  0              1.2742667e-12  2.6109412e-16  0              2.9971705    
   2900000   92.1           200            200            0.0057574794   0.00018759008  0              0.017084848    8.8126644e-20  0              4.2553202e-13  2.6109412e-16  0              2.9971705    
   3000000   92.1           200            200            0.0057574794   0.00018759008  0              0.017084848    3.8073254e-21  0              1.8384212e-14  2.6109412e-16  0              2.9971705    
Loop time of 73.5058 on 4 procs for 3000000 steps with 51 atoms

Performance: 35262541.928 ns/day, 0.000 hours/ns, 40813.127 timesteps/s
99.8% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 0.25189    | 2.0022     | 7.0784     | 207.1 |  2.72
Neigh   | 0.074646   | 0.076821   | 0.080243   |   0.8 |  0.10
Comm    | 31.493     | 38.773     | 46.042     |  89.1 | 52.75
Output  | 0.44476    | 0.48472    | 0.60173    |   9.7 |  0.66
Modify  | 15.94      | 22.877     | 31.552     | 145.3 | 31.12
Other   |            | 9.292      |            |       | 12.64

Nlocal:          12.75 ave          51 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1
Nghost:          41.25 ave          54 max           3 min
Histogram: 1 0 0 0 0 0 0 0 0 3
Neighs:          17.75 ave          71 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1

Total # of neighbors = 71
Ave neighs/atom = 1.3921569
Neighbor list builds = 168
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 8

#variable lat0 equal 1                    #
variable lat1 equal 3+(v_ind*0.01)  # .491+(v_ind*0.001)       # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 10*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 3.08                                                               
Lattice spacing in x,y,z = 3.08 3.08 3.08

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -46.2 ${n1e1} -100 100 -100 100 units box
region box block -46.2 46.2 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -46.2 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -46.2 46.2 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-46.2 -100 -100) to (46.2 100 100)
  1 by 2 by 2 MPI processor grid
create_atoms 1 region substrate
Created 30 atoms
  using lattice units in orthogonal box = (-46.2 -100 -100) to (46.2 100 100)
  create_atoms CPU = 0.000 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 30 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 21 atoms
  using lattice units in orthogonal box = (-46.2 -100 -100) to (46.2 100 100)
  create_atoms CPU = 0.003 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  30 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  30 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  21 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  21 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
30 atoms in group substrate
group slider1 region slider1
21 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 21 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 10000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 10000 Equi_8_*.dump id type diameter mass xu yu zu fx fy fz

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 60 130 130
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 13.9 | 17.37 | 18.53 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   92.4           200            200            0              0              0              0              0              0              0              2.6109412e-16  0              6            
    100000   92.4           200            200            0.0046637824  -6.6652399e-39  0              0.013991347    12461.739      0              6.017328e+10   2.6109412e-16  0              3.3198803    
    200000   92.4           200            200            0.0017411491   1.0714063e-36  0              0.0052234473   3297.5042      0              1.5922468e+10  2.6109412e-16  0              3.0624417    
    300000   92.4           200            200            0.00028802769  8.9722486e-37  0              0.00086408308  168.76451      0              8.1490343e+08  2.6109412e-16  0              3.0428049    
    400000   92.4           200            200           -0.00017018679  6.1178358e-36  0             -0.00051056038  90.558013      0              4.3727224e+08  2.6109412e-16  0              3.0046745    
    500000   92.4           200            200            0.015876073    0.00065179376  0              0.046976426    5.980868       0              28879471       2.6109412e-16  0              2.9949339    
    600000   92.4           200            200            0.006465758    0.00024898293  0              0.019148291    5.3230512      0              25703109       2.6109412e-16  0              2.9968139    
    700000   92.4           200            200            0.0069496085   0.00021473484  0              0.020634091    0.05354997     0              258573.64      2.6109412e-16  0              2.9966961    
    800000   92.4           200            200            0.0061703366   0.00021077321  0              0.018300237    0.013208083    0              63777.108      2.6109412e-16  0              2.996901     
    900000   92.4           200            200            0.0058439048   0.00020873577  0              0.017322979    0.0090624774   0              43759.46       2.6109412e-16  0              2.9969886    
   1000000   92.4           200            200            0.0057495857   0.00020810507  0              0.017040652    0.0018646793   0              9003.869       2.6109412e-16  0              2.997014     
   1100000   92.4           200            200            0.0057347644   0.00020800693  0              0.016996286    0.00019336295  0              933.68047      2.6109412e-16  0              2.9970179    
   1200000   92.4           200            200            0.0057382981   0.00020803294  0              0.017006861    7.7371566e-06  0              37.35996       2.6109412e-16  0              2.9970169    
   1300000   92.4           200            200            0.0057424989   0.00020806236  0              0.017019434    2.4612731e-08  0              0.11884607     2.6109412e-16  0              2.9970157    
   1400000   92.4           200            200            0.0057446267   0.00020807708  0              0.017025803    2.2441856e-07  0              1.0836369      2.6109412e-16  0              2.9970151    
   1500000   92.4           200            200            0.0057453778   0.00020808223  0              0.017028051    7.4277547e-08  0              0.35865969     2.6109412e-16  0              2.9970149    
   1600000   92.4           200            200            0.0057455556   0.00020808343  0              0.017028583    1.1004327e-08  0              0.053135959    2.6109412e-16  0              2.9970149    
   1700000   92.4           200            200            0.0057455642   0.00020808348  0              0.017028609    7.9364826e-10  0              0.0038322434   2.6109412e-16  0              2.9970149    
   1800000   92.4           200            200            0.0057455455   0.00020808335  0              0.017028553    1.0724337e-11  0              5.1783987e-05  2.6109412e-16  0              2.9970149    
   1900000   92.4           200            200            0.0057455327   0.00020808326  0              0.017028515    3.1731053e-12  0              1.532179e-05   2.6109412e-16  0              2.9970149    
   2000000   92.4           200            200            0.0057455273   0.00020808322  0              0.017028499    2.3955998e-12  0              1.1567494e-05  2.6109412e-16  0              2.9970149    
   2100000   92.4           200            200            0.0057455257   0.00020808321  0              0.017028494    5.1646895e-13  0              2.4938437e-06  2.6109412e-16  0              2.9970149    
   2200000   92.4           200            200            0.0057455254   0.00020808321  0              0.017028493    5.582771e-14   0              2.6957203e-07  2.6109412e-16  0              2.9970149    
   2300000   92.4           200            200            0.0057455255   0.00020808321  0              0.017028493    2.4366342e-15  0              1.1765634e-08  2.6109412e-16  0              2.9970149    
   2400000   92.4           200            200            0.0057455255   0.00020808321  0              0.017028493    2.1996518e-18  0              1.0621331e-11  2.6109412e-16  0              2.9970149    
   2500000   92.4           200            200            0.0057455256   0.00020808321  0              0.017028494    5.7224237e-17  0              2.7631536e-10  2.6109412e-16  0              2.9970149    
   2600000   92.4           200            200            0.0057455256   0.00020808321  0              0.017028494    2.0611857e-17  0              9.9527281e-11  2.6109412e-16  0              2.9970149    
   2700000   92.4           200            200            0.0057455256   0.00020808321  0              0.017028494    2.5893174e-18  0              1.2502887e-11  2.6109412e-16  0              2.9970149    
   2800000   92.4           200            200            0.0057455256   0.00020808321  0              0.017028494    1.3906163e-19  0              6.7147883e-13  2.6109412e-16  0              2.9970149    
   2900000   92.4           200            200            0.0057455256   0.00020808321  0              0.017028494    1.1672871e-20  0              5.6364118e-14  2.6109412e-16  0              2.9970149    
   3000000   92.4           200            200            0.0057455256   0.00020808321  0              0.017028494    7.7540728e-20  0              3.7441642e-13  2.6109412e-16  0              2.9970149    
Loop time of 73.6597 on 4 procs for 3000000 steps with 51 atoms

Performance: 35188843.178 ns/day, 0.000 hours/ns, 40727.828 timesteps/s
99.8% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 0.24346    | 1.9986     | 7.0521     | 206.4 |  2.71
Neigh   | 0.070268   | 0.071752   | 0.074439   |   0.6 |  0.10
Comm    | 31.513     | 38.755     | 46.08      |  89.7 | 52.61
Output  | 0.45198    | 0.49146    | 0.6074     |   9.5 |  0.67
Modify  | 15.865     | 22.885     | 31.503     | 144.6 | 31.07
Other   |            | 9.457      |            |       | 12.84

Nlocal:          12.75 ave          51 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1
Nghost:          41.25 ave          54 max           3 min
Histogram: 1 0 0 0 0 0 0 0 0 3
Neighs:          17.25 ave          69 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1

Total # of neighbors = 69
Ave neighs/atom = 1.3529412
Neighbor list builds = 168
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 9

#variable lat0 equal 1                    #
variable lat1 equal 3+(v_ind*0.01)  # .491+(v_ind*0.001)       # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 10*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 3.09                                                               
Lattice spacing in x,y,z = 3.09 3.09 3.09

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -46.35 ${n1e1} -100 100 -100 100 units box
region box block -46.35 46.35 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -46.35 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -46.35 46.35 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-46.35 -100 -100) to (46.35 100 100)
  1 by 2 by 2 MPI processor grid
create_atoms 1 region substrate
Created 30 atoms
  using lattice units in orthogonal box = (-46.35 -100 -100) to (46.35 100 100)
  create_atoms CPU = 0.000 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 30 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 21 atoms
  using lattice units in orthogonal box = (-46.35 -100 -100) to (46.35 100 100)
  create_atoms CPU = 0.003 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  30 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  30 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  21 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  21 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
30 atoms in group substrate
group slider1 region slider1
21 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 21 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 10000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 10000 Equi_9_*.dump id type diameter mass xu yu zu fx fy fz

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 60 130 130
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 13.9 | 17.37 | 18.53 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   92.7           200            200            0              0              0              0              0              0              0              2.6109412e-16  0              6            
    100000   92.7           200            200            0.0046425964   1.3299734e-38  0              0.013927789    12437.237      0              6.0054967e+10  2.6109412e-16  0              3.3208203    
    200000   92.7           200            200            0.0017213624  -4.1488966e-37  0              0.0051640872   3255.7218      0              1.5720716e+10  2.6109412e-16  0              3.064123     
    300000   92.7           200            200            0.00026241903  4.3376685e-36  0              0.0007872571   143.31442      0              6.9201406e+08  2.6109412e-16  0              3.0435561    
    400000   92.7           200            200           -0.0002085244  -6.6702388e-36  0             -0.00062557321  144.34659      0              6.9699803e+08  2.6109412e-16  0              3.001871     
    500000   92.7           200            200            0.00067150297 -1.052071e-35   0              0.0020145089   16.678077      0              80532467       2.6109412e-16  0              2.9989415    
    600000   92.7           200            200            0.004539109    0.00012030664  0              0.01349702     4.7987485      0              23171439       2.6109412e-16  0              2.9971888    
    700000   92.7           200            200            0.0045983132   0.00020900228  0              0.013585937    0.061698951    0              297922.15      2.6109412e-16  0              2.9971651    
    800000   92.7           200            200            0.0056673709   0.00021992282  0              0.01678219     0.099335813    0              479657.09      2.6109412e-16  0              2.996858     
    900000   92.7           200            200            0.0058649411   0.00022145529  0              0.017373368    0.0044909289   0              21685.088      2.6109412e-16  0              2.996805     
   1000000   92.7           200            200            0.0057847474   0.00022081669  0              0.017133425    0.00038873695  0              1877.0716      2.6109412e-16  0              2.9968274    
   1100000   92.7           200            200            0.005731381    0.00022039057  0              0.016973752    0.00025075076  0              1210.7857      2.6109412e-16  0              2.9968421    
   1200000   92.7           200            200            0.0057238157   0.00022033152  0              0.016951116    7.8781295e-06  0              38.040668      2.6109412e-16  0              2.9968441    
   1300000   92.7           200            200            0.0057284103   0.00022036937  0              0.016964862    1.3746029e-06  0              6.6374653      2.6109412e-16  0              2.9968428    
   1400000   92.7           200            200            0.0057310236   0.00022039043  0              0.01697268     6.1638602e-07  0              2.9763075      2.6109412e-16  0              2.9968421    
   1500000   92.7           200            200            0.005731305    0.00022039259  0              0.016973522    1.2699449e-08  0              0.061321093    2.6109412e-16  0              2.996842     
   1600000   92.7           200            200            0.0057310486   0.00022039049  0              0.016972755    4.5277313e-09  0              0.021862794    2.6109412e-16  0              2.9968421    
   1700000   92.7           200            200            0.005730922    0.00022038947  0              0.016972376    1.4826592e-09  0              0.0071592308   2.6109412e-16  0              2.9968421    
   1800000   92.7           200            200            0.0057309129   0.0002203894   0              0.016972349    1.7665359e-11  0              8.5299695e-05  2.6109412e-16  0              2.9968421    
   1900000   92.7           200            200            0.0057309269   0.00022038951  0              0.016972391    1.4119849e-11  0              6.8179698e-05  2.6109412e-16  0              2.9968421    
   2000000   92.7           200            200            0.0057309329   0.00022038956  0              0.016972409    3.487361e-12   0              1.6839218e-05  2.6109412e-16  0              2.9968421    
   2100000   92.7           200            200            0.0057309331   0.00022038957  0              0.01697241     1.8770084e-14  0              9.063402e-08   2.6109412e-16  0              2.9968421    
   2200000   92.7           200            200            0.0057309324   0.00022038956  0              0.016972408    4.213106e-14   0              2.0343581e-07  2.6109412e-16  0              2.9968421    
   2300000   92.7           200            200            0.0057309321   0.00022038956  0              0.016972407    8.0141596e-15  0              3.8697508e-08  2.6109412e-16  0              2.9968421    
   2400000   92.7           200            200            0.0057309321   0.00022038956  0              0.016972407    1.0338841e-17  0              4.9922562e-11  2.6109412e-16  0              2.9968421    
   2500000   92.7           200            200            0.0057309321   0.00022038956  0              0.016972407    1.2319393e-16  0              5.9485941e-10  2.6109412e-16  0              2.9968421    
   2600000   92.7           200            200            0.0057309322   0.00022038956  0              0.016972407    1.7424805e-17  0              8.4138148e-11  2.6109412e-16  0              2.9968421    
   2700000   92.7           200            200            0.0057309322   0.00022038956  0              0.016972407    3.3653753e-19  0              1.6250193e-12  2.6109412e-16  0              2.9968421    
   2800000   92.7           200            200            0.0057309322   0.00022038956  0              0.016972407    1.0373815e-19  0              5.0091438e-13  2.6109412e-16  0              2.9968421    
   2900000   92.7           200            200            0.0057309322   0.00022038956  0              0.016972407    9.2710098e-21  0              4.4766388e-14  2.6109412e-16  0              2.9968421    
   3000000   92.7           200            200            0.0057309322   0.00022038956  0              0.016972407    6.680807e-21   0              3.2259226e-14  2.6109412e-16  0              2.9968421    
Loop time of 73.3686 on 4 procs for 3000000 steps with 51 atoms

Performance: 35328473.198 ns/day, 0.000 hours/ns, 40889.437 timesteps/s
99.8% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 0.24184    | 1.8695     | 6.543      | 197.4 |  2.55
Neigh   | 0.069929   | 0.072654   | 0.076642   |   1.1 |  0.10
Comm    | 31.565     | 38.82      | 45.973     |  89.6 | 52.91
Output  | 0.45002    | 0.48968    | 0.60615    |   9.6 |  0.67
Modify  | 15.782     | 22.759     | 31.313     | 145.0 | 31.02
Other   |            | 9.358      |            |       | 12.75

Nlocal:          12.75 ave          51 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1
Nghost:          41.25 ave          54 max           3 min
Histogram: 1 0 0 0 0 0 0 0 0 3
Neighs:          16.75 ave          67 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1

Total # of neighbors = 67
Ave neighs/atom = 1.3137255
Neighbor list builds = 168
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 10

#variable lat0 equal 1                    #
variable lat1 equal 3+(v_ind*0.01)  # .491+(v_ind*0.001)       # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 10*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 3.1                                                               
Lattice spacing in x,y,z = 3.1 3.1 3.1

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -46.5 ${n1e1} -100 100 -100 100 units box
region box block -46.5 46.5 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -46.5 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -46.5 46.5 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-46.5 -100 -100) to (46.5 100 100)
  1 by 2 by 2 MPI processor grid
create_atoms 1 region substrate
Created 30 atoms
  using lattice units in orthogonal box = (-46.5 -100 -100) to (46.5 100 100)
  create_atoms CPU = 0.000 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 30 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 21 atoms
  using lattice units in orthogonal box = (-46.5 -100 -100) to (46.5 100 100)
  create_atoms CPU = 0.004 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  30 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  30 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  21 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  21 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
30 atoms in group substrate
group slider1 region slider1
21 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 21 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 10000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 10000 Equi_10_*.dump id type diameter mass xu yu zu fx fy fz

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 60 130 130
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 13.96 | 17.43 | 18.59 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   93             200            200            0              0              0              0              0              0              0              2.6109412e-16  0              6            
    100000   93             200            200            0.0046222338   1.0609773e-37  0              0.013866701    12415.658      0              5.9950769e+10  2.6109412e-16  0              3.3216001    
    200000   93             200            200            0.001703192   -3.9894065e-37  0              0.0051095759   3218.5241      0              1.5541101e+10  2.6109412e-16  0              3.0655833    
    300000   93             200            200            0.00024083887  9.270148e-37   0              0.0007225166   123.21999      0              5.9498524e+08  2.6109412e-16  0              3.0440762    
    400000   93             200            200            0.00097959059  1.8012371e-06  0              0.0029369705   213.28584      0              1.029881e+09   2.6109412e-16  0              2.9982832    
    500000   93             200            200            0.00019105276 -1.0602975e-35  0              0.00057315828  2.9864232      0              14420369       2.6109412e-16  0              2.9994429    
    600000   93             200            200            0.0045504742   0.00022769849  0              0.013423724    4.79338        0              23145516       2.6109412e-16  0              2.9969813    
    700000   93             200            200            0.0068014443   0.00023176516  0              0.020172568    0.15424415     0              744789.8       2.6109412e-16  0              2.9963617    
    800000   93             200            200            0.0054101705   0.00022080739  0              0.016009704    0.050915007    0              245850.35      2.6109412e-16  0              2.9967406    
    900000   93             200            200            0.0056275219   0.00022302543  0              0.01665954     0.0097690148   0              47171.077      2.6109412e-16  0              2.9966773    
   1000000   93             200            200            0.0057699635   0.00022431963  0              0.017085571    0.00017159683  0              828.57968      2.6109412e-16  0              2.996638     
   1100000   93             200            200            0.0057151442   0.00022381878  0              0.016921614    0.00024653254  0              1190.4174      2.6109412e-16  0              2.9966534    
   1200000   93             200            200            0.0057055355   0.00022373389  0              0.016892873    9.5863304e-07  0              4.6288959      2.6109412e-16  0              2.996656     
   1300000   93             200            200            0.0057146271   0.00022381734  0              0.016920064    3.8149107e-06  0              18.420839      2.6109412e-16  0              2.9966534    
   1400000   93             200            200            0.005714337    0.00022381424  0              0.016919197    2.251142e-07   0              1.0869959      2.6109412e-16  0              2.9966535    
   1500000   93             200            200            0.0057131574   0.0002238035   0              0.016915669    3.2842823e-08  0              0.15858624     2.6109412e-16  0              2.9966539    
   1600000   93             200            200            0.0057134032   0.0002238058   0              0.016916404    9.2023089e-09  0              0.044434656    2.6109412e-16  0              2.9966538    
   1700000   93             200            200            0.0057135198   0.00022380685  0              0.016916752    5.9730684e-11  0              0.00028841809  2.6109412e-16  0              2.9966538    
   1800000   93             200            200            0.0057134661   0.00022380636  0              0.016916592    2.0545706e-10  0              0.00099207862  2.6109412e-16  0              2.9966538    
   1900000   93             200            200            0.0057134597   0.0002238063   0              0.016916573    2.1423715e-12  0              1.0344745e-05  2.6109412e-16  0              2.9966538    
   2000000   93             200            200            0.0057134681   0.00022380638  0              0.016916598    2.8336379e-12  0              1.3682623e-05  2.6109412e-16  0              2.9966538    
   2100000   93             200            200            0.0057134675   0.00022380637  0              0.016916596    2.42841e-13    0              1.1725923e-06  2.6109412e-16  0              2.9966538    
   2200000   93             200            200            0.0057134665   0.00022380636  0              0.016916593    2.0033454e-14  0              9.6734378e-08  2.6109412e-16  0              2.9966538    
   2300000   93             200            200            0.0057134667   0.00022380637  0              0.016916594    8.3601736e-15  0              4.0368286e-08  2.6109412e-16  0              2.9966538    
   2400000   93             200            200            0.0057134668   0.00022380637  0              0.016916594    1.1411679e-17  0              5.5102912e-11  2.6109412e-16  0              2.9966538    
   2500000   93             200            200            0.0057134668   0.00022380637  0              0.016916594    1.6824681e-16  0              8.1240361e-10  2.6109412e-16  0              2.9966538    
   2600000   93             200            200            0.0057134668   0.00022380637  0              0.016916594    3.3137994e-18  0              1.6001152e-11  2.6109412e-16  0              2.9966538    
   2700000   93             200            200            0.0057134668   0.00022380637  0              0.016916594    1.2276304e-18  0              5.9277877e-12  2.6109412e-16  0              2.9966538    
   2800000   93             200            200            0.0057134668   0.00022380637  0              0.016916594    2.8979521e-19  0              1.3993174e-12  2.6109412e-16  0              2.9966538    
   2900000   93             200            200            0.0057134668   0.00022380637  0              0.016916594    1.6773552e-21  0              8.0993481e-15  2.6109412e-16  0              2.9966538    
   3000000   93             200            200            0.0057134668   0.00022380637  0              0.016916594    2.5956436e-20  0              1.2533434e-13  2.6109412e-16  0              2.9966538    
Loop time of 73.3907 on 4 procs for 3000000 steps with 51 atoms

Performance: 35317812.857 ns/day, 0.000 hours/ns, 40877.098 timesteps/s
99.8% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 0.24741    | 1.576      | 5.3687     | 174.5 |  2.15
Neigh   | 0.076042   | 0.078727   | 0.082588   |   1.0 |  0.11
Comm    | 31.543     | 39.118     | 45.969     |  92.5 | 53.30
Output  | 0.44628    | 0.48641    | 0.60394    |   9.7 |  0.66
Modify  | 15.908     | 22.837     | 31.444     | 145.2 | 31.12
Other   |            | 9.294      |            |       | 12.66

Nlocal:          12.75 ave          51 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1
Nghost:          41.25 ave          54 max           3 min
Histogram: 1 0 0 0 0 0 0 0 0 3
Neighs:          11.75 ave          47 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1

Total # of neighbors = 47
Ave neighs/atom = 0.92156863
Neighbor list builds = 166
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 11

#variable lat0 equal 1                    #
variable lat1 equal 3+(v_ind*0.01)  # .491+(v_ind*0.001)       # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 10*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 3.11                                                               
Lattice spacing in x,y,z = 3.11 3.11 3.11

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -46.65 ${n1e1} -100 100 -100 100 units box
region box block -46.65 46.65 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -46.65 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -46.65 46.65 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-46.65 -100 -100) to (46.65 100 100)
  1 by 2 by 2 MPI processor grid
create_atoms 1 region substrate
Created 30 atoms
  using lattice units in orthogonal box = (-46.65 -100 -100) to (46.65 100 100)
  create_atoms CPU = 0.000 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 30 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 21 atoms
  using lattice units in orthogonal box = (-46.65 -100 -100) to (46.65 100 100)
  create_atoms CPU = 0.004 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  30 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  30 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  21 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  21 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
30 atoms in group substrate
group slider1 region slider1
21 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 21 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 10000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 10000 Equi_11_*.dump id type diameter mass xu yu zu fx fy fz

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 61 130 130
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 13.92 | 17.39 | 18.55 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   93.3           200            200            0              0              0              0              0              0              0              2.6109412e-16  0              6            
    100000   93.3           200            200            0.004602089   -2.6408987e-38  0              0.013806267    12394.303      0              5.9847654e+10  2.6109412e-16  0              3.3224187    
    200000   93.3           200            200            0.001685351   -1.0477009e-36  0              0.0050560529   3182.0481      0              1.5364971e+10  2.6109412e-16  0              3.0670456    
    300000   93.3           200            200            0.00022143176 -7.2999128e-37  0              0.00066429528  106.20777      0              5.1283929e+08  2.6109412e-16  0              3.0444663    
    400000   93.3           200            200            0.014897342    0.0010949718   0              0.043597054    194.85486      0              9.4088437e+08  2.6109412e-16  0              2.9943207    
    500000   93.3           200            200            0.0024418829   5.5615576e-05  0              0.0072700331   32.583774      0              1.5733538e+08  2.6109412e-16  0              2.9974812    
    600000   93.3           200            200            0.0078464522   0.00026996897  0              0.023269388    3.2724099      0              15801296       2.6109412e-16  0              2.9958896    
    700000   93.3           200            200            0.0051269604   0.00021133641  0              0.015169545    0.55773342     0              2693095.1      2.6109412e-16  0              2.9966115    
    800000   93.3           200            200            0.0059795284   0.0002202849   0              0.0177183      0.056223556    0              271483.43      2.6109412e-16  0              2.9963722    
    900000   93.3           200            200            0.0055567173   0.00021621355  0              0.016453938    0.003534451    0              17066.599      2.6109412e-16  0              2.9964902    
   1000000   93.3           200            200            0.0057499054   0.00021818033  0              0.017031536    9.2873517e-05  0              448.45297      2.6109412e-16  0              2.9964355    
   1100000   93.3           200            200            0.005671525    0.00021739824  0              0.016797177    1.8377104e-06  0              8.8736461      2.6109412e-16  0              2.9964577    
   1200000   93.3           200            200            0.0057001386   0.00021768823  0              0.016882728    5.070875e-06   0              24.485441      2.6109412e-16  0              2.9964495    
   1300000   93.3           200            200            0.0056907181   0.00021759266  0              0.016854562    1.9350358e-06  0              9.3435954      2.6109412e-16  0              2.9964522    
   1400000   93.3           200            200            0.0056934325   0.00021762044  0              0.016862677    4.4653518e-07  0              2.1561586      2.6109412e-16  0              2.9964515    
   1500000   93.3           200            200            0.0056928088   0.00021761396  0              0.016860812    7.7886647e-08  0              0.37608674     2.6109412e-16  0              2.9964516    
   1600000   93.3           200            200            0.0056928777   0.00021761474  0              0.016861018    1.0973655e-08  0              0.052987852    2.6109412e-16  0              2.9964516    
   1700000   93.3           200            200            0.0056929139   0.00021761507  0              0.016861127    1.2599974e-09  0              0.0060840766   2.6109412e-16  0              2.9964516    
   1800000   93.3           200            200            0.0056928792   0.00021761473  0              0.016861023    1.1340954e-10  0              0.00054761408  2.6109412e-16  0              2.9964516    
   1900000   93.3           200            200            0.0056928986   0.00021761492  0              0.016861081    6.9931163e-12  0              3.3767256e-05  2.6109412e-16  0              2.9964516    
   2000000   93.3           200            200            0.0056928897   0.00021761484  0              0.016861054    1.6678367e-13  0              8.0533866e-07  2.6109412e-16  0              2.9964516    
   2100000   93.3           200            200            0.0056928933   0.00021761487  0              0.016861065    5.2175272e-15  0              2.5193572e-08  2.6109412e-16  0              2.9964516    
   2200000   93.3           200            200            0.005692892    0.00021761486  0              0.016861061    1.1182768e-14  0              5.3997586e-08  2.6109412e-16  0              2.9964516    
   2300000   93.3           200            200            0.0056928924   0.00021761486  0              0.016861062    4.1269233e-15  0              1.9927435e-08  2.6109412e-16  0              2.9964516    
   2400000   93.3           200            200            0.0056928923   0.00021761486  0              0.016861062    9.3858129e-16  0              4.5320731e-09  2.6109412e-16  0              2.9964516    
   2500000   93.3           200            200            0.0056928923   0.00021761486  0              0.016861062    1.6204151e-16  0              7.8244046e-10  2.6109412e-16  0              2.9964516    
   2600000   93.3           200            200            0.0056928923   0.00021761486  0              0.016861062    2.2598912e-17  0              1.0912206e-10  2.6109412e-16  0              2.9964516    
   2700000   93.3           200            200            0.0056928923   0.00021761486  0              0.016861062    3.0444283e-18  0              1.4700455e-11  2.6109412e-16  0              2.9964516    
   2800000   93.3           200            200            0.0056928923   0.00021761486  0              0.016861062    2.6824919e-19  0              1.2952793e-12  2.6109412e-16  0              2.9964516    
   2900000   93.3           200            200            0.0056928923   0.00021761486  0              0.016861062    1.4014053e-19  0              6.7668849e-13  2.6109412e-16  0              2.9964516    
   3000000   93.3           200            200            0.0056928923   0.00021761486  0              0.016861062    1.5565874e-21  0              7.5162037e-15  2.6109412e-16  0              2.9964516    
Loop time of 71.7151 on 4 procs for 3000000 steps with 51 atoms

Performance: 36143019.004 ns/day, 0.000 hours/ns, 41832.198 timesteps/s
99.8% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 0.23952    | 1.4791     | 4.9922     | 166.8 |  2.06
Neigh   | 0.070038   | 0.071836   | 0.074846   |   0.7 |  0.10
Comm    | 30.411     | 37.868     | 44.547     |  92.3 | 52.80
Output  | 0.45271    | 0.49271    | 0.61       |   9.6 |  0.69
Modify  | 15.676     | 22.501     | 30.867     | 142.3 | 31.38
Other   |            | 9.302      |            |       | 12.97

Nlocal:          12.75 ave          51 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1
Nghost:          39.25 ave          52 max           1 min
Histogram: 1 0 0 0 0 0 0 0 0 3
Neighs:           8.75 ave          35 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1

Total # of neighbors = 35
Ave neighs/atom = 0.68627451
Neighbor list builds = 166
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 12

#variable lat0 equal 1                    #
variable lat1 equal 3+(v_ind*0.01)  # .491+(v_ind*0.001)       # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 10*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 3.12                                                               
Lattice spacing in x,y,z = 3.12 3.12 3.12

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -46.8 ${n1e1} -100 100 -100 100 units box
region box block -46.8 46.8 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -46.8 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -46.8 46.8 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-46.8 -100 -100) to (46.8 100 100)
  1 by 2 by 2 MPI processor grid
create_atoms 1 region substrate
Created 29 atoms
  using lattice units in orthogonal box = (-46.8 -100 -100) to (46.8 100 100)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 30 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 21 atoms
  using lattice units in orthogonal box = (-46.8 -100 -100) to (46.8 100 100)
  create_atoms CPU = 0.004 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  29 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  29 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  21 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  21 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
29 atoms in group substrate
group slider1 region slider1
21 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 21 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 10000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 10000 Equi_12_*.dump id type diameter mass xu yu zu fx fy fz

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 61 130 130
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 13.92 | 17.39 | 18.55 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   93.6           200            200            0              0              0              0              0              0              0              2.6109412e-16  0              6            
    100000   93.6           200            200            0.0045823768   7.9049013e-38  0              0.01374713     12374.17       0              6.6389378e+10  2.6109412e-16  0              3.323197     
    200000   93.6           200            200            0.0016679189   1.7110555e-36  0              0.0050037568   3146.5383      0              1.6881675e+10  2.6109412e-16  0              3.0684944    
    300000   93.6           200            200            0.00020196447 -7.7384323e-37  0              0.00060589341  90.124611      0              4.8353277e+08  2.6109412e-16  0              3.0448318    
    400000   93.6           200            200            0.027825168    0.0016252389   0              0.081850264    63.118145      0              3.3863881e+08  2.6109412e-16  0              2.9918037    
    500000   93.6           200            200            0.012125053    0.00066295619  0              0.035712202    20.751981      0              1.1133765e+08  2.6109412e-16  0              2.9946584    
    600000   93.6           200            200            0.0037094135   0.00011000967  0              0.011018231    3.1526635      0              16914537       2.6109412e-16  0              2.9968424    
    700000   93.6           200            200            0.0046513165   0.00017390838  0              0.013780041    0.12250258     0              657245.69      2.6109412e-16  0              2.9965471    
    800000   93.6           200            200            0.0059860372   0.00020391382  0              0.017754198    0.043564613    0              233731.03      2.6109412e-16  0              2.9961479    
    900000   93.6           200            200            0.005706024    0.00020120721  0              0.016916865    0.01229777     0              65979.477      2.6109412e-16  0              2.9962265    
   1000000   93.6           200            200            0.005613483    0.00020017759  0              0.016640271    9.4574456e-05  0              507.40689      2.6109412e-16  0              2.9962541    
   1100000   93.6           200            200            0.0056828386   0.00020093382  0              0.016847582    0.00013543357  0              726.62246      2.6109412e-16  0              2.9962339    
   1200000   93.6           200            200            0.00567156     0.00020081623  0              0.016813864    2.8349835e-05  0              152.10134      2.6109412e-16  0              2.9962371    
   1300000   93.6           200            200            0.0056660516   0.00020075554  0              0.016797399    6.7520211e-08  0              0.3622566      2.6109412e-16  0              2.9962387    
   1400000   93.6           200            200            0.0056694756   0.00020079245  0              0.016807634    3.9806933e-07  0              2.1357048      2.6109412e-16  0              2.9962377    
   1500000   93.6           200            200            0.0056690416   0.00020078796  0              0.016806337    6.3761698e-08  0              0.34209158     2.6109412e-16  0              2.9962378    
   1600000   93.6           200            200            0.0056687277   0.00020078451  0              0.016805399    2.604351e-12   0              1.3972754e-05  2.6109412e-16  0              2.9962379    
   1700000   93.6           200            200            0.0056688946   0.00020078631  0              0.016805897    1.129829e-09   0              0.0060617109   2.6109412e-16  0              2.9962379    
   1800000   93.6           200            200            0.0056688796   0.00020078616  0              0.016805853    1.3918706e-10  0              0.00074676053  2.6109412e-16  0              2.9962379    
   1900000   93.6           200            200            0.0056688622   0.00020078597  0              0.016805801    2.3442925e-13  0              1.2577499e-06  2.6109412e-16  0              2.9962379    
   2000000   93.6           200            200            0.0056688702   0.00020078605  0              0.016805825    3.1089144e-12  0              1.6679816e-05  2.6109412e-16  0              2.9962379    
   2100000   93.6           200            200            0.0056688698   0.00020078605  0              0.016805823    2.9365107e-13  0              1.5754844e-06  2.6109412e-16  0              2.9962379    
   2200000   93.6           200            200            0.0056688689   0.00020078604  0              0.016805821    2.6960236e-15  0              1.4464592e-08  2.6109412e-16  0              2.9962379    
   2300000   93.6           200            200            0.0056688692   0.00020078604  0              0.016805822    8.3164236e-15  0              4.4618926e-08  2.6109412e-16  0              2.9962379    
   2400000   93.6           200            200            0.0056688692   0.00020078604  0              0.016805822    5.9277456e-16  0              3.1803291e-09  2.6109412e-16  0              2.9962379    
   2500000   93.6           200            200            0.0056688692   0.00020078604  0              0.016805821    1.5558037e-17  0              8.3471326e-11  2.6109412e-16  0              2.9962379    
   2600000   93.6           200            200            0.0056688692   0.00020078604  0              0.016805822    2.1588522e-17  0              1.1582583e-10  2.6109412e-16  0              2.9962379    
   2700000   93.6           200            200            0.0056688692   0.00020078604  0              0.016805822    3.7937315e-19  0              2.0353968e-12  2.6109412e-16  0              2.9962379    
   2800000   93.6           200            200            0.0056688692   0.00020078604  0              0.016805822    3.6332029e-19  0              1.9492707e-12  2.6109412e-16  0              2.9962379    
   2900000   93.6           200            200            0.0056688692   0.00020078604  0              0.016805822    1.0120406e-19  0              5.4297575e-13  2.6109412e-16  0              2.9962379    
   3000000   93.6           200            200            0.0056688692   0.00020078604  0              0.016805822    7.5023345e-20  0              4.0251209e-13  2.6109412e-16  0              2.9962379    
Loop time of 70.2478 on 4 procs for 3000000 steps with 50 atoms

Performance: 36897929.416 ns/day, 0.000 hours/ns, 42705.937 timesteps/s
99.8% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 0.24092    | 1.3821     | 4.6456     | 160.3 |  1.97
Neigh   | 0.069383   | 0.070606   | 0.073036   |   0.6 |  0.10
Comm    | 29.716     | 36.85      | 43.268     |  90.2 | 52.46
Output  | 0.44423    | 0.48403    | 0.60092    |   9.7 |  0.69
Modify  | 15.516     | 22.224     | 30.243     | 138.4 | 31.64
Other   |            | 9.237      |            |       | 13.15

Nlocal:           12.5 ave          50 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1
Nghost:           37.5 ave          50 max           0 min
Histogram: 1 0 0 0 0 0 0 0 0 3
Neighs:           8.25 ave          33 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1

Total # of neighbors = 33
Ave neighs/atom = 0.66
Neighbor list builds = 166
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 13

#variable lat0 equal 1                    #
variable lat1 equal 3+(v_ind*0.01)  # .491+(v_ind*0.001)       # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 10*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 3.13                                                               
Lattice spacing in x,y,z = 3.13 3.13 3.13

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -46.95 ${n1e1} -100 100 -100 100 units box
region box block -46.95 46.95 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -46.95 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -46.95 46.95 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-46.95 -100 -100) to (46.95 100 100)
  1 by 2 by 2 MPI processor grid
create_atoms 1 region substrate
Created 30 atoms
  using lattice units in orthogonal box = (-46.95 -100 -100) to (46.95 100 100)
  create_atoms CPU = 0.000 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 30 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 21 atoms
  using lattice units in orthogonal box = (-46.95 -100 -100) to (46.95 100 100)
  create_atoms CPU = 0.003 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  30 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  30 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  21 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  21 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
30 atoms in group substrate
group slider1 region slider1
21 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 21 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 10000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 10000 Equi_13_*.dump id type diameter mass xu yu zu fx fy fz

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 61 130 130
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 13.92 | 17.39 | 18.55 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   93.9           200            200            0              0              0              0              0              0              0              2.6109412e-16  0              6            
    100000   93.9           200            200            0.0045634494  -1.5731204e-37  0              0.013690348    12356.95       0              5.9667291e+10  2.6109412e-16  0              3.3237859    
    200000   93.9           200            200            0.0016523028   3.805258e-36   0              0.0049569084   3116.2363      0              1.504719e+10   2.6109412e-16  0              3.0696698    
    300000   93.9           200            200            0.00018216678  1.3373382e-37  0              0.00054650034  74.836589      0              3.6135911e+08  2.6109412e-16  0              3.0451823    
    400000   93.9           200            200            0.031969612    0.0017661136   0              0.094142723    1.4049371      0              6783938.3      2.6109412e-16  0              2.9908928    
    500000   93.9           200            200            0.013339966    0.00058287739  0              0.039437021    12.947435      0              62518532       2.6109412e-16  0              2.9941686    
    600000   93.9           200            200            0.0043906264   7.4129242e-05  0              0.01309775     4.3925881      0              21210236       2.6109412e-16  0              2.9964191    
    700000   93.9           200            200            0.0046774047   0.00013504239  0              0.013897172    0.15591795     0              752871.97      2.6109412e-16  0              2.9963177    
    800000   93.9           200            200            0.0052902578   0.00016974037  0              0.015701033    0.02323105     0              112174.43      2.6109412e-16  0              2.9961235    
    900000   93.9           200            200            0.0055208753   0.0001727789   0              0.016389847    0.0044596715   0              21534.158      2.6109412e-16  0              2.9960524    
   1000000   93.9           200            200            0.0056015332   0.00017375076  0              0.016630849    0.00081188146  0              3920.285       2.6109412e-16  0              2.9960278    
   1100000   93.9           200            200            0.0056287609   0.00017406945  0              0.016712213    0.00013868437  0              669.65719      2.6109412e-16  0              2.9960196    
   1200000   93.9           200            200            0.0056376913   0.00017417322  0              0.016738901    2.2486672e-05  0              108.58009      2.6109412e-16  0              2.9960168    
   1300000   93.9           200            200            0.0056405248   0.00017420618  0              0.016747368    3.4916527e-06  0              16.859941      2.6109412e-16  0              2.996016     
   1400000   93.9           200            200            0.0056413852   0.00017421624  0              0.016749939    5.22209e-07    0              2.5215604      2.6109412e-16  0              2.9960157    
   1500000   93.9           200            200            0.00564163     0.00017421913  0              0.016750671    7.5501446e-08  0              0.36456946     2.6109412e-16  0              2.9960156    
   1600000   93.9           200            200            0.0056416923   0.00017421987  0              0.016750857    1.0576051e-08  0              0.051067966    2.6109412e-16  0              2.9960156    
   1700000   93.9           200            200            0.0056417046   0.00017422003  0              0.016750894    1.4368892e-09  0              0.0069382237   2.6109412e-16  0              2.9960156    
   1800000   93.9           200            200            0.0056417052   0.00017422004  0              0.016750896    1.8936822e-10  0              0.00091439136  2.6109412e-16  0              2.9960156    
   1900000   93.9           200            200            0.005641704    0.00017422003  0              0.016750892    2.4188764e-11  0              0.00011679889  2.6109412e-16  0              2.9960156    
   2000000   93.9           200            200            0.005641703    0.00017422002  0              0.016750889    2.9893616e-12  0              1.4434557e-05  2.6109412e-16  0              2.9960156    
   2100000   93.9           200            200            0.0056417025   0.00017422001  0              0.016750887    3.5622292e-13  0              1.720073e-06   2.6109412e-16  0              2.9960156    
   2200000   93.9           200            200            0.0056417022   0.00017422001  0              0.016750887    4.0723567e-14  0              1.9663953e-07  2.6109412e-16  0              2.9960156    
   2300000   93.9           200            200            0.0056417021   0.00017422001  0              0.016750886    4.4293016e-15  0              2.1387512e-08  2.6109412e-16  0              2.9960156    
   2400000   93.9           200            200            0.005641702    0.00017422001  0              0.016750886    4.5860453e-16  0              2.2144371e-09  2.6109412e-16  0              2.9960156    
   2500000   93.9           200            200            0.005641702    0.00017422001  0              0.016750886    4.519963e-17   0              2.1825284e-10  2.6109412e-16  0              2.9960156    
   2600000   93.9           200            200            0.005641702    0.00017422001  0              0.016750886    3.6752744e-18  0              1.7746585e-11  2.6109412e-16  0              2.9960156    
   2700000   93.9           200            200            0.005641702    0.00017422001  0              0.016750886    9.4272907e-19  0              4.5521013e-12  2.6109412e-16  0              2.9960156    
   2800000   93.9           200            200            0.005641702    0.00017422001  0              0.016750886    2.7973194e-19  0              1.3507254e-12  2.6109412e-16  0              2.9960156    
   2900000   93.9           200            200            0.005641702    0.00017422001  0              0.016750886    2.1378427e-21  0              1.0322877e-14  2.6109412e-16  0              2.9960156    
   3000000   93.9           200            200            0.005641702    0.00017422001  0              0.016750886    2.3015167e-21  0              1.11132e-14    2.6109412e-16  0              2.9960156    
Loop time of 70.8057 on 4 procs for 3000000 steps with 51 atoms

Performance: 36607231.571 ns/day, 0.000 hours/ns, 42369.481 timesteps/s
99.8% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 0.23992    | 1.4163     | 4.7768     | 163.1 |  2.00
Neigh   | 0.067765   | 0.069513   | 0.072469   |   0.7 |  0.10
Comm    | 30.202     | 37.602     | 44.18      |  91.8 | 53.11
Output  | 0.44858    | 0.48852    | 0.60549    |   9.7 |  0.69
Modify  | 15.326     | 22.116     | 30.424     | 143.0 | 31.23
Other   |            | 9.114      |            |       | 12.87

Nlocal:          12.75 ave          51 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1
Nghost:          39.25 ave          52 max           1 min
Histogram: 1 0 0 0 0 0 0 0 0 3
Neighs:           8.25 ave          33 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1

Total # of neighbors = 33
Ave neighs/atom = 0.64705882
Neighbor list builds = 166
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 14

#variable lat0 equal 1                    #
variable lat1 equal 3+(v_ind*0.01)  # .491+(v_ind*0.001)       # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 10*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 3.14                                                               
Lattice spacing in x,y,z = 3.14 3.14 3.14

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -47.1 ${n1e1} -100 100 -100 100 units box
region box block -47.1 47.1 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -47.1 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -47.1 47.1 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-47.1 -100 -100) to (47.1 100 100)
  1 by 2 by 2 MPI processor grid
create_atoms 1 region substrate
Created 30 atoms
  using lattice units in orthogonal box = (-47.1 -100 -100) to (47.1 100 100)
  create_atoms CPU = 0.000 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 30 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 21 atoms
  using lattice units in orthogonal box = (-47.1 -100 -100) to (47.1 100 100)
  create_atoms CPU = 0.003 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  30 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  30 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  21 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  21 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
30 atoms in group substrate
group slider1 region slider1
21 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 21 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 10000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 10000 Equi_14_*.dump id type diameter mass xu yu zu fx fy fz

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 61 130 130
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 13.92 | 17.39 | 18.55 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   94.2           200            200            0              0              0              0              0              0              0              2.6109412e-16  0              6            
    100000   94.2           200            200            0.0045445899   5.2558371e-38  0              0.01363377     12339.392      0              5.9582507e+10  2.6109412e-16  0              3.3244331    
    200000   94.2           200            200            0.0016375535   4.2143322e-36  0              0.0049126606   3088.3064      0              1.4912326e+10  2.6109412e-16  0              3.0707286    
    300000   94.2           200            200            0.00016238782  2.6173938e-36  0              0.00048716346  60.720618      0              2.9319813e+08  2.6109412e-16  0              3.0455015    
    400000   94.2           200            200            0.030238746    0.001733387    0              0.08898285     22.859706      0              1.1038134e+08  2.6109412e-16  0              2.9908879    
    500000   94.2           200            200            0.0026221417  -1.6251337e-35  0              0.0078664251   27.672731      0              1.3362171e+08  2.6109412e-16  0              2.997182     
    600000   94.2           200            200            0.0074643448   0.00021712849  0              0.022175906    3.4685914      0              16748586       2.6109412e-16  0              2.9952666    
    700000   94.2           200            200            0.0055142189   0.00016290581  0              0.016379751    0.68826305     0              3323375.9      2.6109412e-16  0              2.9958171    
    800000   94.2           200            200            0.0057801258   0.00013874464  0              0.017201633    0.076011734    0              367033.46      2.6109412e-16  0              2.9957381    
    900000   94.2           200            200            0.0054914016   0.0001355203   0              0.016338684    0.0040601743   0              19605.129      2.6109412e-16  0              2.9958262    
   1000000   94.2           200            200            0.0056645758   0.00013756529  0              0.016856162    1.025355e-05   0              49.510725      2.6109412e-16  0              2.9957723    
   1100000   94.2           200            200            0.0055934701   0.0001367496   0              0.016643661    4.4314566e-05  0              213.97918      2.6109412e-16  0              2.9957945    
   1200000   94.2           200            200            0.0056150012   0.00013700353  0              0.016708       2.1632603e-05  0              104.4561       2.6109412e-16  0              2.9957877    
   1300000   94.2           200            200            0.0056109768   0.00013695531  0              0.016695975    4.1726445e-06  0              20.148207      2.6109412e-16  0              2.995789     
   1400000   94.2           200            200            0.0056106103   0.00013695168  0              0.016694879    4.4065536e-07  0              2.127767       2.6109412e-16  0              2.9957891    
   1500000   94.2           200            200            0.0056113871   0.00013696052  0              0.016697201    2.0683252e-08  0              0.09987202     2.6109412e-16  0              2.9957888    
   1600000   94.2           200            200            0.005610945    0.00013695542  0              0.016695879    1.4711105e-12  0              7.1034662e-06  2.6109412e-16  0              2.995789     
   1700000   94.2           200            200            0.0056111197   0.00013695745  0              0.016696402    3.4942796e-10  0              0.0016872626   2.6109412e-16  0              2.9957889    
   1800000   94.2           200            200            0.0056110689   0.00013695685  0              0.01669625     1.4394009e-10  0              0.00069503519  2.6109412e-16  0              2.9957889    
   1900000   94.2           200            200            0.0056110774   0.00013695696  0              0.016696275    2.5658795e-11  0              0.00012389714  2.6109412e-16  0              2.9957889    
   2000000   94.2           200            200            0.0056110789   0.00013695697  0              0.01669628     2.5064784e-12  0              1.2102887e-05  2.6109412e-16  0              2.9957889    
   2100000   94.2           200            200            0.0056110768   0.00013695695  0              0.016696274    1.003184e-13   0              4.8440166e-07  2.6109412e-16  0              2.9957889    
   2200000   94.2           200            200            0.005611078    0.00013695696  0              0.016696277    1.8864889e-16  0              9.1091797e-10  2.6109412e-16  0              2.9957889    
   2300000   94.2           200            200            0.0056110775   0.00013695696  0              0.016696276    2.6591646e-15  0              1.2840154e-08  2.6109412e-16  0              2.9957889    
   2400000   94.2           200            200            0.0056110776   0.00013695696  0              0.016696276    9.4588987e-16  0              4.5673636e-09  2.6109412e-16  0              2.9957889    
   2500000   94.2           200            200            0.0056110776   0.00013695696  0              0.016696276    1.565938e-16   0              7.5613542e-10  2.6109412e-16  0              2.9957889    
   2600000   94.2           200            200            0.0056110776   0.00013695696  0              0.016696276    1.3556356e-17  0              6.5458792e-11  2.6109412e-16  0              2.9957889    
   2700000   94.2           200            200            0.0056110776   0.00013695696  0              0.016696276    1.3099596e-18  0              6.325326e-12   2.6109412e-16  0              2.9957889    
   2800000   94.2           200            200            0.0056110776   0.00013695696  0              0.016696276    1.7921107e-19  0              8.6534611e-13  2.6109412e-16  0              2.9957889    
   2900000   94.2           200            200            0.0056110776   0.00013695696  0              0.016696276    3.830127e-20   0              1.8494313e-13  2.6109412e-16  0              2.9957889    
   3000000   94.2           200            200            0.0056110776   0.00013695696  0              0.016696276    3.9913492e-20  0              1.9272797e-13  2.6109412e-16  0              2.9957889    
Loop time of 70.6538 on 4 procs for 3000000 steps with 51 atoms

Performance: 36685942.039 ns/day, 0.000 hours/ns, 42460.581 timesteps/s
99.8% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 0.22943    | 1.3634     | 4.5943     | 159.8 |  1.93
Neigh   | 0.072366   | 0.074628   | 0.077967   |   0.9 |  0.11
Comm    | 30.208     | 37.621     | 44.166     |  92.0 | 53.25
Output  | 0.44725    | 0.48704    | 0.60352    |   9.6 |  0.69
Modify  | 15.239     | 22.06      | 30.367     | 142.8 | 31.22
Other   |            | 9.047      |            |       | 12.80

Nlocal:          12.75 ave          51 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1
Nghost:          39.25 ave          52 max           1 min
Histogram: 1 0 0 0 0 0 0 0 0 3
Neighs:           7.75 ave          31 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1

Total # of neighbors = 31
Ave neighs/atom = 0.60784314
Neighbor list builds = 166
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 15

#variable lat0 equal 1                    #
variable lat1 equal 3+(v_ind*0.01)  # .491+(v_ind*0.001)       # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 10*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 3.15                                                               
Lattice spacing in x,y,z = 3.15 3.15 3.15

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -47.25 ${n1e1} -100 100 -100 100 units box
region box block -47.25 47.25 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -47.25 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -47.25 47.25 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-47.25 -100 -100) to (47.25 100 100)
  1 by 2 by 2 MPI processor grid
create_atoms 1 region substrate
Created 30 atoms
  using lattice units in orthogonal box = (-47.25 -100 -100) to (47.25 100 100)
  create_atoms CPU = 0.000 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 30 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 21 atoms
  using lattice units in orthogonal box = (-47.25 -100 -100) to (47.25 100 100)
  create_atoms CPU = 0.003 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  30 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  30 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  21 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  21 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
30 atoms in group substrate
group slider1 region slider1
21 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 21 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 10000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 10000 Equi_15_*.dump id type diameter mass xu yu zu fx fy fz

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 61 130 130
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 13.92 | 17.39 | 18.55 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   94.5           200            200            0              0              0              0              0              0              0              2.6109412e-16  0              6            
    100000   94.5           200            200            0.0045258103   5.2661531e-38  0              0.013577431    12321.536      0              5.9496286e+10  2.6109412e-16  0              3.3251408    
    200000   94.5           200            200            0.0016229291   5.0435104e-36  0              0.0048687873   3060.5252      0              1.4778181e+10  2.6109412e-16  0              3.0717994    
    300000   94.5           200            200            0.00014450779  5.1263161e-36  0              0.00043352337  49.047837      0              2.3683445e+08  2.6109412e-16  0              3.0457249    
    400000   94.5           200            200            0.02454643     0.0013717911   0              0.072267499    92.859689      0              4.483862e+08   2.6109412e-16  0              2.9915259    
    500000   94.5           200            200            0.00069523098  1.9452593e-35  0              0.0020856929   0.15308955     0              739214.64      2.6109412e-16  0              2.9987939    
    600000   94.5           200            200            0.0070628319   0.00015946245  0              0.021029033    3.8437496      0              18560091       2.6109412e-16  0              2.995122     
    700000   94.5           200            200            0.0046190096   4.0589785e-05  0              0.013816439    0.060222752    0              290794.12      2.6109412e-16  0              2.9959026    
    800000   94.5           200            200            0.0053493234   9.048661e-05   0              0.015957484    0.056088184    0              270829.77      2.6109412e-16  0              2.9956406    
    900000   94.5           200            200            0.0055429591   9.0725243e-05  0              0.016538152    0.011328005    0              54698.883      2.6109412e-16  0              2.9955755    
   1000000   94.5           200            200            0.0055840846   9.1186525e-05  0              0.016661067    0.0016015085   0              7733.1113      2.6109412e-16  0              2.9955622    
   1100000   94.5           200            200            0.0055866879   9.1209939e-05  0              0.016668854    0.00016848451  0              813.55141      2.6109412e-16  0              2.9955615    
   1200000   94.5           200            200            0.0055829878   9.1165825e-05  0              0.016657798    1.2099675e-05  0              58.425001      2.6109412e-16  0              2.9955628    
   1300000   94.5           200            200            0.0055801106   9.1132423e-05  0              0.016649199    3.936877e-07   0              1.900977       2.6109412e-16  0              2.9955638    
   1400000   94.5           200            200            0.0055786408   9.1115499e-05  0              0.016644807    1.6542556e-09  0              0.0079878085   2.6109412e-16  0              2.9955642    
   1500000   94.5           200            200            0.005578023    9.1108425e-05  0              0.016642961    1.2716621e-08  0              0.061404012    2.6109412e-16  0              2.9955645    
   1600000   94.5           200            200            0.0055777986   9.110587e-05   0              0.01664229     5.1510841e-09  0              0.024872741    2.6109412e-16  0              2.9955645    
   1700000   94.5           200            200            0.0055777284   9.1105076e-05  0              0.01664208     1.1507234e-09  0              0.0055564317   2.6109412e-16  0              2.9955646    
   1800000   94.5           200            200            0.0055777106   9.1104877e-05  0              0.016642027    1.8315907e-10  0              0.0008844096   2.6109412e-16  0              2.9955646    
   1900000   94.5           200            200            0.005577708    9.1104849e-05  0              0.016642019    2.1936477e-11  0              0.0001059234   2.6109412e-16  0              2.9955646    
   2000000   94.5           200            200            0.0055777086   9.1104856e-05  0              0.016642021    1.8994521e-12  0              9.1717743e-06  2.6109412e-16  0              2.9955646    
   2100000   94.5           200            200            0.0055777093   9.1104865e-05  0              0.016642023    9.64695e-14    0              4.6581669e-07  2.6109412e-16  0              2.9955646    
   2200000   94.5           200            200            0.0055777098   9.110487e-05   0              0.016642024    6.9409814e-16  0              3.3515515e-09  2.6109412e-16  0              2.9955646    
   2300000   94.5           200            200            0.00557771     9.1104873e-05  0              0.016642025    5.8068501e-16  0              2.8039201e-09  2.6109412e-16  0              2.9955646    
   2400000   94.5           200            200            0.00557771     9.1104874e-05  0              0.016642025    4.0694977e-16  0              1.9650148e-09  2.6109412e-16  0              2.9955646    
   2500000   94.5           200            200            0.0055777101   9.1104874e-05  0              0.016642025    1.1011725e-16  0              5.3171677e-10  2.6109412e-16  0              2.9955646    
   2600000   94.5           200            200            0.0055777101   9.1104874e-05  0              0.016642025    1.9494437e-17  0              9.413166e-11   2.6109412e-16  0              2.9955646    
   2700000   94.5           200            200            0.0055777101   9.1104874e-05  0              0.016642025    2.3045077e-18  0              1.1127643e-11  2.6109412e-16  0              2.9955646    
   2800000   94.5           200            200            0.0055777101   9.1104874e-05  0              0.016642025    5.0277795e-20  0              2.4277348e-13  2.6109412e-16  0              2.9955646    
   2900000   94.5           200            200            0.0055777101   9.1104874e-05  0              0.016642025    6.8346721e-20  0              3.3002186e-13  2.6109412e-16  0              2.9955646    
   3000000   94.5           200            200            0.0055777101   9.1104874e-05  0              0.016642025    4.6011611e-20  0              2.221736e-13   2.6109412e-16  0              2.9955646    
Loop time of 70.6178 on 4 procs for 3000000 steps with 51 atoms

Performance: 36704633.768 ns/day, 0.000 hours/ns, 42482.215 timesteps/s
99.8% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 0.22625    | 1.4266     | 4.8107     | 163.6 |  2.02
Neigh   | 0.068794   | 0.070469   | 0.073117   |   0.6 |  0.10
Comm    | 30.025     | 37.616     | 44.26      |  92.9 | 53.27
Output  | 0.44545    | 0.48536    | 0.60216    |   9.7 |  0.69
Modify  | 15.147     | 21.974     | 30.421     | 144.0 | 31.12
Other   |            | 9.046      |            |       | 12.81

Nlocal:          12.75 ave          51 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1
Nghost:          39.25 ave          52 max           1 min
Histogram: 1 0 0 0 0 0 0 0 0 3
Neighs:           7.75 ave          31 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1

Total # of neighbors = 31
Ave neighs/atom = 0.60784314
Neighbor list builds = 164
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 16

#variable lat0 equal 1                    #
variable lat1 equal 3+(v_ind*0.01)  # .491+(v_ind*0.001)       # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 10*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 3.16                                                               
Lattice spacing in x,y,z = 3.16 3.16 3.16

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -47.4 ${n1e1} -100 100 -100 100 units box
region box block -47.4 47.4 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -47.4 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -47.4 47.4 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-47.4 -100 -100) to (47.4 100 100)
  1 by 2 by 2 MPI processor grid
create_atoms 1 region substrate
Created 29 atoms
  using lattice units in orthogonal box = (-47.4 -100 -100) to (47.4 100 100)
  create_atoms CPU = 0.000 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 30 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 21 atoms
  using lattice units in orthogonal box = (-47.4 -100 -100) to (47.4 100 100)
  create_atoms CPU = 0.003 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  29 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  29 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  21 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  21 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
29 atoms in group substrate
group slider1 region slider1
21 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 21 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 10000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 10000 Equi_16_*.dump id type diameter mass xu yu zu fx fy fz

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 62 130 130
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 13.94 | 17.41 | 18.57 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   94.8           200            200            0              0              0              0              0              0              0              2.6109412e-16  0              6            
    100000   94.8           200            200            0.0045072927   3.1344038e-37  0              0.013521878    12304.228      0              6.6014128e+10  2.6109412e-16  0              3.3258434    
    200000   94.8           200            200            0.0016084244  -6.6151519e-36  0              0.0048252732   3032.8799      0              1.627188e+10   2.6109412e-16  0              3.072884     
    300000   94.8           200            200            0.00013053577  8.4391114e-36  0              0.00039160731  40.712848      0              2.1843086e+08  2.6109412e-16  0              3.0458005    
    400000   94.8           200            200            0.016438614    0.00075852684  0              0.048557315    168.96451      0              9.0652125e+08  2.6109412e-16  0              2.9927109    
    500000   94.8           200            200            0.0045573003   1.6806085e-08  0              0.013671884    33.140442      0              1.778037e+08   2.6109412e-16  0              2.9957304    
    600000   94.8           200            200            0.004527921   -6.3793848e-37  0              0.013583763    3.7164311      0              19939240       2.6109412e-16  0              2.9958353    
    700000   94.8           200            200            0.0062384499   6.9372714e-05  0              0.018645977    0.34641119     0              1858550.7      2.6109412e-16  0              2.9951175    
    800000   94.8           200            200            0.0053150666   2.6372443e-05  0              0.015918827    0.049068955    0              263262.69      2.6109412e-16  0              2.9954427    
    900000   94.8           200            200            0.0054169687   3.8173492e-05  0              0.016212732    0.00014037764  0              753.14819      2.6109412e-16  0              2.9954028    
   1000000   94.8           200            200            0.0055179297   3.9375927e-05  0              0.016514413    0.0011293406   0              6059.0908      2.6109412e-16  0              2.9953644    
   1100000   94.8           200            200            0.005548559    3.9688455e-05  0              0.016605989    0.00018362295  0              985.16612      2.6109412e-16  0              2.9953531    
   1200000   94.8           200            200            0.0055486462   3.9686965e-05  0              0.016606252    2.5506302e-06  0              13.684534      2.6109412e-16  0              2.9953532    
   1300000   94.8           200            200            0.0055445446   3.9645166e-05  0              0.016593989    1.2264951e-06  0              6.5803399      2.6109412e-16  0              2.9953547    
   1400000   94.8           200            200            0.0055426722   3.9626288e-05  0              0.01658839     5.1734031e-07  0              2.7756125      2.6109412e-16  0              2.9953554    
   1500000   94.8           200            200            0.0055423762   3.9623392e-05  0              0.016587505    3.1341627e-08  0              0.16815278     2.6109412e-16  0              2.9953555    
   1600000   94.8           200            200            0.005542495    3.9624637e-05  0              0.01658786     2.8465518e-10  0              0.00152722     2.6109412e-16  0              2.9953555    
   1700000   94.8           200            200            0.005542589    3.9625594e-05  0              0.016588141    1.0001199e-09  0              0.0053658014   2.6109412e-16  0              2.9953555    
   1800000   94.8           200            200            0.0055426157   3.962586e-05   0              0.016588221    1.4615347e-10  0              0.00078413646  2.6109412e-16  0              2.9953554    
   1900000   94.8           200            200            0.0055426151   3.9625852e-05  0              0.016588219    1.4756053e-12  0              7.9168553e-06  2.6109412e-16  0              2.9953554    
   2000000   94.8           200            200            0.0055426112   3.9625812e-05  0              0.016588208    1.1747456e-12  0              6.3026956e-06  2.6109412e-16  0              2.9953554    
   2100000   94.8           200            200            0.0055426095   3.9625795e-05  0              0.016588203    4.3161083e-13  0              2.3156602e-06  2.6109412e-16  0              2.9953554    
   2200000   94.8           200            200            0.0055426093   3.9625793e-05  0              0.016588202    2.3047205e-14  0              1.2365189e-07  2.6109412e-16  0              2.9953554    
   2300000   94.8           200            200            0.0055426094   3.9625794e-05  0              0.016588202    3.9386333e-16  0              2.113139e-09   2.6109412e-16  0              2.9953554    
   2400000   94.8           200            200            0.0055426095   3.9625795e-05  0              0.016588203    8.7129424e-16  0              4.6746312e-09  2.6109412e-16  0              2.9953554    
   2500000   94.8           200            200            0.0055426095   3.9625795e-05  0              0.016588203    1.1667649e-16  0              6.2598777e-10  2.6109412e-16  0              2.9953554    
   2600000   94.8           200            200            0.0055426095   3.9625795e-05  0              0.016588203    1.1847755e-18  0              6.3565074e-12  2.6109412e-16  0              2.9953554    
   2700000   94.8           200            200            0.0055426095   3.9625795e-05  0              0.016588203    1.6611137e-18  0              8.9121374e-12  2.6109412e-16  0              2.9953554    
   2800000   94.8           200            200            0.0055426095   3.9625795e-05  0              0.016588203    2.3790244e-19  0              1.2763842e-12  2.6109412e-16  0              2.9953554    
   2900000   94.8           200            200            0.0055426095   3.9625795e-05  0              0.016588203    1.3458489e-19  0              7.220692e-13   2.6109412e-16  0              2.9953554    
   3000000   94.8           200            200            0.0055426095   3.9625795e-05  0              0.016588203    1.8474643e-20  0              9.9119375e-14  2.6109412e-16  0              2.9953554    
Loop time of 69.208 on 4 procs for 3000000 steps with 50 atoms

Performance: 37452295.942 ns/day, 0.000 hours/ns, 43347.565 timesteps/s
99.8% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 0.22697    | 1.2939     | 4.3442     | 154.9 |  1.87
Neigh   | 0.067951   | 0.069802   | 0.072582   |   0.7 |  0.10
Comm    | 29.4       | 36.707     | 43.06      |  91.1 | 53.04
Output  | 0.44671    | 0.48655    | 0.6033     |   9.7 |  0.70
Modify  | 14.982     | 21.644     | 29.71      | 140.0 | 31.27
Other   |            | 9.007      |            |       | 13.01

Nlocal:           12.5 ave          50 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1
Nghost:           37.5 ave          50 max           0 min
Histogram: 1 0 0 0 0 0 0 0 0 3
Neighs:           7.25 ave          29 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1

Total # of neighbors = 29
Ave neighs/atom = 0.58
Neighbor list builds = 164
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 17

#variable lat0 equal 1                    #
variable lat1 equal 3+(v_ind*0.01)  # .491+(v_ind*0.001)       # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 10*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 3.17                                                               
Lattice spacing in x,y,z = 3.17 3.17 3.17

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -47.55 ${n1e1} -100 100 -100 100 units box
region box block -47.55 47.55 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -47.55 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -47.55 47.55 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-47.55 -100 -100) to (47.55 100 100)
  1 by 2 by 2 MPI processor grid
create_atoms 1 region substrate
Created 30 atoms
  using lattice units in orthogonal box = (-47.55 -100 -100) to (47.55 100 100)
  create_atoms CPU = 0.000 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 30 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 21 atoms
  using lattice units in orthogonal box = (-47.55 -100 -100) to (47.55 100 100)
  create_atoms CPU = 0.002 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  30 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  30 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  21 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  21 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
30 atoms in group substrate
group slider1 region slider1
21 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 21 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 10000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 10000 Equi_17_*.dump id type diameter mass xu yu zu fx fy fz

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 62 130 130
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 13.94 | 17.41 | 18.57 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   95.1           200            200            0              0              0              0              0              0              0              2.6109412e-16  0              6            
    100000   95.1           200            200            0.0044893005  -2.0483881e-37  0              0.013467902    12288.726      0              5.9337858e+10  2.6109412e-16  0              3.3264358    
    200000   95.1           200            200            0.001593708   -1.6146906e-36  0              0.0047811239   3004.3743      0              1.4507048e+10  2.6109412e-16  0              3.0740438    
    300000   95.1           200            200            0.00011890313  4.2663414e-36  0              0.00035670939  34.307508      0              1.6565868e+08  2.6109412e-16  0              3.0457895    
    400000   95.1           200            200            0.008156398    0.00011330252  0              0.024355891    210.20062      0              1.0149836e+09  2.6109412e-16  0              2.9943669    
    500000   95.1           200            200            0.011831956    0.00038636863  0              0.035109499    12.549447      0              60596789       2.6109412e-16  0              2.9933467    
    600000   95.1           200            200            0.0036339238  -4.3730754e-36  0              0.010901771    0.0018748154   0              9052.8128      2.6109412e-16  0              2.9963756    
    700000   95.1           200            200            0.0051699217   2.5248354e-36  0              0.015509765    0.42140915     0              2034834        2.6109412e-16  0              2.9954225    
    800000   95.1           200            200            0.0053452208  -1.3204422e-36  0              0.016035662    0.043148381    0              208348.09      2.6109412e-16  0              2.9953097    
    900000   95.1           200            200            0.0054301411  -2.464887e-37   0              0.016290423    0.0022979493   0              11095.975      2.6109412e-16  0              2.9952629    
   1000000   95.1           200            200            0.0054804921   4.6955208e-37  0              0.016441476    0.000231199    0              1116.3772      2.6109412e-16  0              2.9952333    
   1100000   95.1           200            200            0.0054995684   5.3859495e-37  0              0.016498705    1.4778089e-05  0              71.358102      2.6109412e-16  0              2.9952221    
   1200000   95.1           200            200            0.0055070858   1.7768181e-37  0              0.016521257    5.510713e-07   0              2.6609261      2.6109412e-16  0              2.9952177    
   1300000   95.1           200            200            0.0055099802  -8.8810433e-38  0              0.016529941    4.2066483e-10  0              0.0020312399   2.6109412e-16  0              2.995216     
   1400000   95.1           200            200            0.0055110714  -1.2586308e-37  0              0.016533214    7.3140456e-09  0              0.035316909    2.6109412e-16  0              2.9952154    
   1500000   95.1           200            200            0.0055114746  -3.4207761e-39  0              0.016534424    4.2352606e-09  0              0.020450558    2.6109412e-16  0              2.9952151    
   1600000   95.1           200            200            0.0055116207   1.1692583e-38  0              0.016534862    1.2842636e-09  0              0.0062012494   2.6109412e-16  0              2.9952151    
   1700000   95.1           200            200            0.0055116725   5.219228e-39   0              0.016535018    2.9929653e-10  0              0.0014451959   2.6109412e-16  0              2.995215     
   1800000   95.1           200            200            0.0055116905  -4.4942151e-38  0              0.016535072    6.0119103e-11  0              0.00029029363  2.6109412e-16  0              2.995215     
   1900000   95.1           200            200            0.0055116966  -6.3608712e-39  0              0.01653509     1.093857e-11   0              5.2818438e-05  2.6109412e-16  0              2.995215     
   2000000   95.1           200            200            0.0055116987  -1.9236185e-39  0              0.016535096    1.8500892e-12  0              8.9334185e-06  2.6109412e-16  0              2.995215     
   2100000   95.1           200            200            0.0055116993   4.0223891e-39  0              0.016535098    2.9515651e-13  0              1.4252052e-06  2.6109412e-16  0              2.995215     
   2200000   95.1           200            200            0.0055116995   5.1349706e-39  0              0.016535098    4.4808512e-14  0              2.1636427e-07  2.6109412e-16  0              2.995215     
   2300000   95.1           200            200            0.0055116995   4.3644408e-38  0              0.016535099    6.5156641e-15  0              3.146181e-08   2.6109412e-16  0              2.995215     
   2400000   95.1           200            200            0.0055116995  -2.9368235e-38  0              0.016535099    9.0898685e-16  0              4.3891722e-09  2.6109412e-16  0              2.995215     
   2500000   95.1           200            200            0.0055116995   2.6013939e-38  0              0.016535099    1.2187472e-16  0              5.8848941e-10  2.6109412e-16  0              2.995215     
   2600000   95.1           200            200            0.0055116995  -6.762482e-40   0              0.016535099    1.5503935e-17  0              7.4862953e-11  2.6109412e-16  0              2.995215     
   2700000   95.1           200            200            0.0055116995   2.0331979e-38  0              0.016535099    1.9209614e-18  0              9.2756351e-12  2.6109412e-16  0              2.995215     
   2800000   95.1           200            200            0.0055116995   1.1444749e-38  0              0.016535099    1.7928457e-19  0              8.65701e-13    2.6109412e-16  0              2.995215     
   2900000   95.1           200            200            0.0055116995   5.2495946e-39  0              0.016535099    1.1195543e-19  0              5.4059269e-13  2.6109412e-16  0              2.995215     
   3000000   95.1           200            200            0.0055116995   8.4258554e-39  0              0.016535099    2.7687052e-20  0              1.3369086e-13  2.6109412e-16  0              2.995215     
Loop time of 70.5993 on 4 procs for 3000000 steps with 51 atoms

Performance: 36714228.163 ns/day, 0.000 hours/ns, 42493.320 timesteps/s
99.8% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 0.22208    | 1.2814     | 4.2696     | 152.4 |  1.82
Neigh   | 0.075501   | 0.076241   | 0.078044   |   0.4 |  0.11
Comm    | 30.057     | 37.752     | 44.242     |  94.0 | 53.47
Output  | 0.44494    | 0.48486    | 0.60192    |   9.7 |  0.69
Modify  | 15.129     | 21.949     | 30.355     | 143.6 | 31.09
Other   |            | 9.056      |            |       | 12.83

Nlocal:          12.75 ave          51 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1
Nghost:          39.25 ave          52 max           1 min
Histogram: 1 0 0 0 0 0 0 0 0 3
Neighs:           7.25 ave          29 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1

Total # of neighbors = 29
Ave neighs/atom = 0.56862745
Neighbor list builds = 164
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 18

#variable lat0 equal 1                    #
variable lat1 equal 3+(v_ind*0.01)  # .491+(v_ind*0.001)       # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 10*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 3.18                                                               
Lattice spacing in x,y,z = 3.18 3.18 3.18

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -47.7 ${n1e1} -100 100 -100 100 units box
region box block -47.7 47.7 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -47.7 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -47.7 47.7 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-47.7 -100 -100) to (47.7 100 100)
  1 by 2 by 2 MPI processor grid
create_atoms 1 region substrate
Created 30 atoms
  using lattice units in orthogonal box = (-47.7 -100 -100) to (47.7 100 100)
  create_atoms CPU = 0.000 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 30 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 21 atoms
  using lattice units in orthogonal box = (-47.7 -100 -100) to (47.7 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  30 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  30 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  21 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  21 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
30 atoms in group substrate
group slider1 region slider1
21 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 21 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 10000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 10000 Equi_18_*.dump id type diameter mass xu yu zu fx fy fz

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 62 130 130
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 13.94 | 17.41 | 18.57 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   95.4           200            200            0              0              0              0              0              0              0              2.6109412e-16  0              6            
    100000   95.4           200            200            0.0044720429   7.6325365e-40  0              0.013416129    12276.065      0              5.9276725e+10  2.6109412e-16  0              3.3268235    
    200000   95.4           200            200            0.001579368   -7.7554894e-37  0              0.0047381041   2976.7796      0              1.4373803e+10  2.6109412e-16  0              3.0751758    
    300000   95.4           200            200            0.0001088138   9.5394121e-38  0              0.0003264414   29.149913      0              1.407545e+08   2.6109412e-16  0              3.0457214    
    400000   95.4           200            200            0.0040119272  -1.415948e-35   0              0.012035782    207.14943      0              1.0002504e+09  2.6109412e-16  0              2.9963224    
    500000   95.4           200            200            0.0014954839  -4.2004677e-35  0              0.0044864516   7.6762878      0              37066046       2.6109412e-16  0              2.99804      
    600000   95.4           200            200            0.0044658572   3.2308967e-35  0              0.013397572    2.8022562      0              13531093       2.6109412e-16  0              2.9958137    
    700000   95.4           200            200            0.0050042228   1.9984567e-36  0              0.015012668    0.27008059     0              1304122.5      2.6109412e-16  0              2.9954984    
    800000   95.4           200            200            0.0053434761  -2.7901234e-36  0              0.016030428    0.047933386    0              231453.17      2.6109412e-16  0              2.9953007    
    900000   95.4           200            200            0.0054502423   5.9495215e-37  0              0.016350727    0.0077520393   0              37431.823      2.6109412e-16  0              2.9952397    
   1000000   95.4           200            200            0.0054825984   3.1913244e-37  0              0.016447795    0.0011858988   0              5726.2811      2.6109412e-16  0              2.9952215    
   1100000   95.4           200            200            0.0054917592   5.7588952e-38  0              0.016475278    0.00017333624  0              836.97865      2.6109412e-16  0              2.9952164    
   1200000   95.4           200            200            0.005494059   -1.325064e-38   0              0.016482177    2.4308686e-05  0              117.37795      2.6109412e-16  0              2.9952151    
   1300000   95.4           200            200            0.0054944954  -2.515545e-38   0              0.016483486    3.2763546e-06  0              15.820344      2.6109412e-16  0              2.9952149    
   1400000   95.4           200            200            0.0054945023   1.2231994e-38  0              0.016483507    4.2435865e-07  0              2.049076       2.6109412e-16  0              2.9952149    
   1500000   95.4           200            200            0.0054944482  -3.0098332e-39  0              0.016483345    5.2724474e-08  0              0.25458762     2.6109412e-16  0              2.995215     
   1600000   95.4           200            200            0.0054944079   1.4889705e-38  0              0.016483224    6.2603746e-09  0              0.030229108    2.6109412e-16  0              2.995215     
   1700000   95.4           200            200            0.0054943859  -7.8783738e-39  0              0.016483158    7.0584699e-10  0              0.0034082825   2.6109412e-16  0              2.995215     
   1800000   95.4           200            200            0.0054943753  -6.1641956e-38  0              0.016483126    7.4777227e-11  0              0.00036107247  2.6109412e-16  0              2.995215     
   1900000   95.4           200            200            0.0054943705   7.0193052e-38  0              0.016483112    7.3135057e-12  0              3.5314302e-05  2.6109412e-16  0              2.995215     
   2000000   95.4           200            200            0.0054943685  -9.5552752e-39  0              0.016483106    6.3983736e-13  0              3.0895456e-06  2.6109412e-16  0              2.995215     
   2100000   95.4           200            200            0.0054943677   5.7783112e-38  0              0.016483103    4.700148e-14   0              2.2695333e-07  2.6109412e-16  0              2.995215     
   2200000   95.4           200            200            0.0054943674  -2.2147969e-39  0              0.016483102    2.4667339e-15  0              1.1910975e-08  2.6109412e-16  0              2.995215     
   2300000   95.4           200            200            0.0054943672   5.6076361e-38  0              0.016483102    4.6323239e-17  0              2.2367834e-10  2.6109412e-16  0              2.995215     
   2400000   95.4           200            200            0.0054943672   4.8691936e-38  0              0.016483102    3.6082366e-18  0              1.7422883e-11  2.6109412e-16  0              2.995215     
   2500000   95.4           200            200            0.0054943672   3.0702592e-38  0              0.016483102    4.9417544e-18  0              2.3861964e-11  2.6109412e-16  0              2.995215     
   2600000   95.4           200            200            0.0054943672   2.8120048e-38  0              0.016483101    1.9625292e-18  0              9.4763511e-12  2.6109412e-16  0              2.995215     
   2700000   95.4           200            200            0.0054943672   8.6348868e-38  0              0.016483101    4.0001572e-19  0              1.9315327e-12  2.6109412e-16  0              2.995215     
   2800000   95.4           200            200            0.0054943672   5.3217505e-39  0              0.016483101    9.9003999e-20  0              4.7805488e-13  2.6109412e-16  0              2.995215     
   2900000   95.4           200            200            0.0054943672   2.5733035e-38  0              0.016483101    1.6324972e-20  0              7.8827447e-14  2.6109412e-16  0              2.995215     
   3000000   95.4           200            200            0.0054943672   1.5692198e-38  0              0.016483101    1.5545786e-20  0              7.5065037e-14  2.6109412e-16  0              2.995215     
Loop time of 70.3855 on 4 procs for 3000000 steps with 51 atoms

Performance: 36825766.754 ns/day, 0.000 hours/ns, 42622.415 timesteps/s
99.8% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 0.22284    | 1.4428     | 4.876      | 165.1 |  2.05
Neigh   | 0.068913   | 0.070648   | 0.073572   |   0.7 |  0.10
Comm    | 29.752     | 37.483     | 44.071     |  93.9 | 53.25
Output  | 0.43978    | 0.47945    | 0.59599    |   9.7 |  0.68
Modify  | 15.203     | 21.951     | 30.401     | 144.0 | 31.19
Other   |            | 8.959      |            |       | 12.73

Nlocal:          12.75 ave          51 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1
Nghost:          39.25 ave          52 max           1 min
Histogram: 1 0 0 0 0 0 0 0 0 3
Neighs:           7.25 ave          29 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1

Total # of neighbors = 29
Ave neighs/atom = 0.56862745
Neighbor list builds = 164
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 19

#variable lat0 equal 1                    #
variable lat1 equal 3+(v_ind*0.01)  # .491+(v_ind*0.001)       # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 10*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 3.19                                                               
Lattice spacing in x,y,z = 3.19 3.19 3.19

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -47.85 ${n1e1} -100 100 -100 100 units box
region box block -47.85 47.85 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -47.85 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -47.85 47.85 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-47.85 -100 -100) to (47.85 100 100)
  1 by 2 by 2 MPI processor grid
create_atoms 1 region substrate
Created 30 atoms
  using lattice units in orthogonal box = (-47.85 -100 -100) to (47.85 100 100)
  create_atoms CPU = 0.000 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 30 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 21 atoms
  using lattice units in orthogonal box = (-47.85 -100 -100) to (47.85 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  30 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  30 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  21 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  21 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
30 atoms in group substrate
group slider1 region slider1
21 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 21 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 10000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 10000 Equi_19_*.dump id type diameter mass xu yu zu fx fy fz

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 62 130 130
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 13.94 | 17.41 | 18.57 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   95.7           200            200            0              0              0              0              0              0              0              2.6109412e-16  0              6            
    100000   95.7           200            200            0.004454886   -2.0526215e-37  0              0.013364658    12263.339      0              5.9215275e+10  2.6109412e-16  0              3.3272271    
    200000   95.7           200            200            0.001565259    1.6993247e-36  0              0.004695777    2949.6624      0              1.4242864e+10  2.6109412e-16  0              3.0763049    
    300000   95.7           200            200            9.9150434e-05  8.3405679e-36  0              0.0002974513   24.549531      0              1.185409e+08   2.6109412e-16  0              3.0456284    
    400000   95.7           200            200            0.0012597213  -8.4675943e-36  0              0.0037791638   178.0024       0              8.5950991e+08  2.6109412e-16  0              2.9984848    
    500000   95.7           200            200            0.0040589227  -2.8075531e-35  0              0.012176768    27.594949      0              1.3324613e+08  2.6109412e-16  0              2.9960218    
    600000   95.7           200            200            0.0039406413   2.7434212e-35  0              0.011821924    1.1867978      0              5730622        2.6109412e-16  0              2.9961456    
    700000   95.7           200            200            0.0050064512   3.9673462e-36  0              0.015019354    0.29179892     0              1408992.5      2.6109412e-16  0              2.9954874    
    800000   95.7           200            200            0.0053345265   2.4730088e-36  0              0.016003579    0.05075396     0              245072.71      2.6109412e-16  0              2.995296     
    900000   95.7           200            200            0.0054363381  -1.0088391e-36  0              0.016309014    0.0080851327   0              39040.212      2.6109412e-16  0              2.9952378    
   1000000   95.7           200            200            0.0054666658   7.9026316e-38  0              0.016399998    0.001221003    0              5895.7864      2.6109412e-16  0              2.9952207    
   1100000   95.7           200            200            0.0054750261   1.8643691e-37  0              0.016425078    0.00017639192  0              851.73345      2.6109412e-16  0              2.9952161    
   1200000   95.7           200            200            0.0054770178   6.7999469e-40  0              0.016431053    2.4464131e-05  0              118.12853      2.6109412e-16  0              2.995215     
   1300000   95.7           200            200            0.0054773383   9.25648e-39    0              0.016432015    3.2613008e-06  0              15.747654      2.6109412e-16  0              2.9952149    
   1400000   95.7           200            200            0.0054773024   5.5018074e-39  0              0.016431907    4.1766035e-07  0              2.0167324      2.6109412e-16  0              2.9952149    
   1500000   95.7           200            200            0.0054772328  -8.6559476e-39  0              0.016431699    5.1266601e-08  0              0.24754807     2.6109412e-16  0              2.995215     
   1600000   95.7           200            200            0.0054771871   2.9620428e-38  0              0.016431561    6.0050533e-09  0              0.028996253    2.6109412e-16  0              2.995215     
   1700000   95.7           200            200            0.0054771631  -1.4538654e-38  0              0.016431489    6.6629862e-10  0              0.0032173176   2.6109412e-16  0              2.995215     
   1800000   95.7           200            200            0.0054771519  -2.5355334e-39  0              0.016431456    6.9188886e-11  0              0.00033408837  2.6109412e-16  0              2.995215     
   1900000   95.7           200            200            0.0054771469   3.998138e-38   0              0.016431441    6.5871268e-12  0              3.1806878e-05  2.6109412e-16  0              2.995215     
   2000000   95.7           200            200            0.0054771448  -2.2060542e-38  0              0.016431434    5.537252e-13   0              2.6737408e-06  2.6109412e-16  0              2.995215     
   2100000   95.7           200            200            0.005477144    7.5496689e-38  0              0.016431432    3.7932964e-14  0              1.8316471e-07  2.6109412e-16  0              2.995215     
   2200000   95.7           200            200            0.0054771436   4.3662819e-39  0              0.016431431    1.6985984e-15  0              8.201924e-09   2.6109412e-16  0              2.995215     
   2300000   95.7           200            200            0.0054771435  -2.9230374e-38  0              0.016431431    1.3368835e-17  0              6.4553321e-11  2.6109412e-16  0              2.995215     
   2400000   95.7           200            200            0.0054771435   3.8447499e-39  0              0.01643143     9.3260673e-18  0              4.5032241e-11  2.6109412e-16  0              2.995215     
   2500000   95.7           200            200            0.0054771434   7.2115612e-40  0              0.01643143     6.3773055e-18  0              3.0793726e-11  2.6109412e-16  0              2.995215     
   2600000   95.7           200            200            0.0054771434  -3.8420639e-38  0              0.01643143     2.350921e-18   0              1.1351756e-11  2.6109412e-16  0              2.995215     
   2700000   95.7           200            200            0.0054771434  -2.9668563e-38  0              0.01643143     4.8099819e-19  0              2.3225681e-12  2.6109412e-16  0              2.995215     
   2800000   95.7           200            200            0.0054771434   3.5077915e-38  0              0.01643143     1.2462604e-19  0              6.0177456e-13  2.6109412e-16  0              2.995215     
   2900000   95.7           200            200            0.0054771434   3.7218144e-38  0              0.01643143     8.4049723e-21  0              4.0584603e-14  2.6109412e-16  0              2.995215     
   3000000   95.7           200            200            0.0054771434   2.3523691e-38  0              0.01643143     6.2181039e-20  0              3.0024999e-13  2.6109412e-16  0              2.995215     
Loop time of 70.2585 on 4 procs for 3000000 steps with 51 atoms

Performance: 36892339.845 ns/day, 0.000 hours/ns, 42699.467 timesteps/s
99.8% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 0.22421    | 1.3386     | 4.4717     | 156.4 |  1.91
Neigh   | 0.069794   | 0.072012   | 0.07538    |   0.9 |  0.10
Comm    | 29.879     | 37.487     | 43.992     |  93.2 | 53.36
Output  | 0.44597    | 0.48557    | 0.6018     |   9.6 |  0.69
Modify  | 15.139     | 21.857     | 30.143     | 142.0 | 31.11
Other   |            | 9.018      |            |       | 12.84

Nlocal:          12.75 ave          51 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1
Nghost:          39.25 ave          52 max           1 min
Histogram: 1 0 0 0 0 0 0 0 0 3
Neighs:           7.25 ave          29 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1

Total # of neighbors = 29
Ave neighs/atom = 0.56862745
Neighbor list builds = 164
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 20

#variable lat0 equal 1                    #
variable lat1 equal 3+(v_ind*0.01)  # .491+(v_ind*0.001)       # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 10*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 3.2                                                               
Lattice spacing in x,y,z = 3.2 3.2 3.2

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -48 ${n1e1} -100 100 -100 100 units box
region box block -48 48 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -48 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -48 48 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-48 -100 -100) to (48 100 100)
  1 by 2 by 2 MPI processor grid
create_atoms 1 region substrate
Created 30 atoms
  using lattice units in orthogonal box = (-48 -100 -100) to (48 100 100)
  create_atoms CPU = 0.000 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 30 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 21 atoms
  using lattice units in orthogonal box = (-48 -100 -100) to (48 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  30 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  30 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  21 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  21 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
30 atoms in group substrate
group slider1 region slider1
21 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 21 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 10000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 10000 Equi_20_*.dump id type diameter mass xu yu zu fx fy fz

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 62 130 130
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 13.94 | 17.41 | 18.57 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   96             200            200            0              0              0              0              0              0              0              2.6109412e-16  0              6            
    100000   96             200            200            0.0044377128   2.0606519e-37  0              0.013313138    12249.992      0              5.9150828e+10  2.6109412e-16  0              3.3276936    
    200000   96             200            200            0.0015519146   2.5824771e-36  0              0.0046557437   2924.6365      0              1.4122023e+10  2.6109412e-16  0              3.0773326    
    300000   96             200            200            8.940844e-05   4.2177816e-36  0              0.00026822532  20.253445      0              97796636       2.6109412e-16  0              3.0455229    
    400000   96             200            200            0.00023849179 -5.6226929e-36  0              0.00071547538  131.35182      0              6.3425093e+08  2.6109412e-16  0              3.0007073    
    500000   96             200            200            0.010470362    6.7217942e-05  0              0.031343869    8.5958762      0              41506410       2.6109412e-16  0              2.9928231    
    600000   96             200            200            0.0064017975  -8.3463732e-36  0              0.019205393    3.0605018      0              14778068       2.6109412e-16  0              2.9946974    
    700000   96             200            200            0.0056635373  -8.2663076e-37  0              0.016990612    0.49725201     0              2401052        2.6109412e-16  0              2.9951044    
    800000   96             200            200            0.0054986595  -1.3441441e-37  0              0.016495978    0.071687165    0              346151.66      2.6109412e-16  0              2.9951954    
    900000   96             200            200            0.0054612653   7.7564032e-37  0              0.016383796    0.0098992143   0              47799.763      2.6109412e-16  0              2.9952154    
   1000000   96             200            200            0.0054556884  -2.2003331e-37  0              0.016367065    0.0013149413   0              6349.3812      2.6109412e-16  0              2.9952179    
   1100000   96             200            200            0.0054566916  -1.1275098e-38  0              0.016370075    0.00016781779  0              810.33205      2.6109412e-16  0              2.9952171    
   1200000   96             200            200            0.0054581831  -1.262152e-37   0              0.016374549    2.0522701e-05  0              99.096779      2.6109412e-16  0              2.9952161    
   1300000   96             200            200            0.0054591351   4.0209323e-38  0              0.016377405    2.3937371e-06  0              11.5585        2.6109412e-16  0              2.9952156    
   1400000   96             200            200            0.0054596269  -4.5880308e-38  0              0.016378881    2.6425732e-07  0              1.276004       2.6109412e-16  0              2.9952153    
   1500000   96             200            200            0.0054598564   1.2892412e-38  0              0.016379569    2.7264911e-08  0              0.1316525      2.6109412e-16  0              2.9952151    
   1600000   96             200            200            0.005459957   -4.5099559e-38  0              0.016379871    2.5730679e-09  0              0.012424424    2.6109412e-16  0              2.9952151    
   1700000   96             200            200            0.0054599992  -1.0843233e-38  0              0.016379998    2.1340809e-10  0              0.0010304713   2.6109412e-16  0              2.995215     
   1800000   96             200            200            0.0054600164  -2.2826403e-38  0              0.016380049    1.427243e-11   0              6.8916455e-05  2.6109412e-16  0              2.995215     
   1900000   96             200            200            0.0054600232   9.0279691e-39  0              0.01638007     6.011325e-13   0              2.9026537e-06  2.6109412e-16  0              2.995215     
   2000000   96             200            200            0.0054600258  -2.7601974e-38  0              0.016380077    2.872575e-15   0              1.3870637e-08  2.6109412e-16  0              2.995215     
   2100000   96             200            200            0.0054600268   3.1152096e-38  0              0.01638008     4.3476346e-15  0              2.0993171e-08  2.6109412e-16  0              2.995215     
   2200000   96             200            200            0.0054600272   2.8153659e-38  0              0.016380081    3.0548331e-15  0              1.4750696e-08  2.6109412e-16  0              2.995215     
   2300000   96             200            200            0.0054600273  -4.3181483e-39  0              0.016380082    9.7799907e-16  0              4.7224075e-09  2.6109412e-16  0              2.995215     
   2400000   96             200            200            0.0054600273   2.3804098e-38  0              0.016380082    2.3645131e-16  0              1.1417388e-09  2.6109412e-16  0              2.995215     
   2500000   96             200            200            0.0054600274   6.2818143e-38  0              0.016380082    4.8737017e-17  0              2.3533361e-10  2.6109412e-16  0              2.995215     
   2600000   96             200            200            0.0054600274   1.3753645e-38  0              0.016380082    9.0768867e-18  0              4.3829038e-11  2.6109412e-16  0              2.995215     
   2700000   96             200            200            0.0054600274  -3.8244601e-38  0              0.016380082    1.395733e-18   0              6.739495e-12   2.6109412e-16  0              2.995215     
   2800000   96             200            200            0.0054600274   4.8315554e-38  0              0.016380082    2.7430558e-19  0              1.3245235e-12  2.6109412e-16  0              2.995215     
   2900000   96             200            200            0.0054600274  -5.3697827e-38  0              0.016380082    3.4815349e-21  0              1.6811086e-14  2.6109412e-16  0              2.995215     
   3000000   96             200            200            0.0054600274   9.0992271e-39  0              0.016380082    7.431785e-20   0              3.588543e-13   2.6109412e-16  0              2.995215     
Loop time of 70.6572 on 4 procs for 3000000 steps with 51 atoms

Performance: 36684170.932 ns/day, 0.000 hours/ns, 42458.531 timesteps/s
99.8% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 0.22344    | 1.2798     | 4.2925     | 153.8 |  1.81
Neigh   | 0.071781   | 0.073783   | 0.07693    |   0.8 |  0.10
Comm    | 30.233     | 37.795     | 44.281     |  93.2 | 53.49
Output  | 0.44927    | 0.48915    | 0.60619    |   9.7 |  0.69
Modify  | 15.193     | 21.973     | 30.274     | 143.0 | 31.10
Other   |            | 9.047      |            |       | 12.80

Nlocal:          12.75 ave          51 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1
Nghost:          39.25 ave          52 max           1 min
Histogram: 1 0 0 0 0 0 0 0 0 3
Neighs:           6.75 ave          27 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1

Total # of neighbors = 27
Ave neighs/atom = 0.52941176
Neighbor list builds = 164
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 21

#variable lat0 equal 1                    #
variable lat1 equal 3+(v_ind*0.01)  # .491+(v_ind*0.001)       # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 10*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 3.21                                                               
Lattice spacing in x,y,z = 3.21 3.21 3.21

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -48.15 ${n1e1} -100 100 -100 100 units box
region box block -48.15 48.15 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -48.15 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -48.15 48.15 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-48.15 -100 -100) to (48.15 100 100)
  1 by 2 by 2 MPI processor grid
create_atoms 1 region substrate
Created 30 atoms
  using lattice units in orthogonal box = (-48.15 -100 -100) to (48.15 100 100)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 30 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 21 atoms
  using lattice units in orthogonal box = (-48.15 -100 -100) to (48.15 100 100)
  create_atoms CPU = 0.003 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  30 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  30 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  21 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  21 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
30 atoms in group substrate
group slider1 region slider1
21 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 21 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 10000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 10000 Equi_21_*.dump id type diameter mass xu yu zu fx fy fz

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 63 130 130
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 13.96 | 17.43 | 18.59 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   96.3           200            200            0              0              0              0              0              0              0              2.6109412e-16  0              6            
    100000   96.3           200            200            0.004420547   -1.9767395e-37  0              0.013261641    12236.124      0              5.9083864e+10  2.6109412e-16  0              3.328219     
    200000   96.3           200            200            0.0015399256  -1.5874312e-36  0              0.0046197767   2903.4943      0              1.4019935e+10  2.6109412e-16  0              3.0781466    
    300000   96.3           200            200            7.9336191e-05 -3.1611497e-36  0              0.00023800857  16.187602      0              78164136       2.6109412e-16  0              3.0454095    
    400000   96.3           200            200            0.00018750932 -3.9496839e-36  0              0.00056252796  84.775323      0              4.0934969e+08  2.6109412e-16  0              3.0028112    
    500000   96.3           200            200            0.0017566755   2.5175411e-35  0              0.0052700264   9.7565933      0              47111097       2.6109412e-16  0              2.9978016    
    600000   96.3           200            200            0.0036703367   1.5476618e-35  0              0.01101101     0.1458888      0              704444.8       2.6109412e-16  0              2.9963166    
    700000   96.3           200            200            0.0048204508  -2.7088419e-36  0              0.014461352    0.094890343    0              458191.51      2.6109412e-16  0              2.9955841    
    800000   96.3           200            200            0.0052309806   1.7434507e-36  0              0.015692942    0.022591577    0              109086.64      2.6109412e-16  0              2.9953386    
    900000   96.3           200            200            0.0053729178  -3.2649577e-37  0              0.016118753    0.0044342482   0              21411.398      2.6109412e-16  0              2.9952555    
   1000000   96.3           200            200            0.0054206669   1.6548372e-36  0              0.016262001    0.00078899813  0              3809.7896      2.6109412e-16  0              2.9952278    
   1100000   96.3           200            200            0.0054362239  -4.07902e-38    0              0.016308672    0.00013096754  0              632.3954       2.6109412e-16  0              2.9952189    
   1200000   96.3           200            200            0.0054410932   5.1232984e-38  0              0.01632328     2.0566334e-05  0              99.307468      2.6109412e-16  0              2.9952161    
   1300000   96.3           200            200            0.0054425351   7.6842579e-39  0              0.016327605    3.0799514e-06  0              14.871983      2.6109412e-16  0              2.9952153    
   1400000   96.3           200            200            0.0054429267   2.4977532e-38  0              0.01632878     4.419463e-07   0              2.1340005      2.6109412e-16  0              2.9952151    
   1500000   96.3           200            200            0.0054430168   1.1767565e-39  0              0.01632905     6.0913441e-08  0              0.29412921     2.6109412e-16  0              2.995215     
   1600000   96.3           200            200            0.0054430294   4.2836081e-38  0              0.016329088    8.07048e-09    0              0.03896946     2.6109412e-16  0              2.995215     
   1700000   96.3           200            200            0.0054430265  -1.5703656e-38  0              0.016329079    1.0269707e-09  0              0.0049588739   2.6109412e-16  0              2.995215     
   1800000   96.3           200            200            0.0054430226   6.8160265e-38  0              0.016329068    1.2518967e-10  0              0.00060449613  2.6109412e-16  0              2.995215     
   1900000   96.3           200            200            0.0054430202   2.9252841e-38  0              0.016329061    1.4549495e-11  0              7.0254307e-05  2.6109412e-16  0              2.995215     
   2000000   96.3           200            200            0.0054430189   1.7978701e-38  0              0.016329057    1.5992687e-12  0              7.7222964e-06  2.6109412e-16  0              2.995215     
   2100000   96.3           200            200            0.0054430184   3.1351361e-38  0              0.016329055    1.6406949e-13  0              7.9223283e-07  2.6109412e-16  0              2.995215     
   2200000   96.3           200            200            0.0054430181   1.5119323e-38  0              0.016329054    1.5375061e-14  0              7.4240669e-08  2.6109412e-16  0              2.995215     
   2300000   96.3           200            200            0.005443018    7.8680979e-39  0              0.016329054    1.2637241e-15  0              6.1020716e-09  2.6109412e-16  0              2.995215     
   2400000   96.3           200            200            0.005443018    4.1785141e-38  0              0.016329054    8.5461244e-17  0              4.1266176e-10  2.6109412e-16  0              2.995215     
   2500000   96.3           200            200            0.0054430179  -1.5875086e-38  0              0.016329054    3.7263829e-18  0              1.799337e-11   2.6109412e-16  0              2.995215     
   2600000   96.3           200            200            0.0054430179  -3.3385536e-38  0              0.016329054    3.6411254e-21  0              1.7581692e-14  2.6109412e-16  0              2.995215     
   2700000   96.3           200            200            0.0054430179  -8.5863655e-38  0              0.016329054    5.3445052e-20  0              2.5806703e-13  2.6109412e-16  0              2.995215     
   2800000   96.3           200            200            0.0054430179  -1.3061982e-38  0              0.016329054    5.9896705e-20  0              2.8921975e-13  2.6109412e-16  0              2.995215     
   2900000   96.3           200            200            0.0054430179   2.5297198e-38  0              0.016329054    1.2905882e-21  0              6.2317883e-15  2.6109412e-16  0              2.995215     
   3000000   96.3           200            200            0.0054430179   5.5104931e-38  0              0.016329054    5.8247095e-20  0              2.8125438e-13  2.6109412e-16  0              2.995215     
Loop time of 70.2535 on 4 procs for 3000000 steps with 51 atoms

Performance: 36894966.763 ns/day, 0.000 hours/ns, 42702.508 timesteps/s
99.8% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 0.24985    | 1.3125     | 4.3544     | 153.3 |  1.87
Neigh   | 0.072741   | 0.074749   | 0.077911   |   0.8 |  0.11
Comm    | 29.943     | 37.56      | 44.035     |  93.4 | 53.46
Output  | 0.44361    | 0.48316    | 0.59921    |   9.6 |  0.69
Modify  | 15.058     | 21.8       | 30.144     | 143.0 | 31.03
Other   |            | 9.024      |            |       | 12.84

Nlocal:          12.75 ave          51 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1
Nghost:          39.25 ave          52 max           1 min
Histogram: 1 0 0 0 0 0 0 0 0 3
Neighs:           6.75 ave          27 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1

Total # of neighbors = 27
Ave neighs/atom = 0.52941176
Neighbor list builds = 164
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 22

#variable lat0 equal 1                    #
variable lat1 equal 3+(v_ind*0.01)  # .491+(v_ind*0.001)       # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 10*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 3.22                                                               
Lattice spacing in x,y,z = 3.22 3.22 3.22

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -48.3 ${n1e1} -100 100 -100 100 units box
region box block -48.3 48.3 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -48.3 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -48.3 48.3 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-48.3 -100 -100) to (48.3 100 100)
  1 by 2 by 2 MPI processor grid
create_atoms 1 region substrate
Created 29 atoms
  using lattice units in orthogonal box = (-48.3 -100 -100) to (48.3 100 100)
  create_atoms CPU = 0.000 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 30 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 21 atoms
  using lattice units in orthogonal box = (-48.3 -100 -100) to (48.3 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  29 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  29 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  21 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  21 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
29 atoms in group substrate
group slider1 region slider1
21 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 21 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 10000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 10000 Equi_22_*.dump id type diameter mass xu yu zu fx fy fz

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 63 130 130
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 13.96 | 17.43 | 18.59 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   96.6           200            200            0              0              0              0              0              0              0              2.6109412e-16  0              6            
    100000   96.6           200            200            0.0044034201   1.6399061e-36  0              0.01321026     12221.874      0              6.5572282e+10  2.6109412e-16  0              3.3287956    
    200000   96.6           200            200            0.0015286849   1.6811301e-36  0              0.0045860547   2884.423       0              1.5475385e+10  2.6109412e-16  0              3.0788471    
    300000   96.6           200            200            6.8582355e-05  9.4237007e-37  0              0.00020574706  12.289506      0              65935141       2.6109412e-16  0              3.0452928    
    400000   96.6           200            200            0.00013206777  1.3152484e-37  0              0.00039620332  44.190502      0              2.3708902e+08  2.6109412e-16  0              3.0046205    
    500000   96.6           200            200            0.002154064   -3.2846414e-36  0              0.0064621919   15.086604      0              80942014       2.6109412e-16  0              2.9973609    
    600000   96.6           200            200            0.0057532897   5.9017301e-36  0              0.017259869    3.8702819      0              20764674       2.6109412e-16  0              2.9950035    
    700000   96.6           200            200            0.005719355    1.1794391e-36  0              0.017158065    0.44150415     0              2368739.5      2.6109412e-16  0              2.9950368    
    800000   96.6           200            200            0.0055693647  -1.5482844e-36  0              0.016708094    0.049485148    0              265495.64      2.6109412e-16  0              2.9951287    
    900000   96.6           200            200            0.0054893257  -2.1176277e-36  0              0.016467977    0.005293974    0              28403.006      2.6109412e-16  0              2.9951771    
   1000000   96.6           200            200            0.0054526869   2.6319366e-37  0              0.016358061    0.00052735984  0              2829.3688      2.6109412e-16  0              2.9951991    
   1100000   96.6           200            200            0.0054369126  -1.027204e-36   0              0.016310738    4.747561e-05   0              254.71414      2.6109412e-16  0              2.9952086    
   1200000   96.6           200            200            0.0054303847   1.1360151e-37  0              0.016291154    3.6586259e-06  0              19.629105      2.6109412e-16  0              2.9952125    
   1300000   96.6           200            200            0.005427764    5.1626576e-38  0              0.016283292    2.1263456e-07  0              1.140818       2.6109412e-16  0              2.995214     
   1400000   96.6           200            200            0.0054267382   3.3828628e-39  0              0.016280214    5.9440721e-09  0              0.031890885    2.6109412e-16  0              2.9952146    
   1500000   96.6           200            200            0.0054263455   9.776655e-39   0              0.016279036    3.8866338e-11  0              0.00020852404  2.6109412e-16  0              2.9952149    
   1600000   96.6           200            200            0.0054261982   1.4980314e-38  0              0.016278595    2.2424534e-10  0              0.0012031117   2.6109412e-16  0              2.995215     
   1700000   96.6           200            200            0.0054261441   1.1476242e-38  0              0.016278432    1.0131329e-10  0              0.00054356179  2.6109412e-16  0              2.995215     
   1800000   96.6           200            200            0.0054261246  -1.6036432e-38  0              0.016278374    2.8156033e-11  0              0.00015106156  2.6109412e-16  0              2.995215     
   1900000   96.6           200            200            0.0054261177   2.8551426e-38  0              0.016278353    6.2675469e-12  0              3.3626379e-05  2.6109412e-16  0              2.995215     
   2000000   96.6           200            200            0.0054261153  -2.0531338e-38  0              0.016278346    1.2226535e-12  0              6.5597291e-06  2.6109412e-16  0              2.995215     
   2100000   96.6           200            200            0.0054261145   2.5161859e-38  0              0.016278344    2.1781701e-13  0              1.1686226e-06  2.6109412e-16  0              2.995215     
   2200000   96.6           200            200            0.0054261143   4.7750538e-38  0              0.016278343    3.6253105e-14  0              1.9450363e-07  2.6109412e-16  0              2.995215     
   2300000   96.6           200            200            0.0054261142  -3.6088093e-39  0              0.016278343    5.7045654e-15  0              3.0605894e-08  2.6109412e-16  0              2.995215     
   2400000   96.6           200            200            0.0054261142   4.9909394e-38  0              0.016278342    8.5688289e-16  0              4.597312e-09   2.6109412e-16  0              2.995215     
   2500000   96.6           200            200            0.0054261142   2.4936828e-38  0              0.016278342    1.2295118e-16  0              6.5965251e-10  2.6109412e-16  0              2.995215     
   2600000   96.6           200            200            0.0054261142  -4.6250015e-39  0              0.016278342    1.6937187e-17  0              9.0870685e-11  2.6109412e-16  0              2.995215     
   2700000   96.6           200            200            0.0054261142   1.3941074e-38  0              0.016278342    2.2292712e-18  0              1.1960392e-11  2.6109412e-16  0              2.995215     
   2800000   96.6           200            200            0.0054261142   2.3471907e-38  0              0.016278342    2.459513e-19   0              1.3195676e-12  2.6109412e-16  0              2.995215     
   2900000   96.6           200            200            0.0054261142   1.7862683e-38  0              0.016278342    1.640746e-19   0              8.8028615e-13  2.6109412e-16  0              2.995215     
   3000000   96.6           200            200            0.0054261142   4.206763e-38   0              0.016278342    1.157807e-20   0              6.2118173e-14  2.6109412e-16  0              2.995215     
Loop time of 69.1811 on 4 procs for 3000000 steps with 50 atoms

Performance: 37466880.698 ns/day, 0.000 hours/ns, 43364.445 timesteps/s
99.8% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 0.21888    | 1.3833     | 4.69       | 162.4 |  2.00
Neigh   | 0.07011    | 0.072132   | 0.075192   |   0.8 |  0.10
Comm    | 29.121     | 36.575     | 42.992     |  91.8 | 52.87
Output  | 0.49024    | 0.52929    | 0.64392    |   9.1 |  0.77
Modify  | 15         | 21.682     | 29.843     | 140.4 | 31.34
Other   |            | 8.94       |            |       | 12.92

Nlocal:           12.5 ave          50 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1
Nghost:           37.5 ave          50 max           0 min
Histogram: 1 0 0 0 0 0 0 0 0 3
Neighs:           6.75 ave          27 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1

Total # of neighbors = 27
Ave neighs/atom = 0.54
Neighbor list builds = 164
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 23

#variable lat0 equal 1                    #
variable lat1 equal 3+(v_ind*0.01)  # .491+(v_ind*0.001)       # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 10*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 3.23                                                               
Lattice spacing in x,y,z = 3.23 3.23 3.23

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -48.45 ${n1e1} -100 100 -100 100 units box
region box block -48.45 48.45 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -48.45 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -48.45 48.45 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-48.45 -100 -100) to (48.45 100 100)
  1 by 2 by 2 MPI processor grid
create_atoms 1 region substrate
Created 30 atoms
  using lattice units in orthogonal box = (-48.45 -100 -100) to (48.45 100 100)
  create_atoms CPU = 0.000 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 30 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 21 atoms
  using lattice units in orthogonal box = (-48.45 -100 -100) to (48.45 100 100)
  create_atoms CPU = 0.002 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  30 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  30 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  21 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  21 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
30 atoms in group substrate
group slider1 region slider1
21 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 21 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 10000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 10000 Equi_23_*.dump id type diameter mass xu yu zu fx fy fz

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 63 130 130
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 13.96 | 17.43 | 18.59 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   96.9           200            200            0              0              0              0              0              0              0              2.6109412e-16  0              6            
    100000   96.9           200            200            0.004386374    2.0771797e-37  0              0.013159122    12207.434      0              5.8945329e+10  2.6109412e-16  0              3.3294104    
    200000   96.9           200            200            0.0015181903  -1.5844708e-36  0              0.004554571    2867.4281      0              1.3845784e+10  2.6109412e-16  0              3.0794303    
    300000   96.9           200            200            5.7186865e-05 -5.5868513e-36  0              0.00017156059  8.6892063      0              41957067       2.6109412e-16  0              3.0451683    
    400000   96.9           200            200            7.3337702e-05  3.3894139e-36  0              0.00022001311  14.422573      0              69641442       2.6109412e-16  0              3.0059075    
    500000   96.9           200            200            0.0072206015   7.5831908e-35  0              0.021661805    25.709829      0              1.2414357e+08  2.6109412e-16  0              2.9941496    
    600000   96.9           200            200            0.0072941143  -7.2722011e-35  0              0.021882343    0.18846715     0              910040.41      2.6109412e-16  0              2.9941541    
    700000   96.9           200            200            0.0061068133  -1.2135843e-35  0              0.01832044     0.00038682735  0              1867.8509      2.6109412e-16  0              2.9948118    
    800000   96.9           200            200            0.0056600831   1.8303951e-36  0              0.016980249    0.0023664584   0              11426.781      2.6109412e-16  0              2.9950686    
    900000   96.9           200            200            0.0054981135   7.3009839e-37  0              0.01649434     0.00099678325  0              4813.1096      2.6109412e-16  0              2.9951631    
   1000000   96.9           200            200            0.0054401516   3.744083e-37   0              0.016320455    0.00026782488  0              1293.2305      2.6109412e-16  0              2.995197     
   1100000   96.9           200            200            0.0054197732  -1.0009019e-38  0              0.01625932     5.850944e-05   0              282.52115      2.6109412e-16  0              2.9952089    
   1200000   96.9           200            200            0.0054127621   1.0408738e-38  0              0.016238286    1.1276941e-05  0              54.452312      2.6109412e-16  0              2.995213     
   1300000   96.9           200            200            0.0054104111   2.6510063e-38  0              0.016231233    1.9919036e-06  0              9.6181898      2.6109412e-16  0              2.9952144    
   1400000   96.9           200            200            0.005409647    8.1602023e-39  0              0.016228941    3.2918265e-07  0              1.5895052      2.6109412e-16  0              2.9952148    
   1500000   96.9           200            200            0.0054094086  -2.3484452e-38  0              0.016228226    5.1521962e-08  0              0.24878112     2.6109412e-16  0              2.995215     
   1600000   96.9           200            200            0.0054093383   4.5074723e-38  0              0.016228015    7.6942174e-09  0              0.037152622    2.6109412e-16  0              2.995215     
   1700000   96.9           200            200            0.0054093193  -4.2785109e-39  0              0.016227958    1.101245e-09   0              0.0053175179   2.6109412e-16  0              2.995215     
   1800000   96.9           200            200            0.005409315    7.5741896e-38  0              0.016227945    1.5141488e-10  0              0.00073112828  2.6109412e-16  0              2.995215     
   1900000   96.9           200            200            0.0054093144   2.3922486e-38  0              0.016227943    2.0012686e-11  0              9.6634099e-05  2.6109412e-16  0              2.995215     
   2000000   96.9           200            200            0.0054093146   1.2340518e-38  0              0.016227944    2.540229e-12   0              1.2265856e-05  2.6109412e-16  0              2.995215     
   2100000   96.9           200            200            0.0054093148   2.5208612e-38  0              0.016227944    3.0877217e-13  0              1.4909503e-06  2.6109412e-16  0              2.995215     
   2200000   96.9           200            200            0.0054093149   8.6338725e-39  0              0.016227945    3.5777059e-14  0              1.7275461e-07  2.6109412e-16  0              2.995215     
   2300000   96.9           200            200            0.005409315    7.3138326e-39  0              0.016227945    3.926625e-15   0              1.8960267e-08  2.6109412e-16  0              2.995215     
   2400000   96.9           200            200            0.005409315    2.352026e-39   0              0.016227945    3.9703411e-16  0              1.9171356e-09  2.6109412e-16  0              2.995215     
   2500000   96.9           200            200            0.005409315    8.1056929e-39  0              0.016227945    3.6534121e-17  0              1.7641019e-10  2.6109412e-16  0              2.995215     
   2600000   96.9           200            200            0.005409315   -3.5208653e-39  0              0.016227945    2.6214087e-18  0              1.2657844e-11  2.6109412e-16  0              2.995215     
   2700000   96.9           200            200            0.005409315    7.2997706e-39  0              0.016227945    2.0050972e-19  0              9.681897e-13   2.6109412e-16  0              2.995215     
   2800000   96.9           200            200            0.005409315   -3.7051399e-39  0              0.016227945    1.6698982e-23  0              8.0633406e-17  2.6109412e-16  0              2.995215     
   2900000   96.9           200            200            0.005409315    4.6413199e-38  0              0.016227945    8.3877984e-20  0              4.0501676e-13  2.6109412e-16  0              2.995215     
   3000000   96.9           200            200            0.005409315    4.9818778e-38  0              0.016227945    2.9712407e-20  0              1.4347058e-13  2.6109412e-16  0              2.995215     
Loop time of 70.2548 on 4 procs for 3000000 steps with 51 atoms

Performance: 36894293.250 ns/day, 0.000 hours/ns, 42701.728 timesteps/s
99.8% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 0.22185    | 1.2522     | 4.1736     | 150.8 |  1.78
Neigh   | 0.070407   | 0.072219   | 0.075013   |   0.7 |  0.10
Comm    | 30.024     | 37.561     | 43.9       |  93.0 | 53.46
Output  | 0.46083    | 0.50078    | 0.61801    |   9.6 |  0.71
Modify  | 15.161     | 21.889     | 30.111     | 142.1 | 31.16
Other   |            | 8.98       |            |       | 12.78

Nlocal:          12.75 ave          51 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1
Nghost:          39.25 ave          52 max           1 min
Histogram: 1 0 0 0 0 0 0 0 0 3
Neighs:           6.75 ave          27 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1

Total # of neighbors = 27
Ave neighs/atom = 0.52941176
Neighbor list builds = 164
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 24

#variable lat0 equal 1                    #
variable lat1 equal 3+(v_ind*0.01)  # .491+(v_ind*0.001)       # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 10*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 3.24                                                               
Lattice spacing in x,y,z = 3.24 3.24 3.24

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -48.6 ${n1e1} -100 100 -100 100 units box
region box block -48.6 48.6 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -48.6 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -48.6 48.6 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-48.6 -100 -100) to (48.6 100 100)
  1 by 2 by 2 MPI processor grid
create_atoms 1 region substrate
Created 30 atoms
  using lattice units in orthogonal box = (-48.6 -100 -100) to (48.6 100 100)
  create_atoms CPU = 0.000 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 30 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 21 atoms
  using lattice units in orthogonal box = (-48.6 -100 -100) to (48.6 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  30 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  30 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  21 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  21 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
30 atoms in group substrate
group slider1 region slider1
21 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 21 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 10000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 10000 Equi_24_*.dump id type diameter mass xu yu zu fx fy fz

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 63 130 130
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 13.96 | 17.43 | 18.59 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   97.2           200            200            0              0              0              0              0              0              0              2.6109412e-16  0              6            
    100000   97.2           200            200            0.0043694637   4.0950757e-37  0              0.013108391    12193.066      0              5.8875951e+10  2.6109412e-16  0              3.330044     
    200000   97.2           200            200            0.0015079037   8.7987201e-37  0              0.0045237112   2850.8939      0              1.3765947e+10  2.6109412e-16  0              3.0799891    
    300000   97.2           200            200            4.4791963e-05 -3.1377295e-36  0              0.00013437589  5.4290645      0              26215010       2.6109412e-16  0              3.0450362    
    400000   97.2           200            200            1.2773664e-05  7.4379226e-36  0              3.8320991e-05  0.47202387     0              2279234.3      2.6109412e-16  0              3.0064435    
    500000   97.2           200            200            0.010607144   -9.9588001e-35  0              0.031821431    2.5672582      0              12396371       2.6109412e-16  0              2.9924698    
    600000   97.2           200            200            0.0069306335   6.3791983e-35  0              0.0207919      1.4736964      0              7115952.7      2.6109412e-16  0              2.9943551    
    700000   97.2           200            200            0.0058413676  -1.284409e-36   0              0.017524103    0.32101577     0              1550070.3      2.6109412e-16  0              2.9949589    
    800000   97.2           200            200            0.005526711   -2.102172e-36   0              0.016580133    0.05364896     0              259051.63      2.6109412e-16  0              2.9951385    
    900000   97.2           200            200            0.0054304201   2.9224032e-37  0              0.01629126     0.0083912106   0              40518.153      2.6109412e-16  0              2.9951937    
   1000000   97.2           200            200            0.0054020407  -1.2611744e-37  0              0.016206122    0.0012530807   0              6050.6784      2.6109412e-16  0              2.9952098    
   1100000   97.2           200            200            0.0053943653   3.6277285e-39  0              0.016183096    0.0001794469   0              866.48486      2.6109412e-16  0              2.9952141    
   1200000   97.2           200            200            0.0053926156   1.0432897e-39  0              0.016177847    2.4691136e-05  0              119.22466      2.6109412e-16  0              2.9952151    
   1300000   97.2           200            200            0.0053923803   3.384592e-38   0              0.016177141    3.2659895e-06  0              15.770295      2.6109412e-16  0              2.9952152    
   1400000   97.2           200            200            0.0053924458   2.6613239e-38  0              0.016177337    4.1489349e-07  0              2.0033722      2.6109412e-16  0              2.9952151    
   1500000   97.2           200            200            0.0053925254  -7.915079e-39   0              0.016177576    5.0482782e-08  0              0.24376329     2.6109412e-16  0              2.9952151    
   1600000   97.2           200            200            0.0053925745   1.3626049e-38  0              0.016177723    5.8547682e-09  0              0.028270581    2.6109412e-16  0              2.995215     
   1700000   97.2           200            200            0.0053925995  -2.0502025e-38  0              0.016177798    6.4196399e-10  0              0.0030998143   2.6109412e-16  0              2.995215     
   1800000   97.2           200            200            0.0053926111  -4.6280798e-38  0              0.016177833    6.5665615e-11  0              0.00031707575  2.6109412e-16  0              2.995215     
   1900000   97.2           200            200            0.0053926161   1.2168865e-38  0              0.016177848    6.123676e-12   0              2.956904e-05   2.6109412e-16  0              2.995215     
   2000000   97.2           200            200            0.0053926182  -1.2935008e-38  0              0.016177855    4.9867245e-13  0              2.4079108e-06  2.6109412e-16  0              2.995215     
   2100000   97.2           200            200            0.0053926191  -5.1769316e-38  0              0.016177857    3.2253491e-14  0              1.5574057e-07  2.6109412e-16  0              2.995215     
   2200000   97.2           200            200            0.0053926194   5.7521447e-38  0              0.016177858    1.2444566e-15  0              6.0090355e-09  2.6109412e-16  0              2.995215     
   2300000   97.2           200            200            0.0053926195  -1.930726e-39   0              0.016177859    2.0454436e-18  0              9.8767153e-12  2.6109412e-16  0              2.995215     
   2400000   97.2           200            200            0.0053926196   3.0017549e-38  0              0.016177859    1.3088086e-17  0              6.3197683e-11  2.6109412e-16  0              2.995215     
   2500000   97.2           200            200            0.0053926196   1.3868194e-39  0              0.016177859    7.7002593e-18  0              3.7181797e-11  2.6109412e-16  0              2.995215     
   2600000   97.2           200            200            0.0053926196   2.7945331e-38  0              0.016177859    2.7884313e-18  0              1.3464337e-11  2.6109412e-16  0              2.995215     
   2700000   97.2           200            200            0.0053926196   3.731039e-38   0              0.016177859    6.7501782e-19  0              3.2594195e-12  2.6109412e-16  0              2.995215     
   2800000   97.2           200            200            0.0053926196   3.1152915e-38  0              0.016177859    1.920875e-19   0              9.275218e-13   2.6109412e-16  0              2.995215     
   2900000   97.2           200            200            0.0053926196   6.6795683e-38  0              0.016177859    3.1227741e-23  0              1.5078759e-16  2.6109412e-16  0              2.995215     
   3000000   97.2           200            200            0.0053926196   3.6727404e-38  0              0.016177859    1.4521892e-19  0              7.0121021e-13  2.6109412e-16  0              2.995215     
Loop time of 70.3736 on 4 procs for 3000000 steps with 51 atoms

Performance: 36831988.836 ns/day, 0.000 hours/ns, 42629.617 timesteps/s
99.8% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 0.22535    | 1.235      | 4.094      | 148.6 |  1.75
Neigh   | 0.072534   | 0.074374   | 0.077301   |   0.7 |  0.11
Comm    | 29.984     | 37.556     | 43.981     |  93.2 | 53.37
Output  | 0.44484    | 0.48398    | 0.59898    |   9.5 |  0.69
Modify  | 15.216     | 21.966     | 30.258     | 142.1 | 31.21
Other   |            | 9.059      |            |       | 12.87

Nlocal:          12.75 ave          51 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1
Nghost:          39.25 ave          52 max           1 min
Histogram: 1 0 0 0 0 0 0 0 0 3
Neighs:           6.75 ave          27 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1

Total # of neighbors = 27
Ave neighs/atom = 0.52941176
Neighbor list builds = 164
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 25

#variable lat0 equal 1                    #
variable lat1 equal 3+(v_ind*0.01)  # .491+(v_ind*0.001)       # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 10*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 3.25                                                               
Lattice spacing in x,y,z = 3.25 3.25 3.25

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -48.75 ${n1e1} -100 100 -100 100 units box
region box block -48.75 48.75 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -48.75 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -48.75 48.75 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-48.75 -100 -100) to (48.75 100 100)
  1 by 2 by 2 MPI processor grid
create_atoms 1 region substrate
Created 30 atoms
  using lattice units in orthogonal box = (-48.75 -100 -100) to (48.75 100 100)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 30 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 21 atoms
  using lattice units in orthogonal box = (-48.75 -100 -100) to (48.75 100 100)
  create_atoms CPU = 0.002 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  30 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  30 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  21 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  21 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
30 atoms in group substrate
group slider1 region slider1
21 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 21 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 10000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 10000 Equi_25_*.dump id type diameter mass xu yu zu fx fy fz

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 63 130 130
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 13.96 | 17.43 | 18.59 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   97.5           200            200            0              0              0              0              0              0              0              2.6109412e-16  0              6            
    100000   97.5           200            200            0.0043527615  -4.0044922e-37  0              0.013058285    12179.121      0              5.8808618e+10  2.6109412e-16  0              3.3306681    
    200000   97.5           200            200            0.0014981368   8.8413814e-37  0              0.0044944104   2835.7681      0              1.3692909e+10  2.6109412e-16  0              3.0804673    
    300000   97.5           200            200            3.1629139e-05  8.1980698e-36  0              9.4887417e-05  2.7622911      0              13338115       2.6109412e-16  0              3.0448866    
    400000   97.5           200            200           -4.6619406e-05 -3.099457e-36   0             -0.00013985822  6.5787155      0              31766263       2.6109412e-16  0              3.0060444    
    500000   97.5           200            200            0.010420803    5.2995582e-35  0              0.031262409    4.3806353      0              21152520       2.6109412e-16  0              2.9925756    
    600000   97.5           200            200            0.0059081145   2.5704442e-35  0              0.017724344    3.7219102      0              17971772       2.6109412e-16  0              2.9949249    
    700000   97.5           200            200            0.0054254544   4.3830247e-36  0              0.016276363    0.54267787     0              2620397.2      2.6109412e-16  0              2.9951938    
    800000   97.5           200            200            0.0053578329   5.9278067e-37  0              0.016073499    0.073227675    0              353590.23      2.6109412e-16  0              2.9952288    
    900000   97.5           200            200            0.0053566153  -3.1313546e-36  0              0.016069846    0.0094971388   0              45858.284      2.6109412e-16  0              2.9952276    
   1000000   97.5           200            200            0.0053643243   1.16398e-37    0              0.016092973    0.0011821844   0              5708.3453      2.6109412e-16  0              2.9952223    
   1100000   97.5           200            200            0.0053701208  -4.6681698e-37  0              0.016110362    0.0001406562   0              679.17845      2.6109412e-16  0              2.9952187    
   1200000   97.5           200            200            0.0053733068  -1.412716e-39   0              0.016119921    1.5894502e-05  0              76.748862      2.6109412e-16  0              2.9952167    
   1300000   97.5           200            200            0.0053748445   3.6752484e-39  0              0.016124533    1.6884003e-06  0              8.1526806      2.6109412e-16  0              2.9952157    
   1400000   97.5           200            200            0.0053755336   2.8991333e-38  0              0.016126601    1.6571376e-07  0              0.80017244     2.6109412e-16  0              2.9952153    
   1500000   97.5           200            200            0.0053758275   1.074543e-38   0              0.016127483    1.4572585e-08  0              0.070365799    2.6109412e-16  0              2.9952151    
   1600000   97.5           200            200            0.0053759484  -1.1824207e-38  0              0.016127845    1.0794005e-09  0              0.0052120386   2.6109412e-16  0              2.9952151    
   1700000   97.5           200            200            0.0053759967  -1.0028933e-38  0              0.01612799     5.7733851e-11  0              0.00027877611  2.6109412e-16  0              2.995215     
   1800000   97.5           200            200            0.0053760156   6.9696167e-38  0              0.016128047    1.1866614e-12  0              5.7299633e-06  2.6109412e-16  0              2.995215     
   1900000   97.5           200            200            0.0053760227  -3.8237527e-38  0              0.016128068    5.5038569e-14  0              2.6576155e-07  2.6109412e-16  0              2.995215     
   2000000   97.5           200            200            0.0053760254  -4.2895646e-38  0              0.016128076    1.0131527e-13  0              4.892152e-07   2.6109412e-16  0              2.995215     
   2100000   97.5           200            200            0.0053760264   8.3995353e-39  0              0.016128079    4.0055467e-14  0              1.9341351e-07  2.6109412e-16  0              2.995215     
   2200000   97.5           200            200            0.0053760268  -2.6399182e-38  0              0.01612808     1.055253e-14   0              5.0954393e-08  2.6109412e-16  0              2.995215     
   2300000   97.5           200            200            0.0053760269  -8.0664479e-39  0              0.016128081    2.2814209e-15  0              1.1016165e-08  2.6109412e-16  0              2.995215     
   2400000   97.5           200            200            0.0053760269   3.7901889e-40  0              0.016128081    4.4099349e-16  0              2.1293998e-09  2.6109412e-16  0              2.995215     
   2500000   97.5           200            200            0.0053760269   7.0095481e-38  0              0.016128081    7.6909942e-17  0              3.7137059e-10  2.6109412e-16  0              2.995215     
   2600000   97.5           200            200            0.0053760269   3.4103258e-38  0              0.016128081    1.2762554e-17  0              6.1625803e-11  2.6109412e-16  0              2.995215     
   2700000   97.5           200            200            0.0053760269  -3.6406584e-38  0              0.016128081    1.9034524e-18  0              9.1910906e-12  2.6109412e-16  0              2.995215     
   2800000   97.5           200            200            0.0053760269   1.684259e-38   0              0.016128081    3.0346007e-19  0              1.4653001e-12  2.6109412e-16  0              2.995215     
   2900000   97.5           200            200            0.0053760269  -1.4472267e-38  0              0.016128081    2.2536169e-20  0              1.0881909e-13  2.6109412e-16  0              2.995215     
   3000000   97.5           200            200            0.0053760269   1.5322096e-38  0              0.016128081    2.4199726e-20  0              1.1685182e-13  2.6109412e-16  0              2.995215     
Loop time of 70.246 on 4 procs for 3000000 steps with 51 atoms

Performance: 36898895.489 ns/day, 0.000 hours/ns, 42707.055 timesteps/s
99.8% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 0.22195    | 1.3173     | 4.421      | 156.2 |  1.88
Neigh   | 0.07223    | 0.074125   | 0.077047   |   0.7 |  0.11
Comm    | 30.212     | 37.577     | 44.003     |  91.5 | 53.49
Output  | 0.44258    | 0.48234    | 0.59903    |   9.7 |  0.69
Modify  | 15.066     | 21.787     | 29.934     | 141.6 | 31.02
Other   |            | 9.008      |            |       | 12.82

Nlocal:          12.75 ave          51 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1
Nghost:          39.25 ave          52 max           1 min
Histogram: 1 0 0 0 0 0 0 0 0 3
Neighs:           7.25 ave          29 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1

Total # of neighbors = 29
Ave neighs/atom = 0.56862745
Neighbor list builds = 166
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 26

#variable lat0 equal 1                    #
variable lat1 equal 3+(v_ind*0.01)  # .491+(v_ind*0.001)       # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 10*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 3.26                                                               
Lattice spacing in x,y,z = 3.26 3.26 3.26

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -48.9 ${n1e1} -100 100 -100 100 units box
region box block -48.9 48.9 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -48.9 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -48.9 48.9 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-48.9 -100 -100) to (48.9 100 100)
  1 by 2 by 2 MPI processor grid
create_atoms 1 region substrate
Created 30 atoms
  using lattice units in orthogonal box = (-48.9 -100 -100) to (48.9 100 100)
  create_atoms CPU = 0.000 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 30 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 21 atoms
  using lattice units in orthogonal box = (-48.9 -100 -100) to (48.9 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  30 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  30 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  21 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  21 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
30 atoms in group substrate
group slider1 region slider1
21 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 21 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 10000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 10000 Equi_26_*.dump id type diameter mass xu yu zu fx fy fz

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 64 130 130
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 13.98 | 17.45 | 18.6 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   97.8           200            200            0              0              0              0              0              0              0              2.6109412e-16  0              6            
    100000   97.8           200            200            0.0043363613   4.0904089e-37  0              0.013009084    12166.063      0              5.8745562e+10  2.6109412e-16  0              3.3312442    
    200000   97.8           200            200            0.0014883844   8.7850322e-37  0              0.0044651533   2820.5278      0              1.3619319e+10  2.6109412e-16  0              3.0809539    
    300000   97.8           200            200            1.7386036e-05 -6.9641242e-37  0              5.2158108e-05  0.85583861     0              4132538.4      2.6109412e-16  0              3.0447141    
    400000   97.8           200            200           -0.00010108063  1.7509073e-36  0             -0.0003032419   33.195914      0              1.6029119e+08  2.6109412e-16  0              3.004709     
    500000   97.8           200            200            0.0086109725   1.4660139e-36  0              0.025832917    18.728664      0              90434017       2.6109412e-16  0              2.9934758    
    600000   97.8           200            200            0.0049988205   2.6971945e-37  0              0.014996462    3.8557766      0              18618165       2.6109412e-16  0              2.9954549    
    700000   97.8           200            200            0.005088883   -2.6264535e-36  0              0.015266649    0.45466595     0              2195419.1      2.6109412e-16  0              2.9953852    
    800000   97.8           200            200            0.0052275015   3.6083716e-36  0              0.015682505    0.052654629    0              254250.36      2.6109412e-16  0              2.9952966    
    900000   97.8           200            200            0.0053004683   2.9087643e-36  0              0.015901405    0.0058025543   0              28018.458      2.6109412e-16  0              2.9952511    
   1000000   97.8           200            200            0.0053343676   9.0370521e-37  0              0.016003103    0.00059723594  0              2883.8386      2.6109412e-16  0              2.9952303    
   1100000   97.8           200            200            0.0053491918   5.7000663e-37  0              0.016047575    5.6128177e-05  0              271.02288      2.6109412e-16  0              2.9952213    
   1200000   97.8           200            200            0.005355406    5.4719157e-38  0              0.016066218    4.6228463e-06  0              22.32207       2.6109412e-16  0              2.9952175    
   1300000   97.8           200            200            0.0053579272   2.3324303e-37  0              0.016073782    3.051511e-07   0              1.4734655      2.6109412e-16  0              2.995216     
   1400000   97.8           200            200            0.0053589229  -4.7449071e-38  0              0.016076769    1.2422452e-08  0              0.059983574    2.6109412e-16  0              2.9952154    
   1500000   97.8           200            200            0.0053593071  -7.8285466e-38  0              0.016077921    4.1478383e-11  0              0.00020028427  2.6109412e-16  0              2.9952151    
   1600000   97.8           200            200            0.0053594522   1.8413231e-38  0              0.016078357    1.0797403e-10  0              0.00052136795  2.6109412e-16  0              2.9952151    
   1700000   97.8           200            200            0.005359506    6.4284185e-38  0              0.016078518    7.125713e-11   0              0.00034407518  2.6109412e-16  0              2.995215     
   1800000   97.8           200            200            0.0053595255   7.7453427e-38  0              0.016078576    2.249959e-11   0              0.00010864247  2.6109412e-16  0              2.995215     
   1900000   97.8           200            200            0.0053595324  -7.4352802e-38  0              0.016078597    5.3510594e-12  0              2.5838351e-05  2.6109412e-16  0              2.995215     
   2000000   97.8           200            200            0.0053595348   1.0048185e-37  0              0.016078605    1.0884545e-12  0              5.2557574e-06  2.6109412e-16  0              2.995215     
   2100000   97.8           200            200            0.0053595357  -3.1248637e-38  0              0.016078607    1.998532e-13   0              9.6501956e-07  2.6109412e-16  0              2.995215     
   2200000   97.8           200            200            0.0053595359  -3.4565555e-38  0              0.016078608    3.4022784e-14  0              1.6428385e-07  2.6109412e-16  0              2.995215     
   2300000   97.8           200            200            0.005359536    1.5075937e-38  0              0.016078608    5.4641289e-15  0              2.6384323e-08  2.6109412e-16  0              2.995215     
   2400000   97.8           200            200            0.0053595361   1.3046899e-37  0              0.016078608    8.3373304e-16  0              4.0257984e-09  2.6109412e-16  0              2.995215     
   2500000   97.8           200            200            0.0053595361  -2.7051843e-38  0              0.016078608    1.2165604e-16  0              5.8743347e-10  2.6109412e-16  0              2.995215     
   2600000   97.8           200            200            0.0053595361   1.8809612e-38  0              0.016078608    1.705867e-17   0              8.2370213e-11  2.6109412e-16  0              2.995215     
   2700000   97.8           200            200            0.0053595361   6.8055837e-38  0              0.016078608    2.2613496e-18  0              1.0919248e-11  2.6109412e-16  0              2.995215     
   2800000   97.8           200            200            0.0053595361   2.6412593e-38  0              0.016078608    2.5096564e-19  0              1.2118232e-12  2.6109412e-16  0              2.995215     
   2900000   97.8           200            200            0.0053595361   4.5386624e-38  0              0.016078608    4.6927521e-20  0              2.265962e-13   2.6109412e-16  0              2.995215     
   3000000   97.8           200            200            0.0053595361   1.0005974e-37  0              0.016078608    2.1495094e-20  0              1.0379211e-13  2.6109412e-16  0              2.995215     
Loop time of 70.0839 on 4 procs for 3000000 steps with 51 atoms

Performance: 36984258.927 ns/day, 0.000 hours/ns, 42805.855 timesteps/s
99.8% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 0.22066    | 1.2759     | 4.2654     | 152.8 |  1.82
Neigh   | 0.07431    | 0.076402   | 0.079671   |   0.8 |  0.11
Comm    | 29.816     | 37.328     | 43.735     |  92.6 | 53.26
Output  | 0.49565    | 0.54205    | 0.67868    |  10.7 |  0.77
Modify  | 15.095     | 21.781     | 30.02      | 141.4 | 31.08
Other   |            | 9.081      |            |       | 12.96

Nlocal:          12.75 ave          51 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1
Nghost:          39.25 ave          52 max           1 min
Histogram: 1 0 0 0 0 0 0 0 0 3
Neighs:           7.25 ave          29 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1

Total # of neighbors = 29
Ave neighs/atom = 0.56862745
Neighbor list builds = 166
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 27

#variable lat0 equal 1                    #
variable lat1 equal 3+(v_ind*0.01)  # .491+(v_ind*0.001)       # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 10*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 3.27                                                               
Lattice spacing in x,y,z = 3.27 3.27 3.27

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -49.05 ${n1e1} -100 100 -100 100 units box
region box block -49.05 49.05 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -49.05 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -49.05 49.05 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-49.05 -100 -100) to (49.05 100 100)
  1 by 2 by 2 MPI processor grid
create_atoms 1 region substrate
Created 30 atoms
  using lattice units in orthogonal box = (-49.05 -100 -100) to (49.05 100 100)
  create_atoms CPU = 0.000 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 30 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 21 atoms
  using lattice units in orthogonal box = (-49.05 -100 -100) to (49.05 100 100)
  create_atoms CPU = 0.002 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  30 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  30 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  21 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  21 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
30 atoms in group substrate
group slider1 region slider1
21 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 21 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 10000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 10000 Equi_27_*.dump id type diameter mass xu yu zu fx fy fz

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 64 130 130
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 13.98 | 17.45 | 18.6 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   98.1           200            200            0              0              0              0              0              0              0              2.6109412e-16  0              6            
    100000   98.1           200            200            0.0043203822   5.0790664e-39  0              0.012961147    12154.484      0              5.8689655e+10  2.6109412e-16  0              3.3317211    
    200000   98.1           200            200            0.0014785657   5.7156689e-36  0              0.0044356971   2804.9273      0              1.354399e+10   2.6109412e-16  0              3.0814639    
    300000   98.1           200            200            2.0550637e-06 -2.2983699e-36  0              6.1651911e-06  0.013366935    0              64544.146      2.6109412e-16  0              3.0445066    
    400000   98.1           200            200           -0.00014525025 -5.4927629e-36  0             -0.00043575075  73.005453      0              3.5251721e+08  2.6109412e-16  0              3.0027933    
    500000   98.1           200            200            0.0066712899  -1.4644918e-36  0              0.02001387     27.746458      0              1.3397771e+08  2.6109412e-16  0              2.9945074    
    600000   98.1           200            200            0.0043674286   1.6709981e-35  0              0.013102286    2.82129        0              13623000       2.6109412e-16  0              2.9958375    
    700000   98.1           200            200            0.0048668362   1.8789312e-35  0              0.014600509    0.26803297     0              1294235.3      2.6109412e-16  0              2.99551      
    800000   98.1           200            200            0.0051428995   3.760452e-37   0              0.015428699    0.025629412    0              123755.26      2.6109412e-16  0              2.9953372    
    900000   98.1           200            200            0.0052623447   7.3896392e-36  0              0.015787034    0.0022130331   0              10685.945      2.6109412e-16  0              2.9952639    
   1000000   98.1           200            200            0.005311416    1.1881719e-36  0              0.015934248    0.00015900425  0              767.7746       2.6109412e-16  0              2.9952341    
   1100000   98.1           200            200            0.0053309696   7.0397698e-38  0              0.015992909    7.9371685e-06  0              38.325746      2.6109412e-16  0              2.9952223    
   1200000   98.1           200            200            0.0053385702   1.6565959e-37  0              0.01601571     1.1938235e-07  0              0.57645465     2.6109412e-16  0              2.9952178    
   1300000   98.1           200            200            0.0053414604   1.034501e-37   0              0.016024381    1.6795355e-08  0              0.081098761    2.6109412e-16  0              2.995216     
   1400000   98.1           200            200            0.0053425373   4.4371997e-39  0              0.016027612    1.9929876e-08  0              0.096234239    2.6109412e-16  0              2.9952154    
   1500000   98.1           200            200            0.0053429307   4.2817935e-38  0              0.016028792    7.277321e-09   0              0.035139579    2.6109412e-16  0              2.9952151    
   1600000   98.1           200            200            0.0053430715   1.3090826e-38  0              0.016029215    1.8526151e-09  0              0.0089456152   2.6109412e-16  0              2.9952151    
   1700000   98.1           200            200            0.0053431209  -3.8814443e-38  0              0.016029363    3.9251056e-10  0              0.001895293    2.6109412e-16  0              2.995215     
   1800000   98.1           200            200            0.0053431378   9.0124049e-38  0              0.016029413    7.4102738e-11  0              0.0003578156   2.6109412e-16  0              2.995215     
   1900000   98.1           200            200            0.0053431435  -1.1370302e-38  0              0.01602943     1.2889103e-11  0              6.2236866e-05  2.6109412e-16  0              2.995215     
   2000000   98.1           200            200            0.0053431453   2.2635585e-39  0              0.016029436    2.1040701e-12  0              1.0159802e-05  2.6109412e-16  0              2.995215     
   2100000   98.1           200            200            0.0053431458  -3.8468541e-38  0              0.016029437    3.2585856e-13  0              1.5734544e-06  2.6109412e-16  0              2.995215     
   2200000   98.1           200            200            0.005343146   -6.744368e-38   0              0.016029438    4.8220279e-14  0              2.3283847e-07  2.6109412e-16  0              2.995215     
   2300000   98.1           200            200            0.005343146    1.2878737e-38  0              0.016029438    6.8404878e-15  0              3.3030268e-08  2.6109412e-16  0              2.995215     
   2400000   98.1           200            200            0.005343146    6.4473299e-38  0              0.016029438    9.3342949e-16  0              4.507197e-09   2.6109412e-16  0              2.995215     
   2500000   98.1           200            200            0.005343146    1.0010351e-39  0              0.016029438    1.2235667e-16  0              5.9081655e-10  2.6109412e-16  0              2.995215     
   2600000   98.1           200            200            0.005343146    2.0282284e-39  0              0.016029438    1.4989567e-17  0              7.2379255e-11  2.6109412e-16  0              2.995215     
   2700000   98.1           200            200            0.005343146   -1.8752516e-38  0              0.016029438    1.8269602e-18  0              8.8217369e-12  2.6109412e-16  0              2.995215     
   2800000   98.1           200            200            0.005343146    2.0574511e-38  0              0.016029438    1.2278748e-19  0              5.9289681e-13  2.6109412e-16  0              2.995215     
   2900000   98.1           200            200            0.005343146    1.9754916e-38  0              0.016029438    1.4043331e-19  0              6.7810217e-13  2.6109412e-16  0              2.995215     
   3000000   98.1           200            200            0.005343146    1.67656e-38    0              0.016029438    9.1247344e-21  0              4.4060077e-14  2.6109412e-16  0              2.995215     
Loop time of 70.2376 on 4 procs for 3000000 steps with 51 atoms

Performance: 36903322.386 ns/day, 0.000 hours/ns, 42712.179 timesteps/s
99.8% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 0.22019    | 1.2639     | 4.2068     | 151.2 |  1.80
Neigh   | 0.075945   | 0.077962   | 0.080859   |   0.7 |  0.11
Comm    | 30.12      | 37.63      | 44.027     |  92.6 | 53.58
Output  | 0.44415    | 0.48417    | 0.60147    |   9.7 |  0.69
Modify  | 15.075     | 21.781     | 30.044     | 142.0 | 31.01
Other   |            | 9          |            |       | 12.81

Nlocal:          12.75 ave          51 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1
Nghost:          39.25 ave          52 max           1 min
Histogram: 1 0 0 0 0 0 0 0 0 3
Neighs:           6.75 ave          27 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1

Total # of neighbors = 27
Ave neighs/atom = 0.52941176
Neighbor list builds = 166
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 28

#variable lat0 equal 1                    #
variable lat1 equal 3+(v_ind*0.01)  # .491+(v_ind*0.001)       # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 10*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 3.28                                                               
Lattice spacing in x,y,z = 3.28 3.28 3.28

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -49.2 ${n1e1} -100 100 -100 100 units box
region box block -49.2 49.2 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -49.2 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -49.2 49.2 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-49.2 -100 -100) to (49.2 100 100)
  1 by 2 by 2 MPI processor grid
create_atoms 1 region substrate
Created 30 atoms
  using lattice units in orthogonal box = (-49.2 -100 -100) to (49.2 100 100)
  create_atoms CPU = 0.000 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 30 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 21 atoms
  using lattice units in orthogonal box = (-49.2 -100 -100) to (49.2 100 100)
  create_atoms CPU = 0.002 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  30 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  30 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  21 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  21 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
30 atoms in group substrate
group slider1 region slider1
21 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 21 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 10000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 10000 Equi_28_*.dump id type diameter mass xu yu zu fx fy fz

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 64 130 130
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 13.98 | 17.45 | 18.6 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   98.4           200            200            0              0              0              0              0              0              0              2.6109412e-16  0              6            
    100000   98.4           200            200            0.0043117856  -1.9806334e-37  0              0.012935357    12176.985      0              5.8798301e+10  2.6109412e-16  0              3.3297728    
    200000   98.4           200            200            0.0014753053  -3.1354354e-36  0              0.0044259158   2809.095       0              1.3564114e+10  2.6109412e-16  0              3.080846     
    300000   98.4           200            200           -1.028828e-05   1.1390531e-37  0             -3.0864839e-05  0.30138088     0              1455260.4      2.6109412e-16  0              3.0442657    
    400000   98.4           200            200           -0.00017497156 -5.4759497e-36  0             -0.00052491469  111.15761      0              5.3674033e+08  2.6109412e-16  0              3.0009843    
    500000   98.4           200            200            0.0052861134   1.3427802e-35  0              0.01585834     29.571664      0              1.4279098e+08  2.6109412e-16  0              2.9953026    
    600000   98.4           200            200            0.0040111345  -7.4238332e-36  0              0.012033404    1.8107961      0              8743686.5      2.6109412e-16  0              2.9960567    
    700000   98.4           200            200            0.0047467846   2.7990413e-36  0              0.014240354    0.13301063     0              642260.71      2.6109412e-16  0              2.9955735    
    800000   98.4           200            200            0.0050956619  -9.0551299e-36  0              0.015286986    0.0095529918   0              46127.979      2.6109412e-16  0              2.9953557    
    900000   98.4           200            200            0.0052376421   4.954116e-36   0              0.015712926    0.000506798    0              2447.1461      2.6109412e-16  0              2.9952689    
   1000000   98.4           200            200            0.0052932119   1.2924668e-36  0              0.015879636    1.0181654e-05  0              49.163565      2.6109412e-16  0              2.9952352    
   1100000   98.4           200            200            0.0053144275   2.6089647e-37  0              0.015943283    5.2245804e-07  0              2.5227629      2.6109412e-16  0              2.9952225    
   1200000   98.4           200            200            0.005322356    2.3239573e-37  0              0.015967068    9.1880969e-07  0              4.4366032      2.6109412e-16  0              2.9952177    
   1300000   98.4           200            200            0.0053252598   2.4497558e-37  0              0.015975779    3.6059273e-07  0              1.7411732      2.6109412e-16  0              2.995216     
   1400000   98.4           200            200            0.0053263021   7.0845714e-38  0              0.015978906    9.470543e-08   0              0.45729863     2.6109412e-16  0              2.9952153    
   1500000   98.4           200            200            0.0053266685  -1.6371174e-38  0              0.015980006    2.0428415e-08  0              0.098641507    2.6109412e-16  0              2.9952151    
   1600000   98.4           200            200            0.0053267943  -2.7635585e-39  0              0.015980383    3.90347e-09    0              0.01884846     2.6109412e-16  0              2.995215     
   1700000   98.4           200            200            0.0053268364  -4.2569104e-38  0              0.015980509    6.8504712e-10  0              0.0033078474   2.6109412e-16  0              2.995215     
   1800000   98.4           200            200            0.0053268501   1.0083413e-38  0              0.01598055     1.1262622e-10  0              0.0005438317   2.6109412e-16  0              2.995215     
   1900000   98.4           200            200            0.0053268543   8.3311904e-39  0              0.015980563    1.7550885e-11  0              8.474694e-05   2.6109412e-16  0              2.995215     
   2000000   98.4           200            200            0.0053268556  -1.3380669e-38  0              0.015980567    2.6109073e-12  0              1.2607137e-05  2.6109412e-16  0              2.995215     
   2100000   98.4           200            200            0.0053268559  -1.6704369e-39  0              0.015980568    3.7227304e-13  0              1.7975733e-06  2.6109412e-16  0              2.995215     
   2200000   98.4           200            200            0.005326856    4.3610892e-38  0              0.015980568    5.0998863e-14  0              2.4625526e-07  2.6109412e-16  0              2.995215     
   2300000   98.4           200            200            0.005326856    9.8877752e-39  0              0.015980568    6.7176538e-15  0              3.2437146e-08  2.6109412e-16  0              2.995215     
   2400000   98.4           200            200            0.005326856    2.2603698e-38  0              0.015980568    8.4928085e-16  0              4.1008733e-09  2.6109412e-16  0              2.995215     
   2500000   98.4           200            200            0.005326856   -1.826189e-38   0              0.015980568    1.0131972e-16  0              4.8923665e-10  2.6109412e-16  0              2.995215     
   2600000   98.4           200            200            0.005326856    2.0437125e-38  0              0.015980568    1.1143391e-17  0              5.3807449e-11  2.6109412e-16  0              2.995215     
   2700000   98.4           200            200            0.005326856    4.2147649e-38  0              0.015980568    1.2813308e-18  0              6.1870878e-12  2.6109412e-16  0              2.995215     
   2800000   98.4           200            200            0.005326856   -5.1690939e-38  0              0.015980568    5.7333354e-20  0              2.7684225e-13  2.6109412e-16  0              2.995215     
   2900000   98.4           200            200            0.005326856    8.3651189e-38  0              0.015980568    1.5831645e-19  0              7.6445346e-13  2.6109412e-16  0              2.995215     
   3000000   98.4           200            200            0.005326856   -2.5017009e-39  0              0.015980568    2.6090618e-21  0              1.2598225e-14  2.6109412e-16  0              2.995215     
Loop time of 70.3041 on 4 procs for 3000000 steps with 51 atoms

Performance: 36868389.936 ns/day, 0.000 hours/ns, 42671.748 timesteps/s
99.8% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 0.22262    | 1.2791     | 4.246      | 151.5 |  1.82
Neigh   | 0.074098   | 0.076558   | 0.080124   |   0.9 |  0.11
Comm    | 30.056     | 37.607     | 44.07      |  93.0 | 53.49
Output  | 0.43783    | 0.47671    | 0.59077    |   9.5 |  0.68
Modify  | 15.104     | 21.846     | 30.14      | 142.8 | 31.07
Other   |            | 9.018      |            |       | 12.83

Nlocal:          12.75 ave          51 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1
Nghost:          39.25 ave          52 max           1 min
Histogram: 1 0 0 0 0 0 0 0 0 3
Neighs:           7.25 ave          29 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1

Total # of neighbors = 29
Ave neighs/atom = 0.56862745
Neighbor list builds = 166
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 29

#variable lat0 equal 1                    #
variable lat1 equal 3+(v_ind*0.01)  # .491+(v_ind*0.001)       # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 10*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 3.29                                                               
Lattice spacing in x,y,z = 3.29 3.29 3.29

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -49.35 ${n1e1} -100 100 -100 100 units box
region box block -49.35 49.35 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -49.35 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -49.35 49.35 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-49.35 -100 -100) to (49.35 100 100)
  1 by 2 by 2 MPI processor grid
create_atoms 1 region substrate
Created 30 atoms
  using lattice units in orthogonal box = (-49.35 -100 -100) to (49.35 100 100)
  create_atoms CPU = 0.000 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 30 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 21 atoms
  using lattice units in orthogonal box = (-49.35 -100 -100) to (49.35 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  30 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  30 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  21 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  21 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
30 atoms in group substrate
group slider1 region slider1
21 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 21 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 10000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 10000 Equi_29_*.dump id type diameter mass xu yu zu fx fy fz

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 64 130 130
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 13.98 | 17.45 | 18.6 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   98.7           200            200            0              0              0              0              0              0              0              2.6109412e-16  0              6            
    100000   98.7           200            200            0.0043095573  -9.8362957e-38  0              0.012928672    12226.539      0              5.9037581e+10  2.6109412e-16  0              3.3267366    
    200000   98.7           200            200            0.0014961014  -3.6402467e-37  0              0.0044883042   2886.7212      0              1.3938944e+10  2.6109412e-16  0              3.0762598    
    300000   98.7           200            200           -1.1820707e-05  1.7002897e-36  0             -3.5462122e-05  0.40207707     0              1941486.3      2.6109412e-16  0              3.0440888    
    400000   98.7           200            200           -0.00017917908  1.432421e-35   0             -0.00053753724  133.44381      0              6.443524e+08   2.6109412e-16  0              2.9999276    
    500000   98.7           200            200            0.0046794466   1.9379905e-35  0              0.01403834     28.975434      0              1.39912e+08    2.6109412e-16  0              2.9956675    
    600000   98.7           200            200            0.0038732842  -1.1624412e-36  0              0.011619852    1.3544155      0              6539987.8      2.6109412e-16  0              2.9961381    
    700000   98.7           200            200            0.0046976403  -3.1069566e-35  0              0.014092921    0.082061581    0              396246.01      2.6109412e-16  0              2.9955944    
    800000   98.7           200            200            0.005071123    4.7876171e-37  0              0.015213369    0.0044830438   0              21647.014      2.6109412e-16  0              2.9953609    
    900000   98.7           200            200            0.0052198478   3.2494143e-36  0              0.015659543    0.00011587424  0              559.51523      2.6109412e-16  0              2.9952699    
   1000000   98.7           200            200            0.0052769909   9.4805449e-37  0              0.015830973    1.4232002e-06  0              6.8721247      2.6109412e-16  0              2.9952353    
   1100000   98.7           200            200            0.0052984327   2.1902882e-37  0              0.015895298    5.4080707e-06  0              26.113638      2.6109412e-16  0              2.9952223    
   1200000   98.7           200            200            0.005306312    1.483265e-37   0              0.015918936    2.3491882e-06  0              11.343389      2.6109412e-16  0              2.9952176    
   1300000   98.7           200            200            0.0053091493  -2.8120137e-39  0              0.015927448    6.429771e-07   0              3.1047063      2.6109412e-16  0              2.9952159    
   1400000   98.7           200            200            0.0053101499   1.6301268e-38  0              0.01593045     1.4192969e-07  0              0.68532766     2.6109412e-16  0              2.9952153    
   1500000   98.7           200            200            0.0053104948  -4.7993108e-38  0              0.015931484    2.7535881e-08  0              0.13296092     2.6109412e-16  0              2.9952151    
   1600000   98.7           200            200            0.0053106107   4.8184763e-40  0              0.015931832    4.8867227e-09  0              0.023596235    2.6109412e-16  0              2.995215     
   1700000   98.7           200            200            0.0053106484  -4.5244718e-38  0              0.015931945    8.1054918e-10  0              0.0039138519   2.6109412e-16  0              2.995215     
   1800000   98.7           200            200            0.0053106602   7.5883622e-38  0              0.015931981    1.2725256e-10  0              0.00061445709  2.6109412e-16  0              2.995215     
   1900000   98.7           200            200            0.0053106637  -1.0461363e-38  0              0.015931991    1.9054971e-11  0              9.2009635e-05  2.6109412e-16  0              2.995215     
   2000000   98.7           200            200            0.0053106647   7.9158843e-39  0              0.015931994    2.733945e-12   0              1.3201242e-05  2.6109412e-16  0              2.995215     
   2100000   98.7           200            200            0.0053106649  -3.1012982e-39  0              0.015931995    3.7682343e-13  0              1.8195455e-06  2.6109412e-16  0              2.995215     
   2200000   98.7           200            200            0.0053106649  -2.7774488e-38  0              0.015931995    4.9908349e-14  0              2.4098955e-07  2.6109412e-16  0              2.995215     
   2300000   98.7           200            200            0.0053106649  -3.9879038e-40  0              0.015931995    6.3489392e-15  0              3.0656755e-08  2.6109412e-16  0              2.995215     
   2400000   98.7           200            200            0.0053106649   3.2350463e-38  0              0.015931995    7.7563937e-16  0              3.7452849e-09  2.6109412e-16  0              2.995215     
   2500000   98.7           200            200            0.0053106649   2.3807396e-38  0              0.015931995    8.8749038e-17  0              4.2853734e-10  2.6109412e-16  0              2.995215     
   2600000   98.7           200            200            0.0053106649  -5.0825788e-38  0              0.015931995    9.2476284e-18  0              4.4653488e-11  2.6109412e-16  0              2.995215     
   2700000   98.7           200            200            0.0053106649  -2.2765669e-38  0              0.015931995    1.0064419e-18  0              4.8597477e-12  2.6109412e-16  0              2.995215     
   2800000   98.7           200            200            0.0053106649   5.9649089e-38  0              0.015931995    3.1601339e-20  0              1.5259156e-13  2.6109412e-16  0              2.995215     
   2900000   98.7           200            200            0.0053106649   2.5229767e-38  0              0.015931995    1.5229374e-19  0              7.3537198e-13  2.6109412e-16  0              2.995215     
   3000000   98.7           200            200            0.0053106649   2.548199e-38   0              0.015931995    1.1439777e-24  0              5.5238588e-18  2.6109412e-16  0              2.995215     
Loop time of 70.2711 on 4 procs for 3000000 steps with 51 atoms

Performance: 36885739.047 ns/day, 0.000 hours/ns, 42691.828 timesteps/s
99.8% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 0.22273    | 1.2636     | 4.1969     | 150.7 |  1.80
Neigh   | 0.073711   | 0.075882   | 0.079226   |   0.8 |  0.11
Comm    | 30.027     | 37.566     | 43.982     |  93.2 | 53.46
Output  | 0.44807    | 0.48758    | 0.6036     |   9.6 |  0.69
Modify  | 15.089     | 21.837     | 30.101     | 142.3 | 31.08
Other   |            | 9.041      |            |       | 12.87

Nlocal:          12.75 ave          51 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1
Nghost:          39.25 ave          52 max           1 min
Histogram: 1 0 0 0 0 0 0 0 0 3
Neighs:           7.25 ave          29 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1

Total # of neighbors = 29
Ave neighs/atom = 0.56862745
Neighbor list builds = 164
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 30

#variable lat0 equal 1                    #
variable lat1 equal 3+(v_ind*0.01)  # .491+(v_ind*0.001)       # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 10*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 3.3                                                               
Lattice spacing in x,y,z = 3.3 3.3 3.3

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -49.5 ${n1e1} -100 100 -100 100 units box
region box block -49.5 49.5 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -49.5 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -49.5 49.5 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-49.5 -100 -100) to (49.5 100 100)
  1 by 2 by 2 MPI processor grid
create_atoms 1 region substrate
Created 30 atoms
  using lattice units in orthogonal box = (-49.5 -100 -100) to (49.5 100 100)
  create_atoms CPU = 0.000 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 30 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 21 atoms
  using lattice units in orthogonal box = (-49.5 -100 -100) to (49.5 100 100)
  create_atoms CPU = 0.002 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  30 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  30 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  21 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  21 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
30 atoms in group substrate
group slider1 region slider1
21 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 21 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 10000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 10000 Equi_30_*.dump id type diameter mass xu yu zu fx fy fz

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 64 130 130
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 13.98 | 17.45 | 18.6 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   99             200            200            0              0              0              0              0              0              0              2.6109412e-16  0              6            
    100000   99             200            200            0.0043061457   1.9936278e-37  0              0.012918437    12267.126      0              5.923356e+10   2.6109412e-16  0              3.3254053    
    200000   99             200            200            0.0015283402  -7.8857036e-37  0              0.0045850205   2999.8077      0              1.4484998e+10  2.6109412e-16  0              3.0709315    
    300000   99             200            200            4.7902907e-05  6.8142175e-38  0              0.00014370872  6.4195125      0              30997529       2.6109412e-16  0              3.0440948    
    400000   99             200            200           -0.0001565281  -1.482564e-36   0             -0.0004695843   87.851929      0              4.2420552e+08  2.6109412e-16  0              3.0020584    
    500000   99             200            200            0.0062307507   2.896338e-36   0              0.018692252    28.568174      0              1.3794549e+08  2.6109412e-16  0              2.9947243    
    600000   99             200            200            0.0042313893  -3.0905437e-36  0              0.012694168    2.5538389      0              12331574       2.6109412e-16  0              2.995899     
    700000   99             200            200            0.0047924472   6.0441984e-36  0              0.014377342    0.22991739     0              1110188.8      2.6109412e-16  0              2.9955283    
    800000   99             200            200            0.005086826    4.310053e-37   0              0.015260478    0.020822518    0              100544.49      2.6109412e-16  0              2.9953428    
    900000   99             200            200            0.0052118193   1.1409569e-36  0              0.015635458    0.001660908    0              8019.9304      2.6109412e-16  0              2.9952655    
   1000000   99             200            200            0.0052624423  -3.4518847e-37  0              0.015787327    0.00010339317  0              499.24862      2.6109412e-16  0              2.9952345    
   1100000   99             200            200            0.0052823696   5.0602366e-38  0              0.015847109    3.5724882e-06  0              17.250267      2.6109412e-16  0              2.9952224    
   1200000   99             200            200            0.0052900314   4.0588042e-38  0              0.015870094    2.6316971e-13  0              1.2707523e-06  2.6109412e-16  0              2.9952178    
   1300000   99             200            200            0.0052929156   9.6982301e-38  0              0.015878747    6.5253942e-08  0              0.31508793     2.6109412e-16  0              2.995216     
   1400000   99             200            200            0.0052939798  -8.4027196e-39  0              0.015881939    3.4658036e-08  0              0.16735125     2.6109412e-16  0              2.9952154    
   1500000   99             200            200            0.0052943647  -5.2089309e-38  0              0.015883094    1.0211882e-08  0              0.049309522    2.6109412e-16  0              2.9952151    
   1600000   99             200            200            0.0052945011   7.3838861e-39  0              0.015883503    2.3449521e-09  0              0.011322934    2.6109412e-16  0              2.9952151    
   1700000   99             200            200            0.0052945484   3.3997152e-38  0              0.015883645    4.6665926e-10  0              0.0022533306   2.6109412e-16  0              2.995215     
   1800000   99             200            200            0.0052945644  -3.191907e-38   0              0.015883693    8.4349246e-11  0              0.00040729232  2.6109412e-16  0              2.995215     
   1900000   99             200            200            0.0052945697   1.5160461e-38  0              0.015883709    1.4193276e-11  0              6.8534251e-05  2.6109412e-16  0              2.995215     
   2000000   99             200            200            0.0052945713  -1.7724037e-38  0              0.015883714    2.2550107e-12  0              1.088864e-05   2.6109412e-16  0              2.995215     
   2100000   99             200            200            0.0052945718   2.5116195e-38  0              0.015883715    3.41185e-13    0              1.6474602e-06  2.6109412e-16  0              2.995215     
   2200000   99             200            200            0.005294572   -2.4323943e-38  0              0.015883716    4.9420162e-14  0              2.3863228e-07  2.6109412e-16  0              2.995215     
   2300000   99             200            200            0.005294572   -3.8350435e-38  0              0.015883716    6.8731095e-15  0              3.3187786e-08  2.6109412e-16  0              2.995215     
   2400000   99             200            200            0.005294572    1.7363277e-38  0              0.015883716    9.1921512e-16  0              4.4385609e-09  2.6109412e-16  0              2.995215     
   2500000   99             200            200            0.005294572    9.0671574e-39  0              0.015883716    1.1736713e-16  0              5.6672384e-10  2.6109412e-16  0              2.995215     
   2600000   99             200            200            0.005294572    6.4478656e-38  0              0.015883716    1.4071093e-17  0              6.7944274e-11  2.6109412e-16  0              2.995215     
   2700000   99             200            200            0.005294572   -3.4177931e-38  0              0.015883716    1.729092e-18   0              8.3491663e-12  2.6109412e-16  0              2.995215     
   2800000   99             200            200            0.005294572   -3.7778074e-38  0              0.015883716    1.1761543e-19  0              5.679228e-13   2.6109412e-16  0              2.995215     
   2900000   99             200            200            0.005294572    1.6450615e-38  0              0.015883716    1.0637907e-19  0              5.1366644e-13  2.6109412e-16  0              2.995215     
   3000000   99             200            200            0.005294572    4.1366494e-39  0              0.015883716    4.0817456e-20  0              1.9709289e-13  2.6109412e-16  0              2.995215     
Loop time of 71.0384 on 4 procs for 3000000 steps with 51 atoms

Performance: 36487294.491 ns/day, 0.000 hours/ns, 42230.665 timesteps/s
99.8% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 0.2263     | 1.3234     | 4.4614     | 157.5 |  1.86
Neigh   | 0.075713   | 0.07775    | 0.080822   |   0.7 |  0.11
Comm    | 30.567     | 38.025     | 44.549     |  91.5 | 53.53
Output  | 0.45343    | 0.49324    | 0.61021    |   9.6 |  0.69
Modify  | 15.23      | 22.003     | 30.246     | 142.4 | 30.97
Other   |            | 9.116      |            |       | 12.83

Nlocal:          12.75 ave          51 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1
Nghost:          39.25 ave          52 max           1 min
Histogram: 1 0 0 0 0 0 0 0 0 3
Neighs:           7.25 ave          29 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1

Total # of neighbors = 29
Ave neighs/atom = 0.56862745
Neighbor list builds = 164
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 31

#variable lat0 equal 1                    #
variable lat1 equal 3+(v_ind*0.01)  # .491+(v_ind*0.001)       # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 10*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 3.31                                                               
Lattice spacing in x,y,z = 3.31 3.31 3.31

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -49.65 ${n1e1} -100 100 -100 100 units box
region box block -49.65 49.65 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -49.65 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -49.65 49.65 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-49.65 -100 -100) to (49.65 100 100)
  1 by 2 by 2 MPI processor grid
create_atoms 1 region substrate
Created 30 atoms
  using lattice units in orthogonal box = (-49.65 -100 -100) to (49.65 100 100)
  create_atoms CPU = 0.000 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 30 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 21 atoms
  using lattice units in orthogonal box = (-49.65 -100 -100) to (49.65 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  30 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  30 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  21 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  21 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
30 atoms in group substrate
group slider1 region slider1
21 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 21 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 10000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 10000 Equi_31_*.dump id type diameter mass xu yu zu fx fy fz

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 65 130 130
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 14 | 17.47 | 18.62 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   99.3           200            200            0              0              0              0              0              0              0              2.6109412e-16  0              6            
    100000   99.3           200            200            0.0042999967  -2.4806378e-37  0              0.01289999     12293.064      0              5.9358804e+10  2.6109412e-16  0              3.3256226    
    200000   99.3           200            200            0.0015369905  -9.767876e-38   0              0.0046109715   3038.9509      0              1.4674006e+10  2.6109412e-16  0              3.071118     
    300000   99.3           200            200            0.00011550556  2.4880187e-38  0              0.00034651668  35.272321      0              1.7031742e+08  2.6109412e-16  0              3.0446345    
    400000   99.3           200            200            0.0002123022  -1.9118838e-37  0              0.00063690659  112.89348      0              5.4512222e+08  2.6109412e-16  0              3.0014454    
    500000   99.3           200            200            0.0022522022  -1.3778752e-35  0              0.0067566067   15.759819      0              76098526       2.6109412e-16  0              2.9973497    
    600000   99.3           200            200            0.0035358535   3.6113959e-36  0              0.01060756     0.0032704741   0              15791.949      2.6109412e-16  0              2.9963384    
    700000   99.3           200            200            0.0046308828   5.7441466e-36  0              0.013892648    0.022347317    0              107907.2       2.6109412e-16  0              2.9956136    
    800000   99.3           200            200            0.0050482507   2.7781126e-37  0              0.015144752    0.0090456539   0              43678.226      2.6109412e-16  0              2.9953543    
    900000   99.3           200            200            0.0051988608   3.3883641e-37  0              0.015596582    0.002294833    0              11080.927      2.6109412e-16  0              2.9952628    
   1000000   99.3           200            200            0.0052517263  -1.2748763e-37  0              0.015755179    0.00048205682  0              2327.6799      2.6109412e-16  0              2.995231     
   1100000   99.3           200            200            0.0052698101   3.1158865e-38  0              0.01580943     9.0359716e-05  0              436.31473      2.6109412e-16  0              2.9952202    
   1200000   99.3           200            200            0.0052758243   1.0330262e-38  0              0.015827473    1.5626368e-05  0              75.45414       2.6109412e-16  0              2.9952166    
   1300000   99.3           200            200            0.0052777578  -1.0464312e-38  0              0.015833273    2.5386163e-06  0              12.25807       2.6109412e-16  0              2.9952155    
   1400000   99.3           200            200            0.0052783524   9.7299445e-39  0              0.015835057    3.9158335e-07  0              1.8908158      2.6109412e-16  0              2.9952151    
   1500000   99.3           200            200            0.005278524   -1.3331517e-39  0              0.015835572    5.7722735e-08  0              0.27872243     2.6109412e-16  0              2.995215     
   1600000   99.3           200            200            0.0052785685  -6.9214461e-39  0              0.015835705    8.1620975e-09  0              0.039411848    2.6109412e-16  0              2.995215     
   1700000   99.3           200            200            0.0052785777  -1.1571749e-38  0              0.015835733    1.1091128e-09  0              0.0053555085   2.6109412e-16  0              2.995215     
   1800000   99.3           200            200            0.0052785784  -6.0309473e-39  0              0.015835735    1.4485717e-10  0              0.00069946343  2.6109412e-16  0              2.995215     
   1900000   99.3           200            200            0.0052785776  -7.3447339e-39  0              0.015835733    1.8157667e-11  0              8.7676874e-05  2.6109412e-16  0              2.995215     
   2000000   99.3           200            200            0.005278577    1.5578092e-39  0              0.015835731    2.1772315e-12  0              1.0513072e-05  2.6109412e-16  0              2.995215     
   2100000   99.3           200            200            0.0052785766   6.7230708e-39  0              0.01583573     2.4826984e-13  0              1.1988062e-06  2.6109412e-16  0              2.995215     
   2200000   99.3           200            200            0.0052785764  -6.5788651e-39  0              0.015835729    2.667632e-14   0              1.288104e-07   2.6109412e-16  0              2.995215     
   2300000   99.3           200            200            0.0052785764  -2.6498465e-39  0              0.015835729    2.6574221e-15  0              1.283174e-08   2.6109412e-16  0              2.995215     
   2400000   99.3           200            200            0.0052785763  -3.2001912e-39  0              0.015835729    2.4217236e-16  0              1.1693637e-09  2.6109412e-16  0              2.995215     
   2500000   99.3           200            200            0.0052785763   1.0402293e-38  0              0.015835729    1.8917786e-17  0              9.134722e-11   2.6109412e-16  0              2.995215     
   2600000   99.3           200            200            0.0052785763  -6.1858968e-40  0              0.015835729    9.7492018e-19  0              4.7075406e-12  2.6109412e-16  0              2.995215     
   2700000   99.3           200            200            0.0052785763  -1.452544e-38   0              0.015835729    7.9011881e-21  0              3.815201e-14   2.6109412e-16  0              2.995215     
   2800000   99.3           200            200            0.0052785763  -9.5797414e-39  0              0.015835729    1.9622633e-20  0              9.4750674e-14  2.6109412e-16  0              2.995215     
   2900000   99.3           200            200            0.0052785763   6.4776912e-39  0              0.015835729    1.0886253e-20  0              5.2565819e-14  2.6109412e-16  0              2.995215     
   3000000   99.3           200            200            0.0052785763  -8.2279901e-39  0              0.015835729    1.3629443e-19  0              6.5811704e-13  2.6109412e-16  0              2.995215     
Loop time of 70.491 on 4 procs for 3000000 steps with 51 atoms

Performance: 36770663.794 ns/day, 0.000 hours/ns, 42558.639 timesteps/s
99.8% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 0.22132    | 1.2519     | 4.1545     | 149.8 |  1.78
Neigh   | 0.07385    | 0.075886   | 0.078955   |   0.8 |  0.11
Comm    | 30.199     | 37.706     | 44.104     |  92.8 | 53.49
Output  | 0.46012    | 0.49989    | 0.61645    |   9.5 |  0.71
Modify  | 15.192     | 21.928     | 30.135     | 142.0 | 31.11
Other   |            | 9.029      |            |       | 12.81

Nlocal:          12.75 ave          51 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1
Nghost:          39.25 ave          52 max           1 min
Histogram: 1 0 0 0 0 0 0 0 0 3
Neighs:           7.25 ave          29 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1

Total # of neighbors = 29
Ave neighs/atom = 0.56862745
Neighbor list builds = 164
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 32

#variable lat0 equal 1                    #
variable lat1 equal 3+(v_ind*0.01)  # .491+(v_ind*0.001)       # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 10*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 3.32                                                               
Lattice spacing in x,y,z = 3.32 3.32 3.32

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -49.8 ${n1e1} -100 100 -100 100 units box
region box block -49.8 49.8 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -49.8 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -49.8 49.8 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-49.8 -100 -100) to (49.8 100 100)
  1 by 2 by 2 MPI processor grid
create_atoms 1 region substrate
Created 30 atoms
  using lattice units in orthogonal box = (-49.8 -100 -100) to (49.8 100 100)
  create_atoms CPU = 0.000 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 30 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 21 atoms
  using lattice units in orthogonal box = (-49.8 -100 -100) to (49.8 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  30 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  30 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  21 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  21 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
30 atoms in group substrate
group slider1 region slider1
21 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 21 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 10000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 10000 Equi_32_*.dump id type diameter mass xu yu zu fx fy fz

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 65 130 130
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 14 | 17.47 | 18.62 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   99.6           200            200            0              0              0              0              0              0              0              2.6109412e-16  0              6            
    100000   99.6           200            200            0.0042940085   2.3471726e-40  0              0.012882026    12320.286      0              5.9490254e+10  2.6109412e-16  0              3.3255337    
    200000   99.6           200            200            0.0015319439  -2.4715776e-37  0              0.0045958318   3034.9978      0              1.4654918e+10  2.6109412e-16  0              3.0738514    
    300000   99.6           200            200            0.00012822965  7.4278649e-38  0              0.00038468894  43.196046      0              2.0857825e+08  2.6109412e-16  0              3.0467509    
    400000   99.6           200            200            0.02390971    -0.014191282    0              0.085920413    20.839895      0              1.006284e+08   2.6109412e-16  0              2.9913306    
    500000   99.6           200            200            0.012034697   -0.0062307735   0              0.042334864    1.8888505      0              9120583.2      2.6109412e-16  0              2.9940218    
    600000   99.6           200            200            0.0039746944  -0.0018879118   0              0.013811995    5.1632175      0              24931329       2.6109412e-16  0              2.9964356    
    700000   99.6           200            200            0.0037045975  -0.0015536768   0              0.012667469    0.0021398112   0              10332.382      2.6109412e-16  0              2.9965767    
    800000   99.6           200            200            0.004791874   -0.0018191938   0              0.016194816    0.086456011    0              417465.13      2.6109412e-16  0              2.9961982    
    900000   99.6           200            200            0.004757221   -0.0018164259   0              0.016088089    0.0070922992   0              34246.175      2.6109412e-16  0              2.9962071    
   1000000   99.6           200            200            0.0046124128  -0.0018009274   0              0.015638166    0.00011908574  0              575.02243      2.6109412e-16  0              2.9962539    
   1100000   99.6           200            200            0.0046667322  -0.0018067843   0              0.015806981    0.00022854448  0              1103.5595      2.6109412e-16  0              2.9962366    
   1200000   99.6           200            200            0.0046676201  -0.0018069178   0              0.015809778    1.3895963e-05  0              67.098631      2.6109412e-16  0              2.9962362    
   1300000   99.6           200            200            0.0046599539  -0.0018060891   0              0.015785951    5.7973711e-07  0              2.799343       2.6109412e-16  0              2.9962387    
   1400000   99.6           200            200            0.0046624756  -0.001806357    0              0.015793784    5.8778137e-07  0              2.8381859      2.6109412e-16  0              2.9962379    
   1500000   99.6           200            200            0.0046626441  -0.001806377    0              0.015794309    2.5945051e-08  0              0.12527937     2.6109412e-16  0              2.9962378    
   1600000   99.6           200            200            0.0046622448  -0.0018063338   0              0.015793068    2.3284421e-09  0              0.011243214    2.6109412e-16  0              2.9962379    
   1700000   99.6           200            200            0.0046623596  -0.001806346    0              0.015793425    1.4760311e-09  0              0.0071272262   2.6109412e-16  0              2.9962379    
   1800000   99.6           200            200            0.0046623741  -0.0018063476   0              0.01579347     4.4964501e-11  0              0.00021711748  2.6109412e-16  0              2.9962379    
   1900000   99.6           200            200            0.0046623536  -0.0018063454   0              0.015793406    8.3444951e-12  0              4.0292581e-05  2.6109412e-16  0              2.9962379    
   2000000   99.6           200            200            0.0046623587  -0.001806346    0              0.015793422    3.6194639e-12  0              1.7477096e-05  2.6109412e-16  0              2.9962379    
   2100000   99.6           200            200            0.0046623597  -0.0018063461   0              0.015793425    6.9987095e-14  0              3.3794263e-07  2.6109412e-16  0              2.9962379    
   2200000   99.6           200            200            0.0046623586  -0.001806346    0              0.015793422    2.7660615e-14  0              1.3356321e-07  2.6109412e-16  0              2.9962379    
   2300000   99.6           200            200            0.0046623589  -0.001806346    0              0.015793423    8.6677037e-15  0              4.1853239e-08  2.6109412e-16  0              2.9962379    
   2400000   99.6           200            200            0.0046623589  -0.001806346    0              0.015793423    8.9737711e-17  0              4.3331129e-10  2.6109412e-16  0              2.9962379    
   2500000   99.6           200            200            0.0046623589  -0.001806346    0              0.015793423    8.6342382e-17  0              4.1691646e-10  2.6109412e-16  0              2.9962379    
   2600000   99.6           200            200            0.0046623589  -0.001806346    0              0.015793423    2.0210059e-17  0              9.7587143e-11  2.6109412e-16  0              2.9962379    
   2700000   99.6           200            200            0.0046623589  -0.001806346    0              0.015793423    4.1082442e-20  0              1.9837241e-13  2.6109412e-16  0              2.9962379    
   2800000   99.6           200            200            0.0046623589  -0.001806346    0              0.015793423    3.1262138e-19  0              1.5095368e-12  2.6109412e-16  0              2.9962379    
   2900000   99.6           200            200            0.0046623589  -0.001806346    0              0.015793423    1.5491726e-19  0              7.4804e-13     2.6109412e-16  0              2.9962379    
   3000000   99.6           200            200            0.0046623589  -0.001806346    0              0.015793423    1.5480582e-19  0              7.4750188e-13  2.6109412e-16  0              2.9962379    
Loop time of 70.4555 on 4 procs for 3000000 steps with 51 atoms

Performance: 36789191.065 ns/day, 0.000 hours/ns, 42580.082 timesteps/s
99.8% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 0.22639    | 1.3211     | 4.4185     | 155.6 |  1.88
Neigh   | 0.071324   | 0.073727   | 0.077182   |   0.9 |  0.10
Comm    | 30.078     | 37.558     | 44.04      |  92.8 | 53.31
Output  | 0.45344    | 0.49338    | 0.61057    |   9.6 |  0.70
Modify  | 15.171     | 21.908     | 30.087     | 141.3 | 31.09
Other   |            | 9.102      |            |       | 12.92

Nlocal:          12.75 ave          51 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1
Nghost:          39.25 ave          52 max           1 min
Histogram: 1 0 0 0 0 0 0 0 0 3
Neighs:           7.75 ave          31 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1

Total # of neighbors = 31
Ave neighs/atom = 0.60784314
Neighbor list builds = 166
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 33

#variable lat0 equal 1                    #
variable lat1 equal 3+(v_ind*0.01)  # .491+(v_ind*0.001)       # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 10*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 3.33                                                               
Lattice spacing in x,y,z = 3.33 3.33 3.33

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -49.95 ${n1e1} -100 100 -100 100 units box
region box block -49.95 49.95 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -49.95 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -49.95 49.95 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-49.95 -100 -100) to (49.95 100 100)
  1 by 2 by 2 MPI processor grid
create_atoms 1 region substrate
Created 30 atoms
  using lattice units in orthogonal box = (-49.95 -100 -100) to (49.95 100 100)
  create_atoms CPU = 0.000 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 30 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 21 atoms
  using lattice units in orthogonal box = (-49.95 -100 -100) to (49.95 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  30 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  30 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  21 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  21 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
30 atoms in group substrate
group slider1 region slider1
21 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 21 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 10000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 10000 Equi_33_*.dump id type diameter mass xu yu zu fx fy fz

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 65 130 130
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 14 | 17.47 | 18.62 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   99.9           200            200            0              0              0              0              0              0              0              2.6109412e-16  0              6            
    100000   99.9           200            200            0.0042881378  -1.8504519e-37  0              0.012864413    12349.587      0              5.9631738e+10  2.6109412e-16  0              3.3247735    
    200000   99.9           200            200            0.0015305886   1.4578333e-40  0              0.0045917659   3043.6866      0              1.4696873e+10  2.6109412e-16  0              3.0748583    
    300000   99.9           200            200            0.00012463051 -1.2337979e-38  0              0.00037389154  41.124908      0              1.9857746e+08  2.6109412e-16  0              3.0483487    
    400000   99.9           200            200            0.02997479    -1.4762764e-05  0              0.089939133    7.2255339      0              34889517       2.6109412e-16  0              2.9925517    
    500000   99.9           200            200           -5.2135522e-05 -6.8957798e-37  0             -0.00015640657  11.2285        0              54218408       2.6109412e-16  0              2.9999437    
    600000   99.9           200            200            0.0052620255  -0.00017077746  0              0.015956854    5.7945096      0              27979613       2.6109412e-16  0              2.9975933    
    700000   99.9           200            200            0.0050746693  -0.00017384707  0              0.015397855    0.77702398     0              3751970.7      2.6109412e-16  0              2.9976396    
    800000   99.9           200            200            0.0052444567  -0.00017031687  0              0.015903687    0.10515015     0              507732.46      2.6109412e-16  0              2.9975872    
    900000   99.9           200            200            0.0052523155  -0.00017007982  0              0.015927026    0.012513362    0              60422.545      2.6109412e-16  0              2.9975838    
   1000000   99.9           200            200            0.0052287456  -0.0001705192   0              0.015856756    0.0012657765   0              6111.9819      2.6109412e-16  0              2.9975902    
   1100000   99.9           200            200            0.0052107785  -0.00017086537  0              0.015803201    0.00010292348  0              496.98066      2.6109412e-16  0              2.9975953    
   1200000   99.9           200            200            0.0052012135  -0.00017105142  0              0.015774692    5.7417141e-06  0              27.724683      2.6109412e-16  0              2.997598     
   1300000   99.9           200            200            0.0051968501  -0.00017113674  0              0.015761687    1.0905979e-07  0              0.52661068     2.6109412e-16  0              2.9975993    
   1400000   99.9           200            200            0.0051950437  -0.00017117221  0              0.015756303    8.0152624e-09  0              0.038702834    2.6109412e-16  0              2.9975998    
   1500000   99.9           200            200            0.0051943505  -0.00017118587  0              0.015754237    1.1730045e-08  0              0.05664019     2.6109412e-16  0              2.9976       
   1600000   99.9           200            200            0.0051941023  -0.00017119078  0              0.015753498    4.2056502e-09  0              0.020307579    2.6109412e-16  0              2.9976001    
   1700000   99.9           200            200            0.0051940197  -0.00017119242  0              0.015753251    9.8784663e-10  0              0.0047699578   2.6109412e-16  0              2.9976001    
   1800000   99.9           200            200            0.0051939946  -0.00017119292  0              0.015753177    1.8387095e-10  0              0.00088784702  2.6109412e-16  0              2.9976001    
   1900000   99.9           200            200            0.0051939879  -0.00017119306  0              0.015753157    2.8979603e-11  0              0.00013993213  2.6109412e-16  0              2.9976001    
   2000000   99.9           200            200            0.0051939866  -0.00017119308  0              0.015753153    3.9632746e-12  0              1.9137235e-05  2.6109412e-16  0              2.9976001    
   2100000   99.9           200            200            0.0051939865  -0.00017119309  0              0.015753153    4.709194e-13   0              2.2739012e-06  2.6109412e-16  0              2.9976001    
   2200000   99.9           200            200            0.0051939867  -0.00017119308  0              0.015753153    4.7678607e-14  0              2.3022293e-07  2.6109412e-16  0              2.9976001    
   2300000   99.9           200            200            0.0051939868  -0.00017119308  0              0.015753153    3.8827026e-15  0              1.8748181e-08  2.6109412e-16  0              2.9976001    
   2400000   99.9           200            200            0.0051939868  -0.00017119308  0              0.015753154    2.196733e-16   0              1.0607238e-09  2.6109412e-16  0              2.9976001    
   2500000   99.9           200            200            0.0051939869  -0.00017119308  0              0.015753154    3.9402782e-18  0              1.9026193e-11  2.6109412e-16  0              2.9976001    
   2600000   99.9           200            200            0.0051939869  -0.00017119308  0              0.015753154    2.2300726e-19  0              1.0768223e-12  2.6109412e-16  0              2.9976001    
   2700000   99.9           200            200            0.0051939869  -0.00017119308  0              0.015753154    5.8062655e-20  0              2.8036378e-13  2.6109412e-16  0              2.9976001    
   2800000   99.9           200            200            0.0051939869  -0.00017119308  0              0.015753154    3.6382154e-19  0              1.756764e-12   2.6109412e-16  0              2.9976001    
   2900000   99.9           200            200            0.0051939869  -0.00017119308  0              0.015753154    1.4076547e-19  0              6.7970607e-13  2.6109412e-16  0              2.9976001    
   3000000   99.9           200            200            0.0051939869  -0.00017119308  0              0.015753154    4.383794e-20   0              2.1167772e-13  2.6109412e-16  0              2.9976001    
Loop time of 70.3664 on 4 procs for 3000000 steps with 51 atoms

Performance: 36835764.896 ns/day, 0.000 hours/ns, 42633.987 timesteps/s
99.8% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 0.22578    | 1.3453     | 4.5385     | 159.0 |  1.91
Neigh   | 0.077109   | 0.079289   | 0.082622   |   0.8 |  0.11
Comm    | 30.232     | 37.601     | 44.037     |  91.4 | 53.44
Output  | 0.4541     | 0.49404    | 0.6112     |   9.6 |  0.70
Modify  | 15.107     | 21.825     | 29.96      | 141.7 | 31.02
Other   |            | 9.023      |            |       | 12.82

Nlocal:          12.75 ave          51 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1
Nghost:          39.25 ave          52 max           1 min
Histogram: 1 0 0 0 0 0 0 0 0 3
Neighs:           7.75 ave          31 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1

Total # of neighbors = 31
Ave neighs/atom = 0.60784314
Neighbor list builds = 166
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 34

#variable lat0 equal 1                    #
variable lat1 equal 3+(v_ind*0.01)  # .491+(v_ind*0.001)       # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 10*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 3.34                                                               
Lattice spacing in x,y,z = 3.34 3.34 3.34

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -50.1 ${n1e1} -100 100 -100 100 units box
region box block -50.1 50.1 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -50.1 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -50.1 50.1 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-50.1 -100 -100) to (50.1 100 100)
  1 by 2 by 2 MPI processor grid
create_atoms 1 region substrate
Created 30 atoms
  using lattice units in orthogonal box = (-50.1 -100 -100) to (50.1 100 100)
  create_atoms CPU = 0.000 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 30 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 21 atoms
  using lattice units in orthogonal box = (-50.1 -100 -100) to (50.1 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  30 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  30 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  21 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  21 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
30 atoms in group substrate
group slider1 region slider1
21 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 21 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 10000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 10000 Equi_34_*.dump id type diameter mass xu yu zu fx fy fz

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 65 130 130
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 14 | 17.47 | 18.62 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   100.2          200            200            0              0              0              0              0              0              0              2.6109412e-16  0              6            
    100000   100.2          200            200            0.0042804944   3.0760246e-39  0              0.012841483    12372.912      0              5.9744365e+10  2.6109412e-16  0              3.3236053    
    200000   100.2          200            200            0.0015494265  -1.2277581e-38  0              0.0046482794   3118.2774      0              1.5057046e+10  2.6109412e-16  0              3.0706652    
    300000   100.2          200            200            0.00014877464 -2.4594961e-38  0              0.00044632393  57.791128      0              2.7905267e+08  2.6109412e-16  0              3.0472985    
    400000   100.2          200            200            0.031835636    0.005856045    0              0.089650864    5.225952       0              25234252       2.6109412e-16  0              2.9922391    
    500000   100.2          200            200           -1.5543784e-05 -1.9840584e-40  0             -4.6631351e-05  7.2310543      0              34916173       2.6109412e-16  0              2.9998406    
    600000   100.2          200            200            0.0050430851   0.0012579531   0              0.013871302    5.4641457      0              26384404       2.6109412e-16  0              2.9975046    
    700000   100.2          200            200            0.0050837637   0.0013989321   0              0.013852359    0.53778679     0              2596779.9      2.6109412e-16  0              2.9974974    
    800000   100.2          200            200            0.0054663196   0.0014177807   0              0.014981178    0.069441712    0              335309.17      2.6109412e-16  0              2.9973807    
    900000   100.2          200            200            0.0056215283   0.0014245629   0              0.015440022    0.0094870915   0              45809.77       2.6109412e-16  0              2.9973343    
   1000000   100.2          200            200            0.0056784937   0.0014269385   0              0.015608543    0.0013026748   0              6290.1503      2.6109412e-16  0              2.9973174    
   1100000   100.2          200            200            0.0056991618   0.0014277861   0              0.015669699    0.00017877242  0              863.22802      2.6109412e-16  0              2.9973113    
   1200000   100.2          200            200            0.0057066519   0.0014280915   0              0.015691864    2.4517367e-05  0              118.38559      2.6109412e-16  0              2.9973091    
   1300000   100.2          200            200            0.0057093659   0.0014282019   0              0.015699896    3.360842e-06   0              16.228303      2.6109412e-16  0              2.9973083    
   1400000   100.2          200            200            0.0057103491   0.0014282419   0              0.015702805    4.6054538e-07  0              2.2238088      2.6109412e-16  0              2.997308     
   1500000   100.2          200            200            0.0057107052   0.0014282564   0              0.015703859    6.3091e-08     0              0.30464386     2.6109412e-16  0              2.9973079    
   1600000   100.2          200            200            0.0057108341   0.0014282616   0              0.015704241    8.6405451e-09  0              0.0417221      2.6109412e-16  0              2.9973078    
   1700000   100.2          200            200            0.0057108808   0.0014282636   0              0.015704379    1.1830373e-09  0              0.0057124638   2.6109412e-16  0              2.9973078    
   1800000   100.2          200            200            0.0057108977   0.0014282642   0              0.015704429    1.6193449e-10  0              0.00078192372  2.6109412e-16  0              2.9973078    
   1900000   100.2          200            200            0.0057109038   0.0014282645   0              0.015704447    2.216019e-11   0              0.00010700363  2.6109412e-16  0              2.9973078    
   2000000   100.2          200            200            0.005710906    0.0014282646   0              0.015704453    3.0316538e-12  0              1.4638771e-05  2.6109412e-16  0              2.9973078    
   2100000   100.2          200            200            0.0057109068   0.0014282646   0              0.015704456    4.1468668e-13  0              2.0023736e-06  2.6109412e-16  0              2.9973078    
   2200000   100.2          200            200            0.0057109071   0.0014282646   0              0.015704457    5.6716907e-14  0              2.7386564e-07  2.6109412e-16  0              2.9973078    
   2300000   100.2          200            200            0.0057109072   0.0014282646   0              0.015704457    7.7649142e-15  0              3.7493992e-08  2.6109412e-16  0              2.9973078    
   2400000   100.2          200            200            0.0057109072   0.0014282646   0              0.015704457    1.0618439e-15  0              5.1272643e-09  2.6109412e-16  0              2.9973078    
   2500000   100.2          200            200            0.0057109072   0.0014282646   0              0.015704457    1.4591369e-16  0              7.0456499e-10  2.6109412e-16  0              2.9973078    
   2600000   100.2          200            200            0.0057109072   0.0014282646   0              0.015704457    1.9544437e-17  0              9.4373093e-11  2.6109412e-16  0              2.9973078    
   2700000   100.2          200            200            0.0057109072   0.0014282646   0              0.015704457    1.9817157e-18  0              9.5689961e-12  2.6109412e-16  0              2.9973078    
   2800000   100.2          200            200            0.0057109072   0.0014282646   0              0.015704457    9.3310785e-20  0              4.5056438e-13  2.6109412e-16  0              2.9973078    
   2900000   100.2          200            200            0.0057109072   0.0014282646   0              0.015704457    6.4958789e-20  0              3.1366274e-13  2.6109412e-16  0              2.9973078    
   3000000   100.2          200            200            0.0057109072   0.0014282646   0              0.015704457    6.5195661e-20  0              3.1480651e-13  2.6109412e-16  0              2.9973078    
Loop time of 70.5069 on 4 procs for 3000000 steps with 51 atoms

Performance: 36762371.859 ns/day, 0.000 hours/ns, 42549.042 timesteps/s
99.8% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 0.22593    | 1.3563     | 4.566      | 159.1 |  1.92
Neigh   | 0.078015   | 0.080664   | 0.084107   |   0.8 |  0.11
Comm    | 30.165     | 37.629     | 44.124     |  91.9 | 53.37
Output  | 0.45469    | 0.49471    | 0.61187    |   9.6 |  0.70
Modify  | 15.175     | 21.909     | 30.15      | 142.3 | 31.07
Other   |            | 9.038      |            |       | 12.82

Nlocal:          12.75 ave          51 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1
Nghost:          39.25 ave          52 max           1 min
Histogram: 1 0 0 0 0 0 0 0 0 3
Neighs:           7.75 ave          31 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1

Total # of neighbors = 31
Ave neighs/atom = 0.60784314
Neighbor list builds = 166
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 35

#variable lat0 equal 1                    #
variable lat1 equal 3+(v_ind*0.01)  # .491+(v_ind*0.001)       # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 10*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 3.35                                                               
Lattice spacing in x,y,z = 3.35 3.35 3.35

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -50.25 ${n1e1} -100 100 -100 100 units box
region box block -50.25 50.25 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -50.25 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -50.25 50.25 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-50.25 -100 -100) to (50.25 100 100)
  1 by 2 by 2 MPI processor grid
create_atoms 1 region substrate
Created 30 atoms
  using lattice units in orthogonal box = (-50.25 -100 -100) to (50.25 100 100)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 30 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 21 atoms
  using lattice units in orthogonal box = (-50.25 -100 -100) to (50.25 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  30 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  30 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  21 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  21 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
30 atoms in group substrate
group slider1 region slider1
21 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 21 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 10000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 10000 Equi_35_*.dump id type diameter mass xu yu zu fx fy fz

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 65 130 130
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 14 | 17.47 | 18.62 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   100.5          200            200            0              0              0              0              0              0              0              2.6109412e-16  0              6            
    100000   100.5          200            200            0.0042697033   6.1398387e-39  0              0.01280911     12382.692      0              5.9791586e+10  2.6109412e-16  0              3.3228395    
    200000   100.5          200            200            0.0015622405  -6.1302624e-38  0              0.0046867215   3174.919       0              1.5330548e+10  2.6109412e-16  0              3.0669736    
    300000   100.5          200            200            0.00021801578 -2.7593973e-38  0              0.00065404733  118.40063      0              5.7171425e+08  2.6109412e-16  0              3.0433016    
    400000   100.5          200            200            0.0024569189  -5.4890529e-36  0              0.0073707566   211.4259       0              1.0209e+09     2.6109412e-16  0              2.996929     
    500000   100.5          200            200            0.0060957112   0.00092595571  0              0.017361178    35.150332      0              1.6972837e+08  2.6109412e-16  0              2.9954058    
    600000   100.5          200            200            0.0065118029   0.0016652529   0              0.017870156    4.6198771      0              22307733       2.6109412e-16  0              2.9952996    
    700000   100.5          200            200            0.005644243    0.00076354562  0              0.016169183    0.65671629     0              3171047.9      2.6109412e-16  0              2.9955086    
    800000   100.5          200            200            0.0053376955   0.00077464926  0              0.015238437    0.074620253    0              360314.5       2.6109412e-16  0              2.9956155    
    900000   100.5          200            200            0.0053946925   0.00081031798  0              0.015373759    0.0058288913   0              28145.63       2.6109412e-16  0              2.9955979    
   1000000   100.5          200            200            0.0054446186   0.00081616318  0              0.015517693    0.00024440669  0              1180.1525      2.6109412e-16  0              2.9955802    
   1100000   100.5          200            200            0.0054717477   0.0008191751   0              0.015596068    1.527355e-07   0              0.73750507     2.6109412e-16  0              2.9955708    
   1200000   100.5          200            200            0.0054835735   0.00082045228  0              0.015630268    3.4187701e-06  0              16.508017      2.6109412e-16  0              2.9955667    
   1300000   100.5          200            200            0.0054880053   0.00082092408  0              0.015643092    1.7425707e-06  0              8.4142504      2.6109412e-16  0              2.9955652    
   1400000   100.5          200            200            0.0054894414   0.00082107551  0              0.015647249    4.2819043e-07  0              2.0675784      2.6109412e-16  0              2.9955647    
   1500000   100.5          200            200            0.0054898257   0.00082111559  0              0.015648362    7.277525e-08   0              0.35140564     2.6109412e-16  0              2.9955646    
   1600000   100.5          200            200            0.0054898948   0.00082112257  0              0.015648562    9.2759954e-09  0              0.044790462    2.6109412e-16  0              2.9955645    
   1700000   100.5          200            200            0.00548989     0.00082112194  0              0.015648548    8.698598e-10   0              0.0042002417   2.6109412e-16  0              2.9955645    
   1800000   100.5          200            200            0.0054898775   0.00082112056  0              0.015648512    5.1518399e-11  0              0.00024876391  2.6109412e-16  0              2.9955646    
   1900000   100.5          200            200            0.0054898695   0.0008211197   0              0.015648489    8.6043405e-13  0              4.1547281e-06  2.6109412e-16  0              2.9955646    
   2000000   100.5          200            200            0.0054898657   0.0008211193   0              0.015648478    1.1266051e-13  0              5.4399726e-07  2.6109412e-16  0              2.9955646    
   2100000   100.5          200            200            0.0054898642   0.00082111914  0              0.015648474    1.264022e-13   0              6.1035097e-07  2.6109412e-16  0              2.9955646    
   2200000   100.5          200            200            0.0054898637   0.00082111909  0              0.015648472    3.9275465e-14  0              1.8964716e-07  2.6109412e-16  0              2.9955646    
   2300000   100.5          200            200            0.0054898636   0.00082111907  0              0.015648472    7.6953642e-15  0              3.715816e-08   2.6109412e-16  0              2.9955646    
   2400000   100.5          200            200            0.0054898635   0.00082111907  0              0.015648472    1.1088773e-15  0              5.3543718e-09  2.6109412e-16  0              2.9955646    
   2500000   100.5          200            200            0.0054898635   0.00082111907  0              0.015648472    1.1960104e-16  0              5.7751061e-10  2.6109412e-16  0              2.9955646    
   2600000   100.5          200            200            0.0054898635   0.00082111907  0              0.015648472    8.9711812e-18  0              4.3318623e-11  2.6109412e-16  0              2.9955646    
   2700000   100.5          200            200            0.0054898635   0.00082111907  0              0.015648472    1.1346856e-20  0              5.4789907e-14  2.6109412e-16  0              2.9955646    
   2800000   100.5          200            200            0.0054898635   0.00082111907  0              0.015648472    8.9325308e-20  0              4.3131994e-13  2.6109412e-16  0              2.9955646    
   2900000   100.5          200            200            0.0054898635   0.00082111907  0              0.015648472    6.3554502e-20  0              3.0688194e-13  2.6109412e-16  0              2.9955646    
   3000000   100.5          200            200            0.0054898635   0.00082111906  0              0.015648472    6.2662813e-20  0              3.025763e-13   2.6109412e-16  0              2.9955646    
Loop time of 70.2544 on 4 procs for 3000000 steps with 51 atoms

Performance: 36894512.458 ns/day, 0.000 hours/ns, 42701.982 timesteps/s
99.8% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 0.2215     | 1.3386     | 4.4975     | 157.7 |  1.91
Neigh   | 0.082225   | 0.085032   | 0.088954   |   1.0 |  0.12
Comm    | 29.935     | 37.444     | 43.929     |  92.5 | 53.30
Output  | 0.45748    | 0.498      | 0.61687    |   9.7 |  0.71
Modify  | 15.107     | 21.843     | 30.106     | 142.8 | 31.09
Other   |            | 9.045      |            |       | 12.87

Nlocal:          12.75 ave          51 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1
Nghost:          39.25 ave          52 max           1 min
Histogram: 1 0 0 0 0 0 0 0 0 3
Neighs:           7.75 ave          31 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1

Total # of neighbors = 31
Ave neighs/atom = 0.60784314
Neighbor list builds = 166
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 36

#variable lat0 equal 1                    #
variable lat1 equal 3+(v_ind*0.01)  # .491+(v_ind*0.001)       # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 10*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 3.36                                                               
Lattice spacing in x,y,z = 3.36 3.36 3.36

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -50.4 ${n1e1} -100 100 -100 100 units box
region box block -50.4 50.4 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -50.4 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -50.4 50.4 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-50.4 -100 -100) to (50.4 100 100)
  1 by 2 by 2 MPI processor grid
create_atoms 1 region substrate
Created 30 atoms
  using lattice units in orthogonal box = (-50.4 -100 -100) to (50.4 100 100)
  create_atoms CPU = 0.000 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 30 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 21 atoms
  using lattice units in orthogonal box = (-50.4 -100 -100) to (50.4 100 100)
  create_atoms CPU = 0.002 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  30 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  30 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  21 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  21 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
30 atoms in group substrate
group slider1 region slider1
21 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 21 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 10000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 10000 Equi_36_*.dump id type diameter mass xu yu zu fx fy fz

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 66 130 130
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 14.02 | 17.49 | 18.64 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   100.8          200            200            0              0              0              0              0              0              0              2.6109412e-16  0              6            
    100000   100.8          200            200            0.0042550642   1.8343502e-38  0              0.012765193    12374.17       0              5.975044e+10   2.6109412e-16  0              3.323197     
    200000   100.8          200            200            0.0015487819   7.6429397e-40  0              0.0046463456   3146.5383      0              1.5193507e+10  2.6109412e-16  0              3.0684944    
    300000   100.8          200            200            0.00018753843  4.8920142e-38  0              0.0005626153   90.124611      0              4.3517949e+08  2.6109412e-16  0              3.0448318    
    400000   100.8          200            200            0.021000619   -0.01300196     0              0.076003817    63.118145      0              3.0477493e+08  2.6109412e-16  0              2.9918037    
    500000   100.8          200            200            0.009285885   -0.005303675    0              0.03316133     20.751981      0              1.0020389e+08  2.6109412e-16  0              2.9946584    
    600000   100.8          200            200            0.0031170334  -0.00088011415  0              0.010231214    3.1526635      0              15223084       2.6109412e-16  0              2.9968424    
    700000   100.8          200            200            0.0038014957  -0.0013912654   0              0.012795753    0.12250258     0              591521.12      2.6109412e-16  0              2.9965471    
    800000   100.8          200            200            0.004951577   -0.0016313099   0              0.016486041    0.043564613    0              210357.93      2.6109412e-16  0              2.9961479    
    900000   100.8          200            200            0.0046996198  -0.0016096581   0              0.015708517    0.01229777     0              59381.53       2.6109412e-16  0              2.9962265    
   1000000   100.8          200            200            0.0046167533  -0.0016014207   0              0.015451681    9.4574456e-05  0              456.6662       2.6109412e-16  0              2.9962541    
   1100000   100.8          200            200            0.0046789042  -0.0016074705   0              0.015644183    0.00013543357  0              653.96022      2.6109412e-16  0              2.9962339    
   1200000   100.8          200            200            0.0046687812  -0.0016065299   0              0.015612874    2.8349835e-05  0              136.89121      2.6109412e-16  0              2.9962371    
   1300000   100.8          200            200            0.0046638469  -0.0016060443   0              0.015597585    6.752022e-08   0              0.32603098     2.6109412e-16  0              2.9962387    
   1400000   100.8          200            200            0.0046669165  -0.0016063396   0              0.015607089    3.9806931e-07  0              1.9221342      2.6109412e-16  0              2.9962377    
   1500000   100.8          200            200            0.0046665268  -0.0016063037   0              0.015605884    6.3761696e-08  0              0.30788241     2.6109412e-16  0              2.9962378    
   1600000   100.8          200            200            0.0046662457  -0.0016062761   0              0.015605013    2.604369e-12   0              1.2575566e-05  2.6109412e-16  0              2.9962379    
   1700000   100.8          200            200            0.0046663953  -0.0016062905   0              0.015605476    1.1298257e-09  0              0.005455524    2.6109412e-16  0              2.9962379    
   1800000   100.8          200            200            0.0046663818  -0.0016062893   0              0.015605435    1.3918658e-10  0              0.00067208219  2.6109412e-16  0              2.9962379    
   1900000   100.8          200            200            0.0046663662  -0.0016062877   0              0.015605386    2.3444521e-13  0              1.132052e-06   2.6109412e-16  0              2.9962379    
   2000000   100.8          200            200            0.0046663734  -0.0016062884   0              0.015605409    3.1089104e-12  0              1.5011816e-05  2.6109412e-16  0              2.9962379    
   2100000   100.8          200            200            0.004666373   -0.0016062884   0              0.015605407    2.9360756e-13  0              1.4177258e-06  2.6109412e-16  0              2.9962379    
   2200000   100.8          200            200            0.0046663722  -0.0016062883   0              0.015605405    2.6958243e-15  0              1.3017171e-08  2.6109412e-16  0              2.9962379    
   2300000   100.8          200            200            0.0046663725  -0.0016062883   0              0.015605406    8.3221671e-15  0              4.0184766e-08  2.6109412e-16  0              2.9962379    
   2400000   100.8          200            200            0.0046663725  -0.0016062883   0              0.015605406    5.9372048e-16  0              2.8668637e-09  2.6109412e-16  0              2.9962379    
   2500000   100.8          200            200            0.0046663724  -0.0016062883   0              0.015605406    1.5534485e-17  0              7.5010469e-11  2.6109412e-16  0              2.9962379    
   2600000   100.8          200            200            0.0046663725  -0.0016062883   0              0.015605406    2.1729813e-17  0              1.0492549e-10  2.6109412e-16  0              2.9962379    
   2700000   100.8          200            200            0.0046663725  -0.0016062883   0              0.015605406    3.9620005e-19  0              1.9131083e-12  2.6109412e-16  0              2.9962379    
   2800000   100.8          200            200            0.0046663725  -0.0016062883   0              0.015605406    3.8352755e-19  0              1.8519173e-12  2.6109412e-16  0              2.9962379    
   2900000   100.8          200            200            0.0046663725  -0.0016062883   0              0.015605406    6.5843288e-20  0              3.1793367e-13  2.6109412e-16  0              2.9962379    
   3000000   100.8          200            200            0.0046663725  -0.0016062883   0              0.015605406    1.469757e-19   0              7.0969306e-13  2.6109412e-16  0              2.9962379    
Loop time of 70.6185 on 4 procs for 3000000 steps with 51 atoms

Performance: 36704277.634 ns/day, 0.000 hours/ns, 42481.803 timesteps/s
99.8% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 0.22124    | 1.3994     | 4.7507     | 163.6 |  1.98
Neigh   | 0.075217   | 0.076723   | 0.079322   |   0.6 |  0.11
Comm    | 30.102     | 37.663     | 44.215     |  92.6 | 53.33
Output  | 0.4564     | 0.49608    | 0.6125     |   9.5 |  0.70
Modify  | 15.192     | 21.947     | 30.299     | 142.8 | 31.08
Other   |            | 9.036      |            |       | 12.80

Nlocal:          12.75 ave          51 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1
Nghost:          39.25 ave          52 max           1 min
Histogram: 1 0 0 0 0 0 0 0 0 3
Neighs:           7.75 ave          31 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1

Total # of neighbors = 31
Ave neighs/atom = 0.60784314
Neighbor list builds = 166
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 37

#variable lat0 equal 1                    #
variable lat1 equal 3+(v_ind*0.01)  # .491+(v_ind*0.001)       # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 10*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 3.37                                                               
Lattice spacing in x,y,z = 3.37 3.37 3.37

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -50.55 ${n1e1} -100 100 -100 100 units box
region box block -50.55 50.55 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -50.55 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -50.55 50.55 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-50.55 -100 -100) to (50.55 100 100)
  1 by 2 by 2 MPI processor grid
create_atoms 1 region substrate
Created 29 atoms
  using lattice units in orthogonal box = (-50.55 -100 -100) to (50.55 100 100)
  create_atoms CPU = 0.000 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 30 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 21 atoms
  using lattice units in orthogonal box = (-50.55 -100 -100) to (50.55 100 100)
  create_atoms CPU = 0.003 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  29 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  29 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  21 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  21 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
29 atoms in group substrate
group slider1 region slider1
21 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 21 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 10000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 10000 Equi_37_*.dump id type diameter mass xu yu zu fx fy fz

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 66 130 130
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 14.02 | 17.49 | 18.64 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   101.1          200            200            0              0              0              0              0              0              0              2.6109412e-16  0              6            
    100000   101.1          200            200            0.0042400101   6.097232e-38   0              0.01272003     12363.353      0              6.6331344e+10  2.6109412e-16  0              3.3236777    
    200000   101.1          200            200            0.0015143701   1.8295459e-38  0              0.0045431103   3050.0441      0              1.6363968e+10  2.6109412e-16  0              3.0743888    
    300000   101.1          200            200            0.00012521042 -9.1437896e-39  0              0.00037563127  42.440334      0              2.2769909e+08  2.6109412e-16  0              3.0481989    
    400000   101.1          200            200            0.029210588   -0.0017726087   0              0.089404371    3.9029848      0              20940130       2.6109412e-16  0              2.9924423    
    500000   101.1          200            200           -4.3242871e-05  1.8302378e-38  0             -0.00012972861  10.174972      0              54590333       2.6109412e-16  0              2.9999154    
    600000   101.1          200            200            0.0050152466  -0.0006130189   0              0.015658759    5.7766633      0              30992711       2.6109412e-16  0              2.9975272    
    700000   101.1          200            200            0.0048133355  -0.00061214356  0              0.01505215     0.76447582     0              4101533.5      2.6109412e-16  0              2.9975791    
    800000   101.1          200            200            0.0049979749  -0.00061311043  0              0.015607035    0.10603329     0              568885.33      2.6109412e-16  0              2.9975211    
    900000   101.1          200            200            0.0050234108  -0.00061322936  0              0.015683462    0.013485334    0              72350.947      2.6109412e-16  0              2.9975124    
   1000000   101.1          200            200            0.0050106239  -0.00061318421  0              0.015645056    0.0015358284   0              8239.962       2.6109412e-16  0              2.9975158    
   1100000   101.1          200            200            0.0049978419  -0.00061313419  0              0.01560666     0.00015346635  0              823.37118      2.6109412e-16  0              2.9975194    
   1200000   101.1          200            200            0.0049904176  -0.00061310406  0              0.015584357    1.2826708e-05  0              68.817316      2.6109412e-16  0              2.9975216    
   1300000   101.1          200            200            0.0049868259  -0.00061308921  0              0.015573567    7.960206e-07   0              4.2707762      2.6109412e-16  0              2.9975226    
   1400000   101.1          200            200            0.0049852551  -0.00061308265  0              0.015568848    2.4094405e-08  0              0.12927029     2.6109412e-16  0              2.9975231    
   1500000   101.1          200            200            0.0049846147  -0.00061307996  0              0.015566924    8.8547951e-11  0              0.00047507374  2.6109412e-16  0              2.9975233    
   1600000   101.1          200            200            0.004984368   -0.00061307892  0              0.015566183    7.7016506e-10  0              0.0041320572   2.6109412e-16  0              2.9975234    
   1700000   101.1          200            200            0.0049842778  -0.00061307854  0              0.015565912    3.4700469e-10  0              0.001861735    2.6109412e-16  0              2.9975234    
   1800000   101.1          200            200            0.0049842464  -0.0006130784   0              0.015565818    9.2226101e-11  0              0.0004948076   2.6109412e-16  0              2.9975234    
   1900000   101.1          200            200            0.0049842361  -0.00061307836  0              0.015565787    1.9063744e-11  0              0.00010228     2.6109412e-16  0              2.9975234    
   2000000   101.1          200            200            0.004984233   -0.00061307835  0              0.015565777    3.3544818e-12  0              1.7997325e-05  2.6109412e-16  0              2.9975234    
   2100000   101.1          200            200            0.0049842322  -0.00061307834  0              0.015565775    5.2229555e-13  0              2.8021981e-06  2.6109412e-16  0              2.9975234    
   2200000   101.1          200            200            0.004984232   -0.00061307834  0              0.015565774    7.3131684e-14  0              3.9236303e-07  2.6109412e-16  0              2.9975234    
   2300000   101.1          200            200            0.004984232   -0.00061307834  0              0.015565774    9.2386863e-15  0              4.9567011e-08  2.6109412e-16  0              2.9975234    
   2400000   101.1          200            200            0.004984232   -0.00061307834  0              0.015565774    1.038357e-15   0              5.5709492e-09  2.6109412e-16  0              2.9975234    
   2500000   101.1          200            200            0.004984232   -0.00061307834  0              0.015565774    1.026522e-16   0              5.5074526e-10  2.6109412e-16  0              2.9975234    
   2600000   101.1          200            200            0.004984232   -0.00061307834  0              0.015565774    9.542936e-18   0              5.1199359e-11  2.6109412e-16  0              2.9975234    
   2700000   101.1          200            200            0.004984232   -0.00061307834  0              0.015565774    1.3512525e-18  0              7.2496828e-12  2.6109412e-16  0              2.9975234    
   2800000   101.1          200            200            0.004984232   -0.00061307834  0              0.015565774    3.6598378e-19  0              1.9635608e-12  2.6109412e-16  0              2.9975234    
   2900000   101.1          200            200            0.004984232   -0.00061307834  0              0.015565774    4.8598447e-22  0              2.6073834e-15  2.6109412e-16  0              2.9975234    
   3000000   101.1          200            200            0.004984232   -0.00061307834  0              0.015565774    5.7287726e-23  0              3.073577e-16   2.6109412e-16  0              2.9975234    
Loop time of 69.1882 on 4 procs for 3000000 steps with 50 atoms

Performance: 37463015.445 ns/day, 0.000 hours/ns, 43359.972 timesteps/s
99.8% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 0.21821    | 1.3227     | 4.4801     | 158.5 |  1.91
Neigh   | 0.077791   | 0.080609   | 0.084421   |   1.0 |  0.12
Comm    | 29.462     | 36.635     | 42.899     |  90.1 | 52.95
Output  | 0.45134    | 0.49045    | 0.60514    |   9.5 |  0.71
Modify  | 15.005     | 21.649     | 29.562     | 138.7 | 31.29
Other   |            | 9.011      |            |       | 13.02

Nlocal:           12.5 ave          50 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1
Nghost:           37.5 ave          50 max           0 min
Histogram: 1 0 0 0 0 0 0 0 0 3
Neighs:           8.25 ave          33 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1

Total # of neighbors = 33
Ave neighs/atom = 0.66
Neighbor list builds = 166
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 38

#variable lat0 equal 1                    #
variable lat1 equal 3+(v_ind*0.01)  # .491+(v_ind*0.001)       # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 10*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 3.38                                                               
Lattice spacing in x,y,z = 3.38 3.38 3.38

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -50.7 ${n1e1} -100 100 -100 100 units box
region box block -50.7 50.7 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -50.7 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -50.7 50.7 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-50.7 -100 -100) to (50.7 100 100)
  1 by 2 by 2 MPI processor grid
create_atoms 1 region substrate
Created 30 atoms
  using lattice units in orthogonal box = (-50.7 -100 -100) to (50.7 100 100)
  create_atoms CPU = 0.000 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 30 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 21 atoms
  using lattice units in orthogonal box = (-50.7 -100 -100) to (50.7 100 100)
  create_atoms CPU = 0.002 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  30 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  30 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  21 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  21 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
30 atoms in group substrate
group slider1 region slider1
21 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 21 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 10000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 10000 Equi_38_*.dump id type diameter mass xu yu zu fx fy fz

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 66 130 130
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 14.02 | 17.49 | 18.64 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   101.4          200            200            0              0              0              0              0              0              0              2.6109412e-16  0              6            
    100000   101.4          200            200            0.0042253854  -3.6441725e-38  0              0.012676156    12353.811      0              5.965213e+10   2.6109412e-16  0              3.324186     
    200000   101.4          200            200            0.00150381     3.6477389e-38  0              0.0045114299   3030.5628      0              1.4633503e+10  2.6109412e-16  0              3.0754556    
    300000   101.4          200            200            0.00012125791 -6.0777127e-39  0              0.00036377374  40.161217      0              1.9392414e+08  2.6109412e-16  0              3.0483008    
    400000   101.4          200            200            0.030111001    0.0017602106   0              0.088572791    7.2208841      0              34867065       2.6109412e-16  0              2.992476     
    500000   101.4          200            200           -3.5170165e-05  2.4338535e-37  0             -0.0001055105   11.071865      0              53462073       2.6109412e-16  0              2.9998729    
    600000   101.4          200            200            0.0053050138   0.00061251354  0              0.015302528    5.7734806      0              27878072       2.6109412e-16  0              2.997558     
    700000   101.4          200            200            0.0051693371   0.00061191133  0              0.0148961      0.75583093     0              3649637        2.6109412e-16  0              2.9975902    
    800000   101.4          200            200            0.0053772591   0.00061303867  0              0.015518739    0.1061378      0              512501.44      2.6109412e-16  0              2.9975252    
    900000   101.4          200            200            0.0054117299   0.000613197    0              0.015621993    0.013706041    0              66181.565      2.6109412e-16  0              2.9975139    
   1000000   101.4          200            200            0.0054022821   0.00061316492  0              0.015593681    0.0015880817   0              7668.2782      2.6109412e-16  0              2.9975163    
   1100000   101.4          200            200            0.0053906656   0.00061311957  0              0.015558877    0.00016214939  0              782.96136      2.6109412e-16  0              2.9975196    
   1200000   101.4          200            200            0.0053836248   0.00061309103  0              0.015537783    1.3985831e-05  0              67.532573      2.6109412e-16  0              2.9975216    
   1300000   101.4          200            200            0.0053801505   0.00061307668  0              0.015527375    9.1960247e-07  0              4.4404312      2.6109412e-16  0              2.9975227    
   1400000   101.4          200            200            0.005378612    0.00061307025  0              0.015522766    3.3005533e-08  0              0.15937191     2.6109412e-16  0              2.9975231    
   1500000   101.4          200            200            0.0053779789   0.0006130676   0              0.015520869    2.7562606e-13  0              1.3308996e-06  2.6109412e-16  0              2.9975233    
   1600000   101.4          200            200            0.0053777331   0.00061306656  0              0.015520133    5.8594997e-10  0              0.0028293427   2.6109412e-16  0              2.9975234    
   1700000   101.4          200            200            0.0053776425   0.00061306617  0              0.015519861    3.0380334e-10  0              0.0014669576   2.6109412e-16  0              2.9975234    
   1800000   101.4          200            200            0.0053776107   0.00061306604  0              0.015519766    8.50793e-11    0              0.00041081749  2.6109412e-16  0              2.9975234    
   1900000   101.4          200            200            0.0053776002   0.000613066    0              0.015519735    1.8114808e-11  0              8.7469924e-05  2.6109412e-16  0              2.9975234    
   2000000   101.4          200            200            0.005377597    0.00061306598  0              0.015519725    3.2546825e-12  0              1.5715697e-05  2.6109412e-16  0              2.9975234    
   2100000   101.4          200            200            0.0053775961   0.00061306598  0              0.015519722    5.1527654e-13  0              2.488086e-06   2.6109412e-16  0              2.9975234    
   2200000   101.4          200            200            0.0053775959   0.00061306598  0              0.015519722    7.3271766e-14  0              3.5380313e-07  2.6109412e-16  0              2.9975234    
   2300000   101.4          200            200            0.0053775959   0.00061306598  0              0.015519722    9.4026191e-15  0              4.5401882e-08  2.6109412e-16  0              2.9975234    
   2400000   101.4          200            200            0.0053775959   0.00061306598  0              0.015519722    1.0772448e-15  0              5.2016297e-09  2.6109412e-16  0              2.9975234    
   2500000   101.4          200            200            0.0053775959   0.00061306598  0              0.015519722    1.0874121e-16  0              5.2507239e-10  2.6109412e-16  0              2.9975234    
   2600000   101.4          200            200            0.0053775959   0.00061306598  0              0.015519722    1.0284935e-17  0              4.9662271e-11  2.6109412e-16  0              2.9975234    
   2700000   101.4          200            200            0.0053775959   0.00061306598  0              0.015519722    1.4459624e-18  0              6.9820351e-12  2.6109412e-16  0              2.9975234    
   2800000   101.4          200            200            0.0053775959   0.00061306598  0              0.015519722    3.3543675e-19  0              1.619704e-12   2.6109412e-16  0              2.9975234    
   2900000   101.4          200            200            0.0053775959   0.00061306598  0              0.015519722    5.3697767e-20  0              2.592873e-13   2.6109412e-16  0              2.9975234    
   3000000   101.4          200            200            0.0053775959   0.00061306598  0              0.015519722    9.7960139e-20  0              4.7301445e-13  2.6109412e-16  0              2.9975234    
Loop time of 70.712 on 4 procs for 3000000 steps with 51 atoms

Performance: 36655751.959 ns/day, 0.000 hours/ns, 42425.639 timesteps/s
99.8% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 0.2212     | 1.3373     | 4.5045     | 158.2 |  1.89
Neigh   | 0.077318   | 0.079285   | 0.082282   |   0.7 |  0.11
Comm    | 30.376     | 37.752     | 44.247     |  91.5 | 53.39
Output  | 0.45957    | 0.49914    | 0.61512    |   9.5 |  0.71
Modify  | 15.243     | 22.019     | 30.205     | 142.2 | 31.14
Other   |            | 9.025      |            |       | 12.76

Nlocal:          12.75 ave          51 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1
Nghost:          39.25 ave          52 max           1 min
Histogram: 1 0 0 0 0 0 0 0 0 3
Neighs:           8.25 ave          33 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1

Total # of neighbors = 33
Ave neighs/atom = 0.64705882
Neighbor list builds = 166
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 39

#variable lat0 equal 1                    #
variable lat1 equal 3+(v_ind*0.01)  # .491+(v_ind*0.001)       # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 10*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 3.39                                                               
Lattice spacing in x,y,z = 3.39 3.39 3.39

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -50.85 ${n1e1} -100 100 -100 100 units box
region box block -50.85 50.85 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -50.85 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -50.85 50.85 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-50.85 -100 -100) to (50.85 100 100)
  1 by 2 by 2 MPI processor grid
create_atoms 1 region substrate
Created 30 atoms
  using lattice units in orthogonal box = (-50.85 -100 -100) to (50.85 100 100)
  create_atoms CPU = 0.000 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 30 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 21 atoms
  using lattice units in orthogonal box = (-50.85 -100 -100) to (50.85 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  30 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  30 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  21 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  21 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
30 atoms in group substrate
group slider1 region slider1
21 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 21 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 10000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 10000 Equi_39_*.dump id type diameter mass xu yu zu fx fy fz

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 66 130 130
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 14.02 | 17.49 | 18.64 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   101.7          200            200            0              0              0              0              0              0              0              2.6109412e-16  0              6            
    100000   101.7          200            200            0.0042130439  -3.0299123e-39  0              0.012639132    12354.949      0              5.9657626e+10  2.6109412e-16  0              3.3239361    
    200000   101.7          200            200            0.0015225051   2.7808183e-42  0              0.0045675154   3106.1719      0              1.4998593e+10  2.6109412e-16  0              3.0703283    
    300000   101.7          200            200            0.00015820732  6.8175084e-39  0              0.00047462196  66.734998      0              3.2223942e+08  2.6109412e-16  0              3.0457529    
    400000   101.7          200            200            0.033636475    0.01329138     0              0.087618045    0.80969992     0              3909751.1      2.6109412e-16  0              2.9911173    
    500000   101.7          200            200            0.014713439    0.0054768343   0              0.038663482    8.6153369      0              41600379       2.6109412e-16  0              2.9942214    
    600000   101.7          200            200            0.0043727664   0.0012750081   0              0.011843291    4.4318517      0              21399826       2.6109412e-16  0              2.9966303    
    700000   101.7          200            200            0.0046097259   0.0013813654   0              0.012447812    0.018606344    0              89843.378      2.6109412e-16  0              2.996573     
    800000   101.7          200            200            0.0059065504   0.0016240837   0              0.016095567    0.069464314    0              335418.31      2.6109412e-16  0              2.9961735    
    900000   101.7          200            200            0.0057634926   0.0016125204   0              0.015677957    0.0098545777   0              47584.229      2.6109412e-16  0              2.9962151    
   1000000   101.7          200            200            0.0056370965   0.001600877    0              0.015310413    2.6892206e-06  0              12.985284      2.6109412e-16  0              2.9962545    
   1100000   101.7          200            200            0.0056997824   0.0016066387   0              0.015492708    0.00019505297  0              941.84096      2.6109412e-16  0              2.9962353    
   1200000   101.7          200            200            0.0056953581   0.0016062676   0              0.015479807    2.1040535e-05  0              101.59721      2.6109412e-16  0              2.9962366    
   1300000   101.7          200            200            0.0056883944   0.001605625    0              0.015459558    9.5735535e-08  0              0.46227264     2.6109412e-16  0              2.9962387    
   1400000   101.7          200            200            0.0056913929   0.0016058971   0              0.015468282    5.2886375e-07  0              2.5536938      2.6109412e-16  0              2.9962378    
   1500000   101.7          200            200            0.0056913023   0.0016058904   0              0.015468017    4.3535975e-08  0              0.21021964     2.6109412e-16  0              2.9962378    
   1600000   101.7          200            200            0.0056909278   0.0016058559   0              0.015466927    7.0365962e-10  0              0.0033977205   2.6109412e-16  0              2.9962379    
   1700000   101.7          200            200            0.0056910691   0.0016058687   0              0.015467338    1.3966905e-09  0              0.0067441188   2.6109412e-16  0              2.9962379    
   1800000   101.7          200            200            0.0056910711   0.001605869    0              0.015467344    8.6211638e-11  0              0.00041628515  2.6109412e-16  0              2.9962379    
   1900000   101.7          200            200            0.0056910513   0.0016058672   0              0.015467287    3.4540345e-12  0              1.6678296e-05  2.6109412e-16  0              2.9962379    
   2000000   101.7          200            200            0.0056910578   0.0016058678   0              0.015467306    3.5972332e-12  0              1.7369752e-05  2.6109412e-16  0              2.9962379    
   2100000   101.7          200            200            0.0056910582   0.0016058678   0              0.015467307    1.6151855e-13  0              7.7991525e-07  2.6109412e-16  0              2.9962379    
   2200000   101.7          200            200            0.0056910572   0.0016058677   0              0.015467304    1.3985288e-14  0              6.7529948e-08  2.6109412e-16  0              2.9962379    
   2300000   101.7          200            200            0.0056910575   0.0016058677   0              0.015467305    9.0484602e-15  0              4.3691776e-08  2.6109412e-16  0              2.9962379    
   2400000   101.7          200            200            0.0056910575   0.0016058677   0              0.015467305    2.8042757e-16  0              1.3540844e-09  2.6109412e-16  0              2.9962379    
   2500000   101.7          200            200            0.0056910575   0.0016058677   0              0.015467305    5.0169711e-17  0              2.4225158e-10  2.6109412e-16  0              2.9962379    
   2600000   101.7          200            200            0.0056910575   0.0016058677   0              0.015467305    2.2156144e-17  0              1.0698409e-10  2.6109412e-16  0              2.9962379    
   2700000   101.7          200            200            0.0056910575   0.0016058677   0              0.015467305    1.874952e-20   0              9.0534724e-14  2.6109412e-16  0              2.9962379    
   2800000   101.7          200            200            0.0056910575   0.0016058677   0              0.015467305    3.4239896e-19  0              1.653322e-12   2.6109412e-16  0              2.9962379    
   2900000   101.7          200            200            0.0056910575   0.0016058677   0              0.015467305    6.5659942e-20  0              3.1704836e-13  2.6109412e-16  0              2.9962379    
   3000000   101.7          200            200            0.0056910575   0.0016058677   0              0.015467305    6.8594215e-20  0              3.3121692e-13  2.6109412e-16  0              2.9962379    
Loop time of 70.8286 on 4 procs for 3000000 steps with 51 atoms

Performance: 36595384.164 ns/day, 0.000 hours/ns, 42355.769 timesteps/s
99.8% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 0.22406    | 1.3744     | 4.6428     | 161.0 |  1.94
Neigh   | 0.078058   | 0.080451   | 0.083902   |   0.8 |  0.11
Comm    | 30.271     | 37.776     | 44.366     |  92.4 | 53.33
Output  | 0.45978    | 0.50011    | 0.61834    |   9.7 |  0.71
Modify  | 15.259     | 22.012     | 30.324     | 142.6 | 31.08
Other   |            | 9.085      |            |       | 12.83

Nlocal:          12.75 ave          51 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1
Nghost:          39.25 ave          52 max           1 min
Histogram: 1 0 0 0 0 0 0 0 0 3
Neighs:           8.25 ave          33 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1

Total # of neighbors = 33
Ave neighs/atom = 0.64705882
Neighbor list builds = 166
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 40

#variable lat0 equal 1                    #
variable lat1 equal 3+(v_ind*0.01)  # .491+(v_ind*0.001)       # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 10*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 3.4                                                               
Lattice spacing in x,y,z = 3.4 3.4 3.4

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -51 ${n1e1} -100 100 -100 100 units box
region box block -51 51 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -51 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -51 51 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-51 -100 -100) to (51 100 100)
  1 by 2 by 2 MPI processor grid
create_atoms 1 region substrate
Created 30 atoms
  using lattice units in orthogonal box = (-51 -100 -100) to (51 100 100)
  create_atoms CPU = 0.000 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 30 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 21 atoms
  using lattice units in orthogonal box = (-51 -100 -100) to (51 100 100)
  create_atoms CPU = 0.002 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  30 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  30 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  21 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  21 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
30 atoms in group substrate
group slider1 region slider1
21 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 21 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 10000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 10000 Equi_40_*.dump id type diameter mass xu yu zu fx fy fz

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 66 130 130
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 14.02 | 17.49 | 18.64 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   102            200            200            0              0              0              0              0              0              0              2.6109412e-16  0              6            
    100000   102            200            200            0.00420106    -1.5103513e-39  0              0.01260318     12357.77       0              5.967125e+10   2.6109412e-16  0              3.3234748    
    200000   102            200            200            0.0015286602   9.6684272e-38  0              0.0045859806   3141.4718      0              1.5169043e+10  2.6109412e-16  0              3.0677265    
    300000   102            200            200            0.00020295428 -7.2461801e-38  0              0.00060886285  106.70056      0              5.152188e+08   2.6109412e-16  0              3.0428171    
    400000   102            200            200            0.021306726    0.00099537809  0              0.0629248      105.34634      0              5.0867979e+08  2.6109412e-16  0              2.9908533    
    500000   102            200            200            0.0020541539  -1.4209896e-37  0              0.0061624617   14.382882      0              69449792       2.6109412e-16  0              2.9974636    
    600000   102            200            200            0.0037171823  -3.3213393e-37  0              0.011151547    1.1625064      0              5613327.2      2.6109412e-16  0              2.9961583    
    700000   102            200            200            0.0045401819   2.2559543e-37  0              0.013620546    0.064137887    0              309698.9       2.6109412e-16  0              2.9955975    
    800000   102            200            200            0.0049066178   1.0805112e-36  0              0.014719853    0.0029701464   0              14341.774      2.6109412e-16  0              2.995361     
    900000   102            200            200            0.0050513781  -1.8306691e-38  0              0.015154134    3.839422e-05   0              185.39195      2.6109412e-16  0              2.9952696    
   1000000   102            200            200            0.0051066222  -1.1543399e-37  0              0.015319867    8.0242613e-06  0              38.746286      2.6109412e-16  0              2.995235     
   1100000   102            200            200            0.0051272182  -2.8546314e-41  0              0.015381654    8.418372e-06   0              40.649306      2.6109412e-16  0              2.9952222    
   1200000   102            200            200            0.0051347384  -1.7841044e-38  0              0.015404215    2.9939372e-06  0              14.456651      2.6109412e-16  0              2.9952175    
   1300000   102            200            200            0.0051374287   2.3067468e-39  0              0.015412286    7.5318274e-07  0              3.6368499      2.6109412e-16  0              2.9952159    
   1400000   102            200            200            0.0051383707   7.8495716e-39  0              0.015415112    1.5846603e-07  0              0.76517574     2.6109412e-16  0              2.9952153    
   1500000   102            200            200            0.0051386929  -2.9272017e-39  0              0.015416079    2.9775402e-08  0              0.14377476     2.6109412e-16  0              2.9952151    
   1600000   102            200            200            0.0051388001   1.4885461e-39  0              0.0154164      5.1605089e-09  0              0.024918251    2.6109412e-16  0              2.995215     
   1700000   102            200            200            0.0051388346  -4.6624067e-39  0              0.015416504    8.3995408e-10  0              0.0040558376   2.6109412e-16  0              2.995215     
   1800000   102            200            200            0.0051388453   1.2992197e-39  0              0.015416536    1.2978048e-10  0              0.00062666349  2.6109412e-16  0              2.995215     
   1900000   102            200            200            0.0051388483  -6.4841841e-40  0              0.015416545    1.9159368e-11  0              9.2513733e-05  2.6109412e-16  0              2.995215     
   2000000   102            200            200            0.0051388491  -1.4390293e-39  0              0.015416547    2.7127826e-12  0              1.3099056e-05  2.6109412e-16  0              2.995215     
   2100000   102            200            200            0.0051388493   2.3272665e-39  0              0.015416548    3.6917393e-13  0              1.7826088e-06  2.6109412e-16  0              2.995215     
   2200000   102            200            200            0.0051388493  -1.8096169e-39  0              0.015416548    4.8278933e-14  0              2.3312169e-07  2.6109412e-16  0              2.995215     
   2300000   102            200            200            0.0051388493  -6.2949706e-39  0              0.015416548    6.0521885e-15  0              2.9223852e-08  2.6109412e-16  0              2.995215     
   2400000   102            200            200            0.0051388493  -1.7532282e-40  0              0.015416548    7.2883061e-16  0              3.5192622e-09  2.6109412e-16  0              2.995215     
   2500000   102            200            200            0.0051388493   2.5792242e-39  0              0.015416548    8.3268157e-17  0              4.0207213e-10  2.6109412e-16  0              2.995215     
   2600000   102            200            200            0.0051388493   1.5935061e-39  0              0.015416548    8.6675562e-18  0              4.1852527e-11  2.6109412e-16  0              2.995215     
   2700000   102            200            200            0.0051388493   1.4017895e-39  0              0.015416548    8.0510158e-19  0              3.8875474e-12  2.6109412e-16  0              2.995215     
   2800000   102            200            200            0.0051388493   4.2727325e-39  0              0.015416548    2.6180225e-20  0              1.2641493e-13  2.6109412e-16  0              2.995215     
   2900000   102            200            200            0.0051388493  -4.1406625e-39  0              0.015416548    9.3299815e-20  0              4.5051141e-13  2.6109412e-16  0              2.995215     
   3000000   102            200            200            0.0051388493  -4.2183164e-40  0              0.015416548    1.9485438e-20  0              9.4088205e-14  2.6109412e-16  0              2.995215     
Loop time of 70.7543 on 4 procs for 3000000 steps with 51 atoms

Performance: 36633825.196 ns/day, 0.000 hours/ns, 42400.261 timesteps/s
99.8% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 0.22264    | 1.2834     | 4.3086     | 154.2 |  1.81
Neigh   | 0.075882   | 0.07765    | 0.080483   |   0.7 |  0.11
Comm    | 30.442     | 37.908     | 44.377     |  92.3 | 53.58
Output  | 0.44511    | 0.48465    | 0.60054    |   9.6 |  0.68
Modify  | 15.152     | 21.932     | 30.164     | 143.0 | 31.00
Other   |            | 9.068      |            |       | 12.82

Nlocal:          12.75 ave          51 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1
Nghost:          39.25 ave          52 max           1 min
Histogram: 1 0 0 0 0 0 0 0 0 3
Neighs:           7.75 ave          31 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1

Total # of neighbors = 31
Ave neighs/atom = 0.60784314
Neighbor list builds = 164
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 41

#variable lat0 equal 1                    #
variable lat1 equal 3+(v_ind*0.01)  # .491+(v_ind*0.001)       # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 10*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 3.41                                                               
Lattice spacing in x,y,z = 3.41 3.41 3.41

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -51.15 ${n1e1} -100 100 -100 100 units box
region box block -51.15 51.15 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -51.15 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -51.15 51.15 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-51.15 -100 -100) to (51.15 100 100)
  1 by 2 by 2 MPI processor grid
create_atoms 1 region substrate
Created 29 atoms
  using lattice units in orthogonal box = (-51.15 -100 -100) to (51.15 100 100)
  create_atoms CPU = 0.000 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 30 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 21 atoms
  using lattice units in orthogonal box = (-51.15 -100 -100) to (51.15 100 100)
  create_atoms CPU = 0.004 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  29 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  29 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  21 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  21 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
29 atoms in group substrate
group slider1 region slider1
21 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 21 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 10000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 10000 Equi_41_*.dump id type diameter mass xu yu zu fx fy fz

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 66 130 130
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 14.07 | 17.54 | 18.7 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   102.3          200            200            0              0              0              0              0              0              0              2.6109412e-16  0              6            
    100000   102.3          200            200            0.0041858104   6.0247103e-39  0              0.012557431    12343.886      0              6.6226895e+10  2.6109412e-16  0              3.3243229    
    200000   102.3          200            200            0.0015085572  -3.0115305e-39  0              0.0045256717   3090.203       0              1.6579427e+10  2.6109412e-16  0              3.0708687    
    300000   102.3          200            200            0.00014911913  3.0126138e-38  0              0.00044735738  60.398725      0              3.2404869e+08  2.6109412e-16  0              3.0457712    
    400000   102.3          200            200            0.024511559   -0.01217359     0              0.085708268    6.00291        0              32206560       2.6109412e-16  0              2.9909439    
    500000   102.3          200            200            0.0098788898  -0.0036107664   0              0.033247436    19.118507      0              1.0257381e+08  2.6109412e-16  0              2.9944039    
    600000   102.3          200            200            0.0035776807  -0.00040950522  0              0.011142547    3.8085836      0              20433652       2.6109412e-16  0              2.9965304    
    700000   102.3          200            200            0.0038855247  -0.0009394117   0              0.012595986    0.086262268    0              462810.69      2.6109412e-16  0              2.9963364    
    800000   102.3          200            200            0.0043866256  -0.0011857486   0              0.014345625    0.013246237    0              71068.151      2.6109412e-16  0              2.9961307    
    900000   102.3          200            200            0.004601781   -0.0012083912   0              0.015013734    0.0028940212   0              15526.88       2.6109412e-16  0              2.9960557    
   1000000   102.3          200            200            0.0046787533  -0.0012157308   0              0.015251991    0.00058144205  0              3119.5284      2.6109412e-16  0              2.9960293    
   1100000   102.3          200            200            0.0047053939  -0.0012181882   0              0.01533437     0.00010690199  0              573.54605      2.6109412e-16  0              2.9960202    
   1200000   102.3          200            200            0.004714387   -0.00121901     0              0.015362171    1.8368176e-05  0              98.548163      2.6109412e-16  0              2.9960171    
   1300000   102.3          200            200            0.0047173442  -0.0012192801   0              0.015371313    2.9928603e-06  0              16.057168      2.6109412e-16  0              2.9960161    
   1400000   102.3          200            200            0.0047182861  -0.0012193664   0              0.015374225    4.6671878e-07  0              2.5040199      2.6109412e-16  0              2.9960157    
   1500000   102.3          200            200            0.0047185736  -0.0012193929   0              0.015375114    7.0071774e-08  0              0.37594613     2.6109412e-16  0              2.9960156    
   1600000   102.3          200            200            0.0047186561  -0.0012194006   0              0.015375369    1.0167196e-08  0              0.05454861     2.6109412e-16  0              2.9960156    
   1700000   102.3          200            200            0.0047186775  -0.0012194026   0              0.015375435    1.4290153e-09  0              0.0076668925   2.6109412e-16  0              2.9960156    
   1800000   102.3          200            200            0.0047186819  -0.001219403    0              0.015375449    1.9479452e-10  0              0.0010451034   2.6109412e-16  0              2.9960156    
   1900000   102.3          200            200            0.0047186822  -0.0012194031   0              0.01537545     2.5758266e-11  0              0.00013819716  2.6109412e-16  0              2.9960156    
   2000000   102.3          200            200            0.0047186819  -0.001219403    0              0.015375449    3.3015843e-12  0              1.7713521e-05  2.6109412e-16  0              2.9960156    
   2100000   102.3          200            200            0.0047186815  -0.001219403    0              0.015375448    4.094877e-13   0              2.1969662e-06  2.6109412e-16  0              2.9960156    
   2200000   102.3          200            200            0.0047186814  -0.001219403    0              0.015375447    4.9023969e-14  0              2.6302134e-07  2.6109412e-16  0              2.9960156    
   2300000   102.3          200            200            0.0047186813  -0.001219403    0              0.015375447    5.6343643e-15  0              3.0229254e-08  2.6109412e-16  0              2.9960156    
   2400000   102.3          200            200            0.0047186813  -0.001219403    0              0.015375447    6.2089996e-16  0              3.3312263e-09  2.6109412e-16  0              2.9960156    
   2500000   102.3          200            200            0.0047186812  -0.001219403    0              0.015375447    6.6397685e-17  0              3.5623407e-10  2.6109412e-16  0              2.9960156    
   2600000   102.3          200            200            0.0047186812  -0.001219403    0              0.015375447    6.2381828e-18  0              3.3468836e-11  2.6109412e-16  0              2.9960156    
   2700000   102.3          200            200            0.0047186812  -0.001219403    0              0.015375447    1.3546033e-18  0              7.2676606e-12  2.6109412e-16  0              2.9960156    
   2800000   102.3          200            200            0.0047186812  -0.001219403    0              0.015375447    3.3090661e-19  0              1.7753662e-12  2.6109412e-16  0              2.9960156    
   2900000   102.3          200            200            0.0047186812  -0.001219403    0              0.015375447    3.2456105e-20  0              1.7413213e-13  2.6109412e-16  0              2.9960156    
   3000000   102.3          200            200            0.0047186812  -0.001219403    0              0.015375447    1.1996983e-19  0              6.4365706e-13  2.6109412e-16  0              2.9960156    
Loop time of 69.4367 on 4 procs for 3000000 steps with 50 atoms

Performance: 37328974.609 ns/day, 0.000 hours/ns, 43204.832 timesteps/s
99.8% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 0.22074    | 1.3076     | 4.4167     | 157.0 |  1.88
Neigh   | 0.078005   | 0.080262   | 0.083577   |   0.8 |  0.12
Comm    | 29.693     | 36.891     | 43.19      |  89.9 | 53.13
Output  | 0.44052    | 0.48052    | 0.59768    |   9.8 |  0.69
Modify  | 15.036     | 21.68      | 29.634     | 139.2 | 31.22
Other   |            | 8.997      |            |       | 12.96

Nlocal:           12.5 ave          50 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1
Nghost:           37.5 ave          50 max           0 min
Histogram: 1 0 0 0 0 0 0 0 0 3
Neighs:           7.75 ave          31 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1

Total # of neighbors = 31
Ave neighs/atom = 0.62
Neighbor list builds = 166
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 42

#variable lat0 equal 1                    #
variable lat1 equal 3+(v_ind*0.01)  # .491+(v_ind*0.001)       # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 10*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 3.42                                                               
Lattice spacing in x,y,z = 3.42 3.42 3.42

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -51.3 ${n1e1} -100 100 -100 100 units box
region box block -51.3 51.3 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -51.3 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -51.3 51.3 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-51.3 -100 -100) to (51.3 100 100)
  1 by 2 by 2 MPI processor grid
create_atoms 1 region substrate
Created 30 atoms
  using lattice units in orthogonal box = (-51.3 -100 -100) to (51.3 100 100)
  create_atoms CPU = 0.000 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 30 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 21 atoms
  using lattice units in orthogonal box = (-51.3 -100 -100) to (51.3 100 100)
  create_atoms CPU = 0.002 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  30 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  30 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  21 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  21 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
30 atoms in group substrate
group slider1 region slider1
21 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 21 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 10000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 10000 Equi_42_*.dump id type diameter mass xu yu zu fx fy fz

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 67 130 130
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 14.04 | 17.51 | 18.66 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   102.6          200            200            0              0              0              0              0              0              0              2.6109412e-16  0              6            
    100000   102.6          200            200            0.0041681273  -1.2010817e-38  0              0.012504382    12317.107      0              5.9474901e+10  2.6109412e-16  0              3.3262563    
    200000   102.6          200            200            0.0014720839  -3.002861e-39   0              0.0044162518   2985.0966      0              1.4413963e+10  2.6109412e-16  0              3.0777402    
    300000   102.6          200            200            0.00011296999  1.5017403e-39  0              0.00033890997  35.905977      0              1.7337711e+08  2.6109412e-16  0              3.0482543    
    400000   102.6          200            200            0.027277746   -0.0044190705   0              0.086252307    13.911335      0              67172860       2.6109412e-16  0              2.9923305    
    500000   102.6          200            200            0.00010867601  1.6811103e-37  0              0.00032602802  14.298047      0              69040151       2.6109412e-16  0              2.9994996    
    600000   102.6          200            200            0.0034859802  -0.00095024598  0              0.011408187    4.553944       0              21989366       2.6109412e-16  0              2.9977345    
    700000   102.6          200            200            0.0039343729  -0.0010784513   0              0.01288157     0.33972764     0              1640423.2      2.6109412e-16  0              2.9975649    
    800000   102.6          200            200            0.004430988   -0.0010996788   0              0.014392643    0.042144861    0              203502.45      2.6109412e-16  0              2.9974048    
    900000   102.6          200            200            0.0046276302  -0.0011068171   0              0.014989708    0.0057821727   0              27920.043      2.6109412e-16  0              2.9973432    
   1000000   102.6          200            200            0.0047002996  -0.0011092931   0              0.015210192    0.00080159507  0              3870.6157      2.6109412e-16  0              2.9973207    
   1100000   102.6          200            200            0.0047268741  -0.0011101777   0              0.0152908      0.00011109362  0              536.43132      2.6109412e-16  0              2.9973125    
   1200000   102.6          200            200            0.0047365726  -0.0011104979   0              0.015320216    1.5382623e-05  0              74.277183      2.6109412e-16  0              2.9973095    
   1300000   102.6          200            200            0.0047401102  -0.0011106143   0              0.015330945    2.12852e-06    0              10.277861      2.6109412e-16  0              2.9973084    
   1400000   102.6          200            200            0.0047414001  -0.0011106567   0              0.015334857    2.9437114e-07  0              1.4214129      2.6109412e-16  0              2.997308     
   1500000   102.6          200            200            0.0047418704  -0.0011106722   0              0.015336283    4.0692308e-08  0              0.19648859     2.6109412e-16  0              2.9973079    
   1600000   102.6          200            200            0.0047420418  -0.0011106778   0              0.015336803    5.6226739e-09  0              0.02714988     2.6109412e-16  0              2.9973078    
   1700000   102.6          200            200            0.0047421043  -0.0011106799   0              0.015336993    7.7659074e-10  0              0.0037498787   2.6109412e-16  0              2.9973078    
   1800000   102.6          200            200            0.0047421271  -0.0011106806   0              0.015337062    1.0721638e-10  0              0.00051770954  2.6109412e-16  0              2.9973078    
   1900000   102.6          200            200            0.0047421354  -0.0011106809   0              0.015337087    1.479686e-11   0              7.1448743e-05  2.6109412e-16  0              2.9973078    
   2000000   102.6          200            200            0.0047421384  -0.001110681    0              0.015337096    2.041144e-12   0              9.855954e-06   2.6109412e-16  0              2.9973078    
   2100000   102.6          200            200            0.0047421395  -0.001110681    0              0.015337099    2.813655e-13   0              1.3586133e-06  2.6109412e-16  0              2.9973078    
   2200000   102.6          200            200            0.0047421399  -0.001110681    0              0.015337101    3.8793021e-14  0              1.8731761e-07  2.6109412e-16  0              2.9973078    
   2300000   102.6          200            200            0.00474214    -0.001110681    0              0.015337101    5.3530034e-15  0              2.5847738e-08  2.6109412e-16  0              2.9973078    
   2400000   102.6          200            200            0.0047421401  -0.001110681    0              0.015337101    7.3612509e-16  0              3.5544846e-09  2.6109412e-16  0              2.9973078    
   2500000   102.6          200            200            0.0047421401  -0.001110681    0              0.015337101    1.0279628e-16  0              4.9636644e-10  2.6109412e-16  0              2.9973078    
   2600000   102.6          200            200            0.0047421401  -0.001110681    0              0.015337101    1.3633023e-17  0              6.5828989e-11  2.6109412e-16  0              2.9973078    
   2700000   102.6          200            200            0.0047421401  -0.001110681    0              0.015337101    1.0375225e-18  0              5.0098247e-12  2.6109412e-16  0              2.9973078    
   2800000   102.6          200            200            0.0047421401  -0.0011106811   0              0.015337101    2.4827359e-19  0              1.1988243e-12  2.6109412e-16  0              2.9973078    
   2900000   102.6          200            200            0.0047421401  -0.001110681    0              0.015337101    1.5410289e-19  0              7.4410771e-13  2.6109412e-16  0              2.9973078    
   3000000   102.6          200            200            0.0047421401  -0.0011106811   0              0.015337101    6.4114424e-20  0              3.0958561e-13  2.6109412e-16  0              2.9973078    
Loop time of 70.8493 on 4 procs for 3000000 steps with 51 atoms

Performance: 36584691.779 ns/day, 0.000 hours/ns, 42343.393 timesteps/s
99.8% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 0.21755    | 1.3349     | 4.5058     | 158.5 |  1.88
Neigh   | 0.077386   | 0.079885   | 0.083402   |   0.9 |  0.11
Comm    | 30.501     | 37.914     | 44.332     |  91.4 | 53.51
Output  | 0.44845    | 0.48815    | 0.6045     |   9.6 |  0.69
Modify  | 15.211     | 21.972     | 30.211     | 142.5 | 31.01
Other   |            | 9.061      |            |       | 12.79

Nlocal:          12.75 ave          51 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1
Nghost:          39.25 ave          52 max           1 min
Histogram: 1 0 0 0 0 0 0 0 0 3
Neighs:           7.75 ave          31 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1

Total # of neighbors = 31
Ave neighs/atom = 0.60784314
Neighbor list builds = 166
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 43

#variable lat0 equal 1                    #
variable lat1 equal 3+(v_ind*0.01)  # .491+(v_ind*0.001)       # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 10*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 3.43                                                               
Lattice spacing in x,y,z = 3.43 3.43 3.43

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -51.45 ${n1e1} -100 100 -100 100 units box
region box block -51.45 51.45 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -51.45 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -51.45 51.45 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-51.45 -100 -100) to (51.45 100 100)
  1 by 2 by 2 MPI processor grid
create_atoms 1 region substrate
Created 30 atoms
  using lattice units in orthogonal box = (-51.45 -100 -100) to (51.45 100 100)
  create_atoms CPU = 0.000 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 30 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 21 atoms
  using lattice units in orthogonal box = (-51.45 -100 -100) to (51.45 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  30 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  30 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  21 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  21 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
30 atoms in group substrate
group slider1 region slider1
21 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 21 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 10000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 10000 Equi_43_*.dump id type diameter mass xu yu zu fx fy fz

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 67 130 130
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 14.04 | 17.51 | 18.66 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   102.9          200            200            0              0              0              0              0              0              0              2.6109412e-16  0              6            
    100000   102.9          200            200            0.004152619    2.1575059e-37  0              0.012457857    12300.664      0              5.9395506e+10  2.6109412e-16  0              3.327411     
    200000   102.9          200            200            0.0014559375  -4.1920239e-38  0              0.0043678124   2946.3624      0              1.4226929e+10  2.6109412e-16  0              3.0803421    
    300000   102.9          200            200            0.00010413682 -3.7429919e-40  0              0.00031241045  30.911083      0              1.4925856e+08  2.6109412e-16  0              3.0489012    
    400000   102.9          200            200            0.027152416   -0.00034038276  0              0.081797632    38.22149       0              1.845579e+08   2.6109412e-16  0              2.9929661    
    500000   102.9          200            200            7.0724893e-05 -1.7577955e-06  0              0.00021393248  16.548769      0              79908081       2.6109412e-16  0              2.9997795    
    600000   102.9          200            200            0.00468676    -5.8274332e-05  0              0.014118554    5.7051765      0              27548256       2.6109412e-16  0              2.9978213    
    700000   102.9          200            200            0.004815143   -6.0254847e-05  0              0.014505684    0.74288287     0              3587115.5      2.6109412e-16  0              2.997773     
    800000   102.9          200            200            0.0050768026  -6.3672632e-05  0              0.015294081    0.1067737      0              515571.98      2.6109412e-16  0              2.9976903    
    900000   102.9          200            200            0.0051184065  -6.4245311e-05  0              0.015419465    0.013424046    0              64819.916      2.6109412e-16  0              2.9976766    
   1000000   102.9          200            200            0.0051064071  -6.4112528e-05  0              0.015383334    0.0014220989   0              6866.8066      2.6109412e-16  0              2.9976798    
   1100000   102.9          200            200            0.0050921205  -6.3938988e-05  0              0.0153403      0.00012085904  0              583.58505      2.6109412e-16  0              2.997684     
   1200000   102.9          200            200            0.0050836528  -6.3834382e-05  0              0.015314793    7.1501743e-06  0              34.525633      2.6109412e-16  0              2.9976865    
   1300000   102.9          200            200            0.0050795994  -6.3783911e-05  0              0.015302582    1.6321176e-07  0              0.78809118     2.6109412e-16  0              2.9976877    
   1400000   102.9          200            200            0.0050778785  -6.376237e-05   0              0.015297398    5.7821255e-09  0              0.027919815    2.6109412e-16  0              2.9976882    
   1500000   102.9          200            200            0.0050772097  -6.3753962e-05  0              0.015295383    1.1761122e-08  0              0.056790247    2.6109412e-16  0              2.9976884    
   1600000   102.9          200            200            0.0050769695  -6.375093e-05   0              0.015294659    4.4115039e-09  0              0.021301574    2.6109412e-16  0              2.9976885    
   1700000   102.9          200            200            0.0050768901  -6.3749923e-05  0              0.01529442     1.04364e-09    0              0.0050393641   2.6109412e-16  0              2.9976885    
   1800000   102.9          200            200            0.0050768664  -6.3749621e-05  0              0.015294349    1.9218425e-10  0              0.00092798895  2.6109412e-16  0              2.9976885    
   1900000   102.9          200            200            0.0050768604  -6.3749544e-05  0              0.015294331    2.9532152e-11  0              0.00014260019  2.6109412e-16  0              2.9976885    
   2000000   102.9          200            200            0.0050768594  -6.374953e-05   0              0.015294328    3.8730247e-12  0              1.870145e-05   2.6109412e-16  0              2.9976885    
   2100000   102.9          200            200            0.0050768594  -6.3749531e-05  0              0.015294328    4.313935e-13   0              2.0830448e-06  2.6109412e-16  0              2.9976885    
   2200000   102.9          200            200            0.0050768596  -6.3749533e-05  0              0.015294328    3.9311767e-14  0              1.8982245e-07  2.6109412e-16  0              2.9976885    
   2300000   102.9          200            200            0.0050768598  -6.3749535e-05  0              0.015294329    2.6305118e-15  0              1.27018e-08    2.6109412e-16  0              2.9976885    
   2400000   102.9          200            200            0.0050768598  -6.3749535e-05  0              0.015294329    9.1091437e-17  0              4.3984795e-10  2.6109412e-16  0              2.9976885    
   2500000   102.9          200            200            0.0050768599  -6.3749536e-05  0              0.015294329    9.3846759e-20  0              4.5315241e-13  2.6109412e-16  0              2.9976885    
   2600000   102.9          200            200            0.0050768599  -6.3749536e-05  0              0.015294329    1.9191762e-18  0              9.2670151e-12  2.6109412e-16  0              2.9976885    
   2700000   102.9          200            200            0.0050768599  -6.3749536e-05  0              0.015294329    4.447516e-19   0              2.1475463e-12  2.6109412e-16  0              2.9976885    
   2800000   102.9          200            200            0.0050768599  -6.3749536e-05  0              0.015294329    2.4501837e-19  0              1.183106e-12   2.6109412e-16  0              2.9976885    
   2900000   102.9          200            200            0.0050768599  -6.3749536e-05  0              0.015294329    8.20092e-20    0              3.9599308e-13  2.6109412e-16  0              2.9976885    
   3000000   102.9          200            200            0.0050768599  -6.3749536e-05  0              0.015294329    1.0614052e-20  0              5.1251456e-14  2.6109412e-16  0              2.9976885    
Loop time of 70.7462 on 4 procs for 3000000 steps with 51 atoms

Performance: 36638005.071 ns/day, 0.000 hours/ns, 42405.098 timesteps/s
99.8% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 0.21976    | 1.2921     | 4.3316     | 154.4 |  1.83
Neigh   | 0.076469   | 0.078603   | 0.08176    |   0.8 |  0.11
Comm    | 30.459     | 37.889     | 44.278     |  91.9 | 53.56
Output  | 0.44999    | 0.49015    | 0.60789    |   9.7 |  0.69
Modify  | 15.182     | 21.938     | 30.139     | 142.5 | 31.01
Other   |            | 9.059      |            |       | 12.80

Nlocal:          12.75 ave          51 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1
Nghost:          39.25 ave          52 max           1 min
Histogram: 1 0 0 0 0 0 0 0 0 3
Neighs:           7.25 ave          29 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1

Total # of neighbors = 29
Ave neighs/atom = 0.56862745
Neighbor list builds = 166
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 44

#variable lat0 equal 1                    #
variable lat1 equal 3+(v_ind*0.01)  # .491+(v_ind*0.001)       # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 10*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 3.44                                                               
Lattice spacing in x,y,z = 3.44 3.44 3.44

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -51.6 ${n1e1} -100 100 -100 100 units box
region box block -51.6 51.6 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -51.6 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -51.6 51.6 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-51.6 -100 -100) to (51.6 100 100)
  1 by 2 by 2 MPI processor grid
create_atoms 1 region substrate
Created 30 atoms
  using lattice units in orthogonal box = (-51.6 -100 -100) to (51.6 100 100)
  create_atoms CPU = 0.000 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 30 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 21 atoms
  using lattice units in orthogonal box = (-51.6 -100 -100) to (51.6 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  30 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  30 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  21 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  21 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
30 atoms in group substrate
group slider1 region slider1
21 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 21 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 10000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 10000 Equi_44_*.dump id type diameter mass xu yu zu fx fy fz

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 67 130 130
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 14.04 | 17.51 | 18.66 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   103.2          200            200            0              0              0              0              0              0              0              2.6109412e-16  0              6            
    100000   103.2          200            200            0.0041414977  -1.4929212e-38  0              0.012424493    12306.198      0              5.9422227e+10  2.6109412e-16  0              3.3267502    
    200000   103.2          200            200            0.0014619221  -2.9858719e-39  0              0.0043857662   2980.2367      0              1.4390496e+10  2.6109412e-16  0              3.0776805    
    300000   103.2          200            200            0.00011231545  1.1197379e-39  0              0.00033694636  35.91422       0              1.7341691e+08  2.6109412e-16  0              3.0479309    
    400000   103.2          200            200            0.030854996    0.0070837741   0              0.085481215    13.954071      0              67379217       2.6109412e-16  0              2.9920391    
    500000   103.2          200            200            0.00067776203  6.1183276e-05  0              0.0019721028   22.744907      0              1.0982702e+08  2.6109412e-16  0              2.9987625    
    600000   103.2          200            200            0.0026067025   0.00081759784  0              0.0070025097   0.00149266     0              7207.5209      2.6109412e-16  0              2.9979647    
    700000   103.2          200            200            0.004986623    0.0014231396   0              0.013536729    0.55690423     0              2689091.2      2.6109412e-16  0              2.9971884    
    800000   103.2          200            200            0.005604283    0.001459212    0              0.015353637    0.10233174     0              494123.33      2.6109412e-16  0              2.9970023    
    900000   103.2          200            200            0.0056622045   0.0014619852   0              0.015524628    0.0084740315   0              40918.065      2.6109412e-16  0              2.9969861    
   1000000   103.2          200            200            0.0056206053   0.0014597693   0              0.015402047    0.00018834651  0              909.45789      2.6109412e-16  0              2.996999     
   1100000   103.2          200            200            0.0055877167   0.0014580324   0              0.015305118    1.5386961e-05  0              74.298129      2.6109412e-16  0              2.9970089    
   1200000   103.2          200            200            0.0055730109   0.0014572555   0              0.015261777    1.8370204e-05  0              88.703139      2.6109412e-16  0              2.9970133    
   1300000   103.2          200            200            0.0055683416   0.00145701     0              0.015248015    4.5239742e-06  0              21.844652      2.6109412e-16  0              2.9970147    
   1400000   103.2          200            200            0.0055674352   0.0014569633   0              0.015245342    5.4616886e-07  0              2.637254       2.6109412e-16  0              2.997015     
   1500000   103.2          200            200            0.0055675049   0.0014569675   0              0.015245547    2.906257e-08   0              0.14033275     2.6109412e-16  0              2.997015     
   1600000   103.2          200            200            0.0055676708   0.0014569765   0              0.015246036    3.2630026e-11  0              0.00015755872  2.6109412e-16  0              2.9970149    
   1700000   103.2          200            200            0.0055677642   0.0014569815   0              0.015246311    3.8127016e-10  0              0.0018410172   2.6109412e-16  0              2.9970149    
   1800000   103.2          200            200            0.0055677997   0.0014569834   0              0.015246416    1.6593193e-10  0              0.0008012259   2.6109412e-16  0              2.9970149    
   1900000   103.2          200            200            0.0055678091   0.0014569838   0              0.015246443    2.8576853e-11  0              0.0001379874   2.6109412e-16  0              2.9970149    
   2000000   103.2          200            200            0.0055678101   0.0014569839   0              0.015246446    2.4705783e-12  0              1.1929538e-05  2.6109412e-16  0              2.9970149    
   2100000   103.2          200            200            0.0055678095   0.0014569839   0              0.015246444    6.3145957e-14  0              3.0490923e-07  2.6109412e-16  0              2.9970149    
   2200000   103.2          200            200            0.0055678089   0.0014569838   0              0.015246443    3.2240108e-15  0              1.5567594e-08  2.6109412e-16  0              2.9970149    
   2300000   103.2          200            200            0.0055678087   0.0014569838   0              0.015246442    4.8081937e-15  0              2.3217046e-08  2.6109412e-16  0              2.9970149    
   2400000   103.2          200            200            0.0055678086   0.0014569838   0              0.015246442    1.2432785e-15  0              6.0033467e-09  2.6109412e-16  0              2.9970149    
   2500000   103.2          200            200            0.0055678086   0.0014569838   0              0.015246442    1.5506628e-16  0              7.4875959e-10  2.6109412e-16  0              2.9970149    
   2600000   103.2          200            200            0.0055678086   0.0014569838   0              0.015246442    7.9690493e-18  0              3.8479687e-11  2.6109412e-16  0              2.9970149    
   2700000   103.2          200            200            0.0055678086   0.0014569838   0              0.015246442    1.375637e-19   0              6.6424588e-13  2.6109412e-16  0              2.9970149    
   2800000   103.2          200            200            0.0055678086   0.0014569838   0              0.015246442    3.0900523e-19  0              1.4920757e-12  2.6109412e-16  0              2.9970149    
   2900000   103.2          200            200            0.0055678086   0.0014569838   0              0.015246442    1.3808191e-19  0              6.6674814e-13  2.6109412e-16  0              2.9970149    
   3000000   103.2          200            200            0.0055678086   0.0014569838   0              0.015246442    7.4468893e-20  0              3.5958363e-13  2.6109412e-16  0              2.9970149    
Loop time of 70.988 on 4 procs for 3000000 steps with 51 atoms

Performance: 36513191.726 ns/day, 0.000 hours/ns, 42260.639 timesteps/s
99.8% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 0.22377    | 1.296      | 4.3432     | 154.6 |  1.83
Neigh   | 0.078468   | 0.080504   | 0.083683   |   0.7 |  0.11
Comm    | 30.502     | 37.997     | 44.468     |  92.6 | 53.53
Output  | 0.44705    | 0.48769    | 0.60691    |   9.9 |  0.69
Modify  | 15.315     | 22.065     | 30.288     | 142.2 | 31.08
Other   |            | 9.063      |            |       | 12.77

Nlocal:          12.75 ave          51 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1
Nghost:          39.25 ave          52 max           1 min
Histogram: 1 0 0 0 0 0 0 0 0 3
Neighs:           7.25 ave          29 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1

Total # of neighbors = 29
Ave neighs/atom = 0.56862745
Neighbor list builds = 166
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 45

#variable lat0 equal 1                    #
variable lat1 equal 3+(v_ind*0.01)  # .491+(v_ind*0.001)       # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 10*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 3.45                                                               
Lattice spacing in x,y,z = 3.45 3.45 3.45

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -51.75 ${n1e1} -100 100 -100 100 units box
region box block -51.75 51.75 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -51.75 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -51.75 51.75 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-51.75 -100 -100) to (51.75 100 100)
  1 by 2 by 2 MPI processor grid
create_atoms 1 region substrate
Created 30 atoms
  using lattice units in orthogonal box = (-51.75 -100 -100) to (51.75 100 100)
  create_atoms CPU = 0.000 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 30 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 21 atoms
  using lattice units in orthogonal box = (-51.75 -100 -100) to (51.75 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  30 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  30 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  21 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  21 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
30 atoms in group substrate
group slider1 region slider1
21 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 21 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 10000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 10000 Equi_45_*.dump id type diameter mass xu yu zu fx fy fz

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 67 130 130
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 14.04 | 17.51 | 18.66 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   103.5          200            200            0              0              0              0              0              0              0              2.6109412e-16  0              6            
    100000   103.5          200            200            0.0041322616  -1.1164533e-39  0              0.012396785    12321.536      0              5.9496286e+10  2.6109412e-16  0              3.3251408    
    200000   103.5          200            200            0.0014818048   2.3819107e-38  0              0.0044454145   3060.5252      0              1.4778181e+10  2.6109412e-16  0              3.0717994    
    300000   103.5          200            200            0.00013194189  1.786904e-38   0              0.00039582568  49.047837      0              2.3683445e+08  2.6109412e-16  0              3.0457249    
    400000   103.5          200            200            0.02519519     0.0096022003   0              0.065983369    92.859689      0              4.483862e+08   2.6109412e-16  0              2.9915259    
    500000   103.5          200            200            0.00063477611  1.3702171e-35  0              0.0019043283   0.15308955     0              739214.64      2.6109412e-16  0              2.9987939    
    600000   103.5          200            200            0.0067722084   0.0011162037   0              0.019200422    3.8437496      0              18560091       2.6109412e-16  0              2.995122     
    700000   103.5          200            200            0.0042997138   0.00028413197  0              0.012615009    0.060222752    0              290794.12      2.6109412e-16  0              2.9959026    
    800000   103.5          200            200            0.0050677612   0.00063340711  0              0.014569876    0.056088184    0              270829.77      2.6109412e-16  0              2.9956406    
    900000   103.5          200            200            0.0052450429   0.000635077    0              0.015100052    0.011328005    0              54698.883      2.6109412e-16  0              2.9955755    
   1000000   103.5          200            200            0.0052835282   0.00063830578  0              0.015212279    0.0016015085   0              7733.1113      2.6109412e-16  0              2.9955622    
   1100000   103.5          200            200            0.0052859526   0.0006384696   0              0.015219388    0.00016848451  0              813.55142      2.6109412e-16  0              2.9955615    
   1200000   103.5          200            200            0.0052824848   0.00063816078  0              0.015209294    1.2099675e-05  0              58.425         2.6109412e-16  0              2.9955628    
   1300000   103.5          200            200            0.00527979     0.00063792697  0              0.015201443    3.9368768e-07  0              1.9009769      2.6109412e-16  0              2.9955638    
   1400000   103.5          200            200            0.0052784136   0.0006378085   0              0.015197432    1.6542578e-09  0              0.007987819    2.6109412e-16  0              2.9955642    
   1500000   103.5          200            200            0.0052778352   0.00063775898  0              0.015195747    1.2716619e-08  0              0.061404004    2.6109412e-16  0              2.9955645    
   1600000   103.5          200            200            0.0052776251   0.00063774109  0              0.015195134    5.1510877e-09  0              0.024872759    2.6109412e-16  0              2.9955645    
   1700000   103.5          200            200            0.0052775594   0.00063773553  0              0.015194943    1.1507229e-09  0              0.005556429    2.6109412e-16  0              2.9955646    
   1800000   103.5          200            200            0.0052775428   0.00063773414  0              0.015194894    1.8315923e-10  0              0.00088441038  2.6109412e-16  0              2.9955646    
   1900000   103.5          200            200            0.0052775403   0.00063773394  0              0.015194887    2.1936496e-11  0              0.00010592349  2.6109412e-16  0              2.9955646    
   2000000   103.5          200            200            0.0052775409   0.00063773399  0              0.015194889    1.8994677e-12  0              9.1718499e-06  2.6109412e-16  0              2.9955646    
   2100000   103.5          200            200            0.0052775416   0.00063773406  0              0.015194891    9.6484049e-14  0              4.6588694e-07  2.6109412e-16  0              2.9955646    
   2200000   103.5          200            200            0.005277542    0.00063773409  0              0.015194892    6.9440927e-16  0              3.3530539e-09  2.6109412e-16  0              2.9955646    
   2300000   103.5          200            200            0.0052775422   0.00063773411  0              0.015194892    5.8042883e-16  0              2.8026831e-09  2.6109412e-16  0              2.9955646    
   2400000   103.5          200            200            0.0052775422   0.00063773411  0              0.015194893    4.045342e-16   0              1.9533509e-09  2.6109412e-16  0              2.9955646    
   2500000   103.5          200            200            0.0052775423   0.00063773412  0              0.015194893    1.0981496e-16  0              5.3025712e-10  2.6109412e-16  0              2.9955646    
   2600000   103.5          200            200            0.0052775423   0.00063773412  0              0.015194893    1.9473629e-17  0              9.4031186e-11  2.6109412e-16  0              2.9955646    
   2700000   103.5          200            200            0.0052775423   0.00063773412  0              0.015194893    2.2725413e-18  0              1.0973289e-11  2.6109412e-16  0              2.9955646    
   2800000   103.5          200            200            0.0052775423   0.00063773412  0              0.015194893    5.5342046e-20  0              2.6722693e-13  2.6109412e-16  0              2.9955646    
   2900000   103.5          200            200            0.0052775423   0.00063773412  0              0.015194893    1.0072201e-19  0              4.8635052e-13  2.6109412e-16  0              2.9955646    
   3000000   103.5          200            200            0.0052775423   0.00063773412  0              0.015194893    1.4373267e-19  0              6.9403364e-13  2.6109412e-16  0              2.9955646    
Loop time of 70.4067 on 4 procs for 3000000 steps with 51 atoms

Performance: 36814666.658 ns/day, 0.000 hours/ns, 42609.568 timesteps/s
99.8% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 0.22449    | 1.289      | 4.2865     | 152.5 |  1.83
Neigh   | 0.078856   | 0.079676   | 0.081341   |   0.3 |  0.11
Comm    | 30.098     | 37.649     | 44.101     |  93.0 | 53.47
Output  | 0.45827    | 0.49789    | 0.61409    |   9.5 |  0.71
Modify  | 15.131     | 21.883     | 30.176     | 142.8 | 31.08
Other   |            | 9.008      |            |       | 12.79

Nlocal:          12.75 ave          51 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1
Nghost:          39.25 ave          52 max           1 min
Histogram: 1 0 0 0 0 0 0 0 0 3
Neighs:           7.75 ave          31 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1

Total # of neighbors = 31
Ave neighs/atom = 0.60784314
Neighbor list builds = 164
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 46

#variable lat0 equal 1                    #
variable lat1 equal 3+(v_ind*0.01)  # .491+(v_ind*0.001)       # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 10*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 3.46                                                               
Lattice spacing in x,y,z = 3.46 3.46 3.46

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -51.9 ${n1e1} -100 100 -100 100 units box
region box block -51.9 51.9 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -51.9 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -51.9 51.9 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-51.9 -100 -100) to (51.9 100 100)
  1 by 2 by 2 MPI processor grid
create_atoms 1 region substrate
Created 30 atoms
  using lattice units in orthogonal box = (-51.9 -100 -100) to (51.9 100 100)
  create_atoms CPU = 0.000 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 30 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 21 atoms
  using lattice units in orthogonal box = (-51.9 -100 -100) to (51.9 100 100)
  create_atoms CPU = 0.002 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  30 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  30 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  21 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  21 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
30 atoms in group substrate
group slider1 region slider1
21 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 21 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 10000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 10000 Equi_46_*.dump id type diameter mass xu yu zu fx fy fz

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 67 130 130
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 14.04 | 17.51 | 18.66 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   103.8          200            200            0              0              0              0              0              0              0              2.6109412e-16  0              6            
    100000   103.8          200            200            0.0041208245  -1.7394592e-41  0              0.012362473    12325.32       0              5.9514561e+10  2.6109412e-16  0              3.3244721    
    200000   103.8          200            200            0.0014901123  -2.3744187e-38  0              0.0044703368   3103.0433      0              1.4983486e+10  2.6109412e-16  0              3.0685087    
    300000   103.8          200            200            0.00016927676 -9.3961191e-38  0              0.00050783027  78.768553      0              3.8034515e+08  2.6109412e-16  0              3.0430094    
    400000   103.8          200            200            0.0043799829  -1.5226127e-36  0              0.013139949    197.69376      0              9.5459241e+08  2.6109412e-16  0              2.9958335    
    500000   103.8          200            200            0.0013191096   3.6930967e-36  0              0.0039573289   5.2651629      0              25423587       2.6109412e-16  0              2.9980863    
    600000   103.8          200            200            0.0034928187  -1.0157991e-35  0              0.010478456    0.56061977     0              2707032.2      2.6109412e-16  0              2.9962492    
    700000   103.8          200            200            0.0045345362   1.1706586e-37  0              0.013603609    0.1866103      0              901074.33      2.6109412e-16  0              2.9955417    
    800000   103.8          200            200            0.0048825301  -3.1355108e-37  0              0.01464759     0.03661518     0              176801.6       2.6109412e-16  0              2.9953192    
    900000   103.8          200            200            0.004997437    1.2743363e-37  0              0.014992311    0.0063591349   0              30705.986      2.6109412e-16  0              2.9952473    
   1000000   103.8          200            200            0.0050342517  -7.9268734e-39  0              0.015102755    0.0010314984   0              4980.7366      2.6109412e-16  0              2.9952245    
   1100000   103.8          200            200            0.0050455313   2.942564e-38   0              0.015136594    0.00015871827  0              766.39372      2.6109412e-16  0              2.9952175    
   1200000   103.8          200            200            0.0050487679   6.0043742e-39  0              0.015146304    2.3337251e-05  0              112.68723      2.6109412e-16  0              2.9952156    
   1300000   103.8          200            200            0.0050495998   2.0834486e-39  0              0.015148799    3.2917837e-06  0              15.894845      2.6109412e-16  0              2.9952151    
   1400000   103.8          200            200            0.0050497679  -2.8563551e-39  0              0.015149304    4.4621464e-07  0              2.1546108      2.6109412e-16  0              2.995215     
   1500000   103.8          200            200            0.0050497778  -7.6481772e-39  0              0.015149333    5.8133499e-08  0              0.28070586     2.6109412e-16  0              2.995215     
   1600000   103.8          200            200            0.0050497622   7.0429013e-39  0              0.015149287    7.2678883e-09  0              0.035094032    2.6109412e-16  0              2.995215     
   1700000   103.8          200            200            0.0050497496  -3.1905634e-40  0              0.015149249    8.6895693e-10  0              0.004195882    2.6109412e-16  0              2.995215     
   1800000   103.8          200            200            0.0050497425   5.7481802e-39  0              0.015149227    9.8764372e-11  0              0.00047689781  2.6109412e-16  0              2.995215     
   1900000   103.8          200            200            0.005049739    8.1301418e-40  0              0.015149217    1.0567297e-11  0              5.1025694e-05  2.6109412e-16  0              2.995215     
   2000000   103.8          200            200            0.0050497374   4.9074875e-39  0              0.015149212    1.0471135e-12  0              5.0561362e-06  2.6109412e-16  0              2.995215     
   2100000   103.8          200            200            0.0050497367   1.5819675e-38  0              0.01514921     9.3355149e-14  0              4.507786e-07   2.6109412e-16  0              2.995215     
   2200000   103.8          200            200            0.0050497365  -1.3197662e-38  0              0.015149209    7.0683781e-15  0              3.4130668e-08  2.6109412e-16  0              2.995215     
   2300000   103.8          200            200            0.0050497364  -9.4007489e-39  0              0.015149209    3.946891e-16   0              1.9058124e-09  2.6109412e-16  0              2.995215     
   2400000   103.8          200            200            0.0050497363  -2.4644896e-39  0              0.015149209    9.1425289e-18  0              4.4146e-11     2.6109412e-16  0              2.995215     
   2500000   103.8          200            200            0.0050497363   4.6549917e-39  0              0.015149209    8.7200403e-20  0              4.2105954e-13  2.6109412e-16  0              2.995215     
   2600000   103.8          200            200            0.0050497363   1.3455615e-38  0              0.015149209    5.7823273e-19  0              2.7920789e-12  2.6109412e-16  0              2.995215     
   2700000   103.8          200            200            0.0050497363   1.6868044e-39  0              0.015149209    2.2058305e-19  0              1.0651166e-12  2.6109412e-16  0              2.995215     
   2800000   103.8          200            200            0.0050497363   5.3528869e-40  0              0.015149209    8.368527e-20   0              4.0408622e-13  2.6109412e-16  0              2.995215     
   2900000   103.8          200            200            0.0050497363   5.5647962e-39  0              0.015149209    6.787595e-21   0              3.2774867e-14  2.6109412e-16  0              2.995215     
   3000000   103.8          200            200            0.0050497363   1.679331e-38   0              0.015149209    3.7798193e-20  0              1.8251395e-13  2.6109412e-16  0              2.995215     
Loop time of 70.53 on 4 procs for 3000000 steps with 51 atoms

Performance: 36750337.267 ns/day, 0.000 hours/ns, 42535.113 timesteps/s
99.8% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 0.22292    | 1.2538     | 4.1335     | 148.5 |  1.78
Neigh   | 0.078673   | 0.080783   | 0.084078   |   0.8 |  0.11
Comm    | 30.101     | 37.708     | 44.125     |  93.8 | 53.46
Output  | 0.4453     | 0.48453    | 0.59972    |   9.6 |  0.69
Modify  | 15.239     | 21.948     | 30.201     | 141.9 | 31.12
Other   |            | 9.055      |            |       | 12.84

Nlocal:          12.75 ave          51 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1
Nghost:          39.25 ave          52 max           1 min
Histogram: 1 0 0 0 0 0 0 0 0 3
Neighs:           7.75 ave          31 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1

Total # of neighbors = 31
Ave neighs/atom = 0.60784314
Neighbor list builds = 164
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 47

#variable lat0 equal 1                    #
variable lat1 equal 3+(v_ind*0.01)  # .491+(v_ind*0.001)       # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 10*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 3.47                                                               
Lattice spacing in x,y,z = 3.47 3.47 3.47

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -52.05 ${n1e1} -100 100 -100 100 units box
region box block -52.05 52.05 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -52.05 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -52.05 52.05 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-52.05 -100 -100) to (52.05 100 100)
  1 by 2 by 2 MPI processor grid
create_atoms 1 region substrate
Created 29 atoms
  using lattice units in orthogonal box = (-52.05 -100 -100) to (52.05 100 100)
  create_atoms CPU = 0.000 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 30 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 21 atoms
  using lattice units in orthogonal box = (-52.05 -100 -100) to (52.05 100 100)
  create_atoms CPU = 0.002 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  29 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  29 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  21 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  21 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
29 atoms in group substrate
group slider1 region slider1
21 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 21 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 10000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 10000 Equi_47_*.dump id type diameter mass xu yu zu fx fy fz

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 68 130 130
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 14.06 | 17.52 | 18.68 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   104.1          200            200            0              0              0              0              0              0              0              2.6109412e-16  0              6            
    100000   104.1          200            200            0.0041068377  -7.4000091e-39  0              0.012320513    12315.098      0              6.6072447e+10  2.6109412e-16  0              3.3251125    
    200000   104.1          200            200            0.0014756414  -3.5519349e-38  0              0.0044269243   3069.1478      0              1.6466463e+10  2.6109412e-16  0              3.0705904    
    300000   104.1          200            200            0.00013614559  9.486865e-38   0              0.00040843677  52.632637      0              2.8238241e+08  2.6109412e-16  0              3.0447501    
    400000   104.1          200            200            0.0066208569  -5.7104426e-05  0              0.019919675    207.50919      0              1.1133196e+09  2.6109412e-16  0              2.9944429    
    500000   104.1          200            200            0.0017682174  -2.5908525e-36  0              0.0053046523   12.983264      0              69657261       2.6109412e-16  0              2.9976778    
    600000   104.1          200            200            0.0038318645  -1.0287164e-35  0              0.011495593    1.9963478      0              10710721       2.6109412e-16  0              2.9959954    
    700000   104.1          200            200            0.0045045685  -1.3943507e-37  0              0.013513705    0.15922569     0              854270.96      2.6109412e-16  0              2.9955532    
    800000   104.1          200            200            0.0048604818   8.2462399e-37  0              0.014581445    0.032563663    0              174709.19      2.6109412e-16  0              2.9953245    
    900000   104.1          200            200            0.0049796019   3.9224975e-37  0              0.014938806    0.0058159997   0              31203.757      2.6109412e-16  0              2.9952495    
   1000000   104.1          200            200            0.0050183315  -1.0270524e-37  0              0.015054995    0.00096443431  0              5174.3424      2.6109412e-16  0              2.9952254    
   1100000   104.1          200            200            0.0050304278  -1.4544073e-39  0              0.015091283    0.00015119289  0              811.17372      2.6109412e-16  0              2.9952179    
   1200000   104.1          200            200            0.0050339992  -9.6490157e-39  0              0.015101998    2.2603227e-05  0              121.26988      2.6109412e-16  0              2.9952157    
   1300000   104.1          200            200            0.0050349643   2.5429895e-39  0              0.015104893    3.2379902e-06  0              17.372328      2.6109412e-16  0              2.9952151    
   1400000   104.1          200            200            0.0050351842  -3.3371062e-39  0              0.015105553    4.4557064e-07  0              2.3905568      2.6109412e-16  0              2.995215     
   1500000   104.1          200            200            0.0050352137   2.0189971e-39  0              0.015105641    5.893816e-08   0              0.31621254     2.6109412e-16  0              2.995215     
   1600000   104.1          200            200            0.0050352055   1.4930325e-39  0              0.015105617    7.4872011e-09  0              0.040170016    2.6109412e-16  0              2.995215     
   1700000   104.1          200            200            0.0050351956  -4.1142657e-39  0              0.015105587    9.1101992e-10  0              0.0048877657   2.6109412e-16  0              2.995215     
   1800000   104.1          200            200            0.0050351894   2.1804469e-39  0              0.015105568    1.0565691e-10  0              0.00056686602  2.6109412e-16  0              2.995215     
   1900000   104.1          200            200            0.0050351863   4.1227015e-39  0              0.015105559    1.158519e-11   0              6.2156373e-05  2.6109412e-16  0              2.995215     
   2000000   104.1          200            200            0.0050351848  -1.2502547e-39  0              0.015105554    1.1849839e-12  0              6.3576255e-06  2.6109412e-16  0              2.995215     
   2100000   104.1          200            200            0.0050351842  -3.5673351e-39  0              0.015105553    1.1049e-13     0              5.9279632e-07  2.6109412e-16  0              2.995215     
   2200000   104.1          200            200            0.0050351839   2.3573833e-39  0              0.015105552    8.989753e-15   0              4.8231444e-08  2.6109412e-16  0              2.995215     
   2300000   104.1          200            200            0.0050351838  -8.6289774e-39  0              0.015105551    5.7768744e-16  0              3.0993843e-09  2.6109412e-16  0              2.995215     
   2400000   104.1          200            200            0.0050351838  -2.569691e-40   0              0.015105551    2.0925296e-17  0              1.1226752e-10  2.6109412e-16  0              2.995215     
   2500000   104.1          200            200            0.0050351837   3.0611561e-39  0              0.015105551    3.3781959e-20  0              1.8124554e-13  2.6109412e-16  0              2.995215     
   2600000   104.1          200            200            0.0050351837   1.687536e-38   0              0.015105551    3.0342402e-19  0              1.6279178e-12  2.6109412e-16  0              2.995215     
   2700000   104.1          200            200            0.0050351837  -4.6862437e-39  0              0.015105551    1.2014075e-19  0              6.4457411e-13  2.6109412e-16  0              2.995215     
   2800000   104.1          200            200            0.0050351837  -5.3705663e-39  0              0.015105551    6.6255542e-20  0              3.5547145e-13  2.6109412e-16  0              2.995215     
   2900000   104.1          200            200            0.0050351837  -2.9268006e-39  0              0.015105551    1.723764e-21   0              9.2482658e-15  2.6109412e-16  0              2.995215     
   3000000   104.1          200            200            0.0050351837   4.1375104e-39  0              0.015105551    5.7892926e-20  0              3.1060469e-13  2.6109412e-16  0              2.995215     
Loop time of 69.3305 on 4 procs for 3000000 steps with 50 atoms

Performance: 37386122.984 ns/day, 0.000 hours/ns, 43270.976 timesteps/s
99.8% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 0.2217     | 1.2219     | 4.0373     | 147.1 |  1.76
Neigh   | 0.079488   | 0.081972   | 0.085718   |   0.9 |  0.12
Comm    | 29.373     | 36.756     | 43.009     |  92.3 | 53.02
Output  | 0.45376    | 0.49376    | 0.61114    |   9.6 |  0.71
Modify  | 15.14      | 21.782     | 29.758     | 138.9 | 31.42
Other   |            | 8.994      |            |       | 12.97

Nlocal:           12.5 ave          50 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1
Nghost:           37.5 ave          50 max           0 min
Histogram: 1 0 0 0 0 0 0 0 0 3
Neighs:           7.75 ave          31 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1

Total # of neighbors = 31
Ave neighs/atom = 0.62
Neighbor list builds = 164
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 48

#variable lat0 equal 1                    #
variable lat1 equal 3+(v_ind*0.01)  # .491+(v_ind*0.001)       # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 10*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 3.48                                                               
Lattice spacing in x,y,z = 3.48 3.48 3.48

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -52.2 ${n1e1} -100 100 -100 100 units box
region box block -52.2 52.2 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -52.2 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -52.2 52.2 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-52.2 -100 -100) to (52.2 100 100)
  1 by 2 by 2 MPI processor grid
create_atoms 1 region substrate
Created 30 atoms
  using lattice units in orthogonal box = (-52.2 -100 -100) to (52.2 100 100)
  create_atoms CPU = 0.000 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 30 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 21 atoms
  using lattice units in orthogonal box = (-52.2 -100 -100) to (52.2 100 100)
  create_atoms CPU = 0.003 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  30 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  30 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  21 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  21 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
30 atoms in group substrate
group slider1 region slider1
21 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 21 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 10000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 10000 Equi_48_*.dump id type diameter mass xu yu zu fx fy fz

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 68 130 130
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 14.06 | 17.52 | 18.68 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   104.4          200            200            0              0              0              0              0              0              0              2.6109412e-16  0              6            
    100000   104.4          200            200            0.0040904519   4.4276861e-39  0              0.012271356    12291.284      0              5.9350211e+10  2.6109412e-16  0              3.3271087    
    200000   104.4          200            200            0.0014442942  -1.2544286e-38  0              0.0043328827   2978.4634      0              1.4381934e+10  2.6109412e-16  0              3.0768782    
    300000   104.4          200            200            0.00011062284 -1.475776e-38   0              0.00033186852  35.685703      0              1.7231349e+08  2.6109412e-16  0              3.0470795    
    400000   104.4          200            200            0.022930153   -0.0088729789   0              0.077663439    44.361067      0              2.1420372e+08  2.6109412e-16  0              2.9915919    
    500000   104.4          200            200            0.012273093   -0.0041623812   0              0.040981661    0.39925892     0              1927878.4      2.6109412e-16  0              2.9939805    
    600000   104.4          200            200            0.0041945818  -0.0014123254   0              0.013996071    5.3538025      0              25851596       2.6109412e-16  0              2.9963427    
    700000   104.4          200            200            0.0036898698  -0.0010413214   0              0.012110931    0.016871273    0              81465.341      2.6109412e-16  0              2.9965731    
    800000   104.4          200            200            0.0047094285  -0.0012101961   0              0.015338482    0.091927028    0              443882.72      2.6109412e-16  0              2.9962103    
    900000   104.4          200            200            0.004722417   -0.0012115937   0              0.015378845    0.0057541145   0              27784.56       2.6109412e-16  0              2.9962038    
   1000000   104.4          200            200            0.0045743637  -0.0012006976   0              0.014923789    0.00022551785  0              1088.945       2.6109412e-16  0              2.9962534    
   1100000   104.4          200            200            0.0046234027  -0.0012043448   0              0.015074553    0.00023714776  0              1145.1017      2.6109412e-16  0              2.9962372    
   1200000   104.4          200            200            0.004626538   -0.0012046021   0              0.015084216    1.0686473e-05  0              51.601151      2.6109412e-16  0              2.996236     
   1300000   104.4          200            200            0.0046188149  -0.0012040262   0              0.015060471    9.1710614e-07  0              4.4283773      2.6109412e-16  0              2.9962386    
   1400000   104.4          200            200            0.0046210521  -0.00120419     0              0.015067346    5.9630891e-07  0              2.8793623      2.6109412e-16  0              2.9962379    
   1500000   104.4          200            200            0.0046213264  -0.0012042116   0              0.015068191    1.8612286e-08  0              0.08987207     2.6109412e-16  0              2.9962378    
   1600000   104.4          200            200            0.0046209292  -0.001204182    0              0.015066969    3.3056761e-09  0              0.015961927    2.6109412e-16  0              2.9962379    
   1700000   104.4          200            200            0.0046210289  -0.0012041893   0              0.015067276    1.4643952e-09  0              0.0070710403   2.6109412e-16  0              2.9962379    
   1800000   104.4          200            200            0.0046210483  -0.0012041908   0              0.015067336    2.9190541e-11  0              0.00014095067  2.6109412e-16  0              2.9962379    
   1900000   104.4          200            200            0.0046210281  -0.0012041893   0              0.015067274    1.1002575e-11  0              5.3127496e-05  2.6109412e-16  0              2.9962379    
   2000000   104.4          200            200            0.0046210324  -0.0012041896   0              0.015067287    3.5114133e-12  0              1.6955358e-05  2.6109412e-16  0              2.9962379    
   2100000   104.4          200            200            0.0046210337  -0.0012041897   0              0.015067291    3.8704052e-14  0              1.8688801e-07  2.6109412e-16  0              2.9962379    
   2200000   104.4          200            200            0.0046210327  -0.0012041896   0              0.015067288    3.4529818e-14  0              1.6673213e-07  2.6109412e-16  0              2.9962379    
   2300000   104.4          200            200            0.0046210328  -0.0012041896   0              0.015067288    8.2143476e-15  0              3.9664145e-08  2.6109412e-16  0              2.9962379    
   2400000   104.4          200            200            0.0046210329  -0.0012041896   0              0.015067288    3.5974159e-17  0              1.7370634e-10  2.6109412e-16  0              2.9962379    
   2500000   104.4          200            200            0.0046210329  -0.0012041896   0              0.015067288    1.033428e-16   0              4.9900539e-10  2.6109412e-16  0              2.9962379    
   2600000   104.4          200            200            0.0046210329  -0.0012041896   0              0.015067288    1.8557942e-17  0              8.9609658e-11  2.6109412e-16  0              2.9962379    
   2700000   104.4          200            200            0.0046210329  -0.0012041896   0              0.015067288    1.7475983e-19  0              8.4385268e-13  2.6109412e-16  0              2.9962379    
   2800000   104.4          200            200            0.0046210329  -0.0012041896   0              0.015067288    2.5245821e-19  0              1.2190303e-12  2.6109412e-16  0              2.9962379    
   2900000   104.4          200            200            0.0046210329  -0.0012041896   0              0.015067288    5.3079813e-20  0              2.5630342e-13  2.6109412e-16  0              2.9962379    
   3000000   104.4          200            200            0.0046210329  -0.0012041896   0              0.015067288    9.9506696e-22  0              4.8048222e-15  2.6109412e-16  0              2.9962379    
Loop time of 70.0667 on 4 procs for 3000000 steps with 51 atoms

Performance: 36993311.580 ns/day, 0.000 hours/ns, 42816.333 timesteps/s
99.8% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 0.22535    | 1.3023     | 4.3452     | 154.0 |  1.86
Neigh   | 0.074826   | 0.076735   | 0.079764   |   0.7 |  0.11
Comm    | 29.841     | 37.318     | 43.751     |  92.4 | 53.26
Output  | 0.4879     | 0.53034    | 0.65517    |   9.9 |  0.76
Modify  | 15.117     | 21.792     | 29.987     | 141.3 | 31.10
Other   |            | 9.047      |            |       | 12.91

Nlocal:          12.75 ave          51 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1
Nghost:          39.25 ave          52 max           1 min
Histogram: 1 0 0 0 0 0 0 0 0 3
Neighs:           7.25 ave          29 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1

Total # of neighbors = 29
Ave neighs/atom = 0.56862745
Neighbor list builds = 166
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 49

#variable lat0 equal 1                    #
variable lat1 equal 3+(v_ind*0.01)  # .491+(v_ind*0.001)       # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 10*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 3.49                                                               
Lattice spacing in x,y,z = 3.49 3.49 3.49

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -52.35 ${n1e1} -100 100 -100 100 units box
region box block -52.35 52.35 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -52.35 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -52.35 52.35 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-52.35 -100 -100) to (52.35 100 100)
  1 by 2 by 2 MPI processor grid
create_atoms 1 region substrate
Created 30 atoms
  using lattice units in orthogonal box = (-52.35 -100 -100) to (52.35 100 100)
  create_atoms CPU = 0.000 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 30 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 21 atoms
  using lattice units in orthogonal box = (-52.35 -100 -100) to (52.35 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  30 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  30 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  21 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  21 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
30 atoms in group substrate
group slider1 region slider1
21 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 21 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 10000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 10000 Equi_49_*.dump id type diameter mass xu yu zu fx fy fz

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 68 130 130
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 14.06 | 17.52 | 18.68 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   104.7          200            200            0              0              0              0              0              0              0              2.6109412e-16  0              6            
    100000   104.7          200            200            0.0040725978   2.2074166e-39  0              0.012217793    12258.792      0              5.919332e+10   2.6109412e-16  0              3.3300059    
    200000   104.7          200            200            0.0014233395  -3.6789294e-40  0              0.0042700184   2921.9953      0              1.410927e+10   2.6109412e-16  0              3.0812989    
    300000   104.7          200            200            9.9443625e-05  2.2993451e-41  0              0.00029833088  29.266142      0              1.4131573e+08  2.6109412e-16  0              3.0485614    
    400000   104.7          200            200            0.025557029   -0.0035826677   0              0.080253754    38.01241       0              1.8354832e+08  2.6109412e-16  0              2.9925866    
    500000   104.7          200            200            0.00023288227 -1.9251361e-05  0              0.00071789817  18.342335      0              88568571       2.6109412e-16  0              2.9993003    
    600000   104.7          200            200            0.0031644958  -0.00080136396  0              0.010294851    3.9464319      0              19055907       2.6109412e-16  0              2.9978356    
    700000   104.7          200            200            0.0038184742  -0.00092103439  0              0.012376457    0.2461351      0              1188498.3      2.6109412e-16  0              2.9975913    
    800000   104.7          200            200            0.0043574854  -0.00094160125  0              0.014014058    0.029589886    0              142878.97      2.6109412e-16  0              2.997414     
    900000   104.7          200            200            0.0045689701  -0.0009483499   0              0.01465526     0.0040690001   0              19647.745      2.6109412e-16  0              2.9973467    
   1000000   104.7          200            200            0.0046472575  -0.00095068127  0              0.014892454    0.00056792214  0              2742.2928      2.6109412e-16  0              2.997322     
   1100000   104.7          200            200            0.0046759549  -0.00095151433  0              0.014979379    7.9267862e-05  0              382.75614      2.6109412e-16  0              2.997313     
   1200000   104.7          200            200            0.0046864514  -0.00095181624  0              0.01501117     1.1052055e-05  0              53.366417      2.6109412e-16  0              2.9973097    
   1300000   104.7          200            200            0.0046902881  -0.00095192624  0              0.015022791    1.5396182e-06  0              7.4342651      2.6109412e-16  0              2.9973085    
   1400000   104.7          200            200            0.0046916901  -0.00095196639  0              0.015027037    2.1432702e-07  0              1.0349085      2.6109412e-16  0              2.9973081    
   1500000   104.7          200            200            0.0046922023  -0.00095198105  0              0.015028588    2.9817392e-08  0              0.14397751     2.6109412e-16  0              2.9973079    
   1600000   104.7          200            200            0.0046923894  -0.00095198641  0              0.015029154    4.1457893e-09  0              0.020018533    2.6109412e-16  0              2.9973078    
   1700000   104.7          200            200            0.0046924577  -0.00095198837  0              0.015029361    5.7610467e-10  0              0.0027818033   2.6109412e-16  0              2.9973078    
   1800000   104.7          200            200            0.0046924826  -0.00095198908  0              0.015029437    8.0012298e-11  0              0.00038635075  2.6109412e-16  0              2.9973078    
   1900000   104.7          200            200            0.0046924917  -0.00095198934  0              0.015029465    1.1106746e-11  0              5.3630503e-05  2.6109412e-16  0              2.9973078    
   2000000   104.7          200            200            0.0046924951  -0.00095198944  0              0.015029475    1.5408234e-12  0              7.4400846e-06  2.6109412e-16  0              2.9973078    
   2100000   104.7          200            200            0.0046924963  -0.00095198947  0              0.015029478    2.1365281e-13  0              1.0316529e-06  2.6109412e-16  0              2.9973078    
   2200000   104.7          200            200            0.0046924967  -0.00095198948  0              0.01502948     2.9616228e-14  0              1.4300616e-07  2.6109412e-16  0              2.9973078    
   2300000   104.7          200            200            0.0046924969  -0.00095198949  0              0.01502948     4.1093023e-15  0              1.984235e-08   2.6109412e-16  0              2.9973078    
   2400000   104.7          200            200            0.004692497   -0.00095198949  0              0.01502948     5.6824109e-16  0              2.7438329e-09  2.6109412e-16  0              2.9973078    
   2500000   104.7          200            200            0.004692497   -0.00095198949  0              0.01502948     7.9858275e-17  0              3.8560703e-10  2.6109412e-16  0              2.9973078    
   2600000   104.7          200            200            0.004692497   -0.00095198949  0              0.01502948     1.0480306e-17  0              5.0605648e-11  2.6109412e-16  0              2.9973078    
   2700000   104.7          200            200            0.004692497   -0.00095198949  0              0.01502948     6.61032e-19    0              3.1918869e-12  2.6109412e-16  0              2.9973078    
   2800000   104.7          200            200            0.004692497   -0.00095198949  0              0.01502948     2.7209756e-19  0              1.3138618e-12  2.6109412e-16  0              2.9973078    
   2900000   104.7          200            200            0.004692497   -0.00095198949  0              0.01502948     3.3949783e-20  0              1.6393135e-13  2.6109412e-16  0              2.9973078    
   3000000   104.7          200            200            0.004692497   -0.00095198949  0              0.01502948     8.4381458e-20  0              4.0744786e-13  2.6109412e-16  0              2.9973078    
Loop time of 70.9749 on 4 procs for 3000000 steps with 51 atoms

Performance: 36519966.227 ns/day, 0.000 hours/ns, 42268.479 timesteps/s
99.8% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 0.22483    | 1.2998     | 4.3428     | 154.1 |  1.83
Neigh   | 0.078069   | 0.080556   | 0.084117   |   0.9 |  0.11
Comm    | 30.411     | 37.957     | 44.469     |  93.3 | 53.48
Output  | 0.4564     | 0.4962     | 0.61317    |   9.6 |  0.70
Modify  | 15.272     | 22.057     | 30.333     | 142.8 | 31.08
Other   |            | 9.085      |            |       | 12.80

Nlocal:          12.75 ave          51 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1
Nghost:          39.25 ave          52 max           1 min
Histogram: 1 0 0 0 0 0 0 0 0 3
Neighs:           7.25 ave          29 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1

Total # of neighbors = 29
Ave neighs/atom = 0.56862745
Neighbor list builds = 166
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 50

#variable lat0 equal 1                    #
variable lat1 equal 3+(v_ind*0.01)  # .491+(v_ind*0.001)       # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 10*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 3.5                                                               
Lattice spacing in x,y,z = 3.5 3.5 3.5

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -52.5 ${n1e1} -100 100 -100 100 units box
region box block -52.5 52.5 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -52.5 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -52.5 52.5 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-52.5 -100 -100) to (52.5 100 100)
  1 by 2 by 2 MPI processor grid
create_atoms 1 region substrate
Created 30 atoms
  using lattice units in orthogonal box = (-52.5 -100 -100) to (52.5 100 100)
  create_atoms CPU = 0.000 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 30 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 21 atoms
  using lattice units in orthogonal box = (-52.5 -100 -100) to (52.5 100 100)
  create_atoms CPU = 0.002 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  30 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  30 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  21 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  21 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
30 atoms in group substrate
group slider1 region slider1
21 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 21 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 10000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 10000 Equi_50_*.dump id type diameter mass xu yu zu fx fy fz

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 68 130 130
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 14.06 | 17.52 | 18.68 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   105            200            200            0              0              0              0              0              0              0              2.6109412e-16  0              6            
    100000   105            200            200            0.0040562777  -4.6952983e-38  0              0.012168833    12234.125      0              5.9074211e+10  2.6109412e-16  0              3.3321503    
    200000   105            200            200            0.0014137937  -1.4670927e-39  0              0.004241381    2903.5522      0              1.4020214e+10  2.6109412e-16  0              3.0828157    
    300000   105            200            200            9.3599254e-05  2.9476282e-44  0              0.00028079776  26.201614      0              1.2651822e+08  2.6109412e-16  0              3.049136     
    400000   105            200            200            0.025110731    2.3449482e-38  0              0.075332192    64.007442      0              3.0906903e+08  2.6109412e-16  0              2.9932703    
    500000   105            200            200            0.00026516971 -3.5212944e-38  0              0.00079550912  20.069361      0              96907762       2.6109412e-16  0              2.9996173    
    600000   105            200            200            0.0043131658   6.4336905e-41  0              0.012939497    5.4904637      0              26511484       2.6109412e-16  0              2.9979278    
    700000   105            200            200            0.004629423    2.6655542e-41  0              0.013888269    0.69802904     0              3370532.4      2.6109412e-16  0              2.9978182    
    800000   105            200            200            0.004953548    2.2763427e-38  0              0.014860644    0.1055953      0              509881.92      2.6109412e-16  0              2.9977145    
    900000   105            200            200            0.0050217682   1.9095394e-41  0              0.015065305    0.014080113    0              67987.828      2.6109412e-16  0              2.9976924    
   1000000   105            200            200            0.0050202176  -5.5740337e-38  0              0.015060653    0.0015954079   0              7703.6536      2.6109412e-16  0              2.9976924    
   1100000   105            200            200            0.005009697    5.7982007e-38  0              0.015029091    0.00014860916  0              717.58043      2.6109412e-16  0              2.9976955    
   1200000   105            200            200            0.0050024782  -1.6119825e-38  0              0.015007435    1.0354211e-05  0              49.99678       2.6109412e-16  0              2.9976977    
   1300000   105            200            200            0.0049987992   2.074849e-38   0              0.014996398    3.925279e-07   0              1.8953768      2.6109412e-16  0              2.9976988    
   1400000   105            200            200            0.0049971743   4.0191673e-38  0              0.014991523    5.9981802e-11  0              0.00028963066  2.6109412e-16  0              2.9976993    
   1500000   105            200            200            0.0049965229  -3.6915747e-39  0              0.014989569    6.2878601e-09  0              0.030361826    2.6109412e-16  0              2.9976995    
   1600000   105            200            200            0.004996282   -1.2816377e-38  0              0.014988846    3.2641396e-09  0              0.015761362    2.6109412e-16  0              2.9976996    
   1700000   105            200            200            0.0049961998  -4.5814684e-38  0              0.014988599    8.8085282e-10  0              0.004253323    2.6109412e-16  0              2.9976996    
   1800000   105            200            200            0.0049961742   9.4401746e-40  0              0.014988523    1.7584341e-10  0              0.00084908488  2.6109412e-16  0              2.9976996    
   1900000   105            200            200            0.0049961672  -6.2937041e-38  0              0.014988502    2.8762088e-11  0              0.00013888183  2.6109412e-16  0              2.9976996    
   2000000   105            200            200            0.0049961658   7.204925e-39   0              0.014988497    3.9949918e-12  0              1.9290386e-05  2.6109412e-16  0              2.9976996    
   2100000   105            200            200            0.0049961657   5.6853611e-39  0              0.014988497    4.7339304e-13  0              2.2858456e-06  2.6109412e-16  0              2.9976996    
   2200000   105            200            200            0.0049961658  -9.0749614e-39  0              0.014988497    4.6739877e-14  0              2.2569014e-07  2.6109412e-16  0              2.9976996    
   2300000   105            200            200            0.0049961659   7.1962187e-38  0              0.014988498    3.5659039e-15  0              1.7218474e-08  2.6109412e-16  0              2.9976996    
   2400000   105            200            200            0.004996166    4.8492569e-38  0              0.014988498    1.7264172e-16  0              8.3362506e-10  2.6109412e-16  0              2.9976996    
   2500000   105            200            200            0.004996166   -6.9282737e-39  0              0.014988498    1.1285365e-18  0              5.449299e-12   2.6109412e-16  0              2.9976996    
   2600000   105            200            200            0.004996166    2.0506722e-38  0              0.014988498    8.2993529e-19  0              4.0074605e-12  2.6109412e-16  0              2.9976996    
   2700000   105            200            200            0.004996166   -5.9825802e-38  0              0.014988498    1.6265299e-19  0              7.8539305e-13  2.6109412e-16  0              2.9976996    
   2800000   105            200            200            0.004996166   -4.4056703e-38  0              0.014988498    3.154571e-19   0              1.5232295e-12  2.6109412e-16  0              2.9976996    
   2900000   105            200            200            0.004996166   -3.9887595e-38  0              0.014988498    7.4922051e-20  0              3.6177177e-13  2.6109412e-16  0              2.9976996    
   3000000   105            200            200            0.004996166    3.7638056e-39  0              0.014988498    2.2297245e-20  0              1.0766541e-13  2.6109412e-16  0              2.9976996    
Loop time of 70.3739 on 4 procs for 3000000 steps with 51 atoms

Performance: 36831860.454 ns/day, 0.000 hours/ns, 42629.468 timesteps/s
99.8% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 0.22159    | 1.2631     | 4.2129     | 151.6 |  1.79
Neigh   | 0.078154   | 0.080593   | 0.084404   |   0.9 |  0.11
Comm    | 30.208     | 37.675     | 44.066     |  92.5 | 53.54
Output  | 0.46091    | 0.50023    | 0.61561    |   9.4 |  0.71
Modify  | 15.132     | 21.858     | 30.051     | 142.2 | 31.06
Other   |            | 8.996      |            |       | 12.78

Nlocal:          12.75 ave          51 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1
Nghost:          39.25 ave          52 max           1 min
Histogram: 1 0 0 0 0 0 0 0 0 3
Neighs:           7.25 ave          29 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1

Total # of neighbors = 29
Ave neighs/atom = 0.56862745
Neighbor list builds = 166
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop
Total wall time: 1:00:24

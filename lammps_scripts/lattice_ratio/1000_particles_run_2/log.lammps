LAMMPS (23 Jun 2022 - Update 1)
  using 1 OpenMP thread(s) per MPI task
variable num index 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99

label startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 0

#variable lat0 equal 1                    #
variable lat1 equal 3+(100*0.01)+(v_ind*0.01)  # .491+(v_ind*0.001)       # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 500*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4                                                               
Lattice spacing in x,y,z = 4 4 4

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -3000 ${n1e1} -100 100 -100 100 units box
region box block -3000 3000 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -3000 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -3000 3000 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-3000 -100 -100) to (3000 100 100)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 1500 atoms
  using lattice units in orthogonal box = (-3000 -100 -100) to (3000 100 100)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 1500 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 1001 atoms
  using lattice units in orthogonal box = (-3000 -100 -100) to (3000 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  1500 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  1500 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  1001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  1001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
1500 atoms in group substrate
group slider1 region slider1
1001 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 1001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_0_*.dump id type diameter mass xu yu zu fx fy fz

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 3871 130 130
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 80.51 | 80.51 | 80.52 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   6000           200            200            0              0              0              0              0              0              0              1.1965779e-13  0              6            
    100000   6000           200            200            0.0034131151  -2.6926365e-35  0              0.010239345    590902.63      0              5.7065147e+10  1.1965779e-13  0              3.3252534    
    200000   6000           200            200            0.001253493    2.1442303e-40  0              0.0037604789   152306.09      0              1.4708632e+10  1.1965779e-13  0              3.07009      
    300000   6000           200            200            0.00019506075  1.0770617e-34  0              0.00058518226  6938.8263      0              6.7010218e+08  1.1965779e-13  0              3.0459293    
    400000   6000           200            200           -8.8305839e-05 -5.3852465e-35  0             -0.00026491752  2024.9443      0              1.9555463e+08  1.1965779e-13  0              3.0087317    
    500000   6000           200            200            0.0055796254  -1.3463196e-34  0              0.016738876    2206.2751      0              2.1306625e+08  1.1965779e-13  0              2.9981038    
    600000   6000           200            200            0.0074564561  -5.3852739e-35  0              0.022369368    40.13592       0              3876039.8      1.1965779e-13  0              2.9976729    
    700000   6000           200            200            0.0032218687  -2.6926312e-35  0              0.0096656061   14.853115      0              1434407.5      1.1965779e-13  0              2.9986709    
    800000   6000           200            200            0.0038438309  -1.2116891e-34  0              0.011531493    2.6657595      0              257439.97      1.1965779e-13  0              2.9985015    
    900000   6000           200            200            0.0042389511   1.346333e-35   0              0.012716853    0.63760218     0              61575.055      1.1965779e-13  0              2.9984009    
   1000000   6000           200            200            0.0042271243   2.0194895e-35  0              0.012681373    0.0026958923   0              260.34998      1.1965779e-13  0              2.9984044    
   1100000   6000           200            200            0.004171805    1.5357816e-41  0              0.012515415    0.013953506    0              1347.5298      1.1965779e-13  0              2.9984183    
   1200000   6000           200            200            0.004161494    2.0194849e-35  0              0.012484482    0.00035161284  0              33.956251      1.1965779e-13  0              2.9984209    
   1300000   6000           200            200            0.0041666532   3.3658192e-36  0              0.01249996     0.00013835435  0              13.361273      1.1965779e-13  0              2.9984196    
   1400000   6000           200            200            0.004169162    1.5979729e-41  0              0.012507486    2.5786697e-05  0              2.4902946      1.1965779e-13  0              2.998419     
   1500000   6000           200            200            0.0041690161   3.3658244e-36  0              0.012507048    2.2312172e-07  0              0.021547499    1.1965779e-13  0              2.998419     
   1600000   6000           200            200            0.0041686477  -1.0097402e-35  0              0.012505943    6.1492319e-07  0              0.059384881    1.1965779e-13  0              2.9984191    
   1700000   6000           200            200            0.004168587    3.7023889e-35  0              0.012505761    1.1534792e-08  0              0.0011139476   1.1965779e-13  0              2.9984191    
   1800000   6000           200            200            0.0041686232   1.7106434e-41  0              0.01250587     6.6946537e-09  0              0.00064652174  1.1965779e-13  0              2.9984191    
   1900000   6000           200            200            0.0041686393   2.0194856e-35  0              0.012505918    1.0386627e-09  0              0.00010030661  1.1965779e-13  0              2.9984191    
   2000000   6000           200            200            0.0041686379   6.7316299e-36  0              0.012505914    1.567391e-11   0              1.5136741e-06  1.1965779e-13  0              2.9984191    
   2100000   6000           200            200            0.0041686354  -2.3560629e-35  0              0.012505906    2.689622e-11   0              2.5974444e-06  1.1965779e-13  0              2.9984191    
   2200000   6000           200            200            0.0041686351  -3.3657899e-36  0              0.012505905    3.5681887e-13  0              3.4459012e-08  1.1965779e-13  0              2.9984191    
   2300000   6000           200            200            0.0041686353   1.6649372e-41  0              0.012505906    3.201705e-13   0              3.0919776e-08  1.1965779e-13  0              2.9984191    
   2400000   6000           200            200            0.0041686355   1.6690786e-41  0              0.012505906    4.1417547e-14  0              3.9998103e-09  1.1965779e-13  0              2.9984191    
   2500000   6000           200            200            0.0041686354   4.3755502e-35  0              0.012505906    9.2457901e-16  0              8.9289223e-11  1.1965779e-13  0              2.9984191    
   2600000   6000           200            200            0.0041686354  -6.7315965e-36  0              0.012505906    1.1559357e-15  0              1.11632e-10    1.1965779e-13  0              2.9984191    
   2700000   6000           200            200            0.0041686354  -2.3560629e-35  0              0.012505906    1.6731681e-19  0              1.615826e-14   1.1965779e-13  0              2.9984191    
   2800000   6000           200            200            0.0041686354   1.0097436e-35  0              0.012505906    1.4182824e-17  0              1.3696757e-12  1.1965779e-13  0              2.9984191    
   2900000   6000           200            200            0.0041686354   1.6527591e-41  0              0.012505906    2.7951726e-18  0              2.6993776e-13  1.1965779e-13  0              2.9984191    
   3000000   6000           200            200            0.0041686354  -1.1780306e-35  0              0.012505906    6.655735e-19   0              6.4276324e-14  1.1965779e-13  0              2.9984191    
Loop time of 321.627 on 4 procs for 3000000 steps with 2501 atoms

Performance: 8059012.740 ns/day, 0.000 hours/ns, 9327.561 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 12.037     | 47.642     | 82.686     | 505.4 | 14.81
Neigh   | 3.7875     | 3.8598     | 3.933      |   3.1 |  1.20
Comm    | 25.88      | 46.05      | 98.021     | 443.1 | 14.32
Output  | 0.27187    | 0.2722     | 0.27259    |   0.1 |  0.08
Modify  | 111.37     | 165.65     | 186.03     | 243.7 | 51.50
Other   |            | 58.15      |            |       | 18.08

Nlocal:         625.25 ave         875 max         375 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:           2.75 ave           3 max           2 min
Histogram: 1 0 0 0 0 0 0 0 0 3
Neighs:         312.75 ave         625 max           0 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 1251
Ave neighs/atom = 0.50019992
Neighbor list builds = 168
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 1

#variable lat0 equal 1                    #
variable lat1 equal 3+(100*0.01)+(v_ind*0.01)  # .491+(v_ind*0.001)       # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 500*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.01                                                               
Lattice spacing in x,y,z = 4.01 4.01 4.01

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -3007.5 ${n1e1} -100 100 -100 100 units box
region box block -3007.5 3007.5 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -3007.5 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -3007.5 3007.5 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-3007.5 -100 -100) to (3007.5 100 100)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 1500 atoms
  using lattice units in orthogonal box = (-3007.5 -100 -100) to (3007.5 100 100)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 1500 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 1001 atoms
  using lattice units in orthogonal box = (-3007.5 -100 -100) to (3007.5 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  1500 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  1500 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  1001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  1001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
1500 atoms in group substrate
group slider1 region slider1
1001 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 1001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_1_*.dump id type diameter mass xu yu zu fx fy fz

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 3881 130 130
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 80.72 | 80.72 | 80.73 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   6015           200            200            0              0              0              0              0              0              0              1.1965779e-13  0              6            
    100000   6015           200            200            0.0033768458   8.1798678e-41  0              0.010130537    584185.12      0              5.6416418e+10  1.1965779e-13  0              3.3270137    
    200000   6015           200            200            0.0011880238   5.3718921e-35  0              0.0035640714   140814.51      0              1.3598857e+10  1.1965779e-13  0              3.0753482    
    300000   6015           200            200            6.7649457e-05  5.371883e-35   0              0.00020294837  955.4515       0              92270667       1.1965779e-13  0              3.0453705    
    400000   6015           200            200            0.00017909494 -1.6115516e-34  0              0.00053728481  6113.9064      0              5.9043732e+08  1.1965779e-13  0              3.0008542    
    500000   6015           200            200            0.00087841006  7.0245317e-05  0              0.0025649849   348.47136      0              33652870       1.1965779e-13  0              2.9978563    
    600000   6015           200            200            0.0036613577   0.0015888489   0              0.0093952243   128.37185      0              12397234       1.1965779e-13  0              2.9958117    
    700000   6015           200            200            0.0055577387   0.0023554402   0              0.014317776    2.604061       0              251481.57      1.1965779e-13  0              2.994811     
    800000   6015           200            200            0.0048310747   0.0021772451   0              0.012315979    3.6323969      0              350790.89      1.1965779e-13  0              2.9951838    
    900000   6015           200            200            0.0048155075   0.0021840386   0              0.012262484    0.19434779     0              18768.718      1.1965779e-13  0              2.9951971    
   1000000   6015           200            200            0.0049149926   0.0021977236   0              0.012547254    0.011364945    0              1097.545       1.1965779e-13  0              2.9951411    
   1100000   6015           200            200            0.0048837109   0.0021932502   0              0.012457882    0.0091997924   0              888.4501       1.1965779e-13  0              2.9951582    
   1200000   6015           200            200            0.0048811308   0.0021926634   0              0.012450729    0.00038914709  0              37.581041      1.1965779e-13  0              2.9951597    
   1300000   6015           200            200            0.0048861855   0.0021932544   0              0.012465302    3.4789346e-05  0              3.3597061      1.1965779e-13  0              2.9951569    
   1400000   6015           200            200            0.0048847214   0.0021930883   0              0.012461076    2.2682775e-05  0              2.19054        1.1965779e-13  0              2.9951577    
   1500000   6015           200            200            0.004884562    0.0021930684   0              0.012460618    8.1502578e-07  0              0.078709356    1.1965779e-13  0              2.9951578    
   1600000   6015           200            200            0.0048848163   0.002193098    0              0.012461351    1.0256802e-07  0              0.0099052857   1.1965779e-13  0              2.9951577    
   1700000   6015           200            200            0.0048847471   0.0021930901   0              0.012461151    5.5648561e-08  0              0.0053741397   1.1965779e-13  0              2.9951577    
   1800000   6015           200            200            0.0048847375   0.002193089    0              0.012461123    1.6746759e-09  0              0.00016172822  1.1965779e-13  0              2.9951577    
   1900000   6015           200            200            0.0048847502   0.0021930904   0              0.01246116     2.963669e-10   0              2.8620994e-05  1.1965779e-13  0              2.9951577    
   2000000   6015           200            200            0.004884747    0.0021930901   0              0.012461151    1.3583383e-10  0              1.3117859e-05  1.1965779e-13  0              2.9951577    
   2100000   6015           200            200            0.0048847464   0.00219309     0              0.012461149    3.3646473e-12  0              3.2493355e-07  1.1965779e-13  0              2.9951577    
   2200000   6015           200            200            0.0048847471   0.0021930901   0              0.012461151    8.4133805e-13  0              8.1250406e-08  1.1965779e-13  0              2.9951577    
   2300000   6015           200            200            0.0048847469   0.0021930901   0              0.012461151    3.3004366e-13  0              3.1873255e-08  1.1965779e-13  0              2.9951577    
   2400000   6015           200            200            0.0048847469   0.00219309     0              0.012461151    6.5559423e-15  0              6.3312598e-10  1.1965779e-13  0              2.9951577    
   2500000   6015           200            200            0.0048847469   0.0021930901   0              0.012461151    2.29981e-15    0              2.2209919e-10  1.1965779e-13  0              2.9951577    
   2600000   6015           200            200            0.0048847469   0.0021930901   0              0.012461151    7.8961557e-16  0              7.625542e-11   1.1965779e-13  0              2.9951577    
   2700000   6015           200            200            0.0048847469   0.00219309     0              0.012461151    1.1611285e-17  0              1.1213348e-12  1.1965779e-13  0              2.9951577    
   2800000   6015           200            200            0.0048847469   0.00219309     0              0.012461151    2.2362676e-18  0              2.1596272e-13  1.1965779e-13  0              2.9951577    
   2900000   6015           200            200            0.0048847469   0.00219309     0              0.012461151    7.5145587e-18  0              7.257023e-13   1.1965779e-13  0              2.9951577    
   3000000   6015           200            200            0.0048847469   0.0021930901   0              0.012461151    6.1327279e-18  0              5.9225496e-13  1.1965779e-13  0              2.9951577    
Loop time of 305.019 on 4 procs for 3000000 steps with 2501 atoms

Performance: 8497824.388 ns/day, 0.000 hours/ns, 9835.445 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 11.165     | 42.567     | 73.248     | 466.1 | 13.96
Neigh   | 3.6931     | 3.7631     | 3.8326     |   3.1 |  1.23
Comm    | 19.893     | 39.481     | 84.283     | 414.3 | 12.94
Output  | 0.27261    | 0.27295    | 0.27336    |   0.1 |  0.09
Modify  | 110.57     | 161.68     | 180.1      | 232.1 | 53.01
Other   |            | 57.26      |            |       | 18.77

Nlocal:         625.25 ave         876 max         375 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:           1.75 ave           3 max           1 min
Histogram: 2 0 0 0 0 1 0 0 0 1
Neighs:         349.75 ave         700 max           0 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 1399
Ave neighs/atom = 0.55937625
Neighbor list builds = 164
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 2

#variable lat0 equal 1                    #
variable lat1 equal 3+(100*0.01)+(v_ind*0.01)  # .491+(v_ind*0.001)       # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 500*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.02                                                               
Lattice spacing in x,y,z = 4.02 4.02 4.02

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -3015 ${n1e1} -100 100 -100 100 units box
region box block -3015 3015 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -3015 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -3015 3015 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-3015 -100 -100) to (3015 100 100)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 1500 atoms
  using lattice units in orthogonal box = (-3015 -100 -100) to (3015 100 100)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 1500 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 1001 atoms
  using lattice units in orthogonal box = (-3015 -100 -100) to (3015 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  1500 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  1500 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  1001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  1001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
1500 atoms in group substrate
group slider1 region slider1
1001 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 1001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_2_*.dump id type diameter mass xu yu zu fx fy fz

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 3891 130 130
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 80.85 | 80.86 | 80.87 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   6030           200            200            0              0              0              0              0              0              0              1.1965779e-13  0              6            
    100000   6030           200            200            0.0033697737  -5.3584956e-35  0              0.010109321    584497.95      0              5.6446629e+10  1.1965779e-13  0              3.3270021    
    200000   6030           200            200            0.0011884631  -2.6791906e-35  0              0.0035653892   141434.09      0              1.3658692e+10  1.1965779e-13  0              3.0750895    
    300000   6030           200            200            7.564491e-05  -2.6792195e-35  0              0.00022693473  1189.4029      0              1.1486402e+08  1.1965779e-13  0              3.0455051    
    400000   6030           200            200            0.00034446571  4.1254295e-06  0              0.0010292717   8003.2445      0              7.7289607e+08  1.1965779e-13  0              2.9991307    
    500000   6030           200            200            0.0049720995   0.00098286549  0              0.013933433    1567.0194      0              1.5133152e+08  1.1965779e-13  0              2.9950979    
    600000   6030           200            200            0.0062595236   0.0014833538   0              0.017295217    42.285279      0              4083609.6      1.1965779e-13  0              2.9944478    
    700000   6030           200            200            0.0039636132   0.0011190395   0              0.0107718      6.2294384      0              601594.57      1.1965779e-13  0              2.9956621    
    800000   6030           200            200            0.0045995341   0.0011622383   0              0.012636364    3.5053935      0              338525.81      1.1965779e-13  0              2.9952974    
    900000   6030           200            200            0.0045675232   0.001160685    0              0.012541885    0.41483382     0              40061.681      1.1965779e-13  0              2.9953126    
   1000000   6030           200            200            0.0044999103   0.0011565502   0              0.012343181    0.0086998246   0              840.16679      1.1965779e-13  0              2.9953521    
   1100000   6030           200            200            0.0045406785   0.0011590135   0              0.012463022    0.0013384651   0              129.25938      1.1965779e-13  0              2.9953287    
   1200000   6030           200            200            0.0045279067   0.0011582588   0              0.012425461    0.0010388624   0              100.32589      1.1965779e-13  0              2.9953359    
   1300000   6030           200            200            0.004529269    0.0011583348   0              0.012429472    0.00015343516  0              14.817669      1.1965779e-13  0              2.9953352    
   1400000   6030           200            200            0.0045302588   0.001158396    0              0.012432381    5.3339953e-06  0              0.51511908     1.1965779e-13  0              2.9953346    
   1500000   6030           200            200            0.0045295434   0.0011583529   0              0.012430277    1.842204e-07   0              0.017790687    1.1965779e-13  0              2.995335     
   1600000   6030           200            200            0.0045297943   0.0011583678   0              0.012431015    2.9374251e-07  0              0.028367549    1.1965779e-13  0              2.9953349    
   1700000   6030           200            200            0.004529756    0.0011583656   0              0.012430902    5.4440368e-08  0              0.0052574611   1.1965779e-13  0              2.9953349    
   1800000   6030           200            200            0.0045297428   0.0011583647   0              0.012430864    2.7340503e-09  0              0.000264035    1.1965779e-13  0              2.9953349    
   1900000   6030           200            200            0.004529755    0.0011583655   0              0.0124309      1.1319416e-11  0              1.0931482e-06  1.1965779e-13  0              2.9953349    
   2000000   6030           200            200            0.0045297502   0.0011583652   0              0.012430885    7.8449534e-11  0              7.5760945e-06  1.1965779e-13  0              2.9953349    
   2100000   6030           200            200            0.0045297512   0.0011583653   0              0.012430888    1.8529323e-11  0              1.7894294e-06  1.1965779e-13  0              2.9953349    
   2200000   6030           200            200            0.0045297513   0.0011583653   0              0.012430889    1.2513412e-12  0              1.2084558e-07  1.1965779e-13  0              2.9953349    
   2300000   6030           200            200            0.0045297511   0.0011583653   0              0.012430888    3.9522783e-16  0              3.8168275e-11  1.1965779e-13  0              2.9953349    
   2400000   6030           200            200            0.0045297512   0.0011583653   0              0.012430888    1.9395092e-14  0              1.8730392e-09  1.1965779e-13  0              2.9953349    
   2500000   6030           200            200            0.0045297512   0.0011583653   0              0.012430888    6.0354936e-15  0              5.8286477e-10  1.1965779e-13  0              2.9953349    
   2600000   6030           200            200            0.0045297512   0.0011583653   0              0.012430888    5.2040408e-16  0              5.0256901e-11  1.1965779e-13  0              2.9953349    
   2700000   6030           200            200            0.0045297512   0.0011583653   0              0.012430888    2.8235367e-18  0              2.7267697e-13  1.1965779e-13  0              2.9953349    
   2800000   6030           200            200            0.0045297512   0.0011583653   0              0.012430888    1.0329704e-18  0              9.9756884e-14  1.1965779e-13  0              2.9953349    
   2900000   6030           200            200            0.0045297512   0.0011583653   0              0.012430888    1.5298491e-18  0              1.4774187e-13  1.1965779e-13  0              2.9953349    
   3000000   6030           200            200            0.0045297512   0.0011583653   0              0.012430888    3.8834868e-19  0              3.7503935e-14  1.1965779e-13  0              2.9953349    
Loop time of 303.06 on 4 procs for 3000000 steps with 2501 atoms

Performance: 8552750.731 ns/day, 0.000 hours/ns, 9899.017 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 11.482     | 41.485     | 72.724     | 461.3 | 13.69
Neigh   | 3.7011     | 3.7788     | 3.8559     |   3.4 |  1.25
Comm    | 17.374     | 23.758     | 28.384     |  96.1 |  7.84
Output  | 0.27359    | 0.27392    | 0.27427    |   0.1 |  0.09
Modify  | 175.46     | 176.89     | 178.21     |   7.4 | 58.37
Other   |            | 56.88      |            |       | 18.77

Nlocal:         625.25 ave         877 max         374 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:           1.75 ave           3 max           1 min
Histogram: 2 0 0 0 0 1 0 0 0 1
Neighs:         350.75 ave         702 max           0 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 1403
Ave neighs/atom = 0.56097561
Neighbor list builds = 164
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 3

#variable lat0 equal 1                    #
variable lat1 equal 3+(100*0.01)+(v_ind*0.01)  # .491+(v_ind*0.001)       # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 500*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.03                                                               
Lattice spacing in x,y,z = 4.03 4.03 4.03

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -3022.5 ${n1e1} -100 100 -100 100 units box
region box block -3022.5 3022.5 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -3022.5 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -3022.5 3022.5 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-3022.5 -100 -100) to (3022.5 100 100)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 1500 atoms
  using lattice units in orthogonal box = (-3022.5 -100 -100) to (3022.5 100 100)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 1500 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 1001 atoms
  using lattice units in orthogonal box = (-3022.5 -100 -100) to (3022.5 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  1500 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  1500 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  1001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  1001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
1500 atoms in group substrate
group slider1 region slider1
1001 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 1001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_3_*.dump id type diameter mass xu yu zu fx fy fz

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 3900 130 130
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 81.06 | 81.07 | 81.07 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   6045           200            200            0              0              0              0              0              0              0              1.1965779e-13  0              6            
    100000   6045           200            200            0.0033613152   2.6560366e-41  0              0.010083946    584462.75      0              5.6443229e+10  1.1965779e-13  0              3.3271028    
    200000   6045           200            200            0.0011850655  -1.0690397e-34  0              0.0035551966   141345.21      0              1.3650109e+10  1.1965779e-13  0              3.0752695    
    300000   6045           200            200            7.5305757e-05  2.6726231e-35  0              0.00022591727  1184.7807      0              1.1441764e+08  1.1965779e-13  0              3.0455829    
    400000   6045           200            200            0.00039412703 -1.3092948e-05  0              0.0011954741   8172.9776      0              7.8928768e+08  1.1965779e-13  0              2.9990114    
    500000   6045           200            200            0.0060512562   0.00073961385  0              0.017414155    1433.1586      0              1.384042e+08   1.1965779e-13  0              2.994552     
    600000   6045           200            200            0.0040963317   0.00086096386  0              0.011428031    208.6853       0              20153332       1.1965779e-13  0              2.9955427    
    700000   6045           200            200            0.0049637143   0.00056919378  0              0.014321949    2.2524911      0              217529.47      1.1965779e-13  0              2.9950277    
    800000   6045           200            200            0.0042003348   0.00055615851  0              0.012044846    2.8757042      0              277714.93      1.1965779e-13  0              2.9954432    
    900000   6045           200            200            0.0042580794   0.00056841907  0              0.012205819    0.23795027     0              22979.534      1.1965779e-13  0              2.9954102    
   1000000   6045           200            200            0.0043501461   0.00057198062  0              0.012478458    0.023368952    0              2256.8061      1.1965779e-13  0              2.9953593    
   1100000   6045           200            200            0.0043284896   0.00057115668  0              0.012414312    0.0080219223   0              774.69984      1.1965779e-13  0              2.9953716    
   1200000   6045           200            200            0.0043194344   0.00057081949  0              0.012387484    4.5799596e-05  0              4.4229971      1.1965779e-13  0              2.9953765    
   1300000   6045           200            200            0.00432375     0.00057098541  0              0.012400264    0.00017203174  0              16.613594      1.1965779e-13  0              2.9953741    
   1400000   6045           200            200            0.0043243053   0.00057100536  0              0.012401911    1.2348036e-06  0              0.11924849     1.1965779e-13  0              2.9953738    
   1500000   6045           200            200            0.0043236378   0.00057097998  0              0.012399934    2.5492962e-06  0              0.24619278     1.1965779e-13  0              2.9953742    
   1600000   6045           200            200            0.004323666    0.00057098121  0              0.012400017    1.5691881e-07  0              0.015154095    1.1965779e-13  0              2.9953742    
   1700000   6045           200            200            0.0043237516   0.00057098444  0              0.01240027     2.3752747e-08  0              0.0022938703   1.1965779e-13  0              2.9953741    
   1800000   6045           200            200            0.0043237346   0.00057098378  0              0.01240022     5.9565008e-09  0              0.00057523621  1.1965779e-13  0              2.9953741    
   1900000   6045           200            200            0.0043237257   0.00057098344  0              0.012400194    7.8649146e-11  0              7.5953716e-06  1.1965779e-13  0              2.9953741    
   2000000   6045           200            200            0.0043237294   0.00057098359  0              0.012400204    1.3856389e-10  0              1.3381509e-05  1.1965779e-13  0              2.9953741    
   2100000   6045           200            200            0.00432373     0.00057098361  0              0.012400206    3.8516749e-13  0              3.7196719e-08  1.1965779e-13  0              2.9953741    
   2200000   6045           200            200            0.0043237294   0.00057098359  0              0.012400205    2.2244626e-12  0              2.1482267e-07  1.1965779e-13  0              2.9953741    
   2300000   6045           200            200            0.0043237294   0.00057098359  0              0.012400205    9.8317709e-14  0              9.4948206e-09  1.1965779e-13  0              2.9953741    
   2400000   6045           200            200            0.0043237295   0.00057098359  0              0.012400205    2.3273267e-14  0              2.2475656e-09  1.1965779e-13  0              2.9953741    
   2500000   6045           200            200            0.0043237295   0.00057098359  0              0.012400205    4.3662654e-15  0              4.2166266e-10  1.1965779e-13  0              2.9953741    
   2600000   6045           200            200            0.0043237295   0.00057098359  0              0.012400205    9.8677206e-17  0              9.5295382e-12  1.1965779e-13  0              2.9953741    
   2700000   6045           200            200            0.0043237295   0.00057098359  0              0.012400205    1.0791246e-16  0              1.0421413e-11  1.1965779e-13  0              2.9953741    
   2800000   6045           200            200            0.0043237295   0.00057098359  0              0.012400205    4.1531136e-19  0              4.0107799e-14  1.1965779e-13  0              2.9953741    
   2900000   6045           200            200            0.0043237295   0.00057098359  0              0.012400205    3.5058386e-18  0              3.385688e-13   1.1965779e-13  0              2.9953741    
   3000000   6045           200            200            0.0043237295   0.00057098359  0              0.012400205    2.2713182e-19  0              2.1934766e-14  1.1965779e-13  0              2.9953741    
Loop time of 301.193 on 4 procs for 3000000 steps with 2501 atoms

Performance: 8605775.520 ns/day, 0.000 hours/ns, 9960.388 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 11.168     | 40.171     | 69.956     | 454.1 | 13.34
Neigh   | 3.7005     | 3.7746     | 3.8485     |   3.3 |  1.25
Comm    | 18.29      | 38.772     | 80.602     | 393.9 | 12.87
Output  | 0.2732     | 0.27351    | 0.27387    |   0.1 |  0.09
Modify  | 112.45     | 161.06     | 178.03     | 221.2 | 53.47
Other   |            | 57.14      |            |       | 18.97

Nlocal:         625.25 ave         876 max         375 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:           1.75 ave           3 max           1 min
Histogram: 2 0 0 0 0 1 0 0 0 1
Neighs:         346.75 ave         694 max           0 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 1387
Ave neighs/atom = 0.55457817
Neighbor list builds = 164
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 4

#variable lat0 equal 1                    #
variable lat1 equal 3+(100*0.01)+(v_ind*0.01)  # .491+(v_ind*0.001)       # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 500*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.04                                                               
Lattice spacing in x,y,z = 4.04 4.04 4.04

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -3030 ${n1e1} -100 100 -100 100 units box
region box block -3030 3030 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -3030 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -3030 3030 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-3030 -100 -100) to (3030 100 100)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 1500 atoms
  using lattice units in orthogonal box = (-3030 -100 -100) to (3030 100 100)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 1500 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 1001 atoms
  using lattice units in orthogonal box = (-3030 -100 -100) to (3030 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  1500 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  1500 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  1001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  1001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
1500 atoms in group substrate
group slider1 region slider1
1001 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 1001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_4_*.dump id type diameter mass xu yu zu fx fy fz

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 3910 130 130
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 81.14 | 81.17 | 81.2 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   6060           200            200            0              0              0              0              0              0              0              1.1965779e-13  0              6            
    100000   6060           200            200            0.0033522178  -4.1656007e-37  0              0.010056653    584278.9       0              5.6425474e+10  1.1965779e-13  0              3.3271084    
    200000   6060           200            200            0.0011805198  -1.0663892e-34  0              0.0035415593   141052.63      0              1.3621854e+10  1.1965779e-13  0              3.0753235    
    300000   6060           200            200            7.1517403e-05 -1.3329781e-35  0              0.00021455221  1078.3884      0              1.0414303e+08  1.1965779e-13  0              3.0454459    
    400000   6060           200            200            0.00019635656  2.6660068e-35  0              0.00058906968  7162.534       0              6.9170626e+08  1.1965779e-13  0              2.9998962    
    500000   6060           200            200            0.002097685    0.00021399775  0              0.0060790571   1166.0658      0              1.1261028e+08  1.1965779e-13  0              2.996737     
    600000   6060           200            200            0.0058355962   0.0011421705   0              0.016364618    103.57725      0              10002750       1.1965779e-13  0              2.9945396    
    700000   6060           200            200            0.0039909569   0.0012931013   0              0.010679769    5.8250411      0              562540.78      1.1965779e-13  0              2.9955643    
    800000   6060           200            200            0.0047550768   0.0012538361   0              0.013011394    0.71507593     0              69056.915      1.1965779e-13  0              2.9951133    
    900000   6060           200            200            0.0045326029   0.001258869    0              0.01233894     0.50908521     0              49163.806      1.1965779e-13  0              2.9952408    
   1000000   6060           200            200            0.0045173761   0.0012583538   0              0.012293774    0.026911649    0              2598.9345      1.1965779e-13  0              2.9952483    
   1100000   6060           200            200            0.0045538345   0.0012597642   0              0.012401739    0.0011063868   0              106.84691      1.1965779e-13  0              2.995228     
   1200000   6060           200            200            0.0045419286   0.0012592888   0              0.012366497    0.0012170419   0              117.53319      1.1965779e-13  0              2.9952348    
   1300000   6060           200            200            0.0045415748   0.0012592786   0              0.012365446    7.9013538e-05  0              7.630562       1.1965779e-13  0              2.9952349    
   1400000   6060           200            200            0.0045433149   0.0012593463   0              0.012370598    1.6798458e-06  0              0.16222748     1.1965779e-13  0              2.9952339    
   1500000   6060           200            200            0.0045426958   0.0012593217   0              0.012368766    2.8733027e-06  0              0.277483       1.1965779e-13  0              2.9952343    
   1600000   6060           200            200            0.0045426985   0.001259322    0              0.012368774    2.255741e-07   0              0.021784332    1.1965779e-13  0              2.9952343    
   1700000   6060           200            200            0.0045427809   0.0012593252   0              0.012369018    2.1602539e-09  0              0.00020862186  1.1965779e-13  0              2.9952342    
   1800000   6060           200            200            0.004542749    0.0012593239   0              0.012368923    6.6977293e-09  0              0.00064681876  1.1965779e-13  0              2.9952343    
   1900000   6060           200            200            0.0045427501   0.001259324    0              0.012368926    6.3005074e-10  0              6.0845791e-05  1.1965779e-13  0              2.9952343    
   2000000   6060           200            200            0.004542754    0.0012593241   0              0.012368938    1.9941848e-12  0              1.925841e-07   1.1965779e-13  0              2.9952343    
   2100000   6060           200            200            0.0045427523   0.0012593241   0              0.012368933    1.5403073e-11  0              1.4875185e-06  1.1965779e-13  0              2.9952343    
   2200000   6060           200            200            0.0045427524   0.0012593241   0              0.012368933    1.7262275e-12  0              1.667067e-07   1.1965779e-13  0              2.9952343    
   2300000   6060           200            200            0.0045427526   0.0012593241   0              0.012368934    6.2374412e-16  0              6.0236742e-11  1.1965779e-13  0              2.9952343    
   2400000   6060           200            200            0.0045427525   0.0012593241   0              0.012368934    3.4786552e-14  0              3.3594362e-09  1.1965779e-13  0              2.9952343    
   2500000   6060           200            200            0.0045427525   0.0012593241   0              0.012368934    4.6442973e-15  0              4.4851299e-10  1.1965779e-13  0              2.9952343    
   2600000   6060           200            200            0.0045427526   0.0012593241   0              0.012368934    3.0617989e-18  0              2.9568663e-13  1.1965779e-13  0              2.9952343    
   2700000   6060           200            200            0.0045427525   0.0012593241   0              0.012368934    7.4188088e-17  0              7.1645546e-12  1.1965779e-13  0              2.9952343    
   2800000   6060           200            200            0.0045427525   0.0012593241   0              0.012368934    7.7006516e-18  0              7.4367381e-13  1.1965779e-13  0              2.9952343    
   2900000   6060           200            200            0.0045427525   0.0012593241   0              0.012368934    1.249414e-20   0              1.2065946e-15  1.1965779e-13  0              2.9952343    
   3000000   6060           200            200            0.0045427525   0.0012593241   0              0.012368934    1.3934374e-18  0              1.3456821e-13  1.1965779e-13  0              2.9952343    
Loop time of 304.772 on 4 procs for 3000000 steps with 2501 atoms

Performance: 8504716.198 ns/day, 0.000 hours/ns, 9843.422 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 11.131     | 41.366     | 70.923     | 454.1 | 13.57
Neigh   | 3.7197     | 3.7928     | 3.8645     |   3.2 |  1.24
Comm    | 19.912     | 39.052     | 81.136     | 392.4 | 12.81
Output  | 0.27433    | 0.27464    | 0.27501    |   0.1 |  0.09
Modify  | 113.45     | 163.1      | 181.29     | 224.7 | 53.52
Other   |            | 57.19      |            |       | 18.76

Nlocal:         625.25 ave         876 max         375 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:           1.75 ave           3 max           1 min
Histogram: 2 0 0 0 0 1 0 0 0 1
Neighs:         346.75 ave         694 max           0 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 1387
Ave neighs/atom = 0.55457817
Neighbor list builds = 164
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 5

#variable lat0 equal 1                    #
variable lat1 equal 3+(100*0.01)+(v_ind*0.01)  # .491+(v_ind*0.001)       # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 500*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.05                                                               
Lattice spacing in x,y,z = 4.05 4.05 4.05

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -3037.5 ${n1e1} -100 100 -100 100 units box
region box block -3037.5 3037.5 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -3037.5 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -3037.5 3037.5 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-3037.5 -100 -100) to (3037.5 100 100)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 1500 atoms
  using lattice units in orthogonal box = (-3037.5 -100 -100) to (3037.5 100 100)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 1500 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 1001 atoms
  using lattice units in orthogonal box = (-3037.5 -100 -100) to (3037.5 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  1500 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  1500 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  1001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  1001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
1500 atoms in group substrate
group slider1 region slider1
1001 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 1001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_5_*.dump id type diameter mass xu yu zu fx fy fz

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 3920 130 130
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 81.34 | 81.35 | 81.35 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   6075           200            200            0              0              0              0              0              0              0              1.1965779e-13  0              6            
    100000   6075           200            200            0.0033442778  -1.3296977e-34  0              0.010032834    584362.95      0              5.6433591e+10  1.1965779e-13  0              3.3270726    
    200000   6075           200            200            0.0011786494   1.9945538e-35  0              0.0035359482   141246.5       0              1.3640576e+10  1.1965779e-13  0              3.0752046    
    300000   6075           200            200            6.9739308e-05  3.4465904e-40  0              0.00020921792  1032.3236      0              99694426       1.1965779e-13  0              3.0455885    
    400000   6075           200            200            0.00058948987 -1.0637588e-34  0              0.0017684696   8215.8583      0              7.9342878e+08  1.1965779e-13  0              2.9988414    
    500000   6075           200            200            0.0070434418   0.0010244668   0              0.020105858    1289.9985      0              1.2457883e+08  1.1965779e-13  0              2.9939621    
    600000   6075           200            200            0.0039493756   0.0003074147   0              0.011540712    222.74004      0              21510639       1.1965779e-13  0              2.9952229    
    700000   6075           200            200            0.0035857108   0.00033239055  0              0.010424742    3.3938855      0              327757.17      1.1965779e-13  0              2.9954069    
    800000   6075           200            200            0.0040100678   0.00044254106  0              0.011587662    0.085079331    0              8216.3528      1.1965779e-13  0              2.995198     
    900000   6075           200            200            0.0041842027   0.00045246227  0              0.012100146    0.15383017     0              14855.817      1.1965779e-13  0              2.9951108    
   1000000   6075           200            200            0.0042449965   0.00045555303  0              0.012279437    0.049446267    0              4775.1666      1.1965779e-13  0              2.995081     
   1100000   6075           200            200            0.0042623077   0.00045639452  0              0.012330529    0.00936243     0              904.15648      1.1965779e-13  0              2.9950726    
   1200000   6075           200            200            0.0042657624   0.00045655713  0              0.01234073     0.0012391653   0              119.66971      1.1965779e-13  0              2.995071     
   1300000   6075           200            200            0.004265757    0.00045655435  0              0.012340717    0.00011396468  0              11.005893      1.1965779e-13  0              2.995071     
   1400000   6075           200            200            0.0042652883   0.0004565306   0              0.012339334    5.9964437e-06  0              0.57909361     1.1965779e-13  0              2.9950713    
   1500000   6075           200            200            0.0042649733   0.00045651498  0              0.012338405    4.4663963e-08  0              0.0043133259   1.1965779e-13  0              2.9950714    
   1600000   6075           200            200            0.0042648243   0.00045650765  0              0.012337965    3.5175987e-08  0              0.003397045    1.1965779e-13  0              2.9950715    
   1700000   6075           200            200            0.0042647663   0.00045650483  0              0.012337794    2.3969503e-08  0              0.002314803    1.1965779e-13  0              2.9950715    
   1800000   6075           200            200            0.0042647473   0.00045650391  0              0.012337738    6.2454047e-09  0              0.00060313648  1.1965779e-13  0              2.9950715    
   1900000   6075           200            200            0.0042647424   0.00045650367  0              0.012337723    1.0483678e-09  0              0.00010124386  1.1965779e-13  0              2.9950715    
   2000000   6075           200            200            0.0042647416   0.00045650363  0              0.012337721    1.2463671e-10  0              1.2036521e-05  1.1965779e-13  0              2.9950715    
   2100000   6075           200            200            0.0042647417   0.00045650364  0              0.012337722    9.9736594e-12  0              9.6318463e-07  1.1965779e-13  0              2.9950715    
   2200000   6075           200            200            0.0042647419   0.00045650365  0              0.012337722    3.8870957e-13  0              3.7538788e-08  1.1965779e-13  0              2.9950715    
   2300000   6075           200            200            0.004264742    0.00045650366  0              0.012337722    2.6165126e-17  0              2.5268406e-12  1.1965779e-13  0              2.9950715    
   2400000   6075           200            200            0.0042647421   0.00045650366  0              0.012337723    7.8097356e-15  0              7.5420836e-10  1.1965779e-13  0              2.9950715    
   2500000   6075           200            200            0.0042647421   0.00045650366  0              0.012337723    3.4995898e-15  0              3.3796533e-10  1.1965779e-13  0              2.9950715    
   2600000   6075           200            200            0.0042647421   0.00045650366  0              0.012337723    7.8222128e-16  0              7.5541332e-11  1.1965779e-13  0              2.9950715    
   2700000   6075           200            200            0.0042647421   0.00045650366  0              0.012337723    1.0938824e-16  0              1.0563933e-11  1.1965779e-13  0              2.9950715    
   2800000   6075           200            200            0.0042647421   0.00045650366  0              0.012337723    1.4564495e-17  0              1.4065347e-12  1.1965779e-13  0              2.9950715    
   2900000   6075           200            200            0.0042647421   0.00045650366  0              0.012337723    3.1579879e-18  0              3.0497587e-13  1.1965779e-13  0              2.9950715    
   3000000   6075           200            200            0.0042647421   0.00045650366  0              0.012337723    3.630161e-18   0              3.5057496e-13  1.1965779e-13  0              2.9950715    
Loop time of 305.57 on 4 procs for 3000000 steps with 2501 atoms

Performance: 8482518.582 ns/day, 0.000 hours/ns, 9817.730 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 11.179     | 41.345     | 73.569     | 466.1 | 13.53
Neigh   | 3.7218     | 3.796      | 3.87       |   3.3 |  1.24
Comm    | 18.352     | 39.528     | 81.65      | 394.9 | 12.94
Output  | 0.27468    | 0.27504    | 0.27541    |   0.1 |  0.09
Modify  | 114.96     | 163.11     | 179.45     | 217.7 | 53.38
Other   |            | 57.52      |            |       | 18.82

Nlocal:         625.25 ave         876 max         375 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:           1.75 ave           3 max           1 min
Histogram: 2 0 0 0 0 1 0 0 0 1
Neighs:         351.75 ave         704 max           0 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 1407
Ave neighs/atom = 0.56257497
Neighbor list builds = 164
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 6

#variable lat0 equal 1                    #
variable lat1 equal 3+(100*0.01)+(v_ind*0.01)  # .491+(v_ind*0.001)       # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 500*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.06                                                               
Lattice spacing in x,y,z = 4.06 4.06 4.06

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -3045 ${n1e1} -100 100 -100 100 units box
region box block -3045 3045 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -3045 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -3045 3045 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-3045 -100 -100) to (3045 100 100)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 1500 atoms
  using lattice units in orthogonal box = (-3045 -100 -100) to (3045 100 100)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 1500 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 1001 atoms
  using lattice units in orthogonal box = (-3045 -100 -100) to (3045 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  1500 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  1500 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  1001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  1001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
1500 atoms in group substrate
group slider1 region slider1
1001 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 1001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_6_*.dump id type diameter mass xu yu zu fx fy fz

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 3930 130 130
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 81.49 | 81.52 | 81.55 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   6090           200            200            0              0              0              0              0              0              0              1.1965779e-13  0              6            
    100000   6090           200            200            0.003336073   -1.3264164e-35  0              0.010008219    584360.88      0              5.6433392e+10  1.1965779e-13  0              3.3271512    
    200000   6090           200            200            0.0011754197  -4.9740972e-36  0              0.003526259    141180.25      0              1.3634178e+10  1.1965779e-13  0              3.0753597    
    300000   6090           200            200            7.3182051e-05 -5.305488e-35   0              0.00021954615  1137.6783      0              1.0986882e+08  1.1965779e-13  0              3.0455465    
    400000   6090           200            200            0.00031385451  1.6756193e-05  0              0.00092480733  7888.2464      0              7.6179038e+08  1.1965779e-13  0              2.9992531    
    500000   6090           200            200            0.0040788839  -0.0007224254   0              0.012959077    1586.1427      0              1.5317831e+08  1.1965779e-13  0              2.9952484    
    600000   6090           200            200            0.0045676934  -0.0017842421   0              0.015487322    140.62636      0              13580687       1.1965779e-13  0              2.9947396    
    700000   6090           200            200            0.0042219527   0.00010854935  0              0.012557309    28.380388      0              2740774.8      1.1965779e-13  0              2.9952813    
    800000   6090           200            200            0.0038956305   7.7433313e-05  0              0.011609458    0.047413897    0              4578.8948      1.1965779e-13  0              2.9954555    
    900000   6090           200            200            0.004128475    2.4486802e-06  0              0.012382976    0.47495786     0              45868.03       1.1965779e-13  0              2.995307     
   1000000   6090           200            200            0.0041318192   2.0781808e-06  0              0.012393379    0.015158544    0              1463.9037      1.1965779e-13  0              2.995306     
   1100000   6090           200            200            0.0040988939   9.6555372e-06  0              0.012287026    0.0058721045   0              567.08582      1.1965779e-13  0              2.995326     
   1200000   6090           200            200            0.004102799    8.6895344e-06  0              0.012299708    0.0007089221   0              68.462622      1.1965779e-13  0              2.9953235    
   1300000   6090           200            200            0.0041067192   7.7846283e-06  0              0.012312373    4.6831975e-05  0              4.5226969      1.1965779e-13  0              2.9953211    
   1400000   6090           200            200            0.0041056789   8.0325696e-06  0              0.012309004    2.0127797e-05  0              1.9437986      1.1965779e-13  0              2.9953217    
   1500000   6090           200            200            0.0041052867   8.1219542e-06  0              0.012307738    1.119299e-07   0              0.010809389    1.1965779e-13  0              2.995322     
   1600000   6090           200            200            0.0041054783   8.0767917e-06  0              0.012308358    4.2070795e-07  0              0.040628963    1.1965779e-13  0              2.9953219    
   1700000   6090           200            200            0.0041055061   8.0706599e-06  0              0.012308448    1.5917856e-09  0              0.00015372326  1.1965779e-13  0              2.9953218    
   1800000   6090           200            200            0.0041054766   8.0775509e-06  0              0.012308352    6.7581022e-09  0              0.00065264914  1.1965779e-13  0              2.9953219    
   1900000   6090           200            200            0.0041054768   8.0774745e-06  0              0.012308353    2.6086461e-10  0              2.5192437e-05  1.1965779e-13  0              2.9953219    
   2000000   6090           200            200            0.0041054807   8.0765556e-06  0              0.012308366    8.0366457e-11  0              7.7612172e-06  1.1965779e-13  0              2.9953219    
   2100000   6090           200            200            0.0041054802   8.0766863e-06  0              0.012308364    1.1235087e-11  0              1.0850043e-06  1.1965779e-13  0              2.9953219    
   2200000   6090           200            200            0.0041054797   8.0767931e-06  0              0.012308362    5.9210732e-13  0              5.7181486e-08  1.1965779e-13  0              2.9953219    
   2300000   6090           200            200            0.0041054798   8.0767616e-06  0              0.012308363    3.0579731e-13  0              2.9531715e-08  1.1965779e-13  0              2.9953219    
   2400000   6090           200            200            0.0041054799   8.0767514e-06  0              0.012308363    9.6881457e-16  0              9.3561176e-11  1.1965779e-13  0              2.9953219    
   2500000   6090           200            200            0.0041054799   8.0767569e-06  0              0.012308363    6.1866486e-15  0              5.9746224e-10  1.1965779e-13  0              2.9953219    
   2600000   6090           200            200            0.0041054799   8.0767577e-06  0              0.012308363    4.5252425e-17  0              4.3701553e-12  1.1965779e-13  0              2.9953219    
   2700000   6090           200            200            0.0041054799   8.0767568e-06  0              0.012308363    9.3474028e-17  0              9.0270526e-12  1.1965779e-13  0              2.9953219    
   2800000   6090           200            200            0.0041054799   8.0767571e-06  0              0.012308363    9.6864203e-19  0              9.3544514e-14  1.1965779e-13  0              2.9953219    
   2900000   6090           200            200            0.0041054799   8.0767569e-06  0              0.012308363    7.8230288e-18  0              7.5549213e-13  1.1965779e-13  0              2.9953219    
   3000000   6090           200            200            0.0041054799   8.0767597e-06  0              0.012308363    1.2974788e-18  0              1.2530121e-13  1.1965779e-13  0              2.9953219    
Loop time of 303.51 on 4 procs for 3000000 steps with 2501 atoms

Performance: 8540078.803 ns/day, 0.000 hours/ns, 9884.350 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 11.361     | 39.428     | 67.679     | 444.2 | 12.99
Neigh   | 3.7299     | 3.8019     | 3.8739     |   3.2 |  1.25
Comm    | 17.076     | 24.494     | 31.047     | 116.4 |  8.07
Output  | 0.27434    | 0.27466    | 0.27504    |   0.1 |  0.09
Modify  | 175        | 177.73     | 181.16     |  16.7 | 58.56
Other   |            | 57.79      |            |       | 19.04

Nlocal:         625.25 ave         876 max         374 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:           1.75 ave           2 max           1 min
Histogram: 1 0 0 0 0 0 0 0 0 3
Neighs:         347.25 ave         695 max           0 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 1389
Ave neighs/atom = 0.55537785
Neighbor list builds = 164
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 7

#variable lat0 equal 1                    #
variable lat1 equal 3+(100*0.01)+(v_ind*0.01)  # .491+(v_ind*0.001)       # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 500*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.07                                                               
Lattice spacing in x,y,z = 4.07 4.07 4.07

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -3052.5 ${n1e1} -100 100 -100 100 units box
region box block -3052.5 3052.5 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -3052.5 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -3052.5 3052.5 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-3052.5 -100 -100) to (3052.5 100 100)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 1500 atoms
  using lattice units in orthogonal box = (-3052.5 -100 -100) to (3052.5 100 100)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 1500 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 1001 atoms
  using lattice units in orthogonal box = (-3052.5 -100 -100) to (3052.5 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  1500 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  1500 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  1001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  1001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
1500 atoms in group substrate
group slider1 region slider1
1001 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 1001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_7_*.dump id type diameter mass xu yu zu fx fy fz

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 3939 130 130
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 81.69 | 81.69 | 81.7 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   6105           200            200            0              0              0              0              0              0              0              1.1965779e-13  0              6            
    100000   6105           200            200            0.0033273538   1.0585348e-34  0              0.0099820614   584234.88      0              5.6421223e+10  1.1965779e-13  0              3.3271673    
    200000   6105           200            200            0.0011713737   1.3231734e-35  0              0.0035141211   140967.17      0              1.36136e+10    1.1965779e-13  0              3.0754301    
    300000   6105           200            200            7.0505885e-05  2.6463589e-35  0              0.00021151766  1064.302       0              1.0278267e+08  1.1965779e-13  0              3.0454695    
    400000   6105           200            200            0.00019113165  1.3231831e-35  0              0.00057339494  7074.7758      0              6.8323121e+08  1.1965779e-13  0              3            
    500000   6105           200            200            0.0012470281  -0.0017073355   0              0.0054484198   1074.941       0              1.0381011e+08  1.1965779e-13  0              2.9969157    
    600000   6105           200            200            0.0045505499  -0.001604666    0              0.015256316    148.79404      0              14369463       1.1965779e-13  0              2.9947177    
    700000   6105           200            200            0.0032009143  -0.0023342298   0              0.011936973    27.538243      0              2659446.4      1.1965779e-13  0              2.9953133    
    800000   6105           200            200            0.0032094435  -0.0024703724   0              0.012098703    3.5347597      0              341361.79      1.1965779e-13  0              2.99529      
    900000   6105           200            200            0.003339505   -0.0024368616   0              0.012455377    0.25798248     0              24914.101      1.1965779e-13  0              2.9952173    
   1000000   6105           200            200            0.003246434   -0.0024488106   0              0.012188113    0.004453428    0              430.0802       1.1965779e-13  0              2.9952702    
   1100000   6105           200            200            0.0032892226  -0.0024431784   0              0.012310846    0.00067306724  0              65.000017      1.1965779e-13  0              2.9952461    
   1200000   6105           200            200            0.0032746604  -0.0024450394   0              0.012269021    0.00064743509  0              62.524647      1.1965779e-13  0              2.9952542    
   1300000   6105           200            200            0.0032781262  -0.0024446001   0              0.012278979    0.00015979761  0              15.43211       1.1965779e-13  0              2.9952523    
   1400000   6105           200            200            0.0032778919  -0.0024446258   0              0.012278301    2.1025875e-05  0              2.0305286      1.1965779e-13  0              2.9952524    
   1500000   6105           200            200            0.0032775733  -0.0024446686   0              0.012277388    1.4484959e-06  0              0.13988536     1.1965779e-13  0              2.9952526    
   1600000   6105           200            200            0.0032778069  -0.002444638    0              0.012278059    2.1030526e-08  0              0.0020309777   1.1965779e-13  0              2.9952525    
   1700000   6105           200            200            0.0032777017  -0.0024446516   0              0.012277757    4.9420251e-09  0              0.00047726541  1.1965779e-13  0              2.9952525    
   1800000   6105           200            200            0.0032777369  -0.0024446471   0              0.012277858    4.1128942e-09  0              0.00039719388  1.1965779e-13  0              2.9952525    
   1900000   6105           200            200            0.0032777288  -0.0024446481   0              0.012277834    9.7291009e-10  0              9.3956693e-05  1.1965779e-13  0              2.9952525    
   2000000   6105           200            200            0.0032777292  -0.0024446481   0              0.012277836    1.2394936e-10  0              1.1970142e-05  1.1965779e-13  0              2.9952525    
   2100000   6105           200            200            0.00327773    -0.002444648    0              0.012277838    8.1524659e-12  0              7.8730681e-07  1.1965779e-13  0              2.9952525    
   2200000   6105           200            200            0.0032777295  -0.002444648    0              0.012277836    9.5521963e-14  0              9.2248275e-09  1.1965779e-13  0              2.9952525    
   2300000   6105           200            200            0.0032777297  -0.002444648    0              0.012277837    3.5357209e-14  0              3.4145462e-09  1.1965779e-13  0              2.9952525    
   2400000   6105           200            200            0.0032777296  -0.002444648    0              0.012277837    2.5933628e-14  0              2.5044842e-09  1.1965779e-13  0              2.9952525    
   2500000   6105           200            200            0.0032777296  -0.002444648    0              0.012277837    5.8787219e-15  0              5.6772488e-10  1.1965779e-13  0              2.9952525    
   2600000   6105           200            200            0.0032777296  -0.002444648    0              0.012277837    7.2090797e-16  0              6.9620131e-11  1.1965779e-13  0              2.9952525    
   2700000   6105           200            200            0.0032777296  -0.002444648    0              0.012277837    4.6335225e-17  0              4.4747244e-12  1.1965779e-13  0              2.9952525    
   2800000   6105           200            200            0.0032777296  -0.002444648    0              0.012277837    1.833122e-18   0              1.770298e-13   1.1965779e-13  0              2.9952525    
   2900000   6105           200            200            0.0032777296  -0.002444648    0              0.012277837    4.0690243e-21  0              3.9295724e-16  1.1965779e-13  0              2.9952525    
   3000000   6105           200            200            0.0032777296  -0.002444648    0              0.012277837    1.3562453e-18  0              1.3097646e-13  1.1965779e-13  0              2.9952525    
Loop time of 301.436 on 4 procs for 3000000 steps with 2501 atoms

Performance: 8598834.966 ns/day, 0.000 hours/ns, 9952.355 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 11.25      | 39.85      | 69.047     | 450.3 | 13.22
Neigh   | 3.7385     | 3.8117     | 3.8855     |   3.2 |  1.26
Comm    | 18.533     | 38.767     | 81.835     | 403.6 | 12.86
Output  | 0.27255    | 0.27288    | 0.27325    |   0.1 |  0.09
Modify  | 110.43     | 161.27     | 180.47     | 231.7 | 53.50
Other   |            | 57.47      |            |       | 19.06

Nlocal:         625.25 ave         876 max         375 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:           1.75 ave           3 max           1 min
Histogram: 2 0 0 0 0 1 0 0 0 1
Neighs:         346.75 ave         694 max           0 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 1387
Ave neighs/atom = 0.55457817
Neighbor list builds = 164
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 8

#variable lat0 equal 1                    #
variable lat1 equal 3+(100*0.01)+(v_ind*0.01)  # .491+(v_ind*0.001)       # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 500*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.08                                                               
Lattice spacing in x,y,z = 4.08 4.08 4.08

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -3060 ${n1e1} -100 100 -100 100 units box
region box block -3060 3060 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -3060 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -3060 3060 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-3060 -100 -100) to (3060 100 100)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 1500 atoms
  using lattice units in orthogonal box = (-3060 -100 -100) to (3060 100 100)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 1500 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 1001 atoms
  using lattice units in orthogonal box = (-3060 -100 -100) to (3060 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  1500 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  1500 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  1001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  1001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
1500 atoms in group substrate
group slider1 region slider1
1001 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 1001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_8_*.dump id type diameter mass xu yu zu fx fy fz

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 3949 130 130
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 81.9 | 81.9 | 81.91 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   6120           200            200            0              0              0              0              0              0              0              1.1965779e-13  0              6            
    100000   6120           200            200            0.0033194335   1.6273299e-41  0              0.0099583004   584292.72      0              5.6426809e+10  1.1965779e-13  0              3.3271516    
    200000   6120           200            200            0.001169134    8.2495261e-37  0              0.0035074021   141084.86      0              1.3624966e+10  1.1965779e-13  0              3.075365     
    300000   6120           200            200            7.2706807e-05 -8.2495236e-37  0              0.00021812042  1134.2471      0              1.0953747e+08  1.1965779e-13  0              3.045467     
    400000   6120           200            200            0.00019118533 -3.1678142e-34  0              0.00057355598  7109.9665      0              6.8662967e+08  1.1965779e-13  0              3.0000071    
    500000   6120           200            200            0.0049036156   0.00037643797  0              0.014334409    1608.7707      0              1.5536356e+08  1.1965779e-13  0              2.9950074    
    600000   6120           200            200            0.0041852186   0.00030651679  0              0.012249139    220.7304       0              21316562       1.1965779e-13  0              2.9953397    
    700000   6120           200            200            0.0048094857   0.00040373886  0              0.014024718    6.9854637      0              674606.08      1.1965779e-13  0              2.9950132    
    800000   6120           200            200            0.0039834624   0.00038637307  0              0.011564014    0.53061075     0              51242.589      1.1965779e-13  0              2.995445     
    900000   6120           200            200            0.004244545    0.00039264173  0              0.012340993    0.47282053     0              45661.622      1.1965779e-13  0              2.9953074    
   1000000   6120           200            200            0.0042290939   0.00039233465  0              0.012294947    0.055328872    0              5343.2664      1.1965779e-13  0              2.9953146    
   1100000   6120           200            200            0.0042014078   0.00039168638  0              0.012212537    0.00048953833  0              47.276108      1.1965779e-13  0              2.9953295    
   1200000   6120           200            200            0.0042170262   0.0003920464   0              0.012259032    0.00043615015  0              42.12026       1.1965779e-13  0              2.9953212    
   1300000   6120           200            200            0.0042131363   0.00039195867  0              0.01224745     0.00017354685  0              16.759913      1.1965779e-13  0              2.9953232    
   1400000   6120           200            200            0.0042129293   0.00039195311  0              0.012246835    1.3069251e-05  0              1.2621347      1.1965779e-13  0              2.9953233    
   1500000   6120           200            200            0.0042135546   0.00039196766  0              0.012248696    1.2155183e-10  0              1.1738605e-05  1.1965779e-13  0              2.995323     
   1600000   6120           200            200            0.0042132773   0.00039196131  0              0.012247871    2.4264141e-07  0              0.02343257     1.1965779e-13  0              2.9953232    
   1700000   6120           200            200            0.0042133284   0.00039196245  0              0.012248023    5.7081207e-08  0              0.0055124944   1.1965779e-13  0              2.9953231    
   1800000   6120           200            200            0.0042133408   0.00039196275  0              0.01224806     2.5216871e-09  0              0.00024352649  1.1965779e-13  0              2.9953231    
   1900000   6120           200            200            0.0042133279   0.00039196245  0              0.012248021    5.9133164e-11  0              5.7106577e-06  1.1965779e-13  0              2.9953231    
   2000000   6120           200            200            0.0042133325   0.00039196255  0              0.012248035    1.1067684e-10  0              1.0688377e-05  1.1965779e-13  0              2.9953231    
   2100000   6120           200            200            0.004213332    0.00039196254  0              0.012248033    1.6791526e-11  0              1.6216054e-06  1.1965779e-13  0              2.9953231    
   2200000   6120           200            200            0.0042133316   0.00039196253  0              0.012248032    3.3905895e-13  0              3.2743887e-08  1.1965779e-13  0              2.9953231    
   2300000   6120           200            200            0.0042133319   0.00039196254  0              0.012248033    7.19823e-14    0              6.9515353e-09  1.1965779e-13  0              2.9953231    
   2400000   6120           200            200            0.0042133318   0.00039196254  0              0.012248033    4.3768836e-14  0              4.2268809e-09  1.1965779e-13  0              2.9953231    
   2500000   6120           200            200            0.0042133318   0.00039196254  0              0.012248033    4.3286753e-15  0              4.1803247e-10  1.1965779e-13  0              2.9953231    
   2600000   6120           200            200            0.0042133318   0.00039196254  0              0.012248033    7.0597353e-18  0              6.817787e-13   1.1965779e-13  0              2.9953231    
   2700000   6120           200            200            0.0042133318   0.00039196254  0              0.012248033    5.8090549e-17  0              5.6099694e-12  1.1965779e-13  0              2.9953231    
   2800000   6120           200            200            0.0042133318   0.00039196254  0              0.012248033    1.4455247e-17  0              1.3959843e-12  1.1965779e-13  0              2.9953231    
   2900000   6120           200            200            0.0042133318   0.00039196254  0              0.012248033    2.9862533e-18  0              2.8839097e-13  1.1965779e-13  0              2.9953231    
   3000000   6120           200            200            0.0042133318   0.00039196254  0              0.012248033    1.2392373e-19  0              1.1967667e-14  1.1965779e-13  0              2.9953231    
Loop time of 302.121 on 4 procs for 3000000 steps with 2501 atoms

Performance: 8579343.724 ns/day, 0.000 hours/ns, 9929.796 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 11.126     | 40.074     | 70.101     | 454.4 | 13.26
Neigh   | 3.7604     | 3.8345     | 3.9082     |   3.2 |  1.27
Comm    | 18.198     | 39.383     | 83.532     | 411.1 | 13.04
Output  | 0.27298    | 0.27333    | 0.27371    |   0.1 |  0.09
Modify  | 109.43     | 160.91     | 179.21     | 234.5 | 53.26
Other   |            | 57.65      |            |       | 19.08

Nlocal:         625.25 ave         876 max         375 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:           1.75 ave           3 max           1 min
Histogram: 2 0 0 0 0 1 0 0 0 1
Neighs:         345.75 ave         692 max           0 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 1383
Ave neighs/atom = 0.55297881
Neighbor list builds = 164
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 9

#variable lat0 equal 1                    #
variable lat1 equal 3+(100*0.01)+(v_ind*0.01)  # .491+(v_ind*0.001)       # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 500*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.09                                                               
Lattice spacing in x,y,z = 4.09 4.09 4.09

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -3067.5 ${n1e1} -100 100 -100 100 units box
region box block -3067.5 3067.5 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -3067.5 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -3067.5 3067.5 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-3067.5 -100 -100) to (3067.5 100 100)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 1500 atoms
  using lattice units in orthogonal box = (-3067.5 -100 -100) to (3067.5 100 100)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 1500 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 1001 atoms
  using lattice units in orthogonal box = (-3067.5 -100 -100) to (3067.5 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  1500 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  1500 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  1001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  1001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
1500 atoms in group substrate
group slider1 region slider1
1001 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 1001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_9_*.dump id type diameter mass xu yu zu fx fy fz

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 3959 130 130
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 82.04 | 82.04 | 82.05 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   6135           200            200            0              0              0              0              0              0              0              1.1965779e-13  0              6            
    100000   6135           200            200            0.003311181    2.6334015e-35  0              0.0099335431   584248.9       0              5.6422577e+10  1.1965779e-13  0              3.3272428    
    200000   6135           200            200            0.0011664031  -1.0533479e-34  0              0.0034992094   141109.12      0              1.3627309e+10  1.1965779e-13  0              3.0753428    
    300000   6135           200            200            6.8555673e-05  1.1850278e-34  0              0.00020566702  1017.9741      0              98308648       1.1965779e-13  0              3.0455908    
    400000   6135           200            200            0.00017542072  5.2668593e-35  0              0.00052626216  6102.1186      0              5.8929894e+08  1.1965779e-13  0              3.0011243    
    500000   6135           200            200            0.0008272593  -0.00063114314  0              0.003112921    577.09901      0              55732091       1.1965779e-13  0              2.9978325    
    600000   6135           200            200            0.0044979456   0.0016191491   0              0.011874688    211.72233      0              20446627       1.1965779e-13  0              2.9955138    
    700000   6135           200            200            0.0052460638   0.0020914651   0              0.013646726    12.365579      0              1194179.1      1.1965779e-13  0              2.9951491    
    800000   6135           200            200            0.0045329307   0.002062076    0              0.011536716    0.015864019    0              1532.0334      1.1965779e-13  0              2.9955636    
    900000   6135           200            200            0.0048470935   0.0021019321   0              0.012439348    0.12904984     0              12462.709      1.1965779e-13  0              2.9953846    
   1000000   6135           200            200            0.004754262    0.0020871491   0              0.012175637    0.055304079    0              5340.8721      1.1965779e-13  0              2.9954357    
   1100000   6135           200            200            0.0047681164   0.0020892237   0              0.012215125    0.0092825415   0              896.44142      1.1965779e-13  0              2.9954283    
   1200000   6135           200            200            0.0047720826   0.0020898899   0              0.012226358    0.00075886598  0              73.285845      1.1965779e-13  0              2.9954259    
   1300000   6135           200            200            0.0047677808   0.0020892013   0              0.012214141    1.5634443e-05  0              1.5098626      1.1965779e-13  0              2.9954284    
   1400000   6135           200            200            0.004769893    0.0020895352   0              0.012220144    1.6414997e-06  0              0.15852429     1.1965779e-13  0              2.9954272    
   1500000   6135           200            200            0.0047691736   0.0020894227   0              0.012218098    1.745637e-06   0              0.16858113     1.1965779e-13  0              2.9954276    
   1600000   6135           200            200            0.0047693313   0.0020894469   0              0.012218547    4.0963223e-07  0              0.039559348    1.1965779e-13  0              2.9954275    
   1700000   6135           200            200            0.0047693313   0.0020894471   0              0.012218547    4.6475169e-08  0              0.0044882391   1.1965779e-13  0              2.9954275    
   1800000   6135           200            200            0.0047693101   0.0020894437   0              0.012218486    2.1460435e-09  0              0.00020724952  1.1965779e-13  0              2.9954275    
   1900000   6135           200            200            0.0047693231   0.0020894458   0              0.012218524    3.2238741e-13  0              3.1133869e-08  1.1965779e-13  0              2.9954275    
   2000000   6135           200            200            0.0047693179   0.002089445    0              0.012218509    4.3502566e-11  0              4.2011664e-06  1.1965779e-13  0              2.9954275    
   2100000   6135           200            200            0.0047693194   0.0020894452   0              0.012218513    1.5844232e-11  0              1.5301225e-06  1.1965779e-13  0              2.9954275    
   2200000   6135           200            200            0.0047693192   0.0020894452   0              0.012218512    2.431389e-12   0              2.3480614e-07  1.1965779e-13  0              2.9954275    
   2300000   6135           200            200            0.0047693191   0.0020894452   0              0.012218512    1.7878675e-13  0              1.7265945e-08  1.1965779e-13  0              2.9954275    
   2400000   6135           200            200            0.0047693192   0.0020894452   0              0.012218512    2.4090504e-15  0              2.3264885e-10  1.1965779e-13  0              2.9954275    
   2500000   6135           200            200            0.0047693191   0.0020894452   0              0.012218512    7.242154e-16   0              6.993954e-11   1.1965779e-13  0              2.9954275    
   2600000   6135           200            200            0.0047693192   0.0020894452   0              0.012218512    5.3992277e-16  0              5.2141877e-11  1.1965779e-13  0              2.9954275    
   2700000   6135           200            200            0.0047693192   0.0020894452   0              0.012218512    1.0930882e-16  0              1.0556263e-11  1.1965779e-13  0              2.9954275    
   2800000   6135           200            200            0.0047693192   0.0020894452   0              0.012218512    1.3225785e-17  0              1.2772517e-12  1.1965779e-13  0              2.9954275    
   2900000   6135           200            200            0.0047693192   0.0020894452   0              0.012218512    1.2957416e-18  0              1.2513345e-13  1.1965779e-13  0              2.9954275    
   3000000   6135           200            200            0.0047693192   0.0020894452   0              0.012218512    2.352562e-18   0              2.271936e-13   1.1965779e-13  0              2.9954275    
Loop time of 302.31 on 4 procs for 3000000 steps with 2501 atoms

Performance: 8573978.851 ns/day, 0.000 hours/ns, 9923.587 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 11.602     | 39.502     | 67.708     | 442.5 | 13.07
Neigh   | 3.7403     | 3.8108     | 3.881      |   3.1 |  1.26
Comm    | 18.515     | 38.308     | 79.868     | 392.3 | 12.67
Output  | 0.27125    | 0.27159    | 0.27197    |   0.1 |  0.09
Modify  | 110.96     | 161.31     | 183.16     | 230.4 | 53.36
Other   |            | 59.11      |            |       | 19.55

Nlocal:         625.25 ave         876 max         375 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:           1.75 ave           3 max           1 min
Histogram: 2 0 0 0 0 1 0 0 0 1
Neighs:         345.25 ave         691 max           0 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 1381
Ave neighs/atom = 0.55217913
Neighbor list builds = 164
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 10

#variable lat0 equal 1                    #
variable lat1 equal 3+(100*0.01)+(v_ind*0.01)  # .491+(v_ind*0.001)       # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 500*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.1                                                               
Lattice spacing in x,y,z = 4.1 4.1 4.1

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -3075 ${n1e1} -100 100 -100 100 units box
region box block -3075 3075 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -3075 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -3075 3075 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-3075 -100 -100) to (3075 100 100)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 1500 atoms
  using lattice units in orthogonal box = (-3075 -100 -100) to (3075 100 100)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 1500 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 1001 atoms
  using lattice units in orthogonal box = (-3075 -100 -100) to (3075 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  1500 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  1500 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  1001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  1001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
1500 atoms in group substrate
group slider1 region slider1
1001 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 1001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_10_*.dump id type diameter mass xu yu zu fx fy fz

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 3968 130 130
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 82.18 | 82.18 | 82.19 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   6150           200            200            0              0              0              0              0              0              0              1.1965779e-13  0              6            
    100000   6150           200            200            0.0033027393  -7.8808824e-35  0              0.0099082179   584158.97      0              5.6413892e+10  1.1965779e-13  0              3.3272629    
    200000   6150           200            200            0.0011621346   5.2541248e-35  0              0.0034864038   140838.33      0              1.3601158e+10  1.1965779e-13  0              3.0755799    
    300000   6150           200            200            6.8407554e-05  2.6270387e-35  0              0.00020522266  1018.5612      0              98365352       1.1965779e-13  0              3.0455235    
    400000   6150           200            200            0.00020694325  9.9831654e-17  0              0.00062082975  7255.5762      0              7.0069162e+08  1.1965779e-13  0              2.999828     
    500000   6150           200            200            0.0013919605  -0.00017193065  0              0.004347812    914.20653      0              88287523       1.1965779e-13  0              2.9972355    
    600000   6150           200            200            0.0035258838  -0.00083048609  0              0.011408137    204.35535      0              19735177       1.1965779e-13  0              2.9955195    
    700000   6150           200            200            0.0043418651  -0.0010454036   0              0.014070999    0.12750274     0              12313.302      1.1965779e-13  0              2.9949772    
    800000   6150           200            200            0.0036322256  -0.0010138791   0              0.011910556    3.1990565      0              308941.98      1.1965779e-13  0              2.9953972    
    900000   6150           200            200            0.0036647454  -0.0010153482   0              0.012009584    0.24631717     0              23787.549      1.1965779e-13  0              2.9953801    
   1000000   6150           200            200            0.0037506904  -0.0010198021   0              0.012271873    0.012657559    0              1222.3765      1.1965779e-13  0              2.9953272    
   1100000   6150           200            200            0.0037240704  -0.0010184783   0              0.01219069     0.0092838775   0              896.57044      1.1965779e-13  0              2.9953432    
   1200000   6150           200            200            0.0037194271  -0.0010182305   0              0.012176512    0.00010000466  0              9.6577346      1.1965779e-13  0              2.9953461    
   1300000   6150           200            200            0.003724226   -0.001018475    0              0.012191153    0.00010772979  0              10.403772      1.1965779e-13  0              2.9953432    
   1400000   6150           200            200            0.0037235993  -0.0010184446   0              0.012189243    1.647293e-05   0              1.5908376      1.1965779e-13  0              2.9953436    
   1500000   6150           200            200            0.0037231159  -0.0010184196   0              0.012187767    1.1529307e-07  0              0.011134179    1.1965779e-13  0              2.9953439    
   1600000   6150           200            200            0.0037233266  -0.0010184302   0              0.01218841     4.0434214e-07  0              0.03904847     1.1965779e-13  0              2.9953437    
   1700000   6150           200            200            0.0037233368  -0.0010184308   0              0.012188441    1.4463227e-08  0              0.001396755    1.1965779e-13  0              2.9953437    
   1800000   6150           200            200            0.0037233057  -0.0010184292   0              0.012188346    2.9517085e-09  0              0.00028505487  1.1965779e-13  0              2.9953437    
   1900000   6150           200            200            0.0037233125  -0.0010184295   0              0.012188367    9.2424599e-10  0              8.9257062e-05  1.1965779e-13  0              2.9953437    
   2000000   6150           200            200            0.0037233149  -0.0010184297   0              0.012188374    3.7593042e-13  0              3.6304669e-08  1.1965779e-13  0              2.9953437    
   2100000   6150           200            200            0.0037233133  -0.0010184296   0              0.01218837     1.5515526e-11  0              1.4983785e-06  1.1965779e-13  0              2.9953437    
   2200000   6150           200            200            0.0037233134  -0.0010184296   0              0.01218837     1.2349653e-12  0              1.1926411e-07  1.1965779e-13  0              2.9953437    
   2300000   6150           200            200            0.0037233136  -0.0010184296   0              0.01218837     5.770749e-14   0              5.5729763e-09  1.1965779e-13  0              2.9953437    
   2400000   6150           200            200            0.0037233135  -0.0010184296   0              0.01218837     4.5301609e-14  0              4.3749051e-09  1.1965779e-13  0              2.9953437    
   2500000   6150           200            200            0.0037233135  -0.0010184296   0              0.01218837     4.6415653e-16  0              4.4824916e-11  1.1965779e-13  0              2.9953437    
   2600000   6150           200            200            0.0037233135  -0.0010184296   0              0.01218837     5.3391902e-16  0              5.1562077e-11  1.1965779e-13  0              2.9953437    
   2700000   6150           200            200            0.0037233135  -0.0010184296   0              0.01218837     7.7468132e-17  0              7.4813177e-12  1.1965779e-13  0              2.9953437    
   2800000   6150           200            200            0.0037233135  -0.0010184296   0              0.01218837     2.3738805e-20  0              2.2925238e-15  1.1965779e-13  0              2.9953437    
   2900000   6150           200            200            0.0037233135  -0.0010184296   0              0.01218837     1.0423498e-18  0              1.0066268e-13  1.1965779e-13  0              2.9953437    
   3000000   6150           200            200            0.0037233135  -0.0010184296   0              0.01218837     4.1213336e-19  0              3.980089e-14   1.1965779e-13  0              2.9953437    
Loop time of 302.156 on 4 procs for 3000000 steps with 2501 atoms

Performance: 8578341.073 ns/day, 0.000 hours/ns, 9928.636 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 11.344     | 39.977     | 71.044     | 451.0 | 13.23
Neigh   | 3.72       | 3.7934     | 3.8678     |   3.3 |  1.26
Comm    | 17.706     | 24.294     | 30.527     | 105.5 |  8.04
Output  | 0.27318    | 0.27351    | 0.2739     |   0.1 |  0.09
Modify  | 174.6      | 176.94     | 178.56     |  11.6 | 58.56
Other   |            | 56.88      |            |       | 18.83

Nlocal:         625.25 ave         877 max         374 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:           1.75 ave           3 max           1 min
Histogram: 2 0 0 0 0 1 0 0 0 1
Neighs:         341.75 ave         684 max           0 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 1367
Ave neighs/atom = 0.54658137
Neighbor list builds = 164
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 11

#variable lat0 equal 1                    #
variable lat1 equal 3+(100*0.01)+(v_ind*0.01)  # .491+(v_ind*0.001)       # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 500*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.11                                                               
Lattice spacing in x,y,z = 4.11 4.11 4.11

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -3082.5 ${n1e1} -100 100 -100 100 units box
region box block -3082.5 3082.5 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -3082.5 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -3082.5 3082.5 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-3082.5 -100 -100) to (3082.5 100 100)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 1499 atoms
  using lattice units in orthogonal box = (-3082.5 -100 -100) to (3082.5 100 100)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 1500 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 1001 atoms
  using lattice units in orthogonal box = (-3082.5 -100 -100) to (3082.5 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  1499 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  1499 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  1001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  1001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
1499 atoms in group substrate
group slider1 region slider1
1001 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 1001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_11_*.dump id type diameter mass xu yu zu fx fy fz

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 3978 130 130
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 82.33 | 82.36 | 82.38 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   6165           200            200            0              0              0              0              0              0              0              1.1965779e-13  0              6            
    100000   6165           200            200            0.0032950578   1.3102917e-35  0              0.0098851734   584250.5       0              5.6535803e+10  1.1965779e-13  0              3.3272096    
    200000   6165           200            200            0.0011603479   4.7523727e-40  0              0.0034810437   141036.14      0              1.3647556e+10  1.1965779e-13  0              3.07542      
    300000   6165           200            200            7.1406274e-05 -5.2410224e-35  0              0.00021421882  1111.1667      0              1.0752357e+08  1.1965779e-13  0              3.0454747    
    400000   6165           200            200            0.00024303767 -4.7039522e-09  0              0.00072911771  7592.7553      0              7.3472341e+08  1.1965779e-13  0              2.9994845    
    500000   6165           200            200            0.0031342626   0.00026000227  0              0.0091427855   1493.3332      0              1.4450444e+08  1.1965779e-13  0              2.9959315    
    600000   6165           200            200            0.0063297186   0.0013477303   0              0.017641426    0.69940302     0              67678.695      1.1965779e-13  0              2.9942796    
    700000   6165           200            200            0.0036996924   0.00073443782  0              0.010364639    1.5000782      0              145157.13      1.1965779e-13  0              2.9956154    
    800000   6165           200            200            0.0045384265   0.00092732742  0              0.012687952    1.5810656      0              152993.99      1.1965779e-13  0              2.9951501    
    900000   6165           200            200            0.0043238673   0.00090623401  0              0.012065368    0.44398731     0              42963.043      1.1965779e-13  0              2.9952724    
   1000000   6165           200            200            0.0043518377   0.00090930217  0              0.012146211    0.068581393    0              6636.3728      1.1965779e-13  0              2.9952555    
   1100000   6165           200            200            0.0043629784   0.00091035813  0              0.012178577    0.0061892015   0              598.90659      1.1965779e-13  0              2.9952496    
   1200000   6165           200            200            0.0043520752   0.00090927411  0              0.012146951    0.00023416554  0              22.659351      1.1965779e-13  0              2.9952557    
   1300000   6165           200            200            0.0043575956   0.00090983089  0              0.012162956    5.6971393e-07  0              0.055129152    1.1965779e-13  0              2.9952526    
   1400000   6165           200            200            0.0043555132   0.00090961924  0              0.01215692     6.4968776e-06  0              0.62867929     1.1965779e-13  0              2.9952538    
   1500000   6165           200            200            0.004356109    0.00090968048  0              0.012158646    2.3670331e-06  0              0.22904922     1.1965779e-13  0              2.9952534    
   1600000   6165           200            200            0.0043560063   0.00090966962  0              0.012158349    4.1785799e-07  0              0.040434603    1.1965779e-13  0              2.9952535    
   1700000   6165           200            200            0.004355992    0.00090966836  0              0.012158308    4.3500415e-08  0              0.0042093775   1.1965779e-13  0              2.9952535    
   1800000   6165           200            200            0.0043560151   0.00090967063  0              0.012158375    2.2156296e-09  0              0.00021439844  1.1965779e-13  0              2.9952535    
   1900000   6165           200            200            0.0043560022   0.00090966934  0              0.012158337    4.7230109e-12  0              4.5702864e-07  1.1965779e-13  0              2.9952535    
   2000000   6165           200            200            0.0043560074   0.00090966986  0              0.012158352    2.4474533e-11  0              2.3683118e-06  1.1965779e-13  0              2.9952535    
   2100000   6165           200            200            0.0043560058   0.0009096697   0              0.012158348    1.2085601e-11  0              1.1694798e-06  1.1965779e-13  0              2.9952535    
   2200000   6165           200            200            0.0043560061   0.00090966973  0              0.012158349    2.4647481e-12  0              2.3850474e-07  1.1965779e-13  0              2.9952535    
   2300000   6165           200            200            0.0043560061   0.00090966973  0              0.012158349    2.9379352e-13  0              2.8429334e-08  1.1965779e-13  0              2.9952535    
   2400000   6165           200            200            0.004356006    0.00090966973  0              0.012158348    1.8757561e-14  0              1.8151011e-09  1.1965779e-13  0              2.9952535    
   2500000   6165           200            200            0.0043560061   0.00090966973  0              0.012158349    2.1552243e-16  0              2.0855324e-11  1.1965779e-13  0              2.9952535    
   2600000   6165           200            200            0.0043560061   0.00090966973  0              0.012158348    7.637927e-17   0              7.3909451e-12  1.1965779e-13  0              2.9952535    
   2700000   6165           200            200            0.0043560061   0.00090966973  0              0.012158348    5.8600937e-17  0              5.6706002e-12  1.1965779e-13  0              2.9952535    
   2800000   6165           200            200            0.0043560061   0.00090966973  0              0.012158348    1.4629387e-17  0              1.4156328e-12  1.1965779e-13  0              2.9952535    
   2900000   6165           200            200            0.0043560061   0.00090966973  0              0.012158348    5.1211253e-19  0              4.9555273e-14  1.1965779e-13  0              2.9952535    
   3000000   6165           200            200            0.0043560061   0.00090966973  0              0.012158348    1.5488286e-18  0              1.4987453e-13  1.1965779e-13  0              2.9952535    
Loop time of 299.42 on 4 procs for 3000000 steps with 2500 atoms

Performance: 8656744.200 ns/day, 0.000 hours/ns, 10019.380 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 10.534     | 39.81      | 69.29      | 458.0 | 13.30
Neigh   | 3.7538     | 3.8248     | 3.8948     |   3.1 |  1.28
Comm    | 25.011     | 53.939     | 82.542     | 381.1 | 18.01
Output  | 0.27282    | 0.27317    | 0.27361    |   0.1 |  0.09
Modify  | 109.17     | 144.45     | 180.12     | 282.8 | 48.24
Other   |            | 57.12      |            |       | 19.08

Nlocal:            625 ave         876 max         375 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:            1.5 ave           4 max           0 min
Histogram: 2 0 0 0 0 1 0 0 0 1
Neighs:         346.75 ave         694 max           0 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 1387
Ave neighs/atom = 0.5548
Neighbor list builds = 164
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 12

#variable lat0 equal 1                    #
variable lat1 equal 3+(100*0.01)+(v_ind*0.01)  # .491+(v_ind*0.001)       # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 500*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.12                                                               
Lattice spacing in x,y,z = 4.12 4.12 4.12

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -3090 ${n1e1} -100 100 -100 100 units box
region box block -3090 3090 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -3090 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -3090 3090 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-3090 -100 -100) to (3090 100 100)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 1500 atoms
  using lattice units in orthogonal box = (-3090 -100 -100) to (3090 100 100)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 1500 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 1001 atoms
  using lattice units in orthogonal box = (-3090 -100 -100) to (3090 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  1500 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  1500 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  1001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  1001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
1500 atoms in group substrate
group slider1 region slider1
1001 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 1001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_12_*.dump id type diameter mass xu yu zu fx fy fz

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 3988 130 130
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 82.52 | 82.53 | 82.53 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   6180           200            200            0              0              0              0              0              0              0              1.1965779e-13  0              6            
    100000   6180           200            200            0.0032866722   6.5355604e-35  0              0.0098600167   584152.76      0              5.6413292e+10  1.1965779e-13  0              3.3272464    
    200000   6180           200            200            0.001156991   -1.5685254e-34  0              0.0034709729   140937.16      0              1.3610702e+10  1.1965779e-13  0              3.0754167    
    300000   6180           200            200            7.0276189e-05  1.9976614e-39  0              0.00021082857  1082.7758      0              1.0456673e+08  1.1965779e-13  0              3.0453949    
    400000   6180           200            200            0.00020227635 -4.5511419e-09  0              0.00060683359  7276.5977      0              7.0272172e+08  1.1965779e-13  0              2.9997267    
    500000   6180           200            200            0.002445168    0.00093079479  0              0.0064047091   1229.0548      0              1.1869332e+08  1.1965779e-13  0              2.9965544    
    600000   6180           200            200            0.0069756694   0.0040634437   0              0.016863565    54.842624      0              5296308        1.1965779e-13  0              2.994346     
    700000   6180           200            200            0.0045301757   0.0033045459   0              0.010285981    0.06445707     0              6224.8025      1.1965779e-13  0              2.9955493    
    800000   6180           200            200            0.0052859719   0.0035047038   0              0.012353212    3.4246069      0              330724.02      1.1965779e-13  0              2.9951336    
    900000   6180           200            200            0.0052753201   0.0034944633   0              0.012331497    0.19593282     0              18921.789      1.1965779e-13  0              2.9951404    
   1000000   6180           200            200            0.0051765474   0.003477725    0              0.012051917    0.022417541    0              2164.9257      1.1965779e-13  0              2.9951936    
   1100000   6180           200            200            0.0051999987   0.0034819029   0              0.012118093    0.0085703767   0              827.66564      1.1965779e-13  0              2.9951806    
   1200000   6180           200            200            0.0052081484   0.0034832773   0              0.012141168    3.0492039e-08  0              0.0029447028   1.1965779e-13  0              2.9951763    
   1300000   6180           200            200            0.0052031931   0.0034824179   0              0.012127161    0.00015482773  0              14.952154      1.1965779e-13  0              2.995179     
   1400000   6180           200            200            0.0052031856   0.003482422    0              0.012127135    7.6252752e-06  0              0.7363945      1.1965779e-13  0              2.995179     
   1500000   6180           200            200            0.0052038552   0.0034825371   0              0.012129028    1.1444767e-06  0              0.11052537     1.1965779e-13  0              2.9951786    
   1600000   6180           200            200            0.0052037089   0.0034825112   0              0.012128615    3.6923493e-07  0              0.035658066    1.1965779e-13  0              2.9951787    
   1700000   6180           200            200            0.0052036508   0.0034825014   0              0.012128451    1.1047344e-10  0              1.0668734e-05  1.1965779e-13  0              2.9951787    
   1800000   6180           200            200            0.0052036833   0.003482507    0              0.012128543    7.0940526e-09  0              0.00068509282  1.1965779e-13  0              2.9951787    
   1900000   6180           200            200            0.005203684    0.0034825071   0              0.012128545    2.9295032e-10  0              2.8291045e-05  1.1965779e-13  0              2.9951787    
   2000000   6180           200            200            0.0052036794   0.0034825063   0              0.012128532    5.7581652e-11  0              5.5608238e-06  1.1965779e-13  0              2.9951787    
   2100000   6180           200            200            0.0052036803   0.0034825065   0              0.012128535    1.5814765e-11  0              1.5272768e-06  1.1965779e-13  0              2.9951787    
   2200000   6180           200            200            0.0052036808   0.0034825066   0              0.012128536    2.1918375e-14  0              2.1167197e-09  1.1965779e-13  0              2.9951787    
   2300000   6180           200            200            0.0052036805   0.0034825065   0              0.012128535    3.2335021e-13  0              3.1226849e-08  1.1965779e-13  0              2.9951787    
   2400000   6180           200            200            0.0052036805   0.0034825065   0              0.012128535    1.096004e-14   0              1.0584423e-09  1.1965779e-13  0              2.9951787    
   2500000   6180           200            200            0.0052036806   0.0034825065   0              0.012128535    2.8345757e-15  0              2.7374303e-10  1.1965779e-13  0              2.9951787    
   2600000   6180           200            200            0.0052036806   0.0034825065   0              0.012128535    6.9812713e-16  0              6.7420121e-11  1.1965779e-13  0              2.9951787    
   2700000   6180           200            200            0.0052036806   0.0034825065   0              0.012128535    7.8474993e-19  0              7.5785531e-14  1.1965779e-13  0              2.9951787    
   2800000   6180           200            200            0.0052036806   0.0034825065   0              0.012128535    1.4693344e-17  0              1.418978e-12   1.1965779e-13  0              2.9951787    
   2900000   6180           200            200            0.0052036806   0.0034825065   0              0.012128535    4.7287036e-20  0              4.5666435e-15  1.1965779e-13  0              2.9951787    
   3000000   6180           200            200            0.0052036806   0.0034825065   0              0.012128535    7.5054374e-19  0              7.2482142e-14  1.1965779e-13  0              2.9951787    
Loop time of 306.694 on 4 procs for 3000000 steps with 2501 atoms

Performance: 8451412.342 ns/day, 0.000 hours/ns, 9781.727 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 11.171     | 40.161     | 68.97      | 452.6 | 13.09
Neigh   | 3.7558     | 3.8295     | 3.904      |   3.3 |  1.25
Comm    | 19.214     | 38.726     | 81.082     | 396.8 | 12.63
Output  | 0.27347    | 0.27381    | 0.27419    |   0.1 |  0.09
Modify  | 112.2      | 163.67     | 186.17     | 233.9 | 53.37
Other   |            | 60.04      |            |       | 19.58

Nlocal:         625.25 ave         876 max         375 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:           1.75 ave           3 max           1 min
Histogram: 2 0 0 0 0 1 0 0 0 1
Neighs:         344.75 ave         690 max           0 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 1379
Ave neighs/atom = 0.55137945
Neighbor list builds = 164
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 13

#variable lat0 equal 1                    #
variable lat1 equal 3+(100*0.01)+(v_ind*0.01)  # .491+(v_ind*0.001)       # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 500*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.13                                                               
Lattice spacing in x,y,z = 4.13 4.13 4.13

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -3097.5 ${n1e1} -100 100 -100 100 units box
region box block -3097.5 3097.5 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -3097.5 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -3097.5 3097.5 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-3097.5 -100 -100) to (3097.5 100 100)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 1500 atoms
  using lattice units in orthogonal box = (-3097.5 -100 -100) to (3097.5 100 100)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 1500 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 1001 atoms
  using lattice units in orthogonal box = (-3097.5 -100 -100) to (3097.5 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  1500 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  1500 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  1001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  1001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
1500 atoms in group substrate
group slider1 region slider1
1001 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 1001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_13_*.dump id type diameter mass xu yu zu fx fy fz

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 3997 130 130
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 82.73 | 82.74 | 82.74 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   6195           200            200            0              0              0              0              0              0              0              1.1965779e-13  0              6            
    100000   6195           200            200            0.0032784798   3.2598718e-36  0              0.0098354395   584081.74      0              5.6406434e+10  1.1965779e-13  0              3.3273643    
    200000   6195           200            200            0.0011536193   1.303959e-35   0              0.003460858    140824.62      0              1.3599834e+10  1.1965779e-13  0              3.0755838    
    300000   6195           200            200            7.0006803e-05 -1.3039343e-35  0              0.00021002041  1079.8147      0              1.0428077e+08  1.1965779e-13  0              3.0454308    
    400000   6195           200            200            0.00021124081  1.3806362e-06  0              0.00063234181  7359.7838      0              7.1075524e+08  1.1965779e-13  0              2.9996667    
    500000   6195           200            200            0.0019450902  -0.0014388654   0              0.007274136    1340.6866      0              1.2947391e+08  1.1965779e-13  0              2.9963309    
    600000   6195           200            200            0.0040975901  -0.0050487794   0              0.01734155     17.122124      0              1653532.2      1.1965779e-13  0              2.9942745    
    700000   6195           200            200            0.0020324178  -0.0041883066   0              0.01028556     0.52136445     0              50349.647      1.1965779e-13  0              2.9955724    
    800000   6195           200            200            0.0028009181  -0.0043740648   0              0.012776819    0.16413983     0              15851.45       1.1965779e-13  0              2.9950733    
    900000   6195           200            200            0.0025184394  -0.0043232136   0              0.011878532    0.11307697     0              10920.165      1.1965779e-13  0              2.9952483    
   1000000   6195           200            200            0.0026086356  -0.0043428137   0              0.01216872     0.029675201    0              2865.8185      1.1965779e-13  0              2.9951906    
   1100000   6195           200            200            0.002580793   -0.0043368013   0              0.01207918     0.005994005    0              578.8581       1.1965779e-13  0              2.9952085    
   1200000   6195           200            200            0.0025886015  -0.0043385121   0              0.012104317    0.00104582     0              100.99781      1.1965779e-13  0              2.9952034    
   1300000   6195           200            200            0.002586754   -0.0043380994   0              0.012098361    0.00016261167  0              15.703871      1.1965779e-13  0              2.9952046    
   1400000   6195           200            200            0.0025870266  -0.0043381651   0              0.012099245    2.2907307e-05  0              2.2122237      1.1965779e-13  0              2.9952044    
   1500000   6195           200            200            0.0025870803  -0.0043381737   0              0.012099414    2.935844e-06   0              0.2835228      1.1965779e-13  0              2.9952044    
   1600000   6195           200            200            0.002587005   -0.0043381587   0              0.012099174    3.4060198e-07  0              0.032892902    1.1965779e-13  0              2.9952045    
   1700000   6195           200            200            0.0025870518  -0.0043381683   0              0.012099324    3.518151e-08   0              0.0033975784   1.1965779e-13  0              2.9952044    
   1800000   6195           200            200            0.0025870284  -0.0043381634   0              0.012099249    3.118392e-09   0              0.00030115198  1.1965779e-13  0              2.9952044    
   1900000   6195           200            200            0.0025870388  -0.0043381656   0              0.012099282    2.1795705e-10  0              2.1048732e-05  1.1965779e-13  0              2.9952044    
   2000000   6195           200            200            0.0025870345  -0.0043381647   0              0.012099268    9.3588872e-12  0              9.0381434e-07  1.1965779e-13  0              2.9952044    
   2100000   6195           200            200            0.0025870362  -0.004338165    0              0.012099274    4.1605836e-14  0              4.0179938e-09  1.1965779e-13  0              2.9952044    
   2200000   6195           200            200            0.0025870356  -0.0043381649   0              0.012099272    7.0968075e-14  0              6.8535887e-09  1.1965779e-13  0              2.9952044    
   2300000   6195           200            200            0.0025870358  -0.004338165    0              0.012099272    4.743004e-14   0              4.5804538e-09  1.1965779e-13  0              2.9952044    
   2400000   6195           200            200            0.0025870357  -0.0043381649   0              0.012099272    1.4490648e-14  0              1.399403e-09   1.1965779e-13  0              2.9952044    
   2500000   6195           200            200            0.0025870357  -0.004338165    0              0.012099272    3.1492827e-15  0              3.0413518e-10  1.1965779e-13  0              2.9952044    
   2600000   6195           200            200            0.0025870357  -0.0043381649   0              0.012099272    5.919197e-16   0              5.7163368e-11  1.1965779e-13  0              2.9952044    
   2700000   6195           200            200            0.0025870357  -0.004338165    0              0.012099272    9.9163248e-17  0              9.5764767e-12  1.1965779e-13  0              2.9952044    
   2800000   6195           200            200            0.0025870357  -0.004338165    0              0.012099272    1.4109013e-17  0              1.3625475e-12  1.1965779e-13  0              2.9952044    
   2900000   6195           200            200            0.0025870357  -0.0043381649   0              0.012099272    3.714377e-18   0              3.5870794e-13  1.1965779e-13  0              2.9952044    
   3000000   6195           200            200            0.0025870357  -0.004338165    0              0.012099272    8.6902805e-19  0              8.3924509e-14  1.1965779e-13  0              2.9952044    
Loop time of 304.533 on 4 procs for 3000000 steps with 2501 atoms

Performance: 8511390.069 ns/day, 0.000 hours/ns, 9851.146 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 11.083     | 39.429     | 67.981     | 448.3 | 12.95
Neigh   | 3.7508     | 3.8219     | 3.8941     |   3.1 |  1.26
Comm    | 18.203     | 38.451     | 81.15      | 402.1 | 12.63
Output  | 0.26856    | 0.26889    | 0.26927    |   0.1 |  0.09
Modify  | 112.68     | 163.75     | 184.43     | 231.7 | 53.77
Other   |            | 58.81      |            |       | 19.31

Nlocal:         625.25 ave         876 max         375 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:           1.75 ave           3 max           1 min
Histogram: 2 0 0 0 0 1 0 0 0 1
Neighs:         344.75 ave         690 max           0 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 1379
Ave neighs/atom = 0.55137945
Neighbor list builds = 164
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 14

#variable lat0 equal 1                    #
variable lat1 equal 3+(100*0.01)+(v_ind*0.01)  # .491+(v_ind*0.001)       # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 500*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.14                                                               
Lattice spacing in x,y,z = 4.14 4.14 4.14

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -3105 ${n1e1} -100 100 -100 100 units box
region box block -3105 3105 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -3105 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -3105 3105 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-3105 -100 -100) to (3105 100 100)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 1500 atoms
  using lattice units in orthogonal box = (-3105 -100 -100) to (3105 100 100)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 1500 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 1001 atoms
  using lattice units in orthogonal box = (-3105 -100 -100) to (3105 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  1500 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  1500 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  1001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  1001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
1500 atoms in group substrate
group slider1 region slider1
1001 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 1001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_14_*.dump id type diameter mass xu yu zu fx fy fz

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 4007 130 130
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 82.87 | 82.88 | 82.88 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   6210           200            200            0              0              0              0              0              0              0              1.1965779e-13  0              6            
    100000   6210           200            200            0.0032702471  -3.251976e-36   0              0.0098107412   584002.92      0              5.6398822e+10  1.1965779e-13  0              3.3273892    
    200000   6210           200            200            0.0011494799  -7.8047394e-35  0              0.0034484397   140564.6       0              1.3574723e+10  1.1965779e-13  0              3.0758184    
    300000   6210           200            200            6.6101906e-05 -2.6015225e-35  0              0.00019830572  971.59535      0              93829725       1.1965779e-13  0              3.0455147    
    400000   6210           200            200            0.00018300634  3.3049659e-40  0              0.00054901903  6742.2687      0              6.5112005e+08  1.1965779e-13  0              3.0003253    
    500000   6210           200            200            0.0020781926   0.00035500938  0              0.0058795684   1170.3073      0              1.1301991e+08  1.1965779e-13  0              2.9967371    
    600000   6210           200            200            0.0054771257   0.0016677737   0              0.014763604    153.12603      0              14787816       1.1965779e-13  0              2.9947404    
    700000   6210           200            200            0.0051587925   0.0016252912   0              0.013851086    2.0448089      0              197473.01      1.1965779e-13  0              2.994899     
    800000   6210           200            200            0.0045338882   0.0015811336   0              0.012020531    3.7669579      0              363785.83      1.1965779e-13  0              2.9952616    
    900000   6210           200            200            0.0044672857   0.0015751021   0              0.011826755    0.0083551685   0              806.88237      1.1965779e-13  0              2.9953034    
   1000000   6210           200            200            0.0045415033   0.0015813963   0              0.012043114    0.062215095    0              6008.2886      1.1965779e-13  0              2.9952596    
   1100000   6210           200            200            0.004560855    0.0015830457   0              0.012099519    0.0021130936   0              204.06746      1.1965779e-13  0              2.9952479    
   1200000   6210           200            200            0.0045534237   0.0015824403   0              0.012077831    0.00075421891  0              72.837063      1.1965779e-13  0              2.9952522    
   1300000   6210           200            200            0.0045498187   0.0015821367   0              0.012067319    9.7769994e-05  0              9.4419262      1.1965779e-13  0              2.9952544    
   1400000   6210           200            200            0.0045503358   0.0015821778   0              0.01206883     5.6318411e-06  0              0.54388291     1.1965779e-13  0              2.9952541    
   1500000   6210           200            200            0.0045508914   0.0015822242   0              0.01207045     2.7300918e-06  0              0.26365273     1.1965779e-13  0              2.9952538    
   1600000   6210           200            200            0.0045508964   0.001582225    0              0.012070464    9.5721278e-09  0              0.00092440759  1.1965779e-13  0              2.9952538    
   1700000   6210           200            200            0.0045508222   0.0015822188   0              0.012070248    5.5665377e-08  0              0.0053757637   1.1965779e-13  0              2.9952538    
   1800000   6210           200            200            0.0045508115   0.0015822179   0              0.012070217    3.4332259e-10  0              3.3155639e-05  1.1965779e-13  0              2.9952538    
   1900000   6210           200            200            0.0045508201   0.0015822186   0              0.012070242    8.5969357e-10  0              8.3023052e-05  1.1965779e-13  0              2.9952538    
   2000000   6210           200            200            0.0045508227   0.0015822188   0              0.012070249    4.1479039e-11  0              4.0057487e-06  1.1965779e-13  0              2.9952538    
   2100000   6210           200            200            0.0045508219   0.0015822187   0              0.012070247    9.5351558e-12  0              9.208371e-07   1.1965779e-13  0              2.9952538    
   2200000   6210           200            200            0.0045508214   0.0015822187   0              0.012070246    1.6474903e-12  0              1.5910282e-07  1.1965779e-13  0              2.9952538    
   2300000   6210           200            200            0.0045508215   0.0015822187   0              0.012070246    5.9124257e-14  0              5.7097976e-09  1.1965779e-13  0              2.9952538    
   2400000   6210           200            200            0.0045508215   0.0015822187   0              0.012070246    4.2493546e-14  0              4.1037225e-09  1.1965779e-13  0              2.9952538    
   2500000   6210           200            200            0.0045508215   0.0015822187   0              0.012070246    1.4985338e-17  0              1.4471766e-12  1.1965779e-13  0              2.9952538    
   2600000   6210           200            200            0.0045508215   0.0015822187   0              0.012070246    7.9366237e-16  0              7.6646231e-11  1.1965779e-13  0              2.9952538    
   2700000   6210           200            200            0.0045508215   0.0015822187   0              0.012070246    1.1192681e-17  0              1.080909e-12   1.1965779e-13  0              2.9952538    
   2800000   6210           200            200            0.0045508215   0.0015822187   0              0.012070246    1.3485933e-17  0              1.3023748e-12  1.1965779e-13  0              2.9952538    
   2900000   6210           200            200            0.0045508215   0.0015822187   0              0.012070246    5.7030702e-20  0              5.5076169e-15  1.1965779e-13  0              2.9952538    
   3000000   6210           200            200            0.0045508215   0.0015822187   0              0.012070246    8.8741074e-21  0              8.5699777e-16  1.1965779e-13  0              2.9952538    
Loop time of 301.637 on 4 procs for 3000000 steps with 2501 atoms

Performance: 8593117.936 ns/day, 0.000 hours/ns, 9945.738 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 11.109     | 39.442     | 68.87      | 445.6 | 13.08
Neigh   | 3.7587     | 3.8293     | 3.899      |   3.0 |  1.27
Comm    | 17.882     | 24.006     | 28.551     |  93.5 |  7.96
Output  | 0.27517    | 0.27551    | 0.27588    |   0.1 |  0.09
Modify  | 172.89     | 176.62     | 179.58     |  22.3 | 58.56
Other   |            | 57.46      |            |       | 19.05

Nlocal:         625.25 ave         877 max         374 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:           1.75 ave           3 max           1 min
Histogram: 2 0 0 0 0 1 0 0 0 1
Neighs:         347.75 ave         696 max           0 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 1391
Ave neighs/atom = 0.55617753
Neighbor list builds = 164
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 15

#variable lat0 equal 1                    #
variable lat1 equal 3+(100*0.01)+(v_ind*0.01)  # .491+(v_ind*0.001)       # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 500*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.15                                                               
Lattice spacing in x,y,z = 4.15 4.15 4.15

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -3112.5 ${n1e1} -100 100 -100 100 units box
region box block -3112.5 3112.5 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -3112.5 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -3112.5 3112.5 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-3112.5 -100 -100) to (3112.5 100 100)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 1499 atoms
  using lattice units in orthogonal box = (-3112.5 -100 -100) to (3112.5 100 100)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 1500 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 1001 atoms
  using lattice units in orthogonal box = (-3112.5 -100 -100) to (3112.5 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  1499 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  1499 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  1001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  1001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
1499 atoms in group substrate
group slider1 region slider1
1001 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 1001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_15_*.dump id type diameter mass xu yu zu fx fy fz

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 4017 130 130
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 83.08 | 83.09 | 83.09 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   6225           200            200            0              0              0              0              0              0              0              1.1965779e-13  0              6            
    100000   6225           200            200            0.0032626023   1.2976616e-35  0              0.009787807    584062.15      0              5.6517577e+10  1.1965779e-13  0              3.3273708    
    200000   6225           200            200            0.0011472501  -6.7478185e-34  0              0.0034417503   140666.62      0              1.3611799e+10  1.1965779e-13  0              3.0757679    
    300000   6225           200            200            6.7123043e-05  8.5177347e-40  0              0.00020136913  1005.2729      0              97276615       1.1965779e-13  0              3.0455349    
    400000   6225           200            200            0.00018515618  5.1907279e-35  0              0.00055546855  6917.8019      0              6.6941061e+08  1.1965779e-13  0              3.0001818    
    500000   6225           200            200            0.0022664152   0.00072812657  0              0.006071119    1192.1308      0              1.1535818e+08  1.1965779e-13  0              2.996721     
    600000   6225           200            200            0.0061610692   0.0012617945   0              0.017221413    22.615633      0              2188432.8      1.1965779e-13  0              2.9943596    
    700000   6225           200            200            0.0041553269   0.0016757515   0              0.010790229    15.622724      0              1511754.3      1.1965779e-13  0              2.995528     
    800000   6225           200            200            0.0043718709   0.0015782694   0              0.011537343    1.831456       0              177223.36      1.1965779e-13  0              2.9953726    
    900000   6225           200            200            0.0045976677   0.0015783543   0              0.012214649    0.27592627     0              26700.385      1.1965779e-13  0              2.9952424    
   1000000   6225           200            200            0.0045630032   0.0015782222   0              0.012110787    0.032046592    0              3101.0325      1.1965779e-13  0              2.9952631    
   1100000   6225           200            200            0.0045322717   0.0015781431   0              0.012018672    0.0052855525   0              511.46375      1.1965779e-13  0              2.9952807    
   1200000   6225           200            200            0.004536588    0.0015781527   0              0.012031611    0.00054031304  0              52.284134      1.1965779e-13  0              2.9952781    
   1300000   6225           200            200            0.0045407808   0.0015781624   0              0.01204418     0.0001016121   0              9.8326347      1.1965779e-13  0              2.9952757    
   1400000   6225           200            200            0.0045402489   0.001578161    0              0.012042586    9.0825889e-06  0              0.87888921     1.1965779e-13  0              2.995276     
   1500000   6225           200            200            0.0045396774   0.0015781597   0              0.012040872    1.9451848e-06  0              0.18822848     1.1965779e-13  0              2.9952764    
   1600000   6225           200            200            0.0045397422   0.0015781599   0              0.012041067    1.5181043e-07  0              0.014690145    1.1965779e-13  0              2.9952763    
   1700000   6225           200            200            0.0045398201   0.00157816     0              0.0120413      3.71149e-08    0              0.0035914744   1.1965779e-13  0              2.9952763    
   1800000   6225           200            200            0.0045398122   0.00157816     0              0.012041277    2.5228066e-09  0              0.00024412285  1.1965779e-13  0              2.9952763    
   1900000   6225           200            200            0.0045398017   0.00157816     0              0.012041245    7.0586351e-10  0              6.8303853e-05  1.1965779e-13  0              2.9952763    
   2000000   6225           200            200            0.0045398026   0.00157816     0              0.012041248    4.1653441e-11  0              4.0306525e-06  1.1965779e-13  0              2.9952763    
   2100000   6225           200            200            0.004539804    0.00157816     0              0.012041252    1.3382536e-11  0              1.2949795e-06  1.1965779e-13  0              2.9952763    
   2200000   6225           200            200            0.0045398039   0.00157816     0              0.012041252    6.831309e-13   0              6.6104101e-08  1.1965779e-13  0              2.9952763    
   2300000   6225           200            200            0.0045398037   0.00157816     0              0.012041251    2.5308675e-13  0              2.4490287e-08  1.1965779e-13  0              2.9952763    
   2400000   6225           200            200            0.0045398037   0.00157816     0              0.012041251    1.1027256e-14  0              1.0670676e-09  1.1965779e-13  0              2.9952763    
   2500000   6225           200            200            0.0045398038   0.00157816     0              0.012041251    4.7061882e-15  0              4.5540077e-10  1.1965779e-13  0              2.9952763    
   2600000   6225           200            200            0.0045398038   0.00157816     0              0.012041251    2.0341555e-16  0              1.9683785e-11  1.1965779e-13  0              2.9952763    
   2700000   6225           200            200            0.0045398038   0.00157816     0              0.012041251    8.554464e-17   0              8.2778447e-12  1.1965779e-13  0              2.9952763    
   2800000   6225           200            200            0.0045398038   0.00157816     0              0.012041251    3.3846099e-19  0              3.2751643e-14  1.1965779e-13  0              2.9952763    
   2900000   6225           200            200            0.0045398038   0.00157816     0              0.012041251    2.2941708e-18  0              2.2199859e-13  1.1965779e-13  0              2.9952763    
   3000000   6225           200            200            0.0045398038   0.00157816     0              0.012041251    5.4885932e-18  0              5.3111126e-13  1.1965779e-13  0              2.9952763    
Loop time of 299.973 on 4 procs for 3000000 steps with 2500 atoms

Performance: 8640779.650 ns/day, 0.000 hours/ns, 10000.902 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 10.768     | 40.179     | 69.886     | 459.7 | 13.39
Neigh   | 3.8163     | 3.8903     | 3.9643     |   3.2 |  1.30
Comm    | 25.554     | 54.592     | 83.641     | 381.6 | 18.20
Output  | 0.33905    | 0.3394     | 0.33979    |   0.1 |  0.11
Modify  | 109.24     | 144.34     | 179.01     | 281.5 | 48.12
Other   |            | 56.63      |            |       | 18.88

Nlocal:            625 ave         876 max         375 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:            1.5 ave           4 max           0 min
Histogram: 2 0 0 0 0 1 0 0 0 1
Neighs:         343.25 ave         687 max           0 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 1373
Ave neighs/atom = 0.5492
Neighbor list builds = 164
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 16

#variable lat0 equal 1                    #
variable lat1 equal 3+(100*0.01)+(v_ind*0.01)  # .491+(v_ind*0.001)       # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 500*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.16                                                               
Lattice spacing in x,y,z = 4.16 4.16 4.16

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -3120 ${n1e1} -100 100 -100 100 units box
region box block -3120 3120 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -3120 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -3120 3120 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-3120 -100 -100) to (3120 100 100)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 1500 atoms
  using lattice units in orthogonal box = (-3120 -100 -100) to (3120 100 100)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 1500 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 1001 atoms
  using lattice units in orthogonal box = (-3120 -100 -100) to (3120 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  1500 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  1500 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  1001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  1001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
1500 atoms in group substrate
group slider1 region slider1
1001 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 1001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_16_*.dump id type diameter mass xu yu zu fx fy fz

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 4026 130 130
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 83.16 | 83.19 | 83.22 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   6240           200            200            0              0              0              0              0              0              0              1.1965779e-13  0              6            
    100000   6240           200            200            0.0032543747  -5.1781234e-35  0              0.0097631242   583963.61      0              5.6395025e+10  1.1965779e-13  0              3.3274128    
    200000   6240           200            200            0.0011437309   6.4727299e-36  0              0.0034311928   140523.01      0              1.3570706e+10  1.1965779e-13  0              3.0758271    
    300000   6240           200            200            6.5659212e-05  7.7673136e-35  0              0.00019697764  968.07345      0              93489605       1.1965779e-13  0              3.0454803    
    400000   6240           200            200            0.00018159994  2.5891484e-35  0              0.00054479983  6706.8397      0              6.4769858e+08  1.1965779e-13  0              3.0003261    
    500000   6240           200            200            0.001845303    0.00071938736  0              0.0048165215   985.3742       0              95160388       1.1965779e-13  0              2.9970221    
    600000   6240           200            200            0.0062706624   0.003282849    0              0.015529138    123.10287      0              11888394       1.1965779e-13  0              2.9945712    
    700000   6240           200            200            0.0045366709   0.0032824088   0              0.010327604    4.5816838      0              442466.23      1.1965779e-13  0              2.9955403    
    800000   6240           200            200            0.0052843922   0.0032805439   0              0.012572633    1.305409       0              126067.06      1.1965779e-13  0              2.9950925    
    900000   6240           200            200            0.0051112074   0.0032785826   0              0.01205504     0.50334322     0              48609.285      1.1965779e-13  0              2.995194     
   1000000   6240           200            200            0.0050653963   0.0032735516   0              0.011922637    0.0050633885   0              488.98582      1.1965779e-13  0              2.9952189    
   1100000   6240           200            200            0.0051039845   0.0032779425   0              0.012034011    0.0053906074   0              520.58628      1.1965779e-13  0              2.9951972    
   1200000   6240           200            200            0.005098155    0.0032772544   0              0.01201721     0.0010548429   0              101.86918      1.1965779e-13  0              2.9952006    
   1300000   6240           200            200            0.0050947648   0.0032768762   0              0.012007418    4.9202231e-08  0              0.0047515993   1.1965779e-13  0              2.9952025    
   1400000   6240           200            200            0.0050966069   0.0032770868   0              0.012012734    1.8566509e-05  0              1.7930205      1.1965779e-13  0              2.9952014    
   1500000   6240           200            200            0.0050964901   0.0032770722   0              0.012012398    1.8826322e-06  0              0.18181114     1.1965779e-13  0              2.9952015    
   1600000   6240           200            200            0.0050962782   0.0032770483   0              0.012011786    2.3550484e-08  0              0.0022743371   1.1965779e-13  0              2.9952016    
   1700000   6240           200            200            0.0050963599   0.0032770577   0              0.012012022    5.4180392e-08  0              0.0052323545   1.1965779e-13  0              2.9952016    
   1800000   6240           200            200            0.005096363    0.003277058    0              0.012012031    2.685144e-09   0              0.00025931199  1.1965779e-13  0              2.9952016    
   1900000   6240           200            200            0.0050963511   0.0032770567   0              0.012011996    2.3217467e-10  0              2.2421768e-05  1.1965779e-13  0              2.9952016    
   2000000   6240           200            200            0.0050963544   0.003277057    0              0.012012006    1.3763055e-10  0              1.3291373e-05  1.1965779e-13  0              2.9952016    
   2100000   6240           200            200            0.005096355    0.0032770571   0              0.012012008    2.5615883e-12  0              2.4737986e-07  1.1965779e-13  0              2.9952016    
   2200000   6240           200            200            0.0050963543   0.003277057    0              0.012012006    1.1731674e-12  0              1.1329611e-07  1.1965779e-13  0              2.9952016    
   2300000   6240           200            200            0.0050963544   0.0032770571   0              0.012012006    3.0588841e-13  0              2.9540513e-08  1.1965779e-13  0              2.9952016    
   2400000   6240           200            200            0.0050963545   0.0032770571   0              0.012012006    7.0724783e-16  0              6.8300933e-11  1.1965779e-13  0              2.9952016    
   2500000   6240           200            200            0.0050963545   0.0032770571   0              0.012012006    4.319071e-15   0              4.1710497e-10  1.1965779e-13  0              2.9952016    
   2600000   6240           200            200            0.0050963545   0.0032770571   0              0.012012006    6.2450514e-16  0              6.0310236e-11  1.1965779e-13  0              2.9952016    
   2700000   6240           200            200            0.0050963545   0.0032770571   0              0.012012006    6.8638374e-19  0              6.6286029e-14  1.1965779e-13  0              2.9952016    
   2800000   6240           200            200            0.0050963545   0.0032770571   0              0.012012006    1.3851645e-17  0              1.3376927e-12  1.1965779e-13  0              2.9952016    
   2900000   6240           200            200            0.0050963545   0.0032770571   0              0.012012006    7.2194283e-19  0              6.9720071e-14  1.1965779e-13  0              2.9952016    
   3000000   6240           200            200            0.0050963545   0.0032770571   0              0.012012006    1.7288609e-19  0              1.6696101e-14  1.1965779e-13  0              2.9952016    
Loop time of 304.834 on 4 procs for 3000000 steps with 2501 atoms

Performance: 8502991.877 ns/day, 0.000 hours/ns, 9841.426 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 11.352     | 39.88      | 68.789     | 451.0 | 13.08
Neigh   | 3.8029     | 3.8762     | 3.9489     |   3.2 |  1.27
Comm    | 18.74      | 40.377     | 83.897     | 401.5 | 13.25
Output  | 0.27246    | 0.2728     | 0.2732     |   0.1 |  0.09
Modify  | 111.58     | 162.53     | 182.08     | 231.1 | 53.32
Other   |            | 57.9       |            |       | 18.99

Nlocal:         625.25 ave         876 max         375 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:           1.75 ave           3 max           1 min
Histogram: 2 0 0 0 0 1 0 0 0 1
Neighs:         343.75 ave         688 max           0 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 1375
Ave neighs/atom = 0.54978009
Neighbor list builds = 164
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 17

#variable lat0 equal 1                    #
variable lat1 equal 3+(100*0.01)+(v_ind*0.01)  # .491+(v_ind*0.001)       # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 500*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.17                                                               
Lattice spacing in x,y,z = 4.17 4.17 4.17

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -3127.5 ${n1e1} -100 100 -100 100 units box
region box block -3127.5 3127.5 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -3127.5 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -3127.5 3127.5 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-3127.5 -100 -100) to (3127.5 100 100)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 1500 atoms
  using lattice units in orthogonal box = (-3127.5 -100 -100) to (3127.5 100 100)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 1500 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 1001 atoms
  using lattice units in orthogonal box = (-3127.5 -100 -100) to (3127.5 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  1500 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  1500 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  1001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  1001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
1500 atoms in group substrate
group slider1 region slider1
1001 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 1001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_17_*.dump id type diameter mass xu yu zu fx fy fz

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 4036 130 130
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 83.36 | 83.36 | 83.37 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   6255           200            200            0              0              0              0              0              0              0              1.1965779e-13  0              6            
    100000   6255           200            200            0.003246822   -1.2914344e-35  0              0.009740466    584027.53      0              5.6401199e+10  1.1965779e-13  0              3.3273905    
    200000   6255           200            200            0.0011414814   6.4571955e-36  0              0.0034244443   140616.01      0              1.3579688e+10  1.1965779e-13  0              3.0757941    
    300000   6255           200            200            6.6256787e-05 -7.7485755e-35  0              0.00019877036  989.6039       0              95568862       1.1965779e-13  0              3.0455234    
    400000   6255           200            200            0.00018335391 -2.5828389e-35  0              0.00055006173  6855.3791      0              6.6204344e+08  1.1965779e-13  0              3.0002247    
    500000   6255           200            200            0.0018071044   0.00020108654  0              0.0052202266   1058.723       0              1.0224389e+08  1.1965779e-13  0              2.9969464    
    600000   6255           200            200            0.0055041507   0.0017228266   0              0.014789625    151.95353      0              14674585       1.1965779e-13  0              2.9947349    
    700000   6255           200            200            0.0044528418   0.0015029653   0              0.01185556     28.314178      0              2734380.7      1.1965779e-13  0              2.9952768    
    800000   6255           200            200            0.0044405578   0.0015238927   0              0.011797781    3.5081054      0              338787.71      1.1965779e-13  0              2.995297     
    900000   6255           200            200            0.0045485597   0.0015321658   0              0.012113513    0.3695361      0              35687.151      1.1965779e-13  0              2.9952309    
   1000000   6255           200            200            0.0044811193   0.0015271821   0              0.011916176    0.030939599    0              2987.9251      1.1965779e-13  0              2.9952712    
   1100000   6255           200            200            0.0045143309   0.0015296383   0              0.012013355    0.0018128776   0              175.07474      1.1965779e-13  0              2.9952515    
   1200000   6255           200            200            0.0044999815   0.00152859     0              0.011971355    4.0208494e-05  0              3.8830486      1.1965779e-13  0              2.99526      
   1300000   6255           200            200            0.0045056406   0.0015290024   0              0.011987919    1.5819959e-06  0              0.15277784     1.1965779e-13  0              2.9952567    
   1400000   6255           200            200            0.0045035765   0.0015288529   0              0.011981877    3.0398805e-06  0              0.2935699      1.1965779e-13  0              2.9952579    
   1500000   6255           200            200            0.0045042718   0.001528903    0              0.011983912    1.1284632e-06  0              0.1089789      1.1965779e-13  0              2.9952575    
   1600000   6255           200            200            0.0045040588   0.0015288877   0              0.011983289    2.656933e-07   0              0.025658758    1.1965779e-13  0              2.9952576    
   1700000   6255           200            200            0.0045041155   0.0015288918   0              0.011983455    4.882347e-08   0              0.0047150213   1.1965779e-13  0              2.9952576    
   1800000   6255           200            200            0.0045041042   0.001528891    0              0.011983422    7.5027633e-09  0              0.00072456318  1.1965779e-13  0              2.9952576    
   1900000   6255           200            200            0.0045041045   0.001528891    0              0.011983423    9.8640613e-10  0              9.5260044e-05  1.1965779e-13  0              2.9952576    
   2000000   6255           200            200            0.0045041058   0.0015288911   0              0.011983426    1.105054e-10   0              1.0671821e-05  1.1965779e-13  0              2.9952576    
   2100000   6255           200            200            0.0045041049   0.001528891    0              0.011983424    1.0191479e-11  0              9.8422008e-07  1.1965779e-13  0              2.9952576    
   2200000   6255           200            200            0.0045041054   0.0015288911   0              0.011983425    7.0403976e-13  0              6.799112e-08   1.1965779e-13  0              2.9952576    
   2300000   6255           200            200            0.0045041051   0.001528891    0              0.011983424    2.6156989e-14  0              2.5260548e-09  1.1965779e-13  0              2.9952576    
   2400000   6255           200            200            0.0045041052   0.001528891    0              0.011983425    2.1846445e-18  0              2.1097733e-13  1.1965779e-13  0              2.9952576    
   2500000   6255           200            200            0.0045041052   0.001528891    0              0.011983425    4.3079449e-16  0              4.1603049e-11  1.1965779e-13  0              2.9952576    
   2600000   6255           200            200            0.0045041052   0.001528891    0              0.011983425    2.380696e-16   0              2.2991058e-11  1.1965779e-13  0              2.9952576    
   2700000   6255           200            200            0.0045041052   0.001528891    0              0.011983425    6.0538489e-17  0              5.8463739e-12  1.1965779e-13  0              2.9952576    
   2800000   6255           200            200            0.0045041052   0.001528891    0              0.011983425    7.658258e-18   0              7.3957974e-13  1.1965779e-13  0              2.9952576    
   2900000   6255           200            200            0.0045041052   0.001528891    0              0.011983425    3.9739139e-18  0              3.8377216e-13  1.1965779e-13  0              2.9952576    
   3000000   6255           200            200            0.0045041052   0.001528891    0              0.011983425    2.7276304e-18  0              2.6341502e-13  1.1965779e-13  0              2.9952576    
Loop time of 302.517 on 4 procs for 3000000 steps with 2501 atoms

Performance: 8568117.175 ns/day, 0.000 hours/ns, 9916.802 timesteps/s
99.9% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 11.234     | 40.065     | 70.975     | 453.3 | 13.24
Neigh   | 3.8692     | 3.9437     | 4.0179     |   3.3 |  1.30
Comm    | 18.917     | 40.326     | 84.229     | 404.6 | 13.33
Output  | 0.27619    | 0.27651    | 0.27688    |   0.1 |  0.09
Modify  | 109.4      | 160.55     | 179.44     | 233.2 | 53.07
Other   |            | 57.36      |            |       | 18.96

Nlocal:         625.25 ave         876 max         375 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:           1.75 ave           3 max           1 min
Histogram: 2 0 0 0 0 1 0 0 0 1
Neighs:         345.25 ave         691 max           0 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 1381
Ave neighs/atom = 0.55217913
Neighbor list builds = 164
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 18

#variable lat0 equal 1                    #
variable lat1 equal 3+(100*0.01)+(v_ind*0.01)  # .491+(v_ind*0.001)       # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 500*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.18                                                               
Lattice spacing in x,y,z = 4.18 4.18 4.18

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -3135 ${n1e1} -100 100 -100 100 units box
region box block -3135 3135 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -3135 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -3135 3135 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-3135 -100 -100) to (3135 100 100)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 1500 atoms
  using lattice units in orthogonal box = (-3135 -100 -100) to (3135 100 100)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 1500 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 1001 atoms
  using lattice units in orthogonal box = (-3135 -100 -100) to (3135 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  1500 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  1500 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  1001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  1001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
1500 atoms in group substrate
group slider1 region slider1
1001 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 1001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_18_*.dump id type diameter mass xu yu zu fx fy fz

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 4046 130 130
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 83.51 | 83.54 | 83.57 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   6270           200            200            0              0              0              0              0              0              0              1.1965779e-13  0              6            
    100000   6270           200            200            0.0032386842   1.6104364e-36  0              0.0097160525   583933.27      0              5.6392096e+10  1.1965779e-13  0              3.3274228    
    200000   6270           200            200            0.0011379985   5.1534591e-35  0              0.0034139955   140473.61      0              1.3565936e+10  1.1965779e-13  0              3.07585      
    300000   6270           200            200            6.4990627e-05  2.5767108e-34  0              0.00019497188  958.01826      0              92518547       1.1965779e-13  0              3.0454595    
    400000   6270           200            200            0.00017868617  1.0306855e-34  0              0.0005360585   6568.905       0              6.3437782e+08  1.1965779e-13  0              3.0004464    
    500000   6270           200            200            0.0015910998   0.00063047006  0              0.0041428294   838.76337      0              81001763       1.1965779e-13  0              2.9972336    
    600000   6270           200            200            0.0052282706   0.0026091605   0              0.013075651    202.59179      0              19564865       1.1965779e-13  0              2.9949898    
    700000   6270           200            200            0.0050445292   0.0025888062   0              0.012544781    25.37578       0              2450611.2      1.1965779e-13  0              2.9950701    
    800000   6270           200            200            0.0047651847   0.002713712    0              0.011581842    2.6072959      0              251793.98      1.1965779e-13  0              2.9952696    
    900000   6270           200            200            0.0049385343   0.0026898771   0              0.012125726    0.26443702     0              25537.435      1.1965779e-13  0              2.9951579    
   1000000   6270           200            200            0.0048551486   0.0026842752   0              0.01188117     0.023527847    0              2272.1511      1.1965779e-13  0              2.9952075    
   1100000   6270           200            200            0.0048903444   0.0026865792   0              0.011984454    0.0017578861   0              169.76406      1.1965779e-13  0              2.9951866    
   1200000   6270           200            200            0.0048761243   0.0026856428   0              0.01194273     9.2465959e-05  0              8.9297005      1.1965779e-13  0              2.995195     
   1300000   6270           200            200            0.0048816584   0.0026860046   0              0.011958971    1.7038092e-06  0              0.16454169     1.1965779e-13  0              2.9951917    
   1400000   6270           200            200            0.0048795721   0.0026858684   0              0.011952848    1.2429613e-07  0              0.012003631    1.1965779e-13  0              2.9951929    
   1500000   6270           200            200            0.0048803348   0.002685918    0              0.011955086    1.8572729e-07  0              0.017936212    1.1965779e-13  0              2.9951925    
   1600000   6270           200            200            0.0048800644   0.0026859005   0              0.011954293    6.9775605e-08  0              0.0067384285   1.1965779e-13  0              2.9951927    
   1700000   6270           200            200            0.0048801571   0.0026859065   0              0.011954565    1.7673915e-08  0              0.0017068202   1.1965779e-13  0              2.9951926    
   1800000   6270           200            200            0.0048801265   0.0026859045   0              0.011954475    3.6647025e-09  0              0.00035391074  1.1965779e-13  0              2.9951926    
   1900000   6270           200            200            0.0048801362   0.0026859051   0              0.011954503    6.6868906e-10  0              6.4577203e-05  1.1965779e-13  0              2.9951926    
   2000000   6270           200            200            0.0048801333   0.0026859049   0              0.011954495    1.1110134e-10  0              1.0729372e-05  1.1965779e-13  0              2.9951926    
   2100000   6270           200            200            0.0048801341   0.002685905    0              0.011954497    1.7115024e-11  0              1.6528465e-06  1.1965779e-13  0              2.9951926    
   2200000   6270           200            200            0.0048801339   0.002685905    0              0.011954497    2.4683616e-12  0              2.3837669e-07  1.1965779e-13  0              2.9951926    
   2300000   6270           200            200            0.0048801339   0.002685905    0              0.011954497    3.3435987e-13  0              3.2290083e-08  1.1965779e-13  0              2.9951926    
   2400000   6270           200            200            0.0048801339   0.002685905    0              0.011954497    4.2577913e-14  0              4.1118701e-09  1.1965779e-13  0              2.9951926    
   2500000   6270           200            200            0.0048801339   0.002685905    0              0.011954497    4.9994724e-15  0              4.8281326e-10  1.1965779e-13  0              2.9951926    
   2600000   6270           200            200            0.0048801339   0.002685905    0              0.011954497    5.4313455e-16  0              5.2452047e-11  1.1965779e-13  0              2.9951926    
   2700000   6270           200            200            0.0048801339   0.002685905    0              0.011954497    5.5502116e-17  0              5.3599971e-12  1.1965779e-13  0              2.9951926    
   2800000   6270           200            200            0.0048801339   0.002685905    0              0.011954497    6.8260662e-18  0              6.5921261e-13  1.1965779e-13  0              2.9951926    
   2900000   6270           200            200            0.0048801339   0.002685905    0              0.011954497    2.0937645e-18  0              2.0220079e-13  1.1965779e-13  0              2.9951926    
   3000000   6270           200            200            0.0048801339   0.002685905    0              0.011954497    3.9797997e-18  0              3.8434057e-13  1.1965779e-13  0              2.9951926    
Loop time of 307.741 on 4 procs for 3000000 steps with 2501 atoms

Performance: 8422672.851 ns/day, 0.000 hours/ns, 9748.464 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 11.279     | 40.934     | 71.809     | 461.9 | 13.30
Neigh   | 3.8613     | 3.9361     | 4.0105     |   3.3 |  1.28
Comm    | 18.914     | 40.116     | 85.146     | 414.8 | 13.04
Output  | 0.27851    | 0.27885    | 0.27924    |   0.1 |  0.09
Modify  | 110        | 163.11     | 183.99     | 240.7 | 53.00
Other   |            | 59.37      |            |       | 19.29

Nlocal:         625.25 ave         876 max         375 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:           1.75 ave           3 max           1 min
Histogram: 2 0 0 0 0 1 0 0 0 1
Neighs:         344.75 ave         690 max           0 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 1379
Ave neighs/atom = 0.55137945
Neighbor list builds = 164
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 19

#variable lat0 equal 1                    #
variable lat1 equal 3+(100*0.01)+(v_ind*0.01)  # .491+(v_ind*0.001)       # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 500*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.19                                                               
Lattice spacing in x,y,z = 4.19 4.19 4.19

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -3142.5 ${n1e1} -100 100 -100 100 units box
region box block -3142.5 3142.5 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -3142.5 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -3142.5 3142.5 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-3142.5 -100 -100) to (3142.5 100 100)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 1499 atoms
  using lattice units in orthogonal box = (-3142.5 -100 -100) to (3142.5 100 100)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 1500 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 1001 atoms
  using lattice units in orthogonal box = (-3142.5 -100 -100) to (3142.5 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  1499 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  1499 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  1001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  1001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
1499 atoms in group substrate
group slider1 region slider1
1001 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 1001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_19_*.dump id type diameter mass xu yu zu fx fy fz

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 4055 130 130
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 83.71 | 83.71 | 83.72 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   6285           200            200            0              0              0              0              0              0              0              1.1965779e-13  0              6            
    100000   6285           200            200            0.0032312011  -6.4263598e-36  0              0.0096936032   583996.25      0              5.6511201e+10  1.1965779e-13  0              3.3274004    
    200000   6285           200            200            0.0011357773   4.1128889e-34  0              0.003407332    140567.51      0              1.3602209e+10  1.1965779e-13  0              3.0758134    
    300000   6285           200            200            6.5615202e-05  1.0282242e-34  0              0.00019684561  980.25862      0              94856074       1.1965779e-13  0              3.0454998    
    400000   6285           200            200            0.00018088754  3.0878282e-39  0              0.00054266263  6746.7322      0              6.5285682e+08  1.1965779e-13  0              3.0003116    
    500000   6285           200            200            0.0019320127   0.00086281034  0              0.0049332279   1014.4026      0              98160063       1.1965779e-13  0              2.9970015    
    600000   6285           200            200            0.0066996197   0.0049131278   0              0.015185731    132.15059      0              12787734       1.1965779e-13  0              2.9946345    
    700000   6285           200            200            0.0052126111   0.0044044681   0              0.011233365    24.452549      0              2366184.5      1.1965779e-13  0              2.9953696    
    800000   6285           200            200            0.0054853089   0.0044769304   0              0.011978996    3.7920826      0              366946.09      1.1965779e-13  0              2.9952262    
    900000   6285           200            200            0.0054955806   0.0044837918   0              0.01200295     0.46076922     0              44586.967      1.1965779e-13  0              2.9952183    
   1000000   6285           200            200            0.0054469309   0.0044766912   0              0.011864102    0.036028864    0              3486.3826      1.1965779e-13  0              2.9952472    
   1100000   6285           200            200            0.0054794531   0.004481366    0              0.011956993    0.0012317446   0              119.19146      1.1965779e-13  0              2.9952283    
   1200000   6285           200            200            0.0054643961   0.0044792356   0              0.011913953    5.0265385e-06  0              0.48639991     1.1965779e-13  0              2.995237     
   1300000   6285           200            200            0.0054700389   0.0044800308   0              0.011930086    3.873243e-05   0              3.7479969      1.1965779e-13  0              2.9952337    
   1400000   6285           200            200            0.0054683107   0.0044797897   0              0.011925142    1.4761255e-05  0              1.4283931      1.1965779e-13  0              2.9952347    
   1500000   6285           200            200            0.0054687008   0.0044798432   0              0.011926259    2.9572214e-06  0              0.28615959     1.1965779e-13  0              2.9952345    
   1600000   6285           200            200            0.005468674    0.0044798401   0              0.011926182    3.934189e-07   0              0.038069721    1.1965779e-13  0              2.9952345    
   1700000   6285           200            200            0.0054686392   0.0044798349   0              0.011926083    3.454618e-08   0              0.0033429086   1.1965779e-13  0              2.9952345    
   1800000   6285           200            200            0.005468666    0.0044798388   0              0.011926159    1.5379266e-09  0              0.00014881958  1.1965779e-13  0              2.9952345    
   1900000   6285           200            200            0.0054686529   0.0044798369   0              0.011926122    1.1197687e-12  0              1.0835596e-07  1.1965779e-13  0              2.9952345    
   2000000   6285           200            200            0.005468658    0.0044798376   0              0.011926136    2.1004197e-11  0              2.0325e-06     1.1965779e-13  0              2.9952345    
   2100000   6285           200            200            0.0054686563   0.0044798374   0              0.011926132    1.0206923e-11  0              9.8768695e-07  1.1965779e-13  0              2.9952345    
   2200000   6285           200            200            0.0054686568   0.0044798375   0              0.011926133    2.2797613e-12  0              2.2060423e-07  1.1965779e-13  0              2.9952345    
   2300000   6285           200            200            0.0054686567   0.0044798375   0              0.011926133    3.302907e-13   0              3.1961033e-08  1.1965779e-13  0              2.9952345    
   2400000   6285           200            200            0.0054686567   0.0044798374   0              0.011926133    3.1852709e-14  0              3.0822712e-09  1.1965779e-13  0              2.9952345    
   2500000   6285           200            200            0.0054686567   0.0044798375   0              0.011926133    1.6173111e-15  0              1.5650134e-10  1.1965779e-13  0              2.9952345    
   2600000   6285           200            200            0.0054686567   0.0044798374   0              0.011926133    8.9390648e-18  0              8.650009e-13   1.1965779e-13  0              2.9952345    
   2700000   6285           200            200            0.0054686567   0.0044798374   0              0.011926133    1.0798639e-17  0              1.0449451e-12  1.1965779e-13  0              2.9952345    
   2800000   6285           200            200            0.0054686567   0.0044798374   0              0.011926133    2.0351092e-18  0              1.9693014e-13  1.1965779e-13  0              2.9952345    
   2900000   6285           200            200            0.0054686567   0.0044798374   0              0.011926133    6.2820493e-18  0              6.0789114e-13  1.1965779e-13  0              2.9952345    
   3000000   6285           200            200            0.0054686567   0.0044798374   0              0.011926133    6.846387e-18   0              6.6250005e-13  1.1965779e-13  0              2.9952345    
Loop time of 305.782 on 4 procs for 3000000 steps with 2500 atoms

Performance: 8476622.902 ns/day, 0.000 hours/ns, 9810.906 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 10.456     | 39.214     | 67.838     | 454.0 | 12.82
Neigh   | 3.8663     | 3.9414     | 4.0152     |   3.3 |  1.29
Comm    | 25.788     | 54.343     | 82.49      | 373.2 | 17.77
Output  | 0.27694    | 0.2773     | 0.27768    |   0.1 |  0.09
Modify  | 111.72     | 148.11     | 185.8      | 293.3 | 48.44
Other   |            | 59.9       |            |       | 19.59

Nlocal:            625 ave         876 max         375 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:            1.5 ave           4 max           0 min
Histogram: 2 0 0 0 0 1 0 0 0 1
Neighs:         343.75 ave         688 max           0 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 1375
Ave neighs/atom = 0.55
Neighbor list builds = 164
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 20

#variable lat0 equal 1                    #
variable lat1 equal 3+(100*0.01)+(v_ind*0.01)  # .491+(v_ind*0.001)       # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 500*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.2                                                               
Lattice spacing in x,y,z = 4.2 4.2 4.2

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -3150 ${n1e1} -100 100 -100 100 units box
region box block -3150 3150 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -3150 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -3150 3150 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-3150 -100 -100) to (3150 100 100)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 1500 atoms
  using lattice units in orthogonal box = (-3150 -100 -100) to (3150 100 100)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 1500 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 1001 atoms
  using lattice units in orthogonal box = (-3150 -100 -100) to (3150 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  1500 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  1500 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  1001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  1001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
1500 atoms in group substrate
group slider1 region slider1
1001 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 1001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_20_*.dump id type diameter mass xu yu zu fx fy fz

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 4065 130 130
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 83.91 | 83.92 | 83.93 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   6300           200            200            0              0              0              0              0              0              0              1.1965779e-13  0              6            
    100000   6300           200            200            0.0032215014   2.5644328e-35  0              0.0096645041   582894.66      0              5.6291794e+10  1.1965779e-13  0              3.3323448    
    200000   6300           200            200            0.0011248085  -2.5643997e-35  0              0.0033744255   138730.2       0              1.339757e+10   1.1965779e-13  0              3.082271     
    300000   6300           200            200            7.9191568e-05 -2.5643854e-35  0              0.0002375747   1408.7801      0              1.360499e+08   1.1965779e-13  0              3.0489101    
    400000   6300           200            200            0.021847864   -5.1288156e-35  0              0.065543592    1169.2974      0              1.1292237e+08  1.1965779e-13  0              2.9928364    
    500000   6300           200            200           -4.3512302e-05  2.5644558e-35  0             -0.00013053691  511.37219      0              49384666       1.1965779e-13  0              3.0000563    
    600000   6300           200            200            0.004224379    1.2822141e-34  0              0.012673137    270.58007      0              26130687       1.1965779e-13  0              2.9976146    
    700000   6300           200            200            0.0039739938   1.8700326e-40  0              0.011921981    36.871534      0              3560788.9      1.1965779e-13  0              2.9977025    
    800000   6300           200            200            0.0040464747  -1.2821954e-35  0              0.012139424    4.6877105      0              452705.52      1.1965779e-13  0              2.9976715    
    900000   6300           200            200            0.0040275462   1.282225e-35   0              0.012082639    0.50590069     0              48856.267      1.1965779e-13  0              2.9976777    
   1000000   6300           200            200            0.004000024    7.5145185e-41  0              0.012000072    0.044099737    0              4258.8369      1.1965779e-13  0              2.9976879    
   1100000   6300           200            200            0.0039830679   1.282216e-35   0              0.011949204    0.0027476156   0              265.34504      1.1965779e-13  0              2.9976943    
   1200000   6300           200            200            0.003974822   -6.4110355e-36  0              0.011924466    7.6100928e-05  0              7.349283       1.1965779e-13  0              2.9976974    
   1300000   6300           200            200            0.0039712891  -3.2055096e-36  0              0.011913867    8.0656587e-07  0              0.077892359    1.1965779e-13  0              2.9976988    
   1400000   6300           200            200            0.0039699068  -1.6027631e-35  0              0.011909721    3.2644473e-06  0              0.31525695     1.1965779e-13  0              2.9976993    
   1500000   6300           200            200            0.0039694073   6.4110791e-36  0              0.011908222    1.3302657e-06  0              0.12846754     1.1965779e-13  0              2.9976995    
   1600000   6300           200            200            0.0039692409  -1.2822101e-35  0              0.011907723    3.2527833e-07  0              0.031413052    1.1965779e-13  0              2.9976996    
   1700000   6300           200            200            0.0039691908  -4.8082761e-36  0              0.011907573    6.1035804e-08  0              0.0058944011   1.1965779e-13  0              2.9976996    
   1800000   6300           200            200            0.0039691779   6.411079e-36   0              0.011907534    9.5070408e-09  0              0.00091812195  1.1965779e-13  0              2.9976996    
   1900000   6300           200            200            0.0039691755  -1.6027461e-36  0              0.011907526    1.2621362e-09  0              0.00012188808  1.1965779e-13  0              2.9976996    
   2000000   6300           200            200            0.0039691755   1.2822139e-35  0              0.011907527    1.4250918e-10  0              1.3762517e-05  1.1965779e-13  0              2.9976996    
   2100000   6300           200            200            0.0039691759  -4.808276e-36   0              0.011907528    1.3245511e-11  0              1.2791566e-06  1.1965779e-13  0              2.9976996    
   2200000   6300           200            200            0.0039691761  -8.0136354e-37  0              0.011907528    9.2230621e-13  0              8.9069732e-08  1.1965779e-13  0              2.9976996    
   2300000   6300           200            200            0.0039691763   2.4041665e-36  0              0.011907529    3.5607505e-14  0              3.438718e-09   1.1965779e-13  0              2.9976996    
   2400000   6300           200            200            0.0039691763   8.0138441e-36  0              0.011907529    2.4431008e-17  0              2.3593719e-12  1.1965779e-13  0              2.9976996    
   2500000   6300           200            200            0.0039691763  -2.4041285e-36  0              0.011907529    5.1604178e-16  0              4.9835621e-11  1.1965779e-13  0              2.9976996    
   2600000   6300           200            200            0.0039691763  -6.0101788e-37  0              0.011907529    2.8420327e-16  0              2.7446318e-11  1.1965779e-13  0              2.9976996    
   2700000   6300           200            200            0.0039691763   2.0036464e-37  0              0.011907529    3.3406739e-17  0              3.2261837e-12  1.1965779e-13  0              2.9976996    
   2800000   6300           200            200            0.0039691763  -2.8048198e-36  0              0.011907529    2.5948415e-18  0              2.5059122e-13  1.1965779e-13  0              2.9976996    
   2900000   6300           200            200            0.0039691763  -4.0067215e-37  0              0.011907529    6.4814997e-18  0              6.2593685e-13  1.1965779e-13  0              2.9976996    
   3000000   6300           200            200            0.0039691763  -1.6027472e-36  0              0.011907529    4.5332947e-18  0              4.3779316e-13  1.1965779e-13  0              2.9976996    
Loop time of 309.916 on 4 procs for 3000000 steps with 2501 atoms

Performance: 8363552.981 ns/day, 0.000 hours/ns, 9680.038 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 11.237     | 42.305     | 73.857     | 474.9 | 13.65
Neigh   | 3.9228     | 3.9953     | 4.0692     |   3.1 |  1.29
Comm    | 19.147     | 40.748     | 86.871     | 421.5 | 13.15
Output  | 0.27313    | 0.27346    | 0.2738     |   0.1 |  0.09
Modify  | 113.08     | 164.69     | 183.09     | 232.3 | 53.14
Other   |            | 57.91      |            |       | 18.69

Nlocal:         625.25 ave         876 max         375 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:           1.75 ave           3 max           1 min
Histogram: 2 0 0 0 0 1 0 0 0 1
Neighs:         357.25 ave         715 max           0 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 1429
Ave neighs/atom = 0.57137145
Neighbor list builds = 166
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 21

#variable lat0 equal 1                    #
variable lat1 equal 3+(100*0.01)+(v_ind*0.01)  # .491+(v_ind*0.001)       # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 500*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.21                                                               
Lattice spacing in x,y,z = 4.21 4.21 4.21

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -3157.5 ${n1e1} -100 100 -100 100 units box
region box block -3157.5 3157.5 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -3157.5 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -3157.5 3157.5 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-3157.5 -100 -100) to (3157.5 100 100)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 1500 atoms
  using lattice units in orthogonal box = (-3157.5 -100 -100) to (3157.5 100 100)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 1500 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 1001 atoms
  using lattice units in orthogonal box = (-3157.5 -100 -100) to (3157.5 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  1500 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  1500 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  1001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  1001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
1500 atoms in group substrate
group slider1 region slider1
1001 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 1001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_21_*.dump id type diameter mass xu yu zu fx fy fz

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 4075 130 130
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 84.05 | 84.06 | 84.06 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   6315           200            200            0              0              0              0              0              0              0              1.1965779e-13  0              6            
    100000   6315           200            200            0.0032151062  -1.5989558e-36  0              0.0096453186   583804.19      0              5.637963e+10   1.1965779e-13  0              3.3274751    
    200000   6315           200            200            0.0011288683   6.3958382e-36  0              0.0033866049   140278.57      0              1.35471e+10    1.1965779e-13  0              3.0759355    
    300000   6315           200            200            6.2797227e-05  8.2786902e-40  0              0.00018839168  909.26615      0              87810416       1.1965779e-13  0              3.0453877    
    400000   6315           200            200            0.00017185803  5.116751e-35   0              0.00051557408  6197.75        0              5.9853434e+08  1.1965779e-13  0              3.0007366    
    500000   6315           200            200            0.00080300378 -0.00027145998  0              0.0026804713   428.41655      0              41373404       1.1965779e-13  0              2.9977172    
    600000   6315           200            200            0.0019642765  -0.0036918532   0              0.0095846826   161.13376      0              15561145       1.1965779e-13  0              2.9956256    
    700000   6315           200            200            0.0030357901  -0.0046161329   0              0.013723503    0.0017519715   0              169.19287      1.1965779e-13  0              2.994754     
    800000   6315           200            200            0.0023366972  -0.0044640628   0              0.011474154    2.4587371      0              237447.23      1.1965779e-13  0              2.9951975    
    900000   6315           200            200            0.0024375436  -0.0044944428   0              0.011807074    0.47499241     0              45871.367      1.1965779e-13  0              2.9951316    
   1000000   6315           200            200            0.0024798712  -0.0045094074   0              0.011949021    0.013420874    0              1296.092       1.1965779e-13  0              2.9951018    
   1100000   6315           200            200            0.0024461903  -0.0044999685   0              0.011838539    0.001335298    0              128.95352      1.1965779e-13  0              2.9951243    
   1200000   6315           200            200            0.0024568754  -0.0045024553   0              0.011873081    0.0011141659   0              107.59817      1.1965779e-13  0              2.9951174    
   1300000   6315           200            200            0.0024562697  -0.0045023353   0              0.011871145    0.00012825594  0              12.38604       1.1965779e-13  0              2.9951177    
   1400000   6315           200            200            0.0024551227  -0.0045020618   0              0.01186743     1.0305163e-06  0              0.099519884    1.1965779e-13  0              2.9951185    
   1500000   6315           200            200            0.002455763   -0.0045022113   0              0.0118695      1.0659302e-06  0              0.10293991     1.1965779e-13  0              2.9951181    
   1600000   6315           200            200            0.0024556058  -0.0045021754   0              0.011868993    4.0917883e-07  0              0.039515563    1.1965779e-13  0              2.9951182    
   1700000   6315           200            200            0.0024555961  -0.0045021727   0              0.011868961    2.9697268e-08  0              0.0028679496   1.1965779e-13  0              2.9951182    
   1800000   6315           200            200            0.002455622   -0.0045021789   0              0.011869045    5.3704051e-12  0              5.1863528e-07  1.1965779e-13  0              2.9951182    
   1900000   6315           200            200            0.0024556107  -0.0045021763   0              0.011869008    5.9353815e-10  0              5.7319666e-05  1.1965779e-13  0              2.9951182    
   2000000   6315           200            200            0.0024556127  -0.0045021767   0              0.011869015    1.3344451e-10  0              1.2887116e-05  1.1965779e-13  0              2.9951182    
   2100000   6315           200            200            0.0024556132  -0.0045021768   0              0.011869017    5.4810528e-12  0              5.2932085e-07  1.1965779e-13  0              2.9951182    
   2200000   6315           200            200            0.0024556127  -0.0045021767   0              0.011869015    1.7418384e-13  0              1.6821429e-08  1.1965779e-13  0              2.9951182    
   2300000   6315           200            200            0.0024556129  -0.0045021768   0              0.011869015    2.690718e-13   0              2.5985028e-08  1.1965779e-13  0              2.9951182    
   2400000   6315           200            200            0.0024556129  -0.0045021768   0              0.011869015    3.8572659e-14  0              3.7250713e-09  1.1965779e-13  0              2.9951182    
   2500000   6315           200            200            0.0024556129  -0.0045021768   0              0.011869015    6.3848779e-16  0              6.1660581e-11  1.1965779e-13  0              2.9951182    
   2600000   6315           200            200            0.0024556129  -0.0045021768   0              0.011869015    2.3252161e-16  0              2.2455273e-11  1.1965779e-13  0              2.9951182    
   2700000   6315           200            200            0.0024556129  -0.0045021768   0              0.011869015    1.056478e-16   0              1.0202708e-11  1.1965779e-13  0              2.9951182    
   2800000   6315           200            200            0.0024556129  -0.0045021768   0              0.011869015    1.0965501e-17  0              1.0589696e-12  1.1965779e-13  0              2.9951182    
   2900000   6315           200            200            0.0024556129  -0.0045021768   0              0.011869015    5.6926741e-18  0              5.4975772e-13  1.1965779e-13  0              2.9951182    
   3000000   6315           200            200            0.0024556129  -0.0045021768   0              0.011869015    7.5319794e-18  0              7.2738466e-13  1.1965779e-13  0              2.9951182    
Loop time of 308.079 on 4 procs for 3000000 steps with 2501 atoms

Performance: 8413421.001 ns/day, 0.000 hours/ns, 9737.756 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 11.566     | 39.547     | 68.191     | 445.0 | 12.84
Neigh   | 3.9387     | 4.0162     | 4.0953     |   3.4 |  1.30
Comm    | 18.207     | 40.099     | 82.242     | 392.2 | 13.02
Output  | 0.27399    | 0.27435    | 0.27475    |   0.1 |  0.09
Modify  | 114.85     | 165.2      | 185.16     | 226.9 | 53.62
Other   |            | 58.94      |            |       | 19.13

Nlocal:         625.25 ave         876 max         375 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:           1.75 ave           3 max           1 min
Histogram: 2 0 0 0 0 1 0 0 0 1
Neighs:         343.25 ave         687 max           0 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 1373
Ave neighs/atom = 0.54898041
Neighbor list builds = 164
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 22

#variable lat0 equal 1                    #
variable lat1 equal 3+(100*0.01)+(v_ind*0.01)  # .491+(v_ind*0.001)       # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 500*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.22                                                               
Lattice spacing in x,y,z = 4.22 4.22 4.22

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -3165 ${n1e1} -100 100 -100 100 units box
region box block -3165 3165 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -3165 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -3165 3165 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-3165 -100 -100) to (3165 100 100)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 1500 atoms
  using lattice units in orthogonal box = (-3165 -100 -100) to (3165 100 100)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 1500 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 1001 atoms
  using lattice units in orthogonal box = (-3165 -100 -100) to (3165 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  1500 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  1500 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  1001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  1001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
1500 atoms in group substrate
group slider1 region slider1
1001 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 1001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_22_*.dump id type diameter mass xu yu zu fx fy fz

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 4084 130 130
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 84.19 | 84.2 | 84.2 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   6330           200            200            0              0              0              0              0              0              0              1.1965779e-13  0              6            
    100000   6330           200            200            0.0032077353  -1.2761278e-35  0              0.0096232059   583868.17      0              5.6385808e+10  1.1965779e-13  0              3.3274509    
    200000   6330           200            200            0.0011266993   2.5523066e-35  0              0.0033800979   140375.38      0              1.355645e+10   1.1965779e-13  0              3.0758949    
    300000   6330           200            200            6.346685e-05  -2.5522576e-35  0              0.00019040055  932.23156      0              90028252       1.1965779e-13  0              3.0454265    
    400000   6330           200            200            0.00017411323 -1.2761288e-35  0              0.00052233969  6374.9353      0              6.1564562e+08  1.1965779e-13  0              3.0006015    
    500000   6330           200            200            0.0010820662   4.0875041e-05  0              0.0032053235   606.63601      0              58584563       1.1965779e-13  0              2.9975253    
    600000   6330           200            200            0.0032422237  -0.0021325078   0              0.011859179    212.04027      0              20477332       1.1965779e-13  0              2.9951732    
    700000   6330           200            200            0.0033828194  -0.0025275444   0              0.012676003    22.353649      0              2158755.5      1.1965779e-13  0              2.9949878    
    800000   6330           200            200            0.0029991843  -0.0024268327   0              0.011424385    2.2791376      0              220102.79      1.1965779e-13  0              2.9952455    
    900000   6330           200            200            0.0031801084  -0.002476826    0              0.012017151    0.24519395     0              23679.077      1.1965779e-13  0              2.995123     
   1000000   6330           200            200            0.0031015865  -0.0024644815   0              0.011769241    0.02451791     0              2367.7643      1.1965779e-13  0              2.9951737    
   1100000   6330           200            200            0.0031333698  -0.0024695582   0              0.011869668    0.0022748851   0              219.69212      1.1965779e-13  0              2.9951532    
   1200000   6330           200            200            0.0031207723  -0.0024675687   0              0.011829886    0.00018566155  0              17.929864      1.1965779e-13  0              2.9951613    
   1300000   6330           200            200            0.0031256641  -0.0024683416   0              0.011845334    1.2288773e-05  0              1.1867617      1.1965779e-13  0              2.9951581    
   1400000   6330           200            200            0.0031237959  -0.0024680476   0              0.011839435    5.1525806e-07  0              0.049759936    1.1965779e-13  0              2.9951593    
   1500000   6330           200            200            0.003124498   -0.0024681579   0              0.011841652    2.5645822e-09  0              0.000247669    1.1965779e-13  0              2.9951589    
   1600000   6330           200            200            0.0031242381  -0.0024681171   0              0.011840831    3.5835941e-09  0              0.00034607787  1.1965779e-13  0              2.9951591    
   1700000   6330           200            200            0.0031243329  -0.002468132    0              0.011841131    2.5463821e-09  0              0.00024591136  1.1965779e-13  0              2.995159     
   1800000   6330           200            200            0.0031242988  -0.0024681266   0              0.011841023    8.2433138e-10  0              7.9608025e-05  1.1965779e-13  0              2.995159     
   1900000   6330           200            200            0.0031243108  -0.0024681285   0              0.011841061    1.9951369e-10  0              1.9267604e-05  1.1965779e-13  0              2.995159     
   2000000   6330           200            200            0.0031243067  -0.0024681279   0              0.011841048    4.1277293e-11  0              3.9862655e-06  1.1965779e-13  0              2.995159     
   2100000   6330           200            200            0.0031243081  -0.0024681281   0              0.011841052    7.7228303e-12  0              7.4581567e-07  1.1965779e-13  0              2.995159     
   2200000   6330           200            200            0.0031243076  -0.002468128    0              0.011841051    1.3440211e-12  0              1.2979594e-07  1.1965779e-13  0              2.995159     
   2300000   6330           200            200            0.0031243078  -0.002468128    0              0.011841051    2.2113192e-13  0              2.1355338e-08  1.1965779e-13  0              2.995159     
   2400000   6330           200            200            0.0031243077  -0.002468128    0              0.011841051    3.4734628e-14  0              3.3544218e-09  1.1965779e-13  0              2.995159     
   2500000   6330           200            200            0.0031243077  -0.002468128    0              0.011841051    5.2062762e-15  0              5.0278489e-10  1.1965779e-13  0              2.995159     
   2600000   6330           200            200            0.0031243077  -0.002468128    0              0.011841051    7.8721647e-16  0              7.6023732e-11  1.1965779e-13  0              2.995159     
   2700000   6330           200            200            0.0031243077  -0.002468128    0              0.011841051    1.0824519e-16  0              1.0453545e-11  1.1965779e-13  0              2.995159     
   2800000   6330           200            200            0.0031243077  -0.002468128    0              0.011841051    1.3583903e-17  0              1.3118361e-12  1.1965779e-13  0              2.995159     
   2900000   6330           200            200            0.0031243077  -0.002468128    0              0.011841051    3.6145844e-18  0              3.4907069e-13  1.1965779e-13  0              2.995159     
   3000000   6330           200            200            0.0031243077  -0.002468128    0              0.011841051    2.2703707e-18  0              2.1925616e-13  1.1965779e-13  0              2.995159     
Loop time of 302.58 on 4 procs for 3000000 steps with 2501 atoms

Performance: 8566319.424 ns/day, 0.000 hours/ns, 9914.722 timesteps/s
99.9% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 11.354     | 40.192     | 69.79      | 453.4 | 13.28
Neigh   | 3.9108     | 3.9878     | 4.0657     |   3.4 |  1.32
Comm    | 18.381     | 39.42      | 83.015     | 405.9 | 13.03
Output  | 0.27675    | 0.27709    | 0.27749    |   0.1 |  0.09
Modify  | 110.7      | 161.33     | 179.35     | 230.4 | 53.32
Other   |            | 57.37      |            |       | 18.96

Nlocal:         625.25 ave         876 max         375 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:           1.75 ave           3 max           1 min
Histogram: 2 0 0 0 0 1 0 0 0 1
Neighs:         343.25 ave         687 max           0 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 1373
Ave neighs/atom = 0.54898041
Neighbor list builds = 164
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 23

#variable lat0 equal 1                    #
variable lat1 equal 3+(100*0.01)+(v_ind*0.01)  # .491+(v_ind*0.001)       # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 500*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.23                                                               
Lattice spacing in x,y,z = 4.23 4.23 4.23

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -3172.5 ${n1e1} -100 100 -100 100 units box
region box block -3172.5 3172.5 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -3172.5 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -3172.5 3172.5 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-3172.5 -100 -100) to (3172.5 100 100)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 1499 atoms
  using lattice units in orthogonal box = (-3172.5 -100 -100) to (3172.5 100 100)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 1500 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 1001 atoms
  using lattice units in orthogonal box = (-3172.5 -100 -100) to (3172.5 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  1499 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  1499 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  1001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  1001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
1499 atoms in group substrate
group slider1 region slider1
1001 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 1001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_23_*.dump id type diameter mass xu yu zu fx fy fz

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 4094 130 130
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 84.34 | 84.37 | 84.4 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   6345           200            200            0              0              0              0              0              0              0              1.1965779e-13  0              6            
    100000   6345           200            200            0.0031998162   1.7601339e-40  0              0.0095994487   583778.04      0              5.6490085e+10  1.1965779e-13  0              3.32751      
    200000   6345           200            200            0.001123133   -1.2731128e-35  0              0.0033693989   140199.09      0              1.3566557e+10  1.1965779e-13  0              3.0760368    
    300000   6345           200            200            6.1510905e-05 -2.5461748e-35  0              0.00018453271  881.74364      0              85323136       1.1965779e-13  0              3.0454319    
    400000   6345           200            200            0.00016728814 -2.2916091e-34  0              0.00050186441  5950.3562      0              5.757944e+08   1.1965779e-13  0              3.0010221    
    500000   6345           200            200            0.00076544871 -5.1210782e-05  0              0.0023475569   316.23899      0              30601301       1.1965779e-13  0              2.9978963    
    600000   6345           200            200            0.0034581812   0.0015616745   0              0.0088128692   123.51497      0              11952096       1.1965779e-13  0              2.995832     
    700000   6345           200            200            0.0054573974   0.0029046377   0              0.013467554    5.3357084      0              516317.16      1.1965779e-13  0              2.9948326    
    800000   6345           200            200            0.0048672281   0.0027778776   0              0.011823807    3.7811276      0              365886.01      1.1965779e-13  0              2.9951564    
    900000   6345           200            200            0.0047839198   0.0027592167   0              0.011592543    0.080841583    0              7822.747       1.1965779e-13  0              2.9952069    
   1000000   6345           200            200            0.0048873141   0.0027811591   0              0.011880783    0.029471299    0              2851.8308      1.1965779e-13  0              2.9951473    
   1100000   6345           200            200            0.0048660602   0.0027768574   0              0.011821323    0.0086393969   0              836.00312      1.1965779e-13  0              2.9951592    
   1200000   6345           200            200            0.0048588745   0.0027753137   0              0.01180131     4.1437255e-05  0              4.009733       1.1965779e-13  0              2.9951634    
   1300000   6345           200            200            0.0048640272   0.0027763895   0              0.011815692    0.00010988721  0              10.633387      1.1965779e-13  0              2.9951605    
   1400000   6345           200            200            0.0048633572   0.0027762557   0              0.011813816    1.7664703e-05  0              1.7093493      1.1965779e-13  0              2.9951608    
   1500000   6345           200            200            0.0048628756   0.0027761534   0              0.011812473    5.8013676e-09  0              0.00056137731  1.1965779e-13  0              2.9951611    
   1600000   6345           200            200            0.0048631192   0.002776204    0              0.011813154    3.4915468e-07  0              0.033786432    1.1965779e-13  0              2.995161     
   1700000   6345           200            200            0.0048631066   0.0027762017   0              0.011813118    3.1584206e-08  0              0.0030562892   1.1965779e-13  0              2.995161     
   1800000   6345           200            200            0.0048630778   0.0027761956   0              0.011813038    5.3488656e-10  0              5.1759033e-05  1.1965779e-13  0              2.995161     
   1900000   6345           200            200            0.0048630886   0.0027761978   0              0.011813068    9.8089307e-10  0              9.4917466e-05  1.1965779e-13  0              2.995161     
   2000000   6345           200            200            0.0048630891   0.0027761979   0              0.011813069    4.686324e-11   0              4.5347859e-06  1.1965779e-13  0              2.995161     
   2100000   6345           200            200            0.0048630875   0.0027761976   0              0.011813065    4.1795731e-12  0              4.0444214e-07  1.1965779e-13  0              2.995161     
   2200000   6345           200            200            0.0048630879   0.0027761977   0              0.011813066    2.4770143e-12  0              2.3969169e-07  1.1965779e-13  0              2.995161     
   2300000   6345           200            200            0.004863088    0.0027761977   0              0.011813066    5.0609332e-14  0              4.8972816e-09  1.1965779e-13  0              2.995161     
   2400000   6345           200            200            0.0048630879   0.0027761977   0              0.011813066    1.9668287e-14  0              1.9032289e-09  1.1965779e-13  0              2.995161     
   2500000   6345           200            200            0.0048630879   0.0027761977   0              0.011813066    5.6385872e-15  0              5.4562565e-10  1.1965779e-13  0              2.995161     
   2600000   6345           200            200            0.0048630879   0.0027761977   0              0.011813066    2.4249439e-17  0              2.3465303e-12  1.1965779e-13  0              2.995161     
   2700000   6345           200            200            0.0048630879   0.0027761977   0              0.011813066    7.0063036e-17  0              6.779746e-12   1.1965779e-13  0              2.995161     
   2800000   6345           200            200            0.0048630879   0.0027761977   0              0.011813066    1.3494817e-17  0              1.3058445e-12  1.1965779e-13  0              2.995161     
   2900000   6345           200            200            0.0048630879   0.0027761977   0              0.011813066    1.2833392e-21  0              1.2418408e-16  1.1965779e-13  0              2.995161     
   3000000   6345           200            200            0.0048630879   0.0027761977   0              0.011813066    1.6548147e-19  0              1.6013042e-14  1.1965779e-13  0              2.995161     
Loop time of 293.942 on 4 procs for 3000000 steps with 2500 atoms

Performance: 8818078.620 ns/day, 0.000 hours/ns, 10206.110 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 10.77      | 37.373     | 64.219     | 433.3 | 12.71
Neigh   | 3.9444     | 4.0266     | 4.1083     |   3.6 |  1.37
Comm    | 25.728     | 52.217     | 78.697     | 353.6 | 17.76
Output  | 0.27163    | 0.27195    | 0.27233    |   0.1 |  0.09
Modify  | 109.2      | 143.82     | 177.81     | 279.7 | 48.93
Other   |            | 56.23      |            |       | 19.13

Nlocal:            625 ave         876 max         375 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:            1.5 ave           4 max           0 min
Histogram: 2 0 0 0 0 1 0 0 0 1
Neighs:         343.75 ave         688 max           0 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 1375
Ave neighs/atom = 0.55
Neighbor list builds = 164
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 24

#variable lat0 equal 1                    #
variable lat1 equal 3+(100*0.01)+(v_ind*0.01)  # .491+(v_ind*0.001)       # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 500*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.24                                                               
Lattice spacing in x,y,z = 4.24 4.24 4.24

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -3180 ${n1e1} -100 100 -100 100 units box
region box block -3180 3180 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -3180 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -3180 3180 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-3180 -100 -100) to (3180 100 100)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 1500 atoms
  using lattice units in orthogonal box = (-3180 -100 -100) to (3180 100 100)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 1500 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 1001 atoms
  using lattice units in orthogonal box = (-3180 -100 -100) to (3180 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  1500 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  1500 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  1001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  1001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
1500 atoms in group substrate
group slider1 region slider1
1001 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 1001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_24_*.dump id type diameter mass xu yu zu fx fy fz

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 4104 130 130
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 84.54 | 84.55 | 84.55 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   6360           200            200            0              0              0              0              0              0              0              1.1965779e-13  0              6            
    100000   6360           200            200            0.0031923917   4.644233e-42   0              0.0095771751   583806.79      0              5.6379881e+10  1.1965779e-13  0              3.3275219    
    200000   6360           200            200            0.0011209466  -1.2701127e-35  0              0.0033628399   140288.73      0              1.3548081e+10  1.1965779e-13  0              3.0759833    
    300000   6360           200            200            6.2340785e-05  8.7251182e-40  0              0.00018702236  908.89562      0              87774634       1.1965779e-13  0              3.0454429    
    400000   6360           200            200            0.00016965458  1.0161046e-34  0              0.00050896373  6132.0117      0              5.9218579e+08  1.1965779e-13  0              3.0008586    
    500000   6360           200            200            0.001025715    0.00047551733  0              0.0026016278   407.80717      0              39383097       1.1965779e-13  0              2.9977992    
    600000   6360           200            200            0.0035970197   0.0014035083   0              0.009387551    156.84417      0              15146887       1.1965779e-13  0              2.9956985    
    700000   6360           200            200            0.004722574    0.00098349043  0              0.013184232    12.20411       0              1178585.6      1.1965779e-13  0              2.9948889    
    800000   6360           200            200            0.0041355092   0.0010283755   0              0.011378152    2.3549384      0              227423.09      1.1965779e-13  0              2.9952507    
    900000   6360           200            200            0.0042969805   0.0010196433   0              0.011871298    0.44775093     0              43240.58       1.1965779e-13  0              2.9951482    
   1000000   6360           200            200            0.0042665534   0.0010200491   0              0.011779611    0.068921431    0              6655.9385      1.1965779e-13  0              2.9951677    
   1100000   6360           200            200            0.0042657967   0.0010200493   0              0.011777341    0.0088438086   0              854.07174      1.1965779e-13  0              2.9951677    
   1200000   6360           200            200            0.0042704928   0.0010199915   0              0.011791487    0.00093363584  0              90.163867      1.1965779e-13  0              2.995165     
   1300000   6360           200            200            0.0042673093   0.0010200319   0              0.011781896    7.6438594e-05  0              7.3818923      1.1965779e-13  0              2.9951669    
   1400000   6360           200            200            0.0042689092   0.0010200113   0              0.011786716    4.0472615e-06  0              0.39085555     1.1965779e-13  0              2.995166     
   1500000   6360           200            200            0.0042682166   0.0010200203   0              0.011784629    5.3760195e-08  0              0.0051917748   1.1965779e-13  0              2.9951664    
   1600000   6360           200            200            0.0042684865   0.0010200167   0              0.011785443    1.1800346e-08  0              0.001139593    1.1965779e-13  0              2.9951662    
   1700000   6360           200            200            0.0042683906   0.001020018    0              0.011785154    1.1540487e-08  0              0.0011144976   1.1965779e-13  0              2.9951663    
   1800000   6360           200            200            0.0042684215   0.0010200176   0              0.011785247    3.6821181e-09  0              0.00035559261  1.1965779e-13  0              2.9951663    
   1900000   6360           200            200            0.0042684128   0.0010200177   0              0.011785221    7.8766997e-10  0              7.6067527e-05  1.1965779e-13  0              2.9951663    
   2000000   6360           200            200            0.0042684147   0.0010200177   0              0.011785227    1.3220977e-10  0              1.2767873e-05  1.1965779e-13  0              2.9951663    
   2100000   6360           200            200            0.0042684145   0.0010200177   0              0.011785226    1.8308729e-11  0              1.768126e-06   1.1965779e-13  0              2.9951663    
   2200000   6360           200            200            0.0042684144   0.0010200177   0              0.011785226    2.1026838e-12  0              2.0306215e-07  1.1965779e-13  0              2.9951663    
   2300000   6360           200            200            0.0042684145   0.0010200177   0              0.011785226    1.9359724e-13  0              1.8696236e-08  1.1965779e-13  0              2.9951663    
   2400000   6360           200            200            0.0042684145   0.0010200177   0              0.011785226    1.2658528e-14  0              1.22247e-09    1.1965779e-13  0              2.9951663    
   2500000   6360           200            200            0.0042684145   0.0010200177   0              0.011785226    3.6711364e-16  0              3.5453207e-11  1.1965779e-13  0              2.9951663    
   2600000   6360           200            200            0.0042684145   0.0010200177   0              0.011785226    6.8117157e-19  0              6.5782674e-14  1.1965779e-13  0              2.9951663    
   2700000   6360           200            200            0.0042684145   0.0010200177   0              0.011785226    1.1325106e-17  0              1.0936976e-12  1.1965779e-13  0              2.9951663    
   2800000   6360           200            200            0.0042684145   0.0010200177   0              0.011785226    6.6241731e-18  0              6.3971522e-13  1.1965779e-13  0              2.9951663    
   2900000   6360           200            200            0.0042684145   0.0010200177   0              0.011785226    4.6031688e-18  0              4.4454109e-13  1.1965779e-13  0              2.9951663    
   3000000   6360           200            200            0.0042684145   0.0010200177   0              0.011785226    7.4601532e-18  0              7.2044819e-13  1.1965779e-13  0              2.9951663    
Loop time of 294.91 on 4 procs for 3000000 steps with 2501 atoms

Performance: 8789125.347 ns/day, 0.000 hours/ns, 10172.599 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 10.952     | 37.932     | 65.438     | 435.4 | 12.86
Neigh   | 3.8966     | 3.9763     | 4.057      |   3.5 |  1.35
Comm    | 18.531     | 38.019     | 78.481     | 383.6 | 12.89
Output  | 0.27749    | 0.27784    | 0.27817    |   0.1 |  0.09
Modify  | 109.67     | 158.39     | 177.6      | 224.3 | 53.71
Other   |            | 56.31      |            |       | 19.09

Nlocal:         625.25 ave         876 max         375 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:           1.75 ave           3 max           1 min
Histogram: 2 0 0 0 0 1 0 0 0 1
Neighs:         342.25 ave         685 max           0 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 1369
Ave neighs/atom = 0.54738105
Neighbor list builds = 164
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 25

#variable lat0 equal 1                    #
variable lat1 equal 3+(100*0.01)+(v_ind*0.01)  # .491+(v_ind*0.001)       # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 500*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.25                                                               
Lattice spacing in x,y,z = 4.25 4.25 4.25

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -3187.5 ${n1e1} -100 100 -100 100 units box
region box block -3187.5 3187.5 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -3187.5 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -3187.5 3187.5 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-3187.5 -100 -100) to (3187.5 100 100)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 1500 atoms
  using lattice units in orthogonal box = (-3187.5 -100 -100) to (3187.5 100 100)
  create_atoms CPU = 0.000 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 1500 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 1001 atoms
  using lattice units in orthogonal box = (-3187.5 -100 -100) to (3187.5 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  1500 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  1500 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  1001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  1001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
1500 atoms in group substrate
group slider1 region slider1
1001 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 1001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_25_*.dump id type diameter mass xu yu zu fx fy fz

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 4113 130 130
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 84.75 | 84.75 | 84.76 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   6375           200            200            0              0              0              0              0              0              0              1.1965779e-13  0              6            
    100000   6375           200            200            0.0031837553  -6.3356311e-36  0              0.0095512658   583450.85      0              5.6345507e+10  1.1965779e-13  0              3.3281467    
    200000   6375           200            200            0.0011203159   1.5613144e-40  0              0.0033609477   140689.12      0              1.3586749e+10  1.1965779e-13  0              3.0755262    
    300000   6375           200            200            6.2524287e-05 -5.0684714e-35  0              0.00018757286  918.27353      0              88680285       1.1965779e-13  0              3.0453138    
    400000   6375           200            200            4.9335115e-05  5.0685477e-35  0              0.00014800534  595.29202      0              57489042       1.1965779e-13  0              3.0066498    
    500000   6375           200            200            0.0031641299   5.0685371e-35  0              0.0094923898   1433.995       0              1.3848497e+08  1.1965779e-13  0              2.9964615    
    600000   6375           200            200            0.0036959999   2.5342799e-35  0              0.011088       198.23625      0              19144238       1.1965779e-13  0              2.9960294    
    700000   6375           200            200            0.004290092    2.2201029e-40  0              0.012870276    15.600959      0              1506629        1.1965779e-13  0              2.9955971    
    800000   6375           200            200            0.0041221668   1.2671448e-35  0              0.0123665      0.050299532    0              4857.5687      1.1965779e-13  0              2.9957074    
    900000   6375           200            200            0.0039538351   1.2682002e-40  0              0.011861505    0.39327074     0              37979.274      1.1965779e-13  0              2.9958246    
   1000000   6375           200            200            0.0039068931   6.3357474e-36  0              0.011720679    0.05228902     0              5049.6993      1.1965779e-13  0              2.9958583    
   1100000   6375           200            200            0.0039100694  -3.1678068e-35  0              0.011730208    9.590528e-05   0              9.2618454      1.1965779e-13  0              2.9958563    
   1200000   6375           200            200            0.0039177144   1.0611748e-40  0              0.011753143    0.00071914666  0              69.450037      1.1965779e-13  0              2.995851     
   1300000   6375           200            200            0.0039204404  -6.3355323e-36  0              0.011761321    0.00015316047  0              14.791142      1.1965779e-13  0              2.995849     
   1400000   6375           200            200            0.0039205325   3.1679239e-36  0              0.011761597    2.2008743e-06  0              0.21254469     1.1965779e-13  0              2.995849     
   1500000   6375           200            200            0.0039202027  -3.958703e-37   0              0.011760608    1.1190556e-06  0              0.10807038     1.1965779e-13  0              2.9958492    
   1600000   6375           200            200            0.0039200544  -2.3757559e-36  0              0.011760163    4.0466632e-07  0              0.039079777    1.1965779e-13  0              2.9958493    
   1700000   6375           200            200            0.0039200377  -1.5838014e-36  0              0.011760113    1.4282911e-08  0              0.0013793413   1.1965779e-13  0              2.9958493    
   1800000   6375           200            200            0.0039200508   3.1679253e-36  0              0.011760153    1.3356324e-09  0              0.00012898582  1.1965779e-13  0              2.9958493    
   1900000   6375           200            200            0.0039200585  -6.3355281e-36  0              0.011760176    9.7245172e-10  0              9.3912426e-05  1.1965779e-13  0              2.9958493    
   2000000   6375           200            200            0.0039200599   1.2671379e-35  0              0.01176018     6.2793338e-11  0              6.0641312e-06  1.1965779e-13  0              2.9958493    
   2100000   6375           200            200            0.0039200594  -3.1678071e-35  0              0.011760178    8.828978e-13   0              8.526395e-08   1.1965779e-13  0              2.9958493    
   2200000   6375           200            200            0.0039200591  -2.5342436e-35  0              0.011760177    2.1203353e-12  0              2.0476681e-07  1.1965779e-13  0              2.9958493    
   2300000   6375           200            200            0.003920059    2.5342651e-35  0              0.011760177    2.2424988e-13  0              2.1656449e-08  1.1965779e-13  0              2.9958493    
   2400000   6375           200            200            0.003920059   -7.6027522e-35  0              0.011760177    5.536611e-19   0              5.3468627e-14  1.1965779e-13  0              2.9958493    
   2500000   6375           200            200            0.003920059    5.0685194e-35  0              0.011760177    4.136989e-15   0              3.9952078e-10  1.1965779e-13  0              2.9958493    
   2600000   6375           200            200            0.003920059    3.8013923e-35  0              0.011760177    7.142396e-16   0              6.8976149e-11  1.1965779e-13  0              2.9958493    
   2700000   6375           200            200            0.003920059    2.5342651e-35  0              0.011760177    3.5580021e-18  0              3.4360638e-13  1.1965779e-13  0              2.9958493    
   2800000   6375           200            200            0.003920059    2.5342651e-35  0              0.011760177    7.3135233e-18  0              7.0628773e-13  1.1965779e-13  0              2.9958493    
   2900000   6375           200            200            0.003920059   -3.8013707e-35  0              0.011760177    1.586658e-19   0              1.5322808e-14  1.1965779e-13  0              2.9958493    
   3000000   6375           200            200            0.003920059    1.102103e-40   0              0.011760177    1.1505448e-18  0              1.1111138e-13  1.1965779e-13  0              2.9958493    
Loop time of 293.975 on 4 procs for 3000000 steps with 2501 atoms

Performance: 8817088.118 ns/day, 0.000 hours/ns, 10204.963 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 10.941     | 37.122     | 64.095     | 427.0 | 12.63
Neigh   | 3.9461     | 4.0259     | 4.1073     |   3.5 |  1.37
Comm    | 18.739     | 37.905     | 77.209     | 373.5 | 12.89
Output  | 0.26922    | 0.26954    | 0.26986    |   0.1 |  0.09
Modify  | 109.45     | 158        | 178.1      | 224.4 | 53.75
Other   |            | 56.66      |            |       | 19.27

Nlocal:         625.25 ave         876 max         375 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:           1.75 ave           3 max           1 min
Histogram: 2 0 0 0 0 1 0 0 0 1
Neighs:         353.25 ave         707 max           0 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 1413
Ave neighs/atom = 0.56497401
Neighbor list builds = 164
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 26

#variable lat0 equal 1                    #
variable lat1 equal 3+(100*0.01)+(v_ind*0.01)  # .491+(v_ind*0.001)       # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 500*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.26                                                               
Lattice spacing in x,y,z = 4.26 4.26 4.26

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -3195 ${n1e1} -100 100 -100 100 units box
region box block -3195 3195 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -3195 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -3195 3195 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-3195 -100 -100) to (3195 100 100)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 1500 atoms
  using lattice units in orthogonal box = (-3195 -100 -100) to (3195 100 100)
  create_atoms CPU = 0.000 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 1500 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 1001 atoms
  using lattice units in orthogonal box = (-3195 -100 -100) to (3195 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  1500 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  1500 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  1001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  1001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
1500 atoms in group substrate
group slider1 region slider1
1001 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 1001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_26_*.dump id type diameter mass xu yu zu fx fy fz

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 4123 130 130
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 84.89 | 84.89 | 84.9 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   6390           200            200            0              0              0              0              0              0              0              1.1965779e-13  0              6            
    100000   6390           200            200            0.0031770747   2.2754757e-34  0              0.0095312242   583710.54      0              5.6370586e+10  1.1965779e-13  0              3.327639     
    200000   6390           200            200            0.0011145739   1.7662372e-40  0              0.0033437217   140066.01      0              1.3526573e+10  1.1965779e-13  0              3.0762555    
    300000   6390           200            200            6.0546202e-05  7.6423959e-43  0              0.0001816386   866.9866       0              83727360       1.1965779e-13  0              3.0455137    
    400000   6390           200            200            0.00016800208  5.0566706e-35  0              0.00050400624  6075.0368      0              5.8668357e+08  1.1965779e-13  0              3.0009531    
    500000   6390           200            200            0.0010603155   0.00021606834  0              0.0029648781   558.36861      0              53923244       1.1965779e-13  0              2.9976376    
    600000   6390           200            200            0.0028443439  -0.00027820207  0              0.0088112336   123.24729      0              11902341       1.1965779e-13  0              2.9958876    
    700000   6390           200            200            0.0033858129  -0.00092629918  0              0.011083738    23.825827      0              2300927.9      1.1965779e-13  0              2.9953632    
    800000   6390           200            200            0.003591583   -0.0009480917   0              0.011722841    3.7551508      0              362645.58      1.1965779e-13  0              2.9952218    
    900000   6390           200            200            0.0036217633  -0.00095118727  0              0.011816477    0.44182163     0              42667.971      1.1965779e-13  0              2.9952003    
   1000000   6390           200            200            0.0036131291  -0.0009504666   0              0.011789854    0.036465707    0              3521.597       1.1965779e-13  0              2.9952053    
   1100000   6390           200            200            0.0036031789  -0.0009495565   0              0.011759093    0.001629134    0              157.3301       1.1965779e-13  0              2.9952117    
   1200000   6390           200            200            0.0035975805  -0.00094903304  0              0.011741775    3.0035678e-06  0              0.29006308     1.1965779e-13  0              2.9952153    
   1300000   6390           200            200            0.0035951124  -0.00094879954  0              0.011734137    1.8160359e-05  0              1.7537975      1.1965779e-13  0              2.995217     
   1400000   6390           200            200            0.0035941872  -0.00094871126  0              0.011731273    9.8247954e-06  0              0.94880842     1.1965779e-13  0              2.9952176    
   1500000   6390           200            200            0.0035938902  -0.00094868267  0              0.011730353    2.4306668e-06  0              0.2347364      1.1965779e-13  0              2.9952178    
   1600000   6390           200            200            0.0035938127  -0.00094867512  0              0.011730113    4.0785118e-07  0              0.039387348    1.1965779e-13  0              2.9952178    
   1700000   6390           200            200            0.0035938001  -0.00094867384  0              0.011730074    5.040277e-08   0              0.0048675388   1.1965779e-13  0              2.9952178    
   1800000   6390           200            200            0.0035938019  -0.00094867398  0              0.01173008     4.450546e-09   0              0.00042980188  1.1965779e-13  0              2.9952178    
   1900000   6390           200            200            0.0035938048  -0.00094867425  0              0.011730089    2.2922391e-10  0              2.2136805e-05  1.1965779e-13  0              2.9952178    
   2000000   6390           200            200            0.0035938066  -0.00094867441  0              0.011730094    1.7182647e-12  0              1.6593771e-07  1.1965779e-13  0              2.9952178    
   2100000   6390           200            200            0.0035938074  -0.00094867449  0              0.011730097    1.3219848e-12  0              1.2766783e-07  1.1965779e-13  0              2.9952178    
   2200000   6390           200            200            0.0035938077  -0.00094867452  0              0.011730098    9.1916176e-13  0              8.8766063e-08  1.1965779e-13  0              2.9952178    
   2300000   6390           200            200            0.0035938078  -0.00094867453  0              0.011730098    2.4739775e-13  0              2.3891904e-08  1.1965779e-13  0              2.9952178    
   2400000   6390           200            200            0.0035938078  -0.00094867453  0              0.011730098    4.3848024e-14  0              4.2345283e-09  1.1965779e-13  0              2.9952178    
   2500000   6390           200            200            0.0035938078  -0.00094867453  0              0.011730098    5.7101932e-15  0              5.5144959e-10  1.1965779e-13  0              2.9952178    
   2600000   6390           200            200            0.0035938078  -0.00094867453  0              0.011730098    5.6388927e-16  0              5.4456389e-11  1.1965779e-13  0              2.9952178    
   2700000   6390           200            200            0.0035938078  -0.00094867453  0              0.011730098    2.8524621e-17  0              2.7547037e-12  1.1965779e-13  0              2.9952178    
   2800000   6390           200            200            0.0035938078  -0.00094867453  0              0.011730098    1.4321025e-21  0              1.3830221e-16  1.1965779e-13  0              2.9952178    
   2900000   6390           200            200            0.0035938078  -0.00094867453  0              0.011730098    2.4885329e-19  0              2.403247e-14   1.1965779e-13  0              2.9952178    
   3000000   6390           200            200            0.0035938078  -0.00094867453  0              0.011730098    1.6462255e-19  0              1.5898068e-14  1.1965779e-13  0              2.9952178    
Loop time of 295.474 on 4 procs for 3000000 steps with 2501 atoms

Performance: 8772342.024 ns/day, 0.000 hours/ns, 10153.174 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 11.028     | 37.567     | 64.589     | 429.2 | 12.71
Neigh   | 3.9784     | 4.0588     | 4.139      |   3.5 |  1.37
Comm    | 18.637     | 37.827     | 77.457     | 376.8 | 12.80
Output  | 0.27258    | 0.27291    | 0.27325    |   0.1 |  0.09
Modify  | 111.14     | 159.5      | 178.77     | 222.2 | 53.98
Other   |            | 56.25      |            |       | 19.04

Nlocal:         625.25 ave         876 max         375 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:           1.75 ave           3 max           1 min
Histogram: 2 0 0 0 0 1 0 0 0 1
Neighs:         345.25 ave         691 max           0 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 1381
Ave neighs/atom = 0.55217913
Neighbor list builds = 164
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 27

#variable lat0 equal 1                    #
variable lat1 equal 3+(100*0.01)+(v_ind*0.01)  # .491+(v_ind*0.001)       # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 500*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.27                                                               
Lattice spacing in x,y,z = 4.27 4.27 4.27

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -3202.5 ${n1e1} -100 100 -100 100 units box
region box block -3202.5 3202.5 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -3202.5 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -3202.5 3202.5 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-3202.5 -100 -100) to (3202.5 100 100)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 1500 atoms
  using lattice units in orthogonal box = (-3202.5 -100 -100) to (3202.5 100 100)
  create_atoms CPU = 0.000 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 1500 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 1001 atoms
  using lattice units in orthogonal box = (-3202.5 -100 -100) to (3202.5 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  1500 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  1500 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  1001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  1001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
1500 atoms in group substrate
group slider1 region slider1
1001 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 1001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_27_*.dump id type diameter mass xu yu zu fx fy fz

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 4133 130 130
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 85.1 | 85.1 | 85.11 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   6405           200            200            0              0              0              0              0              0              0              1.1965779e-13  0              6            
    100000   6405           200            200            0.0031692289   2.5223968e-35  0              0.0095076866   583605.71      0              5.6360462e+10  1.1965779e-13  0              3.3276705    
    200000   6405           200            200            0.0011114273   4.3837098e-41  0              0.0033342818   139965.46      0              1.3516862e+10  1.1965779e-13  0              3.0762294    
    300000   6405           200            200            5.9553331e-05  1.1265659e-42  0              0.00017865999  843.66921      0              81475534       1.1965779e-13  0              3.0454047    
    400000   6405           200            200            0.00016351948  1.2855786e-40  0              0.00049055843  5806.2523      0              5.6072629e+08  1.1965779e-13  0              3.0011177    
    500000   6405           200            200            0.00055527056 -0.00035890814  0              0.0020247198   194.86892      0              18819046       1.1965779e-13  0              2.9979939    
    600000   6405           200            200            0.0022408264  -0.0015171091   0              0.0082395884   90.064984      0              8697831.5      1.1965779e-13  0              2.9959041    
    700000   6405           200            200            0.0042909777  -0.00051035223  0              0.013383285    4.4390069      0              428687.52      1.1965779e-13  0              2.994779     
    800000   6405           200            200            0.0036441122  -0.00061110542  0              0.011543442    3.5767893      0              345420.71      1.1965779e-13  0              2.995143     
    900000   6405           200            200            0.0036441381  -0.00062398748  0              0.011556402    0.31706509     0              30619.877      1.1965779e-13  0              2.9951433    
   1000000   6405           200            200            0.0037216465  -0.00062538984  0              0.011790329    0.00023326276  0              22.526847      1.1965779e-13  0              2.9950942    
   1100000   6405           200            200            0.0036842879  -0.00062636584  0              0.01167923     0.0046734563   0              451.32896      1.1965779e-13  0              2.995117     
   1200000   6405           200            200            0.0036918798  -0.00062587996  0              0.011701519    0.0012436355   0              120.10141      1.1965779e-13  0              2.9951125    
   1300000   6405           200            200            0.0036932902  -0.00062578009  0              0.011705651    6.2687348e-05  0              6.0538954      1.1965779e-13  0              2.9951116    
   1400000   6405           200            200            0.0036915813  -0.00062589505  0              0.011700639    8.2281847e-07  0              0.079461919    1.1965779e-13  0              2.9951127    
   1500000   6405           200            200            0.0036922217  -0.00062585271  0              0.011702518    2.2748307e-06  0              0.21968686     1.1965779e-13  0              2.9951123    
   1600000   6405           200            200            0.0036921408  -0.00062585782  0              0.01170228     3.729166e-07   0              0.036013616    1.1965779e-13  0              2.9951123    
   1700000   6405           200            200            0.0036920938  -0.00062586105  0              0.011702142    8.7275795e-09  0              0.00084284716  1.1965779e-13  0              2.9951124    
   1800000   6405           200            200            0.0036921275  -0.00062585879  0              0.011702241    1.3639578e-09  0              0.00013172129  1.1965779e-13  0              2.9951124    
   1900000   6405           200            200            0.0036921175  -0.00062585945  0              0.011702212    9.3287046e-10  0              9.0089952e-05  1.1965779e-13  0              2.9951124    
   2000000   6405           200            200            0.0036921178  -0.00062585944  0              0.011702213    9.7293317e-11  0              9.3958922e-06  1.1965779e-13  0              2.9951124    
   2100000   6405           200            200            0.003692119   -0.00062585935  0              0.011702216    4.5665455e-13  0              4.4100428e-08  1.1965779e-13  0              2.9951124    
   2200000   6405           200            200            0.0036921184  -0.0006258594   0              0.011702215    1.0029326e-12  0              9.6856053e-08  1.1965779e-13  0              2.9951124    
   2300000   6405           200            200            0.0036921185  -0.00062585939  0              0.011702215    3.3367199e-13  0              3.2223652e-08  1.1965779e-13  0              2.9951124    
   2400000   6405           200            200            0.0036921185  -0.00062585939  0              0.011702215    2.1137466e-14  0              2.0413052e-09  1.1965779e-13  0              2.9951124    
   2500000   6405           200            200            0.0036921185  -0.00062585939  0              0.011702215    5.5492543e-17  0              5.3590726e-12  1.1965779e-13  0              2.9951124    
   2600000   6405           200            200            0.0036921185  -0.00062585939  0              0.011702215    5.8292988e-16  0              5.6295195e-11  1.1965779e-13  0              2.9951124    
   2700000   6405           200            200            0.0036921185  -0.00062585939  0              0.011702215    1.0225442e-16  0              9.8750002e-12  1.1965779e-13  0              2.9951124    
   2800000   6405           200            200            0.0036921185  -0.00062585939  0              0.011702215    4.9501938e-18  0              4.7805429e-13  1.1965779e-13  0              2.9951124    
   2900000   6405           200            200            0.0036921185  -0.00062585939  0              0.011702215    5.94764e-19    0              5.743805e-14   1.1965779e-13  0              2.9951124    
   3000000   6405           200            200            0.0036921185  -0.00062585939  0              0.011702215    4.6952818e-19  0              4.5343671e-14  1.1965779e-13  0              2.9951124    
Loop time of 295.792 on 4 procs for 3000000 steps with 2501 atoms

Performance: 8762917.874 ns/day, 0.000 hours/ns, 10142.266 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 11.022     | 37.83      | 65.262     | 432.4 | 12.79
Neigh   | 3.911      | 3.9945     | 4.0791     |   3.7 |  1.35
Comm    | 17.546     | 23.648     | 28.656     |  95.4 |  7.99
Output  | 0.27567    | 0.27598    | 0.27632    |   0.1 |  0.09
Modify  | 168.98     | 173.69     | 177.72     |  28.0 | 58.72
Other   |            | 56.35      |            |       | 19.05

Nlocal:         625.25 ave         877 max         374 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:           1.75 ave           3 max           1 min
Histogram: 2 0 0 0 0 1 0 0 0 1
Neighs:         341.75 ave         684 max           0 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 1367
Ave neighs/atom = 0.54658137
Neighbor list builds = 164
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 28

#variable lat0 equal 1                    #
variable lat1 equal 3+(100*0.01)+(v_ind*0.01)  # .491+(v_ind*0.001)       # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 500*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.28                                                               
Lattice spacing in x,y,z = 4.28 4.28 4.28

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -3210 ${n1e1} -100 100 -100 100 units box
region box block -3210 3210 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -3210 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -3210 3210 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-3210 -100 -100) to (3210 100 100)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 1500 atoms
  using lattice units in orthogonal box = (-3210 -100 -100) to (3210 100 100)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 1500 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 1001 atoms
  using lattice units in orthogonal box = (-3210 -100 -100) to (3210 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  1500 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  1500 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  1001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  1001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
1500 atoms in group substrate
group slider1 region slider1
1001 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 1001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_28_*.dump id type diameter mass xu yu zu fx fy fz

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 4142 130 130
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 85.18 | 85.21 | 85.23 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   6420           200            200            0              0              0              0              0              0              0              1.1965779e-13  0              6            
    100000   6420           200            200            0.0031621585   2.2673882e-40  0              0.0094864756   583699.2       0              5.6369491e+10  1.1965779e-13  0              3.3275892    
    200000   6420           200            200            0.0011100663  -2.5164736e-35  0              0.0033301989   140212.59      0              1.3540728e+10  1.1965779e-13  0              3.075967     
    300000   6420           200            200            6.1948359e-05  7.2191118e-41  0              0.00018584508  914.35171      0              88301544       1.1965779e-13  0              3.0453293    
    400000   6420           200            200            0.00016709266  6.2912442e-35  0              0.00050127797  6067.2236      0              5.8592903e+08  1.1965779e-13  0              3.000822     
    500000   6420           200            200            0.00052126954 -0.00040445215  0              0.0019682608   145.75962      0              14076421       1.1965779e-13  0              2.9980217    
    600000   6420           200            200            0.001514875   -0.0027814482   0              0.0073260733   8.5796412      0              828560.33      1.1965779e-13  0              2.9961026    
    700000   6420           200            200            0.0031729555  -0.0035203393   0              0.013039206    12.762937      0              1232553.1      1.1965779e-13  0              2.9948032    
    800000   6420           200            200            0.0026263193  -0.0034985759   0              0.011377534    3.0319114      0              292800.31      1.1965779e-13  0              2.9951309    
    900000   6420           200            200            0.0027276163  -0.003522877    0              0.011705726    0.50279663     0              48556.5        1.1965779e-13  0              2.9950662    
   1000000   6420           200            200            0.002722952   -0.0035224977   0              0.011691354    0.066118365    0              6385.2384      1.1965779e-13  0              2.9950679    
   1100000   6420           200            200            0.0027126058  -0.0035209736   0              0.011658791    0.0069712371   0              673.23218      1.1965779e-13  0              2.995075     
   1200000   6420           200            200            0.002720484   -0.0035220926   0              0.011683545    0.00055342332  0              53.445663      1.1965779e-13  0              2.9950698    
   1300000   6420           200            200            0.0027163966  -0.0035215196   0              0.01167071     2.6292145e-05  0              2.5391072      1.1965779e-13  0              2.9950725    
   1400000   6420           200            200            0.0027181822  -0.0035217681   0              0.011676315    1.6093254e-07  0              0.015541713    1.1965779e-13  0              2.9950713    
   1500000   6420           200            200            0.0027174893  -0.0035216723   0              0.01167414     1.6962761e-07  0              0.016381421    1.1965779e-13  0              2.9950718    
   1600000   6420           200            200            0.0027177313  -0.0035217055   0              0.011674899    1.1628904e-07  0              0.011230363    1.1965779e-13  0              2.9950716    
   1700000   6420           200            200            0.0027176561  -0.0035216953   0              0.011674664    3.3139043e-08  0              0.0032003316   1.1965779e-13  0              2.9950717    
   1800000   6420           200            200            0.0027176758  -0.0035216979   0              0.011674725    6.5360502e-09  0              0.00063120495  1.1965779e-13  0              2.9950717    
   1900000   6420           200            200            0.0027176722  -0.0035216975   0              0.011674714    1.0099326e-09  0              9.7532062e-05  1.1965779e-13  0              2.9950717    
   2000000   6420           200            200            0.0027176721  -0.0035216974   0              0.011674714    1.263316e-10   0              1.2200202e-05  1.1965779e-13  0              2.9950717    
   2100000   6420           200            200            0.0027176727  -0.0035216975   0              0.011674715    1.2571678e-11  0              1.2140827e-06  1.1965779e-13  0              2.9950717    
   2200000   6420           200            200            0.0027176723  -0.0035216975   0              0.011674714    9.1112065e-13  0              8.7989511e-08  1.1965779e-13  0              2.9950717    
   2300000   6420           200            200            0.0027176725  -0.0035216975   0              0.011674715    3.5112281e-14  0              3.3908928e-09  1.1965779e-13  0              2.9950717    
   2400000   6420           200            200            0.0027176724  -0.0035216975   0              0.011674715    5.2389488e-18  0              5.0594017e-13  1.1965779e-13  0              2.9950717    
   2500000   6420           200            200            0.0027176724  -0.0035216975   0              0.011674715    5.2447978e-16  0              5.0650503e-11  1.1965779e-13  0              2.9950717    
   2600000   6420           200            200            0.0027176724  -0.0035216975   0              0.011674715    3.2396303e-16  0              3.1286031e-11  1.1965779e-13  0              2.9950717    
   2700000   6420           200            200            0.0027176724  -0.0035216975   0              0.011674715    7.2235227e-17  0              6.9759612e-12  1.1965779e-13  0              2.9950717    
   2800000   6420           200            200            0.0027176724  -0.0035216975   0              0.011674715    9.5956542e-18  0              9.266796e-13   1.1965779e-13  0              2.9950717    
   2900000   6420           200            200            0.0027176724  -0.0035216975   0              0.011674715    2.9209778e-18  0              2.8208713e-13  1.1965779e-13  0              2.9950717    
   3000000   6420           200            200            0.0027176724  -0.0035216975   0              0.011674715    1.7454742e-18  0              1.6856541e-13  1.1965779e-13  0              2.9950717    
Loop time of 298.367 on 4 procs for 3000000 steps with 2501 atoms

Performance: 8687294.665 ns/day, 0.000 hours/ns, 10054.739 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 11.086     | 37.88      | 65.444     | 435.0 | 12.70
Neigh   | 3.9591     | 4.0368     | 4.1148     |   3.4 |  1.35
Comm    | 18.272     | 39.612     | 80.927     | 386.1 | 13.28
Output  | 0.27329    | 0.2736     | 0.27393    |   0.1 |  0.09
Modify  | 110.77     | 160.19     | 178.96     | 225.8 | 53.69
Other   |            | 56.37      |            |       | 18.89

Nlocal:         625.25 ave         876 max         375 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:           1.75 ave           3 max           1 min
Histogram: 2 0 0 0 0 1 0 0 0 1
Neighs:         341.25 ave         683 max           0 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 1365
Ave neighs/atom = 0.54578169
Neighbor list builds = 164
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 29

#variable lat0 equal 1                    #
variable lat1 equal 3+(100*0.01)+(v_ind*0.01)  # .491+(v_ind*0.001)       # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 500*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.29                                                               
Lattice spacing in x,y,z = 4.29 4.29 4.29

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -3217.5 ${n1e1} -100 100 -100 100 units box
region box block -3217.5 3217.5 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -3217.5 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -3217.5 3217.5 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-3217.5 -100 -100) to (3217.5 100 100)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 1500 atoms
  using lattice units in orthogonal box = (-3217.5 -100 -100) to (3217.5 100 100)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 1500 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 1001 atoms
  using lattice units in orthogonal box = (-3217.5 -100 -100) to (3217.5 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  1500 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  1500 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  1001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  1001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
1500 atoms in group substrate
group slider1 region slider1
1001 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 1001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_29_*.dump id type diameter mass xu yu zu fx fy fz

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 4152 130 130
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 85.37 | 85.38 | 85.39 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   6435           200            200            0              0              0              0              0              0              0              1.1965779e-13  0              6            
    100000   6435           200            200            0.0031545003  -3.7659234e-35  0              0.009463501    583614.35      0              5.6361297e+10  1.1965779e-13  0              3.3276946    
    200000   6435           200            200            0.0011060713   7.5319227e-35  0              0.0033182138   139927.7       0              1.3513216e+10  1.1965779e-13  0              3.076327     
    300000   6435           200            200            5.9026727e-05 -5.0211329e-35  0              0.00017708018  836.82424      0              80814496       1.1965779e-13  0              3.0454664    
    400000   6435           200            200            0.00016341833 -5.0210588e-35  0              0.000490255    5849.4601      0              5.6489899e+08  1.1965779e-13  0              3.0011253    
    500000   6435           200            200            0.00090422088  0.00044246848  0              0.0022701941   299.75989      0              28948664       1.1965779e-13  0              2.9979165    
    600000   6435           200            200            0.0041368628   0.0037747005   0              0.0086358879   120.24827      0              11612717       1.1965779e-13  0              2.9958446    
    700000   6435           200            200            0.0063395509   0.005752692    0              0.013265961    5.7110474      0              551532.08      1.1965779e-13  0              2.9948353    
    800000   6435           200            200            0.0057079047   0.0054545836   0              0.01166913     3.7775748      0              364811.14      1.1965779e-13  0              2.9951542    
    900000   6435           200            200            0.0056177619   0.0054244444   0              0.011428841    0.074837278    0              7227.2486      1.1965779e-13  0              2.9952072    
   1000000   6435           200            200            0.0057239735   0.0054582414   0              0.011713679    0.030598627    0              2954.9964      1.1965779e-13  0              2.9951475    
   1100000   6435           200            200            0.0057027884   0.0054518641   0              0.011656501    0.0085615619   0              826.81437      1.1965779e-13  0              2.9951591    
   1200000   6435           200            200            0.0056952217   0.0054494452   0              0.01163622     3.4399997e-05  0              3.3221055      1.1965779e-13  0              2.9951634    
   1300000   6435           200            200            0.0057004884   0.005451085    0              0.01165038     0.00011253109  0              10.867447      1.1965779e-13  0              2.9951605    
   1400000   6435           200            200            0.0056998337   0.0054508902   0              0.011648611    1.7352961e-05  0              1.6758248      1.1965779e-13  0              2.9951608    
   1500000   6435           200            200            0.0056993319   0.0054507314   0              0.011647264    1.1008104e-08  0              0.0010630839   1.1965779e-13  0              2.9951611    
   1600000   6435           200            200            0.0056995798   0.0054508082   0              0.011647931    3.5404632e-07  0              0.03419126     1.1965779e-13  0              2.995161     
   1700000   6435           200            200            0.0056995686   0.0054508052   0              0.011647901    3.0679192e-08  0              0.0029627768   1.1965779e-13  0              2.995161     
   1800000   6435           200            200            0.0056995388   0.0054507958   0              0.011647821    6.0023066e-10  0              5.7965981e-05  1.1965779e-13  0              2.995161     
   1900000   6435           200            200            0.0056995498   0.0054507992   0              0.01164785     9.865902e-10   0              9.527782e-05   1.1965779e-13  0              2.995161     
   2000000   6435           200            200            0.0056995503   0.0054507994   0              0.011647852    4.4754345e-11  0              4.3220543e-06  1.1965779e-13  0              2.995161     
   2100000   6435           200            200            0.0056995486   0.0054507988   0              0.011647847    4.4393277e-12  0              4.2871849e-07  1.1965779e-13  0              2.995161     
   2200000   6435           200            200            0.0056995491   0.005450799    0              0.011647848    2.4706287e-12  0              2.3859563e-07  1.1965779e-13  0              2.995161     
   2300000   6435           200            200            0.0056995492   0.005450799    0              0.011647849    4.6480988e-14  0              4.4888011e-09  1.1965779e-13  0              2.995161     
   2400000   6435           200            200            0.0056995491   0.005450799    0              0.011647848    2.0500961e-14  0              1.9798361e-09  1.1965779e-13  0              2.995161     
   2500000   6435           200            200            0.0056995491   0.005450799    0              0.011647848    5.554955e-15   0              5.3645779e-10  1.1965779e-13  0              2.995161     
   2600000   6435           200            200            0.0056995491   0.005450799    0              0.011647848    1.8366522e-17  0              1.7737072e-12  1.1965779e-13  0              2.995161     
   2700000   6435           200            200            0.0056995491   0.005450799    0              0.011647848    7.1095444e-17  0              6.8658891e-12  1.1965779e-13  0              2.995161     
   2800000   6435           200            200            0.0056995491   0.005450799    0              0.011647848    1.3331127e-17  0              1.2874248e-12  1.1965779e-13  0              2.995161     
   2900000   6435           200            200            0.0056995491   0.005450799    0              0.011647848    9.101345e-19   0              8.7894276e-14  1.1965779e-13  0              2.995161     
   3000000   6435           200            200            0.0056995491   0.005450799    0              0.011647848    7.6321368e-19  0              7.3705714e-14  1.1965779e-13  0              2.995161     
Loop time of 295.116 on 4 procs for 3000000 steps with 2501 atoms

Performance: 8782988.930 ns/day, 0.000 hours/ns, 10165.496 timesteps/s
99.9% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 10.901     | 37.641     | 64.875     | 432.9 | 12.75
Neigh   | 3.9343     | 4.0148     | 4.0939     |   3.5 |  1.36
Comm    | 18.736     | 37.903     | 77.863     | 379.3 | 12.84
Output  | 0.27328    | 0.27361    | 0.27393    |   0.1 |  0.09
Modify  | 109.16     | 158.18     | 178.62     | 226.4 | 53.60
Other   |            | 57.1       |            |       | 19.35

Nlocal:         625.25 ave         876 max         375 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:           1.75 ave           3 max           1 min
Histogram: 2 0 0 0 0 1 0 0 0 1
Neighs:         342.75 ave         686 max           0 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 1371
Ave neighs/atom = 0.54818073
Neighbor list builds = 164
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 30

#variable lat0 equal 1                    #
variable lat1 equal 3+(100*0.01)+(v_ind*0.01)  # .491+(v_ind*0.001)       # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 500*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.3                                                               
Lattice spacing in x,y,z = 4.3 4.3 4.3

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -3225 ${n1e1} -100 100 -100 100 units box
region box block -3225 3225 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -3225 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -3225 3225 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-3225 -100 -100) to (3225 100 100)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 1500 atoms
  using lattice units in orthogonal box = (-3225 -100 -100) to (3225 100 100)
  create_atoms CPU = 0.000 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 1500 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 1001 atoms
  using lattice units in orthogonal box = (-3225 -100 -100) to (3225 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  1500 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  1500 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  1001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  1001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
1500 atoms in group substrate
group slider1 region slider1
1001 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 1001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_30_*.dump id type diameter mass xu yu zu fx fy fz

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 4162 130 130
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 85.52 | 85.55 | 85.58 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   6450           200            200            0              0              0              0              0              0              0              1.1965779e-13  0              6            
    100000   6450           200            200            0.0031469942   3.1309892e-36  0              0.0094409827   583567.48      0              5.635677e+10   1.1965779e-13  0              3.3277289    
    200000   6450           200            200            0.001103272   -3.1309797e-36  0              0.0033098159   139883.69      0              1.3508966e+10  1.1965779e-13  0              3.076341     
    300000   6450           200            200            5.8775091e-05  5.0096332e-35  0              0.00017632527  833.71531      0              80514257       1.1965779e-13  0              3.0454281    
    400000   6450           200            200            0.00016668597  2.4997993e-40  0              0.00050005792  6091.8995      0              5.8831205e+08  1.1965779e-13  0              3.000833     
    500000   6450           200            200            0.0004756209   1.602497e-05   0              0.0014108377   43.841653      0              4233913        1.1965779e-13  0              2.9981849    
    600000   6450           200            200            0.003955914    0.0019384777   0              0.0099292642   179.60503      0              17344968       1.1965779e-13  0              2.9955478    
    700000   6450           200            200            0.0044690263   0.0018429008   0              0.011564178    27.738652      0              2678800.5      1.1965779e-13  0              2.995194     
    800000   6450           200            200            0.0045203458   0.0018469439   0              0.011714094    3.6525268      0              352734.9       1.1965779e-13  0              2.9951657    
    900000   6450           200            200            0.0045120284   0.0018459807   0              0.011690105    0.45746584     0              44178.776      1.1965779e-13  0              2.9951725    
   1000000   6450           200            200            0.0045010153   0.0018449096   0              0.011658136    0.054610838    0              5273.9239      1.1965779e-13  0              2.99518      
   1100000   6450           200            200            0.0044942784   0.0018442721   0              0.011638563    0.0061743924   0              596.27862      1.1965779e-13  0              2.9951844    
   1200000   6450           200            200            0.0044908821   0.0018439544   0              0.011628692    0.00065398197  0              63.156898      1.1965779e-13  0              2.9951866    
   1300000   6450           200            200            0.0044893247   0.0018438098   0              0.011624164    6.3711007e-05  0              6.152753       1.1965779e-13  0              2.9951876    
   1400000   6450           200            200            0.0044886515   0.0018437475   0              0.011622207    5.522427e-06   0              0.53331647     1.1965779e-13  0              2.995188     
   1500000   6450           200            200            0.0044883724   0.0018437219   0              0.011621395    3.978886e-07   0              0.038425233    1.1965779e-13  0              2.9951882    
   1600000   6450           200            200            0.0044882605   0.0018437116   0              0.01162107     1.9975949e-08  0              0.0019291342   1.1965779e-13  0              2.9951883    
   1700000   6450           200            200            0.0044882168   0.0018437076   0              0.011620943    3.1021453e-10  0              2.9958299e-05  1.1965779e-13  0              2.9951883    
   1800000   6450           200            200            0.0044882002   0.0018437061   0              0.011620895    3.9238434e-11  0              3.7893671e-06  1.1965779e-13  0              2.9951883    
   1900000   6450           200            200            0.004488194    0.0018437055   0              0.011620876    4.7955455e-11  0              4.6311946e-06  1.1965779e-13  0              2.9951883    
   2000000   6450           200            200            0.0044881917   0.0018437053   0              0.01162087     1.7520986e-11  0              1.6920514e-06  1.1965779e-13  0              2.9951883    
   2100000   6450           200            200            0.0044881909   0.0018437052   0              0.011620868    4.4386999e-12  0              4.2865786e-07  1.1965779e-13  0              2.9951883    
   2200000   6450           200            200            0.0044881907   0.0018437052   0              0.011620867    9.3310376e-13  0              9.0112482e-08  1.1965779e-13  0              2.9951883    
   2300000   6450           200            200            0.0044881906   0.0018437052   0              0.011620866    1.7432784e-13  0              1.6835335e-08  1.1965779e-13  0              2.9951883    
   2400000   6450           200            200            0.0044881905   0.0018437052   0              0.011620866    2.9950952e-14  0              2.8924486e-09  1.1965779e-13  0              2.9951883    
   2500000   6450           200            200            0.0044881905   0.0018437052   0              0.011620866    4.8348293e-15  0              4.6691321e-10  1.1965779e-13  0              2.9951883    
   2600000   6450           200            200            0.0044881905   0.0018437052   0              0.011620866    7.4659729e-16  0              7.2101022e-11  1.1965779e-13  0              2.9951883    
   2700000   6450           200            200            0.0044881905   0.0018437052   0              0.011620866    1.0337142e-16  0              9.9828717e-12  1.1965779e-13  0              2.9951883    
   2800000   6450           200            200            0.0044881905   0.0018437052   0              0.011620866    1.3394603e-17  0              1.2935549e-12  1.1965779e-13  0              2.9951883    
   2900000   6450           200            200            0.0044881905   0.0018437052   0              0.011620866    3.5427812e-18  0              3.4213645e-13  1.1965779e-13  0              2.9951883    
   3000000   6450           200            200            0.0044881905   0.0018437052   0              0.011620866    6.9187002e-18  0              6.6815854e-13  1.1965779e-13  0              2.9951883    
Loop time of 296.944 on 4 procs for 3000000 steps with 2501 atoms

Performance: 8728923.237 ns/day, 0.000 hours/ns, 10102.920 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 11.145     | 37.506     | 65.301     | 428.4 | 12.63
Neigh   | 4.0245     | 4.1051     | 4.1853     |   3.5 |  1.38
Comm    | 18.633     | 38.447     | 78.472     | 378.1 | 12.95
Output  | 0.27475    | 0.27507    | 0.2754     |   0.1 |  0.09
Modify  | 110.85     | 159.79     | 179.44     | 224.7 | 53.81
Other   |            | 56.82      |            |       | 19.14

Nlocal:         625.25 ave         876 max         375 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:           1.75 ave           3 max           1 min
Histogram: 2 0 0 0 0 1 0 0 0 1
Neighs:         337.75 ave         676 max           0 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 1351
Ave neighs/atom = 0.54018393
Neighbor list builds = 164
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 31

#variable lat0 equal 1                    #
variable lat1 equal 3+(100*0.01)+(v_ind*0.01)  # .491+(v_ind*0.001)       # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 500*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.31                                                               
Lattice spacing in x,y,z = 4.31 4.31 4.31

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -3232.5 ${n1e1} -100 100 -100 100 units box
region box block -3232.5 3232.5 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -3232.5 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -3232.5 3232.5 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-3232.5 -100 -100) to (3232.5 100 100)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 1500 atoms
  using lattice units in orthogonal box = (-3232.5 -100 -100) to (3232.5 100 100)
  create_atoms CPU = 0.000 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 1500 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 1001 atoms
  using lattice units in orthogonal box = (-3232.5 -100 -100) to (3232.5 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  1500 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  1500 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  1001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  1001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
1500 atoms in group substrate
group slider1 region slider1
1001 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 1001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_31_*.dump id type diameter mass xu yu zu fx fy fz

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 4171 130 130
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 85.72 | 85.73 | 85.73 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   6465           200            200            0              0              0              0              0              0              0              1.1965779e-13  0              6            
    100000   6465           200            200            0.00314001    -2.4989356e-35  0              0.00942003     583654.46      0              5.636517e+10   1.1965779e-13  0              3.3276704    
    200000   6465           200            200            0.0011014921  -4.9979372e-35  0              0.0033044763   140038.47      0              1.3523913e+10  1.1965779e-13  0              3.0762228    
    300000   6465           200            200            5.9704424e-05 -4.9979298e-35  0              0.00017911327  863.13443      0              83355345       1.1965779e-13  0              3.0454525    
    400000   6465           200            200            0.0001645578   1.2683614e-40  0              0.00049367339  5975.2862      0              5.7705037e+08  1.1965779e-13  0              3.0009994    
    500000   6465           200            200            0.00075831197 -0.00049141705  0              0.002766353    494.4119       0              47746762       1.1965779e-13  0              2.9976707    
    600000   6465           200            200            0.0030851465  -0.0016697293   0              0.010925169    206.8618       0              19977232       1.1965779e-13  0              2.9953174    
    700000   6465           200            200            0.0037747912  -0.0017009259   0              0.013025299    10.406106      0              1004947.3      1.1965779e-13  0              2.9948657    
    800000   6465           200            200            0.003029391   -0.001865568    0              0.010953741    0.037469266    0              3618.5135      1.1965779e-13  0              2.9952926    
    900000   6465           200            200            0.0033021278  -0.0018403816   0              0.011746765    0.30660608     0              29609.821      1.1965779e-13  0              2.9951263    
   1000000   6465           200            200            0.0032533622  -0.0018397615   0              0.011599848    0.068521524    0              6617.3184      1.1965779e-13  0              2.9951557    
   1100000   6465           200            200            0.0032435787  -0.0018397072   0              0.011570443    0.0043084774   0              416.08191      1.1965779e-13  0              2.9951622    
   1200000   6465           200            200            0.0032552391  -0.0018398702   0              0.011605587    1.8532688e-07  0              0.017897544    1.1965779e-13  0              2.9951549    
   1300000   6465           200            200            0.0032502461  -0.0018397755   0              0.011590514    7.4163291e-05  0              7.1621598      1.1965779e-13  0              2.995158     
   1400000   6465           200            200            0.0032513916  -0.0018397964   0              0.011593971    2.2489003e-05  0              2.171827       1.1965779e-13  0              2.9951573    
   1500000   6465           200            200            0.0032514417  -0.0018397975   0              0.011594123    2.011449e-06   0              0.19425134     1.1965779e-13  0              2.9951572    
   1600000   6465           200            200            0.00325126    -0.0018397941   0              0.011593574    1.7438186e-08  0              0.0016840552   1.1965779e-13  0              2.9951574    
   1700000   6465           200            200            0.0032513521  -0.0018397958   0              0.011593852    1.425273e-08   0              0.0013764266   1.1965779e-13  0              2.9951573    
   1800000   6465           200            200            0.0032513265  -0.0018397953   0              0.011593775    6.8458312e-09  0              0.00066112138  1.1965779e-13  0              2.9951573    
   1900000   6465           200            200            0.003251328   -0.0018397953   0              0.011593779    8.3570676e-10  0              8.0706577e-05  1.1965779e-13  0              2.9951573    
   2000000   6465           200            200            0.0032513306  -0.0018397954   0              0.011593787    2.0875745e-11  0              2.0160301e-06  1.1965779e-13  0              2.9951573    
   2100000   6465           200            200            0.003251329   -0.0018397954   0              0.011593782    1.9956869e-12  0              1.9272916e-07  1.1965779e-13  0              2.9951573    
   2200000   6465           200            200            0.0032513295  -0.0018397954   0              0.011593784    1.9178014e-12  0              1.8520753e-07  1.1965779e-13  0              2.9951573    
   2300000   6465           200            200            0.0032513295  -0.0018397954   0              0.011593784    3.1660234e-13  0              3.0575188e-08  1.1965779e-13  0              2.9951573    
   2400000   6465           200            200            0.0032513294  -0.0018397954   0              0.011593784    1.4187069e-14  0              1.3700856e-09  1.1965779e-13  0              2.9951573    
   2500000   6465           200            200            0.0032513295  -0.0018397954   0              0.011593784    1.2823025e-16  0              1.238356e-11   1.1965779e-13  0              2.9951573    
   2600000   6465           200            200            0.0032513294  -0.0018397954   0              0.011593784    5.3324777e-16  0              5.1497253e-11  1.1965779e-13  0              2.9951573    
   2700000   6465           200            200            0.0032513294  -0.0018397954   0              0.011593784    1.0842733e-16  0              1.0471135e-11  1.1965779e-13  0              2.9951573    
   2800000   6465           200            200            0.0032513294  -0.0018397954   0              0.011593784    8.5018165e-18  0              8.2104459e-13  1.1965779e-13  0              2.9951573    
   2900000   6465           200            200            0.0032513294  -0.0018397954   0              0.011593784    2.6818997e-18  0              2.5899868e-13  1.1965779e-13  0              2.9951573    
   3000000   6465           200            200            0.0032513294  -0.0018397954   0              0.011593784    3.5463062e-18  0              3.4247687e-13  1.1965779e-13  0              2.9951573    
Loop time of 297.343 on 4 procs for 3000000 steps with 2501 atoms

Performance: 8717196.845 ns/day, 0.000 hours/ns, 10089.348 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 11.123     | 37.821     | 65.398     | 432.7 | 12.72
Neigh   | 4.0033     | 4.0815     | 4.161      |   3.4 |  1.37
Comm    | 17.384     | 24.757     | 30.868     | 119.1 |  8.33
Output  | 0.27399    | 0.27431    | 0.27465    |   0.1 |  0.09
Modify  | 171.06     | 174.13     | 176.83     |  17.2 | 58.56
Other   |            | 56.28      |            |       | 18.93

Nlocal:         625.25 ave         876 max         374 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:           1.75 ave           2 max           1 min
Histogram: 1 0 0 0 0 0 0 0 0 3
Neighs:         341.25 ave         683 max           0 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 1365
Ave neighs/atom = 0.54578169
Neighbor list builds = 164
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 32

#variable lat0 equal 1                    #
variable lat1 equal 3+(100*0.01)+(v_ind*0.01)  # .491+(v_ind*0.001)       # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 500*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.32                                                               
Lattice spacing in x,y,z = 4.32 4.32 4.32

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -3240 ${n1e1} -100 100 -100 100 units box
region box block -3240 3240 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -3240 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -3240 3240 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-3240 -100 -100) to (3240 100 100)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 1500 atoms
  using lattice units in orthogonal box = (-3240 -100 -100) to (3240 100 100)
  create_atoms CPU = 0.000 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 1500 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 1001 atoms
  using lattice units in orthogonal box = (-3240 -100 -100) to (3240 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  1500 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  1500 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  1001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  1001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
1500 atoms in group substrate
group slider1 region slider1
1001 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 1001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_32_*.dump id type diameter mass xu yu zu fx fy fz

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 4181 130 130
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 85.93 | 85.94 | 85.94 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   6480           200            200            0              0              0              0              0              0              0              1.1965779e-13  0              6            
    100000   6480           200            200            0.0031320359   6.2329879e-36  0              0.0093961076   583459.5       0              5.6346342e+10  1.1965779e-13  0              3.32781      
    200000   6480           200            200            0.0010973779  -9.9726219e-35  0              0.0032921338   139727.42      0              1.3493874e+10  1.1965779e-13  0              3.0764588    
    300000   6480           200            200            5.834736e-05  -3.7397699e-35  0              0.00017504208  829.46528      0              80103820       1.1965779e-13  0              3.0453924    
    400000   6480           200            200            0.00015317445  1.2466052e-35  0              0.00045952334  5260.0986      0              5.0798267e+08  1.1965779e-13  0              3.001667     
    500000   6480           200            200            0.00069636773 -4.2441004e-16  0              0.0020891032   316.42817      0              30558367       1.1965779e-13  0              2.9978435    
    600000   6480           200            200            0.0048337961   0.0011820102   0              0.013319378    189.61786      0              18311936       1.1965779e-13  0              2.994817     
    700000   6480           200            200            0.0046885185   0.00096943892  0              0.013096117    9.2556571      0              893845.11      1.1965779e-13  0              2.9948703    
    800000   6480           200            200            0.0043940417   0.00095564814  0              0.012226477    0.214129       0              20679.046      1.1965779e-13  0              2.9950381    
    900000   6480           200            200            0.004254312    0.00094831838  0              0.011814617    0.0046569002   0              449.73009      1.1965779e-13  0              2.9951184    
   1000000   6480           200            200            0.0041985606   0.00094524935  0              0.011650432    0.011761129    0              1135.8057      1.1965779e-13  0              2.9951505    
   1100000   6480           200            200            0.004178612    0.00094413437  0              0.011591702    0.0043785929   0              422.85317      1.1965779e-13  0              2.9951619    
   1200000   6480           200            200            0.0041722381   0.00094377791  0              0.011572937    0.00098686407  0              95.304268      1.1965779e-13  0              2.9951656    
   1300000   6480           200            200            0.0041704913   0.00094368101  0              0.011567793    0.00016731411  0              16.157999      1.1965779e-13  0              2.9951666    
   1400000   6480           200            200            0.0041701352   0.00094366173  0              0.011566744    2.2695205e-05  0              2.1917405      1.1965779e-13  0              2.9951667    
   1500000   6480           200            200            0.0041701229   0.00094366139  0              0.011566707    2.4664985e-06  0              0.23819677     1.1965779e-13  0              2.9951668    
   1600000   6480           200            200            0.0041701623   0.00094366375  0              0.011566823    2.0284059e-07  0              0.019588892    1.1965779e-13  0              2.9951667    
   1700000   6480           200            200            0.0041701914   0.00094366544  0              0.011566909    1.0325097e-08  0              0.000997124    1.1965779e-13  0              2.9951667    
   1800000   6480           200            200            0.0041702063   0.0009436663   0              0.011566953    9.9577922e-11  0              9.616523e-06   1.1965779e-13  0              2.9951667    
   1900000   6480           200            200            0.0041702128   0.00094366667  0              0.011566972    4.562099e-11   0              4.4057487e-06  1.1965779e-13  0              2.9951667    
   2000000   6480           200            200            0.0041702153   0.00094366681  0              0.011566979    3.6525944e-11  0              3.5274142e-06  1.1965779e-13  0              2.9951667    
   2100000   6480           200            200            0.0041702161   0.00094366685  0              0.011566982    1.0844808e-11  0              1.0473139e-06  1.1965779e-13  0              2.9951667    
   2200000   6480           200            200            0.0041702164   0.00094366687  0              0.011566982    2.17957e-12    0              2.1048727e-07  1.1965779e-13  0              2.9951667    
   2300000   6480           200            200            0.0041702165   0.00094366687  0              0.011566982    3.3983241e-13  0              3.2818582e-08  1.1965779e-13  0              2.9951667    
   2400000   6480           200            200            0.0041702165   0.00094366687  0              0.011566983    4.2788741e-14  0              4.1322304e-09  1.1965779e-13  0              2.9951667    
   2500000   6480           200            200            0.0041702165   0.00094366687  0              0.011566983    4.2375967e-15  0              4.0923676e-10  1.1965779e-13  0              2.9951667    
   2600000   6480           200            200            0.0041702165   0.00094366687  0              0.011566983    2.7843271e-16  0              2.6889039e-11  1.1965779e-13  0              2.9951667    
   2700000   6480           200            200            0.0041702165   0.00094366687  0              0.011566983    5.5678497e-18  0              5.3770307e-13  1.1965779e-13  0              2.9951667    
   2800000   6480           200            200            0.0041702165   0.00094366687  0              0.011566982    4.3619252e-19  0              4.2124351e-14  1.1965779e-13  0              2.9951667    
   2900000   6480           200            200            0.0041702165   0.00094366687  0              0.011566982    5.3485162e-20  0              5.1652141e-15  1.1965779e-13  0              2.9951667    
   3000000   6480           200            200            0.0041702165   0.00094366687  0              0.011566982    5.7206991e-18  0              5.5246417e-13  1.1965779e-13  0              2.9951667    
Loop time of 297.519 on 4 procs for 3000000 steps with 2501 atoms

Performance: 8712037.869 ns/day, 0.000 hours/ns, 10083.377 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 10.946     | 37.795     | 65.113     | 433.9 | 12.70
Neigh   | 4.0263     | 4.1114     | 4.1973     |   3.7 |  1.38
Comm    | 18.51      | 38.138     | 78.36      | 381.1 | 12.82
Output  | 0.27533    | 0.27564    | 0.27596    |   0.1 |  0.09
Modify  | 111.49     | 160.52     | 179.68     | 224.6 | 53.95
Other   |            | 56.68      |            |       | 19.05

Nlocal:         625.25 ave         876 max         375 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:           1.75 ave           3 max           1 min
Histogram: 2 0 0 0 0 1 0 0 0 1
Neighs:         340.25 ave         681 max           0 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 1361
Ave neighs/atom = 0.54418233
Neighbor list builds = 164
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 33

#variable lat0 equal 1                    #
variable lat1 equal 3+(100*0.01)+(v_ind*0.01)  # .491+(v_ind*0.001)       # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 500*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.33                                                               
Lattice spacing in x,y,z = 4.33 4.33 4.33

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -3247.5 ${n1e1} -100 100 -100 100 units box
region box block -3247.5 3247.5 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -3247.5 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -3247.5 3247.5 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-3247.5 -100 -100) to (3247.5 100 100)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 1500 atoms
  using lattice units in orthogonal box = (-3247.5 -100 -100) to (3247.5 100 100)
  create_atoms CPU = 0.000 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 1500 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 1001 atoms
  using lattice units in orthogonal box = (-3247.5 -100 -100) to (3247.5 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  1500 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  1500 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  1001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  1001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
1500 atoms in group substrate
group slider1 region slider1
1001 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 1001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_33_*.dump id type diameter mass xu yu zu fx fy fz

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 4191 130 130
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 86.07 | 86.07 | 86.08 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   6495           200            200            0              0              0              0              0              0              0              1.1965779e-13  0              6            
    100000   6495           200            200            0.0031251412   6.2185878e-36  0              0.0093754236   583552.67      0              5.635534e+10   1.1965779e-13  0              3.3277478    
    200000   6495           200            200            0.0010953299   4.1187894e-40  0              0.0032859897   139822.85      0              1.350309e+10   1.1965779e-13  0              3.0764172    
    300000   6495           200            200            5.7511099e-05  3.1092997e-36  0              0.0001725333   810.26916      0              78249996       1.1965779e-13  0              3.0454709    
    400000   6495           200            200            0.00015913775  6.5782252e-42  0              0.00047741326  5666.9406      0              5.4727256e+08  1.1965779e-13  0              3.0013041    
    500000   6495           200            200            0.00045475809 -0.00067148438  0              0.0020357587   218.68604      0              21119133       1.1965779e-13  0              2.9980119    
    600000   6495           200            200            0.0010884192  -0.0048063686   0              0.0080716262   85.967724      0              8302147.4      1.1965779e-13  0              2.995964     
    700000   6495           200            200            0.0018584473  -0.0075176542   0              0.013092996    7.3541667      0              710212.78      1.1965779e-13  0              2.9948451    
    800000   6495           200            200            0.0014728668  -0.0071286544   0              0.011547255    3.7859284      0              365617.87      1.1965779e-13  0              2.9951539    
    900000   6495           200            200            0.0014218346  -0.0070630222   0              0.011328526    0.094279       0              9104.791       1.1965779e-13  0              2.9952029    
   1000000   6495           200            200            0.001500417   -0.0071091351   0              0.011610386    0.024598944    0              2375.59        1.1965779e-13  0              2.9951432    
   1100000   6495           200            200            0.0014817592  -0.0070989898   0              0.011544268    0.0091052881   0              879.32355      1.1965779e-13  0              2.9951567    
   1200000   6495           200            200            0.0014776155  -0.0070965142   0              0.011529361    0.00016365875  0              15.804991      1.1965779e-13  0              2.99516      
   1300000   6495           200            200            0.0014815954  -0.0070987768   0              0.011543563    6.8906849e-05  0              6.6545302      1.1965779e-13  0              2.995157     
   1400000   6495           200            200            0.0014807362  -0.007098305    0              0.011540514    2.1942116e-05  0              2.1190125      1.1965779e-13  0              2.9951576    
   1500000   6495           200            200            0.0014805057  -0.0070981687   0              0.011539686    3.0347335e-07  0              0.029307284    1.1965779e-13  0              2.9951578    
   1600000   6495           200            200            0.0014807037  -0.0070982809   0              0.011540392    1.8935521e-07  0              0.018286571    1.1965779e-13  0              2.9951577    
   1700000   6495           200            200            0.0014806642  -0.0070982593   0              0.011540252    5.2630191e-08  0              0.0050826471   1.1965779e-13  0              2.9951577    
   1800000   6495           200            200            0.0014806516  -0.0070982519   0              0.011540207    5.3457125e-10  0              5.1625065e-05  1.1965779e-13  0              2.9951577    
   1900000   6495           200            200            0.0014806614  -0.0070982574   0              0.011540242    5.1472716e-10  0              4.9708665e-05  1.1965779e-13  0              2.9951577    
   2000000   6495           200            200            0.0014806596  -0.0070982565   0              0.011540235    1.2556477e-10  0              1.2126147e-05  1.1965779e-13  0              2.9951577    
   2100000   6495           200            200            0.0014806589  -0.0070982561   0              0.011540233    8.7701457e-13  0              8.469579e-08   1.1965779e-13  0              2.9951577    
   2200000   6495           200            200            0.0014806594  -0.0070982563   0              0.011540235    1.3862812e-12  0              1.3387712e-07  1.1965779e-13  0              2.9951577    
   2300000   6495           200            200            0.0014806593  -0.0070982563   0              0.011540234    2.9838256e-13  0              2.8815652e-08  1.1965779e-13  0              2.9951577    
   2400000   6495           200            200            0.0014806593  -0.0070982563   0              0.011540234    1.3148621e-15  0              1.2697997e-10  1.1965779e-13  0              2.9951577    
   2500000   6495           200            200            0.0014806593  -0.0070982563   0              0.011540234    3.6013863e-15  0              3.4779611e-10  1.1965779e-13  0              2.9951577    
   2600000   6495           200            200            0.0014806593  -0.0070982563   0              0.011540234    6.9659609e-16  0              6.7272265e-11  1.1965779e-13  0              2.9951577    
   2700000   6495           200            200            0.0014806593  -0.0070982563   0              0.011540234    1.1930642e-18  0              1.152176e-13   1.1965779e-13  0              2.9951577    
   2800000   6495           200            200            0.0014806593  -0.0070982563   0              0.011540234    4.480631e-18   0              4.3270727e-13  1.1965779e-13  0              2.9951577    
   2900000   6495           200            200            0.0014806593  -0.0070982563   0              0.011540234    7.2698493e-18  0              7.0207001e-13  1.1965779e-13  0              2.9951577    
   3000000   6495           200            200            0.0014806593  -0.0070982563   0              0.011540234    7.2445764e-18  0              6.9962933e-13  1.1965779e-13  0              2.9951577    
Loop time of 294.953 on 4 procs for 3000000 steps with 2501 atoms

Performance: 8787840.950 ns/day, 0.000 hours/ns, 10171.112 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 10.952     | 37.72      | 65.404     | 433.4 | 12.79
Neigh   | 4.0419     | 4.1283     | 4.2168     |   3.8 |  1.40
Comm    | 18.805     | 38.467     | 78.843     | 380.8 | 13.04
Output  | 0.27295    | 0.27326    | 0.27361    |   0.1 |  0.09
Modify  | 108.98     | 157.87     | 177.34     | 225.6 | 53.52
Other   |            | 56.5       |            |       | 19.15

Nlocal:         625.25 ave         876 max         375 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:           1.75 ave           3 max           1 min
Histogram: 2 0 0 0 0 1 0 0 0 1
Neighs:         340.75 ave         682 max           0 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 1363
Ave neighs/atom = 0.54498201
Neighbor list builds = 164
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 34

#variable lat0 equal 1                    #
variable lat1 equal 3+(100*0.01)+(v_ind*0.01)  # .491+(v_ind*0.001)       # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 500*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.34                                                               
Lattice spacing in x,y,z = 4.34 4.34 4.34

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -3255 ${n1e1} -100 100 -100 100 units box
region box block -3255 3255 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -3255 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -3255 3255 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-3255 -100 -100) to (3255 100 100)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 1500 atoms
  using lattice units in orthogonal box = (-3255 -100 -100) to (3255 100 100)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 1500 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 1001 atoms
  using lattice units in orthogonal box = (-3255 -100 -100) to (3255 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  1500 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  1500 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  1001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  1001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
1500 atoms in group substrate
group slider1 region slider1
1001 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 1001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_34_*.dump id type diameter mass xu yu zu fx fy fz

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 4200 130 130
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 86.28 | 86.28 | 86.29 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   6510           200            200            0              0              0              0              0              0              0              1.1965779e-13  0              6            
    100000   6510           200            200            0.0031174506   6.2042608e-36  0              0.0093523519   583420.02      0              5.634253e+10   1.1965779e-13  0              3.3278184    
    200000   6510           200            200            0.0010918614   1.240865e-35   0              0.0032755842   139636.49      0              1.3485092e+10  1.1965779e-13  0              3.0765108    
    300000   6510           200            200            5.636825e-05  -7.4450557e-35  0              0.00016910475  783.0234       0              75618795       1.1965779e-13  0              3.0453875    
    400000   6510           200            200            0.00015564924  4.9635122e-35  0              0.00046694771  5464.0215      0              5.2767608e+08  1.1965779e-13  0              3.0014196    
    500000   6510           200            200            0.0004186145  -0.00045743797  0              0.0017132815   62.640697      0              6049390.2      1.1965779e-13  0              2.9981098    
    600000   6510           200            200            0.0016404646  -0.0021938804   0              0.0071152742   1.0664887      0              102993.85      1.1965779e-13  0              2.9961216    
    700000   6510           200            200            0.0028089838  -0.0027092004   0              0.011136152    26.595959      0              2568447.4      1.1965779e-13  0              2.9951619    
    800000   6510           200            200            0.0030993357  -0.0028409171   0              0.012138924    0.21499139     0              20762.329      1.1965779e-13  0              2.9949438    
    900000   6510           200            200            0.0029172442  -0.0028123223   0              0.011564055    0.48160072     0              46509.55       1.1965779e-13  0              2.9950631    
   1000000   6510           200            200            0.0028747591  -0.0028049362   0              0.011429213    0.0031017406   0              299.5439       1.1965779e-13  0              2.9950925    
   1100000   6510           200            200            0.0028994175  -0.0028090785   0              0.011507331    0.0088588957   0              855.52873      1.1965779e-13  0              2.9950761    
   1200000   6510           200            200            0.0029049053  -0.0028100307   0              0.011524747    4.1501022e-05  0              4.0078717      1.1965779e-13  0              2.9950723    
   1300000   6510           200            200            0.0029015112  -0.0028094665   0              0.011514       0.00016295522  0              15.737049      1.1965779e-13  0              2.9950745    
   1400000   6510           200            200            0.0029008109  -0.0028093446   0              0.011511777    5.2107825e-07  0              0.050322008    1.1965779e-13  0              2.995075     
   1500000   6510           200            200            0.0029012764  -0.0028094222   0              0.011513251    2.9909094e-06  0              0.28884062     1.1965779e-13  0              2.9950747    
   1600000   6510           200            200            0.0029013655  -0.0028094377   0              0.011513534    6.0017961e-09  0              0.00057961051  1.1965779e-13  0              2.9950747    
   1700000   6510           200            200            0.0029013017  -0.0028094271   0              0.011513332    5.4787747e-08  0              0.0052910085   1.1965779e-13  0              2.9950747    
   1800000   6510           200            200            0.0029012905  -0.0028094251   0              0.011513296    6.0188496e-11  0              5.8125742e-06  1.1965779e-13  0              2.9950747    
   1900000   6510           200            200            0.0029012992  -0.0028094266   0              0.011513324    1.0016062e-09  0              9.6727962e-05  1.1965779e-13  0              2.9950747    
   2000000   6510           200            200            0.0029013006  -0.0028094268   0              0.011513329    4.6660212e-13  0              4.5061093e-08  1.1965779e-13  0              2.9950747    
   2100000   6510           200            200            0.0029012994  -0.0028094266   0              0.011513325    1.8276326e-11  0              1.7649967e-06  1.1965779e-13  0              2.9950747    
   2200000   6510           200            200            0.0029012992  -0.0028094266   0              0.011513324    1.8262379e-15  0              1.7636499e-10  1.1965779e-13  0              2.9950747    
   2300000   6510           200            200            0.0029012994  -0.0028094266   0              0.011513325    3.3261328e-13  0              3.2121409e-08  1.1965779e-13  0              2.9950747    
   2400000   6510           200            200            0.0029012994  -0.0028094266   0              0.011513325    2.3865443e-18  0              2.3047537e-13  1.1965779e-13  0              2.9950747    
   2500000   6510           200            200            0.0029012994  -0.0028094266   0              0.011513325    6.0409083e-15  0              5.8338768e-10  1.1965779e-13  0              2.9950747    
   2600000   6510           200            200            0.0029012994  -0.0028094266   0              0.011513325    8.9847821e-19  0              8.6768594e-14  1.1965779e-13  0              2.9950747    
   2700000   6510           200            200            0.0029012994  -0.0028094266   0              0.011513325    1.0764316e-16  0              1.0395406e-11  1.1965779e-13  0              2.9950747    
   2800000   6510           200            200            0.0029012994  -0.0028094266   0              0.011513325    9.4717272e-19  0              9.1471161e-14  1.1965779e-13  0              2.9950747    
   2900000   6510           200            200            0.0029012994  -0.0028094266   0              0.011513325    5.9023968e-18  0              5.7001124e-13  1.1965779e-13  0              2.9950747    
   3000000   6510           200            200            0.0029012994  -0.0028094266   0              0.011513325    6.0305829e-18  0              5.8239053e-13  1.1965779e-13  0              2.9950747    
Loop time of 297.102 on 4 procs for 3000000 steps with 2501 atoms

Performance: 8724275.667 ns/day, 0.000 hours/ns, 10097.541 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 11.329     | 38.161     | 66.592     | 432.7 | 12.84
Neigh   | 4.0229     | 4.1101     | 4.1986     |   3.8 |  1.38
Comm    | 18.339     | 39.046     | 80.325     | 387.5 | 13.14
Output  | 0.27363    | 0.27395    | 0.27428    |   0.1 |  0.09
Modify  | 108.89     | 158.55     | 177.79     | 228.4 | 53.36
Other   |            | 56.96      |            |       | 19.17

Nlocal:         625.25 ave         876 max         375 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:           1.75 ave           3 max           1 min
Histogram: 2 0 0 0 0 1 0 0 0 1
Neighs:         341.25 ave         683 max           0 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 1365
Ave neighs/atom = 0.54578169
Neighbor list builds = 164
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 35

#variable lat0 equal 1                    #
variable lat1 equal 3+(100*0.01)+(v_ind*0.01)  # .491+(v_ind*0.001)       # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 500*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.35                                                               
Lattice spacing in x,y,z = 4.35 4.35 4.35

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -3262.5 ${n1e1} -100 100 -100 100 units box
region box block -3262.5 3262.5 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -3262.5 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -3262.5 3262.5 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-3262.5 -100 -100) to (3262.5 100 100)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 1500 atoms
  using lattice units in orthogonal box = (-3262.5 -100 -100) to (3262.5 100 100)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 1500 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 1001 atoms
  using lattice units in orthogonal box = (-3262.5 -100 -100) to (3262.5 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  1500 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  1500 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  1001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  1001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
1500 atoms in group substrate
group slider1 region slider1
1001 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 1001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_35_*.dump id type diameter mass xu yu zu fx fy fz

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 4210 130 130
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 86.36 | 86.39 | 86.42 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   6525           200            200            0              0              0              0              0              0              0              1.1965779e-13  0              6            
    100000   6525           200            200            0.0031104541  -2.4759338e-35  0              0.0093313624   583469.51      0              5.6347309e+10  1.1965779e-13  0              3.3277668    
    200000   6525           200            200            0.0010897512  -2.4759769e-35  0              0.0032692536   139716.17      0              1.3492788e+10  1.1965779e-13  0              3.0764572    
    300000   6525           200            200            5.2892315e-05 -1.9807874e-34  0              0.00015867695  695.51282      0              67167650       1.1965779e-13  0              3.0455232    
    400000   6525           200            200            0.00015978883  4.8714743e-40  0              0.00047936648  5758.2044      0              5.5608617e+08  1.1965779e-13  0              3.0011937    
    500000   6525           200            200            0.0013225584   3.7375749e-15  0              0.0039676753   726.34317      0              70145024       1.1965779e-13  0              2.9971854    
    600000   6525           200            200            0.0031108629  -0.00012089355  0              0.0094534824   189.00218      0              18252478       1.1965779e-13  0              2.9953245    
    700000   6525           200            200            0.0038222427  -0.00013777075  0              0.011604499    29.197621      0              2819697.3      1.1965779e-13  0              2.9949276    
    800000   6525           200            200            0.0036841188  -0.00016132169  0              0.011213678    3.3128875      0              319934.96      1.1965779e-13  0              2.9949924    
    900000   6525           200            200            0.0038332152  -0.00016394949  0              0.011663595    0.27664976     0              26716.854      1.1965779e-13  0              2.9949113    
   1000000   6525           200            200            0.0037461863  -0.00016243381  0              0.011400993    0.012126052    0              1171.0473      1.1965779e-13  0              2.9949593    
   1100000   6525           200            200            0.0037858479  -0.00016314628  0              0.01152069     1.8674837e-05  0              1.8034821      1.1965779e-13  0              2.9949372    
   1200000   6525           200            200            0.0037705433  -0.00016287273  0              0.011474503    0.00014212215  0              13.72514       1.1965779e-13  0              2.9949457    
   1300000   6525           200            200            0.0037756121  -0.00016296441  0              0.011489801    7.5710044e-05  0              7.3115342      1.1965779e-13  0              2.9949429    
   1400000   6525           200            200            0.003774222   -0.00016293905  0              0.011485605    1.8640145e-05  0              1.8001318      1.1965779e-13  0              2.9949437    
   1500000   6525           200            200            0.0037744853  -0.00016294399  0              0.0114864      3.1231642e-06  0              0.30161284     1.1965779e-13  0              2.9949435    
   1600000   6525           200            200            0.0037744933  -0.00016294405  0              0.011486424    3.8625609e-07  0              0.037301848    1.1965779e-13  0              2.9949435    
   1700000   6525           200            200            0.0037744524  -0.00016294334  0              0.011486301    3.4233297e-08  0              0.0033060068   1.1965779e-13  0              2.9949435    
   1800000   6525           200            200            0.0037744792  -0.00016294381  0              0.011486381    1.7833266e-09  0              0.00017222091  1.1965779e-13  0              2.9949435    
   1900000   6525           200            200            0.0037744665  -0.00016294359  0              0.011486343    1.4595204e-11  0              1.4095003e-06  1.1965779e-13  0              2.9949435    
   2000000   6525           200            200            0.0037744715  -0.00016294368  0              0.011486358    9.5414792e-12  0              9.2144777e-07  1.1965779e-13  0              2.9949435    
   2100000   6525           200            200            0.0037744698  -0.00016294365  0              0.011486353    6.8538525e-12  0              6.6189602e-07  1.1965779e-13  0              2.9949435    
   2200000   6525           200            200            0.0037744703  -0.00016294366  0              0.011486355    1.866424e-12   0              1.8024587e-07  1.1965779e-13  0              2.9949435    
   2300000   6525           200            200            0.0037744702  -0.00016294365  0              0.011486354    3.3378474e-13  0              3.2234541e-08  1.1965779e-13  0              2.9949435    
   2400000   6525           200            200            0.0037744702  -0.00016294365  0              0.011486354    4.3672563e-14  0              4.2175835e-09  1.1965779e-13  0              2.9949435    
   2500000   6525           200            200            0.0037744702  -0.00016294366  0              0.011486354    4.2021434e-15  0              4.0581293e-10  1.1965779e-13  0              2.9949435    
   2600000   6525           200            200            0.0037744702  -0.00016294365  0              0.011486354    2.6818932e-16  0              2.5899805e-11  1.1965779e-13  0              2.9949435    
   2700000   6525           200            200            0.0037744702  -0.00016294366  0              0.011486354    4.2329336e-18  0              4.0878643e-13  1.1965779e-13  0              2.9949435    
   2800000   6525           200            200            0.0037744702  -0.00016294366  0              0.011486354    2.7245516e-18  0              2.6311769e-13  1.1965779e-13  0              2.9949435    
   2900000   6525           200            200            0.0037744702  -0.00016294366  0              0.011486354    4.2102029e-21  0              4.0659126e-16  1.1965779e-13  0              2.9949435    
   3000000   6525           200            200            0.0037744702  -0.00016294366  0              0.011486354    5.4890125e-18  0              5.3008954e-13  1.1965779e-13  0              2.9949435    
Loop time of 297.39 on 4 procs for 3000000 steps with 2501 atoms

Performance: 8715829.417 ns/day, 0.000 hours/ns, 10087.766 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 10.983     | 38.877     | 67.76      | 443.4 | 13.07
Neigh   | 4.0179     | 4.0955     | 4.1741     |   3.4 |  1.38
Comm    | 17.672     | 23.904     | 28.542     |  95.3 |  8.04
Output  | 0.27245    | 0.27277    | 0.27309    |   0.1 |  0.09
Modify  | 170.46     | 173.85     | 177.08     |  19.6 | 58.46
Other   |            | 56.39      |            |       | 18.96

Nlocal:         625.25 ave         877 max         374 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:           1.75 ave           3 max           1 min
Histogram: 2 0 0 0 0 1 0 0 0 1
Neighs:         345.25 ave         691 max           0 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 1381
Ave neighs/atom = 0.55217913
Neighbor list builds = 164
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 36

#variable lat0 equal 1                    #
variable lat1 equal 3+(100*0.01)+(v_ind*0.01)  # .491+(v_ind*0.001)       # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 500*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.36                                                               
Lattice spacing in x,y,z = 4.36 4.36 4.36

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -3270 ${n1e1} -100 100 -100 100 units box
region box block -3270 3270 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -3270 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -3270 3270 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-3270 -100 -100) to (3270 100 100)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 1499 atoms
  using lattice units in orthogonal box = (-3270 -100 -100) to (3270 100 100)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 1500 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 1001 atoms
  using lattice units in orthogonal box = (-3270 -100 -100) to (3270 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  1499 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  1499 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  1001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  1001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
1499 atoms in group substrate
group slider1 region slider1
1001 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 1001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_36_*.dump id type diameter mass xu yu zu fx fy fz

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 4220 130 130
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 86.56 | 86.56 | 86.57 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   6540           200            200            0              0              0              0              0              0              0              1.1965779e-13  0              6            
    100000   6540           200            200            0.003103514    2.2232858e-34  0              0.009310542    583516.14      0              5.6464741e+10  1.1965779e-13  0              3.3277885    
    200000   6540           200            200            0.0010875088   1.2351626e-35  0              0.0032625263   139764.78      0              1.3524531e+10  1.1965779e-13  0              3.0764822    
    300000   6540           200            200            5.764847e-05   2.4703429e-35  0              0.00017294541  824.91924      0              79824444       1.1965779e-13  0              3.0454498    
    400000   6540           200            200            0.00016268672 -4.0142635e-35  0              0.00048806016  5976.4848      0              5.7832277e+08  1.1965779e-13  0              3.0009629    
    500000   6540           200            200            0.00064218578 -0.00064021014  0              0.0025667675   423.09668      0              40941532       1.1965779e-13  0              2.9977204    
    600000   6540           200            200            0.0024934939  -0.0024307346   0              0.0099112164   188.66333      0              18256267       1.1965779e-13  0              2.9954589    
    700000   6540           200            200            0.0031998993  -0.0024822604   0              0.012081958    24.961151      0              2415400.1      1.1965779e-13  0              2.9949774    
    800000   6540           200            200            0.0030356798  -0.0023976301   0              0.01150467     3.8032441      0              368026.14      1.1965779e-13  0              2.9951027    
    900000   6540           200            200            0.0029737803  -0.0024039565   0              0.011325298    0.35221239     0              34082.316      1.1965779e-13  0              2.9951367    
   1000000   6540           200            200            0.0030433085  -0.0024102365   0              0.011540162    0.012929268    0              1251.1184      1.1965779e-13  0              2.9950932    
   1100000   6540           200            200            0.0030072049  -0.0024069851   0              0.0114286      7.0803999e-05  0              6.8514464      1.1965779e-13  0              2.9951161    
   1200000   6540           200            200            0.0030206601  -0.0024082234   0              0.011470204    0.00042599725  0              41.222209      1.1965779e-13  0              2.9951074    
   1300000   6540           200            200            0.0030170126  -0.0024078851   0              0.011458923    0.00014190001  0              13.73115       1.1965779e-13  0              2.9951098    
   1400000   6540           200            200            0.0030175037  -0.0024079329   0              0.011460444    2.2554478e-05  0              2.1825151      1.1965779e-13  0              2.9951095    
   1500000   6540           200            200            0.0030176849  -0.0024079483   0              0.011461003    1.9504005e-06  0              0.18873319     1.1965779e-13  0              2.9951094    
   1600000   6540           200            200            0.0030175041  -0.0024079321   0              0.011460445    5.8895797e-08  0              0.0056991327   1.1965779e-13  0              2.9951095    
   1700000   6540           200            200            0.003017594   -0.0024079403   0              0.011460722    1.2139845e-09  0              0.00011747288  1.1965779e-13  0              2.9951094    
   1800000   6540           200            200            0.0030175616  -0.0024079373   0              0.011460622    2.9969577e-09  0              0.00029000474  1.1965779e-13  0              2.9951094    
   1900000   6540           200            200            0.0030175699  -0.0024079381   0              0.011460648    8.9480224e-10  0              8.658677e-05   1.1965779e-13  0              2.9951094    
   2000000   6540           200            200            0.003017569   -0.002407938    0              0.011460645    1.3298045e-10  0              1.2868036e-05  1.1965779e-13  0              2.9951094    
   2100000   6540           200            200            0.0030175685  -0.0024079379   0              0.011460643    1.0615455e-11  0              1.0272191e-06  1.1965779e-13  0              2.9951094    
   2200000   6540           200            200            0.0030175689  -0.002407938    0              0.011460645    2.5512763e-13  0              2.4687776e-08  1.1965779e-13  0              2.9951094    
   2300000   6540           200            200            0.0030175687  -0.002407938    0              0.011460644    1.421466e-14   0              1.3755011e-09  1.1965779e-13  0              2.9951094    
   2400000   6540           200            200            0.0030175688  -0.002407938    0              0.011460644    2.0630369e-14  0              1.996326e-09   1.1965779e-13  0              2.9951094    
   2500000   6540           200            200            0.0030175688  -0.002407938    0              0.011460644    5.519043e-15   0              5.3405778e-10  1.1965779e-13  0              2.9951094    
   2600000   6540           200            200            0.0030175688  -0.002407938    0              0.011460644    7.9850627e-16  0              7.7268557e-11  1.1965779e-13  0              2.9951094    
   2700000   6540           200            200            0.0030175688  -0.002407938    0              0.011460644    6.0586511e-17  0              5.862737e-12   1.1965779e-13  0              2.9951094    
   2800000   6540           200            200            0.0030175688  -0.002407938    0              0.011460644    1.6162765e-20  0              1.5640122e-15  1.1965779e-13  0              2.9951094    
   2900000   6540           200            200            0.0030175688  -0.002407938    0              0.011460644    1.8885948e-18  0              1.8275247e-13  1.1965779e-13  0              2.9951094    
   3000000   6540           200            200            0.0030175688  -0.002407938    0              0.011460644    6.0766636e-18  0              5.8801671e-13  1.1965779e-13  0              2.9951094    
Loop time of 292.302 on 4 procs for 3000000 steps with 2500 atoms

Performance: 8867528.317 ns/day, 0.000 hours/ns, 10263.343 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 10.354     | 37.187     | 63.898     | 435.3 | 12.72
Neigh   | 4.0182     | 4.091      | 4.1651     |   3.1 |  1.40
Comm    | 24.869     | 51.744     | 77.888     | 357.3 | 17.70
Output  | 0.27178    | 0.27214    | 0.2725     |   0.1 |  0.09
Modify  | 108.98     | 143.14     | 177.38     | 279.5 | 48.97
Other   |            | 55.86      |            |       | 19.11

Nlocal:            625 ave         876 max         375 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:            1.5 ave           4 max           0 min
Histogram: 2 0 0 0 0 1 0 0 0 1
Neighs:         339.75 ave         680 max           0 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 1359
Ave neighs/atom = 0.5436
Neighbor list builds = 164
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 37

#variable lat0 equal 1                    #
variable lat1 equal 3+(100*0.01)+(v_ind*0.01)  # .491+(v_ind*0.001)       # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 500*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.37                                                               
Lattice spacing in x,y,z = 4.37 4.37 4.37

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -3277.5 ${n1e1} -100 100 -100 100 units box
region box block -3277.5 3277.5 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -3277.5 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -3277.5 3277.5 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-3277.5 -100 -100) to (3277.5 100 100)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 1500 atoms
  using lattice units in orthogonal box = (-3277.5 -100 -100) to (3277.5 100 100)
  create_atoms CPU = 0.000 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 1500 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 1001 atoms
  using lattice units in orthogonal box = (-3277.5 -100 -100) to (3277.5 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  1500 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  1500 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  1001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  1001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
1500 atoms in group substrate
group slider1 region slider1
1001 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 1001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_37_*.dump id type diameter mass xu yu zu fx fy fz

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 4230 130 130
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 86.71 | 86.74 | 86.76 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   6555           200            200            0              0              0              0              0              0              0              1.1965779e-13  0              6            
    100000   6555           200            200            0.003095465    1.5404153e-36  0              0.0092863949   583251.6       0              5.6326265e+10  1.1965779e-13  0              3.3279765    
    200000   6555           200            200            0.0010827434   1.2228891e-40  0              0.0032482303   139306.88      0              1.3453261e+10  1.1965779e-13  0              3.0768364    
    300000   6555           200            200            5.3216108e-05  1.2893477e-41  0              0.00015964832  710.06609      0              68573100       1.1965779e-13  0              3.0454325    
    400000   6555           200            200            0.00014917602 -9.119254e-34   0              0.00044752805  5117.3017      0              4.9419237e+08  1.1965779e-13  0              3.0017762    
    500000   6555           200            200            0.00037609184 -0.00045137189  0              0.0015796474   8.4670235      0              817684.52      1.1965779e-13  0              2.9981812    
    600000   6555           200            200            0.0018511314  -0.0015866804   0              0.0071400747   10.247908      0              989669.64      1.1965779e-13  0              2.9961081    
    700000   6555           200            200            0.0029525016  -0.0015951895   0              0.010452694    18.443033      0              1781096.1      1.1965779e-13  0              2.9953075    
    800000   6555           200            200            0.0034346023  -0.0015957289   0              0.011899536    1.797042       0              173545.45      1.1965779e-13  0              2.9949894    
    900000   6555           200            200            0.0033317078  -0.001608434    0              0.011603557    0.23603434     0              22794.507      1.1965779e-13  0              2.9950497    
   1000000   6555           200            200            0.0032542273  -0.0016157599   0              0.011378442    0.039648625    0              3828.9805      1.1965779e-13  0              2.9950982    
   1100000   6555           200            200            0.0032645046  -0.0016163049   0              0.011409819    0.0035027186   0              338.26749      1.1965779e-13  0              2.9950918    
   1200000   6555           200            200            0.0032748805  -0.0016165015   0              0.011441143    0.0008185277   0              79.047547      1.1965779e-13  0              2.995085     
   1300000   6555           200            200            0.0032737849  -0.0016164805   0              0.011437835    5.1093217e-05  0              4.9342172      1.1965779e-13  0              2.9950857    
   1400000   6555           200            200            0.0032723542  -0.0016164516   0              0.011433514    1.6528621e-05  0              1.5962159      1.1965779e-13  0              2.9950866    
   1500000   6555           200            200            0.0032724603  -0.0016164536   0              0.011433834    7.1420535e-07  0              0.06897284     1.1965779e-13  0              2.9950865    
   1600000   6555           200            200            0.0032726563  -0.0016164575   0              0.011434426    3.2811954e-07  0              0.031687437    1.1965779e-13  0              2.9950864    
   1700000   6555           200            200            0.0032726477  -0.0016164573   0              0.0114344      9.4549532e-09  0              0.0009130917   1.1965779e-13  0              2.9950864    
   1800000   6555           200            200            0.003272621   -0.0016164568   0              0.01143432     6.4111339e-09  0              0.00061914143  1.1965779e-13  0              2.9950864    
   1900000   6555           200            200            0.0032726214  -0.0016164568   0              0.011434321    1.1608991e-10  0              1.1211132e-05  1.1965779e-13  0              2.9950864    
   2000000   6555           200            200            0.003272625   -0.0016164569   0              0.011434332    1.2342802e-10  0              1.1919795e-05  1.1965779e-13  0              2.9950864    
   2100000   6555           200            200            0.0032726251  -0.0016164569   0              0.011434332    1.2738535e-12  0              1.2301965e-07  1.1965779e-13  0              2.9950864    
   2200000   6555           200            200            0.0032726246  -0.0016164569   0              0.011434331    2.343593e-12   0              2.2632744e-07  1.1965779e-13  0              2.9950864    
   2300000   6555           200            200            0.0032726246  -0.0016164569   0              0.011434331    1.1645801e-14  0              1.1246681e-09  1.1965779e-13  0              2.9950864    
   2400000   6555           200            200            0.0032726246  -0.0016164569   0              0.011434331    4.3908545e-14  0              4.2403729e-09  1.1965779e-13  0              2.9950864    
   2500000   6555           200            200            0.0032726246  -0.0016164569   0              0.011434331    6.0769508e-17  0              5.8686841e-12  1.1965779e-13  0              2.9950864    
   2600000   6555           200            200            0.0032726246  -0.0016164569   0              0.011434331    8.1162898e-16  0              7.8381318e-11  1.1965779e-13  0              2.9950864    
   2700000   6555           200            200            0.0032726246  -0.0016164569   0              0.011434331    1.3983752e-20  0              1.3504507e-15  1.1965779e-13  0              2.9950864    
   2800000   6555           200            200            0.0032726246  -0.0016164569   0              0.011434331    1.3767374e-17  0              1.3295544e-12  1.1965779e-13  0              2.9950864    
   2900000   6555           200            200            0.0032726246  -0.0016164569   0              0.011434331    1.3249555e-20  0              1.2795472e-15  1.1965779e-13  0              2.9950864    
   3000000   6555           200            200            0.0032726246  -0.0016164569   0              0.011434331    2.0193908e-20  0              1.9501831e-15  1.1965779e-13  0              2.9950864    
Loop time of 293.273 on 4 procs for 3000000 steps with 2501 atoms

Performance: 8838179.691 ns/day, 0.000 hours/ns, 10229.375 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 10.871     | 37.438     | 64.563     | 430.3 | 12.77
Neigh   | 3.9958     | 4.0666     | 4.1371     |   3.1 |  1.39
Comm    | 18.663     | 37.958     | 77.729     | 377.5 | 12.94
Output  | 0.26999    | 0.2703     | 0.27065    |   0.1 |  0.09
Modify  | 109        | 157.41     | 176.54     | 223.8 | 53.67
Other   |            | 56.13      |            |       | 19.14

Nlocal:         625.25 ave         876 max         375 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:           1.75 ave           3 max           1 min
Histogram: 2 0 0 0 0 1 0 0 0 1
Neighs:         339.75 ave         680 max           0 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 1359
Ave neighs/atom = 0.54338265
Neighbor list builds = 164
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 38

#variable lat0 equal 1                    #
variable lat1 equal 3+(100*0.01)+(v_ind*0.01)  # .491+(v_ind*0.001)       # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 500*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.38                                                               
Lattice spacing in x,y,z = 4.38 4.38 4.38

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -3285 ${n1e1} -100 100 -100 100 units box
region box block -3285 3285 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -3285 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -3285 3285 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-3285 -100 -100) to (3285 100 100)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 1500 atoms
  using lattice units in orthogonal box = (-3285 -100 -100) to (3285 100 100)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 1500 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 1001 atoms
  using lattice units in orthogonal box = (-3285 -100 -100) to (3285 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  1500 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  1500 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  1001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  1001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
1500 atoms in group substrate
group slider1 region slider1
1001 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 1001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_38_*.dump id type diameter mass xu yu zu fx fy fz

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 4239 130 130
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 86.9 | 86.91 | 86.91 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   6570           200            200            0              0              0              0              0              0              0              1.1965779e-13  0              6            
    100000   6570           200            200            0.0030888589  -1.5983734e-34  0              0.0092665768   583382.35      0              5.6338892e+10  1.1965779e-13  0              3.3278714    
    200000   6570           200            200            0.001081383    6.1476305e-36  0              0.0032441489   139531.6       0              1.3474963e+10  1.1965779e-13  0              3.0766476    
    300000   6570           200            200            5.4709052e-05  9.8361888e-35  0              0.00016412716  752.33652      0              72655276       1.1965779e-13  0              3.0454474    
    400000   6570           200            200            0.00015380326  1.2295298e-35  0              0.00046140977  5436.2684      0              5.2499589e+08  1.1965779e-13  0              3.001484     
    500000   6570           200            200            0.00078573662  0.00045474261  0              0.0019024673   148.8411       0              14374008       1.1965779e-13  0              2.9980401    
    600000   6570           200            200            0.0028142548   0.0013720358   0              0.0070707285   0.78036788     0              75362.345      1.1965779e-13  0              2.9961594    
    700000   6570           200            200            0.0038313283   0.0013989385   0              0.010095046    10.446627      0              1008860.4      1.1965779e-13  0              2.9954054    
    800000   6570           200            200            0.0042215346   0.0014157575   0              0.011248846    3.4866837      0              336718.96      1.1965779e-13  0              2.9951437    
    900000   6570           200            200            0.0043031014   0.001418828    0              0.011490476    0.43266871     0              41784.048      1.1965779e-13  0              2.9950913    
   1000000   6570           200            200            0.0042989694   0.0014186328   0              0.011478276    0.019261065    0              1860.0958      1.1965779e-13  0              2.9950946    
   1100000   6570           200            200            0.0042856397   0.0014181125   0              0.011438807    3.6771882e-05  0              3.5511652      1.1965779e-13  0              2.9951036    
   1200000   6570           200            200            0.0042782862   0.0014178288   0              0.01141703     0.00049774111  0              48.068274      1.1965779e-13  0              2.9951085    
   1300000   6570           200            200            0.0042757075   0.0014177302   0              0.011409392    0.00015528714  0              14.99652       1.1965779e-13  0              2.9951102    
   1400000   6570           200            200            0.0042751639   0.0014177098   0              0.011407782    1.9441835e-05  0              1.8775533      1.1965779e-13  0              2.9951105    
   1500000   6570           200            200            0.004275188    0.001417711    0              0.011407853    8.915744e-07   0              0.086101874    1.1965779e-13  0              2.9951105    
   1600000   6570           200            200            0.0042752757   0.0014177145   0              0.011408113    1.0587213e-09  0              0.00010224373  1.1965779e-13  0              2.9951104    
   1700000   6570           200            200            0.0042753246   0.0014177164   0              0.011408257    2.1520042e-08  0              0.0020782517   1.1965779e-13  0              2.9951104    
   1800000   6570           200            200            0.0042753419   0.001417717    0              0.011408309    6.8778623e-09  0              0.00066421471  1.1965779e-13  0              2.9951104    
   1900000   6570           200            200            0.0042753456   0.0014177172   0              0.01140832     8.7519082e-10  0              8.4519665e-05  1.1965779e-13  0              2.9951104    
   2000000   6570           200            200            0.0042753455   0.0014177171   0              0.011408319    4.1289152e-11  0              3.9874107e-06  1.1965779e-13  0              2.9951104    
   2100000   6570           200            200            0.0042753449   0.0014177171   0              0.011408318    2.7011112e-14  0              2.6085399e-09  1.1965779e-13  0              2.9951104    
   2200000   6570           200            200            0.0042753446   0.0014177171   0              0.011408317    9.2962857e-13  0              8.9776873e-08  1.1965779e-13  0              2.9951104    
   2300000   6570           200            200            0.0042753445   0.0014177171   0              0.011408316    3.0438075e-13  0              2.9394914e-08  1.1965779e-13  0              2.9951104    
   2400000   6570           200            200            0.0042753444   0.0014177171   0              0.011408316    3.9342485e-14  0              3.7994156e-09  1.1965779e-13  0              2.9951104    
   2500000   6570           200            200            0.0042753444   0.0014177171   0              0.011408316    1.8918644e-15  0              1.8270272e-10  1.1965779e-13  0              2.9951104    
   2600000   6570           200            200            0.0042753444   0.0014177171   0              0.011408316    2.940821e-18   0              2.8400344e-13  1.1965779e-13  0              2.9951104    
   2700000   6570           200            200            0.0042753445   0.0014177171   0              0.011408316    3.7888572e-17  0              3.6590071e-12  1.1965779e-13  0              2.9951104    
   2800000   6570           200            200            0.0042753445   0.0014177171   0              0.011408316    1.1895977e-17  0              1.1488283e-12  1.1965779e-13  0              2.9951104    
   2900000   6570           200            200            0.0042753445   0.0014177171   0              0.011408316    3.2614973e-18  0              3.1497206e-13  1.1965779e-13  0              2.9951104    
   3000000   6570           200            200            0.0042753445   0.0014177171   0              0.011408316    4.846933e-18   0              4.680821e-13   1.1965779e-13  0              2.9951104    
Loop time of 296.475 on 4 procs for 3000000 steps with 2501 atoms

Performance: 8742740.903 ns/day, 0.000 hours/ns, 10118.913 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 10.892     | 37.623     | 64.298     | 432.5 | 12.69
Neigh   | 4.0776     | 4.1548     | 4.2331     |   3.3 |  1.40
Comm    | 18.728     | 38.102     | 77.536     | 374.2 | 12.85
Output  | 0.27426    | 0.27457    | 0.27491    |   0.1 |  0.09
Modify  | 112.22     | 160.2      | 179.07     | 219.8 | 54.04
Other   |            | 56.12      |            |       | 18.93

Nlocal:         625.25 ave         876 max         375 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:           1.75 ave           3 max           1 min
Histogram: 2 0 0 0 0 1 0 0 0 1
Neighs:         342.25 ave         685 max           0 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 1369
Ave neighs/atom = 0.54738105
Neighbor list builds = 164
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 39

#variable lat0 equal 1                    #
variable lat1 equal 3+(100*0.01)+(v_ind*0.01)  # .491+(v_ind*0.001)       # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 500*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.39                                                               
Lattice spacing in x,y,z = 4.39 4.39 4.39

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -3292.5 ${n1e1} -100 100 -100 100 units box
region box block -3292.5 3292.5 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -3292.5 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -3292.5 3292.5 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-3292.5 -100 -100) to (3292.5 100 100)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 1500 atoms
  using lattice units in orthogonal box = (-3292.5 -100 -100) to (3292.5 100 100)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 1500 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 1001 atoms
  using lattice units in orthogonal box = (-3292.5 -100 -100) to (3292.5 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  1500 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  1500 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  1001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  1001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
1500 atoms in group substrate
group slider1 region slider1
1001 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 1001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_39_*.dump id type diameter mass xu yu zu fx fy fz

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 4249 130 130
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 87.11 | 87.12 | 87.12 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   6585           200            200            0              0              0              0              0              0              0              1.1965779e-13  0              6            
    100000   6585           200            200            0.003081771    1.8400786e-35  0              0.0092453129   583362.14      0              5.633694e+10   1.1965779e-13  0              3.3279277    
    200000   6585           200            200            0.001078708    2.2778228e-39  0              0.0032361241   139486.08      0              1.3470567e+10  1.1965779e-13  0              3.0767407    
    300000   6585           200            200            5.4388336e-05 -4.906802e-35   0              0.00016316501  747.10919      0              72150457       1.1965779e-13  0              3.0454903    
    400000   6585           200            200            0.00015256307  9.8138375e-35  0              0.00045768922  5378.2733      0              5.1939514e+08  1.1965779e-13  0              3.0015811    
    500000   6585           200            200            0.00032896621 -0.0007386128   0              0.0017255114   89.010586      0              8596005.3      1.1965779e-13  0              2.9981529    
    600000   6585           200            200            0.001917109   -0.0015401498   0              0.0072914768   28.555388      0              2757674.9      1.1965779e-13  0              2.9961223    
    700000   6585           200            200            0.0035103104  -0.001874908    0              0.012405839    18.882744      0              1823560.2      1.1965779e-13  0              2.9949373    
    800000   6585           200            200            0.0032600524  -0.0019057628   0              0.01168592     2.9021575      0              280269.6       1.1965779e-13  0              2.9950792    
    900000   6585           200            200            0.0030703758  -0.0019399374   0              0.011151065    0.0034616273   0              334.29918      1.1965779e-13  0              2.9951951    
   1000000   6585           200            200            0.0031579789  -0.0019407159   0              0.011414653    0.059468892    0              5743.0799      1.1965779e-13  0              2.9951389    
   1100000   6585           200            200            0.0031541294  -0.0019405876   0              0.011402976    0.0052420735   0              506.24194      1.1965779e-13  0              2.995141     
   1200000   6585           200            200            0.0031436148  -0.0019404029   0              0.011371247    7.376336e-05   0              7.1235374      1.1965779e-13  0              2.9951479    
   1300000   6585           200            200            0.0031476453  -0.0019405247   0              0.011383461    0.00015975933  0              15.428412      1.1965779e-13  0              2.9951453    
   1400000   6585           200            200            0.0031477041  -0.0019405276   0              0.01138364     9.5117989e-06  0              0.91858146     1.1965779e-13  0              2.9951452    
   1500000   6585           200            200            0.003147141   -0.0019405097   0              0.011381933    4.4748646e-07  0              0.04321504     1.1965779e-13  0              2.9951456    
   1600000   6585           200            200            0.0031473221  -0.0019405153   0              0.011382482    4.1003896e-07  0              0.039598628    1.1965779e-13  0              2.9951455    
   1700000   6585           200            200            0.0031473373  -0.0019405158   0              0.011382528    1.5559636e-08  0              0.0015026383   1.1965779e-13  0              2.9951455    
   1800000   6585           200            200            0.0031473078  -0.0019405149   0              0.011382438    1.977272e-09   0              0.00019095078  1.1965779e-13  0              2.9951455    
   1900000   6585           200            200            0.0031473156  -0.0019405151   0              0.011382462    1.0076161e-09  0              9.7308347e-05  1.1965779e-13  0              2.9951455    
   2000000   6585           200            200            0.003147317   -0.0019405152   0              0.011382466    2.1710003e-11  0              2.0965967e-06  1.1965779e-13  0              2.9951455    
   2100000   6585           200            200            0.0031473155  -0.0019405151   0              0.011382461    7.3761233e-12  0              7.1233319e-07  1.1965779e-13  0              2.9951455    
   2200000   6585           200            200            0.0031473158  -0.0019405151   0              0.011382462    2.371864e-12   0              2.2905764e-07  1.1965779e-13  0              2.9951455    
   2300000   6585           200            200            0.0031473159  -0.0019405151   0              0.011382463    2.2631707e-14  0              2.1856083e-09  1.1965779e-13  0              2.9951455    
   2400000   6585           200            200            0.0031473158  -0.0019405151   0              0.011382463    2.4684938e-14  0              2.3838947e-09  1.1965779e-13  0              2.9951455    
   2500000   6585           200            200            0.0031473158  -0.0019405151   0              0.011382463    5.3046471e-15  0              5.1228485e-10  1.1965779e-13  0              2.9951455    
   2600000   6585           200            200            0.0031473158  -0.0019405151   0              0.011382463    9.1132945e-18  0              8.8009676e-13  1.1965779e-13  0              2.9951455    
   2700000   6585           200            200            0.0031473158  -0.0019405151   0              0.011382463    7.2407135e-17  0              6.9925629e-12  1.1965779e-13  0              2.9951455    
   2800000   6585           200            200            0.0031473158  -0.0019405151   0              0.011382463    1.2961101e-17  0              1.2516903e-12  1.1965779e-13  0              2.9951455    
   2900000   6585           200            200            0.0031473158  -0.0019405151   0              0.011382463    5.3919896e-19  0              5.2071976e-14  1.1965779e-13  0              2.9951455    
   3000000   6585           200            200            0.0031473158  -0.0019405151   0              0.011382463    4.9971022e-19  0              4.8258436e-14  1.1965779e-13  0              2.9951455    
Loop time of 294.51 on 4 procs for 3000000 steps with 2501 atoms

Performance: 8801072.044 ns/day, 0.000 hours/ns, 10186.426 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 10.911     | 37.728     | 65.063     | 432.1 | 12.81
Neigh   | 4.0465     | 4.1239     | 4.202      |   3.3 |  1.40
Comm    | 17.789     | 23.814     | 28.709     |  92.8 |  8.09
Output  | 0.28016    | 0.28048    | 0.28079    |   0.1 |  0.10
Modify  | 167.97     | 172.44     | 176.44     |  27.5 | 58.55
Other   |            | 56.13      |            |       | 19.06

Nlocal:         625.25 ave         877 max         374 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:           1.75 ave           3 max           1 min
Histogram: 2 0 0 0 0 1 0 0 0 1
Neighs:         339.25 ave         679 max           0 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 1357
Ave neighs/atom = 0.54258297
Neighbor list builds = 164
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 40

#variable lat0 equal 1                    #
variable lat1 equal 3+(100*0.01)+(v_ind*0.01)  # .491+(v_ind*0.001)       # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 500*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.4                                                               
Lattice spacing in x,y,z = 4.4 4.4 4.4

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -3300 ${n1e1} -100 100 -100 100 units box
region box block -3300 3300 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -3300 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -3300 3300 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-3300 -100 -100) to (3300 100 100)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 1499 atoms
  using lattice units in orthogonal box = (-3300 -100 -100) to (3300 100 100)
  create_atoms CPU = 0.000 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 1500 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 1001 atoms
  using lattice units in orthogonal box = (-3300 -100 -100) to (3300 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  1499 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  1499 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  1001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  1001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
1499 atoms in group substrate
group slider1 region slider1
1001 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 1001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_40_*.dump id type diameter mass xu yu zu fx fy fz

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 4259 130 130
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 87.25 | 87.26 | 87.26 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   6600           200            200            0              0              0              0              0              0              0              1.1965779e-13  0              6            
    100000   6600           200            200            0.0030745344  -9.7913977e-35  0              0.0092236032   583319.38      0              5.6445702e+10  1.1965779e-13  0              3.3277908    
    200000   6600           200            200            0.0010728544  -1.5299111e-36  0              0.0032185631   138791.03      0              1.3430305e+10  1.1965779e-13  0              3.07742      
    300000   6600           200            200            5.7544917e-05  1.8358963e-34  0              0.00017263475  836.75677      0              80969919       1.1965779e-13  0              3.0452613    
    400000   6600           200            200            0.0001536221  -2.4478237e-35  0              0.00046086631  5470.6579      0              5.2937574e+08  1.1965779e-13  0              3.0012849    
    500000   6600           200            200            0.0047600889  -1.4242761e-14  0              0.014280267    1275.0838      0              1.2338524e+08  1.1965779e-13  0              2.9942638    
    600000   6600           200            200            0.0025859443  -7.8755359e-15  0              0.007757833    4.2533981      0              411585.92      1.1965779e-13  0              2.9961403    
    700000   6600           200            200            0.0040886961  -1.2448585e-14  0              0.012266088    14.194035      0              1373505.3      1.1965779e-13  0              2.9947593    
    800000   6600           200            200            0.0038456125  -1.1678305e-14  0              0.011536837    2.9681506      0              287217.17      1.1965779e-13  0              2.994978     
    900000   6600           200            200            0.0037233355  -1.1317778e-14  0              0.011170007    0.0069221473   0              669.8311       1.1965779e-13  0              2.9950822    
   1000000   6600           200            200            0.0037982008  -1.1545777e-14  0              0.011394602    0.041664117    0              4031.6855      1.1965779e-13  0              2.9950162    
   1100000   6600           200            200            0.0037894367  -1.1517491e-14  0              0.01136831     0.00643614     0              622.80194      1.1965779e-13  0              2.9950244    
   1200000   6600           200            200            0.0037822816  -1.149624e-14   0              0.011346845    1.8813163e-07  0              0.018204816    1.1965779e-13  0              2.9950305    
   1300000   6600           200            200            0.0037858828  -1.150724e-14   0              0.011357648    0.00012040153  0              11.65082       1.1965779e-13  0              2.9950273    
   1400000   6600           200            200            0.0037856318  -1.1506392e-14  0              0.011356895    1.3314578e-05  0              1.2884035      1.1965779e-13  0              2.9950276    
   1500000   6600           200            200            0.0037852305  -1.1505194e-14  0              0.011355692    6.1498962e-08  0              0.0059510317   1.1965779e-13  0              2.9950279    
   1600000   6600           200            200            0.0037854     -1.1505713e-14  0              0.0113562      3.3206377e-07  0              0.032132607    1.1965779e-13  0              2.9950278    
   1700000   6600           200            200            0.0037853969  -1.1505699e-14  0              0.011356191    2.5996421e-08  0              0.0025155794   1.1965779e-13  0              2.9950278    
   1800000   6600           200            200            0.0037853751  -1.1505634e-14  0              0.011356125    5.4259687e-10  0              5.2505132e-05  1.1965779e-13  0              2.9950278    
   1900000   6600           200            200            0.0037853829  -1.1505658e-14  0              0.011356149    8.7799221e-10  0              8.4960123e-05  1.1965779e-13  0              2.9950278    
   2000000   6600           200            200            0.0037853832  -1.1505659e-14  0              0.011356149    4.7168662e-11  0              4.5643404e-06  1.1965779e-13  0              2.9950278    
   2100000   6600           200            200            0.003785382   -1.1505655e-14  0              0.011356146    2.8157674e-12  0              2.724716e-07   1.1965779e-13  0              2.9950278    
   2200000   6600           200            200            0.0037853824  -1.1505656e-14  0              0.011356147    2.2313803e-12  0              2.1592259e-07  1.1965779e-13  0              2.9950278    
   2300000   6600           200            200            0.0037853824  -1.1505656e-14  0              0.011356147    7.7607726e-14  0              7.5098183e-09  1.1965779e-13  0              2.9950278    
   2400000   6600           200            200            0.0037853823  -1.1505656e-14  0              0.011356147    1.1527134e-14  0              1.115439e-09   1.1965779e-13  0              2.9950278    
   2500000   6600           200            200            0.0037853824  -1.1505656e-14  0              0.011356147    5.453894e-15   0              5.2775356e-10  1.1965779e-13  0              2.9950278    
   2600000   6600           200            200            0.0037853824  -1.1505656e-14  0              0.011356147    1.1428472e-16  0              1.1058918e-11  1.1965779e-13  0              2.9950278    
   2700000   6600           200            200            0.0037853824  -1.1505656e-14  0              0.011356147    5.2360788e-17  0              5.0667636e-12  1.1965779e-13  0              2.9950278    
   2800000   6600           200            200            0.0037853824  -1.1505656e-14  0              0.011356147    1.1610241e-17  0              1.1234809e-12  1.1965779e-13  0              2.9950278    
   2900000   6600           200            200            0.0037853824  -1.1505656e-14  0              0.011356147    4.0353269e-18  0              3.9048395e-13  1.1965779e-13  0              2.9950278    
   3000000   6600           200            200            0.0037853824  -1.1505656e-14  0              0.011356147    3.8646868e-18  0              3.7397173e-13  1.1965779e-13  0              2.9950278    
Loop time of 287.397 on 4 procs for 3000000 steps with 2500 atoms

Performance: 9018892.583 ns/day, 0.000 hours/ns, 10438.533 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 10.306     | 34.82      | 59.172     | 408.9 | 12.12
Neigh   | 4.0555     | 4.1301     | 4.2045     |   3.1 |  1.44
Comm    | 24.534     | 49.096     | 72.743     | 333.4 | 17.08
Output  | 0.29695    | 0.29727    | 0.2976     |   0.1 |  0.10
Modify  | 108.31     | 142.85     | 177.85     | 282.2 | 49.70
Other   |            | 56.21      |            |       | 19.56

Nlocal:            625 ave         876 max         375 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:            1.5 ave           4 max           0 min
Histogram: 2 0 0 0 0 1 0 0 0 1
Neighs:         329.75 ave         660 max           0 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 1319
Ave neighs/atom = 0.5276
Neighbor list builds = 164
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 41

#variable lat0 equal 1                    #
variable lat1 equal 3+(100*0.01)+(v_ind*0.01)  # .491+(v_ind*0.001)       # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 500*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.41                                                               
Lattice spacing in x,y,z = 4.41 4.41 4.41

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -3307.5 ${n1e1} -100 100 -100 100 units box
region box block -3307.5 3307.5 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -3307.5 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -3307.5 3307.5 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-3307.5 -100 -100) to (3307.5 100 100)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 1500 atoms
  using lattice units in orthogonal box = (-3307.5 -100 -100) to (3307.5 100 100)
  create_atoms CPU = 0.000 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 1500 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 1001 atoms
  using lattice units in orthogonal box = (-3307.5 -100 -100) to (3307.5 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  1500 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  1500 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  1001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  1001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
1500 atoms in group substrate
group slider1 region slider1
1001 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 1001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_41_*.dump id type diameter mass xu yu zu fx fy fz

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 4268 130 130
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 87.39 | 87.4 | 87.4 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   6615           200            200            0              0              0              0              0              0              0              1.1965779e-13  0              6            
    100000   6615           200            200            0.0030675514  -3.0528776e-36  0              0.0092026541   583297.4       0              5.6330687e+10  1.1965779e-13  0              3.3279454    
    200000   6615           200            200            0.0010733455  -1.5264422e-36  0              0.0032200365   139392.89      0              1.3461567e+10  1.1965779e-13  0              3.0767653    
    300000   6615           200            200            5.334185e-05  -1.2211511e-35  0              0.00016002555  725.97099      0              70109082       1.1965779e-13  0              3.0454386    
    400000   6615           200            200            0.00014902102 -7.3268633e-35  0              0.00044706305  5193.9858      0              5.0159797e+08  1.1965779e-13  0              3.0017116    
    500000   6615           200            200            0.00026485398 -0.00078067557  0              0.0015752375   4.7099636      0              454854.57      1.1965779e-13  0              2.9981976    
    600000   6615           200            200            0.0021077152  -0.00086893563  0              0.0071920812   22.813463      0              2203161        1.1965779e-13  0              2.9960809    
    700000   6615           200            200            0.00331341     6.5004246e-05  0              0.0098752259   6.5392535      0              631514.3       1.1965779e-13  0              2.9954258    
    800000   6615           200            200            0.0038510995   0.00024442292  0              0.011308876    3.7472645      0              361883.98      1.1965779e-13  0              2.9951034    
    900000   6615           200            200            0.003927633    0.00025601291  0              0.011526886    0.1409355      0              13610.542      1.1965779e-13  0              2.9950541    
   1000000   6615           200            200            0.0038846978   0.00024998426  0              0.011404109    0.015860914    0              1531.7335      1.1965779e-13  0              2.9950801    
   1100000   6615           200            200            0.0038589648   0.00024618639  0              0.011330708    0.0092023361   0              888.69576      1.1965779e-13  0              2.9950961    
   1200000   6615           200            200            0.0038554751   0.00024564439  0              0.011320781    0.00031080511  0              30.015332      1.1965779e-13  0              2.9950984    
   1300000   6615           200            200            0.0038576838   0.00024596633  0              0.011327085    4.3236387e-05  0              4.1754607      1.1965779e-13  0              2.995097     
   1400000   6615           200            200            0.0038589515   0.0002461554   0              0.011330699    2.2551427e-05  0              2.1778554      1.1965779e-13  0              2.9950962    
   1500000   6615           200            200            0.0038591108   0.00024618022  0              0.011331152    6.8225271e-07  0              0.065887084    1.1965779e-13  0              2.9950961    
   1600000   6615           200            200            0.0038589974   0.00024616369  0              0.011330828    1.1725509e-07  0              0.011323657    1.1965779e-13  0              2.9950962    
   1700000   6615           200            200            0.003858935    0.00024615438  0              0.011330651    5.5160205e-08  0              0.0053269778   1.1965779e-13  0              2.9950962    
   1800000   6615           200            200            0.0038589278   0.00024615325  0              0.01133063     1.4845984e-09  0              0.00014337189  1.1965779e-13  0              2.9950962    
   1900000   6615           200            200            0.0038589336   0.0002461541   0              0.011330647    3.1583722e-10  0              3.0501298e-05  1.1965779e-13  0              2.9950962    
   2000000   6615           200            200            0.0038589367   0.00024615456  0              0.011330655    1.3466585e-10  0              1.3005064e-05  1.1965779e-13  0              2.9950962    
   2100000   6615           200            200            0.003858937    0.00024615461  0              0.011330656    3.2002011e-12  0              3.0905252e-07  1.1965779e-13  0              2.9950962    
   2200000   6615           200            200            0.0038589367   0.00024615457  0              0.011330655    8.4534781e-13  0              8.1637641e-08  1.1965779e-13  0              2.9950962    
   2300000   6615           200            200            0.0038589365   0.00024615454  0              0.011330655    3.2808167e-13  0              3.1683779e-08  1.1965779e-13  0              2.9950962    
   2400000   6615           200            200            0.0038589365   0.00024615454  0              0.011330655    6.6565477e-15  0              6.4284173e-10  1.1965779e-13  0              2.9950962    
   2500000   6615           200            200            0.0038589365   0.00024615454  0              0.011330655    2.2301558e-15  0              2.1537249e-10  1.1965779e-13  0              2.9950962    
   2600000   6615           200            200            0.0038589365   0.00024615454  0              0.011330655    8.0402725e-16  0              7.7647197e-11  1.1965779e-13  0              2.9950962    
   2700000   6615           200            200            0.0038589365   0.00024615454  0              0.011330655    1.4337463e-17  0              1.3846096e-12  1.1965779e-13  0              2.9950962    
   2800000   6615           200            200            0.0038589365   0.00024615454  0              0.011330655    7.5207479e-18  0              7.263e-13      1.1965779e-13  0              2.9950962    
   2900000   6615           200            200            0.0038589365   0.00024615454  0              0.011330655    1.6867487e-18  0              1.6289411e-13  1.1965779e-13  0              2.9950962    
   3000000   6615           200            200            0.0038589365   0.00024615455  0              0.011330655    8.9345722e-19  0              8.6283704e-14  1.1965779e-13  0              2.9950962    
Loop time of 293.585 on 4 procs for 3000000 steps with 2501 atoms

Performance: 8828802.246 ns/day, 0.000 hours/ns, 10218.521 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 10.904     | 37.45      | 64.579     | 429.9 | 12.76
Neigh   | 4.0231     | 4.0967     | 4.171      |   3.1 |  1.40
Comm    | 18.816     | 37.882     | 77.517     | 376.4 | 12.90
Output  | 0.27169    | 0.27201    | 0.27233    |   0.1 |  0.09
Modify  | 108.76     | 157.34     | 177.25     | 224.9 | 53.59
Other   |            | 56.55      |            |       | 19.26

Nlocal:         625.25 ave         876 max         375 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:           1.75 ave           3 max           1 min
Histogram: 2 0 0 0 0 1 0 0 0 1
Neighs:         340.25 ave         681 max           0 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 1361
Ave neighs/atom = 0.54418233
Neighbor list builds = 164
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 42

#variable lat0 equal 1                    #
variable lat1 equal 3+(100*0.01)+(v_ind*0.01)  # .491+(v_ind*0.001)       # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 500*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.42                                                               
Lattice spacing in x,y,z = 4.42 4.42 4.42

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -3315 ${n1e1} -100 100 -100 100 units box
region box block -3315 3315 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -3315 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -3315 3315 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-3315 -100 -100) to (3315 100 100)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 1500 atoms
  using lattice units in orthogonal box = (-3315 -100 -100) to (3315 100 100)
  create_atoms CPU = 0.000 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 1500 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 1001 atoms
  using lattice units in orthogonal box = (-3315 -100 -100) to (3315 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  1500 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  1500 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  1001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  1001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
1500 atoms in group substrate
group slider1 region slider1
1001 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 1001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_42_*.dump id type diameter mass xu yu zu fx fy fz

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 4278 130 130
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 87.54 | 87.57 | 87.6 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   6630           200            200            0              0              0              0              0              0              0              1.1965779e-13  0              6            
    100000   6630           200            200            0.0030605155   3.6551802e-35  0              0.0091815464   583264.02      0              5.6327464e+10  1.1965779e-13  0              3.3280159    
    200000   6630           200            200            0.0010706368  -1.2183866e-35  0              0.0032119105   139332.86      0              1.3455771e+10  1.1965779e-13  0              3.0768753    
    300000   6630           200            200            5.2619227e-05 -2.4367353e-35  0              0.00015785768  710.17159      0              68583289       1.1965779e-13  0              3.0454963    
    400000   6630           200            200            0.00014928147 -7.310333e-35   0              0.0004478444   5232.3988      0              5.0530763e+08  1.1965779e-13  0              3.001715     
    500000   6630           200            200            0.00045628237 -0.00036088282  0              0.0017297299   78.86078       0              7615809.7      1.1965779e-13  0              2.9981451    
    600000   6630           200            200            0.0024719625   0.00026419192  0              0.0071516956   17.624896      0              1702086.3      1.1965779e-13  0              2.9961267    
    700000   6630           200            200            0.0043855235   0.0011986957   0              0.011957875    24.362739      0              2352779        1.1965779e-13  0              2.994988     
    800000   6630           200            200            0.0043236562   0.0012400672   0              0.011730902    2.0435786      0              197354.2       1.1965779e-13  0              2.9950281    
    900000   6630           200            200            0.0040970414   0.0012083508   0              0.011082773    0.038678645    0              3735.3067      1.1965779e-13  0              2.9951682    
   1000000   6630           200            200            0.0041810486   0.0012207708   0              0.011322375    0.066071724    0              6380.7342      1.1965779e-13  0              2.9951171    
   1100000   6630           200            200            0.0041835088   0.0012212202   0              0.011329306    0.0036158048   0              349.18855      1.1965779e-13  0              2.9951152    
   1200000   6630           200            200            0.0041713425   0.0012194244   0              0.011294603    0.00020569017  0              19.864084      1.1965779e-13  0              2.9951227    
   1300000   6630           200            200            0.004175124    0.001219972    0              0.0113054      0.00016770061  0              16.195324      1.1965779e-13  0              2.9951204    
   1400000   6630           200            200            0.0041754869   0.0012200296   0              0.011306431    5.9559899e-06  0              0.57518688     1.1965779e-13  0              2.9951202    
   1500000   6630           200            200            0.0041748545   0.0012199364   0              0.011304627    8.4934444e-07  0              0.082023607    1.1965779e-13  0              2.9951206    
   1600000   6630           200            200            0.0041750192   0.0012199601   0              0.011305097    4.1004464e-07  0              0.039599176    1.1965779e-13  0              2.9951205    
   1700000   6630           200            200            0.0041750488   0.0012199647   0              0.011305182    8.4730458e-09  0              0.00081826611  1.1965779e-13  0              2.9951205    
   1800000   6630           200            200            0.0041750166   0.0012199599   0              0.01130509     3.0516771e-09  0              0.00029470913  1.1965779e-13  0              2.9951205    
   1900000   6630           200            200            0.0041750235   0.0012199609   0              0.01130511     9.6539359e-10  0              9.3230803e-05  1.1965779e-13  0              2.9951205    
   2000000   6630           200            200            0.0041750255   0.0012199612   0              0.011305115    9.2842341e-12  0              8.9660487e-07  1.1965779e-13  0              2.9951205    
   2100000   6630           200            200            0.0041750239   0.001219961    0              0.011305111    9.9856391e-12  0              9.6434155e-07  1.1965779e-13  0              2.9951205    
   2200000   6630           200            200            0.0041750242   0.001219961    0              0.011305111    2.1851591e-12  0              2.1102702e-07  1.1965779e-13  0              2.9951205    
   2300000   6630           200            200            0.0041750243   0.001219961    0              0.011305112    5.4426641e-15  0              5.2561354e-10  1.1965779e-13  0              2.9951205    
   2400000   6630           200            200            0.0041750242   0.001219961    0              0.011305112    3.0484775e-14  0              2.9440014e-09  1.1965779e-13  0              2.9951205    
   2500000   6630           200            200            0.0041750242   0.001219961    0              0.011305112    4.6725452e-15  0              4.5124097e-10  1.1965779e-13  0              2.9951205    
   2600000   6630           200            200            0.0041750242   0.001219961    0              0.011305112    6.4757003e-19  0              6.2537679e-14  1.1965779e-13  0              2.9951205    
   2700000   6630           200            200            0.0041750242   0.001219961    0              0.011305112    8.5411694e-17  0              8.24845e-12    1.1965779e-13  0              2.9951205    
   2800000   6630           200            200            0.0041750242   0.001219961    0              0.011305112    1.2172791e-17  0              1.175561e-12   1.1965779e-13  0              2.9951205    
   2900000   6630           200            200            0.0041750242   0.001219961    0              0.011305112    1.0150522e-19  0              9.8026475e-15  1.1965779e-13  0              2.9951205    
   3000000   6630           200            200            0.0041750242   0.001219961    0              0.011305112    1.7855651e-19  0              1.7243709e-14  1.1965779e-13  0              2.9951205    
Loop time of 294.562 on 4 procs for 3000000 steps with 2501 atoms

Performance: 8799495.430 ns/day, 0.000 hours/ns, 10184.601 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 10.836     | 37.466     | 64.7       | 431.5 | 12.72
Neigh   | 3.9756     | 4.0469     | 4.1174     |   3.1 |  1.37
Comm    | 18.332     | 37.897     | 77.949     | 380.7 | 12.87
Output  | 0.27096    | 0.27128    | 0.27161    |   0.1 |  0.09
Modify  | 109.46     | 158.36     | 177.15     | 225.6 | 53.76
Other   |            | 56.52      |            |       | 19.19

Nlocal:         625.25 ave         876 max         375 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:           1.75 ave           3 max           1 min
Histogram: 2 0 0 0 0 1 0 0 0 1
Neighs:         339.25 ave         679 max           0 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 1357
Ave neighs/atom = 0.54258297
Neighbor list builds = 164
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 43

#variable lat0 equal 1                    #
variable lat1 equal 3+(100*0.01)+(v_ind*0.01)  # .491+(v_ind*0.001)       # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 500*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.43                                                               
Lattice spacing in x,y,z = 4.43 4.43 4.43

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -3322.5 ${n1e1} -100 100 -100 100 units box
region box block -3322.5 3322.5 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -3322.5 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -3322.5 3322.5 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-3322.5 -100 -100) to (3322.5 100 100)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 1500 atoms
  using lattice units in orthogonal box = (-3322.5 -100 -100) to (3322.5 100 100)
  create_atoms CPU = 0.000 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 1500 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 1001 atoms
  using lattice units in orthogonal box = (-3322.5 -100 -100) to (3322.5 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  1500 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  1500 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  1001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  1001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
1500 atoms in group substrate
group slider1 region slider1
1001 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 1001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_43_*.dump id type diameter mass xu yu zu fx fy fz

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 4288 130 130
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 87.74 | 87.74 | 87.75 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   6645           200            200            0              0              0              0              0              0              0              1.1965779e-13  0              6            
    100000   6645           200            200            0.0030527635   3.4798364e-41  0              0.0091582904   583036.37      0              5.6305479e+10  1.1965779e-13  0              3.3280956    
    200000   6645           200            200            0.0010661969   2.4313224e-35  0              0.0031985907   138925.31      0              1.3416412e+10  1.1965779e-13  0              3.0770945    
    300000   6645           200            200            4.8800279e-05  2.4313409e-35  0              0.00014640084  616.62052      0              59548796       1.1965779e-13  0              3.0453825    
    400000   6645           200            200            0.0001355592   1.2156579e-35  0              0.0004066776   4397.0241      0              4.2463311e+08  1.1965779e-13  0              3.0024291    
    500000   6645           200            200            0.00061225405  2.8014607e-05  0              0.0018087475   125.53925      0              12123683       1.1965779e-13  0              2.9979764    
    600000   6645           200            200            0.0024879039  -0.0019721583   0              0.0094358701   174.73385      0              16874545       1.1965779e-13  0              2.9954287    
    700000   6645           200            200            0.0026855423  -0.0018169088   0              0.0098735357   7.8981445      0              762746.26      1.1965779e-13  0              2.9953384    
    800000   6645           200            200            0.0029587167  -0.0018236526   0              0.010699803    0.39921906     0              38553.72       1.1965779e-13  0              2.9951517    
    900000   6645           200            200            0.0031381686  -0.0018202785   0              0.011234784    0.48412859     0              46753.674      1.1965779e-13  0              2.9950327    
   1000000   6645           200            200            0.0031738552  -0.0018209307   0              0.011342496    0.029777511    0              2875.6988      1.1965779e-13  0              2.9950085    
   1100000   6645           200            200            0.0031627818  -0.0018198487   0              0.011308194    0.00096971027  0              93.647677      1.1965779e-13  0              2.9950158    
   1200000   6645           200            200            0.0031540787  -0.0018189779   0              0.011281214    0.0011944382   0              115.35029      1.1965779e-13  0              2.9950217    
   1300000   6645           200            200            0.0031524114  -0.0018188071   0              0.011276041    6.9862324e-05  0              6.7468032      1.1965779e-13  0              2.9950228    
   1400000   6645           200            200            0.0031529787  -0.0018188615   0              0.011277798    2.6343787e-06  0              0.25440944     1.1965779e-13  0              2.9950225    
   1500000   6645           200            200            0.0031534096  -0.0018189044   0              0.011279133    2.9471082e-06  0              0.28461061     1.1965779e-13  0              2.9950222    
   1600000   6645           200            200            0.0031534897  -0.0018189126   0              0.011279382    1.6388001e-07  0              0.015826358    1.1965779e-13  0              2.9950221    
   1700000   6645           200            200            0.0031534607  -0.0018189098   0              0.011279292    7.1240361e-09  0              0.00068798841  1.1965779e-13  0              2.9950221    
   1800000   6645           200            200            0.0031534393  -0.0018189077   0              0.011279226    7.2670696e-09  0              0.00070180157  1.1965779e-13  0              2.9950221    
   1900000   6645           200            200            0.0031534355  -0.0018189073   0              0.011279214    3.8372237e-10  0              3.705716e-05   1.1965779e-13  0              2.9950221    
   2000000   6645           200            200            0.003153437   -0.0018189074   0              0.011279218    1.9159087e-11  0              1.8502474e-06  1.1965779e-13  0              2.9950221    
   2100000   6645           200            200            0.003153438   -0.0018189075   0              0.011279222    1.7905402e-11  0              1.7291756e-06  1.1965779e-13  0              2.9950221    
   2200000   6645           200            200            0.0031534382  -0.0018189075   0              0.011279222    8.976389e-13   0              8.668754e-08   1.1965779e-13  0              2.9950221    
   2300000   6645           200            200            0.0031534382  -0.0018189075   0              0.011279222    5.1182916e-14  0              4.9428797e-09  1.1965779e-13  0              2.9950221    
   2400000   6645           200            200            0.0031534381  -0.0018189075   0              0.011279222    4.3995566e-14  0              4.2487769e-09  1.1965779e-13  0              2.9950221    
   2500000   6645           200            200            0.0031534381  -0.0018189075   0              0.011279222    2.0394548e-15  0              1.9695594e-10  1.1965779e-13  0              2.9950221    
   2600000   6645           200            200            0.0031534381  -0.0018189075   0              0.011279222    1.3792029e-16  0              1.3319355e-11  1.1965779e-13  0              2.9950221    
   2700000   6645           200            200            0.0031534381  -0.0018189075   0              0.011279222    1.0712635e-16  0              1.0345496e-11  1.1965779e-13  0              2.9950221    
   2800000   6645           200            200            0.0031534381  -0.0018189075   0              0.011279222    9.7600131e-19  0              9.4255221e-14  1.1965779e-13  0              2.9950221    
   2900000   6645           200            200            0.0031534381  -0.0018189075   0              0.011279222    1.0536632e-18  0              1.0175525e-13  1.1965779e-13  0              2.9950221    
   3000000   6645           200            200            0.0031534381  -0.0018189075   0              0.011279222    6.2368373e-20  0              6.023091e-15   1.1965779e-13  0              2.9950221    
Loop time of 295.935 on 4 procs for 3000000 steps with 2501 atoms

Performance: 8758677.576 ns/day, 0.000 hours/ns, 10137.358 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 10.985     | 37.882     | 65.764     | 434.0 | 12.80
Neigh   | 4.0363     | 4.1101     | 4.1835     |   3.1 |  1.39
Comm    | 18.729     | 38.35      | 78.869     | 382.6 | 12.96
Output  | 0.27274    | 0.27307    | 0.27338    |   0.1 |  0.09
Modify  | 108.77     | 158.19     | 178.54     | 228.1 | 53.46
Other   |            | 57.13      |            |       | 19.30

Nlocal:         625.25 ave         876 max         375 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:           1.75 ave           3 max           1 min
Histogram: 2 0 0 0 0 1 0 0 0 1
Neighs:         338.75 ave         678 max           0 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 1355
Ave neighs/atom = 0.54178329
Neighbor list builds = 164
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 44

#variable lat0 equal 1                    #
variable lat1 equal 3+(100*0.01)+(v_ind*0.01)  # .491+(v_ind*0.001)       # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 500*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.44                                                               
Lattice spacing in x,y,z = 4.44 4.44 4.44

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -3330 ${n1e1} -100 100 -100 100 units box
region box block -3330 3330 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -3330 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -3330 3330 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-3330 -100 -100) to (3330 100 100)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 1499 atoms
  using lattice units in orthogonal box = (-3330 -100 -100) to (3330 100 100)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 1500 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 1001 atoms
  using lattice units in orthogonal box = (-3330 -100 -100) to (3330 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  1499 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  1499 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  1001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  1001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
1499 atoms in group substrate
group slider1 region slider1
1001 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 1001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_44_*.dump id type diameter mass xu yu zu fx fy fz

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 4297 130 130
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 87.95 | 87.95 | 87.96 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   6660           200            200            0              0              0              0              0              0              0              1.1965779e-13  0              6            
    100000   6660           200            200            0.0030462886   6.0645439e-36  0              0.0091388657   583145.82      0              5.6428907e+10  1.1965779e-13  0              3.3280491    
    200000   6660           200            200            0.0010649411   3.3381372e-40  0              0.0031948234   139158.14      0              1.3465829e+10  1.1965779e-13  0              3.0769358    
    300000   6660           200            200            5.1907187e-05  1.7194252e-39  0              0.00015572156  697.8265       0              67526141       1.1965779e-13  0              3.0453938    
    400000   6660           200            200            0.00013707362  1.3318742e-40  0              0.00041122086  4507.1084      0              4.3613654e+08  1.1965779e-13  0              3.0023707    
    500000   6660           200            200            0.00050895948 -3.1202898e-15  0              0.0015268784   5.2178233      0              504909.84      1.1965779e-13  0              2.998166     
    600000   6660           200            200            0.0051832091  -0.00068436534  0              0.016233993    8.8098782      0              852499.98      1.1965779e-13  0              2.9941831    
    700000   6660           200            200            0.0034988272  -0.00052566138  0              0.011022143    27.996347      0              2709105        1.1965779e-13  0              2.9951855    
    800000   6660           200            200            0.0033655914  -0.00052112765  0              0.010617902    0.093434505    0              9041.3183      1.1965779e-13  0              2.9952638    
    900000   6660           200            200            0.0035394022  -0.00052747109  0              0.011145678    0.41483114     0              40141.705      1.1965779e-13  0              2.9951531    
   1000000   6660           200            200            0.0035957431  -0.00052933836  0              0.011316568    0.033976339    0              3287.7672      1.1965779e-13  0              2.9951186    
   1100000   6660           200            200            0.0035845863  -0.00052895301  0              0.011282712    0.0021032086   0              203.51987      1.1965779e-13  0              2.9951258    
   1200000   6660           200            200            0.0035745209  -0.00052861709  0              0.01125218     0.0012291408   0              118.9395       1.1965779e-13  0              2.9951321    
   1300000   6660           200            200            0.0035737799  -0.00052859438  0              0.011249934    2.7036462e-06  0              0.26162204     1.1965779e-13  0              2.9951325    
   1400000   6660           200            200            0.0035749707  -0.00052863471  0              0.011253547    1.9001201e-05  0              1.8386773      1.1965779e-13  0              2.9951317    
   1500000   6660           200            200            0.0035753365  -0.00052864677  0              0.011254656    1.426805e-06   0              0.13806675     1.1965779e-13  0              2.9951315    
   1600000   6660           200            200            0.0035752576  -0.00052864403  0              0.011254417    1.0305556e-07  0              0.0099723129   1.1965779e-13  0              2.9951316    
   1700000   6660           200            200            0.0035751907  -0.00052864179  0              0.011254214    5.4130233e-08  0              0.0052379864   1.1965779e-13  0              2.9951316    
   1800000   6660           200            200            0.0035751864  -0.00052864166  0              0.011254201    7.4811643e-11  0              7.2392515e-06  1.1965779e-13  0              2.9951316    
   1900000   6660           200            200            0.0035751944  -0.00052864193  0              0.011254225    8.6622569e-10  0              8.382152e-05   1.1965779e-13  0              2.9951316    
   2000000   6660           200            200            0.0035751968  -0.00052864201  0              0.011254232    5.9826909e-11  0              5.7892331e-06  1.1965779e-13  0              2.9951316    
   2100000   6660           200            200            0.0035751962  -0.00052864199  0              0.011254231    5.0244354e-12  0              4.861964e-07   1.1965779e-13  0              2.9951316    
   2200000   6660           200            200            0.0035751958  -0.00052864198  0              0.011254229    2.3802966e-12  0              2.3033267e-07  1.1965779e-13  0              2.9951316    
   2300000   6660           200            200            0.0035751958  -0.00052864198  0              0.011254229    1.7891758e-15  0              1.7313206e-10  1.1965779e-13  0              2.9951316    
   2400000   6660           200            200            0.0035751958  -0.00052864198  0              0.011254229    3.929001e-14   0              3.8019518e-09  1.1965779e-13  0              2.9951316    
   2500000   6660           200            200            0.0035751958  -0.00052864198  0              0.01125423     2.4721518e-15  0              2.3922117e-10  1.1965779e-13  0              2.9951316    
   2600000   6660           200            200            0.0035751958  -0.00052864198  0              0.011254229    2.7468449e-16  0              2.6580223e-11  1.1965779e-13  0              2.9951316    
   2700000   6660           200            200            0.0035751958  -0.00052864198  0              0.011254229    1.0103053e-16  0              9.7763582e-12  1.1965779e-13  0              2.9951316    
   2800000   6660           200            200            0.0035751958  -0.00052864198  0              0.011254229    9.1976613e-19  0              8.9002434e-14  1.1965779e-13  0              2.9951316    
   2900000   6660           200            200            0.0035751958  -0.00052864198  0              0.011254229    7.8028383e-18  0              7.5505238e-13  1.1965779e-13  0              2.9951316    
   3000000   6660           200            200            0.0035751958  -0.00052864198  0              0.011254229    3.4788754e-18  0              3.3663816e-13  1.1965779e-13  0              2.9951316    
Loop time of 291.485 on 4 procs for 3000000 steps with 2500 atoms

Performance: 8892384.745 ns/day, 0.000 hours/ns, 10292.112 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 10.335     | 36.645     | 62.976     | 429.9 | 12.57
Neigh   | 4.0537     | 4.1269     | 4.2        |   3.1 |  1.42
Comm    | 25.228     | 51.372     | 77.085     | 350.2 | 17.62
Output  | 0.26902    | 0.26935    | 0.2697     |   0.1 |  0.09
Modify  | 108.38     | 142.96     | 177.41     | 281.4 | 49.04
Other   |            | 56.12      |            |       | 19.25

Nlocal:            625 ave         876 max         375 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:            1.5 ave           4 max           0 min
Histogram: 2 0 0 0 0 1 0 0 0 1
Neighs:         338.25 ave         677 max           0 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 1353
Ave neighs/atom = 0.5412
Neighbor list builds = 164
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 45

#variable lat0 equal 1                    #
variable lat1 equal 3+(100*0.01)+(v_ind*0.01)  # .491+(v_ind*0.001)       # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 500*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.45                                                               
Lattice spacing in x,y,z = 4.45 4.45 4.45

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -3337.5 ${n1e1} -100 100 -100 100 units box
region box block -3337.5 3337.5 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -3337.5 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -3337.5 3337.5 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-3337.5 -100 -100) to (3337.5 100 100)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 1500 atoms
  using lattice units in orthogonal box = (-3337.5 -100 -100) to (3337.5 100 100)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 1500 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 1001 atoms
  using lattice units in orthogonal box = (-3337.5 -100 -100) to (3337.5 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  1500 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  1500 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  1001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  1001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
1500 atoms in group substrate
group slider1 region slider1
1001 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 1001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_45_*.dump id type diameter mass xu yu zu fx fy fz

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 4307 130 130
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 88.09 | 88.09 | 88.1 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   6675           200            200            0              0              0              0              0              0              0              1.1965779e-13  0              6            
    100000   6675           200            200            0.0030403451  -1.2101635e-35  0              0.0091210353   583400.92      0              5.6340685e+10  1.1965779e-13  0              3.3278786    
    200000   6675           200            200            0.0010646916  -2.4203264e-35  0              0.0031940749   139596.75      0              1.3481255e+10  1.1965779e-13  0              3.0766019    
    300000   6675           200            200            5.4504317e-05 -2.4203522e-35  0              0.00016351295  770.11708      0              74372396       1.1965779e-13  0              3.0454492    
    400000   6675           200            200            0.00015093836 -2.4203477e-35  0              0.00045281507  5406.8144      0              5.2215143e+08  1.1965779e-13  0              3.0015291    
    500000   6675           200            200            0.00054987317 -3.7697978e-05  0              0.0016873175   92.019622      0              8886596.5      1.1965779e-13  0              2.998126     
    600000   6675           200            200            0.0023385713  -0.00029510447  0              0.0073108185   44.2296        0              4271378.2      1.1965779e-13  0              2.996053     
    700000   6675           200            200            0.0041523487  -0.00052640722  0              0.012983453    0.39940211     0              38571.397      1.1965779e-13  0              2.9947638    
    800000   6675           200            200            0.0033754532  -0.00047497577  0              0.010601335    0.0094405309   0              911.6989       1.1965779e-13  0              2.9952601    
    900000   6675           200            200            0.0036588877  -0.00048558645  0              0.01146225     0.00034724486  0              33.534424      1.1965779e-13  0              2.9950759    
   1000000   6675           200            200            0.0035538553  -0.00048198401  0              0.01114355     3.558755e-06   0              0.34367908     1.1965779e-13  0              2.9951433    
   1100000   6675           200            200            0.0035923218  -0.00048334477  0              0.01126031     1.1310369e-06  0              0.10922745     1.1965779e-13  0              2.9951185    
   1200000   6675           200            200            0.003578182   -0.00048285048  0              0.011217396    1.0608141e-06  0              0.10244583     1.1965779e-13  0              2.9951276    
   1300000   6675           200            200            0.0035833701  -0.00048303256  0              0.011233143    3.7590657e-07  0              0.036302366    1.1965779e-13  0              2.9951243    
   1400000   6675           200            200            0.0035814661  -0.00048296586  0              0.011227364    9.6856764e-08  0              0.009353733    1.1965779e-13  0              2.9951255    
   1500000   6675           200            200            0.0035821645  -0.00048299033  0              0.011229484    2.1275515e-08  0              0.0020546369   1.1965779e-13  0              2.9951251    
   1600000   6675           200            200            0.0035819084  -0.00048298136  0              0.011228706    4.2426719e-09  0              0.00040972689  1.1965779e-13  0              2.9951252    
   1700000   6675           200            200            0.0035820023  -0.00048298465  0              0.011228991    7.9302553e-10  0              7.658473e-05   1.1965779e-13  0              2.9951252    
   1800000   6675           200            200            0.0035819679  -0.00048298345  0              0.011228887    1.4148228e-10  0              1.3663346e-05  1.1965779e-13  0              2.9951252    
   1900000   6675           200            200            0.0035819805  -0.00048298389  0              0.011228925    2.4376626e-11  0              2.3541201e-06  1.1965779e-13  0              2.9951252    
   2000000   6675           200            200            0.0035819758  -0.00048298373  0              0.011228911    4.0881443e-12  0              3.9480371e-07  1.1965779e-13  0              2.9951252    
   2100000   6675           200            200            0.0035819775  -0.00048298379  0              0.011228916    6.7041362e-13  0              6.4743749e-08  1.1965779e-13  0              2.9951252    
   2200000   6675           200            200            0.0035819769  -0.00048298376  0              0.011228915    1.0812224e-13  0              1.0441672e-08  1.1965779e-13  0              2.9951252    
   2300000   6675           200            200            0.0035819771  -0.00048298377  0              0.011228915    1.7034607e-14  0              1.6450804e-09  1.1965779e-13  0              2.9951252    
   2400000   6675           200            200            0.0035819771  -0.00048298377  0              0.011228915    2.6614043e-15  0              2.5701938e-10  1.1965779e-13  0              2.9951252    
   2500000   6675           200            200            0.0035819771  -0.00048298377  0              0.011228915    3.8431419e-16  0              3.7114313e-11  1.1965779e-13  0              2.9951252    
   2600000   6675           200            200            0.0035819771  -0.00048298377  0              0.011228915    7.774894e-17   0              7.5084361e-12  1.1965779e-13  0              2.9951252    
   2700000   6675           200            200            0.0035819771  -0.00048298377  0              0.011228915    1.0205366e-17  0              9.855612e-13   1.1965779e-13  0              2.9951252    
   2800000   6675           200            200            0.0035819771  -0.00048298377  0              0.011228915    3.8487672e-20  0              3.7168639e-15  1.1965779e-13  0              2.9951252    
   2900000   6675           200            200            0.0035819771  -0.00048298377  0              0.011228915    7.6869734e-19  0              7.4235287e-14  1.1965779e-13  0              2.9951252    
   3000000   6675           200            200            0.0035819771  -0.00048298377  0              0.011228915    1.048346e-18   0              1.0124175e-13  1.1965779e-13  0              2.9951252    
Loop time of 294.214 on 4 procs for 3000000 steps with 2501 atoms

Performance: 8809922.996 ns/day, 0.000 hours/ns, 10196.670 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 11.188     | 37.566     | 64.934     | 429.3 | 12.77
Neigh   | 4.0665     | 4.1423     | 4.2179     |   3.2 |  1.41
Comm    | 18.511     | 38.17      | 78.165     | 379.0 | 12.97
Output  | 0.27224    | 0.27255    | 0.27287    |   0.1 |  0.09
Modify  | 109.01     | 157.71     | 176.99     | 225.0 | 53.60
Other   |            | 56.36      |            |       | 19.15

Nlocal:         625.25 ave         876 max         375 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:           1.75 ave           3 max           1 min
Histogram: 2 0 0 0 0 1 0 0 0 1
Neighs:         337.25 ave         675 max           0 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 1349
Ave neighs/atom = 0.53938425
Neighbor list builds = 164
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 46

#variable lat0 equal 1                    #
variable lat1 equal 3+(100*0.01)+(v_ind*0.01)  # .491+(v_ind*0.001)       # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 500*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.46                                                               
Lattice spacing in x,y,z = 4.46 4.46 4.46

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -3345 ${n1e1} -100 100 -100 100 units box
region box block -3345 3345 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -3345 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -3345 3345 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-3345 -100 -100) to (3345 100 100)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 1500 atoms
  using lattice units in orthogonal box = (-3345 -100 -100) to (3345 100 100)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 1500 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 1001 atoms
  using lattice units in orthogonal box = (-3345 -100 -100) to (3345 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  1500 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  1500 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  1001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  1001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
1500 atoms in group substrate
group slider1 region slider1
1001 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 1001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_46_*.dump id type diameter mass xu yu zu fx fy fz

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 4317 130 130
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 88.29 | 88.3 | 88.31 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   6690           200            200            0              0              0              0              0              0              0              1.1965779e-13  0              6            
    100000   6690           200            200            0.0030321311  -1.2074564e-35  0              0.0090963934   583007.97      0              5.6302737e+10  1.1965779e-13  0              3.3281191    
    200000   6690           200            200            0.0010590393   2.0886307e-40  0              0.003177118    138929.45      0              1.3416812e+10  1.1965779e-13  0              3.0770654    
    300000   6690           200            200            4.9103665e-05 -6.0373031e-36  0              0.000147311    632.28362      0              61061426       1.1965779e-13  0              3.0453361    
    400000   6690           200            200            0.00013617118  2.6558487e-40  0              0.00040851353  4489.7584      0              4.3358873e+08  1.1965779e-13  0              3.0022956    
    500000   6690           200            200            0.00084108817  0.00067049333  0              0.0018527712   150.16614      0              14501971       1.1965779e-13  0              2.99791      
    600000   6690           200            200            0.0051268424   0.0046342465   0              0.010746281    205.93457      0              19887687       1.1965779e-13  0              2.9950716    
    700000   6690           200            200            0.005023903    0.0043797722   0              0.010691937    25.282157      0              2441569.8      1.1965779e-13  0              2.9950955    
    800000   6690           200            200            0.005047586    0.0043452942   0              0.010797464    2.1042202      0              203210.52      1.1965779e-13  0              2.9950761    
    900000   6690           200            200            0.0051195003   0.0043638924   0              0.010994608    0.069953729    0              6755.6304      1.1965779e-13  0              2.9950332    
   1000000   6690           200            200            0.0051653193   0.0043747117   0              0.011121246    0.00059861133  0              57.809597      1.1965779e-13  0              2.9950052    
   1100000   6690           200            200            0.0051858121   0.0043795262   0              0.01117791     0.0026803758   0              258.85151      1.1965779e-13  0              2.9949926    
   1200000   6690           200            200            0.0051929997   0.0043812183   0              0.011197781    0.00092792726  0              89.612573      1.1965779e-13  0              2.9949881    
   1300000   6690           200            200            0.0051949211   0.0043816749   0              0.011203088    0.00016582264  0              16.013963      1.1965779e-13  0              2.9949869    
   1400000   6690           200            200            0.0051952042   0.0043817449   0              0.011203868    1.8380776e-05  0              1.7750838      1.1965779e-13  0              2.9949867    
   1500000   6690           200            200            0.0051951298   0.0043817289   0              0.01120366     1.1206521e-06  0              0.10822456     1.1965779e-13  0              2.9949868    
   1600000   6690           200            200            0.0051950431   0.0043817091   0              0.01120342     1.255316e-08   0              0.0012122943   1.1965779e-13  0              2.9949868    
   1700000   6690           200            200            0.0051949966   0.0043816983   0              0.011203291    4.8579703e-09  0              0.000469148    1.1965779e-13  0              2.9949868    
   1800000   6690           200            200            0.0051949779   0.004381694    0              0.01120324     3.6658404e-09  0              0.00035402063  1.1965779e-13  0              2.9949869    
   1900000   6690           200            200            0.0051949721   0.0043816926   0              0.011203224    9.0439849e-10  0              8.7340333e-05  1.1965779e-13  0              2.9949869    
   2000000   6690           200            200            0.0051949708   0.0043816923   0              0.01120322     1.3090541e-10  0              1.2641907e-05  1.1965779e-13  0              2.9949869    
   2100000   6690           200            200            0.0051949707   0.0043816923   0              0.01120322     1.1587924e-11  0              1.1190788e-06  1.1965779e-13  0              2.9949869    
   2200000   6690           200            200            0.0051949708   0.0043816923   0              0.01120322     4.5755532e-13  0              4.4187418e-08  1.1965779e-13  0              2.9949869    
   2300000   6690           200            200            0.0051949709   0.0043816923   0              0.01120322     3.1825882e-16  0              3.0735159e-11  1.1965779e-13  0              2.9949869    
   2400000   6690           200            200            0.005194971    0.0043816923   0              0.011203221    1.062498e-14   0              1.0260845e-09  1.1965779e-13  0              2.9949869    
   2500000   6690           200            200            0.005194971    0.0043816923   0              0.011203221    4.2054442e-15  0              4.061317e-10   1.1965779e-13  0              2.9949869    
   2600000   6690           200            200            0.005194971    0.0043816923   0              0.011203221    7.954129e-16   0              7.6815285e-11  1.1965779e-13  0              2.9949869    
   2700000   6690           200            200            0.005194971    0.0043816923   0              0.011203221    9.1695459e-17  0              8.8552911e-12  1.1965779e-13  0              2.9949869    
   2800000   6690           200            200            0.005194971    0.0043816923   0              0.011203221    2.2905421e-18  0              2.2120416e-13  1.1965779e-13  0              2.9949869    
   2900000   6690           200            200            0.005194971    0.0043816923   0              0.011203221    2.2789203e-19  0              2.2008181e-14  1.1965779e-13  0              2.9949869    
   3000000   6690           200            200            0.005194971    0.0043816923   0              0.011203221    1.3172988e-18  0              1.2721529e-13  1.1965779e-13  0              2.9949869    
Loop time of 293.339 on 4 procs for 3000000 steps with 2501 atoms

Performance: 8836180.728 ns/day, 0.000 hours/ns, 10227.061 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 11.001     | 37.358     | 64.298     | 428.6 | 12.74
Neigh   | 4.0835     | 4.156      | 4.2297     |   3.1 |  1.42
Comm    | 18.606     | 37.911     | 77.577     | 376.9 | 12.92
Output  | 0.2816     | 0.28191    | 0.28226    |   0.1 |  0.10
Modify  | 109.03     | 157.47     | 176.78     | 224.1 | 53.68
Other   |            | 56.16      |            |       | 19.14

Nlocal:         625.25 ave         876 max         375 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:           1.75 ave           3 max           1 min
Histogram: 2 0 0 0 0 1 0 0 0 1
Neighs:         338.25 ave         677 max           0 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 1353
Ave neighs/atom = 0.54098361
Neighbor list builds = 164
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 47

#variable lat0 equal 1                    #
variable lat1 equal 3+(100*0.01)+(v_ind*0.01)  # .491+(v_ind*0.001)       # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 500*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.47                                                               
Lattice spacing in x,y,z = 4.47 4.47 4.47

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -3352.5 ${n1e1} -100 100 -100 100 units box
region box block -3352.5 3352.5 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -3352.5 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -3352.5 3352.5 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-3352.5 -100 -100) to (3352.5 100 100)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 1500 atoms
  using lattice units in orthogonal box = (-3352.5 -100 -100) to (3352.5 100 100)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 1500 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 1001 atoms
  using lattice units in orthogonal box = (-3352.5 -100 -100) to (3352.5 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  1500 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  1500 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  1001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  1001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
1500 atoms in group substrate
group slider1 region slider1
1001 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 1001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_47_*.dump id type diameter mass xu yu zu fx fy fz

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 4326 130 130
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 88.37 | 88.4 | 88.43 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   6705           200            200            0              0              0              0              0              0              0              1.1965779e-13  0              6            
    100000   6705           200            200            0.0030241959   2.3496727e-42  0              0.0090725876   582672.08      0              5.6270299e+10  1.1965779e-13  0              3.3284086    
    200000   6705           200            200            0.0010536596   9.6381242e-35  0              0.0031609787   138306.94      0              1.3356695e+10  1.1965779e-13  0              3.0776394    
    300000   6705           200            200            4.431449e-05  -2.2589304e-36  0              0.00013294347  520.52436      0              50268517       1.1965779e-13  0              3.0453489    
    400000   6705           200            200            0.00012481753  5.607378e-40   0              0.00037445258  3835.6551      0              3.7042011e+08  1.1965779e-13  0              3.0029224    
    500000   6705           200            200            0.00096186746 -0.00018307077  0              0.0030686731   601.91242      0              58128393       1.1965779e-13  0              2.9973072    
    600000   6705           200            200            0.0045622376  -0.0010816571   0              0.01476837     86.351863      0              8339244.8      1.1965779e-13  0              2.9942082    
    700000   6705           200            200            0.003998937   -0.00085436135  0              0.012851172    0.0046264572   0              446.79012      1.1965779e-13  0              2.9946063    
    800000   6705           200            200            0.003607568   -0.00081588861  0              0.011638593    1.5942862      0              153964.75      1.1965779e-13  0              2.9948744    
    900000   6705           200            200            0.0034706678  -0.0008091467   0              0.01122115     0.48214143     0              46561.769      1.1965779e-13  0              2.9949679    
   1000000   6705           200            200            0.003444525   -0.00080780727  0              0.011141382    0.053062761    0              5124.4216      1.1965779e-13  0              2.9949855    
   1100000   6705           200            200            0.0034476957  -0.00080799632  0              0.011151084    0.0015544949   0              150.12199      1.1965779e-13  0              2.994983     
   1200000   6705           200            200            0.0034530569  -0.00080828691  0              0.011167458    6.8987019e-05  0              6.6622725      1.1965779e-13  0              2.9949792    
   1300000   6705           200            200            0.0034557272  -0.00080842895  0              0.011175611    0.00010228547  0              9.8779988      1.1965779e-13  0              2.9949774    
   1400000   6705           200            200            0.0034565458  -0.00080847183  0              0.011178109    2.2266007e-05  0              2.1502916      1.1965779e-13  0              2.9949768    
   1500000   6705           200            200            0.0034566583  -0.00080847746  0              0.011178452    1.8504159e-06  0              0.17869992     1.1965779e-13  0              2.9949767    
   1600000   6705           200            200            0.0034566128  -0.00080847493  0              0.011178313    2.2201689e-08  0              0.0021440802   1.1965779e-13  0              2.9949768    
   1700000   6705           200            200            0.0034565714  -0.0008084727   0              0.011178187    9.4896344e-09  0              0.00091644097  1.1965779e-13  0              2.9949768    
   1800000   6705           200            200            0.0034565536  -0.00080847176  0              0.011178133    5.8264576e-09  0              0.00056267757  1.1965779e-13  0              2.9949768    
   1900000   6705           200            200            0.0034565489  -0.00080847152  0              0.011178118    9.5670122e-10  0              9.2391357e-05  1.1965779e-13  0              2.9949768    
   2000000   6705           200            200            0.0034565486  -0.00080847151  0              0.011178117    5.7202418e-11  0              5.5242001e-06  1.1965779e-13  0              2.9949768    
   2100000   6705           200            200            0.0034565491  -0.00080847153  0              0.011178119    3.8203345e-14  0              3.6894056e-09  1.1965779e-13  0              2.9949768    
   2200000   6705           200            200            0.0034565494  -0.00080847155  0              0.01117812     8.2284557e-13  0              7.9464536e-08  1.1965779e-13  0              2.9949768    
   2300000   6705           200            200            0.0034565495  -0.00080847155  0              0.01117812     3.0234543e-13  0              2.9198358e-08  1.1965779e-13  0              2.9949768    
   2400000   6705           200            200            0.0034565495  -0.00080847155  0              0.01117812     3.8172465e-14  0              3.6864235e-09  1.1965779e-13  0              2.9949768    
   2500000   6705           200            200            0.0034565495  -0.00080847155  0              0.01117812     1.513337e-15   0              1.4614725e-10  1.1965779e-13  0              2.9949768    
   2600000   6705           200            200            0.0034565495  -0.00080847155  0              0.01117812     2.6253363e-17  0              2.5353619e-12  1.1965779e-13  0              2.9949768    
   2700000   6705           200            200            0.0034565495  -0.00080847155  0              0.01117812     4.9492882e-17  0              4.7796683e-12  1.1965779e-13  0              2.9949768    
   2800000   6705           200            200            0.0034565495  -0.00080847155  0              0.01117812     1.2658945e-17  0              1.2225103e-12  1.1965779e-13  0              2.9949768    
   2900000   6705           200            200            0.0034565495  -0.00080847155  0              0.01117812     4.8328588e-18  0              4.6672291e-13  1.1965779e-13  0              2.9949768    
   3000000   6705           200            200            0.0034565495  -0.00080847155  0              0.01117812     7.0572187e-18  0              6.8153567e-13  1.1965779e-13  0              2.9949768    
Loop time of 295.873 on 4 procs for 3000000 steps with 2501 atoms

Performance: 8760515.710 ns/day, 0.000 hours/ns, 10139.486 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 11.186     | 37.622     | 65.021     | 430.2 | 12.72
Neigh   | 4.1014     | 4.1787     | 4.2565     |   3.3 |  1.41
Comm    | 18.819     | 38.172     | 78.183     | 378.6 | 12.90
Output  | 0.27316    | 0.27347    | 0.27383    |   0.1 |  0.09
Modify  | 109.57     | 158.58     | 178.98     | 226.2 | 53.60
Other   |            | 57.04      |            |       | 19.28

Nlocal:         625.25 ave         876 max         375 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:           1.75 ave           3 max           1 min
Histogram: 2 0 0 0 0 1 0 0 0 1
Neighs:         339.25 ave         679 max           0 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 1357
Ave neighs/atom = 0.54258297
Neighbor list builds = 164
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 48

#variable lat0 equal 1                    #
variable lat1 equal 3+(100*0.01)+(v_ind*0.01)  # .491+(v_ind*0.001)       # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 500*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.48                                                               
Lattice spacing in x,y,z = 4.48 4.48 4.48

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -3360 ${n1e1} -100 100 -100 100 units box
region box block -3360 3360 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -3360 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -3360 3360 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-3360 -100 -100) to (3360 100 100)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 1499 atoms
  using lattice units in orthogonal box = (-3360 -100 -100) to (3360 100 100)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 1500 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 1001 atoms
  using lattice units in orthogonal box = (-3360 -100 -100) to (3360 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  1499 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  1499 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  1001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  1001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
1499 atoms in group substrate
group slider1 region slider1
1001 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 1001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_48_*.dump id type diameter mass xu yu zu fx fy fz

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 4336 130 130
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 88.57 | 88.58 | 88.58 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   6720           200            200            0              0              0              0              0              0              0              1.1965779e-13  0              6            
    100000   6720           200            200            0.003019066    1.6453173e-39  0              0.0090571979   583137.25      0              5.6428078e+10  1.1965779e-13  0              3.3280686    
    200000   6720           200            200            0.0010552622   4.8083697e-35  0              0.0031657866   139121.97      0              1.3462329e+10  1.1965779e-13  0              3.0769856    
    300000   6720           200            200            5.0462337e-05 -1.4424811e-34  0              0.00015138701  672.31608      0              65057590       1.1965779e-13  0              3.0454193    
    400000   6720           200            200            0.00014088748  5.4035189e-41  0              0.00042266243  4821.1366      0              4.6652391e+08  1.1965779e-13  0              3.0020513    
    500000   6720           200            200            0.00047991083 -0.00011585414  0              0.0015555866   11.922619      0              1153708.7      1.1965779e-13  0              2.9981576    
    600000   6720           200            200            0.0022854369  -0.00089058878  0              0.0077468994   81.623581      0              7898418.1      1.1965779e-13  0              2.9958746    
    700000   6720           200            200            0.0030046108  -0.0010953976   0              0.01010923     17.004793      0              1645492.1      1.1965779e-13  0              2.995304     
    800000   6720           200            200            0.003520549   -0.0012170772   0              0.011778724    0.040215822    0              3891.5393      1.1965779e-13  0              2.9949328    
    900000   6720           200            200            0.0032826712  -0.0011898933   0              0.011037907    0.38200254     0              36965.001      1.1965779e-13  0              2.9950909    
   1000000   6720           200            200            0.0033091971  -0.0011921848   0              0.011119776    0.057060251    0              5521.5137      1.1965779e-13  0              2.9950741    
   1100000   6720           200            200            0.0033298399  -0.0011940755   0              0.011183595    0.00039817889  0              38.530327      1.1965779e-13  0              2.9950599    
   1200000   6720           200            200            0.0033173511  -0.0011929648   0              0.011145018    0.00055601628  0              53.80368       1.1965779e-13  0              2.9950683    
   1300000   6720           200            200            0.0033199758  -0.0011931936   0              0.011153121    0.00016642301  0              16.104151      1.1965779e-13  0              2.9950666    
   1400000   6720           200            200            0.0033205223  -0.001193245    0              0.011154812    5.7912499e-06  0              0.56039826     1.1965779e-13  0              2.9950662    
   1500000   6720           200            200            0.0033199318  -0.0011931919   0              0.011152987    4.862213e-07   0              0.047049872    1.1965779e-13  0              2.9950666    
   1600000   6720           200            200            0.0033201138  -0.001193208    0              0.011153549    3.9235749e-07  0              0.037967012    1.1965779e-13  0              2.9950665    
   1700000   6720           200            200            0.0033201146  -0.0011932082   0              0.011153552    3.140496e-08   0              0.0030389441   1.1965779e-13  0              2.9950665    
   1800000   6720           200            200            0.0033200898  -0.0011932059   0              0.011153475    5.9550289e-11  0              5.7624656e-06  1.1965779e-13  0              2.9950665    
   1900000   6720           200            200            0.0033201004  -0.0011932069   0              0.011153508    7.4170793e-10  0              7.1772388e-05  1.1965779e-13  0              2.9950665    
   2000000   6720           200            200            0.0033200992  -0.0011932068   0              0.011153504    1.1561205e-10  0              1.1187359e-05  1.1965779e-13  0              2.9950665    
   2100000   6720           200            200            0.0033200983  -0.0011932067   0              0.011153501    9.6748881e-13  0              9.3620385e-08  1.1965779e-13  0              2.9950665    
   2200000   6720           200            200            0.0033200988  -0.0011932067   0              0.011153503    1.0471348e-12  0              1.0132744e-07  1.1965779e-13  0              2.9950665    
   2300000   6720           200            200            0.0033200987  -0.0011932067   0              0.011153503    3.3161592e-13  0              3.2089271e-08  1.1965779e-13  0              2.9950665    
   2400000   6720           200            200            0.0033200987  -0.0011932067   0              0.011153503    1.2376653e-14  0              1.1976439e-09  1.1965779e-13  0              2.9950665    
   2500000   6720           200            200            0.0033200987  -0.0011932067   0              0.011153503    8.2760465e-16  0              8.0084302e-11  1.1965779e-13  0              2.9950665    
   2600000   6720           200            200            0.0033200987  -0.0011932067   0              0.011153503    7.8273031e-16  0              7.5741975e-11  1.1965779e-13  0              2.9950665    
   2700000   6720           200            200            0.0033200987  -0.0011932067   0              0.011153503    6.3242388e-17  0              6.1197366e-12  1.1965779e-13  0              2.9950665    
   2800000   6720           200            200            0.0033200987  -0.0011932067   0              0.011153503    1.8842731e-19  0              1.8233428e-14  1.1965779e-13  0              2.9950665    
   2900000   6720           200            200            0.0033200987  -0.0011932067   0              0.011153503    1.5042254e-18  0              1.4555844e-13  1.1965779e-13  0              2.9950665    
   3000000   6720           200            200            0.0033200987  -0.0011932067   0              0.011153503    1.2727228e-18  0              1.2315677e-13  1.1965779e-13  0              2.9950665    
Loop time of 295.148 on 4 procs for 3000000 steps with 2500 atoms

Performance: 8782022.207 ns/day, 0.000 hours/ns, 10164.378 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 10.698     | 37.075     | 63.765     | 429.4 | 12.56
Neigh   | 4.116      | 4.1913     | 4.2667     |   3.2 |  1.42
Comm    | 27.54      | 53.361     | 80.415     | 343.5 | 18.08
Output  | 0.2725     | 0.27281    | 0.27314    |   0.1 |  0.09
Modify  | 108.56     | 143.81     | 178.22     | 279.2 | 48.72
Other   |            | 56.44      |            |       | 19.12

Nlocal:            625 ave         875 max         375 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:            1.5 ave           3 max           0 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Neighs:         336.75 ave         674 max           0 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 1347
Ave neighs/atom = 0.5388
Neighbor list builds = 164
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 49

#variable lat0 equal 1                    #
variable lat1 equal 3+(100*0.01)+(v_ind*0.01)  # .491+(v_ind*0.001)       # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 500*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.49                                                               
Lattice spacing in x,y,z = 4.49 4.49 4.49

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -3367.5 ${n1e1} -100 100 -100 100 units box
region box block -3367.5 3367.5 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -3367.5 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -3367.5 3367.5 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-3367.5 -100 -100) to (3367.5 100 100)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 1500 atoms
  using lattice units in orthogonal box = (-3367.5 -100 -100) to (3367.5 100 100)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 1500 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 1001 atoms
  using lattice units in orthogonal box = (-3367.5 -100 -100) to (3367.5 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  1500 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  1500 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  1001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  1001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
1500 atoms in group substrate
group slider1 region slider1
1001 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 1001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_49_*.dump id type diameter mass xu yu zu fx fy fz

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 4346 130 130
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 88.72 | 88.75 | 88.78 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   6735           200            200            0              0              0              0              0              0              0              1.1965779e-13  0              6            
    100000   6735           200            200            0.0030161746   2.3987939e-35  0              0.0090485237   584225.34      0              5.6420302e+10  1.1965779e-13  0              3.3273831    
    200000   6735           200            200            0.00106273    -1.199396e-35   0              0.0031881901   141152.92      0              1.3631539e+10  1.1965779e-13  0              3.0754247    
    300000   6735           200            200            6.6948645e-05  3.6719813e-40  0              0.00020084594  1163.3571      0              1.123487e+08   1.1965779e-13  0              3.0455313    
    400000   6735           200            200            0.00029549062 -2.8127717e-06  0              0.00088928463  7949.2272      0              7.6767947e+08  1.1965779e-13  0              2.9991893    
    500000   6735           200            200            0.0033389776  -0.0017941611   0              0.011811094    1585.1892      0              1.5308623e+08  1.1965779e-13  0              2.9952287    
    600000   6735           200            200            0.0036533939  -0.0030033772   0              0.013963559    142.69904      0              13780852       1.1965779e-13  0              2.9947471    
    700000   6735           200            200            0.003027139   -0.0021923131   0              0.01127373     28.562361      0              2758348.4      1.1965779e-13  0              2.995298     
    800000   6735           200            200            0.0027875186  -0.002198502    0              0.010561058    0.77541448     0              74883.98       1.1965779e-13  0              2.9954418    
    900000   6735           200            200            0.0030270983  -0.0022474521   0              0.011328747    0.14194019     0              13707.568      1.1965779e-13  0              2.9952798    
   1000000   6735           200            200            0.002964316   -0.0022375725   0              0.01113052     0.069980273    0              6758.1939      1.1965779e-13  0              2.995322     
   1100000   6735           200            200            0.0029553954  -0.0022362329   0              0.011102419    0.0025039258   0              241.81123      1.1965779e-13  0              2.9953276    
   1200000   6735           200            200            0.002967233   -0.0022381239   0              0.011139823    0.00027631719  0              26.684737      1.1965779e-13  0              2.9953197    
   1300000   6735           200            200            0.0029639352  -0.0022375878   0              0.011129393    0.0001708285   0              16.497394      1.1965779e-13  0              2.995322     
   1400000   6735           200            200            0.0029635931  -0.0022375378   0              0.011128317    7.4570306e-06  0              0.72014664     1.1965779e-13  0              2.9953222    
   1500000   6735           200            200            0.0029641678  -0.0022376292   0              0.011130132    5.2311364e-07  0              0.050518571    1.1965779e-13  0              2.9953218    
   1600000   6735           200            200            0.0029639953  -0.0022376012   0              0.011129587    4.1374485e-07  0              0.039956517    1.1965779e-13  0              2.9953219    
   1700000   6735           200            200            0.0029639834  -0.0022375996   0              0.01112955     2.1655835e-08  0              0.0020913656   1.1965779e-13  0              2.9953219    
   1800000   6735           200            200            0.0029640112  -0.002237604    0              0.011129638    9.4483332e-10  0              9.1245239e-05  1.1965779e-13  0              2.9953219    
   1900000   6735           200            200            0.0029640022  -0.0022376025   0              0.011129609    9.9410883e-10  0              9.6003915e-05  1.1965779e-13  0              2.9953219    
   2000000   6735           200            200            0.0029640019  -0.0022376025   0              0.011129608    6.1607837e-11  0              5.9496439e-06  1.1965779e-13  0              2.9953219    
   2100000   6735           200            200            0.0029640032  -0.0022376027   0              0.011129612    1.5989723e-12  0              1.544173e-07   1.1965779e-13  0              2.9953219    
   2200000   6735           200            200            0.0029640028  -0.0022376026   0              0.011129611    2.3692316e-12  0              2.2880343e-07  1.1965779e-13  0              2.9953219    
   2300000   6735           200            200            0.0029640028  -0.0022376026   0              0.011129611    1.719616e-13   0              1.6606821e-08  1.1965779e-13  0              2.9953219    
   2400000   6735           200            200            0.0029640028  -0.0022376026   0              0.011129611    2.505474e-15   0              2.4196074e-10  1.1965779e-13  0              2.9953219    
   2500000   6735           200            200            0.0029640028  -0.0022376026   0              0.011129611    5.6221489e-15  0              5.429469e-10   1.1965779e-13  0              2.9953219    
   2600000   6735           200            200            0.0029640028  -0.0022376026   0              0.011129611    4.9455246e-16  0              4.7760336e-11  1.1965779e-13  0              2.9953219    
   2700000   6735           200            200            0.0029640028  -0.0022376026   0              0.011129611    1.8824583e-18  0              1.8179435e-13  1.1965779e-13  0              2.9953219    
   2800000   6735           200            200            0.0029640028  -0.0022376026   0              0.011129611    1.3736121e-17  0              1.3265363e-12  1.1965779e-13  0              2.9953219    
   2900000   6735           200            200            0.0029640028  -0.0022376026   0              0.011129611    4.8098929e-19  0              4.6450503e-14  1.1965779e-13  0              2.9953219    
   3000000   6735           200            200            0.0029640028  -0.0022376026   0              0.011129611    1.2044635e-18  0              1.1631846e-13  1.1965779e-13  0              2.9953219    
Loop time of 294.923 on 4 procs for 3000000 steps with 2501 atoms

Performance: 8788749.052 ns/day, 0.000 hours/ns, 10172.163 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 10.842     | 37.385     | 64.728     | 431.6 | 12.68
Neigh   | 4.1138     | 4.1875     | 4.2614     |   3.1 |  1.42
Comm    | 18.851     | 38.292     | 78.291     | 378.1 | 12.98
Output  | 0.27177    | 0.27207    | 0.27239    |   0.1 |  0.09
Modify  | 109.77     | 158.44     | 178.04     | 224.3 | 53.72
Other   |            | 56.35      |            |       | 19.11

Nlocal:         625.25 ave         876 max         375 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:           1.75 ave           3 max           1 min
Histogram: 2 0 0 0 0 1 0 0 0 1
Neighs:         337.25 ave         675 max           0 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 1349
Ave neighs/atom = 0.53938425
Neighbor list builds = 164
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 50

#variable lat0 equal 1                    #
variable lat1 equal 3+(100*0.01)+(v_ind*0.01)  # .491+(v_ind*0.001)       # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 500*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.5                                                               
Lattice spacing in x,y,z = 4.5 4.5 4.5

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -3375 ${n1e1} -100 100 -100 100 units box
region box block -3375 3375 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -3375 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -3375 3375 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-3375 -100 -100) to (3375 100 100)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 1500 atoms
  using lattice units in orthogonal box = (-3375 -100 -100) to (3375 100 100)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 1500 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 1001 atoms
  using lattice units in orthogonal box = (-3375 -100 -100) to (3375 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  1500 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  1500 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  1001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  1001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
1500 atoms in group substrate
group slider1 region slider1
1001 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 1001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_50_*.dump id type diameter mass xu yu zu fx fy fz

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 4355 130 130
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 88.92 | 88.93 | 88.93 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   6750           200            200            0              0              0              0              0              0              0              1.1965779e-13  0              6            
    100000   6750           200            200            0.0030453453   7.1803907e-35  0              0.009136036    594300.25      0              5.7393264e+10  1.1965779e-13  0              3.3222103    
    200000   6750           200            200            0.0011416155   1.1967333e-34  0              0.0034248465   158204.69      0              1.5278277e+10  1.1965779e-13  0              3.0646849    
    300000   6750           200            200            0.00021747684  4.786958e-35   0              0.00065243053  10455.258      0              1.009694e+09   1.1965779e-13  0              3.0433987    
    400000   6750           200            200           -1.5483548e-06  2.3934991e-35  0             -4.6450643e-06  0.63237485     0              61070.237      1.1965779e-13  0              3.011405     
    500000   6750           200            200           -1.2197525e-05 -2.3934342e-35  0             -3.6592575e-05  43.742137      0              4224302.5      1.1965779e-13  0              3.0015524    
    600000   6750           200            200            0.0011637477  -9.573838e-35   0              0.0034912432   100.47657      0              9703308        1.1965779e-13  0              2.9993888    
    700000   6750           200            200            0.0035372487   1.0370021e-40  0              0.010611746    46.91248       0              4530471.6      1.1965779e-13  0              2.9987337    
    800000   6750           200            200            0.0036947332   8.2426875e-41  0              0.0110842      6.4171333      0              619720.8       1.1965779e-13  0              2.9986921    
    900000   6750           200            200            0.0037490626  -1.0770573e-34  0              0.011247188    0.80272468     0              77521.404      1.1965779e-13  0              2.9986808    
   1000000   6750           200            200            0.0036742972   4.777964e-41   0              0.011022892    0.084075936    0              8119.4522      1.1965779e-13  0              2.9986979    
   1100000   6750           200            200            0.0037220614   1.4679597e-41  0              0.011166184    0.0070843415   0              684.15499      1.1965779e-13  0              2.9986868    
   1200000   6750           200            200            0.0036985607   4.4877462e-36  0              0.011095682    0.00041033651  0              39.627364      1.1965779e-13  0              2.9986923    
   1300000   6750           200            200            0.0037086928   1.4959163e-36  0              0.011126078    8.8559786e-06  0              0.85524702     1.1965779e-13  0              2.99869      
   1400000   6750           200            200            0.0037047167   5.2357005e-36  0              0.01111415     3.8661575e-07  0              0.037336582    1.1965779e-13  0              2.9986909    
   1500000   6750           200            200            0.0037061545   1.2467483e-42  0              0.011118464    6.9829061e-07  0              0.067435909    1.1965779e-13  0              2.9986905    
   1600000   6750           200            200            0.0037056762   2.9918293e-36  0              0.011117029    2.5416223e-07  0              0.024545169    1.1965779e-13  0              2.9986907    
   1700000   6750           200            200            0.0037058199   7.4795825e-37  0              0.01111746     5.8799927e-08  0              0.0056784761   1.1965779e-13  0              2.9986906    
   1800000   6750           200            200            0.0037057829  -7.4795577e-37  0              0.011117349    1.0597085e-08  0              0.0010233906   1.1965779e-13  0              2.9986906    
   1900000   6750           200            200            0.0037057897   1.4959152e-36  0              0.011117369    1.5912154e-09  0              0.00015366819  1.1965779e-13  0              2.9986906    
   2000000   6750           200            200            0.0037057899  -7.4795578e-37  0              0.01111737     2.0316693e-10  0              1.9620408e-05  1.1965779e-13  0              2.9986906    
   2100000   6750           200            200            0.0037057888  -1.4959128e-36  0              0.011117366    2.1880308e-11  0              2.1130435e-06  1.1965779e-13  0              2.9986906    
   2200000   6750           200            200            0.0037057895   1.2084857e-42  0              0.011117369    1.9026509e-12  0              1.837444e-07   1.1965779e-13  0              2.9986906    
   2300000   6750           200            200            0.0037057892   3.7397972e-37  0              0.011117368    1.1776302e-13  0              1.137271e-08   1.1965779e-13  0              2.9986906    
   2400000   6750           200            200            0.0037057893  -3.7397728e-37  0              0.011117368    3.1631206e-15  0              3.0547155e-10  1.1965779e-13  0              2.9986906    
   2500000   6750           200            200            0.0037057893   1.2209434e-42  0              0.011117368    4.5483649e-17  0              4.3924852e-12  1.1965779e-13  0              2.9986906    
   2600000   6750           200            200            0.0037057893   3.7397972e-37  0              0.011117368    1.462383e-16   0              1.4122648e-11  1.1965779e-13  0              2.9986906    
   2700000   6750           200            200            0.0037057893  -3.7397729e-37  0              0.011117368    3.2372928e-17  0              3.1263457e-12  1.1965779e-13  0              2.9986906    
   2800000   6750           200            200            0.0037057893   9.7234423e-36  0              0.011117368    9.7049165e-18  0              9.3723137e-13  1.1965779e-13  0              2.9986906    
   2900000   6750           200            200            0.0037057893  -1.1219343e-36  0              0.011117368    9.1715635e-19  0              8.8572395e-14  1.1965779e-13  0              2.9986906    
   3000000   6750           200            200            0.0037057893  -5.9836549e-36  0              0.011117368    6.5556811e-19  0              6.3310076e-14  1.1965779e-13  0              2.9986906    
Loop time of 313.116 on 4 procs for 3000000 steps with 2501 atoms

Performance: 8278073.005 ns/day, 0.000 hours/ns, 9581.103 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 11.226     | 46.187     | 81.26      | 513.0 | 14.75
Neigh   | 4.2022     | 4.2814     | 4.3608     |   3.3 |  1.37
Comm    | 18.898     | 42.745     | 94.741     | 463.3 | 13.65
Output  | 0.26912    | 0.26942    | 0.26976    |   0.1 |  0.09
Modify  | 110.67     | 162.96     | 187.32     | 238.9 | 52.05
Other   |            | 56.67      |            |       | 18.10

Nlocal:         625.25 ave         876 max         375 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:           1.75 ave           3 max           1 min
Histogram: 2 0 0 0 0 1 0 0 0 1
Neighs:         333.25 ave         667 max           0 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 1333
Ave neighs/atom = 0.53298681
Neighbor list builds = 168
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 51

#variable lat0 equal 1                    #
variable lat1 equal 3+(100*0.01)+(v_ind*0.01)  # .491+(v_ind*0.001)       # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 500*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.51                                                               
Lattice spacing in x,y,z = 4.51 4.51 4.51

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -3382.5 ${n1e1} -100 100 -100 100 units box
region box block -3382.5 3382.5 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -3382.5 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -3382.5 3382.5 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-3382.5 -100 -100) to (3382.5 100 100)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 1500 atoms
  using lattice units in orthogonal box = (-3382.5 -100 -100) to (3382.5 100 100)
  create_atoms CPU = 0.000 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 1500 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 1001 atoms
  using lattice units in orthogonal box = (-3382.5 -100 -100) to (3382.5 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  1500 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  1500 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  1001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  1001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
1500 atoms in group substrate
group slider1 region slider1
1001 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 1001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_51_*.dump id type diameter mass xu yu zu fx fy fz

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 4365 130 130
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 89.13 | 89.13 | 89.14 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   6765           200            200            0              0              0              0              0              0              0              1.1965779e-13  0              6            
    100000   6765           200            200            0.0030025305   2.6740246e-40  0              0.0090075914   584141.84      0              5.6412237e+10  1.1965779e-13  0              3.3274871    
    200000   6765           200            200            0.0010574207  -2.3881473e-34  0              0.003172262    141026.39      0              1.3619319e+10  1.1965779e-13  0              3.0755703    
    300000   6765           200            200            6.6283109e-05 -4.7761807e-35  0              0.00019884933  1151.0542      0              1.1116058e+08  1.1965779e-13  0              3.0455426    
    400000   6765           200            200            0.00028816812  2.42379e-06    0              0.00086208056  7923.3241      0              7.6517793e+08  1.1965779e-13  0              2.999217     
    500000   6765           200            200            0.0044942938   0.0017802509   0              0.011702631    1585.8416      0              1.5314923e+08  1.1965779e-13  0              2.9952403    
    600000   6765           200            200            0.0056419717   0.0030056832   0              0.013920232    141.8083       0              13694831       1.1965779e-13  0              2.9947436    
    700000   6765           200            200            0.004469333    0.0021916509   0              0.011216348    28.581611      0              2760207.4      1.1965779e-13  0              2.9952995    
    800000   6765           200            200            0.0042379952   0.0021986094   0              0.010515376    0.7885582      0              76153.307      1.1965779e-13  0              2.9954415    
    900000   6765           200            200            0.0045088409   0.0022474795   0              0.011279043    0.13997765     0              13518.039      1.1965779e-13  0              2.9952797    
   1000000   6765           200            200            0.0044394511   0.0022375567   0              0.011080797    0.069984382    0              6758.5907      1.1965779e-13  0              2.9953221    
   1100000   6765           200            200            0.0044298303   0.0022362392   0              0.011053252    0.0025396097   0              245.25733      1.1965779e-13  0              2.9953275    
   1200000   6765           200            200            0.0044428579   0.0022381278   0              0.011090446    0.00027188073  0              26.256295      1.1965779e-13  0              2.9953197    
   1300000   6765           200            200            0.0044392036   0.0022375897   0              0.011080021    0.00017074867  0              16.489684      1.1965779e-13  0              2.995322     
   1400000   6765           200            200            0.0044388374   0.0022375408   0              0.011078971    7.5496154e-06  0              0.72908782     1.1965779e-13  0              2.9953222    
   1500000   6765           200            200            0.0044394693   0.002237632    0              0.011080776    5.1326566e-07  0              0.049567524    1.1965779e-13  0              2.9953218    
   1600000   6765           200            200            0.0044392783   0.0022376039   0              0.011080231    4.1332907e-07  0              0.039916363    1.1965779e-13  0              2.9953219    
   1700000   6765           200            200            0.0044392658   0.0022376023   0              0.011080195    2.1891334e-08  0              0.0021141084   1.1965779e-13  0              2.9953219    
   1800000   6765           200            200            0.0044392963   0.0022376067   0              0.011080282    9.2358494e-10  0              8.9193222e-05  1.1965779e-13  0              2.9953219    
   1900000   6765           200            200            0.0044392864   0.0022376053   0              0.011080254    9.9256179e-10  0              9.5854514e-05  1.1965779e-13  0              2.9953219    
   2000000   6765           200            200            0.0044392861   0.0022376052   0              0.011080253    6.2198442e-11  0              6.0066803e-06  1.1965779e-13  0              2.9953219    
   2100000   6765           200            200            0.0044392875   0.0022376054   0              0.011080257    1.5556094e-12  0              1.5022962e-07  1.1965779e-13  0              2.9953219    
   2200000   6765           200            200            0.004439287    0.0022376054   0              0.011080256    2.3638279e-12  0              2.2828158e-07  1.1965779e-13  0              2.9953219    
   2300000   6765           200            200            0.004439287    0.0022376054   0              0.011080256    1.7323202e-13  0              1.6729508e-08  1.1965779e-13  0              2.9953219    
   2400000   6765           200            200            0.0044392871   0.0022376054   0              0.011080256    2.4357917e-15  0              2.3523133e-10  1.1965779e-13  0              2.9953219    
   2500000   6765           200            200            0.0044392871   0.0022376054   0              0.011080256    5.6028105e-15  0              5.4107933e-10  1.1965779e-13  0              2.9953219    
   2600000   6765           200            200            0.0044392871   0.0022376054   0              0.011080256    5.04415e-16    0              4.871279e-11   1.1965779e-13  0              2.9953219    
   2700000   6765           200            200            0.0044392871   0.0022376054   0              0.011080256    1.6142991e-18  0              1.5589746e-13  1.1965779e-13  0              2.9953219    
   2800000   6765           200            200            0.0044392871   0.0022376054   0              0.011080256    1.3829045e-17  0              1.3355101e-12  1.1965779e-13  0              2.9953219    
   2900000   6765           200            200            0.0044392871   0.0022376054   0              0.011080256    1.3116793e-18  0              1.266726e-13   1.1965779e-13  0              2.9953219    
   3000000   6765           200            200            0.0044392871   0.0022376054   0              0.011080256    1.8466061e-19  0              1.78332e-14    1.1965779e-13  0              2.9953219    
Loop time of 295.073 on 4 procs for 3000000 steps with 2501 atoms

Performance: 8784263.781 ns/day, 0.000 hours/ns, 10166.972 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 10.884     | 37.536     | 65.112     | 432.5 | 12.72
Neigh   | 4.1219     | 4.1972     | 4.274      |   3.2 |  1.42
Comm    | 18.878     | 38.41      | 78.666     | 379.9 | 13.02
Output  | 0.27107    | 0.2714     | 0.27173    |   0.1 |  0.09
Modify  | 108.95     | 158.07     | 177.77     | 226.8 | 53.57
Other   |            | 56.59      |            |       | 19.18

Nlocal:         625.25 ave         876 max         375 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:           1.75 ave           3 max           1 min
Histogram: 2 0 0 0 0 1 0 0 0 1
Neighs:         336.75 ave         674 max           0 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 1347
Ave neighs/atom = 0.53858457
Neighbor list builds = 164
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 52

#variable lat0 equal 1                    #
variable lat1 equal 3+(100*0.01)+(v_ind*0.01)  # .491+(v_ind*0.001)       # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 500*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.52                                                               
Lattice spacing in x,y,z = 4.52 4.52 4.52

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -3390 ${n1e1} -100 100 -100 100 units box
region box block -3390 3390 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -3390 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -3390 3390 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-3390 -100 -100) to (3390 100 100)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 1500 atoms
  using lattice units in orthogonal box = (-3390 -100 -100) to (3390 100 100)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 1500 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 1001 atoms
  using lattice units in orthogonal box = (-3390 -100 -100) to (3390 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  1500 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  1500 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  1001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  1001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
1500 atoms in group substrate
group slider1 region slider1
1001 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 1001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_52_*.dump id type diameter mass xu yu zu fx fy fz

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 4375 130 130
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 89.27 | 89.27 | 89.28 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   6780           200            200            0              0              0              0              0              0              0              1.1965779e-13  0              6            
    100000   6780           200            200            0.0029923486  -1.7871514e-35  0              0.0089770457   583137.25      0              5.6315221e+10  1.1965779e-13  0              3.3280686    
    200000   6780           200            200            0.0010459236   1.6923152e-40  0              0.0031377708   139121.97      0              1.3435404e+10  1.1965779e-13  0              3.0769856    
    300000   6780           200            200            5.0015767e-05 -1.1914314e-35  0              0.0001500473   672.31608      0              64927475       1.1965779e-13  0              3.0454193    
    400000   6780           200            200            0.00013964069  4.7658182e-35  0              0.00041892206  4821.1366      0              4.6559086e+08  1.1965779e-13  0              3.0020513    
    500000   6780           200            200            0.0005525581   0.00011585393  0              0.0015418204   11.922619      0              1151401.2      1.1965779e-13  0              2.9981576    
    600000   6780           200            200            0.0028563101   0.0008905875   0              0.0076783428   81.623581      0              7882621.2      1.1965779e-13  0              2.9958746    
    700000   6780           200            200            0.0037050553   0.001095398    0              0.010019768    17.004793      0              1642201.2      1.1965779e-13  0              2.995304     
    800000   6780           200            200            0.0042971884   0.0012170773   0              0.011674488    0.040215822    0              3883.7563      1.1965779e-13  0              2.9949328    
    900000   6780           200            200            0.0040433732   0.0011898932   0              0.010940226    0.38200254     0              36891.071      1.1965779e-13  0              2.9950909    
   1000000   6780           200            200            0.0040711853   0.0011921848   0              0.011021371    0.057060251    0              5510.4706      1.1965779e-13  0              2.9950741    
   1100000   6780           200            200            0.0040929003   0.0011940755   0              0.011084625    0.00039817888  0              38.453266      1.1965779e-13  0              2.9950599    
   1200000   6780           200            200            0.0040797848   0.0011929648   0              0.01104639     0.00055601628  0              53.696073      1.1965779e-13  0              2.9950683    
   1300000   6780           200            200            0.0040825381   0.0011931936   0              0.011054421    0.000166423    0              16.071943      1.1965779e-13  0              2.9950666    
   1400000   6780           200            200            0.0040831139   0.001193245    0              0.011056097    5.7912487e-06  0              0.55927735     1.1965779e-13  0              2.9950662    
   1500000   6780           200            200            0.0040824934   0.0011931919   0              0.011054288    4.8622131e-07  0              0.046955774    1.1965779e-13  0              2.9950666    
   1600000   6780           200            200            0.0040826845   0.001193208    0              0.011054846    3.923575e-07   0              0.037891079    1.1965779e-13  0              2.9950665    
   1700000   6780           200            200            0.0040826854   0.0011932082   0              0.011054848    3.1404883e-08  0              0.0030328588   1.1965779e-13  0              2.9950665    
   1800000   6780           200            200            0.0040826593   0.0011932059   0              0.011054772    5.9549022e-11  0              5.7508183e-06  1.1965779e-13  0              2.9950665    
   1900000   6780           200            200            0.0040826705   0.0011932069   0              0.011054805    7.4170418e-10  0              7.1628481e-05  1.1965779e-13  0              2.9950665    
   2000000   6780           200            200            0.0040826691   0.0011932068   0              0.011054801    1.1561262e-10  0              1.1165039e-05  1.1965779e-13  0              2.9950665    
   2100000   6780           200            200            0.0040826682   0.0011932067   0              0.011054798    9.6724289e-13  0              9.3409395e-08  1.1965779e-13  0              2.9950665    
   2200000   6780           200            200            0.0040826688   0.0011932067   0              0.0110548      1.0467839e-12  0              1.010909e-07   1.1965779e-13  0              2.9950665    
   2300000   6780           200            200            0.0040826687   0.0011932067   0              0.011054799    3.3160377e-13  0              3.2023919e-08  1.1965779e-13  0              2.9950665    
   2400000   6780           200            200            0.0040826686   0.0011932067   0              0.011054799    1.2350824e-14  0              1.1927542e-09  1.1965779e-13  0              2.9950665    
   2500000   6780           200            200            0.0040826687   0.0011932067   0              0.011054799    8.2428842e-16  0              7.9603876e-11  1.1965779e-13  0              2.9950665    
   2600000   6780           200            200            0.0040826687   0.0011932067   0              0.011054799    7.8124243e-16  0              7.5446802e-11  1.1965779e-13  0              2.9950665    
   2700000   6780           200            200            0.0040826687   0.0011932067   0              0.011054799    6.2271572e-17  0              6.0137427e-12  1.1965779e-13  0              2.9950665    
   2800000   6780           200            200            0.0040826687   0.0011932067   0              0.011054799    2.0508431e-19  0              1.9805574e-14  1.1965779e-13  0              2.9950665    
   2900000   6780           200            200            0.0040826687   0.0011932067   0              0.011054799    1.963577e-18   0              1.8962822e-13  1.1965779e-13  0              2.9950665    
   3000000   6780           200            200            0.0040826687   0.0011932067   0              0.011054799    1.2096283e-18  0              1.1681725e-13  1.1965779e-13  0              2.9950665    
Loop time of 294.796 on 4 procs for 3000000 steps with 2501 atoms

Performance: 8792526.916 ns/day, 0.000 hours/ns, 10176.536 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 10.949     | 37.622     | 64.632     | 427.5 | 12.76
Neigh   | 4.1217     | 4.1968     | 4.2739     |   3.2 |  1.42
Comm    | 17.764     | 23.878     | 28.667     |  90.7 |  8.10
Output  | 0.27306    | 0.27337    | 0.2737     |   0.1 |  0.09
Modify  | 167.71     | 172.65     | 177.37     |  30.8 | 58.57
Other   |            | 56.17      |            |       | 19.05

Nlocal:         625.25 ave         877 max         374 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:           1.75 ave           3 max           1 min
Histogram: 2 0 0 0 0 1 0 0 0 1
Neighs:         336.25 ave         673 max           0 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 1345
Ave neighs/atom = 0.53778489
Neighbor list builds = 164
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 53

#variable lat0 equal 1                    #
variable lat1 equal 3+(100*0.01)+(v_ind*0.01)  # .491+(v_ind*0.001)       # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 500*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.53                                                               
Lattice spacing in x,y,z = 4.53 4.53 4.53

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -3397.5 ${n1e1} -100 100 -100 100 units box
region box block -3397.5 3397.5 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -3397.5 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -3397.5 3397.5 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-3397.5 -100 -100) to (3397.5 100 100)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 1500 atoms
  using lattice units in orthogonal box = (-3397.5 -100 -100) to (3397.5 100 100)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 1500 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 1001 atoms
  using lattice units in orthogonal box = (-3397.5 -100 -100) to (3397.5 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  1500 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  1500 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  1001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  1001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
1500 atoms in group substrate
group slider1 region slider1
1001 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 1001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_53_*.dump id type diameter mass xu yu zu fx fy fz

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 4384 130 130
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 89.41 | 89.41 | 89.42 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   6795           200            200            0              0              0              0              0              0              0              1.1965779e-13  0              6            
    100000   6795           200            200            0.0029840237  -5.944019e-36   0              0.0089520712   582634.34      0              5.6266654e+10  1.1965779e-13  0              3.3284651    
    200000   6795           200            200            0.0010395841  -2.3775726e-35  0              0.0031187524   138281.54      0              1.3354241e+10  1.1965779e-13  0              3.0776701    
    300000   6795           200            200            4.3651442e-05  1.1168502e-40  0              0.00013095433  518.76773      0              50098875       1.1965779e-13  0              3.0453507    
    400000   6795           200            200            0.00012308618 -4.7552059e-35  0              0.00036925853  3831.127       0              3.6998283e+08  1.1965779e-13  0              3.002927     
    500000   6795           200            200            0.001071917    0.00018347223  0              0.0030322789   603.24106      0              58256703       1.1965779e-13  0              2.9973054    
    600000   6795           200            200            0.0052193939   0.0010818284   0              0.014576353    86.129278      0              8317749.2      1.1965779e-13  0              2.9942075    
    700000   6795           200            200            0.0045117748   0.00085436024  0              0.012680964    0.0054168207   0              523.11777      1.1965779e-13  0              2.9946063    
    800000   6795           200            200            0.0040999719   0.00081588215  0              0.011484034    1.5981643      0              154339.27      1.1965779e-13  0              2.9948745    
    900000   6795           200            200            0.0039604816   0.00080914278  0              0.011072302    0.48233991     0              46580.936      1.1965779e-13  0              2.994968     
   1000000   6795           200            200            0.0039338484   0.00080780592  0              0.010993739    0.053006229    0              5118.9622      1.1965779e-13  0              2.9949855    
   1100000   6795           200            200            0.0039371233   0.00080799605  0              0.011003374    0.0015473893   0              149.43578      1.1965779e-13  0              2.994983     
   1200000   6795           200            200            0.0039426113   0.00080828692  0              0.011019547    6.9578947e-05  0              6.7194367      1.1965779e-13  0              2.9949792    
   1300000   6795           200            200            0.0039453405   0.00080842897  0              0.011027592    0.00010245466  0              9.8943379      1.1965779e-13  0              2.9949774    
   1400000   6795           200            200            0.0039461761   0.00080847182  0              0.011030056    2.226631e-05   0              2.1503208      1.1965779e-13  0              2.9949768    
   1500000   6795           200            200            0.0039462904   0.00080847743  0              0.011030394    1.8474014e-06  0              0.1784088      1.1965779e-13  0              2.9949767    
   1600000   6795           200            200            0.0039462437   0.00080847488  0              0.011030256    2.2010098e-08  0              0.0021255777   1.1965779e-13  0              2.9949768    
   1700000   6795           200            200            0.0039462013   0.00080847266  0              0.011030131    9.5331003e-09  0              0.00092063859  1.1965779e-13  0              2.9949768    
   1800000   6795           200            200            0.0039461832   0.00080847172  0              0.011030078    5.8328102e-09  0              0.00056329106  1.1965779e-13  0              2.9949768    
   1900000   6795           200            200            0.0039461784   0.00080847148  0              0.011030064    9.5632251e-10  0              9.2354783e-05  1.1965779e-13  0              2.9949768    
   2000000   6795           200            200            0.0039461781   0.00080847147  0              0.011030063    5.7067123e-11  0              5.5111343e-06  1.1965779e-13  0              2.9949768    
   2100000   6795           200            200            0.0039461786   0.00080847149  0              0.011030064    3.6519308e-14  0              3.5267733e-09  1.1965779e-13  0              2.9949768    
   2200000   6795           200            200            0.0039461789   0.00080847151  0              0.011030065    8.2505575e-13  0              7.9677979e-08  1.1965779e-13  0              2.9949768    
   2300000   6795           200            200            0.003946179    0.00080847151  0              0.011030065    3.0246534e-13  0              2.9209937e-08  1.1965779e-13  0              2.9949768    
   2400000   6795           200            200            0.003946179    0.00080847151  0              0.011030066    3.8112396e-14  0              3.6806224e-09  1.1965779e-13  0              2.9949768    
   2500000   6795           200            200            0.003946179    0.00080847151  0              0.011030066    1.5167886e-15  0              1.4648058e-10  1.1965779e-13  0              2.9949768    
   2600000   6795           200            200            0.003946179    0.00080847151  0              0.011030066    2.8762561e-17  0              2.7776823e-12  1.1965779e-13  0              2.9949768    
   2700000   6795           200            200            0.003946179    0.00080847151  0              0.011030065    5.0130105e-17  0              4.8412067e-12  1.1965779e-13  0              2.9949768    
   2800000   6795           200            200            0.003946179    0.00080847151  0              0.011030065    1.2066693e-17  0              1.1653149e-12  1.1965779e-13  0              2.9949768    
   2900000   6795           200            200            0.003946179    0.00080847151  0              0.011030065    3.6032191e-18  0              3.4797311e-13  1.1965779e-13  0              2.9949768    
   3000000   6795           200            200            0.003946179    0.00080847151  0              0.011030065    2.8074153e-19  0              2.7112007e-14  1.1965779e-13  0              2.9949768    
Loop time of 294.891 on 4 procs for 3000000 steps with 2501 atoms

Performance: 8789695.163 ns/day, 0.000 hours/ns, 10173.258 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 10.842     | 37.206     | 63.908     | 427.5 | 12.62
Neigh   | 4.1561     | 4.2342     | 4.3131     |   3.3 |  1.44
Comm    | 19.219     | 37.998     | 77.138     | 371.1 | 12.89
Output  | 0.27382    | 0.27416    | 0.27447    |   0.1 |  0.09
Modify  | 110.58     | 158.88     | 178.64     | 222.6 | 53.88
Other   |            | 56.3       |            |       | 19.09

Nlocal:         625.25 ave         876 max         375 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:           1.75 ave           3 max           1 min
Histogram: 2 0 0 0 0 1 0 0 0 1
Neighs:         338.25 ave         677 max           0 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 1353
Ave neighs/atom = 0.54098361
Neighbor list builds = 164
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 54

#variable lat0 equal 1                    #
variable lat1 equal 3+(100*0.01)+(v_ind*0.01)  # .491+(v_ind*0.001)       # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 500*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.54                                                               
Lattice spacing in x,y,z = 4.54 4.54 4.54

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -3405 ${n1e1} -100 100 -100 100 units box
region box block -3405 3405 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -3405 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -3405 3405 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-3405 -100 -100) to (3405 100 100)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 1500 atoms
  using lattice units in orthogonal box = (-3405 -100 -100) to (3405 100 100)
  create_atoms CPU = 0.000 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 1500 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 1001 atoms
  using lattice units in orthogonal box = (-3405 -100 -100) to (3405 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  1500 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  1500 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  1001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  1001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
1500 atoms in group substrate
group slider1 region slider1
1001 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 1001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_54_*.dump id type diameter mass xu yu zu fx fy fz

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 4394 130 130
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 89.56 | 89.59 | 89.61 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   6810           200            200            0              0              0              0              0              0              0              1.1965779e-13  0              6            
    100000   6810           200            200            0.0029770781  -3.7068338e-37  0              0.0089312342   582536.46      0              5.6257202e+10  1.1965779e-13  0              3.3284585    
    200000   6810           200            200            0.001036195    4.7447867e-35  0              0.0031085849   138055.44      0              1.3332406e+10  1.1965779e-13  0              3.0777832    
    300000   6810           200            200            4.0939993e-05  4.1619115e-40  0              0.00012281998  460.01532      0              44424987       1.1965779e-13  0              3.0452955    
    400000   6810           200            200            0.0001150221   4.7447801e-35  0              0.00034506629  3390.4448      0              3.2742489e+08  1.1965779e-13  0              3.0033047    
    500000   6810           200            200            0.0016009124  -0.00027871889  0              0.0050814561   1075.3848      0              1.0385296e+08  1.1965779e-13  0              2.9964954    
    600000   6810           200            200            0.0051539178  -0.00020175205  0              0.015663506    6.1267787      0              591680.44      1.1965779e-13  0              2.9939492    
    700000   6810           200            200            0.0039897061  -0.00016618478  0              0.012135303    14.781671      0              1427508        1.1965779e-13  0              2.994674     
    800000   6810           200            200            0.0036483353  -0.00020063324  0              0.011145639    3.5093392      0              338906.86      1.1965779e-13  0              2.9948945    
    900000   6810           200            200            0.0035853851  -0.00019602234  0              0.010952178    0.46668917     0              45069.499      1.1965779e-13  0              2.9949376    
   1000000   6810           200            200            0.0035853622  -0.00019606897  0              0.010952155    0.036676107    0              3541.9159      1.1965779e-13  0              2.9949369    
   1100000   6810           200            200            0.0035938353  -0.00019651871  0              0.010978024    0.0010460802   0              101.02294      1.1965779e-13  0              2.9949308    
   1200000   6810           200            200            0.0035993562  -0.0001968042   0              0.010994873    2.319073e-05   0              2.2395947      1.1965779e-13  0              2.9949268    
   1300000   6810           200            200            0.0036018027  -0.0001969291   0              0.011002337    5.613308e-05   0              5.4209311      1.1965779e-13  0              2.9949251    
   1400000   6810           200            200            0.0036026479  -0.00019697182  0              0.011004915    1.7801778e-05  0              1.7191683      1.1965779e-13  0              2.9949245    
   1500000   6810           200            200            0.0036028672  -0.00019698274  0              0.011005584    2.9976739e-06  0              0.28949389     1.1965779e-13  0              2.9949244    
   1600000   6810           200            200            0.0036028957  -0.00019698407  0              0.011005671    3.0926832e-07  0              0.029866921    1.1965779e-13  0              2.9949243    
   1700000   6810           200            200            0.0036028846  -0.00019698347  0              0.011005637    1.635869e-08   0              0.0015798052   1.1965779e-13  0              2.9949244    
   1800000   6810           200            200            0.0036028736  -0.0001969829   0              0.011005604    6.5948158e-11  0              6.3688011e-06  1.1965779e-13  0              2.9949244    
   1900000   6810           200            200            0.0036028679  -0.00019698261  0              0.011005586    1.4329261e-10  0              1.3838175e-05  1.1965779e-13  0              2.9949244    
   2000000   6810           200            200            0.0036028657  -0.0001969825   0              0.01100558     7.8735987e-11  0              7.603758e-06   1.1965779e-13  0              2.9949244    
   2100000   6810           200            200            0.0036028651  -0.00019698246  0              0.011005578    1.7238562e-11  0              1.6647769e-06  1.1965779e-13  0              2.9949244    
   2200000   6810           200            200            0.0036028649  -0.00019698246  0              0.011005577    2.2550753e-12  0              2.1777903e-07  1.1965779e-13  0              2.9949244    
   2300000   6810           200            200            0.0036028649  -0.00019698246  0              0.011005577    1.731113e-13   0              1.6717851e-08  1.1965779e-13  0              2.9949244    
   2400000   6810           200            200            0.003602865   -0.00019698246  0              0.011005577    4.5895245e-15  0              4.4322342e-10  1.1965779e-13  0              2.9949244    
   2500000   6810           200            200            0.003602865   -0.00019698246  0              0.011005577    1.4410677e-16  0              1.39168e-11    1.1965779e-13  0              2.9949244    
   2600000   6810           200            200            0.003602865   -0.00019698246  0              0.011005577    3.0002667e-16  0              2.8974428e-11  1.1965779e-13  0              2.9949244    
   2700000   6810           200            200            0.003602865   -0.00019698246  0              0.011005577    8.3607996e-17  0              8.0742618e-12  1.1965779e-13  0              2.9949244    
   2800000   6810           200            200            0.003602865   -0.00019698246  0              0.011005577    1.3866839e-17  0              1.3391601e-12  1.1965779e-13  0              2.9949244    
   2900000   6810           200            200            0.003602865   -0.00019698246  0              0.011005577    7.3731394e-18  0              7.1204503e-13  1.1965779e-13  0              2.9949244    
   3000000   6810           200            200            0.003602865   -0.00019698246  0              0.011005577    4.6760943e-18  0              4.5158372e-13  1.1965779e-13  0              2.9949244    
Loop time of 295.838 on 4 procs for 3000000 steps with 2501 atoms

Performance: 8761563.874 ns/day, 0.000 hours/ns, 10140.699 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 10.978     | 37.394     | 64.835     | 428.6 | 12.64
Neigh   | 4.1629     | 4.2411     | 4.3183     |   3.3 |  1.43
Comm    | 18.809     | 38.556     | 78.533     | 377.1 | 13.03
Output  | 0.26971    | 0.27004    | 0.27038    |   0.1 |  0.09
Modify  | 109.86     | 158.74     | 177.72     | 225.2 | 53.66
Other   |            | 56.64      |            |       | 19.14

Nlocal:         625.25 ave         876 max         375 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:           1.75 ave           3 max           1 min
Histogram: 2 0 0 0 0 1 0 0 0 1
Neighs:         336.75 ave         674 max           0 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 1347
Ave neighs/atom = 0.53858457
Neighbor list builds = 164
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 55

#variable lat0 equal 1                    #
variable lat1 equal 3+(100*0.01)+(v_ind*0.01)  # .491+(v_ind*0.001)       # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 500*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.55                                                               
Lattice spacing in x,y,z = 4.55 4.55 4.55

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -3412.5 ${n1e1} -100 100 -100 100 units box
region box block -3412.5 3412.5 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -3412.5 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -3412.5 3412.5 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-3412.5 -100 -100) to (3412.5 100 100)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 1500 atoms
  using lattice units in orthogonal box = (-3412.5 -100 -100) to (3412.5 100 100)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 1500 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 1001 atoms
  using lattice units in orthogonal box = (-3412.5 -100 -100) to (3412.5 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  1500 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  1500 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  1001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  1001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
1500 atoms in group substrate
group slider1 region slider1
1001 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 1001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_55_*.dump id type diameter mass xu yu zu fx fy fz

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 4404 130 130
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 89.75 | 89.76 | 89.77 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   6825           200            200            0              0              0              0              0              0              0              1.1965779e-13  0              6            
    100000   6825           200            200            0.0029716084   7.5333463e-42  0              0.0089148251   582840.73      0              5.6286586e+10  1.1965779e-13  0              3.3282996    
    200000   6825           200            200            0.001036667   -5.9178632e-36  0              0.0031100009   138627.56      0              1.3387657e+10  1.1965779e-13  0              3.0773856    
    300000   6825           200            200            4.6047498e-05 -2.3671426e-35  0              0.00013814249  580.31892      0              56043048       1.1965779e-13  0              3.0453788    
    400000   6825           200            200            0.00012896908 -4.7343023e-35  0              0.00038690724  4212.6288      0              4.0682554e+08  1.1965779e-13  0              3.0025927    
    500000   6825           200            200            0.00024214019 -0.0013448827   0              0.0020713033   268.91113      0              25969512       1.1965779e-13  0              2.9977869    
    600000   6825           200            200            0.0024007147  -0.0036904043   0              0.010892548    209.50071      0              20232079       1.1965779e-13  0              2.9950226    
    700000   6825           200            200            0.002141478   -0.0030641901   0              0.0094886241   4.5501642      0              439422.29      1.1965779e-13  0              2.995361     
    800000   6825           200            200            0.0024372056  -0.0033714039   0              0.010683021    2.8123221      0              271593.94      1.1965779e-13  0              2.9950893    
    900000   6825           200            200            0.0025870852  -0.0034089954   0              0.011170251    0.15067216     0              14550.839      1.1965779e-13  0              2.9949788    
   1000000   6825           200            200            0.002543352   -0.0033991933   0              0.011029249    0.044784915    0              4325.0065      1.1965779e-13  0              2.9950094    
   1100000   6825           200            200            0.0025214345  -0.0033938743   0              0.010958178    0.0036336957   0              350.91633      1.1965779e-13  0              2.9950254    
   1200000   6825           200            200            0.0025264611  -0.0033950528   0              0.010974436    0.00068760908  0              66.404364      1.1965779e-13  0              2.9950219    
   1300000   6825           200            200            0.0025296073  -0.0033958188   0              0.010984641    8.3286231e-05  0              8.0431881      1.1965779e-13  0              2.9950196    
   1400000   6825           200            200            0.0025290486  -0.0033956899   0              0.010982836    1.0172891e-05  0              0.982425       1.1965779e-13  0              2.99502      
   1500000   6825           200            200            0.0025286032  -0.0033955818   0              0.010981391    1.826555e-06   0              0.1763956      1.1965779e-13  0              2.9950203    
   1600000   6825           200            200            0.0025286616  -0.0033955951   0              0.01098158     1.4343543e-07  0              0.013851967    1.1965779e-13  0              2.9950202    
   1700000   6825           200            200            0.0025287239  -0.0033956102   0              0.010981782    3.8652139e-08  0              0.003732747    1.1965779e-13  0              2.9950202    
   1800000   6825           200            200            0.0025287184  -0.0033956089   0              0.010981764    1.9010207e-09  0              0.00018358697  1.1965779e-13  0              2.9950202    
   1900000   6825           200            200            0.0025287097  -0.0033956069   0              0.010981736    7.9317431e-10  0              7.6599097e-05  1.1965779e-13  0              2.9950202    
   2000000   6825           200            200            0.0025287102  -0.0033956069   0              0.010981737    2.3133738e-11  0              2.2340908e-06  1.1965779e-13  0              2.9950202    
   2100000   6825           200            200            0.0025287113  -0.0033956072   0              0.010981741    1.5843267e-11  0              1.5300293e-06  1.1965779e-13  0              2.9950202    
   2200000   6825           200            200            0.0025287113  -0.0033956072   0              0.010981741    2.4769747e-13  0              2.3920849e-08  1.1965779e-13  0              2.9950202    
   2300000   6825           200            200            0.0025287112  -0.0033956072   0              0.010981741    3.0872246e-13  0              2.9814205e-08  1.1965779e-13  0              2.9950202    
   2400000   6825           200            200            0.0025287112  -0.0033956072   0              0.010981741    2.1047925e-15  0              2.032658e-10   1.1965779e-13  0              2.9950202    
   2500000   6825           200            200            0.0025287112  -0.0033956072   0              0.010981741    5.8709153e-15  0              5.6697098e-10  1.1965779e-13  0              2.9950202    
   2600000   6825           200            200            0.0025287112  -0.0033956072   0              0.010981741    9.6120157e-18  0              9.2825968e-13  1.1965779e-13  0              2.9950202    
   2700000   6825           200            200            0.0025287112  -0.0033956072   0              0.010981741    1.0670042e-16  0              1.0304363e-11  1.1965779e-13  0              2.9950202    
   2800000   6825           200            200            0.0025287112  -0.0033956072   0              0.010981741    6.2922408e-19  0              6.0765958e-14  1.1965779e-13  0              2.9950202    
   2900000   6825           200            200            0.0025287112  -0.0033956072   0              0.010981741    6.7993461e-18  0              6.5663218e-13  1.1965779e-13  0              2.9950202    
   3000000   6825           200            200            0.0025287112  -0.0033956072   0              0.010981741    6.1043178e-18  0              5.8951132e-13  1.1965779e-13  0              2.9950202    
Loop time of 296.631 on 4 procs for 3000000 steps with 2501 atoms

Performance: 8738116.634 ns/day, 0.000 hours/ns, 10113.561 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 11.008     | 37.373     | 64.764     | 429.3 | 12.60
Neigh   | 4.2077     | 4.2898     | 4.3717     |   3.5 |  1.45
Comm    | 19.071     | 38.505     | 78.327     | 375.5 | 12.98
Output  | 0.27227    | 0.27259    | 0.27294    |   0.1 |  0.09
Modify  | 110.68     | 159.42     | 179.55     | 224.2 | 53.74
Other   |            | 56.78      |            |       | 19.14

Nlocal:         625.25 ave         876 max         375 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:           1.75 ave           3 max           1 min
Histogram: 2 0 0 0 0 1 0 0 0 1
Neighs:         335.25 ave         671 max           0 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 1341
Ave neighs/atom = 0.53618553
Neighbor list builds = 164
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 56

#variable lat0 equal 1                    #
variable lat1 equal 3+(100*0.01)+(v_ind*0.01)  # .491+(v_ind*0.001)       # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 500*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.56                                                               
Lattice spacing in x,y,z = 4.56 4.56 4.56

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -3420 ${n1e1} -100 100 -100 100 units box
region box block -3420 3420 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -3420 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -3420 3420 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-3420 -100 -100) to (3420 100 100)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 1500 atoms
  using lattice units in orthogonal box = (-3420 -100 -100) to (3420 100 100)
  create_atoms CPU = 0.000 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 1500 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 1001 atoms
  using lattice units in orthogonal box = (-3420 -100 -100) to (3420 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  1500 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  1500 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  1001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  1001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
1500 atoms in group substrate
group slider1 region slider1
1001 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 1001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_56_*.dump id type diameter mass xu yu zu fx fy fz

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 4413 130 130
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 89.96 | 89.97 | 89.97 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   6840           200            200            0              0              0              0              0              0              0              1.1965779e-13  0              6            
    100000   6840           200            200            0.0029658169   2.3619734e-34  0              0.0088974506   583048.66      0              5.6306666e+10  1.1965779e-13  0              3.3281768    
    200000   6840           200            200            0.0010363351  -4.723746e-35   0              0.0031090054   139033.97      0              1.3426906e+10  1.1965779e-13  0              3.0770803    
    300000   6840           200            200            5.0203289e-05  3.3067697e-34  0              0.00015060987  688.83545      0              66522797       1.1965779e-13  0              3.045402     
    400000   6840           200            200            0.00013314959  9.4479748e-35  0              0.00039944877  4487.3138      0              4.3335265e+08  1.1965779e-13  0              3.002391     
    500000   6840           200            200            0.00049508508  2.7820451e-15  0              0.0014852552   4.661296       0              450154.6       1.1965779e-13  0              2.9981666    
    600000   6840           200            200            0.0054955127   0.00068410475  0              0.015802433    9.1920279      0              887700.26      1.1965779e-13  0              2.994184     
    700000   6840           200            200            0.0037501627   0.00052557558  0              0.010724913    27.964145      0              2700576.9      1.1965779e-13  0              2.9951871    
    800000   6840           200            200            0.0036197203   0.00052112204  0              0.010338039    0.088523727    0              8548.9879      1.1965779e-13  0              2.9952638    
    900000   6840           200            200            0.0037935738   0.00052748071  0              0.010853241    0.4166097      0              40233.183      1.1965779e-13  0              2.995153     
   1000000   6840           200            200            0.0038494532   0.00052934065  0              0.011019019    0.033682155    0              3252.7814      1.1965779e-13  0              2.9951186    
   1100000   6840           200            200            0.0038382297   0.00052895179  0              0.010985737    0.0021366895   0              206.34617      1.1965779e-13  0              2.9951258    
   1200000   6840           200            200            0.0038282126   0.00052861604  0              0.010956022    0.0012272695   0              118.5209       1.1965779e-13  0              2.9951321    
   1300000   6840           200            200            0.0038274915   0.00052859384  0              0.010953881    2.5259525e-06  0              0.24393841     1.1965779e-13  0              2.9951325    
   1400000   6840           200            200            0.0038286804   0.00052863427  0              0.010957407    1.9076845e-05  0              1.8423052      1.1965779e-13  0              2.9951317    
   1500000   6840           200            200            0.003829043    0.00052864628  0              0.010958483    1.4137575e-06  0              0.13653058     1.1965779e-13  0              2.9951315    
   1600000   6840           200            200            0.0038289637   0.00052864352  0              0.010958247    1.0459581e-07  0              0.010101115    1.1965779e-13  0              2.9951316    
   1700000   6840           200            200            0.0038288971   0.00052864128  0              0.01095805     5.4034729e-08  0              0.0052182873   1.1965779e-13  0              2.9951316    
   1800000   6840           200            200            0.0038288929   0.00052864115  0              0.010958038    6.8586061e-11  0              6.6235509e-06  1.1965779e-13  0              2.9951316    
   1900000   6840           200            200            0.0038289009   0.00052864143  0              0.010958061    8.6941776e-10  0              8.3962144e-05  1.1965779e-13  0              2.9951316    
   2000000   6840           200            200            0.0038289033   0.0005286415   0              0.010958068    5.9248222e-11  0              5.7217692e-06  1.1965779e-13  0              2.9951316    
   2100000   6840           200            200            0.0038289027   0.00052864148  0              0.010958067    5.0938876e-12  0              4.919312e-07   1.1965779e-13  0              2.9951316    
   2200000   6840           200            200            0.0038289023   0.00052864147  0              0.010958065    2.3752051e-12  0              2.2938031e-07  1.1965779e-13  0              2.9951316    
   2300000   6840           200            200            0.0038289023   0.00052864147  0              0.010958065    1.6198302e-15  0              1.5643161e-10  1.1965779e-13  0              2.9951316    
   2400000   6840           200            200            0.0038289023   0.00052864147  0              0.010958066    3.9551163e-14  0              3.8195682e-09  1.1965779e-13  0              2.9951316    
   2500000   6840           200            200            0.0038289023   0.00052864147  0              0.010958066    2.4491133e-15  0              2.3651783e-10  1.1965779e-13  0              2.9951316    
   2600000   6840           200            200            0.0038289023   0.00052864147  0              0.010958066    2.7378877e-16  0              2.644056e-11   1.1965779e-13  0              2.9951316    
   2700000   6840           200            200            0.0038289023   0.00052864147  0              0.010958066    1.0043473e-16  0              9.6992672e-12  1.1965779e-13  0              2.9951316    
   2800000   6840           200            200            0.0038289023   0.00052864147  0              0.010958066    4.6085439e-19  0              4.4506019e-14  1.1965779e-13  0              2.9951316    
   2900000   6840           200            200            0.0038289023   0.00052864147  0              0.010958066    6.0498148e-18  0              5.8424781e-13  1.1965779e-13  0              2.9951316    
   3000000   6840           200            200            0.0038289023   0.00052864147  0              0.010958066    2.1793616e-18  0              2.1046714e-13  1.1965779e-13  0              2.9951316    
Loop time of 297.165 on 4 procs for 3000000 steps with 2501 atoms

Performance: 8722417.961 ns/day, 0.000 hours/ns, 10095.391 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 10.934     | 37.286     | 64.17      | 427.2 | 12.55
Neigh   | 4.2161     | 4.2975     | 4.3779     |   3.4 |  1.45
Comm    | 18.008     | 24.121     | 29.036     |  92.0 |  8.12
Output  | 0.27009    | 0.27041    | 0.27073    |   0.1 |  0.09
Modify  | 167.43     | 173.66     | 179.71     |  40.2 | 58.44
Other   |            | 57.53      |            |       | 19.36

Nlocal:         625.25 ave         877 max         374 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:           1.75 ave           3 max           1 min
Histogram: 2 0 0 0 0 1 0 0 0 1
Neighs:         335.75 ave         672 max           0 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 1343
Ave neighs/atom = 0.53698521
Neighbor list builds = 164
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 57

#variable lat0 equal 1                    #
variable lat1 equal 3+(100*0.01)+(v_ind*0.01)  # .491+(v_ind*0.001)       # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 500*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.57                                                               
Lattice spacing in x,y,z = 4.57 4.57 4.57

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -3427.5 ${n1e1} -100 100 -100 100 units box
region box block -3427.5 3427.5 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -3427.5 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -3427.5 3427.5 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-3427.5 -100 -100) to (3427.5 100 100)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 1500 atoms
  using lattice units in orthogonal box = (-3427.5 -100 -100) to (3427.5 100 100)
  create_atoms CPU = 0.000 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 1500 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 1001 atoms
  using lattice units in orthogonal box = (-3427.5 -100 -100) to (3427.5 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  1500 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  1500 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  1001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  1001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
1500 atoms in group substrate
group slider1 region slider1
1001 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 1001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_57_*.dump id type diameter mass xu yu zu fx fy fz

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 4423 130 130
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 90.1 | 90.11 | 90.11 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   6855           200            200            0              0              0              0              0              0              0              1.1965779e-13  0              6            
    100000   6855           200            200            0.0029588899   2.3568068e-35  0              0.0088766696   582924.78      0              5.6294703e+10  1.1965779e-13  0              3.3282367    
    200000   6855           200            200            0.0010327803   5.331274e-41   0              0.0030983409   138764.11      0              1.3400844e+10  1.1965779e-13  0              3.0772789    
    300000   6855           200            200            4.6826837e-05  7.0704337e-35  0              0.00014048051  604.60008      0              58387948       1.1965779e-13  0              3.0453929    
    400000   6855           200            200            0.00013097542  6.030451e-41   0              0.00039292625  4370.3318      0              4.2205536e+08  1.1965779e-13  0              3.0024564    
    500000   6855           200            200            0.00057754559 -2.761641e-05   0              0.0017602532   129.23051      0              12480158       1.1965779e-13  0              2.997972     
    600000   6855           200            200            0.0037142805   0.0019754755   0              0.0091673662   175.56446      0              16954759       1.1965779e-13  0              2.9954236    
    700000   6855           200            200            0.0037975456   0.0018172011   0              0.0095754356   8.0339781      0              775864.1       1.1965779e-13  0              2.9953373    
    800000   6855           200            200            0.0040648534   0.0018236294   0              0.010370931    0.38673479     0              37348.078      1.1965779e-13  0              2.9951519    
    900000   6855           200            200            0.0042365634   0.0018202694   0              0.010889421    0.48304425     0              46648.956      1.1965779e-13  0              2.995033     
   1000000   6855           200            200            0.0042718871   0.0018209293   0              0.010994732    0.030151916    0              2911.8562      1.1965779e-13  0              2.9950086    
   1100000   6855           200            200            0.0042605623   0.001819859    0              0.010961828    0.0009389491   0              90.676984      1.1965779e-13  0              2.9950157    
   1200000   6855           200            200            0.0042515555   0.0018189885   0              0.010935678    0.001192018    0              115.11657      1.1965779e-13  0              2.9950216    
   1300000   6855           200            200            0.0042498116   0.0018188161   0              0.010930619    7.0774126e-05  0              6.8348585      1.1965779e-13  0              2.9950228    
   1400000   6855           200            200            0.0042503914   0.00181887     0              0.010932304    2.5555149e-06  0              0.24679333     1.1965779e-13  0              2.9950225    
   1500000   6855           200            200            0.0042508372   0.0018189129   0              0.010933599    2.9417467e-06  0              0.28409284     1.1965779e-13  0              2.9950222    
   1600000   6855           200            200            0.004250921    0.0018189212   0              0.010933842    1.6609982e-07  0              0.016040732    1.1965779e-13  0              2.9950221    
   1700000   6855           200            200            0.0042508914   0.0018189184   0              0.010933756    6.9224093e-09  0              0.00066851675  1.1965779e-13  0              2.9950221    
   1800000   6855           200            200            0.0042508693   0.0018189163   0              0.010933692    7.2553333e-09  0              0.00070066816  1.1965779e-13  0              2.9950221    
   1900000   6855           200            200            0.0042508653   0.0018189159   0              0.01093368     3.8911545e-10  0              3.7577985e-05  1.1965779e-13  0              2.9950221    
   2000000   6855           200            200            0.0042508668   0.001818916    0              0.010933684    1.8649156e-11  0              1.801002e-06   1.1965779e-13  0              2.9950221    
   2100000   6855           200            200            0.0042508679   0.0018189161   0              0.010933688    1.7882796e-11  0              1.7269925e-06  1.1965779e-13  0              2.9950221    
   2200000   6855           200            200            0.0042508681   0.0018189162   0              0.010933688    9.1092673e-13  0              8.7970784e-08  1.1965779e-13  0              2.9950221    
   2300000   6855           200            200            0.004250868    0.0018189161   0              0.010933688    4.9836427e-14  0              4.8128454e-09  1.1965779e-13  0              2.9950221    
   2400000   6855           200            200            0.0042508679   0.0018189161   0              0.010933688    4.3970511e-14  0              4.2463572e-09  1.1965779e-13  0              2.9950221    
   2500000   6855           200            200            0.0042508679   0.0018189161   0              0.010933688    2.0761576e-15  0              2.0050044e-10  1.1965779e-13  0              2.9950221    
   2600000   6855           200            200            0.0042508679   0.0018189161   0              0.010933688    1.3116805e-16  0              1.2667271e-11  1.1965779e-13  0              2.9950221    
   2700000   6855           200            200            0.0042508679   0.0018189161   0              0.010933688    1.0696113e-16  0              1.0329541e-11  1.1965779e-13  0              2.9950221    
   2800000   6855           200            200            0.0042508679   0.0018189161   0              0.010933688    8.9142605e-19  0              8.6087548e-14  1.1965779e-13  0              2.9950221    
   2900000   6855           200            200            0.0042508679   0.0018189161   0              0.010933688    1.1508574e-18  0              1.1114157e-13  1.1965779e-13  0              2.9950221    
   3000000   6855           200            200            0.0042508679   0.0018189161   0              0.010933688    1.2667215e-18  0              1.223309e-13   1.1965779e-13  0              2.9950221    
Loop time of 294.626 on 4 procs for 3000000 steps with 2501 atoms

Performance: 8797608.010 ns/day, 0.000 hours/ns, 10182.417 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 10.88      | 37.434     | 64.538     | 430.5 | 12.71
Neigh   | 4.1937     | 4.273      | 4.3524     |   3.3 |  1.45
Comm    | 19.281     | 38.224     | 77.888     | 374.8 | 12.97
Output  | 0.27381    | 0.27412    | 0.27444    |   0.1 |  0.09
Modify  | 109.09     | 157.73     | 177.81     | 225.0 | 53.54
Other   |            | 56.69      |            |       | 19.24

Nlocal:         625.25 ave         876 max         375 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:           1.75 ave           3 max           1 min
Histogram: 2 0 0 0 0 1 0 0 0 1
Neighs:         335.75 ave         672 max           0 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 1343
Ave neighs/atom = 0.53698521
Neighbor list builds = 164
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 58

#variable lat0 equal 1                    #
variable lat1 equal 3+(100*0.01)+(v_ind*0.01)  # .491+(v_ind*0.001)       # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 500*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.58                                                               
Lattice spacing in x,y,z = 4.58 4.58 4.58

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -3435 ${n1e1} -100 100 -100 100 units box
region box block -3435 3435 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -3435 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -3435 3435 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-3435 -100 -100) to (3435 100 100)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 1500 atoms
  using lattice units in orthogonal box = (-3435 -100 -100) to (3435 100 100)
  create_atoms CPU = 0.000 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 1500 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 1001 atoms
  using lattice units in orthogonal box = (-3435 -100 -100) to (3435 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  1500 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  1500 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  1001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  1001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
1500 atoms in group substrate
group slider1 region slider1
1001 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 1001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_58_*.dump id type diameter mass xu yu zu fx fy fz

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 4433 130 130
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 90.31 | 90.32 | 90.32 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   6870           200            200            0              0              0              0              0              0              0              1.1965779e-13  0              6            
    100000   6870           200            200            0.0029518763   2.3516665e-35  0              0.0088556288   582761.12      0              5.6278898e+10  1.1965779e-13  0              3.3283662    
    200000   6870           200            200            0.0010292921   1.0831074e-40  0              0.0030878764   138504.42      0              1.3375766e+10  1.1965779e-13  0              3.077485     
    300000   6870           200            200            4.4516692e-05  1.6461653e-34  0              0.00013355008  550.48224      0              53161634       1.1965779e-13  0              3.0453767    
    400000   6870           200            200            0.00012680381  1.0740788e-39  0              0.00038041142  4132.4341      0              3.9908091e+08  1.1965779e-13  0              3.0026544    
    500000   6870           200            200            0.00050265421 -0.00081259392  0              0.0023205566   350.73135      0              33871123       1.1965779e-13  0              2.9976567    
    600000   6870           200            200            0.0044530705   0.00085796044  0              0.012501251    180.87939      0              17468037       1.1965779e-13  0              2.9946102    
    700000   6870           200            200            0.0040225667   0.00066523103  0              0.011402469    25.075845      0              2421645.6      1.1965779e-13  0              2.9948623    
    800000   6870           200            200            0.0038722291   0.00067488949  0              0.010941798    3.707452       0              358039.17      1.1965779e-13  0              2.9949706    
    900000   6870           200            200            0.0038428012   0.00067216715  0              0.010856236    0.47373915     0              45750.337      1.1965779e-13  0              2.9949918    
   1000000   6870           200            200            0.0038465489   0.00067234437  0              0.010867302    0.049280203    0              4759.1293      1.1965779e-13  0              2.9949898    
   1100000   6870           200            200            0.003853312    0.00067274111  0              0.010887195    0.0038848373   0              375.16978      1.1965779e-13  0              2.9949855    
   1200000   6870           200            200            0.0038575538   0.0006729951   0              0.010899666    0.00018547676  0              17.912018      1.1965779e-13  0              2.9949827    
   1300000   6870           200            200            0.0038596083   0.00067311919  0              0.010905706    1.2366845e-06  0              0.11943014     1.1965779e-13  0              2.9949813    
   1400000   6870           200            200            0.0038604723   0.00067317168  0              0.010908245    1.1223284e-06  0              0.10838645     1.1965779e-13  0              2.9949807    
   1500000   6870           200            200            0.0038607991   0.00067319164  0              0.010909206    7.9272796e-07  0              0.076555993    1.1965779e-13  0              2.9949805    
   1600000   6870           200            200            0.003860911    0.00067319852  0              0.010909535    2.298164e-07   0              0.022194023    1.1965779e-13  0              2.9949804    
   1700000   6870           200            200            0.0038609452   0.00067320063  0              0.010909635    4.6214851e-08  0              0.0044630995   1.1965779e-13  0              2.9949804    
   1800000   6870           200            200            0.0038609539   0.00067320118  0              0.010909661    7.3272787e-09  0              0.00070761613  1.1965779e-13  0              2.9949804    
   1900000   6870           200            200            0.0038609554   0.00067320128  0              0.010909665    9.5080455e-10  0              9.1821898e-05  1.1965779e-13  0              2.9949804    
   2000000   6870           200            200            0.0038609553   0.00067320127  0              0.010909665    1.0015013e-10  0              9.6717825e-06  1.1965779e-13  0              2.9949804    
   2100000   6870           200            200            0.003860955    0.00067320126  0              0.010909664    8.0422085e-12  0              7.7665893e-07  1.1965779e-13  0              2.9949804    
   2200000   6870           200            200            0.0038609549   0.00067320125  0              0.010909663    4.0013212e-13  0              3.8641896e-08  1.1965779e-13  0              2.9949804    
   2300000   6870           200            200            0.0038609548   0.00067320124  0              0.010909663    3.52346e-15    0              3.4027054e-10  1.1965779e-13  0              2.9949804    
   2400000   6870           200            200            0.0038609547   0.00067320124  0              0.010909663    1.9211772e-15  0              1.8553354e-10  1.1965779e-13  0              2.9949804    
   2500000   6870           200            200            0.0038609547   0.00067320124  0              0.010909663    1.4751228e-15  0              1.424568e-10   1.1965779e-13  0              2.9949804    
   2600000   6870           200            200            0.0038609547   0.00067320124  0              0.010909663    4.2294223e-16  0              4.0844733e-11  1.1965779e-13  0              2.9949804    
   2700000   6870           200            200            0.0038609547   0.00067320124  0              0.010909663    9.0743869e-17  0              8.7633933e-12  1.1965779e-13  0              2.9949804    
   2800000   6870           200            200            0.0038609547   0.00067320124  0              0.010909663    1.3850968e-17  0              1.3376273e-12  1.1965779e-13  0              2.9949804    
   2900000   6870           200            200            0.0038609547   0.00067320124  0              0.010909663    1.9668399e-18  0              1.8994332e-13  1.1965779e-13  0              2.9949804    
   3000000   6870           200            200            0.0038609547   0.00067320124  0              0.010909663    3.0808636e-18  0              2.9752776e-13  1.1965779e-13  0              2.9949804    
Loop time of 295.304 on 4 procs for 3000000 steps with 2501 atoms

Performance: 8777393.476 ns/day, 0.000 hours/ns, 10159.020 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 10.874     | 37.026     | 63.647     | 425.6 | 12.54
Neigh   | 4.2219     | 4.2953     | 4.3702     |   3.1 |  1.45
Comm    | 18.776     | 37.974     | 77.25      | 373.0 | 12.86
Output  | 0.27309    | 0.2734     | 0.27373    |   0.1 |  0.09
Modify  | 110.31     | 159.11     | 178.36     | 225.2 | 53.88
Other   |            | 56.62      |            |       | 19.17

Nlocal:         625.25 ave         876 max         375 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:           1.75 ave           3 max           1 min
Histogram: 2 0 0 0 0 1 0 0 0 1
Neighs:         336.25 ave         673 max           0 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 1345
Ave neighs/atom = 0.53778489
Neighbor list builds = 164
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 59

#variable lat0 equal 1                    #
variable lat1 equal 3+(100*0.01)+(v_ind*0.01)  # .491+(v_ind*0.001)       # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 500*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.59                                                               
Lattice spacing in x,y,z = 4.59 4.59 4.59

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -3442.5 ${n1e1} -100 100 -100 100 units box
region box block -3442.5 3442.5 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -3442.5 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -3442.5 3442.5 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-3442.5 -100 -100) to (3442.5 100 100)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 1500 atoms
  using lattice units in orthogonal box = (-3442.5 -100 -100) to (3442.5 100 100)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 1500 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 1001 atoms
  using lattice units in orthogonal box = (-3442.5 -100 -100) to (3442.5 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  1500 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  1500 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  1001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  1001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
1500 atoms in group substrate
group slider1 region slider1
1001 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 1001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_59_*.dump id type diameter mass xu yu zu fx fy fz

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 4442 130 130
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 90.39 | 90.42 | 90.45 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   6885           200            200            0              0              0              0              0              0              0              1.1965779e-13  0              6            
    100000   6885           200            200            0.0029450102   5.8663411e-36  0              0.0088350305   582631.87      0              5.6266416e+10  1.1965779e-13  0              3.3284706    
    200000   6885           200            200            0.001025972    2.346553e-35   0              0.003077916    138276.64      0              1.3353768e+10  1.1965779e-13  0              3.0776759    
    300000   6885           200            200            4.3056774e-05 -3.5197937e-34  0              0.00012917032  518.20487      0              50044517       1.1965779e-13  0              3.0453534    
    400000   6885           200            200            0.00012266202 -1.1732606e-35  0              0.00036798606  3900.9546      0              3.7672627e+08  1.1965779e-13  0              3.002853     
    500000   6885           200            200            0.0010282627  -0.00034923948  0              0.0034340276   714.99067      0              69048681       1.1965779e-13  0              2.9971338    
    600000   6885           200            200            0.0050328564  -0.0002142045   0              0.015312774    20.158724      0              1946785.3      1.1965779e-13  0              2.9940159    
    700000   6885           200            200            0.0040465019  -0.00010463232  0              0.012244138    8.393679       0              810601.44      1.1965779e-13  0              2.9946552    
    800000   6885           200            200            0.0036300613  -4.6762326e-05  0              0.010936946    3.6720708      0              354622.31      1.1965779e-13  0              2.9949534    
    900000   6885           200            200            0.003563142   -4.4346962e-05  0              0.010733773    0.24308571     0              23475.478      1.1965779e-13  0              2.9949994    
   1000000   6885           200            200            0.0035873547  -4.5315894e-05  0              0.01080738     0.00070319105  0              67.909159      1.1965779e-13  0              2.9949814    
   1100000   6885           200            200            0.0036077967  -4.608483e-05   0              0.010869475    0.0062450541   0              603.10262      1.1965779e-13  0              2.9949667    
   1200000   6885           200            200            0.0036141418  -4.6315453e-05  0              0.010888741    0.0011245548   0              108.60145      1.1965779e-13  0              2.9949622    
   1300000   6885           200            200            0.0036143606  -4.6321531e-05  0              0.010889403    2.5884427e-05  0              2.4997327      1.1965779e-13  0              2.9949621    
   1400000   6885           200            200            0.0036136076  -4.629339e-05   0              0.010887116    4.549924e-06   0              0.43939909     1.1965779e-13  0              2.9949627    
   1500000   6885           200            200            0.0036132245  -4.6279348e-05  0              0.010885953    2.8482216e-06  0              0.27506085     1.1965779e-13  0              2.9949629    
   1600000   6885           200            200            0.0036131462  -4.6276551e-05  0              0.010885715    2.5487239e-07  0              0.024613751    1.1965779e-13  0              2.994963     
   1700000   6885           200            200            0.0036131611  -4.6277132e-05  0              0.01088576     8.9906008e-11  0              8.6824787e-06  1.1965779e-13  0              2.994963     
   1800000   6885           200            200            0.0036131786  -4.6277782e-05  0              0.010885814    4.0483933e-09  0              0.00039096484  1.1965779e-13  0              2.994963     
   1900000   6885           200            200            0.0036131849  -4.6278009e-05  0              0.010885833    9.7069254e-10  0              9.3742538e-05  1.1965779e-13  0              2.994963     
   2000000   6885           200            200            0.0036131854  -4.6278028e-05  0              0.010885834    3.6604144e-11  0              3.5349662e-06  1.1965779e-13  0              2.994963     
   2100000   6885           200            200            0.0036131848  -4.6278006e-05  0              0.010885833    1.8510476e-12  0              1.7876092e-07  1.1965779e-13  0              2.994963     
   2200000   6885           200            200            0.0036131845  -4.6277993e-05  0              0.010885831    2.1162338e-12  0              2.0437071e-07  1.1965779e-13  0              2.994963     
   2300000   6885           200            200            0.0036131844  -4.627799e-05   0              0.010885831    2.4967974e-13  0              2.4112282e-08  1.1965779e-13  0              2.994963     
   2400000   6885           200            200            0.0036131844  -4.627799e-05   0              0.010885831    1.4543445e-15  0              1.4045018e-10  1.1965779e-13  0              2.994963     
   2500000   6885           200            200            0.0036131844  -4.6277991e-05  0              0.010885831    2.4336933e-15  0              2.3502868e-10  1.1965779e-13  0              2.994963     
   2600000   6885           200            200            0.0036131844  -4.6277991e-05  0              0.010885831    7.9990689e-16  0              7.7249282e-11  1.1965779e-13  0              2.994963     
   2700000   6885           200            200            0.0036131844  -4.6277991e-05  0              0.010885831    4.3638997e-17  0              4.214342e-12   1.1965779e-13  0              2.994963     
   2800000   6885           200            200            0.0036131844  -4.6277991e-05  0              0.010885831    1.6668563e-20  0              1.6097305e-15  1.1965779e-13  0              2.994963     
   2900000   6885           200            200            0.0036131844  -4.6277991e-05  0              0.010885831    1.1884714e-18  0              1.1477406e-13  1.1965779e-13  0              2.994963     
   3000000   6885           200            200            0.0036131844  -4.6277991e-05  0              0.010885831    3.0553843e-18  0              2.9506715e-13  1.1965779e-13  0              2.994963     
Loop time of 295.832 on 4 procs for 3000000 steps with 2501 atoms

Performance: 8761743.824 ns/day, 0.000 hours/ns, 10140.907 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 11.053     | 37.203     | 64.071     | 426.8 | 12.58
Neigh   | 4.189      | 4.2633     | 4.3398     |   3.2 |  1.44
Comm    | 18.896     | 38.13      | 77.568     | 373.7 | 12.89
Output  | 0.27204    | 0.27235    | 0.27268    |   0.1 |  0.09
Modify  | 110.32     | 159.2      | 179.13     | 225.3 | 53.82
Other   |            | 56.76      |            |       | 19.19

Nlocal:         625.25 ave         876 max         375 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:           1.75 ave           3 max           1 min
Histogram: 2 0 0 0 0 1 0 0 0 1
Neighs:         336.75 ave         674 max           0 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 1347
Ave neighs/atom = 0.53858457
Neighbor list builds = 164
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 60

#variable lat0 equal 1                    #
variable lat1 equal 3+(100*0.01)+(v_ind*0.01)  # .491+(v_ind*0.001)       # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 500*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.6                                                               
Lattice spacing in x,y,z = 4.6 4.6 4.6

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -3450 ${n1e1} -100 100 -100 100 units box
region box block -3450 3450 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -3450 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -3450 3450 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-3450 -100 -100) to (3450 100 100)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 1500 atoms
  using lattice units in orthogonal box = (-3450 -100 -100) to (3450 100 100)
  create_atoms CPU = 0.000 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 1500 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 1001 atoms
  using lattice units in orthogonal box = (-3450 -100 -100) to (3450 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  1500 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  1500 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  1001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  1001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
1500 atoms in group substrate
group slider1 region slider1
1001 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 1001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_60_*.dump id type diameter mass xu yu zu fx fy fz

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 4452 130 130
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 90.59 | 90.59 | 90.6 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   6900           200            200            0              0              0              0              0              0              0              1.1965779e-13  0              6            
    100000   6900           200            200            0.0029388377  -2.3414258e-35  0              0.0088165132   582719.14      0              5.6274843e+10  1.1965779e-13  0              3.3282625    
    200000   6900           200            200            0.0010214685   5.8535985e-36  0              0.0030644056   137788.75      0              1.3306651e+10  1.1965779e-13  0              3.0782277    
    300000   6900           200            200            4.7379363e-05 -3.5121305e-35  0              0.00014213809  626.43964      0              60497057       1.1965779e-13  0              3.0452078    
    400000   6900           200            200            0.00012953413  2.3414458e-35  0              0.0003886024   4334.3578      0              4.1858125e+08  1.1965779e-13  0              3.0022852    
    500000   6900           200            200            0.002500431    3.9860727e-15  0              0.007501293    1168.1305      0              1.1280969e+08  1.1965779e-13  0              2.9960659    
    600000   6900           200            200            0.0040302433   6.6345155e-15  0              0.01209073     159.18089      0              15372551       1.1965779e-13  0              2.9944743    
    700000   6900           200            200            0.0032948894   5.3844467e-15  0              0.0098846682   10.13597       0              978859.48      1.1965779e-13  0              2.9951929    
    800000   6900           200            200            0.0037725425   6.177042e-15   0              0.011317627    0.30449241     0              29405.698      1.1965779e-13  0              2.9947313    
    900000   6900           200            200            0.0035623763   5.8318241e-15  0              0.010687129    0.0030815989   0              297.59876      1.1965779e-13  0              2.9949299    
   1000000   6900           200            200            0.0036398666   5.9580476e-15  0              0.0109196      0.012491981    0              1206.3861      1.1965779e-13  0              2.9948568    
   1100000   6900           200            200            0.0036154036   5.9185878e-15  0              0.010846211    0.0046816453   0              452.1198       1.1965779e-13  0              2.9948796    
   1200000   6900           200            200            0.0036215623   5.9283563e-15  0              0.010864687    0.00098989333  0              95.596813      1.1965779e-13  0              2.9948739    
   1300000   6900           200            200            0.003620675    5.9270378e-15  0              0.010862025    0.00014784079  0              14.277405      1.1965779e-13  0              2.9948747    
   1400000   6900           200            200            0.0036204473   5.9266162e-15  0              0.010861342    1.617868e-05   0              1.5624211      1.1965779e-13  0              2.994875     
   1500000   6900           200            200            0.0036207219   5.9270809e-15  0              0.010862166    1.1974026e-06  0              0.11563657     1.1965779e-13  0              2.9948747    
   1600000   6900           200            200            0.0036205659   5.9268218e-15  0              0.010861698    4.0503481e-08  0              0.0039115363   1.1965779e-13  0              2.9948748    
   1700000   6900           200            200            0.0036206349   5.9269353e-15  0              0.010861905    1.1728855e-10  0              1.1326888e-05  1.1965779e-13  0              2.9948748    
   1800000   6900           200            200            0.003620609    5.9268931e-15  0              0.010861827    1.192245e-09   0              0.00011513849  1.1965779e-13  0              2.9948748    
   1900000   6900           200            200            0.0036206173   5.9269065e-15  0              0.010861852    4.8487889e-10  0              4.6826132e-05  1.1965779e-13  0              2.9948748    
   2000000   6900           200            200            0.0036206152   5.9269031e-15  0              0.010861846    1.0638125e-10  0              1.0273539e-05  1.1965779e-13  0              2.9948748    
   2100000   6900           200            200            0.0036206155   5.9269036e-15  0              0.010861847    1.6339836e-11  0              1.5779844e-06  1.1965779e-13  0              2.9948748    
   2200000   6900           200            200            0.0036206156   5.9269037e-15  0              0.010861847    1.8407513e-12  0              1.7776659e-07  1.1965779e-13  0              2.9948748    
   2300000   6900           200            200            0.0036206155   5.9269035e-15  0              0.010861847    1.4255754e-13  0              1.3767186e-08  1.1965779e-13  0              2.9948748    
   2400000   6900           200            200            0.0036206156   5.9269036e-15  0              0.010861847    5.362675e-15   0              5.1788877e-10  1.1965779e-13  0              2.9948748    
   2500000   6900           200            200            0.0036206155   5.9269036e-15  0              0.010861847    6.4561452e-18  0              6.2348829e-13  1.1965779e-13  0              2.9948748    
   2600000   6900           200            200            0.0036206155   5.9269036e-15  0              0.010861847    1.285191e-16   0              1.2411454e-11  1.1965779e-13  0              2.9948748    
   2700000   6900           200            200            0.0036206155   5.9269036e-15  0              0.010861847    3.6852464e-17  0              3.5589472e-12  1.1965779e-13  0              2.9948748    
   2800000   6900           200            200            0.0036206155   5.9269036e-15  0              0.010861847    9.9824454e-18  0              9.6403312e-13  1.1965779e-13  0              2.9948748    
   2900000   6900           200            200            0.0036206155   5.9269036e-15  0              0.010861847    3.2825422e-19  0              3.1700443e-14  1.1965779e-13  0              2.9948748    
   3000000   6900           200            200            0.0036206155   5.9269036e-15  0              0.010861847    3.4116095e-18  0              3.2946883e-13  1.1965779e-13  0              2.9948748    
Loop time of 291.189 on 4 procs for 3000000 steps with 2501 atoms

Performance: 8901439.556 ns/day, 0.000 hours/ns, 10302.592 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 11.076     | 35.654     | 60.742     | 406.4 | 12.24
Neigh   | 4.1879     | 4.2622     | 4.3362     |   3.1 |  1.46
Comm    | 18.034     | 24.129     | 28.949     |  91.4 |  8.29
Output  | 0.2705     | 0.27081    | 0.27117    |   0.1 |  0.09
Modify  | 163.26     | 170.34     | 177.34     |  47.5 | 58.50
Other   |            | 56.53      |            |       | 19.41

Nlocal:         625.25 ave         877 max         374 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:           1.75 ave           3 max           1 min
Histogram: 2 0 0 0 0 1 0 0 0 1
Neighs:         326.25 ave         653 max           0 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 1305
Ave neighs/atom = 0.52179128
Neighbor list builds = 164
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 61

#variable lat0 equal 1                    #
variable lat1 equal 3+(100*0.01)+(v_ind*0.01)  # .491+(v_ind*0.001)       # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 500*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.61                                                               
Lattice spacing in x,y,z = 4.61 4.61 4.61

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -3457.5 ${n1e1} -100 100 -100 100 units box
region box block -3457.5 3457.5 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -3457.5 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -3457.5 3457.5 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-3457.5 -100 -100) to (3457.5 100 100)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 1499 atoms
  using lattice units in orthogonal box = (-3457.5 -100 -100) to (3457.5 100 100)
  create_atoms CPU = 0.000 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 1500 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 1001 atoms
  using lattice units in orthogonal box = (-3457.5 -100 -100) to (3457.5 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  1499 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  1499 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  1001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  1001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
1499 atoms in group substrate
group slider1 region slider1
1001 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 1001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_61_*.dump id type diameter mass xu yu zu fx fy fz

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 4462 130 130
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 90.74 | 90.77 | 90.8 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   6915           200            200            0              0              0              0              0              0              0              1.1965779e-13  0              6            
    100000   6915           200            200            0.0029318862   7.885187e-35   0              0.0087956585   582534.92      0              5.6369793e+10  1.1965779e-13  0              3.3284998    
    200000   6915           200            200            0.0010206343   4.6728015e-35  0              0.0030619029   138090.84      0              1.336255e+10   1.1965779e-13  0              3.0777824    
    300000   6915           200            200            4.096189e-05   2.0443084e-35  0              0.00012288567  474.38197      0              45904224       1.1965779e-13  0              3.0453118    
    400000   6915           200            200            0.00011524456  2.3363639e-35  0              0.00034573368  3501.2733      0              3.3880552e+08  1.1965779e-13  0              3.0032113    
    500000   6915           200            200            0.0012336462  -0.00082998706  0              0.0045309258   986.53411      0              95463329       1.1965779e-13  0              2.9966723    
    600000   6915           200            200            0.0055130945   0.0010526147   0              0.015486669    0.21432876     0              20739.817      1.1965779e-13  0              2.9939495    
    700000   6915           200            200            0.0042016259   0.00030358587  0              0.012301292    5.6805192      0              549683.25      1.1965779e-13  0              2.9946113    
    800000   6915           200            200            0.0039167385   0.00045573942  0              0.011294476    1.5377998      0              148807.31      1.1965779e-13  0              2.9948355    
    900000   6915           200            200            0.0038099732   0.00044866396  0              0.010981256    0.28624864     0              27699.243      1.1965779e-13  0              2.9949067    
   1000000   6915           200            200            0.0037752573   0.00044449648  0              0.010881275    0.048319055    0              4675.6598      1.1965779e-13  0              2.9949294    
   1100000   6915           200            200            0.0037645607   0.00044333562  0              0.010850346    0.00764593     0              739.86893      1.1965779e-13  0              2.9949365    
   1200000   6915           200            200            0.003761448    0.00044300379  0              0.01084134     0.0011456331   0              110.85876      1.1965779e-13  0              2.9949385    
   1300000   6915           200            200            0.00376063     0.00044291822  0              0.010838972    0.00016340723  0              15.812325      1.1965779e-13  0              2.994939     
   1400000   6915           200            200            0.0037604558   0.00044290075  0              0.010838467    2.2245469e-05  0              2.1526134      1.1965779e-13  0              2.9949391    
   1500000   6915           200            200            0.0037604397   0.00044289959  0              0.010838419    2.8915715e-06  0              0.27980689     1.1965779e-13  0              2.9949391    
   1600000   6915           200            200            0.0037604515   0.00044290111  0              0.010838453    3.5824807e-07  0              0.034666367    1.1965779e-13  0              2.9949391    
   1700000   6915           200            200            0.0037604622   0.00044290237  0              0.010838484    4.2123484e-08  0              0.0040761369   1.1965779e-13  0              2.9949391    
   1800000   6915           200            200            0.0037604684   0.00044290308  0              0.010838502    4.6640861e-09  0              0.00045132671  1.1965779e-13  0              2.9949391    
   1900000   6915           200            200            0.0037604715   0.00044290342  0              0.010838511    4.7985875e-10  0              4.6434191e-05  1.1965779e-13  0              2.9949391    
   2000000   6915           200            200            0.0037604729   0.00044290358  0              0.010838515    4.4816345e-11  0              4.3367152e-06  1.1965779e-13  0              2.9949391    
   2100000   6915           200            200            0.0037604734   0.00044290364  0              0.010838517    3.6330856e-12  0              3.5156053e-07  1.1965779e-13  0              2.9949391    
   2200000   6915           200            200            0.0037604737   0.00044290367  0              0.010838517    2.3150484e-13  0              2.2401885e-08  1.1965779e-13  0              2.9949391    
   2300000   6915           200            200            0.0037604738   0.00044290368  0              0.010838518    8.5944688e-15  0              8.3165559e-10  1.1965779e-13  0              2.9949391    
   2400000   6915           200            200            0.0037604738   0.00044290369  0              0.010838518    3.6250686e-18  0              3.5078474e-13  1.1965779e-13  0              2.9949391    
   2500000   6915           200            200            0.0037604738   0.00044290369  0              0.010838518    1.1968697e-16  0              1.1581674e-11  1.1965779e-13  0              2.9949391    
   2600000   6915           200            200            0.0037604738   0.00044290369  0              0.010838518    8.4621291e-17  0              8.1884955e-12  1.1965779e-13  0              2.9949391    
   2700000   6915           200            200            0.0037604738   0.00044290369  0              0.010838518    1.6194948e-17  0              1.5671264e-12  1.1965779e-13  0              2.9949391    
   2800000   6915           200            200            0.0037604738   0.00044290369  0              0.010838518    9.9385669e-19  0              9.6171909e-14  1.1965779e-13  0              2.9949391    
   2900000   6915           200            200            0.0037604738   0.00044290369  0              0.010838518    6.0736196e-18  0              5.8772215e-13  1.1965779e-13  0              2.9949391    
   3000000   6915           200            200            0.0037604738   0.00044290369  0              0.010838518    3.5447324e-18  0              3.430109e-13   1.1965779e-13  0              2.9949391    
Loop time of 291.185 on 4 procs for 3000000 steps with 2500 atoms

Performance: 8901543.447 ns/day, 0.000 hours/ns, 10302.712 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 10.319     | 36.534     | 62.462     | 427.6 | 12.55
Neigh   | 4.2226     | 4.2989     | 4.3759     |   3.3 |  1.48
Comm    | 24.594     | 51.19      | 76.335     | 351.0 | 17.58
Output  | 0.27092    | 0.27123    | 0.27157    |   0.1 |  0.09
Modify  | 108.62     | 142.85     | 177.63     | 281.9 | 49.06
Other   |            | 56.04      |            |       | 19.25

Nlocal:            625 ave         876 max         375 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:            1.5 ave           4 max           0 min
Histogram: 2 0 0 0 0 1 0 0 0 1
Neighs:         334.75 ave         670 max           0 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 1339
Ave neighs/atom = 0.5356
Neighbor list builds = 164
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 62

#variable lat0 equal 1                    #
variable lat1 equal 3+(100*0.01)+(v_ind*0.01)  # .491+(v_ind*0.001)       # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 500*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.62                                                               
Lattice spacing in x,y,z = 4.62 4.62 4.62

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -3465 ${n1e1} -100 100 -100 100 units box
region box block -3465 3465 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -3465 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -3465 3465 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-3465 -100 -100) to (3465 100 100)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 1500 atoms
  using lattice units in orthogonal box = (-3465 -100 -100) to (3465 100 100)
  create_atoms CPU = 0.000 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 1500 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 1001 atoms
  using lattice units in orthogonal box = (-3465 -100 -100) to (3465 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  1500 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  1500 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  1001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  1001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
1500 atoms in group substrate
group slider1 region slider1
1001 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 1001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_62_*.dump id type diameter mass xu yu zu fx fy fz

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 4471 130 130
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 90.94 | 90.94 | 90.95 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   6930           200            200            0              0              0              0              0              0              0              1.1965779e-13  0              6            
    100000   6930           200            200            0.0029258878   1.7484723e-35  0              0.0087776635   582632.73      0              5.6266499e+10  1.1965779e-13  0              3.328466     
    200000   6930           200            200            0.0010193415   4.6626617e-35  0              0.0030580246   138283.57      0              1.3354437e+10  1.1965779e-13  0              3.0776662    
    300000   6930           200            200            4.2856913e-05  4.7702491e-41  0              0.00012857074  520.08202      0              50225799       1.1965779e-13  0              3.0453482    
    400000   6930           200            200            0.00012088959  1.1656533e-35  0              0.00036266878  3843.025       0              3.7113185e+08  1.1965779e-13  0              3.0029138    
    500000   6930           200            200            0.0012069654   0.00086663425  0              0.002754262    550.00657      0              53115698       1.1965779e-13  0              2.9973777    
    600000   6930           200            200            0.0041220742  -0.002872031    0              0.015238254    14.932761      0              1442099.2      1.1965779e-13  0              2.994009     
    700000   6930           200            200            0.0027486468  -0.0016623486   0              0.0099082891   17.350894      0              1675625.1      1.1965779e-13  0              2.9952044    
    800000   6930           200            200            0.0030756107  -0.0017346149   0              0.010961447    3.397626       0              328118.4       1.1965779e-13  0              2.9949355    
    900000   6930           200            200            0.0030369236  -0.001726364    0              0.010837135    0.48850871     0              47176.674      1.1965779e-13  0              2.9949691    
   1000000   6930           200            200            0.0030187805  -0.0017231643   0              0.010779506    0.052572115    0              5077.0386      1.1965779e-13  0              2.994982     
   1100000   6930           200            200            0.0030366578  -0.0017265393   0              0.010836513    0.003900612    0              376.69318      1.1965779e-13  0              2.9949684    
   1200000   6930           200            200            0.0030269148  -0.0017246751   0              0.01080542     0.00013721015  0              13.250774      1.1965779e-13  0              2.9949759    
   1300000   6930           200            200            0.0030311595  -0.0017254965   0              0.010818975    1.7548543e-07  0              0.016947127    1.1965779e-13  0              2.9949726    
   1400000   6930           200            200            0.0030295736  -0.0017251876   0              0.010813908    3.4822917e-06  0              0.33629481     1.1965779e-13  0              2.9949739    
   1500000   6930           200            200            0.0030300843  -0.001725288    0              0.010815541    1.4840149e-06  0              0.14331553     1.1965779e-13  0              2.9949735    
   1600000   6930           200            200            0.0030299493  -0.0017252611   0              0.010815109    3.3691061e-07  0              0.032536415    1.1965779e-13  0              2.9949736    
   1700000   6930           200            200            0.0030299727  -0.0017252659   0              0.010815184    5.3911606e-08  0              0.005206397    1.1965779e-13  0              2.9949736    
   1800000   6930           200            200            0.0030299749  -0.0017252662   0              0.010815191    6.4512307e-09  0              0.00062301368  1.1965779e-13  0              2.9949736    
   1900000   6930           200            200            0.0030299702  -0.0017252654   0              0.010815176    5.545938e-10   0              5.35587e-05    1.1965779e-13  0              2.9949736    
   2000000   6930           200            200            0.0030299731  -0.0017252659   0              0.010815185    2.7597516e-11  0              2.6651706e-06  1.1965779e-13  0              2.9949736    
   2100000   6930           200            200            0.0030299718  -0.0017252657   0              0.010815181    1.6993753e-13  0              1.641135e-08   1.1965779e-13  0              2.9949736    
   2200000   6930           200            200            0.0030299723  -0.0017252658   0              0.010815183    1.8235302e-13  0              1.761035e-08   1.1965779e-13  0              2.9949736    
   2300000   6930           200            200            0.0030299721  -0.0017252657   0              0.010815182    1.2068613e-13  0              1.1655002e-08  1.1965779e-13  0              2.9949736    
   2400000   6930           200            200            0.0030299722  -0.0017252657   0              0.010815182    3.2271347e-14  0              3.1165357e-09  1.1965779e-13  0              2.9949736    
   2500000   6930           200            200            0.0030299722  -0.0017252657   0              0.010815182    5.7490364e-15  0              5.5520079e-10  1.1965779e-13  0              2.9949736    
   2600000   6930           200            200            0.0030299722  -0.0017252657   0              0.010815182    7.6735571e-16  0              7.4105722e-11  1.1965779e-13  0              2.9949736    
   2700000   6930           200            200            0.0030299722  -0.0017252657   0              0.010815182    6.6079228e-17  0              6.3814589e-12  1.1965779e-13  0              2.9949736    
   2800000   6930           200            200            0.0030299722  -0.0017252657   0              0.010815182    1.181992e-18   0              1.1414833e-13  1.1965779e-13  0              2.9949736    
   2900000   6930           200            200            0.0030299722  -0.0017252657   0              0.010815182    3.4196943e-19  0              3.3024959e-14  1.1965779e-13  0              2.9949736    
   3000000   6930           200            200            0.0030299722  -0.0017252657   0              0.010815182    8.7630998e-19  0              8.4627745e-14  1.1965779e-13  0              2.9949736    
Loop time of 293.155 on 4 procs for 3000000 steps with 2501 atoms

Performance: 8841728.869 ns/day, 0.000 hours/ns, 10233.482 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 10.962     | 36.925     | 63.233     | 423.5 | 12.60
Neigh   | 4.2506     | 4.332      | 4.4137     |   3.4 |  1.48
Comm    | 18.882     | 37.912     | 76.737     | 369.1 | 12.93
Output  | 0.26776    | 0.26807    | 0.26842    |   0.1 |  0.09
Modify  | 109.09     | 157.4      | 176.75     | 224.0 | 53.69
Other   |            | 56.32      |            |       | 19.21

Nlocal:         625.25 ave         876 max         375 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:           1.75 ave           3 max           1 min
Histogram: 2 0 0 0 0 1 0 0 0 1
Neighs:         337.75 ave         676 max           0 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 1351
Ave neighs/atom = 0.54018393
Neighbor list builds = 164
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 63

#variable lat0 equal 1                    #
variable lat1 equal 3+(100*0.01)+(v_ind*0.01)  # .491+(v_ind*0.001)       # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 500*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.63                                                               
Lattice spacing in x,y,z = 4.63 4.63 4.63

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -3472.5 ${n1e1} -100 100 -100 100 units box
region box block -3472.5 3472.5 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -3472.5 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -3472.5 3472.5 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-3472.5 -100 -100) to (3472.5 100 100)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 1500 atoms
  using lattice units in orthogonal box = (-3472.5 -100 -100) to (3472.5 100 100)
  create_atoms CPU = 0.000 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 1500 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 1001 atoms
  using lattice units in orthogonal box = (-3472.5 -100 -100) to (3472.5 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  1500 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  1500 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  1001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  1001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
1500 atoms in group substrate
group slider1 region slider1
1001 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 1001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_63_*.dump id type diameter mass xu yu zu fx fy fz

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 4481 130 130
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 91.14 | 91.15 | 91.16 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   6945           200            200            0              0              0              0              0              0              0              1.1965779e-13  0              6            
    100000   6945           200            200            0.0029198869   1.1631466e-35  0              0.0087596607   582723.42      0              5.6275256e+10  1.1965779e-13  0              3.3284276    
    200000   6945           200            200            0.0010178854   2.3262991e-35  0              0.0030536563   138440.43      0              1.3369586e+10  1.1965779e-13  0              3.0775785    
    300000   6945           200            200            4.450682e-05   4.9967008e-41  0              0.00013352046  561.94817      0              54268932       1.1965779e-13  0              3.0453792    
    400000   6945           200            200            0.00012728417 -4.6524774e-35  0              0.00038185252  4246.2516      0              4.1007258e+08  1.1965779e-13  0              3.0025416    
    500000   6945           200            200            0.00038156965 -0.00071484239  0              0.0018595513   185.74298      0              17937727       1.1965779e-13  0              2.9978658    
    600000   6945           200            200            0.0030826806  -0.000678111    0              0.0099261527   200.61532      0              19373992       1.1965779e-13  0              2.9951759    
    700000   6945           200            200            0.0030018151  -0.00084070223  0              0.0098461476   18.222462      0              1759795        1.1965779e-13  0              2.9952078    
    800000   6945           200            200            0.0031442162  -0.00078542549  0              0.010218074    0.18125353     0              17504.168      1.1965779e-13  0              2.9951239    
    900000   6945           200            200            0.0032707097  -0.00080166467  0              0.010613794    0.15984585     0              15436.768      1.1965779e-13  0              2.9950324    
   1000000   6945           200            200            0.0033227394  -0.00081346345  0              0.010781682    0.066653003    0              6436.8699      1.1965779e-13  0              2.9949935    
   1100000   6945           200            200            0.0033323486  -0.00081392983  0              0.010810976    0.0053546414   0              517.11294      1.1965779e-13  0              2.9949865    
   1200000   6945           200            200            0.0033296119  -0.00081381057  0              0.010802646    1.3858393e-06  0              0.13383444     1.1965779e-13  0              2.9949883    
   1300000   6945           200            200            0.003326972   -0.00081368856  0              0.010794605    8.621829e-05   0              8.3263453      1.1965779e-13  0              2.9949902    
   1400000   6945           200            200            0.0033260427  -0.00081364442  0              0.010791773    2.2343276e-05  0              2.1577537      1.1965779e-13  0              2.9949908    
   1500000   6945           200            200            0.0033259413  -0.00081363931  0              0.010791463    1.1526888e-06  0              0.11131844     1.1965779e-13  0              2.9949909    
   1600000   6945           200            200            0.0033260168  -0.00081364277  0              0.010791693    1.1908869e-08  0              0.0011500734   1.1965779e-13  0              2.9949909    
   1700000   6945           200            200            0.0033260675  -0.00081364516  0              0.010791848    3.9384681e-08  0              0.0038034906   1.1965779e-13  0              2.9949908    
   1800000   6945           200            200            0.0033260823  -0.00081364587  0              0.010791893    6.8766439e-09  0              0.00066409705  1.1965779e-13  0              2.9949908    
   1900000   6945           200            200            0.0033260828  -0.0008136459   0              0.010791894    1.9712881e-10  0              1.903729e-05   1.1965779e-13  0              2.9949908    
   2000000   6945           200            200            0.003326081   -0.00081364581  0              0.010791889    1.8263868e-11  0              1.7637936e-06  1.1965779e-13  0              2.9949908    
   2100000   6945           200            200            0.0033260801  -0.00081364577  0              0.010791886    1.5968798e-11  0              1.5421522e-06  1.1965779e-13  0              2.9949908    
   2200000   6945           200            200            0.0033260798  -0.00081364576  0              0.010791885    1.9311127e-12  0              1.8649304e-07  1.1965779e-13  0              2.9949908    
   2300000   6945           200            200            0.0033260799  -0.00081364576  0              0.010791885    2.1085932e-14  0              2.0363283e-09  1.1965779e-13  0              2.9949908    
   2400000   6945           200            200            0.0033260799  -0.00081364576  0              0.010791885    1.3416911e-14  0              1.2957093e-09  1.1965779e-13  0              2.9949908    
   2500000   6945           200            200            0.0033260799  -0.00081364576  0              0.010791886    5.8750713e-15  0              5.6737233e-10  1.1965779e-13  0              2.9949908    
   2600000   6945           200            200            0.0033260799  -0.00081364576  0              0.010791886    5.1818254e-16  0              5.0042361e-11  1.1965779e-13  0              2.9949908    
   2700000   6945           200            200            0.0033260799  -0.00081364576  0              0.010791886    2.4643515e-19  0              2.3798943e-14  1.1965779e-13  0              2.9949908    
   2800000   6945           200            200            0.0033260799  -0.00081364576  0              0.010791886    9.8683871e-18  0              9.5301819e-13  1.1965779e-13  0              2.9949908    
   2900000   6945           200            200            0.0033260799  -0.00081364576  0              0.010791886    6.5845969e-18  0              6.3589324e-13  1.1965779e-13  0              2.9949908    
   3000000   6945           200            200            0.0033260799  -0.00081364576  0              0.010791886    6.7230255e-18  0              6.4926168e-13  1.1965779e-13  0              2.9949908    
Loop time of 293.454 on 4 procs for 3000000 steps with 2501 atoms

Performance: 8832725.707 ns/day, 0.000 hours/ns, 10223.062 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 11.001     | 37.177     | 63.912     | 426.1 | 12.67
Neigh   | 4.2701     | 4.3525     | 4.4357     |   3.5 |  1.48
Comm    | 19.042     | 38.136     | 77.358     | 371.6 | 13.00
Output  | 0.27291    | 0.27322    | 0.27355    |   0.1 |  0.09
Modify  | 109.12     | 157.36     | 176.56     | 223.4 | 53.62
Other   |            | 56.15      |            |       | 19.14

Nlocal:         625.25 ave         876 max         375 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:           1.75 ave           3 max           1 min
Histogram: 2 0 0 0 0 1 0 0 0 1
Neighs:         335.25 ave         671 max           0 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 1341
Ave neighs/atom = 0.53618553
Neighbor list builds = 164
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 64

#variable lat0 equal 1                    #
variable lat1 equal 3+(100*0.01)+(v_ind*0.01)  # .491+(v_ind*0.001)       # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 500*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.64                                                               
Lattice spacing in x,y,z = 4.64 4.64 4.64

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -3480 ${n1e1} -100 100 -100 100 units box
region box block -3480 3480 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -3480 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -3480 3480 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-3480 -100 -100) to (3480 100 100)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 1500 atoms
  using lattice units in orthogonal box = (-3480 -100 -100) to (3480 100 100)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 1500 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 1001 atoms
  using lattice units in orthogonal box = (-3480 -100 -100) to (3480 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  1500 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  1500 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  1001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  1001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
1500 atoms in group substrate
group slider1 region slider1
1001 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 1001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_64_*.dump id type diameter mass xu yu zu fx fy fz

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 4491 130 130
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 91.28 | 91.29 | 91.29 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   6960           200            200            0              0              0              0              0              0              0              1.1965779e-13  0              6            
    100000   6960           200            200            0.0029132549  -1.0445603e-34  0              0.0087397648   582619.98      0              5.6265267e+10  1.1965779e-13  0              3.3285227    
    200000   6960           200            200            0.0010150695   5.8031542e-36  0              0.0030452086   138308.07      0              1.3356803e+10  1.1965779e-13  0              3.0776773    
    300000   6960           200            200            4.2698548e-05  1.1606245e-34  0              0.00012809564  520.69591      0              50285084       1.1965779e-13  0              3.0453781    
    400000   6960           200            200            0.0001181851  -2.3212054e-35  0              0.0003545553   3714.1644      0              3.5868741e+08  1.1965779e-13  0              3.0030792    
    500000   6960           200            200            0.001706281    0.0015786147   0              0.0035402283   769.83676      0              74345324       1.1965779e-13  0              2.9971086    
    600000   6960           200            200            0.0059869342   0.0027783144   0              0.015182488    18.207772      0              1758376.3      1.1965779e-13  0              2.9940733    
    700000   6960           200            200            0.0049626198   0.0026574006   0              0.012230459    5.6653213      0              547116.18      1.1965779e-13  0              2.9946902    
    800000   6960           200            200            0.0045437431   0.0025801283   0              0.011051101    2.8625272      0              276442.38      1.1965779e-13  0              2.994954     
    900000   6960           200            200            0.004433478    0.0025647001   0              0.010735734    0.49342628     0              47651.578      1.1965779e-13  0              2.9950276    
   1000000   6960           200            200            0.0044249593   0.0025637606   0              0.010711117    0.032823325    0              3169.8417      1.1965779e-13  0              2.9950339    
   1100000   6960           200            200            0.0044347973   0.0025647058   0              0.010739686    0.00010668926  0              10.303285      1.1965779e-13  0              2.9950275    
   1200000   6960           200            200            0.0044416798   0.0025653786   0              0.010759661    0.00034078661  0              32.910731      1.1965779e-13  0              2.995023     
   1300000   6960           200            200            0.0044443449   0.0025656412   0              0.010767394    0.00014626959  0              14.12567       1.1965779e-13  0              2.9950212    
   1400000   6960           200            200            0.0044449614   0.0025657029   0              0.010769181    2.0433439e-05  0              1.9733153      1.1965779e-13  0              2.9950207    
   1500000   6960           200            200            0.0044449593   0.0025657033   0              0.010769175    9.78381e-07    0              0.094485034    1.1965779e-13  0              2.9950207    
   1600000   6960           200            200            0.004444875    0.0025656953   0              0.01076893     1.3121913e-09  0              0.00012672204  1.1965779e-13  0              2.9950208    
   1700000   6960           200            200            0.0044448264   0.0025656905   0              0.010768789    2.3828943e-08  0              0.0023012287   1.1965779e-13  0              2.9950208    
   1800000   6960           200            200            0.0044448096   0.0025656889   0              0.01076874     7.1545264e-09  0              0.00069093295  1.1965779e-13  0              2.9950208    
   1900000   6960           200            200            0.0044448064   0.0025656886   0              0.010768731    7.9578251e-10  0              7.6850979e-05  1.1965779e-13  0              2.9950208    
   2000000   6960           200            200            0.0044448068   0.0025656886   0              0.010768732    2.4452205e-11  0              2.361419e-06   1.1965779e-13  0              2.9950208    
   2100000   6960           200            200            0.0044448075   0.0025656887   0              0.010768734    8.7930549e-13  0              8.491703e-08   1.1965779e-13  0              2.9950208    
   2200000   6960           200            200            0.0044448078   0.0025656887   0              0.010768735    1.4649592e-12  0              1.4147527e-07  1.1965779e-13  0              2.9950208    
   2300000   6960           200            200            0.0044448079   0.0025656887   0              0.010768735    3.3065087e-13  0              3.1931895e-08  1.1965779e-13  0              2.9950208    
   2400000   6960           200            200            0.004444808    0.0025656887   0              0.010768735    2.904586e-14   0              2.8050413e-09  1.1965779e-13  0              2.9950208    
   2500000   6960           200            200            0.004444808    0.0025656887   0              0.010768735    4.451906e-16   0              4.2993322e-11  1.1965779e-13  0              2.9950208    
   2600000   6960           200            200            0.0044448079   0.0025656887   0              0.010768735    1.0477778e-16  0              1.0118688e-11  1.1965779e-13  0              2.9950208    
   2700000   6960           200            200            0.0044448079   0.0025656887   0              0.010768735    8.2092212e-17  0              7.9278782e-12  1.1965779e-13  0              2.9950208    
   2800000   6960           200            200            0.0044448079   0.0025656887   0              0.010768735    1.1138655e-17  0              1.0756916e-12  1.1965779e-13  0              2.9950208    
   2900000   6960           200            200            0.0044448079   0.0025656887   0              0.010768735    1.3861728e-18  0              1.3386665e-13  1.1965779e-13  0              2.9950208    
   3000000   6960           200            200            0.0044448079   0.0025656887   0              0.010768735    1.3463936e-18  0              1.3002506e-13  1.1965779e-13  0              2.9950208    
Loop time of 297.061 on 4 procs for 3000000 steps with 2501 atoms

Performance: 8725476.746 ns/day, 0.000 hours/ns, 10098.931 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 11.079     | 37.229     | 63.833     | 425.9 | 12.53
Neigh   | 4.2831     | 4.3647     | 4.4475     |   3.4 |  1.47
Comm    | 17.846     | 25.046     | 31.243     | 113.6 |  8.43
Output  | 0.27235    | 0.27268    | 0.27298    |   0.1 |  0.09
Modify  | 169.71     | 173.77     | 177.76     |  25.0 | 58.49
Other   |            | 56.38      |            |       | 18.98

Nlocal:         625.25 ave         876 max         374 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:           1.75 ave           2 max           1 min
Histogram: 1 0 0 0 0 0 0 0 0 3
Neighs:         333.75 ave         668 max           0 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 1335
Ave neighs/atom = 0.53378649
Neighbor list builds = 164
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 65

#variable lat0 equal 1                    #
variable lat1 equal 3+(100*0.01)+(v_ind*0.01)  # .491+(v_ind*0.001)       # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 500*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.65                                                               
Lattice spacing in x,y,z = 4.65 4.65 4.65

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -3487.5 ${n1e1} -100 100 -100 100 units box
region box block -3487.5 3487.5 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -3487.5 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -3487.5 3487.5 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-3487.5 -100 -100) to (3487.5 100 100)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 1499 atoms
  using lattice units in orthogonal box = (-3487.5 -100 -100) to (3487.5 100 100)
  create_atoms CPU = 0.000 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 1500 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 1001 atoms
  using lattice units in orthogonal box = (-3487.5 -100 -100) to (3487.5 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  1499 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  1499 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  1001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  1001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
1499 atoms in group substrate
group slider1 region slider1
1001 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 1001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_65_*.dump id type diameter mass xu yu zu fx fy fz

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 4500 130 130
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 91.49 | 91.5 | 91.5 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   6975           200            200            0              0              0              0              0              0              0              1.1965779e-13  0              6            
    100000   6975           200            200            0.002907163    2.1714883e-36  0              0.0087214889   582684.54      0              5.6384271e+10  1.1965779e-13  0              3.3283796    
    200000   6975           200            200            0.0010131897  -1.2739388e-34  0              0.0030395692   138376.03      0              1.3390147e+10  1.1965779e-13  0              3.0775559    
    300000   6975           200            200            4.0133834e-05  4.6326818e-35  0              0.0001204015   463.62109      0              44862932       1.1965779e-13  0              3.0454018    
    400000   6975           200            200            0.00012309569  2.8953195e-36  0              0.00036928708  4022.5402      0              3.8924664e+08  1.1965779e-13  0              3.0027601    
    500000   6975           200            200            0.00067291919 -1.1076288e-15  0              0.0020187576   7.0702031      0              684157.93      1.1965779e-13  0              2.9979862    
    600000   6975           200            200            0.005290286    0.00030406692  0              0.015566791    24.075004      0              2329650.9      1.1965779e-13  0              2.9939185    
    700000   6975           200            200            0.0040265889   0.00020088932  0              0.011878877    16.709354      0              1616903.6      1.1965779e-13  0              2.994585     
    800000   6975           200            200            0.0034727748   0.00017388891  0              0.010244435    1.4531857      0              140619.51      1.1965779e-13  0              2.9949175    
    900000   6975           200            200            0.0035998926   0.00017654007  0              0.010623138    0.37265178     0              36060.162      1.1965779e-13  0              2.9948411    
   1000000   6975           200            200            0.0036669087   0.00017786942  0              0.010822857    0.012441523    0              1203.921       1.1965779e-13  0              2.9947997    
   1100000   6975           200            200            0.0036439089   0.00017743606  0              0.010754291    0.0085147306   0              823.93961      1.1965779e-13  0              2.9948134    
   1200000   6975           200            200            0.0036369313   0.00017729749  0              0.010733496    4.6521164e-05  0              4.5016844      1.1965779e-13  0              2.9948178    
   1300000   6975           200            200            0.003640647    0.00017736907  0              0.010744572    0.00017005036  0              16.455157      1.1965779e-13  0              2.9948155    
   1400000   6975           200            200            0.003641258    0.00017738141  0              0.010746392    5.723806e-08   0              0.0055387196   1.1965779e-13  0              2.9948151    
   1500000   6975           200            200            0.0036407028   0.00017737068  0              0.010744738    3.0144704e-06  0              0.29169937     1.1965779e-13  0              2.9948155    
   1600000   6975           200            200            0.0036406698   0.00017736997  0              0.010744639    3.4786034e-08  0              0.0033661185   1.1965779e-13  0              2.9948155    
   1700000   6975           200            200            0.0036407476   0.00017737148  0              0.010744871    4.7272805e-08  0              0.004574418    1.1965779e-13  0              2.9948154    
   1800000   6975           200            200            0.0036407451   0.00017737144  0              0.010744864    1.9762389e-09  0              0.00019123348  1.1965779e-13  0              2.9948154    
   1900000   6975           200            200            0.0036407348   0.00017737124  0              0.010744833    6.4278342e-10  0              6.2199822e-05  1.1965779e-13  0              2.9948155    
   2000000   6975           200            200            0.0036407361   0.00017737126  0              0.010744837    6.7966417e-11  0              6.5768638e-06  1.1965779e-13  0              2.9948155    
   2100000   6975           200            200            0.0036407374   0.00017737129  0              0.010744841    7.2073243e-12  0              6.9742664e-07  1.1965779e-13  0              2.9948155    
   2200000   6975           200            200            0.0036407371   0.00017737128  0              0.01074484     1.8221301e-12  0              1.7632093e-07  1.1965779e-13  0              2.9948155    
   2300000   6975           200            200            0.0036407369   0.00017737128  0              0.010744839    5.8525117e-14  0              5.6632635e-09  1.1965779e-13  0              2.9948155    
   2400000   6975           200            200            0.003640737    0.00017737128  0              0.01074484     4.1360411e-14  0              4.002297e-09   1.1965779e-13  0              2.9948155    
   2500000   6975           200            200            0.003640737    0.00017737128  0              0.01074484     2.147193e-16   0              2.0777609e-11  1.1965779e-13  0              2.9948155    
   2600000   6975           200            200            0.003640737    0.00017737128  0              0.01074484     8.1652517e-16  0              7.9012181e-11  1.1965779e-13  0              2.9948155    
   2700000   6975           200            200            0.003640737    0.00017737128  0              0.01074484     1.556368e-19   0              1.5060409e-14  1.1965779e-13  0              2.9948155    
   2800000   6975           200            200            0.003640737    0.00017737128  0              0.01074484     9.7622513e-18  0              9.4465767e-13  1.1965779e-13  0              2.9948155    
   2900000   6975           200            200            0.003640737    0.00017737128  0              0.01074484     2.5027734e-19  0              2.4218431e-14  1.1965779e-13  0              2.9948155    
   3000000   6975           200            200            0.003640737    0.00017737128  0              0.01074484     2.3016095e-18  0              2.2271841e-13  1.1965779e-13  0              2.9948155    
Loop time of 293.671 on 4 procs for 3000000 steps with 2500 atoms

Performance: 8826193.612 ns/day, 0.000 hours/ns, 10215.502 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 10.276     | 37.546     | 64.554     | 438.5 | 12.79
Neigh   | 4.3106     | 4.3874     | 4.4652     |   3.1 |  1.49
Comm    | 25.019     | 52.649     | 78.772     | 359.8 | 17.93
Output  | 0.27024    | 0.27055    | 0.27087    |   0.1 |  0.09
Modify  | 108.85     | 142.88     | 177.2      | 280.7 | 48.65
Other   |            | 55.94      |            |       | 19.05

Nlocal:            625 ave         876 max         375 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:            1.5 ave           4 max           0 min
Histogram: 2 0 0 0 0 1 0 0 0 1
Neighs:         338.75 ave         678 max           0 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 1355
Ave neighs/atom = 0.542
Neighbor list builds = 164
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 66

#variable lat0 equal 1                    #
variable lat1 equal 3+(100*0.01)+(v_ind*0.01)  # .491+(v_ind*0.001)       # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 500*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.66                                                               
Lattice spacing in x,y,z = 4.66 4.66 4.66

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -3495 ${n1e1} -100 100 -100 100 units box
region box block -3495 3495 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -3495 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -3495 3495 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-3495 -100 -100) to (3495 100 100)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 1500 atoms
  using lattice units in orthogonal box = (-3495 -100 -100) to (3495 100 100)
  create_atoms CPU = 0.000 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 1500 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 1001 atoms
  using lattice units in orthogonal box = (-3495 -100 -100) to (3495 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  1500 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  1500 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  1001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  1001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
1500 atoms in group substrate
group slider1 region slider1
1001 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 1001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_66_*.dump id type diameter mass xu yu zu fx fy fz

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 4510 130 130
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 91.57 | 91.6 | 91.63 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   6990           200            200            0              0              0              0              0              0              0              1.1965779e-13  0              6            
    100000   6990           200            200            0.0029005733   2.8904192e-41  0              0.0087017198   582572.97      0              5.6260728e+10  1.1965779e-13  0              3.3285108    
    200000   6990           200            200            0.0010100741   2.3113003e-35  0              0.0030302222   138172.56      0              1.3343717e+10  1.1965779e-13  0              3.0777581    
    300000   6990           200            200            4.1460435e-05 -4.6225366e-35  0              0.0001243813   495.92718      0              47893098       1.1965779e-13  0              3.045346     
    400000   6990           200            200            0.00011667192  3.4669346e-35  0              0.00035001577  3655.3137      0              3.5300404e+08  1.1965779e-13  0              3.0030939    
    500000   6990           200            200            0.00090072346 -0.00081692397  0              0.0035190944   766.51616      0              74024645       1.1965779e-13  0              2.9970645    
    600000   6990           200            200            0.003575592   -0.00421118     0              0.014937956    31.187064      0              3011823.4      1.1965779e-13  0              2.9940569    
    700000   6990           200            200            0.0028947813  -0.0036518875   0              0.012336231    0.09566964     0              9239.089       1.1965779e-13  0              2.9946068    
    800000   6990           200            200            0.0025807846  -0.0035335094   0              0.011275863    0.40814948     0              39416.156      1.1965779e-13  0              2.9948474    
    900000   6990           200            200            0.0024647934  -0.0035080455   0              0.010902426    0.14940128     0              14428.106      1.1965779e-13  0              2.9949339    
   1000000   6990           200            200            0.0024259408  -0.0034988634   0              0.010776686    0.03565899     0              3443.69        1.1965779e-13  0              2.9949631    
   1100000   6990           200            200            0.0024136654  -0.0034959128   0              0.010736909    0.0068424053   0              660.79053      1.1965779e-13  0              2.9949723    
   1200000   6990           200            200            0.0024101206  -0.0034950628   0              0.010725424    0.0011297495   0              109.10312      1.1965779e-13  0              2.994975     
   1300000   6990           200            200            0.002409243   -0.0034948558   0              0.010722585    0.00016509334  0              15.943533      1.1965779e-13  0              2.9949756    
   1400000   6990           200            200            0.0024090942  -0.0034948228   0              0.010722105    2.1558004e-05  0              2.0819177      1.1965779e-13  0              2.9949757    
   1500000   6990           200            200            0.0024091063  -0.0034948271   0              0.010722146    2.5058487e-06  0              0.24199693     1.1965779e-13  0              2.9949757    
   1600000   6990           200            200            0.002409135   -0.0034948347   0              0.01072224     2.5432687e-07  0              0.024561069    1.1965779e-13  0              2.9949757    
   1700000   6990           200            200            0.0024091539  -0.0034948395   0              0.010722301    2.1510623e-08  0              0.002077342    1.1965779e-13  0              2.9949757    
   1800000   6990           200            200            0.0024091635  -0.0034948419   0              0.010722332    1.3490089e-09  0              0.00013027763  1.1965779e-13  0              2.9949757    
   1900000   6990           200            200            0.0024091678  -0.003494843    0              0.010722346    4.1610616e-11  0              4.0184555e-06  1.1965779e-13  0              2.9949757    
   2000000   6990           200            200            0.0024091696  -0.0034948434   0              0.010722352    1.1981546e-13  0              1.157092e-08   1.1965779e-13  0              2.9949757    
   2100000   6990           200            200            0.0024091703  -0.0034948436   0              0.010722354    1.2475388e-12  0              1.2047837e-07  1.1965779e-13  0              2.9949757    
   2200000   6990           200            200            0.0024091705  -0.0034948437   0              0.010722355    5.6426088e-13  0              5.4492277e-08  1.1965779e-13  0              2.9949757    
   2300000   6990           200            200            0.0024091706  -0.0034948437   0              0.010722356    1.4884841e-13  0              1.4374714e-08  1.1965779e-13  0              2.9949757    
   2400000   6990           200            200            0.0024091706  -0.0034948437   0              0.010722356    3.0394342e-14  0              2.935268e-09   1.1965779e-13  0              2.9949757    
   2500000   6990           200            200            0.0024091707  -0.0034948437   0              0.010722356    5.2726562e-15  0              5.0919539e-10  1.1965779e-13  0              2.9949757    
   2600000   6990           200            200            0.0024091707  -0.0034948437   0              0.010722356    7.9609067e-16  0              7.6880739e-11  1.1965779e-13  0              2.9949757    
   2700000   6990           200            200            0.0024091707  -0.0034948437   0              0.010722356    1.0523207e-16  0              1.0162561e-11  1.1965779e-13  0              2.9949757    
   2800000   6990           200            200            0.0024091707  -0.0034948437   0              0.010722356    1.4153416e-17  0              1.3668356e-12  1.1965779e-13  0              2.9949757    
   2900000   6990           200            200            0.0024091707  -0.0034948437   0              0.010722356    1.7474052e-18  0              1.6875189e-13  1.1965779e-13  0              2.9949757    
   3000000   6990           200            200            0.0024091707  -0.0034948437   0              0.010722356    1.523335e-19   0              1.4711279e-14  1.1965779e-13  0              2.9949757    
Loop time of 295.358 on 4 procs for 3000000 steps with 2501 atoms

Performance: 8775776.669 ns/day, 0.000 hours/ns, 10157.149 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 11.054     | 37.168     | 64.031     | 425.8 | 12.58
Neigh   | 4.3051     | 4.3829     | 4.461      |   3.3 |  1.48
Comm    | 19.172     | 38.565     | 77.959     | 371.4 | 13.06
Output  | 0.27488    | 0.2752     | 0.27552    |   0.1 |  0.09
Modify  | 109.82     | 158.36     | 177.64     | 224.1 | 53.62
Other   |            | 56.61      |            |       | 19.17

Nlocal:         625.25 ave         876 max         375 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:           1.75 ave           3 max           1 min
Histogram: 2 0 0 0 0 1 0 0 0 1
Neighs:         335.25 ave         671 max           0 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 1341
Ave neighs/atom = 0.53618553
Neighbor list builds = 164
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 67

#variable lat0 equal 1                    #
variable lat1 equal 3+(100*0.01)+(v_ind*0.01)  # .491+(v_ind*0.001)       # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 500*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.67                                                               
Lattice spacing in x,y,z = 4.67 4.67 4.67

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -3502.5 ${n1e1} -100 100 -100 100 units box
region box block -3502.5 3502.5 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -3502.5 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -3502.5 3502.5 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-3502.5 -100 -100) to (3502.5 100 100)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 1500 atoms
  using lattice units in orthogonal box = (-3502.5 -100 -100) to (3502.5 100 100)
  create_atoms CPU = 0.000 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 1500 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 1001 atoms
  using lattice units in orthogonal box = (-3502.5 -100 -100) to (3502.5 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  1500 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  1500 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  1001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  1001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
1500 atoms in group substrate
group slider1 region slider1
1001 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 1001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_67_*.dump id type diameter mass xu yu zu fx fy fz

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 4520 130 130
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 91.77 | 91.78 | 91.78 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   7005           200            200            0              0              0              0              0              0              0              1.1965779e-13  0              6            
    100000   7005           200            200            0.0028942479   5.7658526e-36  0              0.0086827438   582541.62      0              5.62577e+10    1.1965779e-13  0              3.3285128    
    200000   7005           200            200            0.0010072307  -6.9189637e-35  0              0.0030216921   138025.77      0              1.332954e+10   1.1965779e-13  0              3.0778927    
    300000   7005           200            200            3.8418344e-05  4.6127592e-35  0              0.00011525503  429.44432      0              41472659       1.1965779e-13  0              3.0454121    
    400000   7005           200            200            0.00010781861 -2.3063164e-35  0              0.00032345582  3166.9204      0              3.058385e+08   1.1965779e-13  0              3.0036359    
    500000   7005           200            200            0.0015808539  -4.9954748e-05  0              0.0047925164   1056.2584      0              1.0200588e+08  1.1965779e-13  0              2.9966517    
    600000   7005           200            200            0.0045087153  -0.0017611755   0              0.015287321    0.21449195     0              20714.097      1.1965779e-13  0              2.9940491    
    700000   7005           200            200            0.003547445   -0.0013408084   0              0.011983143    10.354063      0              999921.32      1.1965779e-13  0              2.9947488    
    800000   7005           200            200            0.0032061992  -0.0013804501   0              0.010999048    2.772065       0              267706.19      1.1965779e-13  0              2.9949719    
    900000   7005           200            200            0.0031338515  -0.0013505625   0              0.010752117    0.47366407     0              45743.085      1.1965779e-13  0              2.9950286    
   1000000   7005           200            200            0.0031161596  -0.0013487798   0              0.010697259    0.067535637    0              6522.1084      1.1965779e-13  0              2.995041     
   1100000   7005           200            200            0.0031141043  -0.0013485988   0              0.010690912    0.0082331539   0              795.09907      1.1965779e-13  0              2.9950423    
   1200000   7005           200            200            0.0031150274  -0.0013487061   0              0.010693788    0.00084277364  0              81.389045      1.1965779e-13  0              2.9950415    
   1300000   7005           200            200            0.0031159573  -0.0013488064   0              0.010696678    6.8277104e-05  0              6.593714       1.1965779e-13  0              2.9950408    
   1400000   7005           200            200            0.0031164896  -0.0013488628   0              0.010698332    3.6854694e-06  0              0.35591626     1.1965779e-13  0              2.9950404    
   1500000   7005           200            200            0.0031167401  -0.0013488891   0              0.010699109    5.8221437e-08  0              0.0056226096   1.1965779e-13  0              2.9950403    
   1600000   7005           200            200            0.0031168452  -0.0013489      0              0.010699436    7.8319673e-09  0              0.00075635535  1.1965779e-13  0              2.9950402    
   1700000   7005           200            200            0.0031168857  -0.0013489042   0              0.010699561    9.0300531e-09  0              0.0008720579   1.1965779e-13  0              2.9950401    
   1800000   7005           200            200            0.0031169001  -0.0013489057   0              0.010699606    3.0432272e-09  0              0.0002938931   1.1965779e-13  0              2.9950401    
   1900000   7005           200            200            0.0031169048  -0.0013489062   0              0.01069962     6.8320381e-10  0              6.5978933e-05  1.1965779e-13  0              2.9950401    
   2000000   7005           200            200            0.0031169061  -0.0013489063   0              0.010699625    1.2138274e-10  0              1.1722276e-05  1.1965779e-13  0              2.9950401    
   2100000   7005           200            200            0.0031169065  -0.0013489064   0              0.010699626    1.8100493e-11  0              1.748016e-06   1.1965779e-13  0              2.9950401    
   2200000   7005           200            200            0.0031169065  -0.0013489064   0              0.010699626    2.3056507e-12  0              2.2266324e-07  1.1965779e-13  0              2.9950401    
   2300000   7005           200            200            0.0031169065  -0.0013489064   0              0.010699626    2.4845954e-13  0              2.3994444e-08  1.1965779e-13  0              2.9950401    
   2400000   7005           200            200            0.0031169065  -0.0013489064   0              0.010699626    2.1804525e-14  0              2.105725e-09   1.1965779e-13  0              2.9950401    
   2500000   7005           200            200            0.0031169065  -0.0013489064   0              0.010699626    1.366389e-15   0              1.3195607e-10  1.1965779e-13  0              2.9950401    
   2600000   7005           200            200            0.0031169065  -0.0013489064   0              0.010699626    2.9179771e-17  0              2.8179734e-12  1.1965779e-13  0              2.9950401    
   2700000   7005           200            200            0.0031169065  -0.0013489064   0              0.010699626    2.9640315e-19  0              2.8624494e-14  1.1965779e-13  0              2.9950401    
   2800000   7005           200            200            0.0031169065  -0.0013489064   0              0.010699626    2.5685813e-19  0              2.480552e-14   1.1965779e-13  0              2.9950401    
   2900000   7005           200            200            0.0031169065  -0.0013489064   0              0.010699626    2.7941836e-21  0              2.6984225e-16  1.1965779e-13  0              2.9950401    
   3000000   7005           200            200            0.0031169065  -0.0013489064   0              0.010699626    3.5378367e-19  0              3.4165894e-14  1.1965779e-13  0              2.9950401    
Loop time of 294.602 on 4 procs for 3000000 steps with 2501 atoms

Performance: 8798319.619 ns/day, 0.000 hours/ns, 10183.240 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 10.912     | 37.112     | 63.861     | 426.4 | 12.60
Neigh   | 4.3587     | 4.4357     | 4.513      |   3.2 |  1.51
Comm    | 19.496     | 38.393     | 77.484     | 368.9 | 13.03
Output  | 0.27329    | 0.2736     | 0.27392    |   0.1 |  0.09
Modify  | 109.15     | 157.59     | 177.94     | 224.4 | 53.49
Other   |            | 56.8       |            |       | 19.28

Nlocal:         625.25 ave         876 max         375 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:           1.75 ave           3 max           1 min
Histogram: 2 0 0 0 0 1 0 0 0 1
Neighs:         334.25 ave         669 max           0 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 1337
Ave neighs/atom = 0.53458617
Neighbor list builds = 164
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 68

#variable lat0 equal 1                    #
variable lat1 equal 3+(100*0.01)+(v_ind*0.01)  # .491+(v_ind*0.001)       # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 500*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.68                                                               
Lattice spacing in x,y,z = 4.68 4.68 4.68

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -3510 ${n1e1} -100 100 -100 100 units box
region box block -3510 3510 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -3510 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -3510 3510 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-3510 -100 -100) to (3510 100 100)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 1500 atoms
  using lattice units in orthogonal box = (-3510 -100 -100) to (3510 100 100)
  create_atoms CPU = 0.000 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 1500 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 1001 atoms
  using lattice units in orthogonal box = (-3510 -100 -100) to (3510 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  1500 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  1500 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  1001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  1001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
1500 atoms in group substrate
group slider1 region slider1
1001 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 1001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_68_*.dump id type diameter mass xu yu zu fx fy fz

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 4530 130 130
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 91.92 | 91.95 | 91.98 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   7020           200            200            0              0              0              0              0              0              0              1.1965779e-13  0              6            
    100000   7020           200            200            0.0028878349  -9.205524e-35   0              0.0086635046   582470.86      0              5.6250866e+10  1.1965779e-13  0              3.3285806    
    200000   7020           200            200            0.0010052321  -1.1507e-35     0              0.0030156963   138061.08      0              1.3332951e+10  1.1965779e-13  0              3.0778157    
    300000   7020           200            200            4.1733552e-05  6.9042467e-35  0              0.00012520066  506.50265      0              48914401       1.1965779e-13  0              3.0452752    
    400000   7020           200            200            0.00011152526  6.9042518e-35  0              0.00033457577  3387.2676      0              3.2711806e+08  1.1965779e-13  0              3.0033073    
    500000   7020           200            200            0.00089596894 -9.2556435e-05  0              0.0027804632   698.2747       0              67434373       1.1965779e-13  0              2.9971474    
    600000   7020           200            200            0.002033805   -0.00060815971  0              0.0067095748   25.575842      0              2469931.8      1.1965779e-13  0              2.9959583    
    700000   7020           200            200            0.0037691537  -0.0010021218   0              0.012309583    1.110853       0              107278.23      1.1965779e-13  0              2.994635     
    800000   7020           200            200            0.0030442197  -0.00095974859  0              0.010092408    0.16097705     0              15546.011      1.1965779e-13  0              2.9951227    
    900000   7020           200            200            0.0033046241  -0.00097727353  0              0.010891146    0.030178247    0              2914.3991      1.1965779e-13  0              2.9949428    
   1000000   7020           200            200            0.0032092431  -0.00097118393  0              0.010598913    0.0054074927   0              522.21694      1.1965779e-13  0              2.9950081    
   1100000   7020           200            200            0.0032437804  -0.00097343344  0              0.010704775    0.0009415692   0              90.930014      1.1965779e-13  0              2.9949844    
   1200000   7020           200            200            0.0032312563  -0.00097262278  0              0.010666392    0.000158442    0              15.301194      1.1965779e-13  0              2.994993     
   1300000   7020           200            200            0.0032357844  -0.00097291686  0              0.01068027     2.6029585e-05  0              2.513751       1.1965779e-13  0              2.9949899    
   1400000   7020           200            200            0.0032341496  -0.0009728107   0              0.01067526     4.1872039e-06  0              0.40437018     1.1965779e-13  0              2.994991     
   1500000   7020           200            200            0.0032347386  -0.00097284899  0              0.010677065    6.6212701e-07  0              0.063943487    1.1965779e-13  0              2.9949906    
   1600000   7020           200            200            0.0032345268  -0.00097283521  0              0.010676416    1.0316643e-07  0              0.0099630756   1.1965779e-13  0              2.9949907    
   1700000   7020           200            200            0.0032346028  -0.00097284016  0              0.010676649    1.5871315e-08  0              0.001532738    1.1965779e-13  0              2.9949907    
   1800000   7020           200            200            0.0032345756  -0.00097283839  0              0.010676565    2.4145634e-09  0              0.00023318125  1.1965779e-13  0              2.9949907    
   1900000   7020           200            200            0.0032345853  -0.00097283902  0              0.010676595    3.6373502e-10  0              3.5126925e-05  1.1965779e-13  0              2.9949907    
   2000000   7020           200            200            0.0032345819  -0.00097283879  0              0.010676584    5.4311029e-11  0              5.2449704e-06  1.1965779e-13  0              2.9949907    
   2100000   7020           200            200            0.0032345831  -0.00097283887  0              0.010676588    8.0420831e-12  0              7.7664682e-07  1.1965779e-13  0              2.9949907    
   2200000   7020           200            200            0.0032345826  -0.00097283885  0              0.010676587    1.1834778e-12  0              1.1429182e-07  1.1965779e-13  0              2.9949907    
   2300000   7020           200            200            0.0032345828  -0.00097283886  0              0.010676587    1.7319765e-13  0              1.672619e-08   1.1965779e-13  0              2.9949907    
   2400000   7020           200            200            0.0032345827  -0.00097283885  0              0.010676587    2.5071885e-14  0              2.4212632e-09  1.1965779e-13  0              2.9949907    
   2500000   7020           200            200            0.0032345828  -0.00097283885  0              0.010676587    3.5106603e-15  0              3.3903444e-10  1.1965779e-13  0              2.9949907    
   2600000   7020           200            200            0.0032345828  -0.00097283885  0              0.010676587    5.0485e-16     0              4.8754799e-11  1.1965779e-13  0              2.9949907    
   2700000   7020           200            200            0.0032345828  -0.00097283885  0              0.010676587    7.40716e-17    0              7.153305e-12   1.1965779e-13  0              2.9949907    
   2800000   7020           200            200            0.0032345828  -0.00097283885  0              0.010676587    1.2743254e-17  0              1.2306522e-12  1.1965779e-13  0              2.9949907    
   2900000   7020           200            200            0.0032345828  -0.00097283885  0              0.010676587    4.9516938e-18  0              4.7819914e-13  1.1965779e-13  0              2.9949907    
   3000000   7020           200            200            0.0032345828  -0.00097283885  0              0.010676587    6.0534419e-18  0              5.8459809e-13  1.1965779e-13  0              2.9949907    
Loop time of 294.148 on 4 procs for 3000000 steps with 2501 atoms

Performance: 8811887.458 ns/day, 0.000 hours/ns, 10198.944 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 10.941     | 37.29      | 63.815     | 426.5 | 12.68
Neigh   | 4.3414     | 4.4224     | 4.5032     |   3.4 |  1.50
Comm    | 19.437     | 38.281     | 77.175     | 367.7 | 13.01
Output  | 0.27232    | 0.27263    | 0.27297    |   0.1 |  0.09
Modify  | 109.46     | 157.52     | 176.97     | 222.5 | 53.55
Other   |            | 56.37      |            |       | 19.16

Nlocal:         625.25 ave         876 max         375 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:           1.75 ave           3 max           1 min
Histogram: 2 0 0 0 0 1 0 0 0 1
Neighs:         333.25 ave         667 max           0 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 1333
Ave neighs/atom = 0.53298681
Neighbor list builds = 164
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 69

#variable lat0 equal 1                    #
variable lat1 equal 3+(100*0.01)+(v_ind*0.01)  # .491+(v_ind*0.001)       # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 500*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.69                                                               
Lattice spacing in x,y,z = 4.69 4.69 4.69

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -3517.5 ${n1e1} -100 100 -100 100 units box
region box block -3517.5 3517.5 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -3517.5 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -3517.5 3517.5 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-3517.5 -100 -100) to (3517.5 100 100)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 1499 atoms
  using lattice units in orthogonal box = (-3517.5 -100 -100) to (3517.5 100 100)
  create_atoms CPU = 0.000 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 1500 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 1001 atoms
  using lattice units in orthogonal box = (-3517.5 -100 -100) to (3517.5 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  1499 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  1499 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  1001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  1001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
1499 atoms in group substrate
group slider1 region slider1
1001 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 1001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_69_*.dump id type diameter mass xu yu zu fx fy fz

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 4539 130 130
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 92.12 | 92.12 | 92.13 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   7035           200            200            0              0              0              0              0              0              0              1.1965779e-13  0              6            
    100000   7035           200            200            0.0028815118   4.3393438e-41  0              0.0086445354   582419.55      0              5.6358629e+10  1.1965779e-13  0              3.3286295    
    200000   7035           200            200            0.0010022341   4.5931266e-35  0              0.0030067023   137874.44      0              1.334161e+10   1.1965779e-13  0              3.0780194    
    300000   7035           200            200            3.9092929e-05 -3.7318105e-35  0              0.00011727879  447.95302      0              43346790       1.1965779e-13  0              3.0453357    
    400000   7035           200            200            0.00011167649 -9.1858733e-35  0              0.00033502947  3409.3682      0              3.299122e+08   1.1965779e-13  0              3.0033105    
    500000   7035           200            200            0.0020400475   0.00070040524  0              0.0054197371   1156.4647      0              1.1190689e+08  1.1965779e-13  0              2.9963544    
    600000   7035           200            200            0.0052420459   0.0012330207   0              0.014493117    58.502123      0              5661038.4      1.1965779e-13  0              2.9941048    
    700000   7035           200            200            0.0040063088   0.001387079    0              0.010631847    27.552617      0              2666166.9      1.1965779e-13  0              2.994955     
    800000   7035           200            200            0.0038729466   0.0013519824   0              0.010266857    1.9693177      0              190563.74      1.1965779e-13  0              2.9950381    
    900000   7035           200            200            0.0039272389   0.0013348935   0              0.010446823    0.013533904    0              1309.6268      1.1965779e-13  0              2.9949928    
   1000000   7035           200            200            0.0039732033   0.0013348473   0              0.010584763    0.014288899    0              1382.6849      1.1965779e-13  0              2.9949593    
   1100000   7035           200            200            0.0039921218   0.0013352217   0              0.010641144    0.0073690524   0              713.07648      1.1965779e-13  0              2.9949459    
   1200000   7035           200            200            0.003996976    0.0013353223   0              0.010655606    0.0011752842   0              113.72799      1.1965779e-13  0              2.9949425    
   1300000   7035           200            200            0.0039972714   0.0013353277   0              0.010656486    7.3196069e-05  0              7.0829182      1.1965779e-13  0              2.9949423    
   1400000   7035           200            200            0.0039967902   0.0013353171   0              0.010655054    1.6129809e-07  0              0.015608232    1.1965779e-13  0              2.9949427    
   1500000   7035           200            200            0.0039964678   0.0013353101   0              0.010654093    8.4232617e-07  0              0.08150885     1.1965779e-13  0              2.9949429    
   1600000   7035           200            200            0.0039963434   0.0013353075   0              0.010653723    3.5184889e-07  0              0.034047142    1.1965779e-13  0              2.994943     
   1700000   7035           200            200            0.0039963138   0.0013353069   0              0.010653635    5.0448325e-08  0              0.0048817015   1.1965779e-13  0              2.994943     
   1800000   7035           200            200            0.0039963132   0.0013353069   0              0.010653633    2.6960371e-09  0              0.00026088574  1.1965779e-13  0              2.994943     
   1900000   7035           200            200            0.0039963168   0.0013353069   0              0.010653644    4.2584355e-14  0              4.1207337e-09  1.1965779e-13  0              2.994943     
   2000000   7035           200            200            0.0039963191   0.001335307    0              0.01065365     4.7341349e-11  0              4.5810507e-06  1.1965779e-13  0              2.994943     
   2100000   7035           200            200            0.0039963199   0.001335307    0              0.010653653    1.655738e-11   0              1.6021976e-06  1.1965779e-13  0              2.994943     
   2200000   7035           200            200            0.00399632     0.001335307    0              0.010653653    2.1369982e-12  0              2.0678957e-07  1.1965779e-13  0              2.994943     
   2300000   7035           200            200            0.00399632     0.001335307    0              0.010653653    9.5532339e-14  0              9.2443182e-09  1.1965779e-13  0              2.994943     
   2400000   7035           200            200            0.00399632     0.001335307    0              0.010653653    2.6384171e-16  0              2.5531006e-11  1.1965779e-13  0              2.994943     
   2500000   7035           200            200            0.00399632     0.001335307    0              0.010653653    2.5948107e-15  0              2.5109042e-10  1.1965779e-13  0              2.994943     
   2600000   7035           200            200            0.00399632     0.001335307    0              0.010653653    7.7521356e-16  0              7.5014606e-11  1.1965779e-13  0              2.994943     
   2700000   7035           200            200            0.00399632     0.001335307    0              0.010653653    8.8336387e-17  0              8.547992e-12   1.1965779e-13  0              2.994943     
   2800000   7035           200            200            0.00399632     0.001335307    0              0.010653653    5.3689938e-18  0              5.1953807e-13  1.1965779e-13  0              2.994943     
   2900000   7035           200            200            0.00399632     0.001335307    0              0.010653653    1.5283399e-19  0              1.4789191e-14  1.1965779e-13  0              2.994943     
   3000000   7035           200            200            0.00399632     0.001335307    0              0.010653653    4.0798868e-18  0              3.9479586e-13  1.1965779e-13  0              2.994943     
Loop time of 295.068 on 4 procs for 3000000 steps with 2500 atoms

Performance: 8784408.338 ns/day, 0.000 hours/ns, 10167.139 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 10.257     | 37.075     | 64.145     | 430.4 | 12.56
Neigh   | 4.3565     | 4.439      | 4.5217     |   3.5 |  1.50
Comm    | 25.253     | 52.538     | 78.56      | 347.8 | 17.81
Output  | 0.27188    | 0.27221    | 0.27253    |   0.1 |  0.09
Modify  | 110.09     | 144.22     | 178.12     | 280.8 | 48.88
Other   |            | 56.52      |            |       | 19.16

Nlocal:            625 ave         876 max         375 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:            1.5 ave           4 max           0 min
Histogram: 2 0 0 0 0 1 0 0 0 1
Neighs:         333.75 ave         668 max           0 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 1335
Ave neighs/atom = 0.534
Neighbor list builds = 164
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 70

#variable lat0 equal 1                    #
variable lat1 equal 3+(100*0.01)+(v_ind*0.01)  # .491+(v_ind*0.001)       # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 500*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.7                                                               
Lattice spacing in x,y,z = 4.7 4.7 4.7

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -3525 ${n1e1} -100 100 -100 100 units box
region box block -3525 3525 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -3525 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -3525 3525 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-3525 -100 -100) to (3525 100 100)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 1500 atoms
  using lattice units in orthogonal box = (-3525 -100 -100) to (3525 100 100)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 1500 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 1001 atoms
  using lattice units in orthogonal box = (-3525 -100 -100) to (3525 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  1500 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  1500 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  1001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  1001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
1500 atoms in group substrate
group slider1 region slider1
1001 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 1001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_70_*.dump id type diameter mass xu yu zu fx fy fz

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 4549 130 130
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 92.33 | 92.33 | 92.34 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   7050           200            200            0              0              0              0              0              0              0              1.1965779e-13  0              6            
    100000   7050           200            200            0.0028752504   1.7903229e-37  0              0.0086257511   582380.51      0              5.6242141e+10  1.1965779e-13  0              3.3286562    
    200000   7050           200            200            0.0010001509  -1.1458056e-35  0              0.0030004526   137887.1       0              1.331615e+10   1.1965779e-13  0              3.0779659    
    300000   7050           200            200            3.9650493e-05  8.1775621e-41  0              0.00011895148  462.38078      0              44653426       1.1965779e-13  0              3.0452695    
    400000   7050           200            200            0.00011537134  3.4374244e-34  0              0.00034611403  3637.4019      0              3.5127424e+08  1.1965779e-13  0              3.0030227    
    500000   7050           200            200            0.0018569922  -0.0017265089   0              0.0072974855   1360.4874      0              1.3138613e+08  1.1965779e-13  0              2.9957918    
    600000   7050           200            200            0.0018433253  -0.0015197281   0              0.0070497041   32.051525      0              3095306.9      1.1965779e-13  0              2.9959255    
    700000   7050           200            200            0.0034151623  -0.0019174958   0              0.012162983    0.022132893    0              2137.4364      1.1965779e-13  0              2.9945755    
    800000   7050           200            200            0.00275317    -0.0018535748   0              0.010113085    0.44469775     0              42945.725      1.1965779e-13  0              2.9950826    
    900000   7050           200            200            0.0029713085  -0.0018773302   0              0.010791256    0.19198441     0              18540.48       1.1965779e-13  0              2.9949124    
   1000000   7050           200            200            0.0029061926  -0.0018706195   0              0.010589197    0.046042246    0              4446.4306      1.1965779e-13  0              2.9949623    
   1100000   7050           200            200            0.002922125   -0.0018722573   0              0.010638632    0.0082904668   0              800.63395      1.1965779e-13  0              2.9949502    
   1200000   7050           200            200            0.0029197649  -0.001872031    0              0.010631326    0.0012032258   0              116.19894      1.1965779e-13  0              2.9949519    
   1300000   7050           200            200            0.002919268   -0.0018719694   0              0.010629773    0.00014322142  0              13.8313        1.1965779e-13  0              2.9949523    
   1400000   7050           200            200            0.0029199341  -0.0018720431   0              0.010631845    1.3595996e-05  0              1.313004       1.1965779e-13  0              2.9949518    
   1500000   7050           200            200            0.0029195356  -0.0018719999   0              0.010630607    9.2800987e-07  0              0.089620551    1.1965779e-13  0              2.9949521    
   1600000   7050           200            200            0.0029197243  -0.0018720201   0              0.010631193    3.1004835e-08  0              0.0029942251   1.1965779e-13  0              2.994952     
   1700000   7050           200            200            0.0029196462  -0.0018720118   0              0.01063095     4.684063e-11   0              4.5235328e-06  1.1965779e-13  0              2.994952     
   1800000   7050           200            200            0.0029196754  -0.0018720149   0              0.010631041    8.1412093e-10  0              7.8621972e-05  1.1965779e-13  0              2.994952     
   1900000   7050           200            200            0.0029196655  -0.0018720139   0              0.01063101     3.6182842e-10  0              3.4942799e-05  1.1965779e-13  0              2.994952     
   2000000   7050           200            200            0.0029196684  -0.0018720142   0              0.01063102     8.926781e-11   0              8.6208461e-06  1.1965779e-13  0              2.994952     
   2100000   7050           200            200            0.0029196677  -0.0018720141   0              0.010631017    1.6316773e-11  0              1.5757572e-06  1.1965779e-13  0              2.994952     
   2200000   7050           200            200            0.0029196678  -0.0018720141   0              0.010631018    2.3997678e-12  0              2.317524e-07   1.1965779e-13  0              2.994952     
   2300000   7050           200            200            0.0029196678  -0.0018720141   0              0.010631018    2.8961467e-13  0              2.7968912e-08  1.1965779e-13  0              2.994952     
   2400000   7050           200            200            0.0029196678  -0.0018720141   0              0.010631018    2.8060039e-14  0              2.7098378e-09  1.1965779e-13  0              2.994952     
   2500000   7050           200            200            0.0029196678  -0.0018720141   0              0.010631018    1.9154136e-15  0              1.8497694e-10  1.1965779e-13  0              2.994952     
   2600000   7050           200            200            0.0029196678  -0.0018720141   0              0.010631018    5.3388229e-17  0              5.155853e-12   1.1965779e-13  0              2.994952     
   2700000   7050           200            200            0.0029196678  -0.0018720141   0              0.010631018    1.1487303e-19  0              1.1093615e-14  1.1965779e-13  0              2.994952     
   2800000   7050           200            200            0.0029196678  -0.0018720141   0              0.010631018    1.820777e-19   0              1.7583761e-14  1.1965779e-13  0              2.994952     
   2900000   7050           200            200            0.0029196678  -0.0018720141   0              0.010631018    1.0200431e-18  0              9.850846e-14   1.1965779e-13  0              2.994952     
   3000000   7050           200            200            0.0029196678  -0.0018720141   0              0.010631018    4.9968831e-18  0              4.825632e-13   1.1965779e-13  0              2.994952     
Loop time of 294.149 on 4 procs for 3000000 steps with 2501 atoms

Performance: 8811870.365 ns/day, 0.000 hours/ns, 10198.924 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 10.937     | 36.836     | 62.455     | 421.3 | 12.52
Neigh   | 4.3187     | 4.3951     | 4.4723     |   3.2 |  1.49
Comm    | 19.826     | 37.99      | 75.499     | 356.1 | 12.92
Output  | 0.2701     | 0.27041    | 0.27074    |   0.1 |  0.09
Modify  | 110.53     | 157.97     | 177.72     | 219.9 | 53.70
Other   |            | 56.69      |            |       | 19.27

Nlocal:         625.25 ave         876 max         375 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:           1.75 ave           3 max           1 min
Histogram: 2 0 0 0 0 1 0 0 0 1
Neighs:         330.25 ave         661 max           0 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 1321
Ave neighs/atom = 0.52818872
Neighbor list builds = 164
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 71

#variable lat0 equal 1                    #
variable lat1 equal 3+(100*0.01)+(v_ind*0.01)  # .491+(v_ind*0.001)       # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 500*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.71                                                               
Lattice spacing in x,y,z = 4.71 4.71 4.71

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -3532.5 ${n1e1} -100 100 -100 100 units box
region box block -3532.5 3532.5 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -3532.5 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -3532.5 3532.5 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-3532.5 -100 -100) to (3532.5 100 100)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 1500 atoms
  using lattice units in orthogonal box = (-3532.5 -100 -100) to (3532.5 100 100)
  create_atoms CPU = 0.000 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 1500 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 1001 atoms
  using lattice units in orthogonal box = (-3532.5 -100 -100) to (3532.5 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  1500 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  1500 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  1001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  1001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
1500 atoms in group substrate
group slider1 region slider1
1001 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 1001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_71_*.dump id type diameter mass xu yu zu fx fy fz

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 4559 130 130
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 92.46 | 92.47 | 92.48 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   7065           200            200            0              0              0              0              0              0              0              1.1965779e-13  0              6            
    100000   7065           200            200            0.0028689106   6.1384178e-44  0              0.0086067318   582305.18      0              5.6234867e+10  1.1965779e-13  0              3.3287434    
    200000   7065           200            200            0.00099628208  2.1974377e-41  0              0.0029888462   137501.23      0              1.3278885e+10  1.1965779e-13  0              3.0784564    
    300000   7065           200            200            3.5681178e-05 -1.6007167e-34  0              0.00010704353  378.12833      0              36516928       1.1965779e-13  0              3.045448     
    400000   7065           200            200            0.00010488116  9.1470484e-35  0              0.00031464349  3055.6892      0              2.9509659e+08  1.1965779e-13  0              3.003748     
    500000   7065           200            200            0.0019303351   0.00083860476  0              0.0049524005   1092.3415      0              1.0549053e+08  1.1965779e-13  0              2.9965846    
    600000   7065           200            200            0.0063615157   0.0039290025   0              0.015155545    0.41166716     0              39755.868      1.1965779e-13  0              2.9940487    
    700000   7065           200            200            0.0048665239   0.0030148193   0              0.011584752    17.299634      0              1670674.8      1.1965779e-13  0              2.9948178    
    800000   7065           200            200            0.0044943846   0.0029300815   0              0.010553072    3.6711141      0              354529.92      1.1965779e-13  0              2.9950589    
    900000   7065           200            200            0.0044586018   0.0029225668   0              0.010453239    0.22074476     0              21317.949      1.1965779e-13  0              2.9950811    
   1000000   7065           200            200            0.0044869634   0.0029291955   0              0.010531695    9.7139842e-06  0              0.93810707     1.1965779e-13  0              2.9950616    
   1100000   7065           200            200            0.0045072128   0.0029337431   0              0.010587895    0.0042409401   0              409.55964      1.1965779e-13  0              2.995048     
   1200000   7065           200            200            0.0045143873   0.0029353195   0              0.010607843    0.001219945    0              117.81356      1.1965779e-13  0              2.9950432    
   1300000   7065           200            200            0.0045155493   0.0029355662   0              0.010611082    0.00010346973  0              9.9923663      1.1965779e-13  0              2.9950425    
   1400000   7065           200            200            0.0045152123   0.0029354881   0              0.010610149    6.5656793e-07  0              0.063406631    1.1965779e-13  0              2.9950427    
   1500000   7065           200            200            0.0045148728   0.0029354124   0              0.010609206    8.6845755e-07  0              0.083869414    1.1965779e-13  0              2.995043     
   1600000   7065           200            200            0.004514734    0.0029353819   0              0.01060882     3.7825377e-07  0              0.036529041    1.1965779e-13  0              2.9950431    
   1700000   7065           200            200            0.0045147044   0.0029353755   0              0.010608738    4.331099e-08   0              0.0041826654   1.1965779e-13  0              2.9950431    
   1800000   7065           200            200            0.0045147071   0.0029353762   0              0.010608745    9.0057569e-10  0              8.6971154e-05  1.1965779e-13  0              2.9950431    
   1900000   7065           200            200            0.0045147125   0.0029353774   0              0.01060876     1.387002e-10   0              1.3394673e-05  1.1965779e-13  0              2.9950431    
   2000000   7065           200            200            0.0045147151   0.002935378    0              0.010608767    1.0896662e-10  0              1.0523216e-05  1.1965779e-13  0              2.9950431    
   2100000   7065           200            200            0.0045147158   0.0029353781   0              0.010608769    1.662216e-11   0              1.6052492e-06  1.1965779e-13  0              2.9950431    
   2200000   7065           200            200            0.0045147158   0.0029353781   0              0.010608769    6.4732263e-13  0              6.2513786e-08  1.1965779e-13  0              2.9950431    
   2300000   7065           200            200            0.0045147157   0.0029353781   0              0.010608769    1.2600066e-14  0              1.2168242e-09  1.1965779e-13  0              2.9950431    
   2400000   7065           200            200            0.0045147157   0.0029353781   0              0.010608769    2.8769398e-14  0              2.7783425e-09  1.1965779e-13  0              2.9950431    
   2500000   7065           200            200            0.0045147157   0.0029353781   0              0.010608769    5.9050808e-15  0              5.7027044e-10  1.1965779e-13  0              2.9950431    
   2600000   7065           200            200            0.0045147157   0.0029353781   0              0.010608769    3.3141102e-16  0              3.2005304e-11  1.1965779e-13  0              2.9950431    
   2700000   7065           200            200            0.0045147157   0.0029353781   0              0.010608769    5.5709751e-20  0              5.380049e-15   1.1965779e-13  0              2.9950431    
   2800000   7065           200            200            0.0045147157   0.0029353781   0              0.010608769    3.6295371e-18  0              3.5051471e-13  1.1965779e-13  0              2.9950431    
   2900000   7065           200            200            0.0045147157   0.0029353781   0              0.010608769    9.6391791e-19  0              9.3088293e-14  1.1965779e-13  0              2.9950431    
   3000000   7065           200            200            0.0045147157   0.0029353781   0              0.010608769    1.9884279e-18  0              1.9202813e-13  1.1965779e-13  0              2.9950431    
Loop time of 297.371 on 4 procs for 3000000 steps with 2501 atoms

Performance: 8716386.315 ns/day, 0.000 hours/ns, 10088.410 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 10.987     | 37.769     | 64.373     | 428.5 | 12.70
Neigh   | 4.3945     | 4.4762     | 4.5587     |   3.4 |  1.51
Comm    | 19.812     | 38.537     | 76.8       | 361.2 | 12.96
Output  | 0.27238    | 0.27268    | 0.27302    |   0.1 |  0.09
Modify  | 112.38     | 159.77     | 178.66     | 217.5 | 53.73
Other   |            | 56.55      |            |       | 19.02

Nlocal:         625.25 ave         876 max         375 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:           1.75 ave           3 max           1 min
Histogram: 2 0 0 0 0 1 0 0 0 1
Neighs:         333.75 ave         668 max           0 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 1335
Ave neighs/atom = 0.53378649
Neighbor list builds = 164
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 72

#variable lat0 equal 1                    #
variable lat1 equal 3+(100*0.01)+(v_ind*0.01)  # .491+(v_ind*0.001)       # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 500*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.72                                                               
Lattice spacing in x,y,z = 4.72 4.72 4.72

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -3540 ${n1e1} -100 100 -100 100 units box
region box block -3540 3540 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -3540 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -3540 3540 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-3540 -100 -100) to (3540 100 100)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 1500 atoms
  using lattice units in orthogonal box = (-3540 -100 -100) to (3540 100 100)
  create_atoms CPU = 0.000 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 1500 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 1001 atoms
  using lattice units in orthogonal box = (-3540 -100 -100) to (3540 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  1500 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  1500 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  1001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  1001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
1500 atoms in group substrate
group slider1 region slider1
1001 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 1001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_72_*.dump id type diameter mass xu yu zu fx fy fz

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 4568 130 130
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 92.6 | 92.61 | 92.62 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   7080           200            200            0              0              0              0              0              0              0              1.1965779e-13  0              6            
    100000   7080           200            200            0.0028626794   2.8523788e-36  0              0.0085880382   582256.22      0              5.6230138e+10  1.1965779e-13  0              3.3287991    
    200000   7080           200            200            0.00099397995 -1.1409384e-35  0              0.0029819399   137459.73      0              1.3274877e+10  1.1965779e-13  0              3.0784909    
    300000   7080           200            200            3.566076e-05   1.1409619e-35  0              0.00010698228  379.27429      0              36627596       1.1965779e-13  0              3.045431     
    400000   7080           200            200            0.00010537685 -1.1409437e-35  0              0.00031613056  3095.1019      0              2.9890279e+08  1.1965779e-13  0              3.0036902    
    500000   7080           200            200            0.0018528287   0.00093659055  0              0.0046218955   1031.1531      0              99581388       1.1965779e-13  0              2.9966797    
    600000   7080           200            200            0.0049083858  -0.00040364033  0              0.015128798    1.61182        0              155658.04      1.1965779e-13  0              2.9940353    
    700000   7080           200            200            0.004103053    0.00016307536  0              0.012146084    1.892532       0              182767.19      1.1965779e-13  0              2.9946642    
    800000   7080           200            200            0.0037366879   0.00024916875  0              0.010960895    2.1662619      0              209202.07      1.1965779e-13  0              2.9949317    
    900000   7080           200            200            0.0036201917   0.00026444194  0              0.010596133    0.50260058     0              48537.567      1.1965779e-13  0              2.9950176    
   1000000   7080           200            200            0.0036023829   0.00026581342  0              0.010541335    0.046128784    0              4454.7878      1.1965779e-13  0              2.9950311    
   1100000   7080           200            200            0.0036080654   0.00026541722  0              0.010558779    0.00084058044  0              81.177243      1.1965779e-13  0              2.9950273    
   1200000   7080           200            200            0.0036137856   0.00026500245  0              0.010576354    0.00014807176  0              14.299711      1.1965779e-13  0              2.9950232    
   1300000   7080           200            200            0.0036163384   0.00026481595  0              0.010584199    0.00012022104  0              11.610088      1.1965779e-13  0              2.9950213    
   1400000   7080           200            200            0.0036170466   0.00026476357  0              0.010586376    2.22229e-05    0              2.1461287      1.1965779e-13  0              2.9950208    
   1500000   7080           200            200            0.0036171127   0.0002647583   0              0.01058658     1.5719292e-06  0              0.15180567     1.1965779e-13  0              2.9950208    
   1600000   7080           200            200            0.0036170555   0.00026476231  0              0.010586404    8.2853903e-09  0              0.0008001437   1.1965779e-13  0              2.9950208    
   1700000   7080           200            200            0.0036170135   0.00026476534  0              0.010586275    1.3525074e-08  0              0.0013061549   1.1965779e-13  0              2.9950208    
   1800000   7080           200            200            0.0036169968   0.00026476656  0              0.010586224    6.3486114e-09  0              0.00061310345  1.1965779e-13  0              2.9950208    
   1900000   7080           200            200            0.0036169928   0.00026476685  0              0.010586212    9.3018187e-10  0              8.9830307e-05  1.1965779e-13  0              2.9950208    
   2000000   7080           200            200            0.0036169927   0.00026476686  0              0.010586211    4.807164e-11   0              4.6424149e-06  1.1965779e-13  0              2.9950208    
   2100000   7080           200            200            0.0036169932   0.00026476683  0              0.010586213    8.8720171e-15  0              8.567959e-10   1.1965779e-13  0              2.9950208    
   2200000   7080           200            200            0.0036169935   0.00026476681  0              0.010586214    9.7835726e-13  0              9.4482741e-08  1.1965779e-13  0              2.9950208    
   2300000   7080           200            200            0.0036169937   0.0002647668   0              0.010586214    3.1436611e-13  0              3.0359228e-08  1.1965779e-13  0              2.9950208    
   2400000   7080           200            200            0.0036169937   0.0002647668   0              0.010586214    3.6951751e-14  0              3.5685356e-09  1.1965779e-13  0              2.9950208    
   2500000   7080           200            200            0.0036169937   0.0002647668   0              0.010586214    1.2688679e-15  0              1.2253818e-10  1.1965779e-13  0              2.9950208    
   2600000   7080           200            200            0.0036169937   0.0002647668   0              0.010586214    2.267617e-17   0              2.1899022e-12  1.1965779e-13  0              2.9950208    
   2700000   7080           200            200            0.0036169937   0.0002647668   0              0.010586214    6.0866169e-17  0              5.8780189e-12  1.1965779e-13  0              2.9950208    
   2800000   7080           200            200            0.0036169937   0.0002647668   0              0.010586214    1.3990322e-17  0              1.3510851e-12  1.1965779e-13  0              2.9950208    
   2900000   7080           200            200            0.0036169937   0.0002647668   0              0.010586214    1.5304761e-18  0              1.4780243e-13  1.1965779e-13  0              2.9950208    
   3000000   7080           200            200            0.0036169937   0.0002647668   0              0.010586214    3.5701482e-18  0              3.4477935e-13  1.1965779e-13  0              2.9950208    
Loop time of 294.833 on 4 procs for 3000000 steps with 2501 atoms

Performance: 8791416.664 ns/day, 0.000 hours/ns, 10175.251 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 10.885     | 37.171     | 63.909     | 427.5 | 12.61
Neigh   | 4.3843     | 4.4664     | 4.5498     |   3.4 |  1.51
Comm    | 19.149     | 38.391     | 77.795     | 372.2 | 13.02
Output  | 0.27356    | 0.27387    | 0.27419    |   0.1 |  0.09
Modify  | 109.68     | 158.23     | 177.39     | 224.2 | 53.67
Other   |            | 56.3       |            |       | 19.10

Nlocal:         625.25 ave         876 max         375 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:           1.75 ave           3 max           1 min
Histogram: 2 0 0 0 0 1 0 0 0 1
Neighs:         332.25 ave         665 max           0 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 1329
Ave neighs/atom = 0.53138745
Neighbor list builds = 164
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 73

#variable lat0 equal 1                    #
variable lat1 equal 3+(100*0.01)+(v_ind*0.01)  # .491+(v_ind*0.001)       # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 500*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.73                                                               
Lattice spacing in x,y,z = 4.73 4.73 4.73

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -3547.5 ${n1e1} -100 100 -100 100 units box
region box block -3547.5 3547.5 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -3547.5 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -3547.5 3547.5 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-3547.5 -100 -100) to (3547.5 100 100)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 1499 atoms
  using lattice units in orthogonal box = (-3547.5 -100 -100) to (3547.5 100 100)
  create_atoms CPU = 0.000 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 1500 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 1001 atoms
  using lattice units in orthogonal box = (-3547.5 -100 -100) to (3547.5 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  1499 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  1499 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  1001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  1001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
1499 atoms in group substrate
group slider1 region slider1
1001 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 1001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_73_*.dump id type diameter mass xu yu zu fx fy fz

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 4578 130 130
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 92.75 | 92.78 | 92.81 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   7095           200            200            0              0              0              0              0              0              0              1.1965779e-13  0              6            
    100000   7095           200            200            0.0028566986   5.6927156e-36  0              0.0085700957   582285.11      0              5.6345619e+10  1.1965779e-13  0              3.3287244    
    200000   7095           200            200            0.00099311    -1.1385364e-34  0              0.00297933     137736.29      0              1.3328241e+10  1.1965779e-13  0              3.0780733    
    300000   7095           200            200            3.8086956e-05  4.5542192e-35  0              0.00011426087  432.92791      0              41892864       1.1965779e-13  0              3.0452498    
    400000   7095           200            200            0.00010651415  2.2771278e-35  0              0.00031954245  3170.7353      0              3.0682056e+08  1.1965779e-13  0              3.0034722    
    500000   7095           200            200            0.0021953284  -0.00078810416  0              0.0073740895   1397.0559      0              1.3518803e+08  1.1965779e-13  0              2.9956749    
    600000   7095           200            200            0.0047377941   0.0010635858   0              0.013149796    135.58197      0              13119775       1.1965779e-13  0              2.9943091    
    700000   7095           200            200            0.0033993222   0.00038778096  0              0.0098101857   20.58188       0              1991633.9      1.1965779e-13  0              2.9950799    
    800000   7095           200            200            0.0034918519   0.00047044703  0              0.010005109    0.04676133     0              4524.9244      1.1965779e-13  0              2.9950254    
    900000   7095           200            200            0.0036469953   0.00052660072  0              0.010414385    0.24581382     0              23786.513      1.1965779e-13  0              2.9949239    
   1000000   7095           200            200            0.0037004743   0.00053126096  0              0.010570162    0.06638464     0              6423.8009      1.1965779e-13  0              2.9948864    
   1100000   7095           200            200            0.0037061901   0.00053193652  0              0.010586634    0.0027572757   0              266.81157      1.1965779e-13  0              2.9948827    
   1200000   7095           200            200            0.0037015232   0.0005313335   0              0.010573236    0.00010769556  0              10.421309      1.1965779e-13  0              2.994886     
   1300000   7095           200            200            0.0036985895   0.00053095917  0              0.010564809    0.00014148875  0              13.691353      1.1965779e-13  0              2.994888     
   1400000   7095           200            200            0.0036978575   0.00053086716  0              0.010562705    1.6989085e-05  0              1.6439722      1.1965779e-13  0              2.9948885    
   1500000   7095           200            200            0.0036979133   0.00053087519  0              0.010562865    9.5596388e-08  0              0.0092505159   1.1965779e-13  0              2.9948885    
   1600000   7095           200            200            0.0036980379   0.00053089133  0              0.010563222    1.7000605e-07  0              0.016450869    1.1965779e-13  0              2.9948884    
   1700000   7095           200            200            0.0036980882   0.00053089774  0              0.010563367    5.4325114e-08  0              0.0052568443   1.1965779e-13  0              2.9948884    
   1800000   7095           200            200            0.0036980948   0.00053089854  0              0.010563386    2.7651156e-09  0              0.00026757021  1.1965779e-13  0              2.9948884    
   1900000   7095           200            200            0.003698091    0.00053089804  0              0.010563375    4.9324013e-11  0              4.772906e-06   1.1965779e-13  0              2.9948884    
   2000000   7095           200            200            0.0036980884   0.00053089771  0              0.010563368    1.0714077e-10  0              1.0367624e-05  1.1965779e-13  0              2.9948884    
   2100000   7095           200            200            0.0036980877   0.00053089762  0              0.010563365    1.488054e-11   0              1.4399359e-06  1.1965779e-13  0              2.9948884    
   2200000   7095           200            200            0.0036980877   0.00053089762  0              0.010563366    1.5607351e-13  0              1.5102668e-08  1.1965779e-13  0              2.9948884    
   2300000   7095           200            200            0.0036980878   0.00053089763  0              0.010563366    1.1363437e-13  0              1.0995986e-08  1.1965779e-13  0              2.9948884    
   2400000   7095           200            200            0.0036980879   0.00053089764  0              0.010563366    4.4030169e-14  0              4.2606399e-09  1.1965779e-13  0              2.9948884    
   2500000   7095           200            200            0.0036980879   0.00053089764  0              0.010563366    2.6835589e-15  0              2.5967826e-10  1.1965779e-13  0              2.9948884    
   2600000   7095           200            200            0.0036980879   0.00053089764  0              0.010563366    3.3260735e-17  0              3.2185208e-12  1.1965779e-13  0              2.9948884    
   2700000   7095           200            200            0.0036980879   0.00053089764  0              0.010563366    7.3845338e-17  0              7.1457457e-12  1.1965779e-13  0              2.9948884    
   2800000   7095           200            200            0.0036980879   0.00053089764  0              0.010563366    1.4069646e-17  0              1.3614687e-12  1.1965779e-13  0              2.9948884    
   2900000   7095           200            200            0.0036980879   0.00053089764  0              0.010563366    2.4093385e-19  0              2.3314295e-14  1.1965779e-13  0              2.9948884    
   3000000   7095           200            200            0.0036980879   0.00053089765  0              0.010563366    6.1407976e-19  0              5.9422273e-14  1.1965779e-13  0              2.9948884    
Loop time of 293.094 on 4 procs for 3000000 steps with 2500 atoms

Performance: 8843569.621 ns/day, 0.000 hours/ns, 10235.613 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 10.308     | 36.603     | 62.806     | 428.8 | 12.49
Neigh   | 4.3901     | 4.4713     | 4.5525     |   3.4 |  1.53
Comm    | 25.918     | 52.082     | 77.673     | 347.9 | 17.77
Output  | 0.27236    | 0.27268    | 0.27299    |   0.1 |  0.09
Modify  | 108.74     | 143.29     | 177.85     | 281.1 | 48.89
Other   |            | 56.38      |            |       | 19.23

Nlocal:            625 ave         876 max         375 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:            1.5 ave           4 max           0 min
Histogram: 2 0 0 0 0 1 0 0 0 1
Neighs:         333.25 ave         667 max           0 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 1333
Ave neighs/atom = 0.5332
Neighbor list builds = 164
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 74

#variable lat0 equal 1                    #
variable lat1 equal 3+(100*0.01)+(v_ind*0.01)  # .491+(v_ind*0.001)       # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 500*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.74                                                               
Lattice spacing in x,y,z = 4.74 4.74 4.74

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -3555 ${n1e1} -100 100 -100 100 units box
region box block -3555 3555 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -3555 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -3555 3555 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-3555 -100 -100) to (3555 100 100)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 1500 atoms
  using lattice units in orthogonal box = (-3555 -100 -100) to (3555 100 100)
  create_atoms CPU = 0.000 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 1500 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 1001 atoms
  using lattice units in orthogonal box = (-3555 -100 -100) to (3555 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  1500 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  1500 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  1001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  1001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
1500 atoms in group substrate
group slider1 region slider1
1001 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 1001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_74_*.dump id type diameter mass xu yu zu fx fy fz

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 4588 130 130
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 92.95 | 92.96 | 92.96 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   7110           200            200            0              0              0              0              0              0              0              1.1965779e-13  0              6            
    100000   7110           200            200            0.0028505564   4.6596625e-42  0              0.0085516691   582249.32      0              5.6229471e+10  1.1965779e-13  0              3.3287561    
    200000   7110           200            200            0.00099065421  2.0734372e-40  0              0.0029719626   137657.06      0              1.3293933e+10  1.1965779e-13  0              3.078153     
    300000   7110           200            200            3.7222579e-05 -2.2722335e-35  0              0.00011166774  415.72383      0              40147632       1.1965779e-13  0              3.0452662    
    400000   7110           200            200            0.00010691353 -2.272235e-35   0              0.0003207406   3205.6546      0              3.0957917e+08  1.1965779e-13  0              3.0034417    
    500000   7110           200            200            0.0013671761  -0.0016737689   0              0.0057752973   1212.0992      0              1.1705587e+08  1.1965779e-13  0              2.9961664    
    600000   7110           200            200            0.0034330829  -0.0025416041   0              0.012840853    145.05749      0              14008614       1.1965779e-13  0              2.994337     
    700000   7110           200            200            0.0024190026  -0.002453143    0              0.0097101509   18.493311      0              1785951.6      1.1965779e-13  0              2.9950821    
    800000   7110           200            200            0.0026530623  -0.0024922773   0              0.010451464    3.508706       0              338845.72      1.1965779e-13  0              2.9948977    
    900000   7110           200            200            0.0027310342  -0.0025051841   0              0.010698287    0.18385592     0              17755.489      1.1965779e-13  0              2.9948315    
   1000000   7110           200            200            0.002658029   -0.0024936268   0              0.010467714    0.00042874401  0              41.405028      1.1965779e-13  0              2.994891     
   1100000   7110           200            200            0.0026871261  -0.0024982349   0              0.010559613    0.0047562414   0              459.32375      1.1965779e-13  0              2.9948676    
   1200000   7110           200            200            0.0026811707  -0.0024973236   0              0.010540836    0.00119707     0              115.60446      1.1965779e-13  0              2.9948722    
   1300000   7110           200            200            0.0026804723  -0.0024972006   0              0.010538618    8.9584563e-05  0              8.6514358      1.1965779e-13  0              2.9948729    
   1400000   7110           200            200            0.0026816544  -0.0024973905   0              0.010542354    2.1809192e-07  0              0.021061756    1.1965779e-13  0              2.9948719    
   1500000   7110           200            200            0.0026811075  -0.0024973041   0              0.010540627    1.0472244e-06  0              0.10113344     1.1965779e-13  0              2.9948723    
   1600000   7110           200            200            0.0026812447  -0.0024973253   0              0.010541059    3.8193722e-07  0              0.036884763    1.1965779e-13  0              2.9948722    
   1700000   7110           200            200            0.0026812441  -0.0024973255   0              0.010541058    3.8872308e-08  0              0.0037540093   1.1965779e-13  0              2.9948722    
   1800000   7110           200            200            0.0026812259  -0.0024973225   0              0.010541       5.5588022e-10  0              5.3682933e-05  1.1965779e-13  0              2.9948722    
   1900000   7110           200            200            0.0026812358  -0.0024973241   0              0.010541032    1.9057557e-10  0              1.8404424e-05  1.1965779e-13  0              2.9948722    
   2000000   7110           200            200            0.0026812329  -0.0024973236   0              0.010541022    1.1378847e-10  0              1.0988876e-05  1.1965779e-13  0              2.9948722    
   2100000   7110           200            200            0.0026812332  -0.0024973237   0              0.010541023    1.5393288e-11  0              1.4865736e-06  1.1965779e-13  0              2.9948722    
   2200000   7110           200            200            0.0026812334  -0.0024973237   0              0.010541024    4.7504025e-13  0              4.5875987e-08  1.1965779e-13  0              2.9948722    
   2300000   7110           200            200            0.0026812332  -0.0024973237   0              0.010541023    2.4018626e-14  0              2.3195469e-09  1.1965779e-13  0              2.9948722    
   2400000   7110           200            200            0.0026812333  -0.0024973237   0              0.010541024    3.1401787e-14  0              3.0325599e-09  1.1965779e-13  0              2.9948722    
   2500000   7110           200            200            0.0026812333  -0.0024973237   0              0.010541024    5.6506199e-15  0              5.4569642e-10  1.1965779e-13  0              2.9948722    
   2600000   7110           200            200            0.0026812333  -0.0024973237   0              0.010541024    2.5517918e-16  0              2.4643379e-11  1.1965779e-13  0              2.9948722    
   2700000   7110           200            200            0.0026812333  -0.0024973237   0              0.010541024    9.4407443e-19  0              9.1171951e-14  1.1965779e-13  0              2.9948722    
   2800000   7110           200            200            0.0026812333  -0.0024973237   0              0.010541024    3.5816972e-18  0              3.4589468e-13  1.1965779e-13  0              2.9948722    
   2900000   7110           200            200            0.0026812333  -0.0024973237   0              0.010541024    2.4283746e-18  0              2.3451503e-13  1.1965779e-13  0              2.9948722    
   3000000   7110           200            200            0.0026812333  -0.0024973237   0              0.010541024    4.9272833e-18  0              4.7584175e-13  1.1965779e-13  0              2.9948722    
Loop time of 295.05 on 4 procs for 3000000 steps with 2501 atoms

Performance: 8784952.275 ns/day, 0.000 hours/ns, 10167.769 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 10.966     | 36.968     | 63.904     | 423.7 | 12.53
Neigh   | 4.3983     | 4.4791     | 4.5612     |   3.4 |  1.52
Comm    | 19.539     | 38.718     | 77.663     | 366.5 | 13.12
Output  | 0.27091    | 0.27125    | 0.2716     |   0.1 |  0.09
Modify  | 109.32     | 157.79     | 178        | 224.4 | 53.48
Other   |            | 56.83      |            |       | 19.26

Nlocal:         625.25 ave         876 max         375 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:           1.75 ave           3 max           1 min
Histogram: 2 0 0 0 0 1 0 0 0 1
Neighs:         335.25 ave         671 max           0 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 1341
Ave neighs/atom = 0.53618553
Neighbor list builds = 164
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 75

#variable lat0 equal 1                    #
variable lat1 equal 3+(100*0.01)+(v_ind*0.01)  # .491+(v_ind*0.001)       # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 500*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.75                                                               
Lattice spacing in x,y,z = 4.75 4.75 4.75

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -3562.5 ${n1e1} -100 100 -100 100 units box
region box block -3562.5 3562.5 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -3562.5 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -3562.5 3562.5 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-3562.5 -100 -100) to (3562.5 100 100)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 1500 atoms
  using lattice units in orthogonal box = (-3562.5 -100 -100) to (3562.5 100 100)
  create_atoms CPU = 0.000 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 1500 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 1001 atoms
  using lattice units in orthogonal box = (-3562.5 -100 -100) to (3562.5 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  1500 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  1500 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  1001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  1001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
1500 atoms in group substrate
group slider1 region slider1
1001 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 1001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_75_*.dump id type diameter mass xu yu zu fx fy fz

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 4597 130 130
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 93.16 | 93.17 | 93.17 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   7125           200            200            0              0              0              0              0              0              0              1.1965779e-13  0              6            
    100000   7125           200            200            0.0028435633   2.8343648e-36  0              0.00853069     581900.8       0              5.6195814e+10  1.1965779e-13  0              3.3293562    
    200000   7125           200            200            0.00098984489 -2.2674812e-35  0              0.0029695347   137938.03      0              1.3321068e+10  1.1965779e-13  0              3.0778717    
    300000   7125           200            200            3.8803978e-05 -1.1337423e-34  0              0.00011641194  452.64299      0              43713020       1.1965779e-13  0              3.0451298    
    400000   7125           200            200            7.4155652e-06  3.149048e-40   0              2.2246696e-05  17.988888      0              1737238.1      1.1965779e-13  0              3.0067735    
    500000   7125           200            200            0.0014096813   9.0699816e-35  0              0.0042290439   822.20421      0              79402597       1.1965779e-13  0              2.9975176    
    600000   7125           200            200            0.0035510503   1.1337475e-34  0              0.010653151    196.4131       0              18968172       1.1965779e-13  0              2.9955256    
    700000   7125           200            200            0.0033652124   1.5872452e-34  0              0.010095637    24.220909      0              2339082.1      1.1965779e-13  0              2.9956555    
    800000   7125           200            200            0.0036053562   1.1337609e-35  0              0.010816069    2.4493017      0              236536.02      1.1965779e-13  0              2.995461     
    900000   7125           200            200            0.0034560964  -2.2674799e-35  0              0.010368289    0.17181787     0              16592.94       1.1965779e-13  0              2.9955844    
   1000000   7125           200            200            0.003529233    1.1452048e-40  0              0.010587699    0.0060526431   0              584.52095      1.1965779e-13  0              2.995523     
   1100000   7125           200            200            0.0034985486  -5.6686061e-36  0              0.010495646    4.1076398e-06  0              0.39668645     1.1965779e-13  0              2.9955489    
   1200000   7125           200            200            0.0035099872  -1.1337326e-35  0              0.010529962    0.00014157629  0              13.672425      1.1965779e-13  0              2.9955392    
   1300000   7125           200            200            0.0035061771   5.6688561e-36  0              0.010518531    6.3873043e-05  0              6.1684013      1.1965779e-13  0              2.9955424    
   1400000   7125           200            200            0.0035072804   1.3113936e-40  0              0.010521841    1.5581576e-05  0              1.5047571      1.1965779e-13  0              2.9955415    
   1500000   7125           200            200            0.0035070279  -3.5416354e-37  0              0.010521084    2.7690227e-06  0              0.26741239     1.1965779e-13  0              2.9955417    
   1600000   7125           200            200            0.0035070545   4.9602674e-36  0              0.010521163    3.8875278e-07  0              0.037542961    1.1965779e-13  0              2.9955417    
   1700000   7125           200            200            0.0035070701   2.8344947e-36  0              0.01052121     4.3538186e-08  0              0.0042046064   1.1965779e-13  0              2.9955416    
   1800000   7125           200            200            0.0035070557  -5.6685952e-36  0              0.010521167    3.7015759e-09  0              0.0003574717   1.1965779e-13  0              2.9955417    
   1900000   7125           200            200            0.0035070636   1.7006312e-35  0              0.010521191    1.9926923e-10  0              1.9243996e-05  1.1965779e-13  0              2.9955417    
   2000000   7125           200            200            0.00350706    -1.1337322e-35  0              0.01052118     2.5555928e-12  0              2.4680086e-07  1.1965779e-13  0              2.9955417    
   2100000   7125           200            200            0.0035070614   1.3163875e-40  0              0.010521184    6.292809e-13   0              6.0771445e-08  1.1965779e-13  0              2.9955417    
   2200000   7125           200            200            0.0035070609  -1.1337322e-35  0              0.010521183    5.8845717e-13  0              5.6828981e-08  1.1965779e-13  0              2.9955417    
   2300000   7125           200            200            0.0035070611   1.3145495e-40  0              0.010521183    1.8108849e-13  0              1.748823e-08   1.1965779e-13  0              2.9955417    
   2400000   7125           200            200            0.003507061   -1.1337322e-35  0              0.010521183    3.6890223e-14  0              3.5625936e-09  1.1965779e-13  0              2.9955417    
   2500000   7125           200            200            0.0035070611   1.3134615e-40  0              0.010521183    5.8034831e-15  0              5.6045886e-10  1.1965779e-13  0              2.9955417    
   2600000   7125           200            200            0.0035070611   6.8024853e-35  0              0.010521183    7.4489054e-16  0              7.1936196e-11  1.1965779e-13  0              2.9955417    
   2700000   7125           200            200            0.0035070611  -2.2674776e-35  0              0.010521183    6.8969064e-17  0              6.6605385e-12  1.1965779e-13  0              2.9955417    
   2800000   7125           200            200            0.0035070611   1.3195802e-40  0              0.010521183    3.1321463e-18  0              3.0248027e-13  1.1965779e-13  0              2.9955417    
   2900000   7125           200            200            0.0035070611   4.5349947e-35  0              0.010521183    5.1062261e-18  0              4.9312277e-13  1.1965779e-13  0              2.9955417    
   3000000   7125           200            200            0.0035070611   1.3048889e-40  0              0.010521183    1.407644e-18   0              1.3594018e-13  1.1965779e-13  0              2.9955417    
Loop time of 294.873 on 4 procs for 3000000 steps with 2501 atoms

Performance: 8790223.622 ns/day, 0.000 hours/ns, 10173.870 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 10.991     | 36.48      | 62.459     | 418.8 | 12.37
Neigh   | 4.4058     | 4.4816     | 4.5582     |   3.1 |  1.52
Comm    | 19.535     | 38.371     | 76.422     | 359.9 | 13.01
Output  | 0.27235    | 0.27268    | 0.27303    |   0.1 |  0.09
Modify  | 109.87     | 158.25     | 178.56     | 224.4 | 53.67
Other   |            | 57.01      |            |       | 19.34

Nlocal:         625.25 ave         876 max         375 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:           1.75 ave           3 max           1 min
Histogram: 2 0 0 0 0 1 0 0 0 1
Neighs:         342.25 ave         685 max           0 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 1369
Ave neighs/atom = 0.54738105
Neighbor list builds = 164
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 76

#variable lat0 equal 1                    #
variable lat1 equal 3+(100*0.01)+(v_ind*0.01)  # .491+(v_ind*0.001)       # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 500*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.76                                                               
Lattice spacing in x,y,z = 4.76 4.76 4.76

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -3570 ${n1e1} -100 100 -100 100 units box
region box block -3570 3570 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -3570 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -3570 3570 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-3570 -100 -100) to (3570 100 100)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 1500 atoms
  using lattice units in orthogonal box = (-3570 -100 -100) to (3570 100 100)
  create_atoms CPU = 0.000 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 1500 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 1001 atoms
  using lattice units in orthogonal box = (-3570 -100 -100) to (3570 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  1500 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  1500 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  1001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  1001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
1500 atoms in group substrate
group slider1 region slider1
1001 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 1001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_76_*.dump id type diameter mass xu yu zu fx fy fz

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 4607 130 130
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 93.3 | 93.3 | 93.31 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   7140           200            200            0              0              0              0              0              0              0              1.1965779e-13  0              6            
    100000   7140           200            200            0.0028384088   8.4852332e-36  0              0.0085152264   582196.84      0              5.6224403e+10  1.1965779e-13  0              3.3287983    
    200000   7140           200            200            0.00098599067 -4.5254124e-35  0              0.002957972    137546.94      0              1.3283299e+10  1.1965779e-13  0              3.0782551    
    300000   7140           200            200            3.6346373e-05 -2.2627243e-35  0              0.00010903912  400.16039      0              38644626       1.1965779e-13  0              3.0452634    
    400000   7140           200            200            0.00010462221 -2.2627068e-35  0              0.00031386662  3102.6293      0              2.9962973e+08  1.1965779e-13  0              3.0035363    
    500000   7140           200            200            0.0032733507   0.0028458948   0              0.0069741574   1366.4105      0              1.3195815e+08  1.1965779e-13  0              2.9957616    
    600000   7140           200            200            0.0055285603   0.0032915541   0              0.013294127    124.68234      0              12040928       1.1965779e-13  0              2.9942556    
    700000   7140           200            200            0.0046644243   0.0030780169   0              0.010915256    25.814905      0              2493018.8      1.1965779e-13  0              2.9947863    
    800000   7140           200            200            0.0045553117   0.0030632947   0              0.010602641    3.587325       0              346438.17      1.1965779e-13  0              2.9948565    
    900000   7140           200            200            0.0045287335   0.0030602491   0              0.010525952    0.49080446     0              47398.382      1.1965779e-13  0              2.9948734    
   1000000   7140           200            200            0.0045210474   0.0030590681   0              0.010504074    0.066831432    0              6454.1014      1.1965779e-13  0              2.994878     
   1100000   7140           200            200            0.0045189802   0.0030587633   0              0.010498177    0.0090641063   0              875.34651      1.1965779e-13  0              2.9948793    
   1200000   7140           200            200            0.0045185032   0.0030586998   0              0.01049681     0.0012243251   0              118.23655      1.1965779e-13  0              2.9948795    
   1300000   7140           200            200            0.004518433    0.0030586945   0              0.010496604    0.00016468973  0              15.904555      1.1965779e-13  0              2.9948795    
   1400000   7140           200            200            0.004518446    0.0030586993   0              0.010496639    2.2060709e-05  0              2.1304653      1.1965779e-13  0              2.9948795    
   1500000   7140           200            200            0.004518465    0.0030587034   0              0.010496692    2.9426666e-06  0              0.28418168     1.1965779e-13  0              2.9948795    
   1600000   7140           200            200            0.0045184772   0.0030587059   0              0.010496726    3.9085112e-07  0              0.037745604    1.1965779e-13  0              2.9948795    
   1700000   7140           200            200            0.0045184836   0.0030587071   0              0.010496744    5.1689362e-08  0              0.0049917886   1.1965779e-13  0              2.9948795    
   1800000   7140           200            200            0.0045184866   0.0030587077   0              0.010496752    6.8056765e-09  0              0.00065724352  1.1965779e-13  0              2.9948795    
   1900000   7140           200            200            0.004518488    0.0030587079   0              0.010496756    8.9202451e-10  0              8.6145343e-05  1.1965779e-13  0              2.9948795    
   2000000   7140           200            200            0.0045184886   0.003058708    0              0.010496758    1.1637486e-10  0              1.1238651e-05  1.1965779e-13  0              2.9948795    
   2100000   7140           200            200            0.0045184888   0.0030587081   0              0.010496758    1.510964e-11   0              1.4591809e-06  1.1965779e-13  0              2.9948795    
   2200000   7140           200            200            0.0045184889   0.0030587081   0              0.010496759    1.9519331e-12  0              1.8850373e-07  1.1965779e-13  0              2.9948795    
   2300000   7140           200            200            0.004518489    0.0030587081   0              0.010496759    2.511199e-13   0              2.4251363e-08  1.1965779e-13  0              2.9948795    
   2400000   7140           200            200            0.004518489    0.0030587081   0              0.010496759    3.2290294e-14  0              3.1183655e-09  1.1965779e-13  0              2.9948795    
   2500000   7140           200            200            0.004518489    0.0030587081   0              0.010496759    4.1107179e-15  0              3.9698371e-10  1.1965779e-13  0              2.9948795    
   2600000   7140           200            200            0.004518489    0.0030587081   0              0.010496759    5.0408938e-16  0              4.8681344e-11  1.1965779e-13  0              2.9948795    
   2700000   7140           200            200            0.004518489    0.0030587081   0              0.010496759    6.3014763e-17  0              6.0855148e-12  1.1965779e-13  0              2.9948795    
   2800000   7140           200            200            0.004518489    0.0030587081   0              0.010496759    1.0902063e-17  0              1.0528433e-12  1.1965779e-13  0              2.9948795    
   2900000   7140           200            200            0.004518489    0.0030587081   0              0.010496759    4.3393315e-18  0              4.1906158e-13  1.1965779e-13  0              2.9948795    
   3000000   7140           200            200            0.004518489    0.0030587081   0              0.010496759    2.4999387e-18  0              2.4142618e-13  1.1965779e-13  0              2.9948795    
Loop time of 298.632 on 4 procs for 3000000 steps with 2501 atoms

Performance: 8679580.683 ns/day, 0.000 hours/ns, 10045.811 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 11.151     | 37.124     | 63.807     | 426.2 | 12.43
Neigh   | 4.4529     | 4.5268     | 4.6008     |   3.0 |  1.52
Comm    | 19.306     | 40.094     | 80.1       | 371.9 | 13.43
Output  | 0.27268    | 0.27299    | 0.27332    |   0.1 |  0.09
Modify  | 111.45     | 160.24     | 179.45     | 223.3 | 53.66
Other   |            | 56.37      |            |       | 18.88

Nlocal:         625.25 ave         876 max         375 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:           1.75 ave           3 max           1 min
Histogram: 2 0 0 0 0 1 0 0 0 1
Neighs:         332.25 ave         665 max           0 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 1329
Ave neighs/atom = 0.53138745
Neighbor list builds = 164
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 77

#variable lat0 equal 1                    #
variable lat1 equal 3+(100*0.01)+(v_ind*0.01)  # .491+(v_ind*0.001)       # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 500*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.77                                                               
Lattice spacing in x,y,z = 4.77 4.77 4.77

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -3577.5 ${n1e1} -100 100 -100 100 units box
region box block -3577.5 3577.5 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -3577.5 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -3577.5 3577.5 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-3577.5 -100 -100) to (3577.5 100 100)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 1500 atoms
  using lattice units in orthogonal box = (-3577.5 -100 -100) to (3577.5 100 100)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 1500 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 1001 atoms
  using lattice units in orthogonal box = (-3577.5 -100 -100) to (3577.5 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  1500 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  1500 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  1001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  1001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
1500 atoms in group substrate
group slider1 region slider1
1001 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 1001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_77_*.dump id type diameter mass xu yu zu fx fy fz

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 4617 130 130
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 93.51 | 93.51 | 93.52 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   7155           200            200            0              0              0              0              0              0              0              1.1965779e-13  0              6            
    100000   7155           200            200            0.0028324294   1.1289926e-35  0              0.0084972883   582191.74      0              5.6223911e+10  1.1965779e-13  0              3.3287746    
    200000   7155           200            200            0.00098406708  4.5160657e-35  0              0.0029522012   137581.23      0              1.3286611e+10  1.1965779e-13  0              3.0781664    
    300000   7155           200            200            3.6243446e-05  3.2989768e-40  0              0.00010873034  399.59877      0              38590389       1.1965779e-13  0              3.0452148    
    400000   7155           200            200            0.00010123615  2.8224805e-36  0              0.00030370845  2928.65        0              2.8282805e+08  1.1965779e-13  0              3.003676     
    500000   7155           200            200            0.0026214778  -0.001285344    0              0.0091497775   1498.0001      0              1.4466613e+08  1.1965779e-13  0              2.9951367    
    600000   7155           200            200            0.0036098296  -0.00083592434  0              0.011665413    189.29237      0              18280502       1.1965779e-13  0              2.994578     
    700000   7155           200            200            0.0027667553  -0.00075040654  0              0.0090506724   2.0802218      0              200892.93      1.1965779e-13  0              2.9952151    
    800000   7155           200            200            0.0032142688  -0.00080900495  0              0.010451811    3.6570286      0              353169.64      1.1965779e-13  0              2.9948527    
    900000   7155           200            200            0.0032872275  -0.00081283723  0              0.01067452     0.024059153    0              2323.4608      1.1965779e-13  0              2.9948003    
   1000000   7155           200            200            0.003210993   -0.00080860023  0              0.010441579    0.053121264    0              5130.0715      1.1965779e-13  0              2.994858     
   1100000   7155           200            200            0.0032149155  -0.00080885454  0              0.010453601    0.0038015962   0              367.13095      1.1965779e-13  0              2.9948546    
   1200000   7155           200            200            0.0032244766  -0.00080939439  0              0.010482824    0.00040779307  0              39.381736      1.1965779e-13  0              2.9948474    
   1300000   7155           200            200            0.0032222587  -0.00080926535  0              0.010476041    0.00014129864  0              13.645611      1.1965779e-13  0              2.9948491    
   1400000   7155           200            200            0.0032213613  -0.00080921552  0              0.010473299    3.8665796e-07  0              0.037340658    1.1965779e-13  0              2.9948498    
   1500000   7155           200            200            0.003221819   -0.00080924175  0              0.010474699    2.9341949e-06  0              0.28336354     1.1965779e-13  0              2.9948495    
   1600000   7155           200            200            0.0032218591  -0.00080924384  0              0.010474821    4.7935164e-08  0              0.004629235    1.1965779e-13  0              2.9948494    
   1700000   7155           200            200            0.0032217903  -0.00080923993  0              0.010474611    3.6980791e-08  0              0.0035713401   1.1965779e-13  0              2.9948495    
   1800000   7155           200            200            0.0032217971  -0.00080924034  0              0.010474632    4.0348032e-09  0              0.00038965242  1.1965779e-13  0              2.9948495    
   1900000   7155           200            200            0.0032218052  -0.0008092408   0              0.010474656    2.1624942e-10  0              2.0883821e-05  1.1965779e-13  0              2.9948495    
   2000000   7155           200            200            0.0032218028  -0.00080924066  0              0.010474649    1.246718e-10   0              1.203991e-05   1.1965779e-13  0              2.9948495    
   2100000   7155           200            200            0.0032218021  -0.00080924062  0              0.010474647    8.711226e-17   0              8.4126785e-12  1.1965779e-13  0              2.9948495    
   2200000   7155           200            200            0.0032218026  -0.00080924065  0              0.010474648    2.2722029e-12  0              2.1943309e-07  1.1965779e-13  0              2.9948495    
   2300000   7155           200            200            0.0032218026  -0.00080924065  0              0.010474648    6.9823527e-14  0              6.7430565e-09  1.1965779e-13  0              2.9948495    
   2400000   7155           200            200            0.0032218025  -0.00080924065  0              0.010474648    2.4620307e-14  0              2.377653e-09   1.1965779e-13  0              2.9948495    
   2500000   7155           200            200            0.0032218025  -0.00080924065  0              0.010474648    3.9951781e-15  0              3.858257e-10   1.1965779e-13  0              2.9948495    
   2600000   7155           200            200            0.0032218025  -0.00080924065  0              0.010474648    8.6951972e-17  0              8.3971991e-12  1.1965779e-13  0              2.9948495    
   2700000   7155           200            200            0.0032218025  -0.00080924065  0              0.010474648    1.0169476e-16  0              9.8209516e-12  1.1965779e-13  0              2.9948495    
   2800000   7155           200            200            0.0032218025  -0.00080924065  0              0.010474648    3.1038275e-19  0              2.9974545e-14  1.1965779e-13  0              2.9948495    
   2900000   7155           200            200            0.0032218025  -0.00080924065  0              0.010474648    4.0573666e-18  0              3.9183142e-13  1.1965779e-13  0              2.9948495    
   3000000   7155           200            200            0.0032218025  -0.00080924064  0              0.010474648    2.6674365e-19  0              2.5760192e-14  1.1965779e-13  0              2.9948495    
Loop time of 296.64 on 4 procs for 3000000 steps with 2501 atoms

Performance: 8737871.719 ns/day, 0.000 hours/ns, 10113.277 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 11.193     | 37.004     | 63.454     | 423.1 | 12.47
Neigh   | 4.4298     | 4.5092     | 4.5892     |   3.2 |  1.52
Comm    | 18.33      | 25.538     | 31.779     | 115.3 |  8.61
Output  | 0.28145    | 0.28175    | 0.28209    |   0.1 |  0.09
Modify  | 169.15     | 173.12     | 176.62     |  23.5 | 58.36
Other   |            | 56.19      |            |       | 18.94

Nlocal:         625.25 ave         876 max         374 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:           1.75 ave           2 max           1 min
Histogram: 1 0 0 0 0 0 0 0 0 3
Neighs:         333.25 ave         667 max           0 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 1333
Ave neighs/atom = 0.53298681
Neighbor list builds = 164
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 78

#variable lat0 equal 1                    #
variable lat1 equal 3+(100*0.01)+(v_ind*0.01)  # .491+(v_ind*0.001)       # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 500*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.78                                                               
Lattice spacing in x,y,z = 4.78 4.78 4.78

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -3585 ${n1e1} -100 100 -100 100 units box
region box block -3585 3585 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -3585 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -3585 3585 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-3585 -100 -100) to (3585 100 100)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 1500 atoms
  using lattice units in orthogonal box = (-3585 -100 -100) to (3585 100 100)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 1500 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 1001 atoms
  using lattice units in orthogonal box = (-3585 -100 -100) to (3585 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  1500 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  1500 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  1001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  1001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
1500 atoms in group substrate
group slider1 region slider1
1001 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 1001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_78_*.dump id type diameter mass xu yu zu fx fy fz

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 4626 130 130
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 93.59 | 93.62 | 93.65 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   7170           200            200            0              0              0              0              0              0              0              1.1965779e-13  0              6            
    100000   7170           200            200            0.0028263395   5.6331703e-36  0              0.0084790184   582133.18      0              5.6218256e+10  1.1965779e-13  0              3.3288782    
    200000   7170           200            200            0.00098129279 -2.2532427e-35  0              0.0029438784   137418.92      0              1.3270935e+10  1.1965779e-13  0              3.0784107    
    300000   7170           200            200            3.5589303e-05  2.2533122e-35  0              0.00010676791  387.23717      0              37396594       1.1965779e-13  0              3.0452901    
    400000   7170           200            200            0.00010337207 -4.5063136e-35  0              0.0003101162   3057.4358      0              2.9526526e+08  1.1965779e-13  0              3.0035995    
    500000   7170           200            200            0.0019249397  -0.0011192287   0              0.0068940477   1360.2468      0              1.313629e+08   1.1965779e-13  0              2.9958035    
    600000   7170           200            200            0.0039055952  -0.0014374326   0              0.013154218    127.64217      0              12326767       1.1965779e-13  0              2.9942861    
    700000   7170           200            200            0.0029012781  -0.00097089801  0              0.0096747322   19.907599      0              1922533.4      1.1965779e-13  0              2.9950993    
    800000   7170           200            200            0.0029253357  -0.0011280554   0              0.0099040625   0.093090548    0              8990.0188      1.1965779e-13  0              2.995035     
    900000   7170           200            200            0.0030807509  -0.0011587787   0              0.010401031    0.46704677     0              45104.034      1.1965779e-13  0              2.9949109    
   1000000   7170           200            200            0.0031165365  -0.0011628106   0              0.01051242     0.024761235    0              2391.2628      1.1965779e-13  0              2.9948842    
   1100000   7170           200            200            0.0031052466  -0.0011614907   0              0.010477231    0.002139373    0              206.60533      1.1965779e-13  0              2.9948931    
   1200000   7170           200            200            0.0030971464  -0.0011605591   0              0.010451998    0.0012061686   0              116.48313      1.1965779e-13  0              2.9948993    
   1300000   7170           200            200            0.0030962987  -0.0011604669   0              0.010449363    1.5416389e-05  0              1.4888045      1.1965779e-13  0              2.9948999    
   1400000   7170           200            200            0.0030971422  -0.0011605665   0              0.010451993    1.2493173e-05  0              1.2065012      1.1965779e-13  0              2.9948993    
   1500000   7170           200            200            0.0030975034  -0.001160608    0              0.010453118    2.4452488e-06  0              0.23614463     1.1965779e-13  0              2.994899     
   1600000   7170           200            200            0.0030974953  -0.0011606067   0              0.010453093    3.6532493e-10  0              3.5280467e-05  1.1965779e-13  0              2.994899     
   1700000   7170           200            200            0.0030974442  -0.0011606008   0              0.010452933    4.6857895e-08  0              0.0045252001   1.1965779e-13  0              2.994899     
   1800000   7170           200            200            0.0030974304  -0.0011605992   0              0.01045289     3.6917245e-09  0              0.00035652033  1.1965779e-13  0              2.994899     
   1900000   7170           200            200            0.0030974332  -0.0011605995   0              0.010452899    1.3026766e-10  0              1.2580318e-05  1.1965779e-13  0              2.994899     
   2000000   7170           200            200            0.0030974359  -0.0011605998   0              0.010452908    1.3300286e-10  0              1.2844464e-05  1.1965779e-13  0              2.994899     
   2100000   7170           200            200            0.0030974363  -0.0011605999   0              0.010452909    3.3675819e-12  0              3.2521695e-07  1.1965779e-13  0              2.994899     
   2200000   7170           200            200            0.0030974361  -0.0011605999   0              0.010452908    1.0366109e-12  0              1.0010846e-07  1.1965779e-13  0              2.994899     
   2300000   7170           200            200            0.0030974359  -0.0011605998   0              0.010452908    2.9782872e-13  0              2.8762166e-08  1.1965779e-13  0              2.994899     
   2400000   7170           200            200            0.0030974359  -0.0011605998   0              0.010452908    4.7313903e-16  0              4.5692381e-11  1.1965779e-13  0              2.994899     
   2500000   7170           200            200            0.003097436   -0.0011605998   0              0.010452908    4.5244088e-15  0              4.3693501e-10  1.1965779e-13  0              2.994899     
   2600000   7170           200            200            0.003097436   -0.0011605998   0              0.010452908    4.9555617e-16  0              4.7857268e-11  1.1965779e-13  0              2.994899     
   2700000   7170           200            200            0.003097436   -0.0011605998   0              0.010452908    3.933565e-18   0              3.7987555e-13  1.1965779e-13  0              2.994899     
   2800000   7170           200            200            0.003097436   -0.0011605998   0              0.010452908    1.1863319e-17  0              1.1456744e-12  1.1965779e-13  0              2.994899     
   2900000   7170           200            200            0.003097436   -0.0011605998   0              0.010452908    2.9550164e-18  0              2.8537433e-13  1.1965779e-13  0              2.994899     
   3000000   7170           200            200            0.003097436   -0.0011605998   0              0.010452908    8.7635533e-19  0              8.4632125e-14  1.1965779e-13  0              2.994899     
Loop time of 298.89 on 4 procs for 3000000 steps with 2501 atoms

Performance: 8672087.698 ns/day, 0.000 hours/ns, 10037.139 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 11.181     | 37.427     | 64.838     | 427.4 | 12.52
Neigh   | 4.4309     | 4.5114     | 4.5926     |   3.3 |  1.51
Comm    | 18.815     | 40.488     | 81.375     | 379.0 | 13.55
Output  | 0.2722     | 0.27252    | 0.27283    |   0.1 |  0.09
Modify  | 110.21     | 159.69     | 177.93     | 226.6 | 53.43
Other   |            | 56.5       |            |       | 18.90

Nlocal:         625.25 ave         876 max         375 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:           1.75 ave           3 max           1 min
Histogram: 2 0 0 0 0 1 0 0 0 1
Neighs:         332.75 ave         666 max           0 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 1331
Ave neighs/atom = 0.53218713
Neighbor list builds = 164
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 79

#variable lat0 equal 1                    #
variable lat1 equal 3+(100*0.01)+(v_ind*0.01)  # .491+(v_ind*0.001)       # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 500*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.79                                                               
Lattice spacing in x,y,z = 4.79 4.79 4.79

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -3592.5 ${n1e1} -100 100 -100 100 units box
region box block -3592.5 3592.5 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -3592.5 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -3592.5 3592.5 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-3592.5 -100 -100) to (3592.5 100 100)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 1500 atoms
  using lattice units in orthogonal box = (-3592.5 -100 -100) to (3592.5 100 100)
  create_atoms CPU = 0.000 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 1500 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 1001 atoms
  using lattice units in orthogonal box = (-3592.5 -100 -100) to (3592.5 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  1500 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  1500 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  1001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  1001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
1500 atoms in group substrate
group slider1 region slider1
1001 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 1001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_79_*.dump id type diameter mass xu yu zu fx fy fz

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 4636 130 130
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 93.79 | 93.79 | 93.8 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   7185           200            200            0              0              0              0              0              0              0              1.1965779e-13  0              6            
    100000   7185           200            200            0.0028202294   1.6012683e-41  0              0.0084606883   582052.2       0              5.6210435e+10  1.1965779e-13  0              3.3290607    
    200000   7185           200            200            0.00097848506  1.4053484e-36  0              0.0029354552   137243.9       0              1.3254034e+10  1.1965779e-13  0              3.0787261    
    300000   7185           200            200            3.4750457e-05  1.2811424e-40  0              0.00010425137  371.13939      0              35841986       1.1965779e-13  0              3.0454195    
    400000   7185           200            200            0.00010387488  5.2482799e-40  0              0.00031162464  3097.259       0              2.991111e+08   1.1965779e-13  0              3.0036677    
    500000   7185           200            200            0.0011159198  -0.0010631287   0              0.0044108883   1006.711       0              97220944       1.1965779e-13  0              2.9967008    
    600000   7185           200            200            0.0047579011  -0.00056720254  0              0.014840906    5.6202435      0              542762.89      1.1965779e-13  0              2.9940208    
    700000   7185           200            200            0.0036670696  -0.00093651823  0              0.011937727    2.5813154      0              249284.97      1.1965779e-13  0              2.9946487    
    800000   7185           200            200            0.0032633148  -0.0011381523   0              0.010928097    0.93291773     0              90094.517      1.1965779e-13  0              2.9948821    
    900000   7185           200            200            0.003145355   -0.0011621794   0              0.010598244    0.1848694      0              17853.364      1.1965779e-13  0              2.9949599    
   1000000   7185           200            200            0.0031065057  -0.0011672187   0              0.010486736    0.032806991    0              3168.2643      1.1965779e-13  0              2.9949864    
   1100000   7185           200            200            0.0030938694  -0.0011677187   0              0.010449327    0.0054871353   0              529.90825      1.1965779e-13  0              2.9949953    
   1200000   7185           200            200            0.0030897121  -0.001167894    0              0.01043703     0.00087656746  0              84.652611      1.1965779e-13  0              2.9949982    
   1300000   7185           200            200            0.0030883842  -0.0011679509   0              0.010433104    0.00013470375  0              13.008724      1.1965779e-13  0              2.9949992    
   1400000   7185           200            200            0.0030879764  -0.0011679684   0              0.010431898    2.0006109e-05  0              1.9320468      1.1965779e-13  0              2.9949995    
   1500000   7185           200            200            0.0030878581  -0.0011679734   0              0.010431548    2.8806391e-06  0              0.2781915      1.1965779e-13  0              2.9949995    
   1600000   7185           200            200            0.0030878267  -0.0011679747   0              0.010431455    4.0291355e-07  0              0.038910507    1.1965779e-13  0              2.9949996    
   1700000   7185           200            200            0.0030878199  -0.001167975    0              0.010431435    5.480062e-08   0              0.0052922517   1.1965779e-13  0              2.9949996    
   1800000   7185           200            200            0.0030878191  -0.001167975    0              0.010431432    7.2495389e-09  0              0.00070010858  1.1965779e-13  0              2.9949996    
   1900000   7185           200            200            0.0030878194  -0.001167975    0              0.010431433    9.3229691e-10  0              9.0034562e-05  1.1965779e-13  0              2.9949996    
   2000000   7185           200            200            0.0030878198  -0.001167975    0              0.010431434    1.1638737e-10  0              1.1239859e-05  1.1965779e-13  0              2.9949996    
   2100000   7185           200            200            0.00308782    -0.001167975    0              0.010431435    1.4071234e-11  0              1.3588991e-06  1.1965779e-13  0              2.9949996    
   2200000   7185           200            200            0.0030878201  -0.001167975    0              0.010431435    1.6414068e-12  0              1.5851532e-07  1.1965779e-13  0              2.9949996    
   2300000   7185           200            200            0.0030878201  -0.001167975    0              0.010431435    1.842771e-13   0              1.7796163e-08  1.1965779e-13  0              2.9949996    
   2400000   7185           200            200            0.0030878202  -0.001167975    0              0.010431435    1.9846141e-14  0              1.9165983e-09  1.1965779e-13  0              2.9949996    
   2500000   7185           200            200            0.0030878202  -0.001167975    0              0.010431435    1.9987385e-15  0              1.9302386e-10  1.1965779e-13  0              2.9949996    
   2600000   7185           200            200            0.0030878202  -0.001167975    0              0.010431435    1.6877436e-16  0              1.6299019e-11  1.1965779e-13  0              2.9949996    
   2700000   7185           200            200            0.0030878202  -0.001167975    0              0.010431435    1.4702456e-17  0              1.419858e-12   1.1965779e-13  0              2.9949996    
   2800000   7185           200            200            0.0030878202  -0.001167975    0              0.010431435    2.4979798e-18  0              2.4123701e-13  1.1965779e-13  0              2.9949996    
   2900000   7185           200            200            0.0030878202  -0.001167975    0              0.010431435    1.7112881e-20  0              1.6526395e-15  1.1965779e-13  0              2.9949996    
   3000000   7185           200            200            0.0030878202  -0.001167975    0              0.010431435    1.490253e-18   0              1.4391797e-13  1.1965779e-13  0              2.9949996    
Loop time of 295.587 on 4 procs for 3000000 steps with 2501 atoms

Performance: 8768995.081 ns/day, 0.000 hours/ns, 10149.300 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 11.013     | 37.52      | 64.95      | 429.9 | 12.69
Neigh   | 4.4554     | 4.5384     | 4.621      |   3.4 |  1.54
Comm    | 19.284     | 39.007     | 79.051     | 375.4 | 13.20
Output  | 0.27131    | 0.27164    | 0.27197    |   0.1 |  0.09
Modify  | 109.12     | 157.8      | 176.76     | 224.8 | 53.38
Other   |            | 56.45      |            |       | 19.10

Nlocal:         625.25 ave         876 max         375 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:           1.75 ave           3 max           1 min
Histogram: 2 0 0 0 0 1 0 0 0 1
Neighs:         332.75 ave         666 max           0 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 1331
Ave neighs/atom = 0.53218713
Neighbor list builds = 164
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 80

#variable lat0 equal 1                    #
variable lat1 equal 3+(100*0.01)+(v_ind*0.01)  # .491+(v_ind*0.001)       # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 500*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.8                                                               
Lattice spacing in x,y,z = 4.8 4.8 4.8

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -3600 ${n1e1} -100 100 -100 100 units box
region box block -3600 3600 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -3600 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -3600 3600 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-3600 -100 -100) to (3600 100 100)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 1500 atoms
  using lattice units in orthogonal box = (-3600 -100 -100) to (3600 100 100)
  create_atoms CPU = 0.000 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 1500 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 1001 atoms
  using lattice units in orthogonal box = (-3600 -100 -100) to (3600 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  1500 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  1500 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  1001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  1001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
1500 atoms in group substrate
group slider1 region slider1
1001 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 1001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_80_*.dump id type diameter mass xu yu zu fx fy fz

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 4646 130 130
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 93.94 | 93.97 | 93.99 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   7200           200            200            0              0              0              0              0              0              0              1.1965779e-13  0              6            
    100000   7200           200            200            0.0028118119   3.0292266e-34  0              0.0084354358   580699.99      0              5.6079848e+10  1.1965779e-13  0              3.3342708    
    200000   7200           200            200            0.00096769514  2.2623085e-40  0              0.0029030854   135088.23      0              1.3045854e+10  1.1965779e-13  0              3.0854772    
    300000   7200           200            200            4.483226e-05   3.3894089e-40  0              0.00013449678  609.815        0              58891568       1.1965779e-13  0              3.0489738    
    400000   7200           200            200            0.0048645943   2.019487e-34   0              0.014593783    10924.661      0              1.0550256e+09  1.1965779e-13  0              2.9969394    
    500000   7200           200            200            0.0093213046   2.0194862e-34  0              0.027963914    24.988552      0              2413215.5      1.1965779e-13  0              2.9951408    
    600000   7200           200            200            0.0016738223   2.2438887e-35  0              0.0050214669   0.25473389     0              24600.376      1.1965779e-13  0              2.998454     
    700000   7200           200            200            0.0027807947   7.8535641e-35  0              0.008342384    0.4001698      0              38645.535      1.1965779e-13  0              2.9978298    
    800000   7200           200            200            0.0032141469  -8.9754696e-35  0              0.0096424407   0.014663819    0              1416.1267      1.1965779e-13  0              2.9976105    
    900000   7200           200            200            0.0033805954  -1.1219243e-35  0              0.010141786    0.042657917    0              4119.5963      1.1965779e-13  0              2.9975287    
   1000000   7200           200            200            0.0034416029   7.8535555e-35  0              0.010324809    0.017865496    0              1725.3217      1.1965779e-13  0              2.997499     
   1100000   7200           200            200            0.003462845   -1.1219314e-35  0              0.010388535    0.004644357    0              448.51876      1.1965779e-13  0              2.9974886    
   1200000   7200           200            200            0.0034698521  -2.8048356e-35  0              0.010409556    0.0009543111   0              92.160535      1.1965779e-13  0              2.9974852    
   1300000   7200           200            200            0.0034720169   8.4145479e-36  0              0.010416051    0.00016861364  0              16.283498      1.1965779e-13  0              2.9974841    
   1400000   7200           200            200            0.0034726264  -2.8048056e-36  0              0.010417879    2.6585432e-05  0              2.5674307      1.1965779e-13  0              2.9974838    
   1500000   7200           200            200            0.0034727722   1.6829066e-35  0              0.010418317    3.8052024e-06  0              0.36747921     1.1965779e-13  0              2.9974838    
   1600000   7200           200            200            0.0034727948  -1.6828999e-35  0              0.010418384    4.9735329e-07  0              0.048030821    1.1965779e-13  0              2.9974838    
   1700000   7200           200            200            0.0034727913   5.6097111e-36  0              0.010418374    5.9197753e-08  0              0.0057168953   1.1965779e-13  0              2.9974838    
   1800000   7200           200            200            0.0034727858  -1.6828999e-35  0              0.010418357    6.3362561e-09  0              0.00061191026  1.1965779e-13  0              2.9974838    
   1900000   7200           200            200            0.0034727823   3.3544817e-41  0              0.010418347    5.9287288e-10  0              5.725542e-05   1.1965779e-13  0              2.9974838    
   2000000   7200           200            200            0.0034727806  -4.2072247e-36  0              0.010418342    4.5578459e-11  0              4.4016414e-06  1.1965779e-13  0              2.9974838    
   2100000   7200           200            200            0.0034727798  -5.6096441e-36  0              0.010418339    2.4501254e-12  0              2.3661558e-07  1.1965779e-13  0              2.9974838    
   2200000   7200           200            200            0.0034727794  -1.4023859e-36  0              0.010418338    4.5802035e-14  0              4.4232327e-09  1.1965779e-13  0              2.9974838    
   2300000   7200           200            200            0.0034727793   3.3521618e-41  0              0.010418338    3.1700639e-15  0              3.0614208e-10  1.1965779e-13  0              2.9974838    
   2400000   7200           200            200            0.0034727793   1.4024529e-36  0              0.010418338    4.8553185e-15  0              4.688919e-10   1.1965779e-13  0              2.9974838    
   2500000   7200           200            200            0.0034727792   3.3471747e-41  0              0.010418338    1.8238984e-15  0              1.7613905e-10  1.1965779e-13  0              2.9974838    
   2600000   7200           200            200            0.0034727792  -1.7526891e-37  0              0.010418338    4.4854064e-16  0              4.3316844e-11  1.1965779e-13  0              2.9974838    
   2700000   7200           200            200            0.0034727792  -5.2587364e-37  0              0.010418338    5.0042857e-17  0              4.832781e-12   1.1965779e-13  0              2.9974838    
   2800000   7200           200            200            0.0034727792   3.3541771e-41  0              0.010418338    4.2196048e-18  0              4.0749923e-13  1.1965779e-13  0              2.9974838    
   2900000   7200           200            200            0.0034727792   7.0124328e-37  0              0.010418338    2.6742353e-18  0              2.582585e-13   1.1965779e-13  0              2.9974838    
   3000000   7200           200            200            0.0034727792  -2.1035943e-36  0              0.010418338    2.2846875e-19  0              2.2063877e-14  1.1965779e-13  0              2.9974838    
Loop time of 301.347 on 4 procs for 3000000 steps with 2501 atoms

Performance: 8601378.046 ns/day, 0.000 hours/ns, 9955.299 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 11.169     | 39.156     | 67.618     | 445.4 | 12.99
Neigh   | 4.4991     | 4.5795     | 4.6604     |   3.4 |  1.52
Comm    | 19.061     | 39.57      | 81.959     | 394.0 | 13.13
Output  | 0.2712     | 0.27153    | 0.27186    |   0.1 |  0.09
Modify  | 110.76     | 160.63     | 179.15     | 227.8 | 53.31
Other   |            | 57.14      |            |       | 18.96

Nlocal:         625.25 ave         876 max         375 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:           1.75 ave           3 max           1 min
Histogram: 2 0 0 0 0 1 0 0 0 1
Neighs:         343.75 ave         688 max           0 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 1375
Ave neighs/atom = 0.54978009
Neighbor list builds = 166
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 81

#variable lat0 equal 1                    #
variable lat1 equal 3+(100*0.01)+(v_ind*0.01)  # .491+(v_ind*0.001)       # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 500*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.81                                                               
Lattice spacing in x,y,z = 4.81 4.81 4.81

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -3607.5 ${n1e1} -100 100 -100 100 units box
region box block -3607.5 3607.5 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -3607.5 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -3607.5 3607.5 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-3607.5 -100 -100) to (3607.5 100 100)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 1500 atoms
  using lattice units in orthogonal box = (-3607.5 -100 -100) to (3607.5 100 100)
  create_atoms CPU = 0.000 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 1500 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 1001 atoms
  using lattice units in orthogonal box = (-3607.5 -100 -100) to (3607.5 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  1500 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  1500 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  1001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  1001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
1500 atoms in group substrate
group slider1 region slider1
1001 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 1001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_81_*.dump id type diameter mass xu yu zu fx fy fz

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 4655 130 130
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 94.13 | 94.14 | 94.15 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   7215           200            200            0              0              0              0              0              0              0              1.1965779e-13  0              6            
    100000   7215           200            200            0.0028084535  -5.5979997e-36  0              0.0084253605   582035.14      0              5.6208788e+10  1.1965779e-13  0              3.3290867    
    200000   7215           200            200            0.00097437264 -2.2391482e-35  0              0.0029231179   137234.04      0              1.3253081e+10  1.1965779e-13  0              3.0787381    
    300000   7215           200            200            3.4577754e-05  1.2774619e-39  0              0.00010373326  370.55018      0              35785084       1.1965779e-13  0              3.0454201    
    400000   7215           200            200            0.00010341388 -8.9567835e-35  0              0.00031024165  3095.6281      0              2.9895361e+08  1.1965779e-13  0              3.0036694    
    500000   7215           200            200            0.0017934785   0.00098532519  0              0.0043951102   1007.2588      0              97273847       1.1965779e-13  0              2.9966998    
    600000   7215           200            200            0.0051035909   0.00053119916  0              0.014779573    5.5903302      0              539874.08      1.1965779e-13  0              2.9940207    
    700000   7215           200            200            0.0042501896   0.00086267744  0              0.011887891    2.588251       0              249954.76      1.1965779e-13  0              2.9946487    
    800000   7215           200            200            0.0039290478   0.00090460345  0              0.01088254     0.93429181     0              90227.216      1.1965779e-13  0              2.9948821    
    900000   7215           200            200            0.0038089047   0.0008725893   0              0.010554125    0.1850748      0              17873.2        1.1965779e-13  0              2.99496      
   1000000   7215           200            200            0.0037703452   0.00086792582  0              0.01044311     0.032835671    0              3171.0341      1.1965779e-13  0              2.9949864    
   1100000   7215           200            200            0.0037580122   0.00086816716  0              0.010405869    0.0054909295   0              530.27467      1.1965779e-13  0              2.9949953    
   1200000   7215           200            200            0.0037539552   0.00086823635  0              0.010393629    0.00087704155  0              84.698396      1.1965779e-13  0              2.9949982    
   1300000   7215           200            200            0.0037526595   0.00086825728  0              0.010389721    0.00013475912  0              13.014071      1.1965779e-13  0              2.9949992    
   1400000   7215           200            200            0.0037522616   0.00086826355  0              0.010388521    2.0012024e-05  0              1.932618       1.1965779e-13  0              2.9949995    
   1500000   7215           200            200            0.0037521461   0.00086826534  0              0.010388173    2.8811842e-06  0              0.27824414     1.1965779e-13  0              2.9949995    
   1600000   7215           200            200            0.0037521156   0.0008682658   0              0.010388081    4.029493e-07   0              0.038913959    1.1965779e-13  0              2.9949996    
   1700000   7215           200            200            0.0037521088   0.0008682659   0              0.010388061    5.4800275e-08  0              0.0052922184   1.1965779e-13  0              2.9949996    
   1800000   7215           200            200            0.0037521081   0.00086826591  0              0.010388058    7.2488207e-09  0              0.00070003922  1.1965779e-13  0              2.9949996    
   1900000   7215           200            200            0.0037521084   0.0008682659   0              0.010388059    9.3210687e-10  0              9.001621e-05   1.1965779e-13  0              2.9949996    
   2000000   7215           200            200            0.0037521087   0.0008682659   0              0.01038806     1.1634839e-10  0              1.1236095e-05  1.1965779e-13  0              2.9949996    
   2100000   7215           200            200            0.003752109    0.00086826589  0              0.010388061    1.4065345e-11  0              1.3583303e-06  1.1965779e-13  0              2.9949996    
   2200000   7215           200            200            0.0037521091   0.00086826589  0              0.010388061    1.6415145e-12  0              1.5852572e-07  1.1965779e-13  0              2.9949996    
   2300000   7215           200            200            0.0037521091   0.00086826589  0              0.010388061    1.8405475e-13  0              1.7774691e-08  1.1965779e-13  0              2.9949996    
   2400000   7215           200            200            0.0037521091   0.00086826589  0              0.010388061    1.9805582e-14  0              1.9126814e-09  1.1965779e-13  0              2.9949996    
   2500000   7215           200            200            0.0037521091   0.00086826589  0              0.010388062    1.9806531e-15  0              1.912773e-10   1.1965779e-13  0              2.9949996    
   2600000   7215           200            200            0.0037521091   0.00086826589  0              0.010388062    1.6526618e-16  0              1.5960225e-11  1.1965779e-13  0              2.9949996    
   2700000   7215           200            200            0.0037521091   0.00086826589  0              0.010388062    1.428178e-17   0              1.3792321e-12  1.1965779e-13  0              2.9949996    
   2800000   7215           200            200            0.0037521091   0.00086826589  0              0.010388062    1.9653371e-18  0              1.8979819e-13  1.1965779e-13  0              2.9949996    
   2900000   7215           200            200            0.0037521091   0.00086826589  0              0.010388062    2.124576e-19   0              2.0517634e-14  1.1965779e-13  0              2.9949996    
   3000000   7215           200            200            0.0037521091   0.00086826589  0              0.010388062    4.3685367e-20  0              4.2188201e-15  1.1965779e-13  0              2.9949996    
Loop time of 297.993 on 4 procs for 3000000 steps with 2501 atoms

Performance: 8698188.770 ns/day, 0.000 hours/ns, 10067.348 timesteps/s
99.9% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 11.181     | 37.588     | 65.421     | 429.1 | 12.61
Neigh   | 4.4589     | 4.5442     | 4.6296     |   3.5 |  1.52
Comm    | 18.734     | 24.863     | 29.659     |  95.2 |  8.34
Output  | 0.27452    | 0.27485    | 0.27517    |   0.1 |  0.09
Modify  | 169.07     | 174.05     | 178.16     |  29.7 | 58.41
Other   |            | 56.67      |            |       | 19.02

Nlocal:         625.25 ave         877 max         374 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:           1.75 ave           3 max           1 min
Histogram: 2 0 0 0 0 1 0 0 0 1
Neighs:         332.25 ave         665 max           0 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 1329
Ave neighs/atom = 0.53138745
Neighbor list builds = 164
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 82

#variable lat0 equal 1                    #
variable lat1 equal 3+(100*0.01)+(v_ind*0.01)  # .491+(v_ind*0.001)       # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 500*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.82                                                               
Lattice spacing in x,y,z = 4.82 4.82 4.82

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -3615 ${n1e1} -100 100 -100 100 units box
region box block -3615 3615 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -3615 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -3615 3615 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-3615 -100 -100) to (3615 100 100)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 1500 atoms
  using lattice units in orthogonal box = (-3615 -100 -100) to (3615 100 100)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 1500 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 1001 atoms
  using lattice units in orthogonal box = (-3615 -100 -100) to (3615 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  1500 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  1500 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  1001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  1001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
1500 atoms in group substrate
group slider1 region slider1
1001 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 1001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_82_*.dump id type diameter mass xu yu zu fx fy fz

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 4665 130 130
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 94.34 | 94.35 | 94.35 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   7230           200            200            0              0              0              0              0              0              0              1.1965779e-13  0              6            
    100000   7230           200            200            0.0028026416  -1.7876481e-34  0              0.0084079247   582052.61      0              5.6210475e+10  1.1965779e-13  0              3.3289786    
    200000   7230           200            200            0.0009726074   1.3407516e-34  0              0.0029178222   137297.12      0              1.3259173e+10  1.1965779e-13  0              3.0785509    
    300000   7230           200            200            3.4982937e-05 -5.5863749e-36  0              0.00010494881  380.61932      0              36757489       1.1965779e-13  0              3.0452957    
    400000   7230           200            200            0.00010223201 -4.4690348e-35  0              0.00030669603  3041.6851      0              2.9374417e+08  1.1965779e-13  0              3.0036155    
    500000   7230           200            200            0.0025658967   0.00082736474  0              0.0068703254   1363.7011      0              1.3169649e+08  1.1965779e-13  0              2.9957933    
    600000   7230           200            200            0.0048072977   0.0013908034   0              0.01303109     128.44338      0              12404142       1.1965779e-13  0              2.9942892    
    700000   7230           200            200            0.0036558018   0.0013777867   0              0.0095896187   19.81575       0              1913663.3      1.1965779e-13  0              2.9951005    
    800000   7230           200            200            0.0037131894   0.0013173966   0              0.0098221716   0.097548801    0              9420.5649      1.1965779e-13  0              2.9950349    
    900000   7230           200            200            0.0038789927   0.0013215089   0              0.010315469    0.46796808     0              45193.008      1.1965779e-13  0              2.9949107    
   1000000   7230           200            200            0.0039163897   0.0013238106   0              0.010425358    0.024514638    0              2367.4482      1.1965779e-13  0              2.9948842    
   1100000   7230           200            200            0.0039044208   0.0013230298   0              0.010390233    0.0021690359   0              209.46996      1.1965779e-13  0              2.9948931    
   1200000   7230           200            200            0.0038959048   0.0013224933   0              0.010365221    0.0012053048   0              116.39971      1.1965779e-13  0              2.9948993    
   1300000   7230           200            200            0.0038950277   0.0013224415   0              0.010362642    1.5051729e-05  0              1.4535883      1.1965779e-13  0              2.9948999    
   1400000   7230           200            200            0.0038959189   0.0013224985   0              0.010365258    1.2578103e-05  0              1.2147031      1.1965779e-13  0              2.9948993    
   1500000   7230           200            200            0.003896298    0.0013225222   0              0.010366372    2.43653e-06    0              0.23530263     1.1965779e-13  0              2.994899     
   1600000   7230           200            200            0.0038962888   0.0013225214   0              0.010366345    4.6428515e-10  0              4.4837337e-05  1.1965779e-13  0              2.994899     
   1700000   7230           200            200            0.003896235    0.001322518    0              0.010366187    4.7003141e-08  0              0.004539227    1.1965779e-13  0              2.994899     
   1800000   7230           200            200            0.0038962205   0.0013225171   0              0.010366144    3.6638215e-09  0              0.00035382566  1.1965779e-13  0              2.994899     
   1900000   7230           200            200            0.0038962235   0.0013225173   0              0.010366153    1.3284257e-10  0              1.2828985e-05  1.1965779e-13  0              2.994899     
   2000000   7230           200            200            0.0038962263   0.0013225175   0              0.010366161    1.3304087e-10  0              1.2848135e-05  1.1965779e-13  0              2.994899     
   2100000   7230           200            200            0.0038962267   0.0013225175   0              0.010366163    3.3157223e-12  0              3.2020872e-07  1.1965779e-13  0              2.994899     
   2200000   7230           200            200            0.0038962265   0.0013225175   0              0.010366162    1.0450965e-12  0              1.0092794e-07  1.1965779e-13  0              2.994899     
   2300000   7230           200            200            0.0038962263   0.0013225175   0              0.010366162    2.9688101e-13  0              2.8670643e-08  1.1965779e-13  0              2.994899     
   2400000   7230           200            200            0.0038962263   0.0013225175   0              0.010366162    4.2999406e-16  0              4.1525749e-11  1.1965779e-13  0              2.994899     
   2500000   7230           200            200            0.0038962264   0.0013225175   0              0.010366162    4.5725122e-15  0              4.415805e-10   1.1965779e-13  0              2.994899     
   2600000   7230           200            200            0.0038962264   0.0013225175   0              0.010366162    4.8370213e-16  0              4.6712489e-11  1.1965779e-13  0              2.994899     
   2700000   7230           200            200            0.0038962264   0.0013225175   0              0.010366162    4.2306547e-18  0              4.0856635e-13  1.1965779e-13  0              2.994899     
   2800000   7230           200            200            0.0038962264   0.0013225175   0              0.010366162    1.1550415e-17  0              1.1154564e-12  1.1965779e-13  0              2.994899     
   2900000   7230           200            200            0.0038962264   0.0013225175   0              0.010366162    1.7245483e-18  0              1.6654453e-13  1.1965779e-13  0              2.994899     
   3000000   7230           200            200            0.0038962264   0.0013225175   0              0.010366162    1.659913e-19   0              1.6030252e-14  1.1965779e-13  0              2.994899     
Loop time of 294.731 on 4 procs for 3000000 steps with 2501 atoms

Performance: 8794458.803 ns/day, 0.000 hours/ns, 10178.772 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 10.898     | 37.126     | 63.971     | 427.4 | 12.60
Neigh   | 4.5209     | 4.5992     | 4.6766     |   3.2 |  1.56
Comm    | 19.582     | 38.74      | 78.105     | 370.0 | 13.14
Output  | 0.27349    | 0.27381    | 0.27418    |   0.1 |  0.09
Modify  | 109.15     | 157.59     | 177.2      | 224.2 | 53.47
Other   |            | 56.4       |            |       | 19.14

Nlocal:         625.25 ave         876 max         375 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:           1.75 ave           3 max           1 min
Histogram: 2 0 0 0 0 1 0 0 0 1
Neighs:         332.25 ave         665 max           0 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 1329
Ave neighs/atom = 0.53138745
Neighbor list builds = 164
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 83

#variable lat0 equal 1                    #
variable lat1 equal 3+(100*0.01)+(v_ind*0.01)  # .491+(v_ind*0.001)       # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 500*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.83                                                               
Lattice spacing in x,y,z = 4.83 4.83 4.83

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -3622.5 ${n1e1} -100 100 -100 100 units box
region box block -3622.5 3622.5 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -3622.5 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -3622.5 3622.5 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-3622.5 -100 -100) to (3622.5 100 100)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 1500 atoms
  using lattice units in orthogonal box = (-3622.5 -100 -100) to (3622.5 100 100)
  create_atoms CPU = 0.000 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 1500 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 1001 atoms
  using lattice units in orthogonal box = (-3622.5 -100 -100) to (3622.5 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  1500 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  1500 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  1001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  1001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
1500 atoms in group substrate
group slider1 region slider1
1001 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 1001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_83_*.dump id type diameter mass xu yu zu fx fy fz

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 4675 130 130
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 94.48 | 94.49 | 94.49 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   7245           200            200            0              0              0              0              0              0              0              1.1965779e-13  0              6            
    100000   7245           200            200            0.0027968374   2.0905633e-36  0              0.0083905121   582063.53      0              5.6211529e+10  1.1965779e-13  0              3.3288863    
    200000   7245           200            200            0.00097071756  4.4599013e-35  0              0.0029121527   137330.16      0              1.3262364e+10  1.1965779e-13  0              3.0784054    
    300000   7245           200            200            3.3754768e-05 -4.4598359e-35  0              0.0001012643   356.47378      0              34425686       1.1965779e-13  0              3.0452308    
    400000   7245           200            200            9.6736025e-05 -1.1149645e-34  0              0.00029020807  2752.8813      0              2.6585357e+08  1.1965779e-13  0              3.0038504    
    500000   7245           200            200            0.0033468049   0.00057604853  0              0.0094643662   1509.1711      0              1.4574494e+08  1.1965779e-13  0              2.9950248    
    600000   7245           200            200            0.0040501859   0.00079063027  0              0.011359928    193.31178      0              18668668       1.1965779e-13  0              2.9946169    
    700000   7245           200            200            0.0032383414   0.00079162335  0              0.0089234007   1.5605434      0              150706.11      1.1965779e-13  0              2.9952188    
    800000   7245           200            200            0.0037325885   0.00085434758  0              0.010343418    3.6613112      0              353583.23      1.1965779e-13  0              2.9948473    
    900000   7245           200            200            0.0037993939   0.00085808046  0              0.010540101    0.033073604    0              3194.0119      1.1965779e-13  0              2.9948008    
   1000000   7245           200            200            0.0037209018   0.00085340464  0              0.010309301    0.050982098    0              4923.4861      1.1965779e-13  0              2.9948586    
   1100000   7245           200            200            0.0037260641   0.00085375247  0              0.01032444     0.004150942    0              400.86827      1.1965779e-13  0              2.9948544    
   1200000   7245           200            200            0.0037357209   0.00085433604  0              0.010352827    0.00036375476  0              35.128831      1.1965779e-13  0              2.9948474    
   1300000   7245           200            200            0.0037333191   0.00085418679  0              0.010345771    0.00014549963  0              14.051313      1.1965779e-13  0              2.9948492    
   1400000   7245           200            200            0.0037324415   0.00085413464  0              0.01034319     1.9322035e-07  0              0.018659838    1.1965779e-13  0              2.9948498    
   1500000   7245           200            200            0.0037329205   0.00085416402  0              0.010344597    2.9049498e-06  0              0.28053926     1.1965779e-13  0              2.9948495    
   1600000   7245           200            200            0.0037329542   0.00085416586  0              0.010344697    5.8567086e-08  0              0.00565599     1.1965779e-13  0              2.9948494    
   1700000   7245           200            200            0.0037328836   0.00085416157  0              0.010344489    3.4995951e-08  0              0.0033796585   1.1965779e-13  0              2.9948495    
   1800000   7245           200            200            0.0037328916   0.00085416208  0              0.010344513    4.3172638e-09  0              0.00041693044  1.1965779e-13  0              2.9948495    
   1900000   7245           200            200            0.0037328997   0.00085416257  0              0.010344536    1.8531585e-10  0              1.7896478e-05  1.1965779e-13  0              2.9948495    
   2000000   7245           200            200            0.0037328972   0.00085416241  0              0.010344529    1.2696413e-10  0              1.2261287e-05  1.1965779e-13  0              2.9948495    
   2100000   7245           200            200            0.0037328965   0.00085416238  0              0.010344527    2.4292261e-14  0              2.3459727e-09  1.1965779e-13  0              2.9948495    
   2200000   7245           200            200            0.003732897    0.0008541624   0              0.010344529    2.2258511e-12  0              2.1495677e-07  1.1965779e-13  0              2.9948495    
   2300000   7245           200            200            0.003732897    0.0008541624   0              0.010344529    8.0490036e-14  0              7.7731515e-09  1.1965779e-13  0              2.9948495    
   2400000   7245           200            200            0.0037328969   0.0008541624   0              0.010344528    2.2968454e-14  0              2.2181289e-09  1.1965779e-13  0              2.9948495    
   2500000   7245           200            200            0.0037328969   0.0008541624   0              0.010344528    4.242697e-15   0              4.0972931e-10  1.1965779e-13  0              2.9948495    
   2600000   7245           200            200            0.0037328969   0.0008541624   0              0.010344528    5.0705046e-17  0              4.8967304e-12  1.1965779e-13  0              2.9948495    
   2700000   7245           200            200            0.0037328969   0.0008541624   0              0.010344528    1.0449347e-16  0              1.0091231e-11  1.1965779e-13  0              2.9948495    
   2800000   7245           200            200            0.0037328969   0.0008541624   0              0.010344528    1.1617152e-19  0              1.1219014e-14  1.1965779e-13  0              2.9948495    
   2900000   7245           200            200            0.0037328969   0.0008541624   0              0.010344528    6.9149262e-18  0              6.6779408e-13  1.1965779e-13  0              2.9948495    
   3000000   7245           200            200            0.0037328969   0.0008541624   0              0.010344528    2.2795298e-18  0              2.2014067e-13  1.1965779e-13  0              2.9948495    
Loop time of 296.157 on 4 procs for 3000000 steps with 2501 atoms

Performance: 8752104.018 ns/day, 0.000 hours/ns, 10129.750 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 10.935     | 37.152     | 63.959     | 427.0 | 12.54
Neigh   | 4.4915     | 4.5713     | 4.6532     |   3.3 |  1.54
Comm    | 19.676     | 38.763     | 78.058     | 369.2 | 13.09
Output  | 0.27056    | 0.27089    | 0.27121    |   0.1 |  0.09
Modify  | 109.19     | 158.29     | 178.73     | 227.0 | 53.45
Other   |            | 57.11      |            |       | 19.28

Nlocal:         625.25 ave         876 max         375 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:           1.75 ave           3 max           1 min
Histogram: 2 0 0 0 0 1 0 0 0 1
Neighs:         332.25 ave         665 max           0 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 1329
Ave neighs/atom = 0.53138745
Neighbor list builds = 164
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 84

#variable lat0 equal 1                    #
variable lat1 equal 3+(100*0.01)+(v_ind*0.01)  # .491+(v_ind*0.001)       # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 500*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.84                                                               
Lattice spacing in x,y,z = 4.84 4.84 4.84

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -3630 ${n1e1} -100 100 -100 100 units box
region box block -3630 3630 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -3630 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -3630 3630 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-3630 -100 -100) to (3630 100 100)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 1500 atoms
  using lattice units in orthogonal box = (-3630 -100 -100) to (3630 100 100)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 1500 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 1001 atoms
  using lattice units in orthogonal box = (-3630 -100 -100) to (3630 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  1500 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  1500 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  1001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  1001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
1500 atoms in group substrate
group slider1 region slider1
1001 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 1001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_84_*.dump id type diameter mass xu yu zu fx fy fz

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 4684 130 130
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 94.62 | 94.63 | 94.63 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   7260           200            200            0              0              0              0              0              0              0              1.1965779e-13  0              6            
    100000   7260           200            200            0.0027910058   5.5633539e-36  0              0.0083730175   582050.64      0              5.6210285e+10  1.1965779e-13  0              3.3288697    
    200000   7260           200            200            0.00096856557  1.6689961e-35  0              0.0029056967   137298.89      0              1.3259344e+10  1.1965779e-13  0              3.0784044    
    300000   7260           200            200            3.3776548e-05  2.2253449e-35  0              0.00010132964  358.37249      0              34609050       1.1965779e-13  0              3.0451904    
    400000   7260           200            200            9.4585362e-05 -8.9012264e-35  0              0.00028375609  2649.2848      0              2.5584896e+08  1.1965779e-13  0              3.0039228    
    500000   7260           200            200            0.0044632526   0.00079599225  0              0.012593765    1446.4391      0              1.3968673e+08  1.1965779e-13  0              2.9942512    
    600000   7260           200            200            0.0029190202   0.00096611016  0              0.0077909505   118.46519      0              11440520       1.1965779e-13  0              2.9955211    
    700000   7260           200            200            0.0032065022   0.00063089192  0              0.0089886146   5.3004147      0              511876.12      1.1965779e-13  0              2.9951719    
    800000   7260           200            200            0.0036714401   0.00072803864  0              0.010286282    3.663793       0              353822.9       1.1965779e-13  0              2.99484      
    900000   7260           200            200            0.0037394952   0.00072968515  0              0.0104888      0.16265832     0              15708.376      1.1965779e-13  0              2.9947919    
   1000000   7260           200            200            0.0037068524   0.00072847442  0              0.010392083    0.01010843     0              976.19978      1.1965779e-13  0              2.9948164    
   1100000   7260           200            200            0.0036851625   0.00072765259  0              0.010327835    0.0087726516   0              847.1999       1.1965779e-13  0              2.9948323    
   1200000   7260           200            200            0.0036810558   0.00072749818  0              0.010315669    0.00054016803  0              52.165562      1.1965779e-13  0              2.9948352    
   1300000   7260           200            200            0.003682364    0.00072755083  0              0.010319541    1.2239474e-05  0              1.1820008      1.1965779e-13  0              2.9948342    
   1400000   7260           200            200            0.003683432    0.00072759231  0              0.010322704    2.0329985e-05  0              1.9633244      1.1965779e-13  0              2.9948334    
   1500000   7260           200            200            0.0036836752   0.00072760151  0              0.010323424    1.6886063e-06  0              0.16307351     1.1965779e-13  0              2.9948333    
   1600000   7260           200            200            0.0036836267   0.00072759954  0              0.010323281    9.5180727e-09  0              0.00091918734  1.1965779e-13  0              2.9948333    
   1700000   7260           200            200            0.0036835749   0.00072759753  0              0.010323127    4.5607878e-08  0              0.0044044825   1.1965779e-13  0              2.9948333    
   1800000   7260           200            200            0.003683561    0.000727597    0              0.010323086    5.0037601e-09  0              0.00048322733  1.1965779e-13  0              2.9948333    
   1900000   7260           200            200            0.0036835626   0.00072759707  0              0.010323091    1.0205299e-12  0              9.8555469e-08  1.1965779e-13  0              2.9948333    
   2000000   7260           200            200            0.0036835651   0.00072759716  0              0.010323098    9.872716e-11   0              9.5343624e-06  1.1965779e-13  0              2.9948333    
   2100000   7260           200            200            0.0036835658   0.00072759719  0              0.0103231      1.4190709e-11  0              1.3704371e-06  1.1965779e-13  0              2.9948333    
   2200000   7260           200            200            0.0036835658   0.00072759719  0              0.0103231      1.9646993e-14  0              1.8973659e-09  1.1965779e-13  0              2.9948333    
   2300000   7260           200            200            0.0036835657   0.00072759719  0              0.0103231      2.0469303e-13  0              1.9767787e-08  1.1965779e-13  0              2.9948333    
   2400000   7260           200            200            0.0036835656   0.00072759718  0              0.0103231      3.8790835e-14  0              3.7461412e-09  1.1965779e-13  0              2.9948333    
   2500000   7260           200            200            0.0036835656   0.00072759718  0              0.0103231      2.9212537e-16  0              2.8211378e-11  1.1965779e-13  0              2.9948333    
   2600000   7260           200            200            0.0036835657   0.00072759718  0              0.0103231      4.0302522e-16  0              3.8921291e-11  1.1965779e-13  0              2.9948333    
   2700000   7260           200            200            0.0036835657   0.00072759718  0              0.0103231      1.0266519e-16  0              9.9146689e-12  1.1965779e-13  0              2.9948333    
   2800000   7260           200            200            0.0036835657   0.00072759718  0              0.0103231      3.8234351e-18  0              3.6924e-13     1.1965779e-13  0              2.9948333    
   2900000   7260           200            200            0.0036835657   0.00072759718  0              0.0103231      2.1881194e-18  0              2.1131291e-13  1.1965779e-13  0              2.9948333    
   3000000   7260           200            200            0.0036835657   0.00072759718  0              0.0103231      7.0206731e-18  0              6.7800636e-13  1.1965779e-13  0              2.9948333    
Loop time of 296.33 on 4 procs for 3000000 steps with 2501 atoms

Performance: 8746999.421 ns/day, 0.000 hours/ns, 10123.842 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 10.895     | 37.018     | 63.545     | 425.4 | 12.49
Neigh   | 4.4978     | 4.5787     | 4.6604     |   3.3 |  1.55
Comm    | 19.209     | 38.529     | 77.81      | 370.5 | 13.00
Output  | 0.27624    | 0.27658    | 0.27691    |   0.1 |  0.09
Modify  | 110.46     | 159.23     | 178.44     | 224.8 | 53.73
Other   |            | 56.7       |            |       | 19.13

Nlocal:         625.25 ave         876 max         375 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:           1.75 ave           3 max           1 min
Histogram: 2 0 0 0 0 1 0 0 0 1
Neighs:         330.75 ave         662 max           0 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 1323
Ave neighs/atom = 0.5289884
Neighbor list builds = 164
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 85

#variable lat0 equal 1                    #
variable lat1 equal 3+(100*0.01)+(v_ind*0.01)  # .491+(v_ind*0.001)       # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 500*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.85                                                               
Lattice spacing in x,y,z = 4.85 4.85 4.85

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -3637.5 ${n1e1} -100 100 -100 100 units box
region box block -3637.5 3637.5 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -3637.5 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -3637.5 3637.5 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-3637.5 -100 -100) to (3637.5 100 100)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 1500 atoms
  using lattice units in orthogonal box = (-3637.5 -100 -100) to (3637.5 100 100)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 1500 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 1001 atoms
  using lattice units in orthogonal box = (-3637.5 -100 -100) to (3637.5 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  1500 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  1500 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  1001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  1001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
1500 atoms in group substrate
group slider1 region slider1
1001 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 1001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_85_*.dump id type diameter mass xu yu zu fx fy fz

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 4694 130 130
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 94.77 | 94.8 | 94.83 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   7275           200            200            0              0              0              0              0              0              0              1.1965779e-13  0              6            
    100000   7275           200            200            0.0027851433   1.7765974e-34  0              0.00835543     582011.54      0              5.6206508e+10  1.1965779e-13  0              3.3289396    
    200000   7275           200            200            0.00096649126  7.8172301e-40  0              0.0028994738   137280.49      0              1.3257567e+10  1.1965779e-13  0              3.0784451    
    300000   7275           200            200            3.4227643e-05 -2.220711e-35   0              0.00010268293  369.23757      0              35658322       1.1965779e-13  0              3.0451906    
    400000   7275           200            200            9.5554688e-05  3.9998504e-41  0              0.00028666406  2711.0626      0              2.6181502e+08  1.1965779e-13  0              3.0038618    
    500000   7275           200            200            0.0036569007  -0.0013842682   0              0.01235497     1456.1021      0              1.4061992e+08  1.1965779e-13  0              2.9943043    
    600000   7275           200            200            0.0021508468  -0.0015985677   0              0.008051108    137.12614      0              13242661       1.1965779e-13  0              2.9954492    
    700000   7275           200            200            0.002502268   -0.0014529258   0              0.0089597299   4.8558829      0              468946.42      1.1965779e-13  0              2.9951828    
    800000   7275           200            200            0.0029824891  -0.0013950006   0              0.010342468    3.6499887      0              352489.78      1.1965779e-13  0              2.9948287    
    900000   7275           200            200            0.0030334617  -0.0013948547   0              0.01049524     0.041917874    0              4048.1282      1.1965779e-13  0              2.994793     
   1000000   7275           200            200            0.0029847219  -0.0013950078   0              0.010349174    0.040295326    0              3891.4342      1.1965779e-13  0              2.9948298    
   1100000   7275           200            200            0.0029646334  -0.0013950931   0              0.010288993    0.0069432054   0              670.52508      1.1965779e-13  0              2.9948446    
   1200000   7275           200            200            0.0029655985  -0.0013950879   0              0.010291883    1.4828211e-05  0              1.4320025      1.1965779e-13  0              2.9948438    
   1300000   7275           200            200            0.0029685756  -0.0013950742   0              0.010300801    0.00015155527  0              14.636123      1.1965779e-13  0              2.9948415    
   1400000   7275           200            200            0.0029692749  -0.0013950712   0              0.010302896    8.4580878e-06  0              0.81682158     1.1965779e-13  0              2.994841     
   1500000   7275           200            200            0.002969068   -0.0013950721   0              0.010302276    7.2329525e-07  0              0.069850678    1.1965779e-13  0              2.9948412    
   1600000   7275           200            200            0.0029689161  -0.0013950728   0              0.010301821    3.9560631e-07  0              0.038204826    1.1965779e-13  0              2.9948413    
   1700000   7275           200            200            0.0029689017  -0.0013950729   0              0.010301778    3.6517983e-09  0              0.00035266454  1.1965779e-13  0              2.9948413    
   1800000   7275           200            200            0.0029689182  -0.0013950728   0              0.010301827    4.6231836e-09  0              0.00044647398  1.1965779e-13  0              2.9948413    
   1900000   7275           200            200            0.0029689247  -0.0013950728   0              0.010301847    7.3335336e-10  0              7.0822018e-05  1.1965779e-13  0              2.9948413    
   2000000   7275           200            200            0.0029689243  -0.0013950728   0              0.010301846    2.6567031e-12  0              2.5656537e-07  1.1965779e-13  0              2.9948413    
   2100000   7275           200            200            0.0029689233  -0.0013950728   0              0.010301843    1.6862309e-11  0              1.6284411e-06  1.1965779e-13  0              2.9948413    
   2200000   7275           200            200            0.0029689231  -0.0013950728   0              0.010301842    8.5167339e-13  0              8.224852e-08   1.1965779e-13  0              2.9948413    
   2300000   7275           200            200            0.0029689232  -0.0013950728   0              0.010301842    8.7615071e-14  0              8.4612364e-09  1.1965779e-13  0              2.9948413    
   2400000   7275           200            200            0.0029689232  -0.0013950728   0              0.010301842    4.2860089e-14  0              4.1391206e-09  1.1965779e-13  0              2.9948413    
   2500000   7275           200            200            0.0029689232  -0.0013950728   0              0.010301842    3.3522509e-16  0              3.237364e-11   1.1965779e-13  0              2.9948413    
   2600000   7275           200            200            0.0029689232  -0.0013950728   0              0.010301842    5.2516233e-16  0              5.0716419e-11  1.1965779e-13  0              2.9948413    
   2700000   7275           200            200            0.0029689232  -0.0013950728   0              0.010301842    7.6565463e-17  0              7.3941444e-12  1.1965779e-13  0              2.9948413    
   2800000   7275           200            200            0.0029689232  -0.0013950728   0              0.010301842    2.250548e-20   0              2.1734182e-15  1.1965779e-13  0              2.9948413    
   2900000   7275           200            200            0.0029689232  -0.0013950728   0              0.010301842    1.642677e-18   0              1.5863799e-13  1.1965779e-13  0              2.9948413    
   3000000   7275           200            200            0.0029689232  -0.0013950728   0              0.010301842    3.4390882e-18  0              3.3212252e-13  1.1965779e-13  0              2.9948413    
Loop time of 297.046 on 4 procs for 3000000 steps with 2501 atoms

Performance: 8725927.756 ns/day, 0.000 hours/ns, 10099.453 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 11.281     | 37.463     | 65.132     | 426.7 | 12.61
Neigh   | 4.5089     | 4.5897     | 4.6721     |   3.4 |  1.55
Comm    | 18.463     | 24.901     | 29.859     |  98.8 |  8.38
Output  | 0.26985    | 0.27016    | 0.27051    |   0.1 |  0.09
Modify  | 168.22     | 173.11     | 177.84     |  29.7 | 58.28
Other   |            | 56.71      |            |       | 19.09

Nlocal:         625.25 ave         877 max         374 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:           1.75 ave           3 max           1 min
Histogram: 2 0 0 0 0 1 0 0 0 1
Neighs:         329.75 ave         660 max           0 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 1319
Ave neighs/atom = 0.52738904
Neighbor list builds = 164
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 86

#variable lat0 equal 1                    #
variable lat1 equal 3+(100*0.01)+(v_ind*0.01)  # .491+(v_ind*0.001)       # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 500*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.86                                                               
Lattice spacing in x,y,z = 4.86 4.86 4.86

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -3645 ${n1e1} -100 100 -100 100 units box
region box block -3645 3645 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -3645 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -3645 3645 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-3645 -100 -100) to (3645 100 100)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 1499 atoms
  using lattice units in orthogonal box = (-3645 -100 -100) to (3645 100 100)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 1500 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 1001 atoms
  using lattice units in orthogonal box = (-3645 -100 -100) to (3645 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  1499 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  1499 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  1001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  1001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
1499 atoms in group substrate
group slider1 region slider1
1001 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 1001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_86_*.dump id type diameter mass xu yu zu fx fy fz

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 4704 130 130
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 94.97 | 94.97 | 94.98 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   7290           200            200            0              0              0              0              0              0              0              1.1965779e-13  0              6            
    100000   7290           200            200            0.0027794468   2.2162319e-35  0              0.0083383404   582019.67      0              5.6319934e+10  1.1965779e-13  0              3.3289522    
    200000   7290           200            200            0.00096428574 -2.2161087e-35  0              0.0028928572   137229.43      0              1.3279194e+10  1.1965779e-13  0              3.0785439    
    300000   7290           200            200            3.3268806e-05  4.432493e-35   0              9.9806418e-05  350.74122      0              33939957       1.1965779e-13  0              3.0452606    
    400000   7290           200            200            9.6385061e-05 -4.4322472e-35  0              0.00028915518  2766.1005      0              2.6766552e+08  1.1965779e-13  0              3.0038612    
    500000   7290           200            200            0.0021257282  -0.0016623702   0              0.0080395547   1451.6834      0              1.4047414e+08  1.1965779e-13  0              2.9954329    
    600000   7290           200            200            0.0031003206  -0.0014814833   0              0.010782445    199.07107      0              19263386       1.1965779e-13  0              2.9947609    
    700000   7290           200            200            0.00282535    -0.001659807    0              0.010135857    26.610071      0              2574960.1      1.1965779e-13  0              2.9949034    
    800000   7290           200            200            0.0027668627  -0.0016519716   0              0.0099525597   2.1987074      0              212760.94      1.1965779e-13  0              2.9949609    
    900000   7290           200            200            0.0029345123  -0.0016703859   0              0.010473923    0.011765426    0              1138.4976      1.1965779e-13  0              2.9948216    
   1000000   7290           200            200            0.0028529095  -0.0016618519   0              0.01022058     0.020042177    0              1939.4088      1.1965779e-13  0              2.9948878    
   1100000   7290           200            200            0.0028744272  -0.0016641088   0              0.010287391    0.0083564255   0              808.621        1.1965779e-13  0              2.9948706    
   1200000   7290           200            200            0.0028737356  -0.0016640579   0              0.010285265    0.00092825513  0              89.823884      1.1965779e-13  0              2.994871     
   1300000   7290           200            200            0.002871208   -0.001663783    0              0.010277407    1.7595574e-05  0              1.7026599      1.1965779e-13  0              2.9948731    
   1400000   7290           200            200            0.0028726725  -0.0016639391   0              0.010281957    3.3635031e-06  0              0.32547401     1.1965779e-13  0              2.9948719    
   1500000   7290           200            200            0.0028722191  -0.0016638915   0              0.010280549    2.4350199e-06  0              0.23562805     1.1965779e-13  0              2.9948723    
   1600000   7290           200            200            0.0028722675  -0.0016638963   0              0.010280699    3.5877466e-07  0              0.034717323    1.1965779e-13  0              2.9948722    
   1700000   7290           200            200            0.0028723024  -0.0016639001   0              0.010280807    1.3086071e-08  0              0.0012662916   1.1965779e-13  0              2.9948722    
   1800000   7290           200            200            0.0028722769  -0.0016638974   0              0.010280728    3.513586e-10   0              3.3999698e-05  1.1965779e-13  0              2.9948722    
   1900000   7290           200            200            0.002872286   -0.0016638983   0              0.010280756    6.5508779e-10  0              6.3390471e-05  1.1965779e-13  0              2.9948722    
   2000000   7290           200            200            0.0028722845  -0.0016638982   0              0.010280752    1.2890275e-10  0              1.2473452e-05  1.1965779e-13  0              2.9948722    
   2100000   7290           200            200            0.0028722841  -0.0016638982   0              0.01028075     7.3199068e-12  0              7.0832085e-07  1.1965779e-13  0              2.9948722    
   2200000   7290           200            200            0.0028722845  -0.0016638982   0              0.010280752    4.1194291e-15  0              3.9862222e-10  1.1965779e-13  0              2.9948722    
   2300000   7290           200            200            0.0028722844  -0.0016638982   0              0.010280751    1.5951047e-13  0              1.543525e-08   1.1965779e-13  0              2.9948722    
   2400000   7290           200            200            0.0028722844  -0.0016638982   0              0.010280751    4.3270674e-14  0              4.1871463e-09  1.1965779e-13  0              2.9948722    
   2500000   7290           200            200            0.0028722844  -0.0016638982   0              0.010280751    3.4971551e-15  0              3.3840702e-10  1.1965779e-13  0              2.9948722    
   2600000   7290           200            200            0.0028722844  -0.0016638982   0              0.010280751    8.6970852e-18  0              8.4158541e-13  1.1965779e-13  0              2.9948722    
   2700000   7290           200            200            0.0028722844  -0.0016638982   0              0.010280751    2.872122e-17   0              2.7792484e-12  1.1965779e-13  0              2.9948722    
   2800000   7290           200            200            0.0028722844  -0.0016638982   0              0.010280751    1.055299e-17   0              1.0211745e-12  1.1965779e-13  0              2.9948722    
   2900000   7290           200            200            0.0028722844  -0.0016638982   0              0.010280751    4.4509281e-18  0              4.3070018e-13  1.1965779e-13  0              2.9948722    
   3000000   7290           200            200            0.0028722844  -0.0016638982   0              0.010280751    1.3587276e-18  0              1.3147915e-13  1.1965779e-13  0              2.9948722    
Loop time of 294.521 on 4 procs for 3000000 steps with 2500 atoms

Performance: 8800743.511 ns/day, 0.000 hours/ns, 10186.046 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 10.405     | 36.365     | 62.095     | 425.5 | 12.35
Neigh   | 4.5144     | 4.5987     | 4.6839     |   3.5 |  1.56
Comm    | 25.564     | 51.811     | 76.713     | 344.5 | 17.59
Output  | 0.27149    | 0.27181    | 0.27212    |   0.1 |  0.09
Modify  | 110.15     | 144.79     | 179.65     | 284.3 | 49.16
Other   |            | 56.68      |            |       | 19.25

Nlocal:            625 ave         876 max         375 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:            1.5 ave           4 max           0 min
Histogram: 2 0 0 0 0 1 0 0 0 1
Neighs:         333.25 ave         667 max           0 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 1333
Ave neighs/atom = 0.5332
Neighbor list builds = 164
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 87

#variable lat0 equal 1                    #
variable lat1 equal 3+(100*0.01)+(v_ind*0.01)  # .491+(v_ind*0.001)       # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 500*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.87                                                               
Lattice spacing in x,y,z = 4.87 4.87 4.87

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -3652.5 ${n1e1} -100 100 -100 100 units box
region box block -3652.5 3652.5 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -3652.5 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -3652.5 3652.5 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-3652.5 -100 -100) to (3652.5 100 100)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 1500 atoms
  using lattice units in orthogonal box = (-3652.5 -100 -100) to (3652.5 100 100)
  create_atoms CPU = 0.000 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 1500 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 1001 atoms
  using lattice units in orthogonal box = (-3652.5 -100 -100) to (3652.5 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  1500 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  1500 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  1001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  1001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
1500 atoms in group substrate
group slider1 region slider1
1001 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 1001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_87_*.dump id type diameter mass xu yu zu fx fy fz

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 4713 130 130
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 95.18 | 95.18 | 95.19 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   7305           200            200            0              0              0              0              0              0              0              1.1965779e-13  0              6            
    100000   7305           200            200            0.0027737438   6.6447956e-41  0              0.0083212314   582018.49      0              5.620718e+10   1.1965779e-13  0              3.3289718    
    200000   7305           200            200            0.00096195214 -5.5290332e-36  0              0.0028858564   137147.46      0              1.324472e+10   1.1965779e-13  0              3.0786738    
    300000   7305           200            200            3.2054212e-05  1.1058148e-35  0              9.6162636e-05  327.50432      0              31628023       1.1965779e-13  0              3.0453329    
    400000   7305           200            200            9.3676824e-05  2.2116794e-35  0              0.00028103047  2631.857       0              2.5416591e+08  1.1965779e-13  0              3.0040563    
    500000   7305           200            200            0.004380204    0.0040292311   0              0.0091113808   1505.1314      0              1.4535481e+08  1.1965779e-13  0              2.9951874    
    600000   7305           200            200            0.0048675093   0.0033125352   0              0.011289993    193.83659      0              18719351       1.1965779e-13  0              2.9947076    
    700000   7305           200            200            0.0039835103   0.0029779364   0              0.0089725944   6.0967186      0              588777.44      1.1965779e-13  0              2.9952782    
    800000   7305           200            200            0.0043085185   0.0031118474   0              0.0098137082   1.265652       0              122227.61      1.1965779e-13  0              2.995053     
    900000   7305           200            200            0.0044807173   0.0031604766   0              0.010281675    0.49108862     0              47425.824      1.1965779e-13  0              2.9949355    
   1000000   7305           200            200            0.0044964045   0.0031611878   0              0.010328026    0.010164637    0              981.62787      1.1965779e-13  0              2.9949247    
   1100000   7305           200            200            0.0044797147   0.003157444    0              0.0102817      0.0033257699   0              321.17905      1.1965779e-13  0              2.9949364    
   1200000   7305           200            200            0.0044714192   0.0031555904   0              0.010258667    0.0011999289   0              115.88054      1.1965779e-13  0              2.9949422    
   1300000   7305           200            200            0.0044706404   0.0031554262   0              0.010256495    2.3835163e-05  0              2.3018295      1.1965779e-13  0              2.9949427    
   1400000   7305           200            200            0.0044714746   0.0031556178   0              0.010258806    8.3372737e-06  0              0.80515422     1.1965779e-13  0              2.9949421    
   1500000   7305           200            200            0.0044718845   0.0031557098   0              0.010259944    2.9357845e-06  0              0.28351706     1.1965779e-13  0              2.9949418    
   1600000   7305           200            200            0.0044719218   0.0031557176   0              0.010260048    5.6004441e-08  0              0.0054085081   1.1965779e-13  0              2.9949418    
   1700000   7305           200            200            0.0044718801   0.0031557081   0              0.010259932    2.090662e-08   0              0.0020190117   1.1965779e-13  0              2.9949418    
   1800000   7305           200            200            0.0044718599   0.0031557035   0              0.010259876    7.1813491e-09  0              0.00069352329  1.1965779e-13  0              2.9949418    
   1900000   7305           200            200            0.0044718581   0.0031557032   0              0.010259871    1.3142614e-10  0              1.2692195e-05  1.1965779e-13  0              2.9949418    
   2000000   7305           200            200            0.0044718602   0.0031557037   0              0.010259877    5.2410524e-11  0              5.0614333e-06  1.1965779e-13  0              2.9949418    
   2100000   7305           200            200            0.0044718612   0.0031557039   0              0.01025988     1.7565058e-11  0              1.6963075e-06  1.1965779e-13  0              2.9949418    
   2200000   7305           200            200            0.0044718612   0.0031557039   0              0.01025988     3.0805239e-13  0              2.9749495e-08  1.1965779e-13  0              2.9949418    
   2300000   7305           200            200            0.0044718611   0.0031557039   0              0.01025988     1.3113195e-13  0              1.2663785e-08  1.1965779e-13  0              2.9949418    
   2400000   7305           200            200            0.0044718611   0.0031557039   0              0.010259879    4.2945074e-14  0              4.1473279e-09  1.1965779e-13  0              2.9949418    
   2500000   7305           200            200            0.0044718611   0.0031557039   0              0.010259879    7.4810287e-16  0              7.224642e-11   1.1965779e-13  0              2.9949418    
   2600000   7305           200            200            0.0044718611   0.0031557039   0              0.010259879    3.5170551e-16  0              3.3965201e-11  1.1965779e-13  0              2.9949418    
   2700000   7305           200            200            0.0044718611   0.0031557039   0              0.010259879    1.0445866e-16  0              1.008787e-11   1.1965779e-13  0              2.9949418    
   2800000   7305           200            200            0.0044718611   0.0031557039   0              0.010259879    3.3510545e-18  0              3.2362085e-13  1.1965779e-13  0              2.9949418    
   2900000   7305           200            200            0.0044718611   0.0031557039   0              0.010259879    2.5814593e-19  0              2.4929886e-14  1.1965779e-13  0              2.9949418    
   3000000   7305           200            200            0.0044718611   0.0031557039   0              0.010259879    4.9118782e-20  0              4.7435404e-15  1.1965779e-13  0              2.9949418    
Loop time of 294.018 on 4 procs for 3000000 steps with 2501 atoms

Performance: 8815783.811 ns/day, 0.000 hours/ns, 10203.453 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 10.945     | 37.141     | 63.783     | 426.2 | 12.63
Neigh   | 4.4876     | 4.5702     | 4.6536     |   3.4 |  1.55
Comm    | 19.427     | 38.503     | 77.667     | 369.3 | 13.10
Output  | 0.26991    | 0.27024    | 0.27058    |   0.1 |  0.09
Modify  | 109.01     | 157.29     | 176.68     | 223.7 | 53.50
Other   |            | 56.24      |            |       | 19.13

Nlocal:         625.25 ave         876 max         375 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:           1.75 ave           3 max           1 min
Histogram: 2 0 0 0 0 1 0 0 0 1
Neighs:         331.25 ave         663 max           0 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 1325
Ave neighs/atom = 0.52978808
Neighbor list builds = 164
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 88

#variable lat0 equal 1                    #
variable lat1 equal 3+(100*0.01)+(v_ind*0.01)  # .491+(v_ind*0.001)       # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 500*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.88                                                               
Lattice spacing in x,y,z = 4.88 4.88 4.88

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -3660 ${n1e1} -100 100 -100 100 units box
region box block -3660 3660 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -3660 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -3660 3660 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-3660 -100 -100) to (3660 100 100)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 1500 atoms
  using lattice units in orthogonal box = (-3660 -100 -100) to (3660 100 100)
  create_atoms CPU = 0.000 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 1500 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 1001 atoms
  using lattice units in orthogonal box = (-3660 -100 -100) to (3660 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  1500 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  1500 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  1001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  1001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
1500 atoms in group substrate
group slider1 region slider1
1001 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 1001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_88_*.dump id type diameter mass xu yu zu fx fy fz

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 4723 130 130
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 95.32 | 95.32 | 95.33 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   7320           200            200            0              0              0              0              0              0              0              1.1965779e-13  0              6            
    100000   7320           200            200            0.0027673871   9.0181308e-41  0              0.0083021612   581816.52      0              5.6187675e+10  1.1965779e-13  0              3.3290581    
    200000   7320           200            200            0.00095851507  2.207109e-35   0              0.0028755452   136824.07      0              1.3213489e+10  1.1965779e-13  0              3.0788388    
    300000   7320           200            200            2.9652381e-05  1.8973298e-40  0              8.8957142e-05  282.4713       0              27279056       1.1965779e-13  0              3.0452003    
    400000   7320           200            200            8.623262e-05   8.70161e-41    0              0.00025869786  2260.4507      0              2.1829814e+08  1.1965779e-13  0              3.0042985    
    500000   7320           200            200            0.0024387625  -0.0073588277   0              0.014675115    1285.3888      0              1.2413365e+08  1.1965779e-13  0              2.9937698    
    600000   7320           200            200            0.0010661737  -0.004071387    0              0.0072699079   82.177771      0              7936141        1.1965779e-13  0              2.9956541    
    700000   7320           200            200            0.0014672932  -0.0046470243   0              0.0090489038   9.7366437      0              940295.35      1.1965779e-13  0              2.9951352    
    800000   7320           200            200            0.0018410315  -0.0047809377   0              0.010304032    3.6170899      0              349312.65      1.1965779e-13  0              2.9948145    
    900000   7320           200            200            0.0018778549  -0.0047882238   0              0.010421788    0.083622693    0              8075.6812      1.1965779e-13  0              2.9947873    
   1000000   7320           200            200            0.0018402917  -0.0047796274   0              0.010300502    0.020447112    0              1974.6357      1.1965779e-13  0              2.994818     
   1100000   7320           200            200            0.0018209841  -0.0047751949   0              0.010238147    0.0090153542   0              870.63838      1.1965779e-13  0              2.9948335    
   1200000   7320           200            200            0.0018184538  -0.0047746365   0              0.010229998    0.00032505469  0              31.391455      1.1965779e-13  0              2.9948355    
   1300000   7320           200            200            0.0018200581  -0.00477502     0              0.010235194    3.2724039e-05  0              3.1602535      1.1965779e-13  0              2.9948342    
   1400000   7320           200            200            0.0018210302  -0.0047752458   0              0.010238336    2.1892053e-05  0              2.1141778      1.1965779e-13  0              2.9948334    
   1500000   7320           200            200            0.0018211956  -0.0047752828   0              0.01023887     1.1376259e-06  0              0.10986376     1.1965779e-13  0              2.9948332    
   1600000   7320           200            200            0.0018211296  -0.0047752669   0              0.010238656    4.4928982e-08  0              0.0043389195   1.1965779e-13  0              2.9948333    
   1700000   7320           200            200            0.0018210813  -0.0047752557   0              0.0102385      5.1573833e-08  0              0.0049806317   1.1965779e-13  0              2.9948333    
   1800000   7320           200            200            0.0018210712  -0.0047752534   0              0.010238467    3.675882e-09   0              0.00035499037  1.1965779e-13  0              2.9948333    
   1900000   7320           200            200            0.0018210738  -0.0047752541   0              0.010238475    4.6339022e-11  0              4.4750911e-06  1.1965779e-13  0              2.9948333    
   2000000   7320           200            200            0.0018210761  -0.0047752546   0              0.010238483    1.1772254e-10  0              1.1368801e-05  1.1965779e-13  0              2.9948333    
   2100000   7320           200            200            0.0018210767  -0.0047752547   0              0.010238485    1.1186482e-11  0              1.0803103e-06  1.1965779e-13  0              2.9948333    
   2200000   7320           200            200            0.0018210766  -0.0047752547   0              0.010238485    2.2472576e-14  0              2.1702405e-09  1.1965779e-13  0              2.9948333    
   2300000   7320           200            200            0.0018210765  -0.0047752547   0              0.010238484    2.6009126e-13  0              2.5117752e-08  1.1965779e-13  0              2.9948333    
   2400000   7320           200            200            0.0018210765  -0.0047752547   0              0.010238484    3.2553904e-14  0              3.143823e-09   1.1965779e-13  0              2.9948333    
   2500000   7320           200            200            0.0018210765  -0.0047752547   0              0.010238484    7.4419196e-18  0              7.1868733e-13  1.1965779e-13  0              2.9948333    
   2600000   7320           200            200            0.0018210765  -0.0047752547   0              0.010238484    5.4797686e-16  0              5.2919683e-11  1.1965779e-13  0              2.9948333    
   2700000   7320           200            200            0.0018210765  -0.0047752547   0              0.010238484    9.1949265e-17  0              8.8798018e-12  1.1965779e-13  0              2.9948333    
   2800000   7320           200            200            0.0018210765  -0.0047752547   0              0.010238484    1.9632886e-18  0              1.8960036e-13  1.1965779e-13  0              2.9948333    
   2900000   7320           200            200            0.0018210765  -0.0047752547   0              0.010238484    5.4106446e-20  0              5.2252133e-15  1.1965779e-13  0              2.9948333    
   3000000   7320           200            200            0.0018210765  -0.0047752547   0              0.010238484    1.1377321e-18  0              1.0987402e-13  1.1965779e-13  0              2.9948333    
Loop time of 297.073 on 4 procs for 3000000 steps with 2501 atoms

Performance: 8725142.361 ns/day, 0.000 hours/ns, 10098.544 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 10.848     | 37.209     | 63.994     | 427.7 | 12.53
Neigh   | 4.5083     | 4.5894     | 4.6706     |   3.3 |  1.54
Comm    | 19.714     | 38.745     | 77.871     | 367.7 | 13.04
Output  | 0.27435    | 0.27467    | 0.27501    |   0.1 |  0.09
Modify  | 110.96     | 159.52     | 179.48     | 223.5 | 53.70
Other   |            | 56.74      |            |       | 19.10

Nlocal:         625.25 ave         876 max         375 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:           1.75 ave           3 max           1 min
Histogram: 2 0 0 0 0 1 0 0 0 1
Neighs:         330.25 ave         661 max           0 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 1321
Ave neighs/atom = 0.52818872
Neighbor list builds = 164
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 89

#variable lat0 equal 1                    #
variable lat1 equal 3+(100*0.01)+(v_ind*0.01)  # .491+(v_ind*0.001)       # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 500*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.89                                                               
Lattice spacing in x,y,z = 4.89 4.89 4.89

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -3667.5 ${n1e1} -100 100 -100 100 units box
region box block -3667.5 3667.5 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -3667.5 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -3667.5 3667.5 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-3667.5 -100 -100) to (3667.5 100 100)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 1500 atoms
  using lattice units in orthogonal box = (-3667.5 -100 -100) to (3667.5 100 100)
  create_atoms CPU = 0.000 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 1500 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 1001 atoms
  using lattice units in orthogonal box = (-3667.5 -100 -100) to (3667.5 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  1500 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  1500 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  1001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  1001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
1500 atoms in group substrate
group slider1 region slider1
1001 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 1001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_89_*.dump id type diameter mass xu yu zu fx fy fz

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 4733 130 130
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 95.52 | 95.53 | 95.54 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   7335           200            200            0              0              0              0              0              0              0              1.1965779e-13  0              6            
    100000   7335           200            200            0.0027616864   3.3038688e-35  0              0.0082850593   581801.2       0              5.6186195e+10  1.1965779e-13  0              3.3290867    
    200000   7335           200            200            0.00095659453  4.5154874e-40  0              0.0028697836   136832.75      0              1.3214328e+10  1.1965779e-13  0              3.078836     
    300000   7335           200            200            2.9733881e-05  4.4052923e-35  0              8.9201644e-05  285.12737      0              27535561       1.1965779e-13  0              3.0451992    
    400000   7335           200            200            8.6032266e-05  2.2025937e-35  0              0.0002580968   2259.2593      0              2.1818309e+08  1.1965779e-13  0              3.0043001    
    500000   7335           200            200            0.0039220077  -0.0029536583   0              0.014719681    1279.9901      0              1.2361229e+08  1.1965779e-13  0              2.9937527    
    600000   7335           200            200            0.0025505223   0.00032680939  0              0.0073247575   85.413114      0              8248587.2      1.1965779e-13  0              2.995644     
    700000   7335           200            200            0.0031549356  -0.00090779642  0              0.010372603    26.714019      0              2579848.7      1.1965779e-13  0              2.9947853    
    800000   7335           200            200            0.0031757287  -0.00084965166  0              0.010376838    3.3399437      0              322547.86      1.1965779e-13  0              2.9947934    
    900000   7335           200            200            0.0030819316  -0.00083829123  0              0.010084086    0.26918183     0              25995.654      1.1965779e-13  0              2.9948659    
   1000000   7335           200            200            0.0031460494  -0.00084641605  0              0.010284564    0.0098497919   0              951.2224       1.1965779e-13  0              2.9948148    
   1100000   7335           200            200            0.003116123   -0.00084266635  0              0.010191035    1.7994438e-05  0              1.737774       1.1965779e-13  0              2.9948389    
   1200000   7335           200            200            0.0031273416  -0.00084410196  0              0.010226127    0.00026228385  0              25.329497      1.1965779e-13  0              2.9948298    
   1300000   7335           200            200            0.0031239178  -0.0008436617   0              0.010215415    0.00010375876  0              10.020278      1.1965779e-13  0              2.9948326    
   1400000   7335           200            200            0.0031246786  -0.00084376166  0              0.010217797    2.1010507e-05  0              2.0290444      1.1965779e-13  0              2.9948319    
   1500000   7335           200            200            0.0031246348  -0.00084375473  0              0.010217659    2.7939014e-06  0              0.26981499     1.1965779e-13  0              2.994832     
   1600000   7335           200            200            0.0031245613  -0.00084374586  0              0.01021743     2.4237228e-07  0              0.02340658     1.1965779e-13  0              2.994832     
   1700000   7335           200            200            0.0031246161  -0.00084375269  0              0.010217601    1.0333558e-08  0              0.00099794107  1.1965779e-13  0              2.994832     
   1800000   7335           200            200            0.0031245896  -0.00084374935  0              0.010217518    1.2993824e-12  0              1.2548505e-07  1.1965779e-13  0              2.994832     
   1900000   7335           200            200            0.0031245998  -0.00084375065  0              0.01021755     1.677729e-10   0              1.6202306e-05  1.1965779e-13  0              2.994832     
   2000000   7335           200            200            0.0031245966  -0.00084375024  0              0.01021754     7.6716004e-11  0              7.4086826e-06  1.1965779e-13  0              2.994832     
   2100000   7335           200            200            0.0031245973  -0.00084375033  0              0.010217542    1.6584012e-11  0              1.6015652e-06  1.1965779e-13  0              2.994832     
   2200000   7335           200            200            0.0031245973  -0.00084375032  0              0.010217542    2.3230571e-12  0              2.2434423e-07  1.1965779e-13  0              2.994832     
   2300000   7335           200            200            0.0031245972  -0.00084375032  0              0.010217542    2.1516773e-13  0              2.077936e-08   1.1965779e-13  0              2.994832     
   2400000   7335           200            200            0.0031245973  -0.00084375032  0              0.010217542    1.0627889e-14  0              1.0263655e-09  1.1965779e-13  0              2.994832     
   2500000   7335           200            200            0.0031245972  -0.00084375032  0              0.010217542    2.6720818e-17  0              2.5805054e-12  1.1965779e-13  0              2.994832     
   2600000   7335           200            200            0.0031245973  -0.00084375032  0              0.010217542    8.525067e-17   0              8.2328995e-12  1.1965779e-13  0              2.994832     
   2700000   7335           200            200            0.0031245973  -0.00084375032  0              0.010217542    4.9978361e-17  0              4.8265524e-12  1.1965779e-13  0              2.994832     
   2800000   7335           200            200            0.0031245973  -0.00084375032  0              0.010217542    1.3728933e-17  0              1.3258421e-12  1.1965779e-13  0              2.994832     
   2900000   7335           200            200            0.0031245973  -0.00084375032  0              0.010217542    3.5216435e-18  0              3.4009513e-13  1.1965779e-13  0              2.994832     
   3000000   7335           200            200            0.0031245973  -0.00084375032  0              0.010217542    5.5802074e-18  0              5.3889649e-13  1.1965779e-13  0              2.994832     
Loop time of 295.76 on 4 procs for 3000000 steps with 2501 atoms

Performance: 8763854.341 ns/day, 0.000 hours/ns, 10143.350 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 10.98      | 37.088     | 63.798     | 424.3 | 12.54
Neigh   | 4.577      | 4.6593     | 4.7429     |   3.3 |  1.58
Comm    | 18.589     | 24.748     | 29.658     |  91.9 |  8.37
Output  | 0.27502    | 0.27534    | 0.27567    |   0.1 |  0.09
Modify  | 167.4      | 172.61     | 177.62     |  33.5 | 58.36
Other   |            | 56.38      |            |       | 19.06

Nlocal:         625.25 ave         877 max         374 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:           1.75 ave           3 max           1 min
Histogram: 2 0 0 0 0 1 0 0 0 1
Neighs:         331.75 ave         664 max           0 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 1327
Ave neighs/atom = 0.53058776
Neighbor list builds = 164
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 90

#variable lat0 equal 1                    #
variable lat1 equal 3+(100*0.01)+(v_ind*0.01)  # .491+(v_ind*0.001)       # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 500*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.9                                                               
Lattice spacing in x,y,z = 4.9 4.9 4.9

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -3675 ${n1e1} -100 100 -100 100 units box
region box block -3675 3675 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -3675 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -3675 3675 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-3675 -100 -100) to (3675 100 100)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 1499 atoms
  using lattice units in orthogonal box = (-3675 -100 -100) to (3675 100 100)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 1500 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 1001 atoms
  using lattice units in orthogonal box = (-3675 -100 -100) to (3675 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  1499 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  1499 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  1001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  1001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
1499 atoms in group substrate
group slider1 region slider1
1001 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 1001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_90_*.dump id type diameter mass xu yu zu fx fy fz

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 4742 130 130
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 95.6 | 95.63 | 95.66 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   7350           200            200            0              0              0              0              0              0              0              1.1965779e-13  0              6            
    100000   7350           200            200            0.002756042    1.4617601e-40  0              0.008268126    581796.9       0              5.6298377e+10  1.1965779e-13  0              3.3291024    
    200000   7350           200            200            0.00095474667  1.0724051e-42  0              0.00286424     136856.14      0              1.3243072e+10  1.1965779e-13  0              3.0788182    
    300000   7350           200            200            3.0067039e-05  5.6407837e-40  0              9.0201117e-05  292.56504      0              28310459       1.1965779e-13  0              3.0451918    
    400000   7350           200            200            8.9021217e-05  2.198079e-35   0              0.00026706365  2418.9531      0              2.3407333e+08  1.1965779e-13  0              3.0041367    
    500000   7350           200            200            0.0059704968   0.0018188448   0              0.016092646    1062.4667      0              1.0281106e+08  1.1965779e-13  0              2.9933915    
    600000   7350           200            200            0.003574058    0.0011093546   0              0.0096128194   194.37017      0              18808497       1.1965779e-13  0              2.9950227    
    700000   7350           200            200            0.0032739055   0.0010233011   0              0.0087984154   0.086424791    0              8363.0138      1.1965779e-13  0              2.9952686    
    800000   7350           200            200            0.0037757716   0.0010570823   0              0.010270233    3.5478309      0              343310.74      1.1965779e-13  0              2.9948666    
    900000   7350           200            200            0.0038144704   0.0010595375   0              0.010383874    0.026029308    0              2518.7618      1.1965779e-13  0              2.9948335    
   1000000   7350           200            200            0.0037428742   0.0010553505   0              0.010173272    0.058711187    0              5681.2687      1.1965779e-13  0              2.9948897    
   1100000   7350           200            200            0.0037429048   0.0010553233   0              0.010173391    0.0015319758   0              148.24375      1.1965779e-13  0              2.99489      
   1200000   7350           200            200            0.003752544    0.0010558989   0              0.010201733    0.00089235396  0              86.349858      1.1965779e-13  0              2.9948824    
   1300000   7350           200            200            0.0037518478   0.0010558613   0              0.010199682    5.5253721e-05  0              5.3467023      1.1965779e-13  0              2.9948829    
   1400000   7350           200            200            0.0037505976   0.0010557865   0              0.010196006    1.2203643e-05  0              1.1809023      1.1965779e-13  0              2.9948839    
   1500000   7350           200            200            0.0037507816   0.001055797    0              0.010196548    1.5733046e-06  0              0.15224298     1.1965779e-13  0              2.9948838    
   1600000   7350           200            200            0.003750937    0.0010558063   0              0.010197005    1.450201e-07   0              0.014033069    1.1965779e-13  0              2.9948836    
   1700000   7350           200            200            0.003750901    0.0010558042   0              0.010196899    3.8661883e-08  0              0.0037411702   1.1965779e-13  0              2.9948837    
   1800000   7350           200            200            0.0037508826   0.0010558031   0              0.010196845    1.3835865e-09  0              0.00013388465  1.1965779e-13  0              2.9948837    
   1900000   7350           200            200            0.0037508888   0.0010558035   0              0.010196863    8.5275639e-10  0              8.2518145e-05  1.1965779e-13  0              2.9948837    
   2000000   7350           200            200            0.0037508908   0.0010558036   0              0.010196869    8.4868466e-12  0              8.2124138e-07  1.1965779e-13  0              2.9948837    
   2100000   7350           200            200            0.0037508899   0.0010558036   0              0.010196866    1.7216557e-11  0              1.6659838e-06  1.1965779e-13  0              2.9948837    
   2200000   7350           200            200            0.0037508897   0.0010558036   0              0.010196865    8.9490411e-15  0              8.6596626e-10  1.1965779e-13  0              2.9948837    
   2300000   7350           200            200            0.0037508898   0.0010558036   0              0.010196866    3.2073001e-13  0              3.103588e-08   1.1965779e-13  0              2.9948837    
   2400000   7350           200            200            0.0037508898   0.0010558036   0              0.010196866    7.4162799e-16  0              7.1764652e-11  1.1965779e-13  0              2.9948837    
   2500000   7350           200            200            0.0037508898   0.0010558036   0              0.010196866    5.539952e-15   0              5.3608108e-10  1.1965779e-13  0              2.9948837    
   2600000   7350           200            200            0.0037508898   0.0010558036   0              0.010196866    6.2011045e-17  0              6.000584e-12   1.1965779e-13  0              2.9948837    
   2700000   7350           200            200            0.0037508898   0.0010558036   0              0.010196866    8.1669336e-17  0              7.9028456e-12  1.1965779e-13  0              2.9948837    
   2800000   7350           200            200            0.0037508898   0.0010558036   0              0.010196866    4.3842218e-18  0              4.2424525e-13  1.1965779e-13  0              2.9948837    
   2900000   7350           200            200            0.0037508898   0.0010558036   0              0.010196866    1.35998e-19    0              1.3160034e-14  1.1965779e-13  0              2.9948837    
   3000000   7350           200            200            0.0037508898   0.0010558036   0              0.010196866    2.0032211e-18  0              1.9384445e-13  1.1965779e-13  0              2.9948837    
Loop time of 291.116 on 4 procs for 3000000 steps with 2500 atoms

Performance: 8903679.030 ns/day, 0.000 hours/ns, 10305.184 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 10.274     | 35.896     | 61.221     | 421.9 | 12.33
Neigh   | 4.5155     | 4.5998     | 4.6844     |   3.5 |  1.58
Comm    | 25.306     | 51.238     | 75.898     | 342.7 | 17.60
Output  | 0.27126    | 0.27157    | 0.27192    |   0.1 |  0.09
Modify  | 108.66     | 142.99     | 177.58     | 282.8 | 49.12
Other   |            | 56.12      |            |       | 19.28

Nlocal:            625 ave         876 max         375 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:            1.5 ave           4 max           0 min
Histogram: 2 0 0 0 0 1 0 0 0 1
Neighs:         326.75 ave         654 max           0 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 1307
Ave neighs/atom = 0.5228
Neighbor list builds = 164
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 91

#variable lat0 equal 1                    #
variable lat1 equal 3+(100*0.01)+(v_ind*0.01)  # .491+(v_ind*0.001)       # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 500*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.91                                                               
Lattice spacing in x,y,z = 4.91 4.91 4.91

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -3682.5 ${n1e1} -100 100 -100 100 units box
region box block -3682.5 3682.5 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -3682.5 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -3682.5 3682.5 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-3682.5 -100 -100) to (3682.5 100 100)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 1500 atoms
  using lattice units in orthogonal box = (-3682.5 -100 -100) to (3682.5 100 100)
  create_atoms CPU = 0.000 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 1500 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 1001 atoms
  using lattice units in orthogonal box = (-3682.5 -100 -100) to (3682.5 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  1500 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  1500 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  1001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  1001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
1500 atoms in group substrate
group slider1 region slider1
1001 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 1001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_91_*.dump id type diameter mass xu yu zu fx fy fz

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 4752 130 130
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 95.8 | 95.81 | 95.81 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   7365           200            200            0              0              0              0              0              0              0              1.1965779e-13  0              6            
    100000   7365           200            200            0.0027504354   2.1936144e-35  0              0.0082513063   581795.42      0              5.6185637e+10  1.1965779e-13  0              3.3291296    
    200000   7365           200            200            0.00095299067  1.0968103e-35  0              0.002858972    136898.34      0              1.3220662e+10  1.1965779e-13  0              3.0787886    
    300000   7365           200            200            3.0612065e-05  3.8837504e-40  0              9.1836194e-05  304.21507      0              29378914       1.1965779e-13  0              3.0451922    
    400000   7365           200            200            8.6729032e-05  8.7744336e-35  0              0.0002601871   2311.6723      0              2.2324477e+08  1.1965779e-13  0              3.0042483    
    500000   7365           200            200            0.0003949715  -0.013279585    0              0.0144645      1296.8123      0              1.2523685e+08  1.1965779e-13  0              2.9937922    
    600000   7365           200            200           -0.00098947767 -0.010225141    0              0.0072567083   82.263104      0              7944381.8      1.1965779e-13  0              2.9956543    
    700000   7365           200            200           -0.00027601324 -0.010648783    0              0.0098207436   25.772228      0              2488897.3      1.1965779e-13  0              2.9949163    
    800000   7365           200            200            7.5328051e-07 -0.010714282    0              0.010716542    0.051060634    0              4931.0705      1.1965779e-13  0              2.9946952    
    900000   7365           200            200           -0.00019737339 -0.010691278    0              0.010099157    0.41591039     0              40165.648      1.1965779e-13  0              2.994852     
   1000000   7365           200            200           -0.00019111587 -0.010692569    0              0.010119221    0.026626133    0              2571.3614      1.1965779e-13  0              2.9948458    
   1100000   7365           200            200           -0.00016670895 -0.010697878    0              0.010197752    0.0029074194   0              280.77776      1.1965779e-13  0              2.9948258    
   1200000   7365           200            200           -0.00017248139 -0.010696584    0              0.01017914     0.0010865461   0              104.93085      1.1965779e-13  0              2.9948307    
   1300000   7365           200            200           -0.00017460262 -0.010696132    0              0.010172324    3.4086002e-07  0              0.032917821    1.1965779e-13  0              2.9948324    
   1400000   7365           200            200           -0.00017339417 -0.010696399    0              0.010176216    2.0826145e-05  0              2.01124        1.1965779e-13  0              2.9948314    
   1500000   7365           200            200           -0.00017335316 -0.010696406    0              0.010176346    7.1718257e-07  0              0.06926036     1.1965779e-13  0              2.9948314    
   1600000   7365           200            200           -0.00017352446 -0.010696368    0              0.010175795    1.9684447e-07  0              0.01900983     1.1965779e-13  0              2.9948315    
   1700000   7365           200            200           -0.00017349524 -0.010696375    0              0.010175889    4.1695554e-08  0              0.0040266582   1.1965779e-13  0              2.9948315    
   1800000   7365           200            200           -0.00017347807 -0.010696379    0              0.010175944    3.3917858e-10  0              3.2755439e-05  1.1965779e-13  0              2.9948315    
   1900000   7365           200            200           -0.00017348549 -0.010696377    0              0.01017592     9.7799198e-10  0              9.4447466e-05  1.1965779e-13  0              2.9948315    
   2000000   7365           200            200           -0.0001734863  -0.010696377    0              0.010175918    1.4892405e-11  0              1.4382018e-06  1.1965779e-13  0              2.9948315    
   2100000   7365           200            200           -0.00017348513 -0.010696377    0              0.010175922    1.1798084e-11  0              1.1393745e-06  1.1965779e-13  0              2.9948315    
   2200000   7365           200            200           -0.00017348526 -0.010696377    0              0.010175921    1.4810445e-12  0              1.4302867e-07  1.1965779e-13  0              2.9948315    
   2300000   7365           200            200           -0.00017348539 -0.010696377    0              0.010175921    4.7123694e-14  0              4.5508691e-09  1.1965779e-13  0              2.9948315    
   2400000   7365           200            200           -0.00017348535 -0.010696377    0              0.010175921    4.3283916e-14  0              4.1800508e-09  1.1965779e-13  0              2.9948315    
   2500000   7365           200            200           -0.00017348534 -0.010696377    0              0.010175921    1.4968903e-16  0              1.4455895e-11  1.1965779e-13  0              2.9948315    
   2600000   7365           200            200           -0.00017348535 -0.010696377    0              0.010175921    6.4949106e-16  0              6.2723198e-11  1.1965779e-13  0              2.9948315    
   2700000   7365           200            200           -0.00017348535 -0.010696377    0              0.010175921    3.6012796e-17  0              3.4778581e-12  1.1965779e-13  0              2.9948315    
   2800000   7365           200            200           -0.00017348535 -0.010696377    0              0.010175921    7.4728715e-18  0              7.2167644e-13  1.1965779e-13  0              2.9948315    
   2900000   7365           200            200           -0.00017348535 -0.010696377    0              0.010175921    4.5575854e-18  0              4.4013898e-13  1.1965779e-13  0              2.9948315    
   3000000   7365           200            200           -0.00017348535 -0.010696377    0              0.010175921    4.4265039e-18  0              4.2748006e-13  1.1965779e-13  0              2.9948315    
Loop time of 297.565 on 4 procs for 3000000 steps with 2501 atoms

Performance: 8710690.290 ns/day, 0.000 hours/ns, 10081.817 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 11.131     | 37.375     | 64.794     | 428.6 | 12.56
Neigh   | 4.5031     | 4.5811     | 4.6594     |   3.2 |  1.54
Comm    | 19.081     | 40.559     | 81.271     | 376.8 | 13.63
Output  | 0.27111    | 0.27143    | 0.27177    |   0.1 |  0.09
Modify  | 108.87     | 158.3      | 177.26     | 227.4 | 53.20
Other   |            | 56.48      |            |       | 18.98

Nlocal:         625.25 ave         876 max         375 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:           1.75 ave           3 max           1 min
Histogram: 2 0 0 0 0 1 0 0 0 1
Neighs:         329.75 ave         660 max           0 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 1319
Ave neighs/atom = 0.52738904
Neighbor list builds = 164
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 92

#variable lat0 equal 1                    #
variable lat1 equal 3+(100*0.01)+(v_ind*0.01)  # .491+(v_ind*0.001)       # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 500*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.92                                                               
Lattice spacing in x,y,z = 4.92 4.92 4.92

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -3690 ${n1e1} -100 100 -100 100 units box
region box block -3690 3690 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -3690 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -3690 3690 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-3690 -100 -100) to (3690 100 100)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 1500 atoms
  using lattice units in orthogonal box = (-3690 -100 -100) to (3690 100 100)
  create_atoms CPU = 0.000 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 1500 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 1001 atoms
  using lattice units in orthogonal box = (-3690 -100 -100) to (3690 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  1500 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  1500 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  1001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  1001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
1500 atoms in group substrate
group slider1 region slider1
1001 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 1001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_92_*.dump id type diameter mass xu yu zu fx fy fz

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 4762 130 130
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 95.95 | 95.98 | 96.01 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   7380           200            200            0              0              0              0              0              0              0              1.1965779e-13  0              6            
    100000   7380           200            200            0.0027449385  -1.094569e-35   0              0.0082348156   581826.37      0              5.6188626e+10  1.1965779e-13  0              3.3290957    
    200000   7380           200            200            0.00095137789  4.5976529e-41  0              0.0028541337   136972.07      0              1.3227782e+10  1.1965779e-13  0              3.0787159    
    300000   7380           200            200            3.1783456e-05 -2.1891272e-35  0              9.5350368e-05  328.64322      0              31738010       1.1965779e-13  0              3.0451828    
    400000   7380           200            200            8.5245847e-05 -4.3782413e-35  0              0.00025573754  2246.2123      0              2.1692311e+08  1.1965779e-13  0              3.0043125    
    500000   7380           200            200            0.0041721851  -0.00077360025  0              0.013290156    1430.3462      0              1.381326e+08   1.1965779e-13  0              2.9941429    
    600000   7380           200            200            0.004398831   -0.00050647452  0              0.013702968    66.429402      0              6415276.2      1.1965779e-13  0              2.9940846    
    700000   7380           200            200            0.003242812   -0.00040374225  0              0.010132178    27.725044      0              2677486.3      1.1965779e-13  0              2.9949063    
    800000   7380           200            200            0.0030824566  -0.00039879561  0              0.0096461655   0.62124408     0              59995.306      1.1965779e-13  0              2.9950308    
    900000   7380           200            200            0.0032018666  -0.00040230225  0              0.010007902    0.23821862     0              23005.449      1.1965779e-13  0              2.9949436    
   1000000   7380           200            200            0.0032598791  -0.00040395344  0              0.010183591    0.058959796    0              5693.9151      1.1965779e-13  0              2.9949006    
   1100000   7380           200            200            0.0032597407  -0.00040396119  0              0.010183183    1.1719153e-06  0              0.11317519     1.1965779e-13  0              2.9949004    
   1200000   7380           200            200            0.0032518639  -0.00040374392  0              0.010159336    0.0010518664   0              101.58172      1.1965779e-13  0              2.9949061    
   1300000   7380           200            200            0.0032497132  -0.00040368284  0              0.010152823    8.268108e-05   0              7.9847469      1.1965779e-13  0              2.9949078    
   1400000   7380           200            200            0.0032501814  -0.00040369537  0              0.010154239    3.4746519e-06  0              0.33555701     1.1965779e-13  0              2.9949074    
   1500000   7380           200            200            0.0032506005  -0.00040370706  0              0.010155509    3.0287758e-06  0              0.29249749     1.1965779e-13  0              2.9949071    
   1600000   7380           200            200            0.0032506531  -0.0004037086   0              0.010155668    5.2348917e-08  0              0.0050554837   1.1965779e-13  0              2.9949071    
   1700000   7380           200            200            0.003250611   -0.00040370745  0              0.010155541    2.9423545e-08  0              0.0028415154   1.1965779e-13  0              2.9949071    
   1800000   7380           200            200            0.0032505923  -0.00040370692  0              0.010155484    6.1110652e-09  0              0.00059016294  1.1965779e-13  0              2.9949071    
   1900000   7380           200            200            0.0032505929  -0.00040370693  0              0.010155486    2.4375955e-12  0              2.3540552e-07  1.1965779e-13  0              2.9949071    
   2000000   7380           200            200            0.0032505955  -0.00040370701  0              0.010155494    1.2037572e-10  0              1.1625025e-05  1.1965779e-13  0              2.9949071    
   2100000   7380           200            200            0.0032505962  -0.00040370703  0              0.010155496    7.9303954e-12  0              7.6586083e-07  1.1965779e-13  0              2.9949071    
   2200000   7380           200            200            0.003250596   -0.00040370702  0              0.010155495    4.9370986e-13  0              4.7678965e-08  1.1965779e-13  0              2.9949071    
   2300000   7380           200            200            0.0032505959  -0.00040370702  0              0.010155495    3.2872213e-13  0              3.1745631e-08  1.1965779e-13  0              2.9949071    
   2400000   7380           200            200            0.0032505959  -0.00040370702  0              0.010155495    3.8795848e-15  0              3.7466253e-10  1.1965779e-13  0              2.9949071    
   2500000   7380           200            200            0.0032505959  -0.00040370702  0              0.010155495    3.516451e-15   0              3.3959367e-10  1.1965779e-13  0              2.9949071    
   2600000   7380           200            200            0.0032505959  -0.00040370702  0              0.010155495    6.6127174e-16  0              6.3860892e-11  1.1965779e-13  0              2.9949071    
   2700000   7380           200            200            0.0032505959  -0.00040370702  0              0.010155495    1.1430985e-18  0              1.1039227e-13  1.1965779e-13  0              2.9949071    
   2800000   7380           200            200            0.0032505959  -0.00040370702  0              0.010155495    1.4365919e-17  0              1.3873576e-12  1.1965779e-13  0              2.9949071    
   2900000   7380           200            200            0.0032505959  -0.00040370702  0              0.010155495    1.0343697e-19  0              9.9892027e-15  1.1965779e-13  0              2.9949071    
   3000000   7380           200            200            0.0032505959  -0.00040370702  0              0.010155495    4.0920528e-19  0              3.9518117e-14  1.1965779e-13  0              2.9949071    
Loop time of 299.09 on 4 procs for 3000000 steps with 2501 atoms

Performance: 8666286.731 ns/day, 0.000 hours/ns, 10030.424 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 11.129     | 37.313     | 64.706     | 427.8 | 12.48
Neigh   | 4.5472     | 4.6298     | 4.7127     |   3.4 |  1.55
Comm    | 19.223     | 40.595     | 81.208     | 375.6 | 13.57
Output  | 0.27068    | 0.27099    | 0.27133    |   0.1 |  0.09
Modify  | 109.9      | 159.47     | 178.94     | 227.4 | 53.32
Other   |            | 56.82      |            |       | 19.00

Nlocal:         625.25 ave         876 max         375 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:           1.75 ave           3 max           1 min
Histogram: 2 0 0 0 0 1 0 0 0 1
Neighs:         329.25 ave         659 max           0 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 1317
Ave neighs/atom = 0.52658936
Neighbor list builds = 164
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 93

#variable lat0 equal 1                    #
variable lat1 equal 3+(100*0.01)+(v_ind*0.01)  # .491+(v_ind*0.001)       # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 500*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.93                                                               
Lattice spacing in x,y,z = 4.93 4.93 4.93

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -3697.5 ${n1e1} -100 100 -100 100 units box
region box block -3697.5 3697.5 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -3697.5 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -3697.5 3697.5 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-3697.5 -100 -100) to (3697.5 100 100)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 1500 atoms
  using lattice units in orthogonal box = (-3697.5 -100 -100) to (3697.5 100 100)
  create_atoms CPU = 0.000 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 1500 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 1001 atoms
  using lattice units in orthogonal box = (-3697.5 -100 -100) to (3697.5 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  1500 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  1500 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  1001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  1001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
1500 atoms in group substrate
group slider1 region slider1
1001 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 1001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_93_*.dump id type diameter mass xu yu zu fx fy fz

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 4771 130 130
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 96.15 | 96.16 | 96.16 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   7395           200            200            0              0              0              0              0              0              0              1.1965779e-13  0              6            
    100000   7395           200            200            0.0027393607   8.9978798e-40  0              0.008218082    581818.4       0              5.6187857e+10  1.1965779e-13  0              3.329137     
    200000   7395           200            200            0.00094933999  5.4617756e-36  0              0.00284802     136945.67      0              1.3225233e+10  1.1965779e-13  0              3.078779     
    300000   7395           200            200            3.1443208e-05  2.2915228e-40  0              9.4329623e-05  323.0884       0              31201565       1.1965779e-13  0              3.0452068    
    400000   7395           200            200            9.0550155e-05  2.1847383e-35  0              0.00027165046  2526.6998      0              2.4401058e+08  1.1965779e-13  0              3.004042     
    500000   7395           200            200            0.004382462   -6.7156328e-05  0              0.013214542    1393.2213      0              1.3454734e+08  1.1965779e-13  0              2.9940517    
    600000   7395           200            200            0.0016757681  -0.0024216824   0              0.0074489866   100.67168      0              9722150.6      1.1965779e-13  0              2.9955889    
    700000   7395           200            200            0.0026665119  -0.0016496198   0              0.0096491554   24.379181      0              2354366.8      1.1965779e-13  0              2.9949509    
    800000   7395           200            200            0.0030329524  -0.0015773957   0              0.010676253    0.0017762628   0              171.53875      1.1965779e-13  0              2.9946942    
    900000   7395           200            200            0.0028021958  -0.0016692414   0              0.010075829    0.44684617     0              43153.205      1.1965779e-13  0              2.9948474    
   1000000   7395           200            200            0.0028020901  -0.0016678483   0              0.010074118    0.020557264    0              1985.2734      1.1965779e-13  0              2.9948468    
   1100000   7395           200            200            0.0028307533  -0.0016625562   0              0.010154816    0.0037336411   0              360.56833      1.1965779e-13  0              2.9948262    
   1200000   7395           200            200            0.00282503    -0.0016636214   0              0.010138711    0.0010080216   0              97.34751       1.1965779e-13  0              2.9948305    
   1300000   7395           200            200            0.0028223291  -0.0016641053   0              0.010131093    3.2346945e-06  0              0.31238365     1.1965779e-13  0              2.9948324    
   1400000   7395           200            200            0.0028236492  -0.0016638617   0              0.010134809    2.1587636e-05  0              2.0847793      1.1965779e-13  0              2.9948314    
   1500000   7395           200            200            0.0028237458  -0.0016638457   0              0.010135083    4.8974386e-07  0              0.047295956    1.1965779e-13  0              2.9948314    
   1600000   7395           200            200            0.0028235482  -0.0016638818   0              0.010134526    2.3488379e-07  0              0.022683395    1.1965779e-13  0              2.9948315    
   1700000   7395           200            200            0.0028235752  -0.0016638766   0              0.010134602    3.7123706e-08  0              0.0035851418   1.1965779e-13  0              2.9948315    
   1800000   7395           200            200            0.0028235964  -0.0016638728   0              0.010134662    6.9061307e-10  0              6.6694467e-05  1.1965779e-13  0              2.9948315    
   1900000   7395           200            200            0.0028235885  -0.0016638743   0              0.01013464     9.8057478e-10  0              9.4696893e-05  1.1965779e-13  0              2.9948315    
   2000000   7395           200            200            0.0028235872  -0.0016638745   0              0.010134636    7.8807287e-12  0              7.6106437e-07  1.1965779e-13  0              2.9948315    
   2100000   7395           200            200            0.0028235885  -0.0016638742   0              0.01013464     1.3345327e-11  0              1.2887961e-06  1.1965779e-13  0              2.9948315    
   2200000   7395           200            200            0.0028235884  -0.0016638743   0              0.01013464     1.2530101e-12  0              1.2100675e-07  1.1965779e-13  0              2.9948315    
   2300000   7395           200            200            0.0028235883  -0.0016638743   0              0.010134639    7.0708004e-14  0              6.8284729e-09  1.1965779e-13  0              2.9948315    
   2400000   7395           200            200            0.0028235883  -0.0016638743   0              0.010134639    4.1894275e-14  0              4.0458492e-09  1.1965779e-13  0              2.9948315    
   2500000   7395           200            200            0.0028235883  -0.0016638743   0              0.010134639    2.3480859e-17  0              2.2676133e-12  1.1965779e-13  0              2.9948315    
   2600000   7395           200            200            0.0028235883  -0.0016638743   0              0.010134639    7.0020777e-16  0              6.7621054e-11  1.1965779e-13  0              2.9948315    
   2700000   7395           200            200            0.0028235883  -0.0016638743   0              0.010134639    2.48292e-17    0              2.3978264e-12  1.1965779e-13  0              2.9948315    
   2800000   7395           200            200            0.0028235883  -0.0016638743   0              0.010134639    1.0045839e-17  0              9.7015521e-13  1.1965779e-13  0              2.9948315    
   2900000   7395           200            200            0.0028235883  -0.0016638743   0              0.010134639    3.4681837e-18  0              3.3493236e-13  1.1965779e-13  0              2.9948315    
   3000000   7395           200            200            0.0028235883  -0.0016638743   0              0.010134639    4.1250258e-18  0              3.9836546e-13  1.1965779e-13  0              2.9948315    
Loop time of 295.119 on 4 procs for 3000000 steps with 2501 atoms

Performance: 8782884.032 ns/day, 0.000 hours/ns, 10165.375 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 10.853     | 37.203     | 63.978     | 428.0 | 12.61
Neigh   | 4.532      | 4.6076     | 4.6834     |   3.0 |  1.56
Comm    | 19.743     | 38.62      | 77.891     | 369.3 | 13.09
Output  | 0.27353    | 0.27384    | 0.27416    |   0.1 |  0.09
Modify  | 109.31     | 157.85     | 177.86     | 224.6 | 53.49
Other   |            | 56.56      |            |       | 19.17

Nlocal:         625.25 ave         876 max         375 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:           1.75 ave           3 max           1 min
Histogram: 2 0 0 0 0 1 0 0 0 1
Neighs:         329.25 ave         659 max           0 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 1317
Ave neighs/atom = 0.52658936
Neighbor list builds = 164
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 94

#variable lat0 equal 1                    #
variable lat1 equal 3+(100*0.01)+(v_ind*0.01)  # .491+(v_ind*0.001)       # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 500*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.94                                                               
Lattice spacing in x,y,z = 4.94 4.94 4.94

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -3705 ${n1e1} -100 100 -100 100 units box
region box block -3705 3705 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -3705 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -3705 3705 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-3705 -100 -100) to (3705 100 100)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 1499 atoms
  using lattice units in orthogonal box = (-3705 -100 -100) to (3705 100 100)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 1500 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 1001 atoms
  using lattice units in orthogonal box = (-3705 -100 -100) to (3705 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  1499 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  1499 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  1001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  1001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
1499 atoms in group substrate
group slider1 region slider1
1001 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 1001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_94_*.dump id type diameter mass xu yu zu fx fy fz

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 4781 130 130
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 96.36 | 96.36 | 96.37 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   7410           200            200            0              0              0              0              0              0              0              1.1965779e-13  0              6            
    100000   7410           200            200            0.002733848    1.8272523e-40  0              0.008201544    581826.7       0              5.630126e+10   1.1965779e-13  0              3.3291458    
    200000   7410           200            200            0.0009474531  -4.3603036e-35  0              0.0028423593   136952.43      0              1.325239e+10   1.1965779e-13  0              3.0787975    
    300000   7410           200            200            3.1595164e-05  1.3081894e-34  0              9.4785493e-05  327.42837      0              31684057       1.1965779e-13  0              3.0452262    
    400000   7410           200            200            9.232627e-05  -6.5407963e-35  0              0.00027697881  2630.7785      0              2.545709e+08   1.1965779e-13  0              3.003952     
    500000   7410           200            200            0.0023284162  -0.0042017629   0              0.011187011    1494.3404      0              1.446019e+08   1.1965779e-13  0              2.9945151    
    600000   7410           200            200            0.0026759018  -0.00041158098  0              0.0084392863   164.49752      0              15917829       1.1965779e-13  0              2.9953005    
    700000   7410           200            200            0.0024547267  -0.0018230738   0              0.0091872538   16.13223       0              1561057.4      1.1965779e-13  0              2.9950711    
    800000   7410           200            200            0.0028470806  -0.0021096844   0              0.010650926    0.0090950067   0              880.09083      1.1965779e-13  0              2.9946946    
    900000   7410           200            200            0.0026626008  -0.0020232872   0              0.010011089    0.3520324      0              34064.899      1.1965779e-13  0              2.9948595    
   1000000   7410           200            200            0.0026834524  -0.0020348839   0              0.010085241    0.056151318    0              5433.5595      1.1965779e-13  0              2.9948392    
   1100000   7410           200            200            0.0026991555  -0.0020426145   0              0.010140081    0.00036550531  0              35.368624      1.1965779e-13  0              2.9948254    
   1200000   7410           200            200            0.0026897615  -0.0020378716   0              0.010107156    0.00057461661  0              55.603566      1.1965779e-13  0              2.9948339    
   1300000   7410           200            200            0.0026915735  -0.0020388226   0              0.010113543    0.00015900098  0              15.385949      1.1965779e-13  0              2.9948322    
   1400000   7410           200            200            0.002692081   -0.0020390667   0              0.01011531     4.1768711e-06  0              0.40418068     1.1965779e-13  0              2.9948318    
   1500000   7410           200            200            0.0026916242  -0.0020388365   0              0.010113709    7.1457163e-07  0              0.069146507    1.1965779e-13  0              2.9948322    
   1600000   7410           200            200            0.0026917469  -0.0020388999   0              0.010114141    3.9610098e-07  0              0.038329256    1.1965779e-13  0              2.9948321    
   1700000   7410           200            200            0.0026917571  -0.0020389044   0              0.010114176    2.2311578e-08  0              0.0021590106   1.1965779e-13  0              2.9948321    
   1800000   7410           200            200            0.0026917363  -0.002038894    0              0.010114103    5.0039086e-10  0              4.842101e-05   1.1965779e-13  0              2.9948321    
   1900000   7410           200            200            0.0026917436  -0.0020388978   0              0.010114129    8.7057504e-10  0              8.4242391e-05  1.1965779e-13  0              2.9948321    
   2000000   7410           200            200            0.0026917434  -0.0020388976   0              0.010114128    8.7056107e-11  0              8.4241039e-06  1.1965779e-13  0              2.9948321    
   2100000   7410           200            200            0.0026917425  -0.0020388972   0              0.010114125    5.6049278e-15  0              5.4236855e-10  1.1965779e-13  0              2.9948321    
   2200000   7410           200            200            0.0026917429  -0.0020388974   0              0.010114126    1.6633967e-12  0              1.6096087e-07  1.1965779e-13  0              2.9948321    
   2300000   7410           200            200            0.0026917429  -0.0020388973   0              0.010114126    2.8043283e-13  0              2.7136468e-08  1.1965779e-13  0              2.9948321    
   2400000   7410           200            200            0.0026917428  -0.0020388973   0              0.010114126    2.3600748e-15  0              2.2837588e-10  1.1965779e-13  0              2.9948321    
   2500000   7410           200            200            0.0026917428  -0.0020388973   0              0.010114126    2.6275358e-15  0              2.5425711e-10  1.1965779e-13  0              2.9948321    
   2600000   7410           200            200            0.0026917428  -0.0020388973   0              0.010114126    7.80382e-16    0              7.5514737e-11  1.1965779e-13  0              2.9948321    
   2700000   7410           200            200            0.0026917428  -0.0020388973   0              0.010114126    1.5351432e-17  0              1.4855025e-12  1.1965779e-13  0              2.9948321    
   2800000   7410           200            200            0.0026917428  -0.0020388973   0              0.010114126    5.9672692e-18  0              5.7743101e-13  1.1965779e-13  0              2.9948321    
   2900000   7410           200            200            0.0026917428  -0.0020388973   0              0.010114126    4.8252132e-18  0              4.6691839e-13  1.1965779e-13  0              2.9948321    
   3000000   7410           200            200            0.0026917428  -0.0020388973   0              0.010114126    2.1759323e-18  0              2.1055709e-13  1.1965779e-13  0              2.9948321    
Loop time of 292.131 on 4 procs for 3000000 steps with 2500 atoms

Performance: 8872737.513 ns/day, 0.000 hours/ns, 10269.372 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 10.347     | 36.458     | 62.39      | 427.2 | 12.48
Neigh   | 4.5622     | 4.6372     | 4.712      |   3.0 |  1.59
Comm    | 25.648     | 51.89      | 77.242     | 347.4 | 17.76
Output  | 0.26898    | 0.26931    | 0.26964    |   0.1 |  0.09
Modify  | 108.82     | 143.01     | 177.37     | 280.5 | 48.95
Other   |            | 55.86      |            |       | 19.12

Nlocal:            625 ave         876 max         375 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:            1.5 ave           4 max           0 min
Histogram: 2 0 0 0 0 1 0 0 0 1
Neighs:         329.75 ave         660 max           0 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 1319
Ave neighs/atom = 0.5276
Neighbor list builds = 164
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 95

#variable lat0 equal 1                    #
variable lat1 equal 3+(100*0.01)+(v_ind*0.01)  # .491+(v_ind*0.001)       # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 500*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.95                                                               
Lattice spacing in x,y,z = 4.95 4.95 4.95

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -3712.5 ${n1e1} -100 100 -100 100 units box
region box block -3712.5 3712.5 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -3712.5 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -3712.5 3712.5 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-3712.5 -100 -100) to (3712.5 100 100)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 1500 atoms
  using lattice units in orthogonal box = (-3712.5 -100 -100) to (3712.5 100 100)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 1500 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 1001 atoms
  using lattice units in orthogonal box = (-3712.5 -100 -100) to (3712.5 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  1500 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  1500 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  1001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  1001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
1500 atoms in group substrate
group slider1 region slider1
1001 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 1001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_95_*.dump id type diameter mass xu yu zu fx fy fz

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 4791 130 130
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 96.5 | 96.5 | 96.51 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   7425           200            200            0              0              0              0              0              0              0              1.1965779e-13  0              6            
    100000   7425           200            200            0.0027284855  -1.0879287e-35  0              0.0081854564   581882.02      0              5.6194001e+10  1.1965779e-13  0              3.3290723    
    200000   7425           200            200            0.00094582844  6.8931791e-40  0              0.0028374853   137017.92      0              1.323221e+10   1.1965779e-13  0              3.0787485    
    300000   7425           200            200            3.0004727e-05 -2.1758218e-35  0              9.001418e-05   297.19966      0              28701416       1.1965779e-13  0              3.0452764    
    400000   7425           200            200            9.7286025e-05  1.0879472e-35  0              0.00029185807  2913.5063      0              2.8136559e+08  1.1965779e-13  0              3.0037054    
    500000   7425           200            200            0.0010016721  -2.1758571e-35  0              0.0030050164   569.75403      0              55022766       1.1965779e-13  0              2.9970863    
    600000   7425           200            200            0.0028752078  -0.00036189977  0              0.0089875231   202.90331      0              19594949       1.1965779e-13  0              2.9949624    
    700000   7425           200            200            0.0030919164  -0.00051333921  0              0.0097890883   27.313069      0              2637700.7      1.1965779e-13  0              2.9947666    
    800000   7425           200            200            0.0032189623  -0.00058595147  0              0.010242838    3.5757187      0              345317.32      1.1965779e-13  0              2.9946615    
    900000   7425           200            200            0.0032179874  -0.00058603768  0              0.01024        0.28110838     0              27147.436      1.1965779e-13  0              2.9946606    
   1000000   7425           200            200            0.0031945247  -0.00058459976  0              0.010168174    0.007797586    0              753.03505      1.1965779e-13  0              2.994676     
   1100000   7425           200            200            0.0031794459  -0.00058363787  0              0.010121976    0.00020197786  0              19.505576      1.1965779e-13  0              2.9946861    
   1200000   7425           200            200            0.0031728481  -0.00058320817  0              0.010101753    0.00044512975  0              42.987446      1.1965779e-13  0              2.9946906    
   1300000   7425           200            200            0.003170605   -0.00058306011  0              0.010094875    0.00013814179  0              13.340746      1.1965779e-13  0              2.9946921    
   1400000   7425           200            200            0.0031700405  -0.00058302228  0              0.010093144    2.2767202e-05  0              2.1986934      1.1965779e-13  0              2.9946925    
   1500000   7425           200            200            0.0031699771  -0.00058301774  0              0.010092949    2.2720348e-06  0              0.21941686     1.1965779e-13  0              2.9946926    
   1600000   7425           200            200            0.003170012   -0.0005830199   0              0.010093056    1.1120858e-07  0              0.010739728    1.1965779e-13  0              2.9946925    
   1700000   7425           200            200            0.0031700433  -0.00058302192  0              0.010093152    1.6635532e-10  0              1.6065406e-05  1.1965779e-13  0              2.9946925    
   1800000   7425           200            200            0.0031700588  -0.00058302293  0              0.010093199    1.3389035e-09  0              0.00012930171  1.1965779e-13  0              2.9946925    
   1900000   7425           200            200            0.0031700646  -0.00058302332  0              0.010093217    6.4749236e-10  0              6.2530178e-05  1.1965779e-13  0              2.9946925    
   2000000   7425           200            200            0.0031700663  -0.00058302343  0              0.010093222    1.3351137e-10  0              1.2893573e-05  1.1965779e-13  0              2.9946925    
   2100000   7425           200            200            0.0031700666  -0.00058302345  0              0.010093223    1.6452597e-11  0              1.5888741e-06  1.1965779e-13  0              2.9946925    
   2200000   7425           200            200            0.0031700666  -0.00058302345  0              0.010093223    1.1464869e-12  0              1.107195e-07   1.1965779e-13  0              2.9946925    
   2300000   7425           200            200            0.0031700665  -0.00058302344  0              0.010093223    2.1782369e-14  0              2.1035853e-09  1.1965779e-13  0              2.9946925    
   2400000   7425           200            200            0.0031700665  -0.00058302344  0              0.010093223    2.4454692e-15  0              2.3616591e-10  1.1965779e-13  0              2.9946925    
   2500000   7425           200            200            0.0031700665  -0.00058302344  0              0.010093223    2.7364405e-15  0              2.6426584e-10  1.1965779e-13  0              2.9946925    
   2600000   7425           200            200            0.0031700665  -0.00058302344  0              0.010093223    7.1107154e-16  0              6.86702e-11    1.1965779e-13  0              2.9946925    
   2700000   7425           200            200            0.0031700665  -0.00058302344  0              0.010093223    1.0637533e-16  0              1.0272968e-11  1.1965779e-13  0              2.9946925    
   2800000   7425           200            200            0.0031700665  -0.00058302344  0              0.010093223    2.3935131e-18  0              2.3114836e-13  1.1965779e-13  0              2.9946925    
   2900000   7425           200            200            0.0031700665  -0.00058302344  0              0.010093223    3.8951904e-18  0              3.7616961e-13  1.1965779e-13  0              2.9946925    
   3000000   7425           200            200            0.0031700665  -0.00058302344  0              0.010093223    1.2808518e-19  0              1.236955e-14   1.1965779e-13  0              2.9946925    
Loop time of 295.408 on 4 procs for 3000000 steps with 2501 atoms

Performance: 8774296.370 ns/day, 0.000 hours/ns, 10155.436 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 10.863     | 37.802     | 65.023     | 433.2 | 12.80
Neigh   | 4.5824     | 4.6609     | 4.7405     |   3.2 |  1.58
Comm    | 19.453     | 38.772     | 78.942     | 377.1 | 13.12
Output  | 0.27509    | 0.27543    | 0.27575    |   0.1 |  0.09
Modify  | 109        | 157.65     | 176.45     | 224.8 | 53.37
Other   |            | 56.24      |            |       | 19.04

Nlocal:         625.25 ave         876 max         375 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:           1.75 ave           3 max           1 min
Histogram: 2 0 0 0 0 1 0 0 0 1
Neighs:         333.25 ave         667 max           0 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 1333
Ave neighs/atom = 0.53298681
Neighbor list builds = 164
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 96

#variable lat0 equal 1                    #
variable lat1 equal 3+(100*0.01)+(v_ind*0.01)  # .491+(v_ind*0.001)       # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 500*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.96                                                               
Lattice spacing in x,y,z = 4.96 4.96 4.96

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -3720 ${n1e1} -100 100 -100 100 units box
region box block -3720 3720 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -3720 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -3720 3720 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-3720 -100 -100) to (3720 100 100)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 1500 atoms
  using lattice units in orthogonal box = (-3720 -100 -100) to (3720 100 100)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 1500 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 1001 atoms
  using lattice units in orthogonal box = (-3720 -100 -100) to (3720 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  1500 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  1500 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  1001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  1001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
1500 atoms in group substrate
group slider1 region slider1
1001 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 1001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_96_*.dump id type diameter mass xu yu zu fx fy fz

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 4800 130 130
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 96.71 | 96.71 | 96.72 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   7440           200            200            0              0              0              0              0              0              0              1.1965779e-13  0              6            
    100000   7440           200            200            0.0027222659   2.0357706e-36  0              0.0081667976   581649.39      0              5.6171535e+10  1.1965779e-13  0              3.3292747    
    200000   7440           200            200            0.00094212993 -1.0857329e-35  0              0.0028263898   136610.28      0              1.3192843e+10  1.1965779e-13  0              3.0790868    
    300000   7440           200            200            2.8645809e-05 -1.3028858e-34  0              8.5937428e-05  272.56418      0              26322298       1.1965779e-13  0              3.0452087    
    400000   7440           200            200            8.43548e-05   -8.6859359e-35  0              0.0002530644   2236.0077      0              2.1593762e+08  1.1965779e-13  0              3.0043233    
    500000   7440           200            200            0.0066675665   0.005481266    0              0.014521434    1277.4886      0              1.233707e+08   1.1965779e-13  0              2.9937518    
    600000   7440           200            200            0.002765173    0.0011577975   0              0.0071377216   80.861015      0              7808978.1      1.1965779e-13  0              2.9956586    
    700000   7440           200            200            0.0037136113   0.0022321953   0              0.0089086384   9.9183611      0              957844.33      1.1965779e-13  0              2.9951336    
    800000   7440           200            200            0.0041730741   0.0023776276   0              0.010141595    3.6107562      0              348700.99      1.1965779e-13  0              2.9948136    
    900000   7440           200            200            0.0042127716   0.0023840303   0              0.010254284    0.081045605    0              7826.8044      1.1965779e-13  0              2.9947872    
   1000000   7440           200            200            0.0041700089   0.0023759378   0              0.010134089    0.020881594    0              2016.5949      1.1965779e-13  0              2.9948181    
   1100000   7440           200            200            0.0041482038   0.0023717824   0              0.010072829    0.0090131832   0              870.42872      1.1965779e-13  0              2.9948336    
   1200000   7440           200            200            0.0041454099   0.0023712678   0              0.010064962    0.00031759579  0              30.671129      1.1965779e-13  0              2.9948355    
   1300000   7440           200            200            0.0041472511   0.0023716317   0              0.010070122    3.3648367e-05  0              3.2495184      1.1965779e-13  0              2.9948342    
   1400000   7440           200            200            0.0041483516   0.0023718438   0              0.010073211    2.1924444e-05  0              2.1173059      1.1965779e-13  0              2.9948334    
   1500000   7440           200            200            0.0041485357   0.0023718782   0              0.010073729    1.1175358e-06  0              0.10792361     1.1965779e-13  0              2.9948332    
   1600000   7440           200            200            0.0041484596   0.0023718631   0              0.010073516    4.6719646e-08  0              0.004511849    1.1965779e-13  0              2.9948333    
   1700000   7440           200            200            0.0041484048   0.0023718525   0              0.010073362    5.1741222e-08  0              0.0049967969   1.1965779e-13  0              2.9948333    
   1800000   7440           200            200            0.0041483936   0.0023718504   0              0.01007333     3.6252136e-09  0              0.00035009719  1.1965779e-13  0              2.9948333    
   1900000   7440           200            200            0.0041483966   0.002371851    0              0.010073339    4.9309116e-11  0              4.7619214e-06  1.1965779e-13  0              2.9948333    
   2000000   7440           200            200            0.0041483993   0.0023718515   0              0.010073346    1.183224e-10   0              1.1426731e-05  1.1965779e-13  0              2.9948333    
   2100000   7440           200            200            0.0041483999   0.0023718516   0              0.010073348    1.1062673e-11  0              1.0683538e-06  1.1965779e-13  0              2.9948333    
   2200000   7440           200            200            0.0041483998   0.0023718516   0              0.010073348    2.5891209e-14  0              2.5003876e-09  1.1965779e-13  0              2.9948333    
   2300000   7440           200            200            0.0041483997   0.0023718516   0              0.010073347    2.620052e-13   0              2.5302587e-08  1.1965779e-13  0              2.9948333    
   2400000   7440           200            200            0.0041483996   0.0023718516   0              0.010073347    3.2193554e-14  0              3.109023e-09   1.1965779e-13  0              2.9948333    
   2500000   7440           200            200            0.0041483996   0.0023718516   0              0.010073347    4.2647961e-18  0              4.1186348e-13  1.1965779e-13  0              2.9948333    
   2600000   7440           200            200            0.0041483996   0.0023718516   0              0.010073347    5.5794163e-16  0              5.3882009e-11  1.1965779e-13  0              2.9948333    
   2700000   7440           200            200            0.0041483996   0.0023718516   0              0.010073347    9.0560578e-17  0              8.7456925e-12  1.1965779e-13  0              2.9948333    
   2800000   7440           200            200            0.0041483996   0.0023718516   0              0.010073347    1.6435609e-18  0              1.5872335e-13  1.1965779e-13  0              2.9948333    
   2900000   7440           200            200            0.0041483996   0.0023718516   0              0.010073347    2.0577042e-18  0              1.9871835e-13  1.1965779e-13  0              2.9948333    
   3000000   7440           200            200            0.0041483996   0.0023718516   0              0.010073347    7.0317416e-18  0              6.7907527e-13  1.1965779e-13  0              2.9948333    
Loop time of 293.845 on 4 procs for 3000000 steps with 2501 atoms

Performance: 8820976.521 ns/day, 0.000 hours/ns, 10209.464 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 10.872     | 37.123     | 63.848     | 426.6 | 12.63
Neigh   | 4.5501     | 4.6244     | 4.6996     |   3.0 |  1.57
Comm    | 19.545     | 38.47      | 77.712     | 369.9 | 13.09
Output  | 0.27165    | 0.27196    | 0.27229    |   0.1 |  0.09
Modify  | 108.76     | 157.17     | 176.69     | 224.4 | 53.49
Other   |            | 56.18      |            |       | 19.12

Nlocal:         625.25 ave         876 max         375 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:           1.75 ave           3 max           1 min
Histogram: 2 0 0 0 0 1 0 0 0 1
Neighs:         328.25 ave         657 max           0 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 1313
Ave neighs/atom = 0.52499
Neighbor list builds = 164
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 97

#variable lat0 equal 1                    #
variable lat1 equal 3+(100*0.01)+(v_ind*0.01)  # .491+(v_ind*0.001)       # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 500*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.97                                                               
Lattice spacing in x,y,z = 4.97 4.97 4.97

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -3727.5 ${n1e1} -100 100 -100 100 units box
region box block -3727.5 3727.5 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -3727.5 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -3727.5 3727.5 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-3727.5 -100 -100) to (3727.5 100 100)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 1500 atoms
  using lattice units in orthogonal box = (-3727.5 -100 -100) to (3727.5 100 100)
  create_atoms CPU = 0.000 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 1500 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 1001 atoms
  using lattice units in orthogonal box = (-3727.5 -100 -100) to (3727.5 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  1500 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  1500 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  1001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  1001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
1500 atoms in group substrate
group slider1 region slider1
1001 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 1001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_97_*.dump id type diameter mass xu yu zu fx fy fz

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 4810 130 130
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 96.79 | 96.82 | 96.84 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   7455           200            200            0              0              0              0              0              0              0              1.1965779e-13  0              6            
    100000   7455           200            200            0.0027167853   2.7089051e-36  0              0.008150356    581648.19      0              5.6171419e+10  1.1965779e-13  0              3.3292771    
    200000   7455           200            200            0.00094023951  4.3343825e-35  0              0.0028207185   136611.48      0              1.3192959e+10  1.1965779e-13  0              3.0790857    
    300000   7455           200            200            2.8597626e-05  4.3343508e-35  0              8.5792878e-05  272.74031      0              26339307       1.1965779e-13  0              3.0452087    
    400000   7455           200            200            8.4075721e-05  4.3342936e-35  0              0.00025222716  2230.524       0              2.1540804e+08  1.1965779e-13  0              3.004329     
    500000   7455           200            200            0.0066541394   0.0054254064   0              0.014537012    1273.6194      0              1.2299704e+08  1.1965779e-13  0              2.9937394    
    600000   7455           200            200            0.0034253728   0.0031501025   0              0.007126016    78.486384      0              7579653.2      1.1965779e-13  0              2.9956672    
    700000   7455           200            200            0.0044261237   0.0035482319   0              0.0097301392   26.014259      0              2512271        1.1965779e-13  0              2.9949089    
    800000   7455           200            200            0.0046722998   0.0034309942   0              0.010585905    0.069890343    0              6749.5091      1.1965779e-13  0              2.9946956    
    900000   7455           200            200            0.0044730928   0.0034456382   0              0.0099736403   0.40864736     0              39464.237      1.1965779e-13  0              2.9948529    
   1000000   7455           200            200            0.0044813042   0.0034459488   0              0.0099979638   0.027942609    0              2698.4971      1.1965779e-13  0              2.9948455    
   1100000   7455           200            200            0.0045080452   0.0034491926   0              0.010074943    0.0027406204   0              264.6695       1.1965779e-13  0              2.9948257    
   1200000   7455           200            200            0.0045014764   0.00344836     0              0.010056069    0.001101041    0              106.33066      1.1965779e-13  0              2.9948307    
   1300000   7455           200            200            0.0044992009   0.0034480866   0              0.010049516    1.0742059e-07  0              0.010373912    1.1965779e-13  0              2.9948324    
   1400000   7455           200            200            0.0045005478   0.0034482534   0              0.01005339     2.0622413e-05  0              1.9915651      1.1965779e-13  0              2.9948314    
   1500000   7455           200            200            0.0045005815   0.0034482565   0              0.010053488    7.6889229e-07  0              0.074254114    1.1965779e-13  0              2.9948314    
   1600000   7455           200            200            0.004500393    0.0034482333   0              0.010052946    1.888506e-07   0              0.018237839    1.1965779e-13  0              2.9948315    
   1700000   7455           200            200            0.0045004267   0.0034482376   0              0.010053043    4.2598674e-08  0              0.004113875    1.1965779e-13  0              2.9948315    
   1800000   7455           200            200            0.0045004453   0.0034482399   0              0.010053096    2.8035082e-10  0              2.7074275e-05  1.1965779e-13  0              2.9948315    
   1900000   7455           200            200            0.004500437    0.0034482388   0              0.010053072    9.7528016e-10  0              9.4185577e-05  1.1965779e-13  0              2.9948315    
   2000000   7455           200            200            0.0045004362   0.0034482387   0              0.01005307     1.6615268e-11  0              1.6045837e-06  1.1965779e-13  0              2.9948315    
   2100000   7455           200            200            0.0045004374   0.0034482389   0              0.010053073    1.1454697e-11  0              1.1062127e-06  1.1965779e-13  0              2.9948315    
   2200000   7455           200            200            0.0045004373   0.0034482389   0              0.010053073    1.5285218e-12  0              1.476137e-07   1.1965779e-13  0              2.9948315    
   2300000   7455           200            200            0.0045004371   0.0034482388   0              0.010053073    4.2630518e-14  0              4.1169503e-09  1.1965779e-13  0              2.9948315    
   2400000   7455           200            200            0.0045004372   0.0034482388   0              0.010053073    4.3470855e-14  0              4.198104e-09   1.1965779e-13  0              2.9948315    
   2500000   7455           200            200            0.0045004372   0.0034482389   0              0.010053073    1.8833489e-16  0              1.8188035e-11  1.1965779e-13  0              2.9948315    
   2600000   7455           200            200            0.0045004372   0.0034482389   0              0.010053073    6.344008e-16   0              6.1265888e-11  1.1965779e-13  0              2.9948315    
   2700000   7455           200            200            0.0045004372   0.0034482389   0              0.010053073    3.4265483e-17  0              3.3091151e-12  1.1965779e-13  0              2.9948315    
   2800000   7455           200            200            0.0045004372   0.0034482389   0              0.010053073    8.3021197e-18  0              8.017593e-13   1.1965779e-13  0              2.9948315    
   2900000   7455           200            200            0.0045004372   0.0034482389   0              0.010053073    6.9921174e-18  0              6.7524865e-13  1.1965779e-13  0              2.9948315    
   3000000   7455           200            200            0.0045004372   0.0034482389   0              0.010053073    3.5052801e-18  0              3.3851486e-13  1.1965779e-13  0              2.9948315    
Loop time of 293.318 on 4 procs for 3000000 steps with 2501 atoms

Performance: 8836829.793 ns/day, 0.000 hours/ns, 10227.812 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 10.889     | 37.037     | 63.626     | 425.6 | 12.63
Neigh   | 4.5541     | 4.6302     | 4.7075     |   3.2 |  1.58
Comm    | 19.435     | 38.404     | 77.539     | 369.3 | 13.09
Output  | 0.27464    | 0.27496    | 0.27527    |   0.1 |  0.09
Modify  | 108.88     | 157.07     | 176.25     | 223.3 | 53.55
Other   |            | 55.9       |            |       | 19.06

Nlocal:         625.25 ave         876 max         375 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:           1.75 ave           3 max           1 min
Histogram: 2 0 0 0 0 1 0 0 0 1
Neighs:         328.75 ave         658 max           0 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 1315
Ave neighs/atom = 0.52578968
Neighbor list builds = 164
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 98

#variable lat0 equal 1                    #
variable lat1 equal 3+(100*0.01)+(v_ind*0.01)  # .491+(v_ind*0.001)       # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 500*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.98                                                               
Lattice spacing in x,y,z = 4.98 4.98 4.98

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -3735 ${n1e1} -100 100 -100 100 units box
region box block -3735 3735 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -3735 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -3735 3735 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-3735 -100 -100) to (3735 100 100)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 1499 atoms
  using lattice units in orthogonal box = (-3735 -100 -100) to (3735 100 100)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 1500 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 1001 atoms
  using lattice units in orthogonal box = (-3735 -100 -100) to (3735 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  1499 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  1499 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  1001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  1001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
1499 atoms in group substrate
group slider1 region slider1
1001 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 1001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_98_*.dump id type diameter mass xu yu zu fx fy fz

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 4820 130 130
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 96.98 | 96.99 | 97 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   7470           200            200            0              0              0              0              0              0              0              1.1965779e-13  0              6            
    100000   7470           200            200            0.0027113209  -8.6510012e-35  0              0.0081339627   581645.17      0              5.6283695e+10  1.1965779e-13  0              3.3292803    
    200000   7470           200            200            0.00093834714 -6.4882459e-35  0              0.0028150414   136610.53      0              1.3219306e+10  1.1965779e-13  0              3.0790855    
    300000   7470           200            200            2.8606175e-05 -2.1627419e-35  0              8.5818524e-05  273.97378      0              26511450       1.1965779e-13  0              3.0452063    
    400000   7470           200            200            8.4201327e-05 -4.3254627e-35  0              0.00025260398  2245.3333      0              2.1727277e+08  1.1965779e-13  0              3.004313     
    500000   7470           200            200            0.007686988    0.0091314424   0              0.013929522    1323.3682      0              1.2805754e+08  1.1965779e-13  0              2.9938481    
    600000   7470           200            200            0.0036119051   0.00422322     0              0.0066124952   22.378283      0              2165465.4      1.1965779e-13  0              2.9958383    
    700000   7470           200            200            0.0055438479   0.0054632161   0              0.011168328    9.8814179      0              956188.99      1.1965779e-13  0              2.9945234    
    800000   7470           200            200            0.0052726974   0.0053916564   0              0.010426436    1.4522894      0              140532.78      1.1965779e-13  0              2.9947135    
    900000   7470           200            200            0.0051019208   0.0053468765   0              0.0099588859   0.41213012     0              39880.338      1.1965779e-13  0              2.9948419    
   1000000   7470           200            200            0.0051038041   0.0053470808   0              0.0099643316   0.0006973845   0              67.483371      1.1965779e-13  0              2.9948413    
   1100000   7470           200            200            0.0051272706   0.0053534205   0              0.010028391    0.0085042769   0              822.92805      1.1965779e-13  0              2.9948238    
   1200000   7470           200            200            0.0051319638   0.0053547197   0              0.010041172    0.00024914776  0              24.109126      1.1965779e-13  0              2.9948202    
   1300000   7470           200            200            0.0051297817   0.0053541437   0              0.010035201    8.334232e-05   0              8.0647342      1.1965779e-13  0              2.9948218    
   1400000   7470           200            200            0.0051286913   0.0053538476   0              0.010032226    1.6352071e-05  0              1.5823306      1.1965779e-13  0              2.9948226    
   1500000   7470           200            200            0.0051287569   0.0053538633   0              0.010032407    1.4677911e-07  0              0.014203283    1.1965779e-13  0              2.9948226    
   1600000   7470           200            200            0.0051289177   0.0053539065   0              0.010032847    3.9164468e-07  0              0.037898036    1.1965779e-13  0              2.9948225    
   1700000   7470           200            200            0.0051289426   0.0053539135   0              0.010032914    6.3356982e-09  0              0.00061308255  1.1965779e-13  0              2.9948225    
   1800000   7470           200            200            0.0051289261   0.0053539091   0              0.010032869    4.5855622e-09  0              0.00044372823  1.1965779e-13  0              2.9948225    
   1900000   7470           200            200            0.0051289193   0.0053539072   0              0.010032851    6.2204505e-10  0              6.0193045e-05  1.1965779e-13  0              2.9948225    
   2000000   7470           200            200            0.0051289201   0.0053539074   0              0.010032853    1.5224439e-11  0              1.4732137e-06  1.1965779e-13  0              2.9948225    
   2100000   7470           200            200            0.0051289212   0.0053539077   0              0.010032856    1.7491425e-11  0              1.6925818e-06  1.1965779e-13  0              2.9948225    
   2200000   7470           200            200            0.0051289213   0.0053539078   0              0.010032856    1.2318333e-13  0              1.1920004e-08  1.1965779e-13  0              2.9948225    
   2300000   7470           200            200            0.0051289212   0.0053539077   0              0.010032856    2.405285e-13   0              2.3275071e-08  1.1965779e-13  0              2.9948225    
   2400000   7470           200            200            0.0051289211   0.0053539077   0              0.010032856    2.2476422e-14  0              2.1749619e-09  1.1965779e-13  0              2.9948225    
   2500000   7470           200            200            0.0051289212   0.0053539077   0              0.010032856    1.2491503e-15  0              1.2087575e-10  1.1965779e-13  0              2.9948225    
   2600000   7470           200            200            0.0051289212   0.0053539077   0              0.010032856    7.5756539e-16  0              7.3306856e-11  1.1965779e-13  0              2.9948225    
   2700000   7470           200            200            0.0051289212   0.0053539077   0              0.010032856    1.3318833e-19  0              1.2888152e-14  1.1965779e-13  0              2.9948225    
   2800000   7470           200            200            0.0051289212   0.0053539077   0              0.010032856    1.3565248e-17  0              1.3126598e-12  1.1965779e-13  0              2.9948225    
   2900000   7470           200            200            0.0051289212   0.0053539077   0              0.010032856    4.8865077e-19  0              4.7284964e-14  1.1965779e-13  0              2.9948225    
   3000000   7470           200            200            0.0051289212   0.0053539077   0              0.010032856    5.2353556e-18  0              5.0660639e-13  1.1965779e-13  0              2.9948225    
Loop time of 292.084 on 4 procs for 3000000 steps with 2500 atoms

Performance: 8874157.463 ns/day, 0.000 hours/ns, 10271.016 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 10.379     | 36.167     | 61.697     | 423.3 | 12.38
Neigh   | 4.5945     | 4.6662     | 4.7394     |   2.9 |  1.60
Comm    | 25.473     | 51.396     | 76.511     | 345.0 | 17.60
Output  | 0.32982    | 0.33014    | 0.33048    |   0.1 |  0.11
Modify  | 108.39     | 143.08     | 177.44     | 284.9 | 48.99
Other   |            | 56.44      |            |       | 19.32

Nlocal:            625 ave         876 max         375 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:            1.5 ave           4 max           0 min
Histogram: 2 0 0 0 0 1 0 0 0 1
Neighs:         331.25 ave         663 max           0 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 1325
Ave neighs/atom = 0.53
Neighbor list builds = 164
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 99

#variable lat0 equal 1                    #
variable lat1 equal 3+(100*0.01)+(v_ind*0.01)  # .491+(v_ind*0.001)       # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 500*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.99                                                               
Lattice spacing in x,y,z = 4.99 4.99 4.99

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -3742.5 ${n1e1} -100 100 -100 100 units box
region box block -3742.5 3742.5 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -3742.5 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -3742.5 3742.5 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-3742.5 -100 -100) to (3742.5 100 100)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 1500 atoms
  using lattice units in orthogonal box = (-3742.5 -100 -100) to (3742.5 100 100)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 1500 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 1001 atoms
  using lattice units in orthogonal box = (-3742.5 -100 -100) to (3742.5 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  1500 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  1500 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  1001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  1001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
1500 atoms in group substrate
group slider1 region slider1
1001 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 1001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_99_*.dump id type diameter mass xu yu zu fx fy fz

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 4830 130 130
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 97.13 | 97.16 | 97.19 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   7485           200            200            0              0              0              0              0              0              0              1.1965779e-13  0              6            
    100000   7485           200            200            0.0027058964   4.6039105e-41  0              0.0081176893   581648.19      0              5.6171419e+10  1.1965779e-13  0              3.3292771    
    200000   7485           200            200            0.00093647102 -4.3168486e-35  0              0.002809413    136611.48      0              1.3192959e+10  1.1965779e-13  0              3.0790857    
    300000   7485           200            200            2.8483006e-05  2.022046e-39   0              8.5449019e-05  272.74031      0              26339307       1.1965779e-13  0              3.0452087    
    400000   7485           200            200            8.3738744e-05  2.1584411e-34  0              0.00025121623  2230.524       0              2.1540804e+08  1.1965779e-13  0              3.004329     
    500000   7485           200            200            0.010858159    0.018095731    0              0.014478747    1273.6194      0              1.2299704e+08  1.1965779e-13  0              2.9937394    
    600000   7485           200            200            0.0050606214   0.0080844092   0              0.0070974548   78.486384      0              7579653.2      1.1965779e-13  0              2.9956672    
    700000   7485           200            200            0.0066875833   0.010371609    0              0.0096911407   26.014259      0              2512271        1.1965779e-13  0              2.9949089    
    800000   7485           200            200            0.0069565337   0.010326124    0              0.010543477    0.069890343    0              6749.5091      1.1965779e-13  0              2.9946956    
    900000   7485           200            200            0.0067289658   0.010253232    0              0.0099336658   0.40864736     0              39464.237      1.1965779e-13  0              2.9948529    
   1000000   7485           200            200            0.0067385572   0.01025778     0              0.0099578918   0.027942609    0              2698.4971      1.1965779e-13  0              2.9948455    
   1100000   7485           200            200            0.0067687221   0.010271604    0              0.010034562    0.0027406204   0              264.6695       1.1965779e-13  0              2.9948257    
   1200000   7485           200            200            0.0067612974   0.010268128    0              0.010015764    0.0011010409   0              106.33065      1.1965779e-13  0              2.9948307    
   1300000   7485           200            200            0.0067587377   0.010266976    0              0.010009237    1.074207e-07   0              0.010373922    1.1965779e-13  0              2.9948324    
   1400000   7485           200            200            0.0067602583   0.010267679    0              0.010013096    2.0622412e-05  0              1.991565       1.1965779e-13  0              2.9948314    
   1500000   7485           200            200            0.0067602952   0.010267692    0              0.010013194    7.6889241e-07  0              0.074254126    1.1965779e-13  0              2.9948314    
   1600000   7485           200            200            0.0067600826   0.010267595    0              0.010012653    1.8885066e-07  0              0.018237845    1.1965779e-13  0              2.9948315    
   1700000   7485           200            200            0.0067601208   0.010267613    0              0.01001275     4.2598596e-08  0              0.0041138675   1.1965779e-13  0              2.9948315    
   1800000   7485           200            200            0.0067601417   0.010267622    0              0.010012803    2.8034586e-10  0              2.7073797e-05  1.1965779e-13  0              2.9948315    
   1900000   7485           200            200            0.0067601323   0.010267618    0              0.010012779    9.7527934e-10  0              9.4185498e-05  1.1965779e-13  0              2.9948315    
   2000000   7485           200            200            0.0067601314   0.010267617    0              0.010012777    1.6615266e-11  0              1.6045834e-06  1.1965779e-13  0              2.9948315    
   2100000   7485           200            200            0.0067601329   0.010267618    0              0.010012781    1.145461e-11   0              1.1062043e-06  1.1965779e-13  0              2.9948315    
   2200000   7485           200            200            0.0067601327   0.010267618    0              0.01001278     1.5284549e-12  0              1.4760723e-07  1.1965779e-13  0              2.9948315    
   2300000   7485           200            200            0.0067601325   0.010267618    0              0.01001278     4.2607417e-14  0              4.1147193e-09  1.1965779e-13  0              2.9948315    
   2400000   7485           200            200            0.0067601326   0.010267618    0              0.01001278     4.3458458e-14  0              4.1969068e-09  1.1965779e-13  0              2.9948315    
   2500000   7485           200            200            0.0067601326   0.010267618    0              0.01001278     1.9293193e-16  0              1.8631985e-11  1.1965779e-13  0              2.9948315    
   2600000   7485           200            200            0.0067601326   0.010267618    0              0.01001278     6.3627302e-16  0              6.1446694e-11  1.1965779e-13  0              2.9948315    
   2700000   7485           200            200            0.0067601326   0.010267618    0              0.01001278     3.6341916e-17  0              3.5096421e-12  1.1965779e-13  0              2.9948315    
   2800000   7485           200            200            0.0067601326   0.010267618    0              0.01001278     7.6802023e-18  0              7.4169896e-13  1.1965779e-13  0              2.9948315    
   2900000   7485           200            200            0.0067601326   0.010267618    0              0.01001278     3.7485692e-18  0              3.6200999e-13  1.1965779e-13  0              2.9948315    
   3000000   7485           200            200            0.0067601326   0.010267618    0              0.01001278     4.4089185e-18  0              4.257818e-13   1.1965779e-13  0              2.9948315    
Loop time of 294.599 on 4 procs for 3000000 steps with 2501 atoms

Performance: 8798403.378 ns/day, 0.000 hours/ns, 10183.337 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 10.809     | 36.97      | 63.644     | 426.1 | 12.55
Neigh   | 4.5747     | 4.6486     | 4.7232     |   3.0 |  1.58
Comm    | 19.244     | 38.467     | 77.835     | 371.4 | 13.06
Output  | 0.27278    | 0.27311    | 0.27343    |   0.1 |  0.09
Modify  | 109.2      | 157.84     | 176.71     | 225.0 | 53.58
Other   |            | 56.4       |            |       | 19.14

Nlocal:         625.25 ave         876 max         375 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:           1.75 ave           3 max           1 min
Histogram: 2 0 0 0 0 1 0 0 0 1
Neighs:         328.75 ave         658 max           0 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 1315
Ave neighs/atom = 0.52578968
Neighbor list builds = 164
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop
Total wall time: 8:16:05

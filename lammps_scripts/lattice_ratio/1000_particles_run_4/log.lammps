LAMMPS (23 Jun 2022 - Update 1)
  using 1 OpenMP thread(s) per MPI task
variable num index 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99

label startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 0

#variable lat0 equal 1                    #
variable lat1 equal 3+(300*0.01)+(v_ind*0.01)  # .491+(v_ind*0.001)       # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 500*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 6                                                               
Lattice spacing in x,y,z = 6 6 6

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -4500 ${n1e1} -100 100 -100 100 units box
region box block -4500 4500 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -4500 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -4500 4500 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-4500 -100 -100) to (4500 100 100)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 1500 atoms
  using lattice units in orthogonal box = (-4500 -100 -100) to (4500 100 100)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 1500 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 1001 atoms
  using lattice units in orthogonal box = (-4500 -100 -100) to (4500 100 100)
  create_atoms CPU = 0.002 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  1500 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  1500 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  1001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  1001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
1500 atoms in group substrate
group slider1 region slider1
1001 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 1001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_0_*.dump id type diameter mass xu yu zu fx fy fz

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 5807 130 130
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 114.2 | 114.2 | 114.2 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   9000           200            200            0              0              0              0              0              0              0              1.1965779e-13  0              6            
    100000   9000           200            200            0.0022948165   8.9755333e-36  0              0.0068844495   598584.56      0              5.7807012e+10  1.1965779e-13  0              3.3183368    
    200000   9000           200            200            0.00088220172 -5.3852715e-35  0              0.0026466051   165767.85      0              1.6008672e+10  1.1965779e-13  0              3.0576515    
    300000   9000           200            200            0.00020595447 -1.2565654e-34  0              0.0006178634   15829.63       0              1.5287123e+09  1.1965779e-13  0              3.0391545    
    400000   9000           200            200            7.8362333e-05  5.3853167e-35  0              0.000235087    2776.3876      0              2.6812364e+08  1.1965779e-13  0              3.009441     
    500000   9000           200            200           -5.1416066e-05 -8.9754633e-35  0             -0.0001542482   1527.4951      0              1.4751454e+08  1.1965779e-13  0              3.0004271    
    600000   9000           200            200            0.0012291225   8.9754926e-35  0              0.0036873675   277.59679      0              26808311       1.1965779e-13  0              2.9994287    
    700000   9000           200            200            0.0023737643   3.4538543e-41  0              0.0071212929   47.084909      0              4547123.5      1.1965779e-13  0              2.9991       
    800000   9000           200            200            0.0027542966  -2.6926418e-35  0              0.0082628897   7.2291816      0              698142.62      1.1965779e-13  0              2.9990079    
    900000   9000           200            200            0.0027773975  -2.6926424e-35  0              0.0083321926   0.96830613     0              93512.076      1.1965779e-13  0              2.999003     
   1000000   9000           200            200            0.0027792069  -8.9754649e-36  0              0.0083376208   0.12927723     0              12484.669      1.1965779e-13  0              2.9990027    
   1100000   9000           200            200            0.0027794827   6.7316196e-36  0              0.008338448    0.017257502    0              1666.606       1.1965779e-13  0              2.9990028    
   1200000   9000           200            200            0.0027795686  -1.1219348e-36  0              0.0083387057   0.0023037065   0              222.47549      1.1965779e-13  0              2.9990028    
   1300000   9000           200            200            0.0027796042   9.5364518e-36  0              0.0083388127   0.00030751958  0              29.69804       1.1965779e-13  0              2.9990028    
   1400000   9000           200            200            0.0027796197   6.8881997e-44  0              0.0083388592   4.1050204e-05  0              3.9643349      1.1965779e-13  0              2.9990028    
   1500000   9000           200            200            0.0027796264   6.1706454e-36  0              0.0083388793   5.4796778e-06  0              0.52918806     1.1965779e-13  0              2.9990028    
   1600000   9000           200            200            0.0027796293  -2.2438709e-36  0              0.0083388878   7.3146146e-07  0              0.070639312    1.1965779e-13  0              2.9990028    
   1700000   9000           200            200            0.0027796305   8.9395597e-44  0              0.0083388914   9.7639895e-08  0              0.0094293622   1.1965779e-13  0              2.9990028    
   1800000   9000           200            200            0.0027796309   9.0120936e-44  0              0.0083388928   1.3033366e-08  0              0.0012586692   1.1965779e-13  0              2.9990028    
   1900000   9000           200            200            0.0027796311   2.1877743e-35  0              0.0083388934   1.7397784e-09  0              0.00016801534  1.1965779e-13  0              2.9990028    
   2000000   9000           200            200            0.0027796312  -4.4877419e-36  0              0.0083388936   2.3222794e-10  0              2.2426912e-05  1.1965779e-13  0              2.9990028    
   2100000   9000           200            200            0.0027796312  -5.6096766e-37  0              0.0083388937   3.0994796e-11  0              2.9932555e-06  1.1965779e-13  0              2.9990028    
   2200000   9000           200            200            0.0027796313   5.6096784e-37  0              0.0083388938   4.1372428e-12  0              3.9954529e-07  1.1965779e-13  0              2.9990028    
   2300000   9000           200            200            0.0027796313  -1.1219354e-36  0              0.0083388938   5.520984e-13   0              5.3317712e-08  1.1965779e-13  0              2.9990028    
   2400000   9000           200            200            0.0027796313  -1.1219354e-36  0              0.0083388938   7.3793638e-14  0              7.1264613e-09  1.1965779e-13  0              2.9990028    
   2500000   9000           200            200            0.0027796313   1.6829034e-36  0              0.0083388938   9.8756656e-15  0              9.537211e-10   1.1965779e-13  0              2.9990028    
   2600000   9000           200            200            0.0027796313   1.1219356e-36  0              0.0083388938   1.3128746e-15  0              1.2678803e-10  1.1965779e-13  0              2.9990028    
   2700000   9000           200            200            0.0027796313  -5.6096766e-37  0              0.0083388938   1.7972738e-16  0              1.7356783e-11  1.1965779e-13  0              2.9990028    
   2800000   9000           200            200            0.0027796313  -2.8048387e-36  0              0.0083388938   6.2184266e-18  0              6.0053113e-13  1.1965779e-13  0              2.9990028    
   2900000   9000           200            200            0.0027796313   1.6829033e-36  0              0.0083388938   1.1191834e-19  0              1.0808272e-14  1.1965779e-13  0              2.9990028    
   3000000   9000           200            200            0.0027796313  -6.1706452e-36  0              0.0083388938   2.607073e-18   0              2.5177245e-13  1.1965779e-13  0              2.9990028    
Loop time of 353.833 on 4 procs for 3000000 steps with 2501 atoms

Performance: 7325497.539 ns/day, 0.000 hours/ns, 8478.585 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 11.573     | 60.469     | 110.02     | 625.3 | 17.09
Neigh   | 5.7839     | 5.8937     | 6.0061     |   4.1 |  1.67
Comm    | 22.545     | 52.464     | 123.9      | 572.2 | 14.83
Output  | 0.28294    | 0.28329    | 0.28369    |   0.1 |  0.08
Modify  | 116.52     | 176.49     | 219.25     | 281.0 | 49.88
Other   |            | 58.23      |            |       | 16.46

Nlocal:         625.25 ave         876 max         375 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:           1.75 ave           3 max           1 min
Histogram: 2 0 0 0 0 1 0 0 0 1
Neighs:         375.25 ave         751 max           0 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 1501
Ave neighs/atom = 0.60015994
Neighbor list builds = 172
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 1

#variable lat0 equal 1                    #
variable lat1 equal 3+(300*0.01)+(v_ind*0.01)  # .491+(v_ind*0.001)       # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 500*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 6.01                                                               
Lattice spacing in x,y,z = 6.01 6.01 6.01

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -4507.5 ${n1e1} -100 100 -100 100 units box
region box block -4507.5 4507.5 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -4507.5 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -4507.5 4507.5 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-4507.5 -100 -100) to (4507.5 100 100)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 1500 atoms
  using lattice units in orthogonal box = (-4507.5 -100 -100) to (4507.5 100 100)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 1500 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 1001 atoms
  using lattice units in orthogonal box = (-4507.5 -100 -100) to (4507.5 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  1500 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  1500 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  1001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  1001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
1500 atoms in group substrate
group slider1 region slider1
1001 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 1001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_1_*.dump id type diameter mass xu yu zu fx fy fz

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 5817 130 130
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 114.4 | 114.4 | 114.4 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   9015           200            200            0              0              0              0              0              0              0              1.1965779e-13  0              6            
    100000   9015           200            200            0.0022194946   4.48028e-36    0              0.0066584837   571198.06      0              5.5162221e+10  1.1965779e-13  0              3.3370948    
    200000   9015           200            200            0.00071289517 -1.7921066e-34  0              0.0021386855   119193.44      0              1.151085e+10   1.1965779e-13  0              3.0927309    
    300000   9015           200            200           -6.9997366e-05  5.7347629e-34  0             -0.0002099921   2885.0798      0              2.7862035e+08  1.1965779e-13  0              3.0377769    
    400000   9015           200            200            0.012691976    0.017518319    0              0.020557608    5866.7445      0              5.665682e+08   1.1965779e-13  0              2.9882666    
    500000   9015           200            200            0.0061222612   0.0056943691   0              0.012672414    848.34637      0              81927220       1.1965779e-13  0              2.9909039    
    600000   9015           200            200            0.0030204456   0.0028591733   0              0.0062021635   38.32023       0              3700693.6      1.1965779e-13  0              2.9936217    
    700000   9015           200            200            0.0037126851   0.0035886461   0              0.0075494091   7.1361085      0              689154.28      1.1965779e-13  0              2.9929421    
    800000   9015           200            200            0.0040232466   0.0037413823   0              0.0083283575   3.0546107      0              294992.43      1.1965779e-13  0              2.9925883    
    900000   9015           200            200            0.004055235    0.003746543    0              0.0084191621   0.075817184    0              7321.8809      1.1965779e-13  0              2.9925507    
   1000000   9015           200            200            0.0040274739   0.0037369333   0              0.0083454883   0.017223419    0              1663.3145      1.1965779e-13  0              2.9925841    
   1100000   9015           200            200            0.0040129737   0.0037321426   0              0.0083067784   0.0075349604   0              727.67254      1.1965779e-13  0              2.9926013    
   1200000   9015           200            200            0.0040112025   0.0037316914   0              0.008301916    0.00024449092  0              23.611183      1.1965779e-13  0              2.9926033    
   1300000   9015           200            200            0.0040124503   0.0037320905   0              0.0083052604   3.2546382e-05  0              3.1430966      1.1965779e-13  0              2.9926018    
   1400000   9015           200            200            0.0040131728   0.0037323151   0              0.0083072034   1.853017e-05   0              1.7895112      1.1965779e-13  0              2.9926009    
   1500000   9015           200            200            0.0040132822   0.0037323477   0              0.0083074989   7.8298512e-07  0              0.075615099    1.1965779e-13  0              2.9926008    
   1600000   9015           200            200            0.0040132267   0.0037323299   0              0.0083073502   5.8042288e-08  0              0.0056053088   1.1965779e-13  0              2.9926008    
   1700000   9015           200            200            0.0040131906   0.0037323187   0              0.0083072531   4.4980209e-08  0              0.0043438666   1.1965779e-13  0              2.9926009    
   1800000   9015           200            200            0.0040131842   0.0037323168   0              0.0083072359   2.402833e-09   0              0.00023204841  1.1965779e-13  0              2.9926009    
   1900000   9015           200            200            0.0040131866   0.0037323175   0              0.0083072424   9.5743387e-11  0              9.246211e-06   1.1965779e-13  0              2.9926009    
   2000000   9015           200            200            0.0040131884   0.0037323181   0              0.0083072472   1.0774072e-10  0              1.0404828e-05  1.1965779e-13  0              2.9926009    
   2100000   9015           200            200            0.0040131888   0.0037323182   0              0.0083072481   7.1287423e-12  0              6.8844291e-07  1.1965779e-13  0              2.9926009    
   2200000   9015           200            200            0.0040131887   0.0037323182   0              0.0083072479   1.4022797e-13  0              1.3542213e-08  1.1965779e-13  0              2.9926009    
   2300000   9015           200            200            0.0040131886   0.0037323182   0              0.0083072476   2.5444362e-13  0              2.4572344e-08  1.1965779e-13  0              2.9926009    
   2400000   9015           200            200            0.0040131886   0.0037323181   0              0.0083072476   2.0512408e-14  0              1.9809416e-09  1.1965779e-13  0              2.9926009    
   2500000   9015           200            200            0.0040131886   0.0037323181   0              0.0083072476   2.1426673e-16  0              2.0692347e-11  1.1965779e-13  0              2.9926009    
   2600000   9015           200            200            0.0040131886   0.0037323181   0              0.0083072476   5.7560839e-16  0              5.5588138e-11  1.1965779e-13  0              2.9926009    
   2700000   9015           200            200            0.0040131886   0.0037323181   0              0.0083072476   7.91625e-17    0              7.6449476e-12  1.1965779e-13  0              2.9926009    
   2800000   9015           200            200            0.0040131886   0.0037323181   0              0.0083072476   4.4468863e-19  0              4.2944845e-14  1.1965779e-13  0              2.9926009    
   2900000   9015           200            200            0.0040131886   0.0037323181   0              0.0083072476   7.4327475e-18  0              7.1780155e-13  1.1965779e-13  0              2.9926009    
   3000000   9015           200            200            0.0040131886   0.0037323181   0              0.0083072476   2.2724485e-19  0              2.1945681e-14  1.1965779e-13  0              2.9926009    
Loop time of 300.706 on 4 procs for 3000000 steps with 2501 atoms

Performance: 8619721.363 ns/day, 0.000 hours/ns, 9976.529 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 11.421     | 36.852     | 62.545     | 398.0 | 12.26
Neigh   | 5.5384     | 5.639      | 5.7409     |   3.8 |  1.88
Comm    | 23.787     | 40.73      | 76.276     | 325.3 | 13.54
Output  | 0.27243    | 0.27281    | 0.27321    |   0.1 |  0.09
Modify  | 111.43     | 159.99     | 181.02     | 226.0 | 53.21
Other   |            | 57.22      |            |       | 19.03

Nlocal:         625.25 ave         876 max         375 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:           1.75 ave           3 max           1 min
Histogram: 2 0 0 0 0 1 0 0 0 1
Neighs:         303.25 ave         607 max           0 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 1213
Ave neighs/atom = 0.485006
Neighbor list builds = 164
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 2

#variable lat0 equal 1                    #
variable lat1 equal 3+(300*0.01)+(v_ind*0.01)  # .491+(v_ind*0.001)       # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 500*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 6.02                                                               
Lattice spacing in x,y,z = 6.02 6.02 6.02

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -4515 ${n1e1} -100 100 -100 100 units box
region box block -4515 4515 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -4515 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -4515 4515 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-4515 -100 -100) to (4515 100 100)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 1500 atoms
  using lattice units in orthogonal box = (-4515 -100 -100) to (4515 100 100)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 1500 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 1001 atoms
  using lattice units in orthogonal box = (-4515 -100 -100) to (4515 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  1500 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  1500 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  1001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  1001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
1500 atoms in group substrate
group slider1 region slider1
1001 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 1001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_2_*.dump id type diameter mass xu yu zu fx fy fz

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 5826 130 130
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 114.4 | 114.5 | 114.5 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   9030           200            200            0              0              0              0              0              0              0              1.1965779e-13  0              6            
    100000   9030           200            200            0.0022319611   2.2364174e-35  0              0.0066958832   577402.26      0              5.5761377e+10  1.1965779e-13  0              3.3325534    
    200000   9030           200            200            0.00075059564  1.7891526e-34  0              0.0022517869   129599.13      0              1.2515756e+10  1.1965779e-13  0              3.0846593    
    300000   9030           200            200           -1.4802083e-05  1.7891465e-35  0             -4.4406249e-05  113.84574      0              10994406       1.1965779e-13  0              3.0434225    
    400000   9030           200            200           -2.7112307e-05 -1.7891298e-34  0             -8.1336921e-05  403.54288      0              38971283       1.1965779e-13  0              3.0049062    
    500000   9030           200            200            0.0034720528   0.0019898839   0              0.0084262747   1405.4621      0              1.3572947e+08  1.1965779e-13  0              2.9938603    
    600000   9030           200            200            0.0022358139   0.001088327    0              0.0056191148   11.148152      0              1076608.8      1.1965779e-13  0              2.9950253    
    700000   9030           200            200            0.003511458    0.0015357416   0              0.0089986324   15.030905      0              1451577.2      1.1965779e-13  0              2.9937161    
    800000   9030           200            200            0.0032159858   0.0014918633   0              0.008156094    2.9848019      0              288250.81      1.1965779e-13  0              2.9940094    
    900000   9030           200            200            0.0032655034   0.0014939944   0              0.0083025158   0.45802976     0              44233.236      1.1965779e-13  0              2.9939596    
   1000000   9030           200            200            0.0032687721   0.0014945978   0              0.0083117186   0.056914728    0              5496.4171      1.1965779e-13  0              2.9939549    
   1100000   9030           200            200            0.0032598873   0.001493359    0              0.008286303    0.0056566228   0              546.27614      1.1965779e-13  0              2.9939646    
   1200000   9030           200            200            0.0032656731   0.0014941471   0              0.0083028722   0.00041409222  0              39.990063      1.1965779e-13  0              2.9939585    
   1300000   9030           200            200            0.0032628349   0.0014937654   0              0.0082947394   1.646597e-05   0              1.5901656      1.1965779e-13  0              2.9939615    
   1400000   9030           200            200            0.0032640362   0.001493926    0              0.0082981827   7.7804591e-09  0              0.00075138105  1.1965779e-13  0              2.9939602    
   1500000   9030           200            200            0.0032635804   0.0014938655   0              0.0082968756   2.3612439e-07  0              0.022803203    1.1965779e-13  0              2.9939607    
   1600000   9030           200            200            0.0032637366   0.0014938861   0              0.0082973237   1.2334606e-07  0              0.01191188     1.1965779e-13  0              2.9939605    
   1700000   9030           200            200            0.003263689    0.0014938798   0              0.0082971872   3.2280957e-08  0              0.0031174638   1.1965779e-13  0              2.9939606    
   1800000   9030           200            200            0.0032637012   0.0014938814   0              0.0082972221   6.0948189e-09  0              0.00058859399  1.1965779e-13  0              2.9939606    
   1900000   9030           200            200            0.0032636991   0.0014938812   0              0.0082972161   9.1631302e-10  0              8.8490953e-05  1.1965779e-13  0              2.9939606    
   2000000   9030           200            200            0.0032636989   0.0014938811   0              0.0082972156   1.1243201e-10  0              1.0857879e-05  1.1965779e-13  0              2.9939606    
   2100000   9030           200            200            0.0032636993   0.0014938812   0              0.0082972168   1.102054e-11   0              1.0642848e-06  1.1965779e-13  0              2.9939606    
   2200000   9030           200            200            0.0032636991   0.0014938811   0              0.008297216    7.8712945e-13  0              7.6015328e-08  1.1965779e-13  0              2.9939606    
   2300000   9030           200            200            0.0032636992   0.0014938812   0              0.0082972164   2.9300155e-14  0              2.8295993e-09  1.1965779e-13  0              2.9939606    
   2400000   9030           200            200            0.0032636991   0.0014938812   0              0.0082972162   6.8611812e-19  0              6.6260377e-14  1.1965779e-13  0              2.9939606    
   2500000   9030           200            200            0.0032636991   0.0014938812   0              0.0082972163   5.4368374e-16  0              5.2505084e-11  1.1965779e-13  0              2.9939606    
   2600000   9030           200            200            0.0032636991   0.0014938812   0              0.0082972163   2.6375743e-16  0              2.5471805e-11  1.1965779e-13  0              2.9939606    
   2700000   9030           200            200            0.0032636991   0.0014938812   0              0.0082972163   4.942272e-17   0              4.7728925e-12  1.1965779e-13  0              2.9939606    
   2800000   9030           200            200            0.0032636991   0.0014938812   0              0.0082972163   8.0007622e-18  0              7.7265634e-13  1.1965779e-13  0              2.9939606    
   2900000   9030           200            200            0.0032636991   0.0014938812   0              0.0082972163   3.9827835e-18  0              3.8462872e-13  1.1965779e-13  0              2.9939606    
   3000000   9030           200            200            0.0032636991   0.0014938812   0              0.0082972163   5.2525519e-18  0              5.0725387e-13  1.1965779e-13  0              2.9939606    
Loop time of 301.943 on 4 procs for 3000000 steps with 2501 atoms

Performance: 8584399.642 ns/day, 0.000 hours/ns, 9935.648 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 11.048     | 36.261     | 61.931     | 413.0 | 12.01
Neigh   | 5.6324     | 5.7287     | 5.8264     |   3.7 |  1.90
Comm    | 22.487     | 40.612     | 77.919     | 342.4 | 13.45
Output  | 0.26697    | 0.26729    | 0.26766    |   0.1 |  0.09
Modify  | 113.45     | 161.92     | 182.87     | 223.1 | 53.63
Other   |            | 57.15      |            |       | 18.93

Nlocal:         625.25 ave         876 max         375 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:           1.75 ave           3 max           1 min
Histogram: 2 0 0 0 0 1 0 0 0 1
Neighs:         309.25 ave         619 max           0 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 1237
Ave neighs/atom = 0.49460216
Neighbor list builds = 166
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 3

#variable lat0 equal 1                    #
variable lat1 equal 3+(300*0.01)+(v_ind*0.01)  # .491+(v_ind*0.001)       # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 500*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 6.03                                                               
Lattice spacing in x,y,z = 6.03 6.03 6.03

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -4522.5 ${n1e1} -100 100 -100 100 units box
region box block -4522.5 4522.5 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -4522.5 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -4522.5 4522.5 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-4522.5 -100 -100) to (4522.5 100 100)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 1500 atoms
  using lattice units in orthogonal box = (-4522.5 -100 -100) to (4522.5 100 100)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 1500 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 1001 atoms
  using lattice units in orthogonal box = (-4522.5 -100 -100) to (4522.5 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  1500 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  1500 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  1001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  1001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
1500 atoms in group substrate
group slider1 region slider1
1001 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 1001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_3_*.dump id type diameter mass xu yu zu fx fy fz

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 5836 130 130
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 114.6 | 114.6 | 114.7 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   9045           200            200            0              0              0              0              0              0              0              1.1965779e-13  0              6            
    100000   9045           200            200            0.0022322943   2.2327103e-36  0              0.0066968828   578967.43      0              5.5912531e+10  1.1965779e-13  0              3.3313343    
    200000   9045           200            200            0.00075880488 -3.5722889e-35  0              0.0022764146   132175.53      0              1.2764567e+10  1.1965779e-13  0              3.0826026    
    300000   9045           200            200           -8.4835048e-07  1.7862054e-35  0             -2.5450514e-06  0.32078451     0              30979.072      1.1965779e-13  0              3.0442345    
    400000   9045           200            200            7.1068864e-06  1.4214356e-40  0              2.1320659e-05  26.492282      0              2558435        1.1965779e-13  0              3.0057366    
    500000   9045           200            200            0.00066854976  0.00012405507  0              0.0018815942   129.2957       0              12486454       1.1965779e-13  0              2.9973032    
    600000   9045           200            200            0.003276286    0.0010929937   0              0.0087358644   189.69199      0              18319094       1.1965779e-13  0              2.9940949    
    700000   9045           200            200            0.0034386368   0.00099598918  0              0.0093199212   4.5300452      0              437479.34      1.1965779e-13  0              2.9939192    
    800000   9045           200            200            0.0032158525   0.00094882684  0              0.0086987305   0.010115879    0              976.91922      1.1965779e-13  0              2.9941263    
    900000   9045           200            200            0.0031183922   0.00093363143  0              0.0084215451   0.086234525    0              8327.9132      1.1965779e-13  0              2.9942199    
   1000000   9045           200            200            0.0030844376   0.00093067587  0              0.0083226369   0.033712087    0              3255.672       1.1965779e-13  0              2.9942535    
   1100000   9045           200            200            0.003073951    0.00092979126  0              0.0082920617   0.0073790009   0              712.61109      1.1965779e-13  0              2.9942638    
   1200000   9045           200            200            0.003071338    0.00092957151  0              0.0082844426   0.0011560347   0              111.64155      1.1965779e-13  0              2.9942664    
   1300000   9045           200            200            0.0030709644   0.00092954182  0              0.0082833515   0.00013624309  0              13.157382      1.1965779e-13  0              2.9942667    
   1400000   9045           200            200            0.0030710614   0.00092955125  0              0.0082836329   1.1547656e-05  0              1.11519        1.1965779e-13  0              2.9942666    
   1500000   9045           200            200            0.0030711781   0.0009295617   0              0.0082839727   5.6251294e-07  0              0.054323473    1.1965779e-13  0              2.9942665    
   1600000   9045           200            200            0.0030712449   0.00092956757  0              0.0082841672   2.9858214e-09  0              0.00028834926  1.1965779e-13  0              2.9942664    
   1700000   9045           200            200            0.0030712749   0.00092957019  0              0.0082842544   4.0700721e-09  0              0.00039305843  1.1965779e-13  0              2.9942664    
   1800000   9045           200            200            0.0030712863   0.00092957118  0              0.0082842879   2.6023261e-09  0              0.00025131403  1.1965779e-13  0              2.9942664    
   1900000   9045           200            200            0.0030712902   0.00092957151  0              0.0082842989   6.9117632e-10  0              6.6748862e-05  1.1965779e-13  0              2.9942664    
   2000000   9045           200            200            0.0030712912   0.0009295716   0              0.008284302    1.2326318e-10  0              1.1903875e-05  1.1965779e-13  0              2.9942664    
   2100000   9045           200            200            0.0030712914   0.00092957161  0              0.0082843026   1.6386505e-11  0              1.5824913e-06  1.1965779e-13  0              2.9942664    
   2200000   9045           200            200            0.0030712914   0.00092957161  0              0.0082843026   1.6161755e-12  0              1.5607866e-07  1.1965779e-13  0              2.9942664    
   2300000   9045           200            200            0.0030712914   0.00092957161  0              0.0082843026   1.048813e-13   0              1.0128685e-08  1.1965779e-13  0              2.9942664    
   2400000   9045           200            200            0.0030712914   0.00092957161  0              0.0082843025   2.6022824e-15  0              2.5130981e-10  1.1965779e-13  0              2.9942664    
   2500000   9045           200            200            0.0030712914   0.00092957161  0              0.0082843025   1.1489499e-16  0              1.1095736e-11  1.1965779e-13  0              2.9942664    
   2600000   9045           200            200            0.0030712914   0.00092957161  0              0.0082843025   1.7893994e-16  0              1.7280739e-11  1.1965779e-13  0              2.9942664    
   2700000   9045           200            200            0.0030712914   0.00092957161  0              0.0082843025   4.4900574e-17  0              4.3361761e-12  1.1965779e-13  0              2.9942664    
   2800000   9045           200            200            0.0030712914   0.00092957161  0              0.0082843025   7.0992626e-18  0              6.8559597e-13  1.1965779e-13  0              2.9942664    
   2900000   9045           200            200            0.0030712914   0.00092957161  0              0.0082843025   5.4387045e-18  0              5.2523115e-13  1.1965779e-13  0              2.9942664    
   3000000   9045           200            200            0.0030712914   0.00092957161  0              0.0082843025   1.9756076e-18  0              1.9079004e-13  1.1965779e-13  0              2.9942664    
Loop time of 307.529 on 4 procs for 3000000 steps with 2501 atoms

Performance: 8428481.860 ns/day, 0.000 hours/ns, 9755.187 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 11.348     | 38.015     | 65.726     | 424.6 | 12.36
Neigh   | 5.6127     | 5.7108     | 5.8105     |   3.7 |  1.86
Comm    | 22.912     | 41.83      | 81.285     | 356.4 | 13.60
Output  | 0.27104    | 0.27137    | 0.27173    |   0.1 |  0.09
Modify  | 113        | 163.45     | 185.08     | 230.4 | 53.15
Other   |            | 58.25      |            |       | 18.94

Nlocal:         625.25 ave         876 max         375 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:           1.75 ave           3 max           1 min
Histogram: 2 0 0 0 0 1 0 0 0 1
Neighs:         316.25 ave         633 max           0 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 1265
Ave neighs/atom = 0.50579768
Neighbor list builds = 166
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 4

#variable lat0 equal 1                    #
variable lat1 equal 3+(300*0.01)+(v_ind*0.01)  # .491+(v_ind*0.001)       # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 500*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 6.04                                                               
Lattice spacing in x,y,z = 6.04 6.04 6.04

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -4530 ${n1e1} -100 100 -100 100 units box
region box block -4530 4530 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -4530 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -4530 4530 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-4530 -100 -100) to (4530 100 100)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 1500 atoms
  using lattice units in orthogonal box = (-4530 -100 -100) to (4530 100 100)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 1500 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 1001 atoms
  using lattice units in orthogonal box = (-4530 -100 -100) to (4530 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  1500 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  1500 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  1001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  1001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
1500 atoms in group substrate
group slider1 region slider1
1001 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 1001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_4_*.dump id type diameter mass xu yu zu fx fy fz

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 5846 130 130
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 114.8 | 114.8 | 114.9 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   9060           200            200            0              0              0              0              0              0              0              1.1965779e-13  0              6            
    100000   9060           200            200            0.0022304131  -1.1145048e-36  0              0.0066912394   579673.15      0              5.5980684e+10  1.1965779e-13  0              3.3307835    
    200000   9060           200            200            0.00076182277 -1.7831957e-35  0              0.0022854683   133347.62      0              1.2877759e+10  1.1965779e-13  0              3.0816601    
    300000   9060           200            200            5.5306263e-06 -3.5663798e-35  0              1.6591879e-05  15.8134        0              1527145        1.1965779e-13  0              3.0445341    
    400000   9060           200            200            2.3071443e-05 -5.3495981e-35  0              6.9214328e-05  269.05498      0              25983404       1.1965779e-13  0              3.0056989    
    500000   9060           200            200            0.0018248209   0.00025310214  0              0.0052213605   1230.5758      0              1.188402e+08   1.1965779e-13  0              2.9956132    
    600000   9060           200            200            0.0020054956   0.00046570015  0              0.0055507867   26.136435      0              2524069.9      1.1965779e-13  0              2.9954199    
    700000   9060           200            200            0.0027271329   0.00065086771  0              0.007530531    14.591112      0              1409105.1      1.1965779e-13  0              2.9946743    
    800000   9060           200            200            0.0029825293   0.00069629059  0              0.0082512974   3.5224057      0              340168.73      1.1965779e-13  0              2.9944239    
    900000   9060           200            200            0.0030209072   0.00069879017  0              0.0083639313   0.30540271     0              29493.608      1.1965779e-13  0              2.9943842    
   1000000   9060           200            200            0.0030079693   0.00069804136  0              0.0083258666   0.0032895736   0              317.68347      1.1965779e-13  0              2.9943962    
   1100000   9060           200            200            0.0029955252   0.00069727856  0              0.008289297    0.0017837301   0              172.25989      1.1965779e-13  0              2.9944084    
   1200000   9060           200            200            0.0029902806   0.00069694935  0              0.0082738925   0.00099115624  0              95.718775      1.1965779e-13  0              2.9944136    
   1300000   9060           200            200            0.0029890084   0.00069686772  0              0.0082701576   0.00014431074  0              13.936499      1.1965779e-13  0              2.9944149    
   1400000   9060           200            200            0.002989       0.00069686635  0              0.0082701338   6.3047101e-06  0              0.60886377     1.1965779e-13  0              2.9944149    
   1500000   9060           200            200            0.0029891669   0.0006968766   0              0.0082706242   4.3273634e-08  0              0.0041790578   1.1965779e-13  0              2.9944147    
   1600000   9060           200            200            0.0029892619   0.00069688255  0              0.0082709033   2.0767909e-07  0              0.02005616     1.1965779e-13  0              2.9944146    
   1700000   9060           200            200            0.0029892929   0.00069688452  0              0.0082709941   5.211395e-08   0              0.0050327923   1.1965779e-13  0              2.9944146    
   1800000   9060           200            200            0.0029892975   0.00069688482  0              0.0082710076   4.4809625e-09  0              0.00043273928  1.1965779e-13  0              2.9944146    
   1900000   9060           200            200            0.0029892959   0.00069688472  0              0.0082710029   4.7067671e-11  0              4.5454588e-06  1.1965779e-13  0              2.9944146    
   2000000   9060           200            200            0.0029892943   0.00069688463  0              0.0082709984   2.6732024e-11  0              2.5815875e-06  1.1965779e-13  0              2.9944146    
   2100000   9060           200            200            0.0029892937   0.00069688459  0              0.0082709965   1.4695811e-11  0              1.4192163e-06  1.1965779e-13  0              2.9944146    
   2200000   9060           200            200            0.0029892936   0.00069688458  0              0.0082709961   2.1287012e-12  0              2.0557473e-07  1.1965779e-13  0              2.9944146    
   2300000   9060           200            200            0.0029892936   0.00069688458  0              0.0082709961   9.2353548e-14  0              8.9188446e-09  1.1965779e-13  0              2.9944146    
   2400000   9060           200            200            0.0029892936   0.00069688458  0              0.0082709961   7.1469245e-16  0              6.9019881e-11  1.1965779e-13  0              2.9944146    
   2500000   9060           200            200            0.0029892936   0.00069688458  0              0.0082709962   3.2118876e-15  0              3.1018112e-10  1.1965779e-13  0              2.9944146    
   2600000   9060           200            200            0.0029892936   0.00069688458  0              0.0082709962   7.667631e-16   0              7.4048492e-11  1.1965779e-13  0              2.9944146    
   2700000   9060           200            200            0.0029892936   0.00069688458  0              0.0082709962   4.9698398e-17  0              4.7995155e-12  1.1965779e-13  0              2.9944146    
   2800000   9060           200            200            0.0029892936   0.00069688458  0              0.0082709962   2.5563656e-19  0              2.4687549e-14  1.1965779e-13  0              2.9944146    
   2900000   9060           200            200            0.0029892936   0.00069688458  0              0.0082709962   1.008018e-20   0              9.7347161e-16  1.1965779e-13  0              2.9944146    
   3000000   9060           200            200            0.0029892936   0.00069688458  0              0.0082709962   7.3749989e-18  0              7.1222461e-13  1.1965779e-13  0              2.9944146    
Loop time of 303.864 on 4 procs for 3000000 steps with 2501 atoms

Performance: 8530118.988 ns/day, 0.000 hours/ns, 9872.823 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 11.275     | 38.05      | 66.178     | 428.8 | 12.52
Neigh   | 5.6304     | 5.7265     | 5.8247     |   3.7 |  1.88
Comm    | 22.344     | 42.029     | 82.156     | 362.3 | 13.83
Output  | 0.27139    | 0.27174    | 0.27213    |   0.1 |  0.09
Modify  | 111.69     | 161.01     | 179.8      | 225.5 | 52.99
Other   |            | 56.78      |            |       | 18.69

Nlocal:         625.25 ave         876 max         375 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:           1.75 ave           3 max           1 min
Histogram: 2 0 0 0 0 1 0 0 0 1
Neighs:         318.25 ave         637 max           0 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 1273
Ave neighs/atom = 0.5089964
Neighbor list builds = 166
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 5

#variable lat0 equal 1                    #
variable lat1 equal 3+(300*0.01)+(v_ind*0.01)  # .491+(v_ind*0.001)       # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 500*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 6.05                                                               
Lattice spacing in x,y,z = 6.05 6.05 6.05

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -4537.5 ${n1e1} -100 100 -100 100 units box
region box block -4537.5 4537.5 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -4537.5 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -4537.5 4537.5 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-4537.5 -100 -100) to (4537.5 100 100)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 1500 atoms
  using lattice units in orthogonal box = (-4537.5 -100 -100) to (4537.5 100 100)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 1500 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 1001 atoms
  using lattice units in orthogonal box = (-4537.5 -100 -100) to (4537.5 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  1500 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  1500 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  1001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  1001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
1500 atoms in group substrate
group slider1 region slider1
1001 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 1001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_5_*.dump id type diameter mass xu yu zu fx fy fz

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 5855 130 130
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 115 | 115 | 115 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   9075           200            200            0              0              0              0              0              0              0              1.1965779e-13  0              6            
    100000   9075           200            200            0.0022275965  -8.9012536e-36  0              0.0066827894   580005.63      0              5.6012792e+10  1.1965779e-13  0              3.3305718    
    200000   9075           200            200            0.00076280917  3.1154588e-35  0              0.0022884275   133964.82      0              1.2937363e+10  1.1965779e-13  0              3.081183     
    300000   9075           200            200            9.0921192e-06 -2.2253203e-36  0              2.7276358e-05  42.257608      0              4080937.3      1.1965779e-13  0              3.044687     
    400000   9075           200            200            3.2124695e-05 -1.7802497e-35  0              9.6374084e-05  514.24827      0              49662417       1.1965779e-13  0              3.0055687    
    500000   9075           200            200            0.0034035537   0.00052642891  0              0.0096842321   1435.0042      0              1.3858243e+08  1.1965779e-13  0              2.9940888    
    600000   9075           200            200            0.0029303342   0.00050368065  0              0.008287322    197.91846      0              19113548       1.1965779e-13  0              2.9945086    
    700000   9075           200            200            0.0032784982   0.00057669441  0              0.0092588003   6.8921079      0              665590.45      1.1965779e-13  0              2.9941752    
    800000   9075           200            200            0.0030508457   0.00056239519  0              0.0085901419   1.3050641      0              126033.75      1.1965779e-13  0              2.9943869    
    900000   9075           200            200            0.0029236116   0.00055641784  0              0.0082144171   0.44409164     0              42887.192      1.1965779e-13  0              2.9945122    
   1000000   9075           200            200            0.0029191619   0.000556151    0              0.0082013347   0.00062427015  0              60.287543      1.1965779e-13  0              2.9945174    
   1100000   9075           200            200            0.0029350911   0.00055693426  0              0.0082483391   0.0069368992   0              669.91607      1.1965779e-13  0              2.9945019    
   1200000   9075           200            200            0.0029399573   0.00055717734  0              0.0082626944   0.00065290178  0              63.05258       1.1965779e-13  0              2.994497     
   1300000   9075           200            200            0.0029391016   0.00055713744  0              0.0082601674   1.9670424e-05  0              1.8996287      1.1965779e-13  0              2.9944978    
   1400000   9075           200            200            0.0029382176   0.00055709407  0              0.0082575588   2.1407792e-05  0              2.0674114      1.1965779e-13  0              2.9944987    
   1500000   9075           200            200            0.0029380977   0.00055708791  0              0.0082572053   4.0118701e-07  0              0.03874377     1.1965779e-13  0              2.9944988    
   1600000   9075           200            200            0.0029381851   0.00055709212  0              0.0082574631   2.07477e-07    0              0.020036643    1.1965779e-13  0              2.9944987    
   1700000   9075           200            200            0.0029382245   0.00055709407  0              0.0082575794   4.2718778e-08  0              0.0041254738   1.1965779e-13  0              2.9944987    
   1800000   9075           200            200            0.0029382232   0.00055709402  0              0.0082575756   4.1253249e-11  0              3.9839435e-06  1.1965779e-13  0              2.9944987    
   1900000   9075           200            200            0.0029382175   0.00055709375  0              0.0082575589   8.7549264e-10  0              8.4548813e-05  1.1965779e-13  0              2.9944987    
   2000000   9075           200            200            0.0029382162   0.00055709368  0              0.0082575549   4.9138528e-11  0              4.7454473e-06  1.1965779e-13  0              2.9944987    
   2100000   9075           200            200            0.0029382166   0.0005570937   0              0.0082575561   4.5151544e-12  0              4.3604129e-07  1.1965779e-13  0              2.9944987    
   2200000   9075           200            200            0.0029382169   0.00055709372  0              0.008257557    2.2838196e-12  0              2.2055495e-07  1.1965779e-13  0              2.9944987    
   2300000   9075           200            200            0.0029382169   0.00055709372  0              0.0082575571   1.3211141e-14  0              1.2758375e-09  1.1965779e-13  0              2.9944987    
   2400000   9075           200            200            0.0029382169   0.00055709371  0              0.008257557    2.981714e-14   0              2.879526e-09   1.1965779e-13  0              2.9944987    
   2500000   9075           200            200            0.0029382169   0.00055709371  0              0.0082575569   3.8060554e-15  0              3.6756159e-10  1.1965779e-13  0              2.9944987    
   2600000   9075           200            200            0.0029382169   0.00055709371  0              0.0082575569   3.4689554e-17  0              3.3500688e-12  1.1965779e-13  0              2.9944987    
   2700000   9075           200            200            0.0029382169   0.00055709371  0              0.0082575569   1.0321233e-16  0              9.967508e-12   1.1965779e-13  0              2.9944987    
   2800000   9075           200            200            0.0029382169   0.00055709371  0              0.0082575569   3.5987071e-19  0              3.4753738e-14  1.1965779e-13  0              2.9944987    
   2900000   9075           200            200            0.0029382169   0.00055709371  0              0.0082575569   2.8562568e-18  0              2.7583684e-13  1.1965779e-13  0              2.9944987    
   3000000   9075           200            200            0.0029382169   0.00055709371  0              0.0082575569   2.7694911e-18  0              2.6745763e-13  1.1965779e-13  0              2.9944987    
Loop time of 307.828 on 4 procs for 3000000 steps with 2501 atoms

Performance: 8420294.207 ns/day, 0.000 hours/ns, 9745.711 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 11.616     | 38.38      | 67.11      | 432.1 | 12.47
Neigh   | 5.7062     | 5.8084     | 5.9121     |   3.8 |  1.89
Comm    | 21.825     | 44.014     | 86.013     | 373.3 | 14.30
Output  | 0.27306    | 0.27343    | 0.27384    |   0.1 |  0.09
Modify  | 110.91     | 162.05     | 180.88     | 232.6 | 52.64
Other   |            | 57.3       |            |       | 18.62

Nlocal:         625.25 ave         876 max         375 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:           1.75 ave           3 max           1 min
Histogram: 2 0 0 0 0 1 0 0 0 1
Neighs:         316.25 ave         633 max           0 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 1265
Ave neighs/atom = 0.50579768
Neighbor list builds = 166
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 6

#variable lat0 equal 1                    #
variable lat1 equal 3+(300*0.01)+(v_ind*0.01)  # .491+(v_ind*0.001)       # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 500*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 6.06                                                               
Lattice spacing in x,y,z = 6.06 6.06 6.06

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -4545 ${n1e1} -100 100 -100 100 units box
region box block -4545 4545 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -4545 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -4545 4545 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-4545 -100 -100) to (4545 100 100)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 1500 atoms
  using lattice units in orthogonal box = (-4545 -100 -100) to (4545 100 100)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 1500 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 1001 atoms
  using lattice units in orthogonal box = (-4545 -100 -100) to (4545 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  1500 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  1500 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  1001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  1001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
1500 atoms in group substrate
group slider1 region slider1
1001 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 1001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_6_*.dump id type diameter mass xu yu zu fx fy fz

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 5865 130 130
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 115.2 | 115.2 | 115.2 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   9090           200            200            0              0              0              0              0              0              0              1.1965779e-13  0              6            
    100000   9090           200            200            0.0022196025   4.6369601e-40  0              0.0066588076   578355.19      0              5.5853404e+10  1.1965779e-13  0              3.3316078    
    200000   9090           200            200            0.00075148145  3.5546605e-35  0              0.0022544443   131209.56      0              1.267128e+10   1.1965779e-13  0              3.0830933    
    300000   9090           200            200           -6.8418959e-06 -1.7772964e-35  0             -2.0525688e-05  24.055915      0              2323148.1      1.1965779e-13  0              3.0436908    
    400000   9090           200            200           -1.1982647e-05 -2.2216524e-36  0             -3.5947941e-05  77.039281      0              7439902.4      1.1965779e-13  0              3.0052996    
    500000   9090           200            200            0.0015803806   0.0003012778   0              0.0044398638   1026.6492      0              99146433       1.1965779e-13  0              2.9955233    
    600000   9090           200            200            0.0022862857   0.0003693632   0              0.0064894939   115.16502      0              11121813       1.1965779e-13  0              2.9946395    
    700000   9090           200            200            0.0026380635   4.3150174e-05  0              0.0078710402   22.927888      0              2214211.3      1.1965779e-13  0              2.9940725    
    800000   9090           200            200            0.0028525021  -7.5820188e-05  0              0.0086333265   0.20640738     0              19933.348      1.1965779e-13  0              2.9938103    
    900000   9090           200            200            0.0027544199  -1.6340716e-05  0              0.0082796004   0.43457299     0              41967.949      1.1965779e-13  0              2.9939348    
   1000000   9090           200            200            0.0027263089  -1.159333e-05   0              0.00819052     0.004211093    0              406.67722      1.1965779e-13  0              2.9939653    
   1100000   9090           200            200            0.0027408525  -1.4228168e-05  0              0.0082367858   0.0077739137   0              750.74894      1.1965779e-13  0              2.9939488    
   1200000   9090           200            200            0.002744823   -1.4891325e-05  0              0.0082493603   9.4532236e-05  0              9.1292467      1.1965779e-13  0              2.9939445    
   1300000   9090           200            200            0.0027428962  -1.4556524e-05  0              0.0082432452   0.00013901747  0              13.425312      1.1965779e-13  0              2.9939466    
   1400000   9090           200            200            0.00274234    -1.4463358e-05  0              0.0082414834   2.0742199e-06  0              0.20031331     1.1965779e-13  0              2.9939472    
   1500000   9090           200            200            0.0027425938  -1.4507745e-05  0              0.008242289    2.4802682e-06  0              0.23952655     1.1965779e-13  0              2.993947     
   1600000   9090           200            200            0.0027426716  -1.4520799e-05  0              0.0082425355   4.4733068e-08  0              0.0043199995   1.1965779e-13  0              2.9939469    
   1700000   9090           200            200            0.0027426382  -1.4514957e-05  0              0.0082424295   4.4166105e-08  0              0.0042652463   1.1965779e-13  0              2.9939469    
   1800000   9090           200            200            0.0027426273  -1.4513132e-05  0              0.0082423951   9.5036603e-10  0              9.1779549e-05  1.1965779e-13  0              2.9939469    
   1900000   9090           200            200            0.0027426317  -1.4513901e-05  0              0.008242409    7.848675e-10   0              7.5796886e-05  1.1965779e-13  0              2.9939469    
   2000000   9090           200            200            0.0027426332  -1.4514155e-05  0              0.0082424138   1.9935292e-11  0              1.9252078e-06  1.1965779e-13  0              2.9939469    
   2100000   9090           200            200            0.0027426326  -1.4514054e-05  0              0.008242412    1.3917319e-11  0              1.344035e-06   1.1965779e-13  0              2.9939469    
   2200000   9090           200            200            0.0027426324  -1.4514019e-05  0              0.0082424113   4.1295359e-13  0              3.9880102e-08  1.1965779e-13  0              2.9939469    
   2300000   9090           200            200            0.0027426325  -1.4514032e-05  0              0.0082424116   2.4638562e-13  0              2.379416e-08   1.1965779e-13  0              2.9939469    
   2400000   9090           200            200            0.0027426325  -1.4514037e-05  0              0.0082424117   8.3773825e-15  0              8.0902764e-10  1.1965779e-13  0              2.9939469    
   2500000   9090           200            200            0.0027426325  -1.4514035e-05  0              0.0082424116   4.3702968e-15  0              4.2205198e-10  1.1965779e-13  0              2.9939469    
   2600000   9090           200            200            0.0027426325  -1.4514034e-05  0              0.0082424116   1.6747079e-16  0              1.617313e-11   1.1965779e-13  0              2.9939469    
   2700000   9090           200            200            0.0027426325  -1.4514035e-05  0              0.0082424116   6.6685809e-17  0              6.4400381e-12  1.1965779e-13  0              2.9939469    
   2800000   9090           200            200            0.0027426325  -1.4514035e-05  0              0.0082424116   4.8803794e-18  0              4.7131211e-13  1.1965779e-13  0              2.9939469    
   2900000   9090           200            200            0.0027426325  -1.4514035e-05  0              0.0082424116   4.2903571e-18  0              4.1433198e-13  1.1965779e-13  0              2.9939469    
   3000000   9090           200            200            0.0027426325  -1.4514038e-05  0              0.0082424116   1.8278375e-19  0              1.7651946e-14  1.1965779e-13  0              2.9939469    
Loop time of 307.467 on 4 procs for 3000000 steps with 2501 atoms

Performance: 8430184.306 ns/day, 0.000 hours/ns, 9757.158 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 11.853     | 38.323     | 65.188     | 422.7 | 12.46
Neigh   | 5.6552     | 5.7586     | 5.8641     |   3.9 |  1.87
Comm    | 21.344     | 42.318     | 82.005     | 360.3 | 13.76
Output  | 0.27087    | 0.27122    | 0.27168    |   0.1 |  0.09
Modify  | 113.23     | 162.84     | 182.21     | 225.9 | 52.96
Other   |            | 57.96      |            |       | 18.85

Nlocal:         625.25 ave         876 max         375 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:           1.75 ave           3 max           1 min
Histogram: 2 0 0 0 0 1 0 0 0 1
Neighs:         316.25 ave         633 max           0 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 1265
Ave neighs/atom = 0.50579768
Neighbor list builds = 166
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 7

#variable lat0 equal 1                    #
variable lat1 equal 3+(300*0.01)+(v_ind*0.01)  # .491+(v_ind*0.001)       # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 500*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 6.07                                                               
Lattice spacing in x,y,z = 6.07 6.07 6.07

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -4552.5 ${n1e1} -100 100 -100 100 units box
region box block -4552.5 4552.5 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -4552.5 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -4552.5 4552.5 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-4552.5 -100 -100) to (4552.5 100 100)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 1500 atoms
  using lattice units in orthogonal box = (-4552.5 -100 -100) to (4552.5 100 100)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 1500 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 1001 atoms
  using lattice units in orthogonal box = (-4552.5 -100 -100) to (4552.5 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  1500 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  1500 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  1001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  1001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
1500 atoms in group substrate
group slider1 region slider1
1001 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 1001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_7_*.dump id type diameter mass xu yu zu fx fy fz

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 5875 130 130
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 115.3 | 115.3 | 115.3 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   9105           200            200            0              0              0              0              0              0              0              1.1965779e-13  0              6            
    100000   9105           200            200            0.0022153659   5.5449909e-37  0              0.0066460977   578101.13      0              5.582887e+10   1.1965779e-13  0              3.3320089    
    200000   9105           200            200            0.00074860464 -1.7743686e-35  0              0.0022458139   130747.09      0              1.2626618e+10  1.1965779e-13  0              3.0837444    
    300000   9105           200            200           -8.547526e-06   4.4360119e-36  0             -2.5642578e-05  37.916301      0              3661685        1.1965779e-13  0              3.0438098    
    400000   9105           200            200           -1.1878647e-05  6.1361514e-40  0             -3.563594e-05   75.932996      0              7333065.2      1.1965779e-13  0              3.0054345    
    500000   9105           200            200            0.0011888602   0.0007270689   0              0.0028395118   571.64272      0              55205163       1.1965779e-13  0              2.9964853    
    600000   9105           200            200            0.0032065605   0.00052183615  0              0.0090978452   176.93409      0              17087028       1.1965779e-13  0              2.9938092    
    700000   9105           200            200            0.0027110167   0.00085191082  0              0.0072811392   5.4453734      0              525875.18      1.1965779e-13  0              2.994439     
    800000   9105           200            200            0.0031372133   0.00080484826  0              0.0086067915   0.35061102     0              33859.502      1.1965779e-13  0              2.9939581    
    900000   9105           200            200            0.0029838772   0.00078798242  0              0.0081636492   0.3653601      0              35283.863      1.1965779e-13  0              2.9941173    
   1000000   9105           200            200            0.0030003551   0.00078831812  0              0.0082127473   0.056887617    0              5493.7988      1.1965779e-13  0              2.9940985    
   1100000   9105           200            200            0.0030117322   0.00078852774  0              0.0082466689   0.001866701    0              180.27263      1.1965779e-13  0              2.9940867    
   1200000   9105           200            200            0.003003569    0.00078837266  0              0.0082223343   9.2058123e-05  0              8.8903146      1.1965779e-13  0              2.9940954    
   1300000   9105           200            200            0.0030063058   0.00078842545  0              0.0082304918   0.00011765885  0              11.36265       1.1965779e-13  0              2.9940924    
   1400000   9105           200            200            0.0030059752   0.00078841872  0              0.0082295068   1.9179174e-05  0              1.8521873      1.1965779e-13  0              2.9940928    
   1500000   9105           200            200            0.0030057788   0.00078841511  0              0.0082289214   6.8469055e-07  0              0.066122513    1.1965779e-13  0              2.994093     
   1600000   9105           200            200            0.0030059262   0.00078841791  0              0.0082293606   2.4962859e-08  0              0.0024107342   1.1965779e-13  0              2.9940929    
   1700000   9105           200            200            0.0030058756   0.00078841693  0              0.0082292098   3.7746745e-08  0              0.0036453104   1.1965779e-13  0              2.9940929    
   1800000   9105           200            200            0.0030058822   0.00078841707  0              0.0082292294   6.4505846e-09  0              0.00062295129  1.1965779e-13  0              2.9940929    
   1900000   9105           200            200            0.0030058855   0.00078841713  0              0.0082292395   2.4968707e-10  0              2.411299e-05   1.1965779e-13  0              2.9940929    
   2000000   9105           200            200            0.0030058829   0.00078841708  0              0.0082292316   6.6032306e-12  0              6.3769275e-07  1.1965779e-13  0              2.9940929    
   2100000   9105           200            200            0.0030058838   0.0007884171   0              0.0082292344   1.2084352e-11  0              1.1670202e-06  1.1965779e-13  0              2.9940929    
   2200000   9105           200            200            0.0030058837   0.00078841709  0              0.008229234    2.1662635e-12  0              2.0920222e-07  1.1965779e-13  0              2.9940929    
   2300000   9105           200            200            0.0030058836   0.00078841709  0              0.0082292338   9.0641444e-14  0              8.7535019e-09  1.1965779e-13  0              2.9940929    
   2400000   9105           200            200            0.0030058837   0.00078841709  0              0.008229234    1.6108769e-15  0              1.5556696e-10  1.1965779e-13  0              2.9940929    
   2500000   9105           200            200            0.0030058837   0.00078841709  0              0.0082292339   3.8643573e-15  0              3.7319197e-10  1.1965779e-13  0              2.9940929    
   2600000   9105           200            200            0.0030058837   0.00078841709  0              0.0082292339   7.194102e-16   0              6.9475488e-11  1.1965779e-13  0              2.9940929    
   2700000   9105           200            200            0.0030058837   0.00078841709  0              0.0082292339   1.7504828e-17  0              1.690491e-12   1.1965779e-13  0              2.9940929    
   2800000   9105           200            200            0.0030058837   0.00078841709  0              0.0082292339   1.9245844e-18  0              1.8586259e-13  1.1965779e-13  0              2.9940929    
   2900000   9105           200            200            0.0030058837   0.00078841709  0              0.0082292339   2.9650798e-18  0              2.8634619e-13  1.1965779e-13  0              2.9940929    
   3000000   9105           200            200            0.0030058837   0.00078841709  0              0.0082292339   7.6750243e-18  0              7.4119891e-13  1.1965779e-13  0              2.9940929    
Loop time of 302.16 on 4 procs for 3000000 steps with 2501 atoms

Performance: 8578242.232 ns/day, 0.000 hours/ns, 9928.521 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 11.278     | 37.015     | 63.276     | 419.6 | 12.25
Neigh   | 5.6503     | 5.7469     | 5.8449     |   3.6 |  1.90
Comm    | 22.01      | 40.721     | 79.367     | 354.2 | 13.48
Output  | 0.27032    | 0.27064    | 0.27102    |   0.1 |  0.09
Modify  | 112.34     | 161.34     | 181.31     | 225.3 | 53.40
Other   |            | 57.06      |            |       | 18.88

Nlocal:         625.25 ave         876 max         375 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:           1.75 ave           3 max           1 min
Histogram: 2 0 0 0 0 1 0 0 0 1
Neighs:         312.25 ave         625 max           0 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 1249
Ave neighs/atom = 0.49940024
Neighbor list builds = 166
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 8

#variable lat0 equal 1                    #
variable lat1 equal 3+(300*0.01)+(v_ind*0.01)  # .491+(v_ind*0.001)       # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 500*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 6.08                                                               
Lattice spacing in x,y,z = 6.08 6.08 6.08

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -4560 ${n1e1} -100 100 -100 100 units box
region box block -4560 4560 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -4560 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -4560 4560 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-4560 -100 -100) to (4560 100 100)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 1500 atoms
  using lattice units in orthogonal box = (-4560 -100 -100) to (4560 100 100)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 1500 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 1001 atoms
  using lattice units in orthogonal box = (-4560 -100 -100) to (4560 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  1500 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  1500 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  1001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  1001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
1500 atoms in group substrate
group slider1 region slider1
1001 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 1001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_8_*.dump id type diameter mass xu yu zu fx fy fz

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 5884 130 130
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 115.5 | 115.5 | 115.5 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   9120           200            200            0              0              0              0              0              0              0              1.1965779e-13  0              6            
    100000   9120           200            200            0.0022129854   1.7714825e-35  0              0.0066389561   578595.17      0              5.587658e+10   1.1965779e-13  0              3.3316248    
    200000   9120           200            200            0.00075035779 -1.1071729e-35  0              0.0022510734   131567.8       0              1.2705876e+10  1.1965779e-13  0              3.0830864    
    300000   9120           200            200           -4.121877e-06   6.2442686e-40  0             -1.2365631e-05  8.6469659      0              835062.08      1.1965779e-13  0              3.04406      
    400000   9120           200            200           -1.0076069e-06 -3.5429052e-35  0             -3.0228206e-06  0.48394475     0              46735.92       1.1965779e-13  0              3.0056541    
    500000   9120           200            200            0.00057633485  5.1991287e-05  0              0.0016770133   17.892104      0              1727891.3      1.1965779e-13  0              2.9973612    
    600000   9120           200            200            0.0038950802   0.00047217731  0              0.011213063    15.377636      0              1485062        1.1965779e-13  0              2.9932084    
    700000   9120           200            200            0.0029297033   0.00035647443  0              0.0084326354   24.880413      0              2402772.2      1.1965779e-13  0              2.9941343    
    800000   9120           200            200            0.0027328625   0.0003606095   0              0.0078379781   0.33322633     0              32180.614      1.1965779e-13  0              2.9943386    
    900000   9120           200            200            0.0028382315   0.00036447813  0              0.0081502164   0.37787032     0              36492.011      1.1965779e-13  0              2.9942255    
   1000000   9120           200            200            0.0028754978   0.00036570333  0              0.00826079     0.019450294    0              1878.3702      1.1965779e-13  0              2.9941871    
   1100000   9120           200            200            0.0028648952   0.00036534373  0              0.008229342    0.0047653053   0              460.19908      1.1965779e-13  0              2.9941985    
   1200000   9120           200            200            0.0028588157   0.00036514322  0              0.0082113039   0.00066272573  0              64.001308      1.1965779e-13  0              2.9942048    
   1300000   9120           200            200            0.0028596336   0.00036517205  0              0.0082137289   4.5151383e-05  0              4.3603973      1.1965779e-13  0              2.9942039    
   1400000   9120           200            200            0.0028605361   0.00036520205  0              0.0082164064   1.7218998e-05  0              1.6628876      1.1965779e-13  0              2.994203     
   1500000   9120           200            200            0.0028605166   0.00036520118  0              0.0082163488   2.3904774e-07  0              0.023085519    1.1965779e-13  0              2.994203     
   1600000   9120           200            200            0.0028603929   0.00036519705  0              0.0082159817   3.7089741e-07  0              0.035818617    1.1965779e-13  0              2.9942031    
   1700000   9120           200            200            0.0028603831   0.00036519675  0              0.0082159526   2.1783541e-11  0              2.1036985e-06  1.1965779e-13  0              2.9942031    
   1800000   9120           200            200            0.0028603988   0.00036519728  0              0.0082159991   6.8277516e-09  0              0.00065937538  1.1965779e-13  0              2.9942031    
   1900000   9120           200            200            0.0028604017   0.00036519737  0              0.0082160078   5.9081968e-11  0              5.7057136e-06  1.1965779e-13  0              2.9942031    
   2000000   9120           200            200            0.0028603999   0.00036519731  0              0.0082160023   1.0761259e-10  0              1.0392454e-05  1.1965779e-13  0              2.9942031    
   2100000   9120           200            200            0.0028603993   0.00036519729  0              0.0082160006   4.3317559e-12  0              4.1832998e-07  1.1965779e-13  0              2.9942031    
   2200000   9120           200            200            0.0028603995   0.0003651973   0              0.0082160012   1.4153288e-12  0              1.3668232e-07  1.1965779e-13  0              2.9942031    
   2300000   9120           200            200            0.0028603996   0.0003651973   0              0.0082160015   1.6058705e-13  0              1.5508348e-08  1.1965779e-13  0              2.9942031    
   2400000   9120           200            200            0.0028603996   0.0003651973   0              0.0082160014   1.4462858e-14  0              1.3967193e-09  1.1965779e-13  0              2.9942031    
   2500000   9120           200            200            0.0028603996   0.0003651973   0              0.0082160014   4.4237461e-15  0              4.2721374e-10  1.1965779e-13  0              2.9942031    
   2600000   9120           200            200            0.0028603996   0.0003651973   0              0.0082160014   8.927681e-17   0              8.6217153e-12  1.1965779e-13  0              2.9942031    
   2700000   9120           200            200            0.0028603996   0.0003651973   0              0.0082160014   9.9512847e-17  0              9.6102385e-12  1.1965779e-13  0              2.9942031    
   2800000   9120           200            200            0.0028603996   0.0003651973   0              0.0082160014   1.7349601e-19  0              1.6755002e-14  1.1965779e-13  0              2.9942031    
   2900000   9120           200            200            0.0028603996   0.0003651973   0              0.0082160014   5.3011604e-18  0              5.1194812e-13  1.1965779e-13  0              2.9942031    
   3000000   9120           200            200            0.0028603996   0.0003651973   0              0.0082160014   1.5094285e-20  0              1.457698e-15   1.1965779e-13  0              2.9942031    
Loop time of 305.345 on 4 procs for 3000000 steps with 2501 atoms

Performance: 8488771.504 ns/day, 0.000 hours/ns, 9824.967 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 11.271     | 37.065     | 64.141     | 419.9 | 12.14
Neigh   | 5.666      | 5.7635     | 5.8623     |   3.7 |  1.89
Comm    | 22.032     | 41.304     | 80.382     | 356.1 | 13.53
Output  | 0.28382    | 0.28415    | 0.28454    |   0.1 |  0.09
Modify  | 112.48     | 162.78     | 183.77     | 230.8 | 53.31
Other   |            | 58.14      |            |       | 19.04

Nlocal:         625.25 ave         876 max         375 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:           1.75 ave           3 max           1 min
Histogram: 2 0 0 0 0 1 0 0 0 1
Neighs:         313.25 ave         627 max           0 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 1253
Ave neighs/atom = 0.5009996
Neighbor list builds = 166
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 9

#variable lat0 equal 1                    #
variable lat1 equal 3+(300*0.01)+(v_ind*0.01)  # .491+(v_ind*0.001)       # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 500*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 6.09                                                               
Lattice spacing in x,y,z = 6.09 6.09 6.09

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -4567.5 ${n1e1} -100 100 -100 100 units box
region box block -4567.5 4567.5 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -4567.5 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -4567.5 4567.5 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-4567.5 -100 -100) to (4567.5 100 100)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 1500 atoms
  using lattice units in orthogonal box = (-4567.5 -100 -100) to (4567.5 100 100)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 1500 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 1001 atoms
  using lattice units in orthogonal box = (-4567.5 -100 -100) to (4567.5 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  1500 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  1500 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  1001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  1001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
1500 atoms in group substrate
group slider1 region slider1
1001 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 1001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_9_*.dump id type diameter mass xu yu zu fx fy fz

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 5894 130 130
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 115.6 | 115.7 | 115.7 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   9135           200            200            0              0              0              0              0              0              0              1.1965779e-13  0              6            
    100000   9135           200            200            0.0022103012   6.4110607e-35  0              0.0066309037   578967.43      0              5.5912531e+10  1.1965779e-13  0              3.3313343    
    200000   9135           200            200            0.00075132897 -1.326425e-35   0              0.0022539869   132175.53      0              1.2764567e+10  1.1965779e-13  0              3.0826026    
    300000   9135           200            200           -8.3999235e-07  9.4949922e-40  0             -2.5199771e-06  0.32078452     0              30979.072      1.1965779e-13  0              3.0442345    
    400000   9135           200            200            7.0368678e-06  3.5371881e-35  0              2.1110603e-05  26.492282      0              2558435        1.1965779e-13  0              3.0057366    
    500000   9135           200            200            0.00083021016  0.00062757414  0              0.0018630563   129.2957       0              12486454       1.1965779e-13  0              2.9973032    
    600000   9135           200            200            0.0033384788   0.0013656397   0              0.0086497967   189.69199      0              18319094       1.1965779e-13  0              2.9940949    
    700000   9135           200            200            0.0034577544   0.0011451638   0              0.0092280994   4.5300452      0              437479.34      1.1965779e-13  0              2.9939192    
    800000   9135           200            200            0.0032226639   0.0010549629   0              0.0086130287   0.010115879    0              976.91922      1.1965779e-13  0              2.9941263    
    900000   9135           200            200            0.0031260096   0.0010394547   0              0.0083385742   0.086234525    0              8327.9132      1.1965779e-13  0              2.9942199    
   1000000   9135           200            200            0.0030917199   0.0010345191   0              0.0082406405   0.033712087    0              3255.672       1.1965779e-13  0              2.9942535    
   1100000   9135           200            200            0.0030811175   0.0010329859   0              0.0082103665   0.0073790009   0              712.61109      1.1965779e-13  0              2.9942638    
   1200000   9135           200            200            0.0030784764   0.0010326068   0              0.0082028224   0.0011560347   0              111.64155      1.1965779e-13  0              2.9942664    
   1300000   9135           200            200            0.0030780992   0.0010325556   0              0.0082017421   0.00013624309  0              13.157382      1.1965779e-13  0              2.9942667    
   1400000   9135           200            200            0.0030781976   0.0010325719   0              0.0082020208   1.1547657e-05  0              1.11519        1.1965779e-13  0              2.9942666    
   1500000   9135           200            200            0.0030783157   0.0010325899   0              0.0082023572   5.6251287e-07  0              0.054323467    1.1965779e-13  0              2.9942665    
   1600000   9135           200            200            0.0030783833   0.0010326      0              0.0082025498   2.9858247e-09  0              0.00028834958  1.1965779e-13  0              2.9942664    
   1700000   9135           200            200            0.0030784136   0.0010326045   0              0.0082026362   4.0700587e-09  0              0.00039305714  1.1965779e-13  0              2.9942664    
   1800000   9135           200            200            0.0030784252   0.0010326062   0              0.0082026693   2.6023232e-09  0              0.00025131375  1.1965779e-13  0              2.9942664    
   1900000   9135           200            200            0.003078429    0.0010326068   0              0.0082026802   6.9117751e-10  0              6.6748976e-05  1.1965779e-13  0              2.9942664    
   2000000   9135           200            200            0.0030784301   0.001032607    0              0.0082026833   1.2326271e-10  0              1.190383e-05   1.1965779e-13  0              2.9942664    
   2100000   9135           200            200            0.0030784303   0.001032607    0              0.0082026839   1.6387437e-11  0              1.5825814e-06  1.1965779e-13  0              2.9942664    
   2200000   9135           200            200            0.0030784303   0.001032607    0              0.0082026839   1.6163264e-12  0              1.5609324e-07  1.1965779e-13  0              2.9942664    
   2300000   9135           200            200            0.0030784303   0.001032607    0              0.0082026838   1.0496787e-13  0              1.0137046e-08  1.1965779e-13  0              2.9942664    
   2400000   9135           200            200            0.0030784303   0.001032607    0              0.0082026838   2.5991786e-15  0              2.5101006e-10  1.1965779e-13  0              2.9942664    
   2500000   9135           200            200            0.0030784302   0.001032607    0              0.0082026837   1.0513694e-16  0              1.0153374e-11  1.1965779e-13  0              2.9942664    
   2600000   9135           200            200            0.0030784302   0.001032607    0              0.0082026837   1.7529603e-16  0              1.6928836e-11  1.1965779e-13  0              2.9942664    
   2700000   9135           200            200            0.0030784302   0.001032607    0              0.0082026837   4.4786952e-17  0              4.3252032e-12  1.1965779e-13  0              2.9942664    
   2800000   9135           200            200            0.0030784302   0.001032607    0              0.0082026837   6.9684556e-18  0              6.7296356e-13  1.1965779e-13  0              2.9942664    
   2900000   9135           200            200            0.0030784302   0.001032607    0              0.0082026837   6.276867e-18   0              6.0617489e-13  1.1965779e-13  0              2.9942664    
   3000000   9135           200            200            0.0030784302   0.001032607    0              0.0082026837   1.0747992e-18  0              1.0379642e-13  1.1965779e-13  0              2.9942664    
Loop time of 303.235 on 4 procs for 3000000 steps with 2501 atoms

Performance: 8547815.543 ns/day, 0.000 hours/ns, 9893.305 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 11.59      | 37.454     | 65.158     | 421.2 | 12.35
Neigh   | 5.7237     | 5.8254     | 5.9273     |   3.9 |  1.92
Comm    | 22.067     | 41.933     | 81.604     | 359.3 | 13.83
Output  | 0.27226    | 0.27261    | 0.27302    |   0.1 |  0.09
Modify  | 111.35     | 160.86     | 180.51     | 227.1 | 53.05
Other   |            | 56.89      |            |       | 18.76

Nlocal:         625.25 ave         876 max         375 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:           1.75 ave           3 max           1 min
Histogram: 2 0 0 0 0 1 0 0 0 1
Neighs:         316.25 ave         633 max           0 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 1265
Ave neighs/atom = 0.50579768
Neighbor list builds = 166
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 10

#variable lat0 equal 1                    #
variable lat1 equal 3+(300*0.01)+(v_ind*0.01)  # .491+(v_ind*0.001)       # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 500*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 6.1                                                               
Lattice spacing in x,y,z = 6.1 6.1 6.1

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -4575 ${n1e1} -100 100 -100 100 units box
region box block -4575 4575 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -4575 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -4575 4575 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-4575 -100 -100) to (4575 100 100)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 1500 atoms
  using lattice units in orthogonal box = (-4575 -100 -100) to (4575 100 100)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 1500 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 1001 atoms
  using lattice units in orthogonal box = (-4575 -100 -100) to (4575 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  1500 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  1500 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  1001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  1001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
1500 atoms in group substrate
group slider1 region slider1
1001 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 1001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_10_*.dump id type diameter mass xu yu zu fx fy fz

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 5904 130 130
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 115.8 | 115.8 | 115.8 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   9150           200            200            0              0              0              0              0              0              0              1.1965779e-13  0              6            
    100000   9150           200            200            0.0022074449   2.3595306e-40  0              0.0066223347   579271.08      0              5.5941855e+10  1.1965779e-13  0              3.3310797    
    200000   9150           200            200            0.00075182687  3.8147144e-41  0              0.0022554806   132654.34      0              1.2810806e+10  1.1965779e-13  0              3.0822138    
    300000   9150           200            200            1.9022784e-06  1.8571997e-40  0              5.7068351e-06  1.994366       0              192601.6       1.1965779e-13  0              3.0443575    
    400000   9150           200            200            1.4940266e-05  2.334478e-40   0              4.4820798e-05  117.067        0              11305493       1.1965779e-13  0              3.0057309    
    500000   9150           200            200            0.00088442648  4.635072e-05   0              0.0026069287   491.66656      0              47481637       1.1965779e-13  0              2.9968815    
    600000   9150           200            200            0.0036930422   0.0002889244   0              0.010790202    43.184277      0              4170428.4      1.1965779e-13  0              2.9934249    
    700000   9150           200            200            0.0029473927   0.00027965445  0              0.0085625237   21.978422      0              2122518.7      1.1965779e-13  0              2.9941996    
    800000   9150           200            200            0.0026956896   0.00027473989  0              0.0078123288   0.12586146     0              12154.799      1.1965779e-13  0              2.9944878    
    900000   9150           200            200            0.0028229914   0.00027725081  0              0.0081917233   0.46080627     0              44501.371      1.1965779e-13  0              2.9943458    
   1000000   9150           200            200            0.0028392724   0.00027757898  0              0.0082402381   0.0027665621   0              267.17476      1.1965779e-13  0              2.9943265    
   1100000   9150           200            200            0.0028195823   0.00027720588  0              0.008181541    0.0070131287   0              677.27777      1.1965779e-13  0              2.9943484    
   1200000   9150           200            200            0.0028203344   0.00027721752  0              0.0081837856   0.00038354051  0              37.039597      1.1965779e-13  0              2.9943478    
   1300000   9150           200            200            0.0028228775   0.00027726638  0              0.0081913661   7.0216824e-05  0              6.7810383      1.1965779e-13  0              2.9943449    
   1400000   9150           200            200            0.0028223968   0.00027725753  0              0.0081899329   1.5153693e-05  0              1.4634352      1.1965779e-13  0              2.9943454    
   1500000   9150           200            200            0.0028221253   0.00027725226  0              0.0081891238   3.0241455e-07  0              0.029205032    1.1965779e-13  0              2.9943457    
   1600000   9150           200            200            0.0028222307   0.00027725424  0              0.0081894379   3.6880613e-07  0              0.035616656    1.1965779e-13  0              2.9943456    
   1700000   9150           200            200            0.0028222516   0.00027725466  0              0.0081895002   2.6868229e-10  0              2.5947412e-05  1.1965779e-13  0              2.9943456    
   1800000   9150           200            200            0.0028222343   0.00027725433  0              0.0081894485   6.3200083e-09  0              0.00061034116  1.1965779e-13  0              2.9943456    
   1900000   9150           200            200            0.002822234    0.00027725432  0              0.0081894478   1.9799701e-10  0              1.9121134e-05  1.1965779e-13  0              2.9943456    
   2000000   9150           200            200            0.0028222364   0.00027725437  0              0.0081894549   7.4445653e-11  0              7.1894283e-06  1.1965779e-13  0              2.9943456    
   2100000   9150           200            200            0.0028222361   0.00027725436  0              0.0081894539   1.0147091e-11  0              9.7993346e-07  1.1965779e-13  0              2.9943456    
   2200000   9150           200            200            0.0028222358   0.00027725436  0              0.0081894531   4.7523647e-13  0              4.5894936e-08  1.1965779e-13  0              2.9943456    
   2300000   9150           200            200            0.0028222359   0.00027725436  0              0.0081894534   2.8363564e-13  0              2.73915e-08    1.1965779e-13  0              2.9943456    
   2400000   9150           200            200            0.0028222359   0.00027725436  0              0.0081894534   1.7697205e-16  0              1.7090694e-11  1.1965779e-13  0              2.9943456    
   2500000   9150           200            200            0.0028222359   0.00027725436  0              0.0081894534   5.4624011e-15  0              5.275196e-10   1.1965779e-13  0              2.9943456    
   2600000   9150           200            200            0.0028222359   0.00027725436  0              0.0081894534   8.7787435e-17  0              8.4778821e-12  1.1965779e-13  0              2.9943456    
   2700000   9150           200            200            0.0028222359   0.00027725436  0              0.0081894534   5.5295187e-17  0              5.3400134e-12  1.1965779e-13  0              2.9943456    
   2800000   9150           200            200            0.0028222359   0.00027725436  0              0.0081894534   8.6772446e-18  0              8.3798618e-13  1.1965779e-13  0              2.9943456    
   2900000   9150           200            200            0.0028222359   0.00027725436  0              0.0081894534   1.6216726e-19  0              1.5660954e-14  1.1965779e-13  0              2.9943456    
   3000000   9150           200            200            0.0028222359   0.00027725436  0              0.0081894534   1.5173159e-19  0              1.4653151e-14  1.1965779e-13  0              2.9943456    
Loop time of 304.933 on 4 procs for 3000000 steps with 2501 atoms

Performance: 8500220.402 ns/day, 0.000 hours/ns, 9838.218 timesteps/s
99.9% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 11.39      | 36.145     | 61.833     | 411.1 | 11.85
Neigh   | 5.7086     | 5.8118     | 5.9164     |   3.9 |  1.91
Comm    | 22.476     | 43.919     | 82.466     | 345.1 | 14.40
Output  | 0.28022    | 0.28055    | 0.28091    |   0.1 |  0.09
Modify  | 111.66     | 161.05     | 180.24     | 226.2 | 52.81
Other   |            | 57.73      |            |       | 18.93

Nlocal:         625.25 ave         876 max         375 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:           1.75 ave           3 max           1 min
Histogram: 2 0 0 0 0 1 0 0 0 1
Neighs:         313.25 ave         627 max           0 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 1253
Ave neighs/atom = 0.5009996
Neighbor list builds = 166
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 11

#variable lat0 equal 1                    #
variable lat1 equal 3+(300*0.01)+(v_ind*0.01)  # .491+(v_ind*0.001)       # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 500*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 6.11                                                               
Lattice spacing in x,y,z = 6.11 6.11 6.11

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -4582.5 ${n1e1} -100 100 -100 100 units box
region box block -4582.5 4582.5 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -4582.5 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -4582.5 4582.5 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-4582.5 -100 -100) to (4582.5 100 100)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 1500 atoms
  using lattice units in orthogonal box = (-4582.5 -100 -100) to (4582.5 100 100)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 1500 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 1001 atoms
  using lattice units in orthogonal box = (-4582.5 -100 -100) to (4582.5 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  1500 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  1500 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  1001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  1001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
1500 atoms in group substrate
group slider1 region slider1
1001 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 1001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_11_*.dump id type diameter mass xu yu zu fx fy fz

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 5913 130 130
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 116 | 116 | 116 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   9165           200            200            0              0              0              0              0              0              0              1.1965779e-13  0              6            
    100000   9165           200            200            0.002202413    1.0576711e-34  0              0.0066072389   578709.9       0              5.588766e+10   1.1965779e-13  0              3.3315398    
    200000   9165           200            200            0.00074732912  2.442809e-40   0              0.0022419874   131748.72      0              1.2723349e+10  1.1965779e-13  0              3.0829512    
    300000   9165           200            200           -3.1244199e-06 -3.5255228e-35  0             -9.3732598e-06  4.9650561      0              479489.58      1.1965779e-13  0              3.044121     
    400000   9165           200            200            1.4310568e-06 -4.4069381e-35  0              4.2931704e-06  1.183197       0              114264.7       1.1965779e-13  0              3.0056924    
    500000   9165           200            200            0.00023479086 -0.00093854057  0              0.0016429131   0.29633547     0              28617.959      1.1965779e-13  0              2.9974143    
    600000   9165           200            200            0.0020309901  -0.0046134695   0              0.01070644     64.980769      0              6275377.6      1.1965779e-13  0              2.9933808    
    700000   9165           200            200            0.0018770576  -0.0032571818   0              0.0088883545   15.403983      0              1487606.4      1.1965779e-13  0              2.993986     
    800000   9165           200            200            0.0016274011  -0.0030935521   0              0.0079757552   2.5778389      0              248949.23      1.1965779e-13  0              2.9943005    
    900000   9165           200            200            0.0016401036  -0.0031100279   0              0.0080303388   0.010228997    0              987.84332      1.1965779e-13  0              2.9942786    
   1000000   9165           200            200            0.0016790056  -0.0031255102   0              0.008162527    0.059703356    0              5765.7228      1.1965779e-13  0              2.9942315    
   1100000   9165           200            200            0.0016877111  -0.0031286263   0              0.0081917596   0.0028949807   0              279.57651      1.1965779e-13  0              2.9942215    
   1200000   9165           200            200            0.0016848028  -0.0031275233   0              0.0081819318   0.00032782018  0              31.658527      1.1965779e-13  0              2.9942251    
   1300000   9165           200            200            0.0016828272  -0.0031267975   0              0.0081752792   0.00015032243  0              14.517064      1.1965779e-13  0              2.9942274    
   1400000   9165           200            200            0.0016826733  -0.0031267463   0              0.0081747661   8.9667032e-07  0              0.086594001    1.1965779e-13  0              2.9942276    
   1500000   9165           200            200            0.0016828971  -0.0031268303   0              0.0081755216   1.9384224e-06  0              0.18719896     1.1965779e-13  0              2.9942273    
   1600000   9165           200            200            0.0016829798  -0.0031268604   0              0.0081757997   2.6277556e-07  0              0.025376983    1.1965779e-13  0              2.9942272    
   1700000   9165           200            200            0.0016829724  -0.0031268574   0              0.0081757746   2.127491e-09   0              0.00020545785  1.1965779e-13  0              2.9942272    
   1800000   9165           200            200            0.0016829592  -0.0031268525   0              0.0081757302   6.708422e-09   0              0.00064785138  1.1965779e-13  0              2.9942272    
   1900000   9165           200            200            0.0016829566  -0.0031268516   0              0.0081757213   2.6955897e-10  0              2.6032076e-05  1.1965779e-13  0              2.9942272    
   2000000   9165           200            200            0.0016829576  -0.003126852    0              0.0081757248   4.239561e-11   0              4.0942646e-06  1.1965779e-13  0              2.9942272    
   2100000   9165           200            200            0.0016829583  -0.0031268522   0              0.008175727    1.6114738e-11  0              1.5562461e-06  1.1965779e-13  0              2.9942272    
   2200000   9165           200            200            0.0016829583  -0.0031268522   0              0.0081757271   5.3233484e-14  0              5.1409089e-09  1.1965779e-13  0              2.9942272    
   2300000   9165           200            200            0.0016829582  -0.0031268522   0              0.0081757269   2.2797482e-13  0              2.2016176e-08  1.1965779e-13  0              2.9942272    
   2400000   9165           200            200            0.0016829582  -0.0031268522   0              0.0081757268   2.6726826e-14  0              2.5810856e-09  1.1965779e-13  0              2.9942272    
   2500000   9165           200            200            0.0016829582  -0.0031268522   0              0.0081757268   3.8430533e-16  0              3.7113458e-11  1.1965779e-13  0              2.9942272    
   2600000   9165           200            200            0.0016829582  -0.0031268522   0              0.0081757268   7.4787261e-16  0              7.2224184e-11  1.1965779e-13  0              2.9942272    
   2700000   9165           200            200            0.0016829582  -0.0031268522   0              0.0081757268   3.4387418e-17  0              3.3208907e-12  1.1965779e-13  0              2.9942272    
   2800000   9165           200            200            0.0016829582  -0.0031268522   0              0.0081757268   8.8888418e-19  0              8.5842072e-14  1.1965779e-13  0              2.9942272    
   2900000   9165           200            200            0.0016829582  -0.0031268522   0              0.0081757268   3.1562823e-18  0              3.0481115e-13  1.1965779e-13  0              2.9942272    
   3000000   9165           200            200            0.0016829582  -0.0031268522   0              0.0081757268   6.4682556e-18  0              6.2465783e-13  1.1965779e-13  0              2.9942272    
Loop time of 303.929 on 4 procs for 3000000 steps with 2501 atoms

Performance: 8528296.279 ns/day, 0.000 hours/ns, 9870.713 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 11.407     | 37.028     | 63.058     | 419.8 | 12.18
Neigh   | 5.6613     | 5.758      | 5.8574     |   3.6 |  1.89
Comm    | 21.886     | 42.434     | 81.883     | 356.6 | 13.96
Output  | 0.26939    | 0.26973    | 0.27013    |   0.1 |  0.09
Modify  | 112.06     | 161.48     | 181.21     | 226.0 | 53.13
Other   |            | 56.96      |            |       | 18.74

Nlocal:         625.25 ave         876 max         375 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:           1.75 ave           3 max           1 min
Histogram: 2 0 0 0 0 1 0 0 0 1
Neighs:         314.25 ave         629 max           0 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 1257
Ave neighs/atom = 0.50259896
Neighbor list builds = 166
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 12

#variable lat0 equal 1                    #
variable lat1 equal 3+(300*0.01)+(v_ind*0.01)  # .491+(v_ind*0.001)       # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 500*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 6.12                                                               
Lattice spacing in x,y,z = 6.12 6.12 6.12

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -4590 ${n1e1} -100 100 -100 100 units box
region box block -4590 4590 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -4590 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -4590 4590 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-4590 -100 -100) to (4590 100 100)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 1500 atoms
  using lattice units in orthogonal box = (-4590 -100 -100) to (4590 100 100)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 1500 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 1001 atoms
  using lattice units in orthogonal box = (-4590 -100 -100) to (4590 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  1500 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  1500 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  1001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  1001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
1500 atoms in group substrate
group slider1 region slider1
1001 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 1001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_12_*.dump id type diameter mass xu yu zu fx fy fz

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 5923 130 130
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 116.2 | 116.2 | 116.2 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   9180           200            200            0              0              0              0              0              0              0              1.1965779e-13  0              6            
    100000   9180           200            200            0.0021976099   9.4553709e-41  0              0.0065928296   578239.89      0              5.584227e+10   1.1965779e-13  0              3.3318746    
    200000   9180           200            200            0.0007433752  -1.7598719e-35  0              0.0022301256   130993.66      0              1.265043e+10   1.1965779e-13  0              3.0835178    
    300000   9180           200            200           -7.4030936e-06  1.7599044e-34  0             -2.2209281e-05  28.796433      0              2780953.4      1.1965779e-13  0              3.0438717    
    400000   9180           200            200           -9.318575e-06   8.7995373e-36  0             -2.7955725e-05  47.149124      0              4553324.9      1.1965779e-13  0              3.0054868    
    500000   9180           200            200            0.0008739657   6.7691904e-05  0              0.0025542052   580.58937      0              56069166       1.1965779e-13  0              2.996556     
    600000   9180           200            200            0.0038691219   0.00035294858  0              0.011254417    0.21034807     0              20313.911      1.1965779e-13  0              2.9931932    
    700000   9180           200            200            0.0029203393   0.00030134919  0              0.0084596686   24.013731      0              2319074.3      1.1965779e-13  0              2.9941266    
    800000   9180           200            200            0.0027141117   0.00029657096  0              0.007845764    1.2527003      0              120976.83      1.1965779e-13  0              2.9943382    
    900000   9180           200            200            0.0027780013   0.00029821676  0              0.0080357872   0.12458181     0              12031.22       1.1965779e-13  0              2.9942683    
   1000000   9180           200            200            0.0028232186   0.00029929706  0              0.0081703588   0.061753686    0              5963.729       1.1965779e-13  0              2.9942207    
   1100000   9180           200            200            0.0028270155   0.00029937903  0              0.0081816675   0.00042529473  0              41.07192       1.1965779e-13  0              2.9942171    
   1200000   9180           200            200            0.0028219473   0.00029925806  0              0.008166584    0.00077562865  0              74.904663      1.1965779e-13  0              2.9942225    
   1300000   9180           200            200            0.0028200436   0.00029921366  0              0.008160917    0.00010904071  0              10.530371      1.1965779e-13  0              2.9942244    
   1400000   9180           200            200            0.0028202033   0.00029921781  0              0.0081613921   7.817284e-07   0              0.075493734    1.1965779e-13  0              2.9942243    
   1500000   9180           200            200            0.0028205041   0.00029922494  0              0.0081622874   2.7290524e-06  0              0.26355235     1.1965779e-13  0              2.9942239    
   1600000   9180           200            200            0.0028205653   0.00029922634  0              0.0081624695   1.1234899e-07  0              0.010849861    1.1965779e-13  0              2.9942239    
   1700000   9180           200            200            0.0028205416   0.00029922576  0              0.0081623989   1.7070284e-08  0              0.0016485259   1.1965779e-13  0              2.9942239    
   1800000   9180           200            200            0.0028205268   0.00029922542  0              0.0081623549   6.5870977e-09  0              0.00063613474  1.1965779e-13  0              2.9942239    
   1900000   9180           200            200            0.0028205259   0.0002992254   0              0.0081623523   2.2107595e-11  0              2.1349933e-06  1.1965779e-13  0              2.9942239    
   2000000   9180           200            200            0.0028205277   0.00029922544  0              0.0081623575   9.3225545e-11  0              9.0030559e-06  1.1965779e-13  0              2.9942239    
   2100000   9180           200            200            0.0028205283   0.00029922546  0              0.0081623593   1.0828723e-11  0              1.0457605e-06  1.1965779e-13  0              2.9942239    
   2200000   9180           200            200            0.0028205282   0.00029922545  0              0.0081623591   1.5799047e-13  0              1.5257589e-08  1.1965779e-13  0              2.9942239    
   2300000   9180           200            200            0.0028205281   0.00029922545  0              0.0081623588   3.0600166e-13  0              2.955145e-08   1.1965779e-13  0              2.9942239    
   2400000   9180           200            200            0.0028205281   0.00029922545  0              0.0081623588   9.73854e-15    0              9.4047849e-10  1.1965779e-13  0              2.9942239    
   2500000   9180           200            200            0.0028205281   0.00029922545  0              0.0081623588   2.3181609e-15  0              2.2387138e-10  1.1965779e-13  0              2.9942239    
   2600000   9180           200            200            0.0028205281   0.00029922545  0              0.0081623588   6.7273823e-16  0              6.4968243e-11  1.1965779e-13  0              2.9942239    
   2700000   9180           200            200            0.0028205281   0.00029922545  0              0.0081623588   2.6479127e-18  0              2.5571646e-13  1.1965779e-13  0              2.9942239    
   2800000   9180           200            200            0.0028205281   0.00029922545  0              0.0081623588   5.9476427e-18  0              5.7438076e-13  1.1965779e-13  0              2.9942239    
   2900000   9180           200            200            0.0028205281   0.00029922545  0              0.0081623588   2.8951652e-18  0              2.7959433e-13  1.1965779e-13  0              2.9942239    
   3000000   9180           200            200            0.0028205281   0.00029922545  0              0.0081623588   5.5023428e-18  0              5.3137688e-13  1.1965779e-13  0              2.9942239    
Loop time of 300.458 on 4 procs for 3000000 steps with 2501 atoms

Performance: 8626833.032 ns/day, 0.000 hours/ns, 9984.760 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 11.524     | 36.365     | 62.049     | 408.7 | 12.10
Neigh   | 5.7794     | 5.8759     | 5.9726     |   3.6 |  1.96
Comm    | 22.623     | 40.874     | 78.193     | 341.6 | 13.60
Output  | 0.27203    | 0.27236    | 0.27275    |   0.1 |  0.09
Modify  | 111.15     | 159.84     | 180.95     | 225.8 | 53.20
Other   |            | 57.23      |            |       | 19.05

Nlocal:         625.25 ave         876 max         375 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:           1.75 ave           3 max           1 min
Histogram: 2 0 0 0 0 1 0 0 0 1
Neighs:         312.75 ave         626 max           0 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 1251
Ave neighs/atom = 0.50019992
Neighbor list builds = 166
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 13

#variable lat0 equal 1                    #
variable lat1 equal 3+(300*0.01)+(v_ind*0.01)  # .491+(v_ind*0.001)       # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 500*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 6.13                                                               
Lattice spacing in x,y,z = 6.13 6.13 6.13

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -4597.5 ${n1e1} -100 100 -100 100 units box
region box block -4597.5 4597.5 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -4597.5 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -4597.5 4597.5 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-4597.5 -100 -100) to (4597.5 100 100)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 1500 atoms
  using lattice units in orthogonal box = (-4597.5 -100 -100) to (4597.5 100 100)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 1500 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 1001 atoms
  using lattice units in orthogonal box = (-4597.5 -100 -100) to (4597.5 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  1500 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  1500 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  1001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  1001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
1500 atoms in group substrate
group slider1 region slider1
1001 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 1001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_13_*.dump id type diameter mass xu yu zu fx fy fz

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 5933 130 130
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 116.4 | 116.4 | 116.4 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   9195           200            200            0              0              0              0              0              0              0              1.1965779e-13  0              6            
    100000   9195           200            200            0.0021947213  -4.3925536e-36  0              0.006584164    578511.16      0              5.5868467e+10  1.1965779e-13  0              3.3316885    
    200000   9195           200            200            0.00074370349  7.7503944e-41  0              0.0022311105   131419.52      0              1.2691557e+10  1.1965779e-13  0              3.083208     
    300000   9195           200            200           -5.0434233e-06  8.7852387e-36  0             -1.513027e-05   13.252704      0              1279851.3      1.1965779e-13  0              3.0440168    
    400000   9195           200            200           -1.9919911e-06  2.4756194e-41  0             -5.9759734e-06  2.0388636      0              196898.85      1.1965779e-13  0              3.0056275    
    500000   9195           200            200            0.00063307053  4.684988e-05   0              0.0018523617   105.41612      0              10180334       1.1965779e-13  0              2.9972269    
    600000   9195           200            200            0.0029862395  -0.0012200005   0              0.010178719    108.73701      0              10501042       1.1965779e-13  0              2.993485     
    700000   9195           200            200            0.0015773556  -0.0024006072   0              0.0071326739   1.7138726      0              165513.55      1.1965779e-13  0              2.9945425    
    800000   9195           200            200            0.0021519583  -0.0020592372   0              0.0085151121   0.46847424     0              45241.889      1.1965779e-13  0              2.9940312    
    900000   9195           200            200            0.0019991428  -0.0020787767   0              0.008076205    0.34165667     0              32994.755      1.1965779e-13  0              2.994191     
   1000000   9195           200            200            0.002021181   -0.0020779862   0              0.0081415291   0.061515048    0              5940.6831      1.1965779e-13  0              2.994166     
   1100000   9195           200            200            0.0020283576  -0.0020778154   0              0.0081628881   0.0041473885   0              400.52509      1.1965779e-13  0              2.9941587    
   1200000   9195           200            200            0.0020212595  -0.0020779929   0              0.0081417713   1.3904041e-05  0              1.3427527      1.1965779e-13  0              2.9941663    
   1300000   9195           200            200            0.0020243957  -0.0020779098   0              0.0081510969   4.26671e-05    0              4.1204832      1.1965779e-13  0              2.9941629    
   1400000   9195           200            200            0.0020235418  -0.0020779322   0              0.0081485577   1.8290625e-05  0              1.7663776      1.1965779e-13  0              2.9941639    
   1500000   9195           200            200            0.0020236121  -0.0020779302   0              0.0081487663   2.5268428e-06  0              0.24402439     1.1965779e-13  0              2.9941638    
   1600000   9195           200            200            0.0020236867  -0.0020779283   0              0.0081489884   1.1653113e-07  0              0.011253743    1.1965779e-13  0              2.9941637    
   1700000   9195           200            200            0.0020236341  -0.0020779297   0              0.0081488319   2.9738824e-10  0              2.8719627e-05  1.1965779e-13  0              2.9941638    
   1800000   9195           200            200            0.0020236544  -0.0020779291   0              0.0081488924   3.1380601e-09  0              0.00030305138  1.1965779e-13  0              2.9941637    
   1900000   9195           200            200            0.0020236498  -0.0020779293   0              0.0081488786   9.0224743e-10  0              8.7132599e-05  1.1965779e-13  0              2.9941637    
   2000000   9195           200            200            0.0020236497  -0.0020779293   0              0.0081488784   9.5954633e-11  0              9.2666117e-06  1.1965779e-13  0              2.9941637    
   2100000   9195           200            200            0.0020236504  -0.0020779292   0              0.0081488803   2.5831273e-12  0              2.4945994e-07  1.1965779e-13  0              2.9941637    
   2200000   9195           200            200            0.00202365    -0.0020779293   0              0.0081488792   1.5443718e-13  0              1.4914437e-08  1.1965779e-13  0              2.9941637    
   2300000   9195           200            200            0.0020236501  -0.0020779293   0              0.0081488796   1.9689497e-13  0              1.9014707e-08  1.1965779e-13  0              2.9941637    
   2400000   9195           200            200            0.0020236501  -0.0020779293   0              0.0081488795   4.1397694e-14  0              3.997893e-09   1.1965779e-13  0              2.9941637    
   2500000   9195           200            200            0.0020236501  -0.0020779293   0              0.0081488795   3.3021231e-15  0              3.1889542e-10  1.1965779e-13  0              2.9941637    
   2600000   9195           200            200            0.0020236501  -0.0020779293   0              0.0081488796   3.6369718e-17  0              3.512327e-12   1.1965779e-13  0              2.9941637    
   2700000   9195           200            200            0.0020236501  -0.0020779293   0              0.0081488795   3.0160521e-17  0              2.9126872e-12  1.1965779e-13  0              2.9941637    
   2800000   9195           200            200            0.0020236501  -0.0020779293   0              0.0081488795   1.3521729e-17  0              1.3058318e-12  1.1965779e-13  0              2.9941637    
   2900000   9195           200            200            0.0020236501  -0.0020779293   0              0.0081488795   2.8956302e-18  0              2.7963923e-13  1.1965779e-13  0              2.9941637    
   3000000   9195           200            200            0.0020236501  -0.0020779293   0              0.0081488795   7.9426545e-22  0              7.6704472e-17  1.1965779e-13  0              2.9941637    
Loop time of 305.323 on 4 procs for 3000000 steps with 2501 atoms

Performance: 8489370.239 ns/day, 0.000 hours/ns, 9825.660 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 11.471     | 36.646     | 64.114     | 416.3 | 12.00
Neigh   | 5.7506     | 5.8546     | 5.9601     |   3.9 |  1.92
Comm    | 22.044     | 41.907     | 80.869     | 353.7 | 13.73
Output  | 0.27393    | 0.27426    | 0.27464    |   0.1 |  0.09
Modify  | 113.45     | 163.23     | 183.91     | 227.5 | 53.46
Other   |            | 57.41      |            |       | 18.80

Nlocal:         625.25 ave         876 max         375 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:           1.75 ave           3 max           1 min
Histogram: 2 0 0 0 0 1 0 0 0 1
Neighs:         313.25 ave         627 max           0 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 1253
Ave neighs/atom = 0.5009996
Neighbor list builds = 166
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 14

#variable lat0 equal 1                    #
variable lat1 equal 3+(300*0.01)+(v_ind*0.01)  # .491+(v_ind*0.001)       # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 500*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 6.14                                                               
Lattice spacing in x,y,z = 6.14 6.14 6.14

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -4605 ${n1e1} -100 100 -100 100 units box
region box block -4605 4605 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -4605 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -4605 4605 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-4605 -100 -100) to (4605 100 100)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 1500 atoms
  using lattice units in orthogonal box = (-4605 -100 -100) to (4605 100 100)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 1500 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 1001 atoms
  using lattice units in orthogonal box = (-4605 -100 -100) to (4605 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  1500 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  1500 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  1001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  1001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
1500 atoms in group substrate
group slider1 region slider1
1001 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 1001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_14_*.dump id type diameter mass xu yu zu fx fy fz

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 5942 130 130
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 116.5 | 116.5 | 116.5 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   9210           200            200            0              0              0              0              0              0              0              1.1965779e-13  0              6            
    100000   9210           200            200            0.0021917714  -4.385404e-36   0              0.0065753141   578757.85      0              5.589229e+10   1.1965779e-13  0              3.3314967    
    200000   9210           200            200            0.00074397136 -8.7708132e-36  0              0.0022319141   131830.77      0              1.2731272e+10  1.1965779e-13  0              3.0828774    
    300000   9210           200            200           -2.697977e-06   3.5083605e-35  0             -8.0939311e-06  3.7151225      0              358779.94      1.1965779e-13  0              3.0441372    
    400000   9210           200            200            2.5466809e-06  3.5083854e-35  0              7.6400428e-06  3.6540735      0              352884.27      1.1965779e-13  0              3.0056977    
    500000   9210           200            200            0.00053885302 -2.5589295e-05  0              0.0016421483   3.8711819      0              373851.04      1.1965779e-13  0              2.9974155    
    600000   9210           200            200            0.0032509828  -0.00089280915  0              0.010645757    66.119347      0              6385333.3      1.1965779e-13  0              2.9933841    
    700000   9210           200            200            0.0024980853  -0.0013574183   0              0.008851674    15.34244       0              1481663.1      1.1965779e-13  0              2.993983     
    800000   9210           200            200            0.0022032271  -0.0013960428   0              0.0080057242   3.0962225      0              299011.01      1.1965779e-13  0              2.9942738    
    900000   9210           200            200            0.0022032103  -0.0013848713   0              0.0079945021   0.030017908    0              2898.9147      1.1965779e-13  0              2.9942754    
   1000000   9210           200            200            0.0022364167  -0.0013854537   0              0.008094704    0.027098695    0              2616.998       1.1965779e-13  0              2.9942394    
   1100000   9210           200            200            0.0022506192  -0.0013859677   0              0.0081378253   0.0084225566   0              813.39023      1.1965779e-13  0              2.9942242    
   1200000   9210           200            200            0.0022520508  -0.0013860189   0              0.0081421713   0.00025246285  0              24.381055      1.1965779e-13  0              2.9942228    
   1300000   9210           200            200            0.002250729   -0.0013859666   0              0.0081381536   3.3425011e-05  0              3.2279483      1.1965779e-13  0              2.9942243    
   1400000   9210           200            200            0.0022499872  -0.0013859382   0              0.0081358998   2.0652959e-05  0              1.9945149      1.1965779e-13  0              2.9942251    
   1500000   9210           200            200            0.0022498574  -0.0013859335   0              0.0081355056   1.2271676e-06  0              0.11851106     1.1965779e-13  0              2.9942252    
   1600000   9210           200            200            0.0022499035  -0.0013859353   0              0.0081356459   2.3388957e-08  0              0.002258738    1.1965779e-13  0              2.9942251    
   1700000   9210           200            200            0.0022499402  -0.0013859367   0              0.0081357573   4.5356084e-08  0              0.004380166    1.1965779e-13  0              2.9942251    
   1800000   9210           200            200            0.0022499492  -0.001385937    0              0.0081357847   4.6008807e-09  0              0.00044432013  1.1965779e-13  0              2.9942251    
   1900000   9210           200            200            0.002249948   -0.001385937    0              0.008135781    3.0898153e-13  0              2.9839224e-08  1.1965779e-13  0              2.9942251    
   2000000   9210           200            200            0.0022499463  -0.0013859369   0              0.0081357758   8.8015697e-11  0              8.499926e-06   1.1965779e-13  0              2.9942251    
   2100000   9210           200            200            0.0022499457  -0.0013859369   0              0.0081357741   1.4601594e-11  0              1.4101174e-06  1.1965779e-13  0              2.9942251    
   2200000   9210           200            200            0.0022499457  -0.0013859369   0              0.0081357742   1.0352982e-13  0              9.9981689e-09  1.1965779e-13  0              2.9942251    
   2300000   9210           200            200            0.0022499458  -0.0013859369   0              0.0081357744   1.4607593e-13  0              1.4106968e-08  1.1965779e-13  0              2.9942251    
   2400000   9210           200            200            0.0022499459  -0.0013859369   0              0.0081357745   4.0797329e-14  0              3.939914e-09   1.1965779e-13  0              2.9942251    
   2500000   9210           200            200            0.0022499459  -0.0013859369   0              0.0081357745   1.1557876e-15  0              1.1161769e-10  1.1965779e-13  0              2.9942251    
   2600000   9210           200            200            0.0022499459  -0.0013859369   0              0.0081357745   1.6988227e-16  0              1.6406014e-11  1.1965779e-13  0              2.9942251    
   2700000   9210           200            200            0.0022499459  -0.0013859369   0              0.0081357745   9.7223642e-17  0              9.3891635e-12  1.1965779e-13  0              2.9942251    
   2800000   9210           200            200            0.0022499459  -0.0013859369   0              0.0081357745   7.8314731e-18  0              7.5630761e-13  1.1965779e-13  0              2.9942251    
   2900000   9210           200            200            0.0022499459  -0.0013859369   0              0.0081357745   1.065425e-18   0              1.0289112e-13  1.1965779e-13  0              2.9942251    
   3000000   9210           200            200            0.0022499459  -0.0013859369   0              0.0081357745   4.4517816e-19  0              4.299212e-14   1.1965779e-13  0              2.9942251    
Loop time of 299.336 on 4 procs for 3000000 steps with 2501 atoms

Performance: 8659169.374 ns/day, 0.000 hours/ns, 10022.187 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 11.083     | 36.16      | 62.662     | 414.8 | 12.08
Neigh   | 5.6994     | 5.8004     | 5.9039     |   3.9 |  1.94
Comm    | 21.845     | 40.993     | 79.219     | 350.1 | 13.69
Output  | 0.2719     | 0.27219    | 0.27251    |   0.1 |  0.09
Modify  | 111.16     | 159.76     | 179.78     | 224.3 | 53.37
Other   |            | 56.35      |            |       | 18.83

Nlocal:         625.25 ave         876 max         375 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:           1.75 ave           3 max           1 min
Histogram: 2 0 0 0 0 1 0 0 0 1
Neighs:         314.75 ave         630 max           0 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 1259
Ave neighs/atom = 0.50339864
Neighbor list builds = 166
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 15

#variable lat0 equal 1                    #
variable lat1 equal 3+(300*0.01)+(v_ind*0.01)  # .491+(v_ind*0.001)       # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 500*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 6.15                                                               
Lattice spacing in x,y,z = 6.15 6.15 6.15

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -4612.5 ${n1e1} -100 100 -100 100 units box
region box block -4612.5 4612.5 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -4612.5 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -4612.5 4612.5 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-4612.5 -100 -100) to (4612.5 100 100)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 1500 atoms
  using lattice units in orthogonal box = (-4612.5 -100 -100) to (4612.5 100 100)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 1500 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 1001 atoms
  using lattice units in orthogonal box = (-4612.5 -100 -100) to (4612.5 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  1500 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  1500 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  1001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  1001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
1500 atoms in group substrate
group slider1 region slider1
1001 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 1001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_15_*.dump id type diameter mass xu yu zu fx fy fz

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 5952 130 130
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 116.7 | 116.7 | 116.7 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   9225           200            200            0              0              0              0              0              0              0              1.1965779e-13  0              6            
    100000   9225           200            200            0.0021888504  -3.5025899e-35  0              0.0065665512   579018.06      0              5.591742e+10   1.1965779e-13  0              3.3312516    
    200000   9225           200            200            0.00074399819 -7.0052519e-35  0              0.0022319946   132175.02      0              1.2764518e+10  1.1965779e-13  0              3.0826096    
    300000   9225           200            200           -1.2906557e-06 -5.4728547e-37  0             -3.8719672e-06  0.81246204     0              78461.768      1.1965779e-13  0              3.0442226    
    400000   9225           200            200            6.5808424e-06  2.2105126e-40  0              1.9742527e-05  23.667475      0              2285635.3      1.1965779e-13  0              3.0057631    
    500000   9225           200            200            0.0017511382   6.6756788e-05  0              0.0051866577   1315.6226      0              1.2705341e+08  1.1965779e-13  0              2.9952468    
    600000   9225           200            200            0.0025630602   0.00025551359  0              0.0074336671   196.3985       0              18966761       1.1965779e-13  0              2.9943811    
    700000   9225           200            200            0.0028758291   0.00024674427  0              0.0083807432   25.41527       0              2454424.8      1.1965779e-13  0              2.9940956    
    800000   9225           200            200            0.0028397078   0.00024085221  0              0.0082782713   3.1259925      0              301885.98      1.1965779e-13  0              2.9941311    
    900000   9225           200            200            0.0028118074   0.00024007467  0              0.0081953477   0.38176218     0              36867.859      1.1965779e-13  0              2.9941581    
   1000000   9225           200            200            0.002798002    0.00023968744  0              0.0081543184   0.045666415    0              4410.1355      1.1965779e-13  0              2.9941713    
   1100000   9225           200            200            0.0027917951   0.00023951306  0              0.0081358722   0.0053170356   0              513.48124      1.1965779e-13  0              2.9941772    
   1200000   9225           200            200            0.0027891295   0.00023943828  0              0.0081279504   0.00059935297  0              57.88122       1.1965779e-13  0              2.9941797    
   1300000   9225           200            200            0.0027880192   0.00023940721  0              0.0081246505   6.4966822e-05  0              6.2740307      1.1965779e-13  0              2.9941808    
   1400000   9225           200            200            0.0027875673   0.0002393946   0              0.0081233073   6.7055307e-06  0              0.64757216     1.1965779e-13  0              2.9941812    
   1500000   9225           200            200            0.0027873867   0.00023938957  0              0.0081227706   6.4901961e-07  0              0.062677668    1.1965779e-13  0              2.9941814    
   1600000   9225           200            200            0.0027873157   0.0002393876   0              0.0081225595   5.7401929e-08  0              0.0055434674   1.1965779e-13  0              2.9941814    
   1700000   9225           200            200            0.0027872882   0.00023938684  0              0.0081224776   4.4173984e-09  0              0.00042660072  1.1965779e-13  0              2.9941815    
   1800000   9225           200            200            0.0027872776   0.00023938655  0              0.0081224462   2.6458403e-10  0              2.5551632e-05  1.1965779e-13  0              2.9941815    
   1900000   9225           200            200            0.0027872736   0.00023938644  0              0.0081224343   8.5587425e-12  0              8.2654209e-07  1.1965779e-13  0              2.9941815    
   2000000   9225           200            200            0.0027872721   0.0002393864   0              0.0081224299   3.0839431e-15  0              2.9782515e-10  1.1965779e-13  0              2.9941815    
   2100000   9225           200            200            0.0027872715   0.00023938638  0              0.0081224282   1.892837e-13   0              1.8279665e-08  1.1965779e-13  0              2.9941815    
   2200000   9225           200            200            0.0027872713   0.00023938638  0              0.0081224276   9.6633198e-14  0              9.3321426e-09  1.1965779e-13  0              2.9941815    
   2300000   9225           200            200            0.0027872713   0.00023938637  0              0.0081224274   2.8596424e-14  0              2.7616379e-09  1.1965779e-13  0              2.9941815    
   2400000   9225           200            200            0.0027872712   0.00023938637  0              0.0081224273   6.5692327e-15  0              6.3440948e-10  1.1965779e-13  0              2.9941815    
   2500000   9225           200            200            0.0027872712   0.00023938637  0              0.0081224273   1.3154204e-15  0              1.2703388e-10  1.1965779e-13  0              2.9941815    
   2600000   9225           200            200            0.0027872712   0.00023938637  0              0.0081224273   2.5372715e-16  0              2.4503152e-11  1.1965779e-13  0              2.9941815    
   2700000   9225           200            200            0.0027872712   0.00023938637  0              0.0081224273   3.6075197e-17  0              3.4838843e-12  1.1965779e-13  0              2.9941815    
   2800000   9225           200            200            0.0027872712   0.00023938637  0              0.0081224273   1.4435107e-18  0              1.3940394e-13  1.1965779e-13  0              2.9941815    
   2900000   9225           200            200            0.0027872712   0.00023938637  0              0.0081224273   3.5379682e-18  0              3.4167165e-13  1.1965779e-13  0              2.9941815    
   3000000   9225           200            200            0.0027872712   0.00023938637  0              0.0081224273   2.8829514e-20  0              2.7841481e-15  1.1965779e-13  0              2.9941815    
Loop time of 297.06 on 4 procs for 3000000 steps with 2501 atoms

Performance: 8725505.244 ns/day, 0.000 hours/ns, 10098.964 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 11.042     | 36.27      | 62.367     | 415.6 | 12.21
Neigh   | 5.7194     | 5.8241     | 5.931      |   4.0 |  1.96
Comm    | 21.876     | 40.567     | 78.567     | 349.3 | 13.66
Output  | 0.2737     | 0.27401    | 0.27435    |   0.1 |  0.09
Modify  | 109.23     | 157.73     | 177.79     | 225.2 | 53.10
Other   |            | 56.39      |            |       | 18.98

Nlocal:         625.25 ave         876 max         375 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:           1.75 ave           3 max           1 min
Histogram: 2 0 0 0 0 1 0 0 0 1
Neighs:         318.25 ave         637 max           0 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 1273
Ave neighs/atom = 0.5089964
Neighbor list builds = 166
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 16

#variable lat0 equal 1                    #
variable lat1 equal 3+(300*0.01)+(v_ind*0.01)  # .491+(v_ind*0.001)       # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 500*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 6.16                                                               
Lattice spacing in x,y,z = 6.16 6.16 6.16

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -4620 ${n1e1} -100 100 -100 100 units box
region box block -4620 4620 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -4620 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -4620 4620 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-4620 -100 -100) to (4620 100 100)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 1500 atoms
  using lattice units in orthogonal box = (-4620 -100 -100) to (4620 100 100)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 1500 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 1001 atoms
  using lattice units in orthogonal box = (-4620 -100 -100) to (4620 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  1500 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  1500 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  1001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  1001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
1500 atoms in group substrate
group slider1 region slider1
1001 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 1001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_16_*.dump id type diameter mass xu yu zu fx fy fz

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 5962 130 130
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 116.8 | 116.8 | 116.9 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   9240           200            200            0              0              0              0              0              0              0              1.1965779e-13  0              6            
    100000   9240           200            200            0.0021840866  -8.7422464e-36  0              0.0065522597   578536.4       0              5.5870905e+10  1.1965779e-13  0              3.33164      
    200000   9240           200            200            0.00074028872  2.2319605e-40  0              0.0022208662   131479.29      0              1.2697329e+10  1.1965779e-13  0              3.0831159    
    300000   9240           200            200           -4.5941987e-06  2.1855908e-36  0             -1.3782596e-05  11.073165      0              1069367        1.1965779e-13  0              3.0439932    
    400000   9240           200            200           -2.691066e-06  -1.7484612e-35  0             -8.0731979e-06  3.8188882      0              368800.89      1.1965779e-13  0              3.0056007    
    500000   9240           200            200            0.00035410684 -0.00060274496  0              0.0016650655   24.06716       0              2324234.1      1.1965779e-13  0              2.9973042    
    600000   9240           200            200            0.0026764024  -0.0029415645   0              0.010970772    26.188468      0              2529094.8      1.1965779e-13  0              2.9931916    
    700000   9240           200            200            0.0019474857  -0.0026236972   0              0.0084661544   23.117997      0              2232570.7      1.1965779e-13  0              2.9940367    
    800000   9240           200            200            0.0017265605  -0.0025844053   0              0.0077640868   0.77541164     0              74883.706      1.1965779e-13  0              2.9942818    
    900000   9240           200            200            0.0018062678  -0.0025985485   0              0.0080173518   0.2847843      0              27502.429      1.1965779e-13  0              2.9941882    
   1000000   9240           200            200            0.0018463093  -0.0026050344   0              0.0081439623   0.035739907    0              3451.5044      1.1965779e-13  0              2.9941435    
   1100000   9240           200            200            0.0018406824  -0.0026040738   0              0.0081261208   0.0022374556   0              216.07745      1.1965779e-13  0              2.9941502    
   1200000   9240           200            200            0.0018345419  -0.0026030806   0              0.0081067063   0.0010052634   0              97.081146      1.1965779e-13  0              2.9941571    
   1300000   9240           200            200            0.0018344941  -0.0026030804   0              0.0081065627   4.88231e-06    0              0.47149855     1.1965779e-13  0              2.9941571    
   1400000   9240           200            200            0.0018353159  -0.0026032146   0              0.0081091623   2.0867883e-05  0              2.0152707      1.1965779e-13  0              2.9941562    
   1500000   9240           200            200            0.0018354305  -0.0026032323   0              0.0081095237   9.1603561e-08  0              0.0088464162   1.1965779e-13  0              2.994156     
   1600000   9240           200            200            0.0018353347  -0.0026032165   0              0.0081092205   3.3232179e-07  0              0.032093259    1.1965779e-13  0              2.9941561    
   1700000   9240           200            200            0.0018353066  -0.0026032121   0              0.0081091319   1.360575e-08   0              0.001313946    1.1965779e-13  0              2.9941562    
   1800000   9240           200            200            0.0018353158  -0.0026032136   0              0.0081091611   3.8975735e-09  0              0.00037639975  1.1965779e-13  0              2.9941562    
   1900000   9240           200            200            0.0018353208  -0.0026032144   0              0.0081091769   5.7343148e-10  0              5.5377908e-05  1.1965779e-13  0              2.9941562    
   2000000   9240           200            200            0.0018353202  -0.0026032143   0              0.008109175    2.7806585e-11  0              2.6853609e-06  1.1965779e-13  0              2.9941562    
   2100000   9240           200            200            0.0018353195  -0.0026032142   0              0.0081091727   1.53984e-11    0              1.4870672e-06  1.1965779e-13  0              2.9941562    
   2200000   9240           200            200            0.0018353195  -0.0026032142   0              0.0081091726   3.8211944e-14  0              3.690236e-09   1.1965779e-13  0              2.9941562    
   2300000   9240           200            200            0.0018353196  -0.0026032142   0              0.0081091729   3.0822469e-13  0              2.9766134e-08  1.1965779e-13  0              2.9941562    
   2400000   9240           200            200            0.0018353196  -0.0026032142   0              0.008109173    2.1172606e-15  0              2.0446987e-10  1.1965779e-13  0              2.9941562    
   2500000   9240           200            200            0.0018353196  -0.0026032142   0              0.0081091729   4.7832642e-15  0              4.6193342e-10  1.1965779e-13  0              2.9941562    
   2600000   9240           200            200            0.0018353196  -0.0026032142   0              0.0081091729   2.0192269e-16  0              1.9500248e-11  1.1965779e-13  0              2.9941562    
   2700000   9240           200            200            0.0018353196  -0.0026032142   0              0.0081091729   3.9407679e-17  0              3.8057116e-12  1.1965779e-13  0              2.9941562    
   2800000   9240           200            200            0.0018353196  -0.0026032142   0              0.0081091729   1.2196123e-17  0              1.1778143e-12  1.1965779e-13  0              2.9941562    
   2900000   9240           200            200            0.0018353196  -0.0026032142   0              0.0081091729   1.9265629e-20  0              1.8605366e-15  1.1965779e-13  0              2.9941562    
   3000000   9240           200            200            0.0018353196  -0.0026032142   0              0.0081091729   4.8702313e-18  0              4.7033208e-13  1.1965779e-13  0              2.9941562    
Loop time of 299.056 on 4 procs for 3000000 steps with 2501 atoms

Performance: 8667277.255 ns/day, 0.000 hours/ns, 10031.571 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 11.193     | 35.564     | 60.951     | 408.4 | 11.89
Neigh   | 5.7194     | 5.8232     | 5.9298     |   4.0 |  1.95
Comm    | 21.664     | 41.805     | 79.718     | 345.9 | 13.98
Output  | 0.27108    | 0.2714     | 0.27173    |   0.1 |  0.09
Modify  | 109.33     | 158.49     | 179.67     | 227.9 | 53.00
Other   |            | 57.1       |            |       | 19.09

Nlocal:         625.25 ave         876 max         375 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:           1.75 ave           3 max           1 min
Histogram: 2 0 0 0 0 1 0 0 0 1
Neighs:         313.25 ave         627 max           0 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 1253
Ave neighs/atom = 0.5009996
Neighbor list builds = 166
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 17

#variable lat0 equal 1                    #
variable lat1 equal 3+(300*0.01)+(v_ind*0.01)  # .491+(v_ind*0.001)       # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 500*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 6.17                                                               
Lattice spacing in x,y,z = 6.17 6.17 6.17

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -4627.5 ${n1e1} -100 100 -100 100 units box
region box block -4627.5 4627.5 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -4627.5 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -4627.5 4627.5 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-4627.5 -100 -100) to (4627.5 100 100)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 1500 atoms
  using lattice units in orthogonal box = (-4627.5 -100 -100) to (4627.5 100 100)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 1500 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 1001 atoms
  using lattice units in orthogonal box = (-4627.5 -100 -100) to (4627.5 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  1500 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  1500 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  1001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  1001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
1500 atoms in group substrate
group slider1 region slider1
1001 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 1001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_17_*.dump id type diameter mass xu yu zu fx fy fz

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 5971 130 130
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 117 | 117 | 117 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   9255           200            200            0              0              0              0              0              0              0              1.1965779e-13  0              6            
    100000   9255           200            200            0.0021798609  -8.7280914e-36  0              0.0065395828   578260.24      0              5.5844235e+10  1.1965779e-13  0              3.331884     
    200000   9255           200            200            0.00073737848  4.3641026e-35  0              0.0022121354   130999.81      0              1.2651024e+10  1.1965779e-13  0              3.0835457    
    300000   9255           200            200           -6.9186518e-06 -3.4911512e-35  0             -2.0755955e-05  25.518386      0              2464383.1      1.1965779e-13  0              3.0438919    
    400000   9255           200            200           -8.8715886e-06  1.2792532e-40  0             -2.6614766e-05  43.380594      0              4189387.2      1.1965779e-13  0              3.0055126    
    500000   9255           200            200            0.00077126985  6.0879303e-05  0              0.0022529302   350.51122      0              33849865       1.1965779e-13  0              2.996852     
    600000   9255           200            200            0.0033022502   0.00017108558  0              0.0097356651   135.75428      0              13110177       1.1965779e-13  0              2.9935874    
    700000   9255           200            200            0.0024419093   0.00016973161  0              0.0071559962   5.0062129      0              483464.21      1.1965779e-13  0              2.9944941    
    800000   9255           200            200            0.002900036    0.00021242056  0              0.0084876873   0.0019679366   0              190.04924      1.1965779e-13  0              2.9940019    
    900000   9255           200            200            0.0027215603   0.00019274071  0              0.0079719402   0.10913454     0              10539.433      1.1965779e-13  0              2.9941902    
   1000000   9255           200            200            0.002772972    0.00019479832  0              0.0081241178   0.044062956    0              4255.2849      1.1965779e-13  0              2.9941335    
   1100000   9255           200            200            0.0027629759   0.0001944252   0              0.0080945025   0.0083710285   0              808.41402      1.1965779e-13  0              2.9941447    
   1200000   9255           200            200            0.0027625268   0.00019441487  0              0.0080931656   0.00096417633  0              93.113248      1.1965779e-13  0              2.9941451    
   1300000   9255           200            200            0.0027641693   0.00019447307  0              0.0080980349   6.0863609e-05  0              5.8777717      1.1965779e-13  0              2.9941433    
   1400000   9255           200            200            0.0027631647   0.00019443677  0              0.0080950574   7.595509e-07   0              0.073351989    1.1965779e-13  0              2.9941444    
   1500000   9255           200            200            0.0027635949   0.0001944525   0              0.0080963322   2.3727696e-07  0              0.022914511    1.1965779e-13  0              2.9941439    
   1600000   9255           200            200            0.0027634514   0.0001944472   0              0.0080959069   1.8800832e-07  0              0.018156498    1.1965779e-13  0              2.9941441    
   1700000   9255           200            200            0.0027634864   0.00019444852  0              0.0080960108   4.6475029e-08  0              0.0044882257   1.1965779e-13  0              2.9941441    
   1800000   9255           200            200            0.002763483    0.00019444838  0              0.0080960008   6.6193348e-09  0              0.00063924797  1.1965779e-13  0              2.9941441    
   1900000   9255           200            200            0.0027634805   0.00019444829  0              0.0080959933   5.6152002e-10  0              5.4227584e-05  1.1965779e-13  0              2.9941441    
   2000000   9255           200            200            0.0027634826   0.00019444837  0              0.0080959995   1.9329991e-11  0              1.8667521e-06  1.1965779e-13  0              2.9941441    
   2100000   9255           200            200            0.0027634816   0.00019444833  0              0.0080959965   1.1880728e-13  0              1.1473557e-08  1.1965779e-13  0              2.9941441    
   2200000   9255           200            200            0.002763482    0.00019444834  0              0.0080959976   6.6668488e-13  0              6.4383654e-08  1.1965779e-13  0              2.9941441    
   2300000   9255           200            200            0.0027634819   0.00019444834  0              0.0080959973   2.3374867e-13  0              2.2573773e-08  1.1965779e-13  0              2.9941441    
   2400000   9255           200            200            0.0027634819   0.00019444834  0              0.0080959973   4.1393287e-14  0              3.9974674e-09  1.1965779e-13  0              2.9941441    
   2500000   9255           200            200            0.0027634819   0.00019444834  0              0.0080959973   4.4289402e-15  0              4.2771534e-10  1.1965779e-13  0              2.9941441    
   2600000   9255           200            200            0.0027634819   0.00019444834  0              0.0080959973   2.5142053e-16  0              2.4280395e-11  1.1965779e-13  0              2.9941441    
   2700000   9255           200            200            0.0027634819   0.00019444834  0              0.0080959973   1.7280917e-20  0              1.6688673e-15  1.1965779e-13  0              2.9941441    
   2800000   9255           200            200            0.0027634819   0.00019444834  0              0.0080959973   3.8526995e-18  0              3.7206614e-13  1.1965779e-13  0              2.9941441    
   2900000   9255           200            200            0.0027634819   0.00019444834  0              0.0080959973   2.9864507e-18  0              2.8841003e-13  1.1965779e-13  0              2.9941441    
   3000000   9255           200            200            0.0027634819   0.00019444834  0              0.0080959973   6.9714311e-18  0              6.7325091e-13  1.1965779e-13  0              2.9941441    
Loop time of 296.431 on 4 procs for 3000000 steps with 2501 atoms

Performance: 8744027.608 ns/day, 0.000 hours/ns, 10120.402 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 11.19      | 35.805     | 61.355     | 409.0 | 12.08
Neigh   | 5.7721     | 5.8816     | 5.9931     |   4.1 |  1.98
Comm    | 21.906     | 40.32      | 77.451     | 342.6 | 13.60
Output  | 0.27018    | 0.27048    | 0.27083    |   0.1 |  0.09
Modify  | 109.9      | 157.93     | 178        | 223.3 | 53.28
Other   |            | 56.22      |            |       | 18.97

Nlocal:         625.25 ave         876 max         375 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:           1.75 ave           3 max           1 min
Histogram: 2 0 0 0 0 1 0 0 0 1
Neighs:         313.25 ave         627 max           0 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 1253
Ave neighs/atom = 0.5009996
Neighbor list builds = 166
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 18

#variable lat0 equal 1                    #
variable lat1 equal 3+(300*0.01)+(v_ind*0.01)  # .491+(v_ind*0.001)       # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 500*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 6.18                                                               
Lattice spacing in x,y,z = 6.18 6.18 6.18

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -4635 ${n1e1} -100 100 -100 100 units box
region box block -4635 4635 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -4635 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -4635 4635 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-4635 -100 -100) to (4635 100 100)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 1500 atoms
  using lattice units in orthogonal box = (-4635 -100 -100) to (4635 100 100)
  create_atoms CPU = 0.000 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 1500 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 1001 atoms
  using lattice units in orthogonal box = (-4635 -100 -100) to (4635 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  1500 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  1500 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  1001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  1001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
1500 atoms in group substrate
group slider1 region slider1
1001 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 1001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_18_*.dump id type diameter mass xu yu zu fx fy fz

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 5981 130 130
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 117.2 | 117.2 | 117.2 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   9270           200            200            0              0              0              0              0              0              0              1.1965779e-13  0              6            
    100000   9270           200            200            0.0021768725  -3.8124021e-35  0              0.0065306174   578475.24      0              5.5864998e+10  1.1965779e-13  0              3.331711     
    200000   9270           200            200            0.00073746071  7.7847609e-41  0              0.0022123821   131356.5       0              1.2685471e+10  1.1965779e-13  0              3.0832559    
    300000   9270           200            200           -5.0199492e-06  3.7391594e-40  0             -1.5059848e-05  13.346335      0              1288893.5      1.1965779e-13  0              3.043997     
    400000   9270           200            200           -3.9546454e-06  2.6142307e-35  0             -1.1863936e-05  8.4324168      0              814342.46      1.1965779e-13  0              3.0056094    
    500000   9270           200            200            0.00041847919 -0.00044271486  0              0.0016981524   77.027915      0              7438804.7      1.1965779e-13  0              2.9972653    
    600000   9270           200            200            0.0039845768   0.00072903374  0              0.011224697    0.82753919     0              79917.812      1.1965779e-13  0              2.9931472    
    700000   9270           200            200            0.0028256132   0.00046082184  0              0.0080160178   25.924017      0              2503556        1.1965779e-13  0              2.9941931    
    800000   9270           200            200            0.0027424528   0.00045409696  0              0.0077732616   1.3204819      0              127522.69      1.1965779e-13  0              2.9942746    
    900000   9270           200            200            0.0027997976   0.00046144478  0              0.007937948    0.0040938741   0              395.35706      1.1965779e-13  0              2.9942134    
   1000000   9270           200            200            0.0028370789   0.00046444103  0              0.0080467956   0.035005937    0              3380.6228      1.1965779e-13  0              2.9941745    
   1100000   9270           200            200            0.0028494853   0.00046539561  0              0.0080830602   0.0085137123   0              822.19339      1.1965779e-13  0              2.9941618    
   1200000   9270           200            200            0.0028511342   0.00046551565  0              0.008087887    0.00060246895  0              58.182139      1.1965779e-13  0              2.9941602    
   1300000   9270           200            200            0.0028503497   0.00046545263  0              0.0080855964   6.4307398e-07  0              0.062103482    1.1965779e-13  0              2.994161     
   1400000   9270           200            200            0.002849704    0.00046540241  0              0.0080837097   8.2825345e-06  0              0.7998679      1.1965779e-13  0              2.9941617    
   1500000   9270           200            200            0.0028494614   0.0004653838   0              0.0080830003   2.7616459e-06  0              0.2667         1.1965779e-13  0              2.9941619    
   1600000   9270           200            200            0.0028494175   0.00046538053  0              0.0080828719   2.5898886e-07  0              0.02501129     1.1965779e-13  0              2.994162     
   1700000   9270           200            200            0.0028494265   0.00046538127  0              0.0080828982   2.5558e-09     0              0.00024682087  1.1965779e-13  0              2.994162     
   1800000   9270           200            200            0.0028494373   0.00046538212  0              0.0080829298   1.7107439e-09  0              0.0001652114   1.1965779e-13  0              2.9941619    
   1900000   9270           200            200            0.0028494419   0.00046538247  0              0.0080829432   8.4967932e-10  0              8.2055947e-05  1.1965779e-13  0              2.9941619    
   2000000   9270           200            200            0.0028494429   0.00046538255  0              0.0080829463   1.0316011e-10  0              9.962465e-06   1.1965779e-13  0              2.9941619    
   2100000   9270           200            200            0.0028494429   0.00046538254  0              0.0080829461   2.4050341e-12  0              2.3226098e-07  1.1965779e-13  0              2.9941619    
   2200000   9270           200            200            0.0028494427   0.00046538253  0              0.0080829456   2.8437476e-13  0              2.7462879e-08  1.1965779e-13  0              2.9941619    
   2300000   9270           200            200            0.0028494426   0.00046538252  0              0.0080829453   2.4690397e-13  0              2.3844218e-08  1.1965779e-13  0              2.9941619    
   2400000   9270           200            200            0.0028494426   0.00046538252  0              0.0080829452   3.8627815e-14  0              3.7303979e-09  1.1965779e-13  0              2.9941619    
   2500000   9270           200            200            0.0028494426   0.00046538252  0              0.0080829452   1.6381844e-15  0              1.5820412e-10  1.1965779e-13  0              2.9941619    
   2600000   9270           200            200            0.0028494426   0.00046538252  0              0.0080829452   2.090119e-17   0              2.0184874e-12  1.1965779e-13  0              2.9941619    
   2700000   9270           200            200            0.0028494426   0.00046538252  0              0.0080829452   4.8075431e-17  0              4.642781e-12   1.1965779e-13  0              2.9941619    
   2800000   9270           200            200            0.0028494426   0.00046538252  0              0.0080829453   1.2495014e-17  0              1.206679e-12   1.1965779e-13  0              2.9941619    
   2900000   9270           200            200            0.0028494426   0.00046538252  0              0.0080829453   1.9973162e-19  0              1.928865e-14   1.1965779e-13  0              2.9941619    
   3000000   9270           200            200            0.0028494426   0.00046538252  0              0.0080829453   4.6805682e-18  0              4.5201577e-13  1.1965779e-13  0              2.9941619    
Loop time of 297.14 on 4 procs for 3000000 steps with 2501 atoms

Performance: 8723149.998 ns/day, 0.000 hours/ns, 10096.238 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 11.083     | 36.328     | 62.858     | 416.5 | 12.23
Neigh   | 5.7763     | 5.887      | 6.0009     |   4.2 |  1.98
Comm    | 21.95      | 41.029     | 79.323     | 350.4 | 13.81
Output  | 0.27252    | 0.27285    | 0.2732     |   0.1 |  0.09
Modify  | 108.87     | 157.35     | 177.4      | 225.1 | 52.95
Other   |            | 56.28      |            |       | 18.94

Nlocal:         625.25 ave         876 max         375 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:           1.75 ave           3 max           1 min
Histogram: 2 0 0 0 0 1 0 0 0 1
Neighs:         315.25 ave         631 max           0 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 1261
Ave neighs/atom = 0.50419832
Neighbor list builds = 166
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 19

#variable lat0 equal 1                    #
variable lat1 equal 3+(300*0.01)+(v_ind*0.01)  # .491+(v_ind*0.001)       # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 500*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 6.19                                                               
Lattice spacing in x,y,z = 6.19 6.19 6.19

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -4642.5 ${n1e1} -100 100 -100 100 units box
region box block -4642.5 4642.5 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -4642.5 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -4642.5 4642.5 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-4642.5 -100 -100) to (4642.5 100 100)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 1500 atoms
  using lattice units in orthogonal box = (-4642.5 -100 -100) to (4642.5 100 100)
  create_atoms CPU = 0.000 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 1500 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 1001 atoms
  using lattice units in orthogonal box = (-4642.5 -100 -100) to (4642.5 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  1500 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  1500 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  1001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  1001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
1500 atoms in group substrate
group slider1 region slider1
1001 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 1001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_19_*.dump id type diameter mass xu yu zu fx fy fz

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 5991 130 130
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 117.4 | 117.4 | 117.4 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   9285           200            200            0              0              0              0              0              0              0              1.1965779e-13  0              6            
    100000   9285           200            200            0.002173807    8.9991536e-41  0              0.0065214209   578653.6       0              5.5882223e+10  1.1965779e-13  0              3.3315822    
    200000   9285           200            200            0.00073733679 -3.4799307e-35  0              0.0022120104   131655.39      0              1.2714335e+10  1.1965779e-13  0              3.083021     
    300000   9285           200            200           -3.5453878e-06  3.48005e-35    0             -1.0636163e-05  6.5985635      0              637242.03      1.1965779e-13  0              3.0440913    
    400000   9285           200            200            1.1180691e-06  2.4535408e-41  0              3.3542073e-06  0.75617577     0              73026.044      1.1965779e-13  0              3.0056688    
    500000   9285           200            200            0.0005024246  -0.0001835791   0              0.0016908529   21.648914      0              2090697.1      1.1965779e-13  0              2.9973586    
    600000   9285           200            200            0.0035884546  -0.00040478083  0              0.011170145    0.5415407      0              52298.125      1.1965779e-13  0              2.9931648    
    700000   9285           200            200            0.0025731304  -0.00022957271  0              0.0079489638   25.431565      0              2455998.5      1.1965779e-13  0              2.9942431    
    800000   9285           200            200            0.0024206518  -0.00041697506  0              0.0076789305   0.0032160051   0              310.57875      1.1965779e-13  0              2.9943341    
    900000   9285           200            200            0.0025575406  -0.00038456066  0              0.0080571825   0.46392088     0              44802.158      1.1965779e-13  0              2.9941957    
   1000000   9285           200            200            0.0025787991  -0.00038571385  0              0.0081221112   0.0022401146   0              216.33423      1.1965779e-13  0              2.9941733    
   1100000   9285           200            200            0.0025637123  -0.00038483861  0              0.0080759755   0.0077387626   0              747.3543       1.1965779e-13  0              2.99419      
   1200000   9285           200            200            0.0025596081  -0.00038462031  0              0.0080634446   0.00018867991  0              18.221355      1.1965779e-13  0              2.9941944    
   1300000   9285           200            200            0.0025612991  -0.00038471382  0              0.008068611    0.00011484231  0              11.090648      1.1965779e-13  0              2.9941925    
   1400000   9285           200            200            0.0025619946  -0.00038475118  0              0.008070735    7.5644116e-06  0              0.73051673     1.1965779e-13  0              2.9941918    
   1500000   9285           200            200            0.0025618247  -0.0003847416   0              0.0080702157   1.4776324e-06  0              0.14269916     1.1965779e-13  0              2.994192     
   1600000   9285           200            200            0.0025617166  -0.00038473575  0              0.0080698857   2.2352204e-07  0              0.021586158    1.1965779e-13  0              2.9941921    
   1700000   9285           200            200            0.0025617305  -0.00038473655  0              0.0080699281   1.5480121e-08  0              0.0014949593   1.1965779e-13  0              2.9941921    
   1800000   9285           200            200            0.0025617463  -0.00038473741  0              0.0080699762   5.5050053e-09  0              0.00053163401  1.1965779e-13  0              2.9941921    
   1900000   9285           200            200            0.0025617457  -0.00038473737  0              0.0080699745   1.1184062e-10  0              1.0800767e-05  1.1965779e-13  0              2.9941921    
   2000000   9285           200            200            0.0025617435  -0.00038473726  0              0.0080699678   1.1869597e-10  0              1.1462807e-05  1.1965779e-13  0              2.9941921    
   2100000   9285           200            200            0.0025617434  -0.00038473725  0              0.0080699675   2.6530075e-13  0              2.5620847e-08  1.1965779e-13  0              2.9941921    
   2200000   9285           200            200            0.0025617437  -0.00038473727  0              0.0080699684   2.2890992e-12  0              2.2106482e-07  1.1965779e-13  0              2.9941921    
   2300000   9285           200            200            0.0025617437  -0.00038473727  0              0.0080699685   3.2251785e-15  0              3.1146465e-10  1.1965779e-13  0              2.9941921    
   2400000   9285           200            200            0.0025617437  -0.00038473727  0              0.0080699684   3.9686638e-14  0              3.8326514e-09  1.1965779e-13  0              2.9941921    
   2500000   9285           200            200            0.0025617437  -0.00038473727  0              0.0080699684   6.2868734e-16  0              6.0714123e-11  1.1965779e-13  0              2.9941921    
   2600000   9285           200            200            0.0025617437  -0.00038473727  0              0.0080699684   6.0766999e-16  0              5.8684418e-11  1.1965779e-13  0              2.9941921    
   2700000   9285           200            200            0.0025617437  -0.00038473727  0              0.0080699684   4.1566974e-17  0              4.0142408e-12  1.1965779e-13  0              2.9941921    
   2800000   9285           200            200            0.0025617437  -0.00038473727  0              0.0080699684   2.4482554e-18  0              2.3643498e-13  1.1965779e-13  0              2.9941921    
   2900000   9285           200            200            0.0025617437  -0.00038473727  0              0.0080699684   9.4886163e-19  0              9.1634264e-14  1.1965779e-13  0              2.9941921    
   3000000   9285           200            200            0.0025617437  -0.00038473727  0              0.0080699684   3.9904893e-18  0              3.8537289e-13  1.1965779e-13  0              2.9941921    
Loop time of 300.37 on 4 procs for 3000000 steps with 2501 atoms

Performance: 8629368.288 ns/day, 0.000 hours/ns, 9987.695 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 11.035     | 35.965     | 61.846     | 412.4 | 11.97
Neigh   | 5.7459     | 5.8499     | 5.957      |   3.9 |  1.95
Comm    | 22.328     | 40.586     | 77.798     | 341.9 | 13.51
Output  | 0.27257    | 0.27287    | 0.27318    |   0.1 |  0.09
Modify  | 111.07     | 160.18     | 182.35     | 227.3 | 53.33
Other   |            | 57.51      |            |       | 19.15

Nlocal:         625.25 ave         876 max         375 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:           1.75 ave           3 max           1 min
Histogram: 2 0 0 0 0 1 0 0 0 1
Neighs:         314.25 ave         629 max           0 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 1257
Ave neighs/atom = 0.50259896
Neighbor list builds = 166
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 20

#variable lat0 equal 1                    #
variable lat1 equal 3+(300*0.01)+(v_ind*0.01)  # .491+(v_ind*0.001)       # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 500*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 6.2                                                               
Lattice spacing in x,y,z = 6.2 6.2 6.2

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -4650 ${n1e1} -100 100 -100 100 units box
region box block -4650 4650 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -4650 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -4650 4650 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-4650 -100 -100) to (4650 100 100)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 1500 atoms
  using lattice units in orthogonal box = (-4650 -100 -100) to (4650 100 100)
  create_atoms CPU = 0.000 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 1500 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 1001 atoms
  using lattice units in orthogonal box = (-4650 -100 -100) to (4650 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  1500 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  1500 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  1001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  1001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
1500 atoms in group substrate
group slider1 region slider1
1001 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 1001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_20_*.dump id type diameter mass xu yu zu fx fy fz

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 6000 130 130
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 117.6 | 117.6 | 117.6 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   9300           200            200            0              0              0              0              0              0              0              1.1965779e-13  0              6            
    100000   9300           200            200            0.0021709214   2.6701904e-40  0              0.0065127643   578909.02      0              5.5906889e+10  1.1965779e-13  0              3.3313257    
    200000   9300           200            200            0.00073618032 -4.3429719e-35  0              0.002208541    131659.32      0              1.2714715e+10  1.1965779e-13  0              3.0831335    
    300000   9300           200            200            5.4758933e-07  4.733664e-40   0              1.642768e-06   0.19544848     0              18875.015      1.1965779e-13  0              3.0442005    
    400000   9300           200            200            1.7791768e-05  3.4744008e-35  0              5.3375305e-05  170.31727      0              16448023       1.1965779e-13  0              3.0054701    
    500000   9300           200            200            0.0048956865   0.00031587729  0              0.014371182    604.0767       0              58337404       1.1965779e-13  0              2.9918074    
    600000   9300           200            200            0.0036102323   5.1029957e-05  0              0.010779667    0.070053468    0              6765.2625      1.1965779e-13  0              2.9927748    
    700000   9300           200            200            0.0026956962   9.5545598e-35  0              0.0080870885   22.385586      0              2161839.7      1.1965779e-13  0              2.9938604    
    800000   9300           200            200            0.0026121104   1.1199601e-40  0              0.0078363313   1.5326138      0              148008.87      1.1965779e-13  0              2.993995     
    900000   9300           200            200            0.0026475236  -4.3428373e-36  0              0.0079425709   0.00095375979  0              92.107294      1.1965779e-13  0              2.9939434    
   1000000   9300           200            200            0.0026767344   2.171636e-36   0              0.0080302031   0.033442252    0              3229.6133      1.1965779e-13  0              2.9938992    
   1100000   9300           200            200            0.0026862735   3.257381e-36   0              0.0080588204   0.0072602656   0              701.14449      1.1965779e-13  0              2.9938845    
   1200000   9300           200            200            0.0026869816   1.4656556e-40  0              0.0080609449   0.00028634144  0              27.652807      1.1965779e-13  0              2.9938833    
   1300000   9300           200            200            0.002686039   -4.3428286e-36  0              0.008058117    1.0495222e-05  0              1.0135534      1.1965779e-13  0              2.9938847    
   1400000   9300           200            200            0.002685483    8.6861016e-36  0              0.0080564491   1.4956085e-05  0              1.4443516      1.1965779e-13  0              2.9938855    
   1500000   9300           200            200            0.0026853387  -6.0801517e-35  0              0.0080560162   2.1075008e-06  0              0.20352734     1.1965779e-13  0              2.9938857    
   1600000   9300           200            200            0.0026853433  -2.6057708e-35  0              0.0080560299   3.4954855e-08  0              0.0033756897   1.1965779e-13  0              2.9938857    
   1700000   9300           200            200            0.002685365    8.6861015e-36  0              0.0080560951   1.0961337e-08  0              0.0010585674   1.1965779e-13  0              2.9938857    
   1800000   9300           200            200            0.002685375   -5.2115565e-35  0              0.0080561251   5.8353595e-09  0              0.00056353725  1.1965779e-13  0              2.9938857    
   1900000   9300           200            200            0.002685377   -1.2160318e-34  0              0.0080561309   5.372637e-10   0              5.1885083e-05  1.1965779e-13  0              2.9938857    
   2000000   9300           200            200            0.0026853766   1.4955159e-40  0              0.0080561297   1.0151101e-12  0              9.8032064e-08  1.1965779e-13  0              2.9938857    
   2100000   9300           200            200            0.0026853761   1.4916259e-40  0              0.0080561284   6.9550772e-12  0              6.7167158e-07  1.1965779e-13  0              2.9938857    
   2200000   9300           200            200            0.002685376    1.7372054e-35  0              0.0080561279   2.0293941e-12  0              1.9598436e-07  1.1965779e-13  0              2.9938857    
   2300000   9300           200            200            0.0026853759   3.4743959e-35  0              0.0080561278   1.154526e-13   0              1.1149585e-08  1.1965779e-13  0              2.9938857    
   2400000   9300           200            200            0.0026853759   1.4938568e-40  0              0.0080561278   6.7845718e-16  0              6.5520538e-11  1.1965779e-13  0              2.9938857    
   2500000   9300           200            200            0.002685376   -6.948747e-35   0              0.0080561279   3.5361083e-15  0              3.4149203e-10  1.1965779e-13  0              2.9938857    
   2600000   9300           200            200            0.002685376    3.4743959e-35  0              0.0080561279   6.1698331e-16  0              5.9583832e-11  1.1965779e-13  0              2.9938857    
   2700000   9300           200            200            0.002685376    6.9487768e-35  0              0.0080561279   1.8705675e-18  0              1.8064602e-13  1.1965779e-13  0              2.9938857    
   2800000   9300           200            200            0.002685376   -1.3897509e-34  0              0.0080561279   3.0753642e-18  0              2.9699666e-13  1.1965779e-13  0              2.9938857    
   2900000   9300           200            200            0.002685376    3.4743963e-35  0              0.0080561279   4.1982931e-18  0              4.054411e-13   1.1965779e-13  0              2.9938857    
   3000000   9300           200            200            0.002685376    3.4743945e-35  0              0.0080561279   4.5048885e-19  0              4.3504989e-14  1.1965779e-13  0              2.9938857    
Loop time of 296.427 on 4 procs for 3000000 steps with 2501 atoms

Performance: 8744138.310 ns/day, 0.000 hours/ns, 10120.530 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 11.229     | 34.498     | 58.666     | 395.5 | 11.64
Neigh   | 5.7985     | 5.8987     | 6.0016     |   3.8 |  1.99
Comm    | 21.86      | 41.415     | 77.461     | 331.3 | 13.97
Output  | 0.26949    | 0.26979    | 0.27011    |   0.1 |  0.09
Modify  | 108.95     | 157.29     | 178.92     | 226.0 | 53.06
Other   |            | 57.06      |            |       | 19.25

Nlocal:         625.25 ave         876 max         375 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:           1.75 ave           3 max           1 min
Histogram: 2 0 0 0 0 1 0 0 0 1
Neighs:         307.25 ave         615 max           0 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 1229
Ave neighs/atom = 0.49140344
Neighbor list builds = 166
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 21

#variable lat0 equal 1                    #
variable lat1 equal 3+(300*0.01)+(v_ind*0.01)  # .491+(v_ind*0.001)       # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 500*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 6.21                                                               
Lattice spacing in x,y,z = 6.21 6.21 6.21

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -4657.5 ${n1e1} -100 100 -100 100 units box
region box block -4657.5 4657.5 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -4657.5 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -4657.5 4657.5 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-4657.5 -100 -100) to (4657.5 100 100)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 1500 atoms
  using lattice units in orthogonal box = (-4657.5 -100 -100) to (4657.5 100 100)
  create_atoms CPU = 0.000 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 1500 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 1001 atoms
  using lattice units in orthogonal box = (-4657.5 -100 -100) to (4657.5 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  1500 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  1500 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  1001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  1001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
1500 atoms in group substrate
group slider1 region slider1
1001 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 1001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_21_*.dump id type diameter mass xu yu zu fx fy fz

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 6010 130 130
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 117.6 | 117.7 | 117.7 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   9315           200            200            0              0              0              0              0              0              0              1.1965779e-13  0              6            
    100000   9315           200            200            0.0021656797   4.3360086e-36  0              0.0064970391   578211.44      0              5.5839522e+10  1.1965779e-13  0              3.3318687    
    200000   9315           200            200            0.00073230351  2.9702853e-41  0              0.0021969105   130911.38      0              1.2642484e+10  1.1965779e-13  0              3.0835524    
    300000   9315           200            200           -8.2337633e-06  6.9376953e-35  0             -2.470129e-05   36.809429      0              3554791.2      1.1965779e-13  0              3.0438109    
    400000   9315           200            200           -1.1625414e-05  3.4688053e-35  0             -3.4876242e-05  76.126571      0              7351759.3      1.1965779e-13  0              3.0054382    
    500000   9315           200            200            0.00078018662 -6.9386038e-06  0              0.0023474985   399.62372      0              38592799       1.1965779e-13  0              2.9967466    
    600000   9315           200            200            0.0034312419   0.00035999367  0              0.0099337321   118.44759      0              11438820       1.1965779e-13  0              2.9934721    
    700000   9315           200            200            0.0023527441   2.8964171e-05  0              0.0070292682   1.3349068      0              128915.75      1.1965779e-13  0              2.9944898    
    800000   9315           200            200            0.0026993656   0.0001082996   0              0.0079897971   3.4030972      0              328646.77      1.1965779e-13  0              2.9941251    
    900000   9315           200            200            0.0027645413   0.00010598636  0              0.0081876375   0.0014004741   0              135.24777      1.1965779e-13  0              2.9940564    
   1000000   9315           200            200            0.0027157503   0.00010326096  0              0.00804399     0.062804315    0              6065.1912      1.1965779e-13  0              2.9941085    
   1100000   9315           200            200            0.0027090927   0.0001028875   0              0.0080243905   3.2524463e-05  0              3.1409799      1.1965779e-13  0              2.9941152    
   1200000   9315           200            200            0.0027159441   0.0001032952   0              0.0080445371   0.0011267615   0              108.81456      1.1965779e-13  0              2.9941079    
   1300000   9315           200            200            0.0027165537   0.00010332808  0              0.0080463329   4.8284752e-06  0              0.46629958     1.1965779e-13  0              2.9941073    
   1400000   9315           200            200            0.0027156032   0.00010327213  0              0.0080435374   1.9669385e-05  0              1.8995284      1.1965779e-13  0              2.9941083    
   1500000   9315           200            200            0.0027155614   0.00010327007  0              0.0080434141   2.3522419e-07  0              0.022716269    1.1965779e-13  0              2.9941084    
   1600000   9315           200            200            0.0027156914   0.00010327771  0              0.0080437965   3.3374568e-07  0              0.032230769    1.1965779e-13  0              2.9941082    
   1700000   9315           200            200            0.0027156915   0.00010327766  0              0.0080437968   8.0992178e-09  0              0.00078216449  1.1965779e-13  0              2.9941082    
   1800000   9315           200            200            0.002715674    0.00010327664  0              0.0080437452   5.4924882e-09  0              0.0005304252   1.1965779e-13  0              2.9941083    
   1900000   9315           200            200            0.0027156747   0.00010327669  0              0.0080437474   2.3386745e-10  0              2.2585245e-05  1.1965779e-13  0              2.9941083    
   2000000   9315           200            200            0.002715677    0.00010327682  0              0.0080437543   8.7385062e-11  0              8.4390238e-06  1.1965779e-13  0              2.9941083    
   2100000   9315           200            200            0.0027156768   0.00010327681  0              0.0080437537   6.0563357e-12  0              5.8487755e-07  1.1965779e-13  0              2.9941083    
   2200000   9315           200            200            0.0027156765   0.00010327679  0              0.0080437528   1.3369629e-12  0              1.291143e-07   1.1965779e-13  0              2.9941083    
   2300000   9315           200            200            0.0027156766   0.00010327679  0              0.0080437529   1.453071e-13   0              1.403272e-08   1.1965779e-13  0              2.9941083    
   2400000   9315           200            200            0.0027156766   0.0001032768   0              0.008043753    1.9487196e-14  0              1.881934e-09   1.1965779e-13  0              2.9941083    
   2500000   9315           200            200            0.0027156766   0.0001032768   0              0.008043753    3.3870362e-15  0              3.2709572e-10  1.1965779e-13  0              2.9941083    
   2600000   9315           200            200            0.0027156766   0.0001032768   0              0.008043753    2.3482278e-16  0              2.2677504e-11  1.1965779e-13  0              2.9941083    
   2700000   9315           200            200            0.0027156766   0.0001032768   0              0.008043753    5.9570707e-17  0              5.7529125e-12  1.1965779e-13  0              2.9941083    
   2800000   9315           200            200            0.0027156766   0.0001032768   0              0.008043753    4.4023036e-18  0              4.2514297e-13  1.1965779e-13  0              2.9941083    
   2900000   9315           200            200            0.0027156766   0.0001032768   0              0.008043753    5.1781451e-18  0              5.0006819e-13  1.1965779e-13  0              2.9941083    
   3000000   9315           200            200            0.0027156766   0.0001032768   0              0.008043753    5.5285248e-19  0              5.3390535e-14  1.1965779e-13  0              2.9941083    
Loop time of 298.493 on 4 procs for 3000000 steps with 2501 atoms

Performance: 8683630.568 ns/day, 0.000 hours/ns, 10050.498 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 11.177     | 35.749     | 61.204     | 410.2 | 11.98
Neigh   | 5.8091     | 5.9168     | 6.0268     |   4.1 |  1.98
Comm    | 21.866     | 41.919     | 79.901     | 345.9 | 14.04
Output  | 0.27205    | 0.27236    | 0.27269    |   0.1 |  0.09
Modify  | 108.68     | 157.52     | 178.84     | 226.9 | 52.77
Other   |            | 57.11      |            |       | 19.13

Nlocal:         625.25 ave         876 max         375 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:           1.75 ave           3 max           1 min
Histogram: 2 0 0 0 0 1 0 0 0 1
Neighs:         313.75 ave         628 max           0 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 1255
Ave neighs/atom = 0.50179928
Neighbor list builds = 166
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 22

#variable lat0 equal 1                    #
variable lat1 equal 3+(300*0.01)+(v_ind*0.01)  # .491+(v_ind*0.001)       # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 500*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 6.22                                                               
Lattice spacing in x,y,z = 6.22 6.22 6.22

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -4665 ${n1e1} -100 100 -100 100 units box
region box block -4665 4665 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -4665 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -4665 4665 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-4665 -100 -100) to (4665 100 100)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 1500 atoms
  using lattice units in orthogonal box = (-4665 -100 -100) to (4665 100 100)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 1500 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 1001 atoms
  using lattice units in orthogonal box = (-4665 -100 -100) to (4665 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  1500 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  1500 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  1001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  1001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
1500 atoms in group substrate
group slider1 region slider1
1001 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 1001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_22_*.dump id type diameter mass xu yu zu fx fy fz

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 6020 130 130
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 117.8 | 117.8 | 117.9 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   9330           200            200            0              0              0              0              0              0              0              1.1965779e-13  0              6            
    100000   9330           200            200            0.0021624044   1.7316068e-34  0              0.0064872132   578287.07      0              5.5846826e+10  1.1965779e-13  0              3.3318613    
    200000   9330           200            200            0.00073158846  4.3290218e-35  0              0.0021947654   131038.37      0              1.2654748e+10  1.1965779e-13  0              3.083517     
    300000   9330           200            200           -6.6022939e-06  6.9122805e-41  0             -1.9806882e-05  23.588922      0              2278049.2      1.1965779e-13  0              3.0439054    
    400000   9330           200            200           -8.0330958e-06 -3.463168e-35   0             -2.4099287e-05  36.047509      0              3481210.4      1.1965779e-13  0              3.0055251    
    500000   9330           200            200            0.00087580789  0.00023544156  0              0.0023919821   408.37043      0              39437493       1.1965779e-13  0              2.9967641    
    600000   9330           200            200            0.0031491395   0.00015352715  0              0.0092938914   158.69807      0              15325924       1.1965779e-13  0              2.9937       
    700000   9330           200            200            0.0023349811  -3.3644464e-05  0              0.0070385877   2.4109475      0              232832.05      1.1965779e-13  0              2.9944987    
    800000   9330           200            200            0.0027591025  -1.4339795e-05  0              0.0082916472   1.8919544      0              182711.41      1.1965779e-13  0              2.9940305    
    900000   9330           200            200            0.0026965077  -5.0756123e-06  0              0.0080945986   0.37606711     0              36317.87       1.1965779e-13  0              2.9941045    
   1000000   9330           200            200            0.0026584411  -3.3409094e-06  0              0.0079786643   0.00049610473  0              47.910244      1.1965779e-13  0              2.9941459    
   1100000   9330           200            200            0.0026772343  -4.2276899e-06  0              0.0080359307   0.0078330573   0              756.46061      1.1965779e-13  0              2.9941248    
   1200000   9330           200            200            0.0026774548  -4.2309464e-06  0              0.0080365954   0.00040667709  0              39.273962      1.1965779e-13  0              2.9941247    
   1300000   9330           200            200            0.0026748592  -4.1108995e-06  0              0.0080286885   4.4357908e-05  0              4.2837693      1.1965779e-13  0              2.9941276    
   1400000   9330           200            200            0.0026755092  -4.1419143e-06  0              0.0080306695   1.9926448e-05  0              1.9243538      1.1965779e-13  0              2.9941268    
   1500000   9330           200            200            0.0026756892  -4.149997e-06   0              0.0080312176   7.2899325e-08  0              0.0070400951   1.1965779e-13  0              2.9941266    
   1600000   9330           200            200            0.0026755544  -4.1436977e-06  0              0.0080308068   2.8255143e-07  0              0.027286795    1.1965779e-13  0              2.9941268    
   1700000   9330           200            200            0.0026755654  -4.1442563e-06  0              0.0080308404   3.0827597e-08  0              0.0029771087   1.1965779e-13  0              2.9941268    
   1800000   9330           200            200            0.0026755807  -4.14496e-06    0              0.0080308871   6.6308472e-10  0              6.4035976e-05  1.1965779e-13  0              2.9941268    
   1900000   9330           200            200            0.0026755752  -4.1447004e-06  0              0.0080308703   9.2589243e-10  0              8.9416063e-05  1.1965779e-13  0              2.9941268    
   2000000   9330           200            200            0.0026755746  -4.1446734e-06  0              0.0080308684   2.0175091e-11  0              1.9483659e-06  1.1965779e-13  0              2.9941268    
   2100000   9330           200            200            0.0026755755  -4.1447155e-06  0              0.0080308712   8.579417e-12   0              8.2853869e-07  1.1965779e-13  0              2.9941268    
   2200000   9330           200            200            0.0026755753  -4.1447081e-06  0              0.0080308707   1.8851275e-12  0              1.8205212e-07  1.1965779e-13  0              2.9941268    
   2300000   9330           200            200            0.0026755752  -4.1447044e-06  0              0.0080308705   1.2816703e-15  0              1.2377455e-10  1.1965779e-13  0              2.9941268    
   2400000   9330           200            200            0.0026755753  -4.1447064e-06  0              0.0080308706   3.7913115e-14  0              3.6613773e-09  1.1965779e-13  0              2.9941268    
   2500000   9330           200            200            0.0026755753  -4.1447064e-06  0              0.0080308706   2.1425521e-15  0              2.0691234e-10  1.1965779e-13  0              2.9941268    
   2600000   9330           200            200            0.0026755753  -4.1447062e-06  0              0.0080308706   1.7908756e-16  0              1.7294995e-11  1.1965779e-13  0              2.9941268    
   2700000   9330           200            200            0.0026755753  -4.1447062e-06  0              0.0080308706   9.3096627e-17  0              8.9906058e-12  1.1965779e-13  0              2.9941268    
   2800000   9330           200            200            0.0026755753  -4.1447062e-06  0              0.0080308706   5.2504657e-20  0              5.070524e-15   1.1965779e-13  0              2.9941268    
   2900000   9330           200            200            0.0026755753  -4.1447062e-06  0              0.0080308706   5.9099189e-18  0              5.7073766e-13  1.1965779e-13  0              2.9941268    
   3000000   9330           200            200            0.0026755753  -4.1447055e-06  0              0.0080308706   3.0754363e-18  0              2.9700363e-13  1.1965779e-13  0              2.9941268    
Loop time of 296.721 on 4 procs for 3000000 steps with 2501 atoms

Performance: 8735478.904 ns/day, 0.000 hours/ns, 10110.508 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 11.051     | 35.791     | 61.346     | 409.7 | 12.06
Neigh   | 5.8111     | 5.9179     | 6.0274     |   4.0 |  1.99
Comm    | 22.232     | 40.535     | 77.611     | 341.1 | 13.66
Output  | 0.27197    | 0.2723     | 0.27267    |   0.1 |  0.09
Modify  | 109.09     | 157.45     | 178.54     | 225.6 | 53.06
Other   |            | 56.75      |            |       | 19.13

Nlocal:         625.25 ave         876 max         375 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:           1.75 ave           3 max           1 min
Histogram: 2 0 0 0 0 1 0 0 0 1
Neighs:         312.75 ave         626 max           0 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 1251
Ave neighs/atom = 0.50019992
Neighbor list builds = 166
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 23

#variable lat0 equal 1                    #
variable lat1 equal 3+(300*0.01)+(v_ind*0.01)  # .491+(v_ind*0.001)       # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 500*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 6.23                                                               
Lattice spacing in x,y,z = 6.23 6.23 6.23

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -4672.5 ${n1e1} -100 100 -100 100 units box
region box block -4672.5 4672.5 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -4672.5 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -4672.5 4672.5 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-4672.5 -100 -100) to (4672.5 100 100)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 1500 atoms
  using lattice units in orthogonal box = (-4672.5 -100 -100) to (4672.5 100 100)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 1500 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 1001 atoms
  using lattice units in orthogonal box = (-4672.5 -100 -100) to (4672.5 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  1500 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  1500 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  1001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  1001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
1500 atoms in group substrate
group slider1 region slider1
1001 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 1001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_23_*.dump id type diameter mass xu yu zu fx fy fz

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 6030 130 130
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 118 | 118 | 118 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   9345           200            200            0              0              0              0              0              0              0              1.1965779e-13  0              6            
    100000   9345           200            200            0.0021593161   8.644145e-36   0              0.0064779483   578438.84      0              5.5861483e+10  1.1965779e-13  0              3.331755     
    200000   9345           200            200            0.00073160677 -1.7288097e-35  0              0.0021948203   131376.42      0              1.2687395e+10  1.1965779e-13  0              3.0832029    
    300000   9345           200            200           -6.4748503e-06  3.2370506e-40  0             -1.9424551e-05  22.746679      0              2196711.4      1.1965779e-13  0              3.0439888    
    400000   9345           200            200           -3.0339093e-07  1.7288487e-35  0             -9.1017279e-07  0.034872724    0              3367.7581      1.1965779e-13  0              3.0056298    
    500000   9345           200            200            0.0020028816   0.0033602712   0              0.0026483735   568.0758       0              54860695       1.1965779e-13  0              2.9965861    
    600000   9345           200            200            0.0038672913   0.0063482863   0              0.0052535877   6.7597669      0              652809.9       1.1965779e-13  0              2.9952176    
    700000   9345           200            200            0.0041278058   0.0049406488   0              0.0074427686   18.700663      0              1805976.2      1.1965779e-13  0              2.9943656    
    800000   9345           200            200            0.0042277167   0.0044712141   0              0.0082119359   2.7440228      0              264998.08      1.1965779e-13  0              2.9940933    
    900000   9345           200            200            0.0042144078   0.0044763796   0              0.0081668437   5.6444847e-06  0              0.54510393     1.1965779e-13  0              2.9941064    
   1000000   9345           200            200            0.0041760682   0.0044846556   0              0.008043549    0.049491511    0              4779.5359      1.1965779e-13  0              2.9941484    
   1100000   9345           200            200            0.004164801    0.0044874938   0              0.0080069093   0.0060214681   0              581.51029      1.1965779e-13  0              2.9941613    
   1200000   9345           200            200            0.0041659894   0.0044872197   0              0.0080107484   9.2167398e-06  0              0.89008676     1.1965779e-13  0              2.99416      
   1300000   9345           200            200            0.0041679204   0.0044867355   0              0.0080170257   0.00013279223  0              12.824124      1.1965779e-13  0              2.9941579    
   1400000   9345           200            200            0.0041684312   0.0044866047   0              0.008018689    1.2907182e-05  0              1.2464832      1.1965779e-13  0              2.9941573    
   1500000   9345           200            200            0.004168348    0.0044866242   0              0.0080184197   9.407467e-08   0              0.0090850583   1.1965779e-13  0              2.9941574    
   1600000   9345           200            200            0.0041682502   0.0044866486   0              0.0080181019   3.4942153e-07  0              0.033744631    1.1965779e-13  0              2.9941575    
   1700000   9345           200            200            0.0041682274   0.0044866545   0              0.0080180278   2.6870138e-08  0              0.0025949256   1.1965779e-13  0              2.9941575    
   1800000   9345           200            200            0.0041682327   0.0044866532   0              0.008018045    5.2007119e-10  0              5.0224753e-05  1.1965779e-13  0              2.9941575    
   1900000   9345           200            200            0.0041682376   0.004486652    0              0.0080180609   9.0184942e-10  0              8.7094161e-05  1.1965779e-13  0              2.9941575    
   2000000   9345           200            200            0.0041682386   0.0044866517   0              0.0080180641   5.4079508e-11  0              5.2226118e-06  1.1965779e-13  0              2.9941575    
   2100000   9345           200            200            0.0041682383   0.0044866518   0              0.0080180631   2.2408506e-12  0              2.1640531e-07  1.1965779e-13  0              2.9941575    
   2200000   9345           200            200            0.0041682381   0.0044866519   0              0.0080180623   2.2855045e-12  0              2.2071766e-07  1.1965779e-13  0              2.9941575    
   2300000   9345           200            200            0.004168238    0.0044866519   0              0.0080180622   1.0466193e-13  0              1.01075e-08    1.1965779e-13  0              2.9941575    
   2400000   9345           200            200            0.004168238    0.0044866519   0              0.0080180622   8.5655994e-15  0              8.2720428e-10  1.1965779e-13  0              2.9941575    
   2500000   9345           200            200            0.004168238    0.0044866519   0              0.0080180623   5.6917961e-15  0              5.4967293e-10  1.1965779e-13  0              2.9941575    
   2600000   9345           200            200            0.004168238    0.0044866519   0              0.0080180623   1.8806277e-16  0              1.8161756e-11  1.1965779e-13  0              2.9941575    
   2700000   9345           200            200            0.004168238    0.0044866519   0              0.0080180623   3.7361855e-17  0              3.6081405e-12  1.1965779e-13  0              2.9941575    
   2800000   9345           200            200            0.004168238    0.0044866519   0              0.0080180623   1.2212941e-17  0              1.1794385e-12  1.1965779e-13  0              2.9941575    
   2900000   9345           200            200            0.004168238    0.0044866519   0              0.0080180623   8.6411261e-19  0              8.344981e-14   1.1965779e-13  0              2.9941575    
   3000000   9345           200            200            0.004168238    0.0044866519   0              0.0080180623   3.2155852e-18  0              3.105382e-13   1.1965779e-13  0              2.9941575    
Loop time of 297.425 on 4 procs for 3000000 steps with 2501 atoms

Performance: 8714808.451 ns/day, 0.000 hours/ns, 10086.584 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 11.129     | 35.974     | 61.624     | 411.5 | 12.10
Neigh   | 5.816      | 5.9202     | 6.0261     |   4.0 |  1.99
Comm    | 22.091     | 40.544     | 77.977     | 344.3 | 13.63
Output  | 0.27053    | 0.27085    | 0.27118    |   0.1 |  0.09
Modify  | 109.31     | 157.83     | 179.01     | 226.1 | 53.07
Other   |            | 56.88      |            |       | 19.13

Nlocal:         625.25 ave         876 max         375 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:           1.75 ave           3 max           1 min
Histogram: 2 0 0 0 0 1 0 0 0 1
Neighs:         312.75 ave         626 max           0 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 1251
Ave neighs/atom = 0.50019992
Neighbor list builds = 166
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 24

#variable lat0 equal 1                    #
variable lat1 equal 3+(300*0.01)+(v_ind*0.01)  # .491+(v_ind*0.001)       # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 500*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 6.24                                                               
Lattice spacing in x,y,z = 6.24 6.24 6.24

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -4680 ${n1e1} -100 100 -100 100 units box
region box block -4680 4680 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -4680 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -4680 4680 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-4680 -100 -100) to (4680 100 100)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 1500 atoms
  using lattice units in orthogonal box = (-4680 -100 -100) to (4680 100 100)
  create_atoms CPU = 0.000 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 1500 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 1001 atoms
  using lattice units in orthogonal box = (-4680 -100 -100) to (4680 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  1500 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  1500 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  1001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  1001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
1500 atoms in group substrate
group slider1 region slider1
1001 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 1001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_24_*.dump id type diameter mass xu yu zu fx fy fz

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 6039 130 130
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 118.2 | 118.2 | 118.2 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   9360           200            200            0              0              0              0              0              0              0              1.1965779e-13  0              6            
    100000   9360           200            200            0.0021563113  -2.5890785e-35  0              0.006468934    578627.01      0              5.5879655e+10  1.1965779e-13  0              3.3315701    
    200000   9360           200            200            0.00073133116  2.1575748e-36  0              0.0021939935   131629.47      0              1.2711832e+10  1.1965779e-13  0              3.083006     
    300000   9360           200            200           -4.0331521e-06 -8.6301786e-36  0             -1.2099456e-05  8.7214335      0              842253.62      1.1965779e-13  0              3.0440654    
    400000   9360           200            200           -2.9914451e-07  2.589088e-35   0             -8.9743353e-07  0.033828066    0              3266.8725      1.1965779e-13  0              3.0056476    
    500000   9360           200            200            0.00044583061  3.0911014e-06  0              0.0013344007   4.3002323      0              415285.65      1.1965779e-13  0              2.9973945    
    600000   9360           200            200            0.0023643208   0.00016476871  0              0.0069281936   168.94841      0              16315828       1.1965779e-13  0              2.9946636    
    700000   9360           200            200            0.0026402335   0.00015102363  0              0.0077696767   24.896386      0              2404314.7      1.1965779e-13  0              2.9943701    
    800000   9360           200            200            0.0026923381   0.00015162933  0              0.0079253849   3.3828017      0              326686.77      1.1965779e-13  0              2.9943193    
    900000   9360           200            200            0.0027090468   0.00015181632  0              0.007975324    0.45536968     0              43976.344      1.1965779e-13  0              2.9943033    
   1000000   9360           200            200            0.002715275    0.00015188557  0              0.0079939394   0.061176951    0              5908.0321      1.1965779e-13  0              2.9942973    
   1100000   9360           200            200            0.0027176668   0.0001519122   0              0.0080010881   0.0082128691   0              793.14011      1.1965779e-13  0              2.994295     
   1200000   9360           200            200            0.0027185899   0.00015192252  0              0.0080038471   0.0011020875   0              106.43173      1.1965779e-13  0              2.9942941    
   1300000   9360           200            200            0.002718946    0.00015192652  0              0.0080049114   0.0001478396   0              14.27729       1.1965779e-13  0              2.9942938    
   1400000   9360           200            200            0.0027190831   0.00015192806  0              0.0080053213   1.982587e-05   0              1.9146406      1.1965779e-13  0              2.9942937    
   1500000   9360           200            200            0.0027191358   0.00015192866  0              0.0080054788   2.6579388e-06  0              0.2566847      1.1965779e-13  0              2.9942936    
   1600000   9360           200            200            0.002719156    0.00015192889  0              0.0080055392   3.5622987e-07  0              0.034402131    1.1965779e-13  0              2.9942936    
   1700000   9360           200            200            0.0027191638   0.00015192898  0              0.0080055623   4.7729634e-08  0              0.0046093864   1.1965779e-13  0              2.9942936    
   1800000   9360           200            200            0.0027191667   0.00015192901  0              0.0080055711   6.3932401e-09  0              0.00061741337  1.1965779e-13  0              2.9942936    
   1900000   9360           200            200            0.0027191678   0.00015192903  0              0.0080055745   8.5611528e-10  0              8.2677486e-05  1.1965779e-13  0              2.9942936    
   2000000   9360           200            200            0.0027191683   0.00015192903  0              0.0080055758   1.1460003e-10  0              1.1067251e-05  1.1965779e-13  0              2.9942936    
   2100000   9360           200            200            0.0027191684   0.00015192903  0              0.0080055763   1.5336392e-11  0              1.481079e-06   1.1965779e-13  0              2.9942936    
   2200000   9360           200            200            0.0027191685   0.00015192903  0              0.0080055765   2.0511096e-12  0              1.9808148e-07  1.1965779e-13  0              2.9942936    
   2300000   9360           200            200            0.0027191685   0.00015192903  0              0.0080055765   2.7465385e-13  0              2.6524103e-08  1.1965779e-13  0              2.9942936    
   2400000   9360           200            200            0.0027191685   0.00015192903  0              0.0080055765   3.6843883e-14  0              3.5581185e-09  1.1965779e-13  0              2.9942936    
   2500000   9360           200            200            0.0027191685   0.00015192903  0              0.0080055766   4.9328017e-15  0              4.7637468e-10  1.1965779e-13  0              2.9942936    
   2600000   9360           200            200            0.0027191685   0.00015192903  0              0.0080055766   6.6825572e-16  0              6.4535354e-11  1.1965779e-13  0              2.9942936    
   2700000   9360           200            200            0.0027191685   0.00015192903  0              0.0080055766   7.86012e-17    0              7.5907413e-12  1.1965779e-13  0              2.9942936    
   2800000   9360           200            200            0.0027191685   0.00015192903  0              0.0080055766   6.9337552e-18  0              6.6961245e-13  1.1965779e-13  0              2.9942936    
   2900000   9360           200            200            0.0027191685   0.00015192903  0              0.0080055766   2.1304651e-18  0              2.0574507e-13  1.1965779e-13  0              2.9942936    
   3000000   9360           200            200            0.0027191685   0.00015192903  0              0.0080055766   1.0533583e-18  0              1.017258e-13   1.1965779e-13  0              2.9942936    
Loop time of 298.346 on 4 procs for 3000000 steps with 2501 atoms

Performance: 8687892.722 ns/day, 0.000 hours/ns, 10055.431 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 11.032     | 35.589     | 61.119     | 408.1 | 11.93
Neigh   | 5.8057     | 5.904      | 6.0028     |   3.6 |  1.98
Comm    | 21.756     | 40.405     | 77.673     | 343.8 | 13.54
Output  | 0.27383    | 0.27415    | 0.27449    |   0.1 |  0.09
Modify  | 110.14     | 158.84     | 179.92     | 226.8 | 53.24
Other   |            | 57.33      |            |       | 19.22

Nlocal:         625.25 ave         876 max         375 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:           1.75 ave           3 max           1 min
Histogram: 2 0 0 0 0 1 0 0 0 1
Neighs:         313.25 ave         627 max           0 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 1253
Ave neighs/atom = 0.5009996
Neighbor list builds = 166
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 25

#variable lat0 equal 1                    #
variable lat1 equal 3+(300*0.01)+(v_ind*0.01)  # .491+(v_ind*0.001)       # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 500*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 6.25                                                               
Lattice spacing in x,y,z = 6.25 6.25 6.25

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -4687.5 ${n1e1} -100 100 -100 100 units box
region box block -4687.5 4687.5 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -4687.5 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -4687.5 4687.5 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-4687.5 -100 -100) to (4687.5 100 100)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 1500 atoms
  using lattice units in orthogonal box = (-4687.5 -100 -100) to (4687.5 100 100)
  create_atoms CPU = 0.000 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 1500 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 1001 atoms
  using lattice units in orthogonal box = (-4687.5 -100 -100) to (4687.5 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  1500 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  1500 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  1001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  1001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
1500 atoms in group substrate
group slider1 region slider1
1001 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 1001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_25_*.dump id type diameter mass xu yu zu fx fy fz

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 6049 130 130
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 118.4 | 118.4 | 118.4 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   9375           200            200            0              0              0              0              0              0              0              1.1965779e-13  0              6            
    100000   9375           200            200            0.0021521403   5.3852924e-37  0              0.0064564209   578302.79      0              5.5848344e+10  1.1965779e-13  0              3.3320754    
    200000   9375           200            200            0.00072993053 -8.6164346e-36  0              0.0021897916   131559.52      0              1.2705077e+10  1.1965779e-13  0              3.0831659    
    300000   9375           200            200           -6.1904362e-07  8.616486e-35   0             -1.8571309e-06  0.17517745     0              16917.385      1.1965779e-13  0              3.0439719    
    400000   9375           200            200           -5.5383919e-05 -1.7232677e-35  0             -0.00016615176  1946.6074      0              1.8798941e+08  1.1965779e-13  0              3.0037371    
    500000   9375           200            200            0.00084772496 -5.1698639e-35  0              0.0025431749   322.88478      0              31181901       1.1965779e-13  0              2.9974909    
    600000   9375           200            200            0.0018462335   3.446601e-35   0              0.0055387004   0.2239875      0              21631.11       1.1965779e-13  0              2.9958594    
    700000   9375           200            200            0.0025461709   5.1698935e-35  0              0.0076385128   20.704108      0              1999454.6      1.1965779e-13  0              2.9948758    
    800000   9375           200            200            0.0027500211  -2.5849281e-35  0              0.0082500632   1.5265947      0              147427.59      1.1965779e-13  0              2.994599     
    900000   9375           200            200            0.00270197    -1.2924583e-35  0              0.0081059101   0.094728879    0              9148.2371      1.1965779e-13  0              2.9946595    
   1000000   9375           200            200            0.0026623955  -8.6163479e-36  0              0.0079871864   0.05900513     0              5698.2931      1.1965779e-13  0              2.994712     
   1100000   9375           200            200            0.0026590389   1.1828643e-40  0              0.0079771167   0.00036071157  0              34.834942      1.1965779e-13  0              2.9947168    
   1200000   9375           200            200            0.0026635347   3.2312923e-36  0              0.007990604    0.00078748639  0              76.049798      1.1965779e-13  0              2.9947109    
   1300000   9375           200            200            0.0026651086   1.1787015e-40  0              0.0079953259   9.1190354e-05  0              8.8065116      1.1965779e-13  0              2.9947088    
   1400000   9375           200            200            0.0026648934   1.1813836e-40  0              0.0079946801   1.9920474e-06  0              0.19237768     1.1965779e-13  0              2.9947091    
   1500000   9375           200            200            0.0026646273  -8.6163464e-36  0              0.0079938819   2.6904653e-06  0              0.25982588     1.1965779e-13  0              2.9947094    
   1600000   9375           200            200            0.0026645902   1.1840484e-40  0              0.0079937705   4.7408685e-08  0              0.0045783914   1.1965779e-13  0              2.9947095    
   1700000   9375           200            200            0.0026646168  -8.6163467e-36  0              0.0079938505   2.7961104e-08  0              0.0027002833   1.1965779e-13  0              2.9947095    
   1800000   9375           200            200            0.0026646285  -1.7232812e-35  0              0.0079938854   5.0423609e-09  0              0.00048695512  1.1965779e-13  0              2.9947094    
   1900000   9375           200            200            0.0026646278   1.7233047e-35  0              0.0079938833   2.3986299e-11  0              2.3164251e-06  1.1965779e-13  0              2.9947094    
   2000000   9375           200            200            0.002664626   -8.6163466e-36  0              0.0079938781   1.1672326e-10  0              1.1272297e-05  1.1965779e-13  0              2.9947094    
   2100000   9375           200            200            0.0026646257   3.4465977e-35  0              0.0079938771   4.1146945e-12  0              3.9736774e-07  1.1965779e-13  0              2.9947094    
   2200000   9375           200            200            0.0026646258   1.7233048e-35  0              0.0079938775   9.0972396e-13  0              8.7854629e-08  1.1965779e-13  0              2.9947094    
   2300000   9375           200            200            0.0026646259  -3.4465741e-35  0              0.0079938778   2.6129574e-13  0              2.5234073e-08  1.1965779e-13  0              2.9947094    
   2400000   9375           200            200            0.0026646259  -1.7232811e-35  0              0.0079938778   1.2696932e-18  0              1.2261788e-13  1.1965779e-13  0              2.9947094    
   2500000   9375           200            200            0.0026646259   8.6164765e-35  0              0.0079938777   4.8292172e-15  0              4.6637123e-10  1.1965779e-13  0              2.9947094    
   2600000   9375           200            200            0.0026646259   1.7233048e-35  0              0.0079938777   2.767295e-16   0              2.6724555e-11  1.1965779e-13  0              2.9947094    
   2700000   9375           200            200            0.0026646259   1.7233048e-35  0              0.0079938777   3.7322517e-17  0              3.6043416e-12  1.1965779e-13  0              2.9947094    
   2800000   9375           200            200            0.0026646259   1.7233047e-35  0              0.0079938777   1.1507772e-17  0              1.1113382e-12  1.1965779e-13  0              2.9947094    
   2900000   9375           200            200            0.0026646259   6.8931837e-35  0              0.0079938777   6.3058764e-18  0              6.0897641e-13  1.1965779e-13  0              2.9947094    
   3000000   9375           200            200            0.0026646259   3.4465971e-35  0              0.0079938777   2.0851074e-18  0              2.0136474e-13  1.1965779e-13  0              2.9947094    
Loop time of 294.767 on 4 procs for 3000000 steps with 2501 atoms

Performance: 8793397.612 ns/day, 0.000 hours/ns, 10177.544 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 11.058     | 35.253     | 60.39      | 404.3 | 11.96
Neigh   | 5.848      | 5.9548     | 6.0637     |   4.0 |  2.02
Comm    | 22.16      | 40.283     | 76.597     | 335.4 | 13.67
Output  | 0.26844    | 0.26875    | 0.26908    |   0.1 |  0.09
Modify  | 108.96     | 156.56     | 177.57     | 222.9 | 53.11
Other   |            | 56.45      |            |       | 19.15

Nlocal:         625.25 ave         876 max         375 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:           1.75 ave           3 max           1 min
Histogram: 2 0 0 0 0 1 0 0 0 1
Neighs:         320.25 ave         641 max           0 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 1281
Ave neighs/atom = 0.51219512
Neighbor list builds = 166
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 26

#variable lat0 equal 1                    #
variable lat1 equal 3+(300*0.01)+(v_ind*0.01)  # .491+(v_ind*0.001)       # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 500*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 6.26                                                               
Lattice spacing in x,y,z = 6.26 6.26 6.26

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -4695 ${n1e1} -100 100 -100 100 units box
region box block -4695 4695 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -4695 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -4695 4695 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-4695 -100 -100) to (4695 100 100)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 1500 atoms
  using lattice units in orthogonal box = (-4695 -100 -100) to (4695 100 100)
  create_atoms CPU = 0.000 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 1500 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 1001 atoms
  using lattice units in orthogonal box = (-4695 -100 -100) to (4695 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  1500 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  1500 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  1001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  1001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
1500 atoms in group substrate
group slider1 region slider1
1001 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 1001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_26_*.dump id type diameter mass xu yu zu fx fy fz

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 6059 130 130
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 118.5 | 118.5 | 118.5 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   9390           200            200            0              0              0              0              0              0              0              1.1965779e-13  0              6            
    100000   9390           200            200            0.0021482507   9.2825153e-41  0              0.0064447521   578150.98      0              5.5833683e+10  1.1965779e-13  0              3.3319718    
    200000   9390           200            200            0.00072619123  3.4410924e-35  0              0.0021785737   130834.19      0              1.2635029e+10  1.1965779e-13  0              3.0836743    
    300000   9390           200            200           -7.8662249e-06  1.7205453e-35  0             -2.3598675e-05  34.101151      0              3293245        1.1965779e-13  0              3.0438357    
    400000   9390           200            200           -1.0601376e-05 -1.8925903e-34  0             -3.1804127e-05  64.151877      0              6195329.1      1.1965779e-13  0              3.0054616    
    500000   9390           200            200            0.0015853679   0.0020196905   0              0.0027364131   565.34305      0              54596785       1.1965779e-13  0              2.9965063    
    600000   9390           200            200            0.0038721148   0.0036078625   0              0.0080084821   191.10553      0              18455604       1.1965779e-13  0              2.9941193    
    700000   9390           200            200            0.0036958844   0.0035001095   0              0.0075875437   22.127691      0              2136934        1.1965779e-13  0              2.994249     
    800000   9390           200            200            0.0039348222   0.0035063915   0              0.0082980751   1.1370635      0              109809.45      1.1965779e-13  0              2.9939937    
    900000   9390           200            200            0.0037881796   0.0035255528   0              0.0078389858   0.00071490165  0              69.040084      1.1965779e-13  0              2.9941614    
   1000000   9390           200            200            0.0038489599   0.0035278139   0              0.0080190657   0.025534474    0              2465.9368      1.1965779e-13  0              2.9940942    
   1100000   9390           200            200            0.0038341664   0.0035270376   0              0.0079754617   0.0080132323   0              773.86062      1.1965779e-13  0              2.9941107    
   1200000   9390           200            200            0.0038345295   0.0035270624   0              0.0079765261   0.0009386439   0              90.64751       1.1965779e-13  0              2.9941102    
   1300000   9390           200            200            0.0038363119   0.003527145    0              0.0079817908   3.3409241e-05  0              3.2264254      1.1965779e-13  0              2.9941083    
   1400000   9390           200            200            0.0038352243   0.0035270933   0              0.0079785798   5.8513772e-07  0              0.056508413    1.1965779e-13  0              2.9941095    
   1500000   9390           200            200            0.0038356177   0.0035271122   0              0.0079797411   1.502215e-06   0              0.14507317     1.1965779e-13  0              2.994109     
   1600000   9390           200            200            0.0038355352   0.0035271081   0              0.0079794974   3.7351778e-07  0              0.036071674    1.1965779e-13  0              2.9941091    
   1700000   9390           200            200            0.0038355302   0.0035271079   0              0.0079794828   3.6425983e-08  0              0.0035177607   1.1965779e-13  0              2.9941091    
   1800000   9390           200            200            0.0038355442   0.0035271086   0              0.0079795242   8.2857314e-10  0              8.0017663e-05  1.1965779e-13  0              2.9941091    
   1900000   9390           200            200            0.0038355367   0.0035271082   0              0.007979502    8.0500267e-11  0              7.7741396e-06  1.1965779e-13  0              2.9941091    
   2000000   9390           200            200            0.0038355392   0.0035271083   0              0.0079795093   8.3049705e-11  0              8.020346e-06   1.1965779e-13  0              2.9941091    
   2100000   9390           200            200            0.0038355388   0.0035271083   0              0.0079795081   1.6816555e-11  0              1.6240225e-06  1.1965779e-13  0              2.9941091    
   2200000   9390           200            200            0.0038355387   0.0035271083   0              0.0079795078   1.3469342e-12  0              1.3007727e-07  1.1965779e-13  0              2.9941091    
   2300000   9390           200            200            0.0038355388   0.0035271083   0              0.0079795081   1.5090801e-14  0              1.4573615e-09  1.1965779e-13  0              2.9941091    
   2400000   9390           200            200            0.0038355388   0.0035271083   0              0.007979508    7.0865432e-15  0              6.8436762e-10  1.1965779e-13  0              2.9941091    
   2500000   9390           200            200            0.0038355388   0.0035271083   0              0.007979508    4.3756207e-15  0              4.2256613e-10  1.1965779e-13  0              2.9941091    
   2600000   9390           200            200            0.0038355388   0.0035271083   0              0.007979508    7.2447313e-16  0              6.9964429e-11  1.1965779e-13  0              2.9941091    
   2700000   9390           200            200            0.0038355388   0.0035271083   0              0.007979508    2.8555276e-17  0              2.7576642e-12  1.1965779e-13  0              2.9941091    
   2800000   9390           200            200            0.0038355388   0.0035271083   0              0.007979508    2.6094737e-19  0              2.5200429e-14  1.1965779e-13  0              2.9941091    
   2900000   9390           200            200            0.0038355388   0.0035271083   0              0.007979508    1.0229094e-18  0              9.878527e-14   1.1965779e-13  0              2.9941091    
   3000000   9390           200            200            0.0038355388   0.0035271083   0              0.007979508    5.7783903e-18  0              5.5803558e-13  1.1965779e-13  0              2.9941091    
Loop time of 297.65 on 4 procs for 3000000 steps with 2501 atoms

Performance: 8708200.316 ns/day, 0.000 hours/ns, 10078.936 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 11.186     | 35.735     | 60.812     | 410.2 | 12.01
Neigh   | 5.8977     | 6.0005     | 6.1051     |   3.8 |  2.02
Comm    | 21.938     | 41.923     | 79.718     | 344.3 | 14.08
Output  | 0.33939    | 0.3397     | 0.34004    |   0.1 |  0.11
Modify  | 109.11     | 157.37     | 177.28     | 223.9 | 52.87
Other   |            | 56.28      |            |       | 18.91

Nlocal:         625.25 ave         876 max         375 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:           1.75 ave           3 max           1 min
Histogram: 2 0 0 0 0 1 0 0 0 1
Neighs:         312.25 ave         625 max           0 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 1249
Ave neighs/atom = 0.49940024
Neighbor list builds = 166
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 27

#variable lat0 equal 1                    #
variable lat1 equal 3+(300*0.01)+(v_ind*0.01)  # .491+(v_ind*0.001)       # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 500*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 6.27                                                               
Lattice spacing in x,y,z = 6.27 6.27 6.27

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -4702.5 ${n1e1} -100 100 -100 100 units box
region box block -4702.5 4702.5 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -4702.5 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -4702.5 4702.5 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-4702.5 -100 -100) to (4702.5 100 100)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 1500 atoms
  using lattice units in orthogonal box = (-4702.5 -100 -100) to (4702.5 100 100)
  create_atoms CPU = 0.000 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 1500 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 1001 atoms
  using lattice units in orthogonal box = (-4702.5 -100 -100) to (4702.5 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  1500 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  1500 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  1001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  1001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
1500 atoms in group substrate
group slider1 region slider1
1001 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 1001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_27_*.dump id type diameter mass xu yu zu fx fy fz

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 6068 130 130
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 118.7 | 118.7 | 118.7 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   9405           200            200            0              0              0              0              0              0              0              1.1965779e-13  0              6            
    100000   9405           200            200            0.0021451628  -4.2944872e-35  0              0.0064354885   578285.59      0              5.5846683e+10  1.1965779e-13  0              3.3318808    
    200000   9405           200            200            0.00072598527  7.31854e-41    0              0.0021779558   131104.56      0              1.266114e+10   1.1965779e-13  0              3.0834477    
    300000   9405           200            200           -6.6979345e-06 -6.8711492e-35  0             -2.0093803e-05  24.68555       0              2383953.7      1.1965779e-13  0              3.0439053    
    400000   9405           200            200           -1.0647169e-05 -1.1165667e-34  0             -3.1941506e-05  64.924391      0              6269933        1.1965779e-13  0              3.0055089    
    500000   9405           200            200            0.00012857589 -0.0026968554   0              0.003082583    696.12395      0              67226668       1.1965779e-13  0              2.9963527    
    600000   9405           200            200            0.0010325758  -0.0040027959   0              0.0071005233   171.94638      0              16605351       1.1965779e-13  0              2.9945133    
    700000   9405           200            200            0.0013400632  -0.0038727771   0              0.0078929667   25.587642      0              2471071.3      1.1965779e-13  0              2.9941808    
    800000   9405           200            200            0.0014534942  -0.0038793573   0              0.00823984     1.7724996      0              171175.32      1.1965779e-13  0              2.9940626    
    900000   9405           200            200            0.0013124125  -0.0038889308   0              0.0078261683   4.9197728e-05  0              4.7511644      1.1965779e-13  0              2.9942131    
   1000000   9405           200            200            0.0013695854  -0.0038930729   0              0.0080018292   0.033694367    0              3253.9608      1.1965779e-13  0              2.9941476    
   1100000   9405           200            200            0.001358738   -0.0038921287   0              0.0079683427   0.0084103582   0              812.21219      1.1965779e-13  0              2.9941604    
   1200000   9405           200            200            0.0013565084  -0.0038919605   0              0.0079614858   0.00046326743  0              44.739053      1.1965779e-13  0              2.9941628    
   1300000   9405           200            200            0.0013590997  -0.0038921683   0              0.0079694674   2.2852163e-06  0              0.22068984     1.1965779e-13  0              2.9941598    
   1400000   9405           200            200            0.0013580935  -0.0038920858   0              0.0079663664   1.34458e-05    0              1.2984991      1.1965779e-13  0              2.994161     
   1500000   9405           200            200            0.0013582516  -0.0038920993   0              0.007966854    2.7097677e-06  0              0.26168997     1.1965779e-13  0              2.9941608    
   1600000   9405           200            200            0.0013583076  -0.0038921036   0              0.0079670264   1.1277328e-07  0              0.010890837    1.1965779e-13  0              2.9941607    
   1700000   9405           200            200            0.001358258   -0.0038920996   0              0.0079668736   2.7727711e-09  0              0.00026777439  1.1965779e-13  0              2.9941608    
   1800000   9405           200            200            0.0013582755  -0.003892101    0              0.0079669274   5.1658591e-09  0              0.0004988817   1.1965779e-13  0              2.9941608    
   1900000   9405           200            200            0.0013582733  -0.0038921008   0              0.0079669209   8.5020939e-10  0              8.2107138e-05  1.1965779e-13  0              2.9941608    
   2000000   9405           200            200            0.0013582721  -0.0038921007   0              0.0079669169   2.5150154e-11  0              2.4288219e-06  1.1965779e-13  0              2.9941608    
   2100000   9405           200            200            0.001358273   -0.0038921008   0              0.0079669198   1.970531e-12   0              1.9029978e-07  1.1965779e-13  0              2.9941608    
   2200000   9405           200            200            0.0013582727  -0.0038921008   0              0.0079669189   1.9180785e-12  0              1.8523429e-07  1.1965779e-13  0              2.9941608    
   2300000   9405           200            200            0.0013582727  -0.0038921008   0              0.007966919    2.5924633e-13  0              2.5036155e-08  1.1965779e-13  0              2.9941608    
   2400000   9405           200            200            0.0013582728  -0.0038921008   0              0.0079669191   4.8937364e-15  0              4.7260203e-10  1.1965779e-13  0              2.9941608    
   2500000   9405           200            200            0.0013582727  -0.0038921008   0              0.007966919    1.1213642e-15  0              1.0829333e-10  1.1965779e-13  0              2.9941608    
   2600000   9405           200            200            0.0013582727  -0.0038921008   0              0.007966919    6.7263896e-16  0              6.4958656e-11  1.1965779e-13  0              2.9941608    
   2700000   9405           200            200            0.0013582727  -0.0038921008   0              0.007966919    6.3189594e-17  0              6.1023987e-12  1.1965779e-13  0              2.9941608    
   2800000   9405           200            200            0.0013582727  -0.0038921008   0              0.007966919    1.0839413e-20  0              1.0467929e-15  1.1965779e-13  0              2.9941608    
   2900000   9405           200            200            0.0013582727  -0.0038921008   0              0.007966919    2.7949871e-20  0              2.6991985e-15  1.1965779e-13  0              2.9941608    
   3000000   9405           200            200            0.0013582727  -0.0038921008   0              0.007966919    2.0771789e-18  0              2.0059907e-13  1.1965779e-13  0              2.9941608    
Loop time of 299.836 on 4 procs for 3000000 steps with 2501 atoms

Performance: 8644724.870 ns/day, 0.000 hours/ns, 10005.469 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 11.054     | 36.141     | 61.829     | 413.4 | 12.05
Neigh   | 5.8716     | 5.9773     | 6.0851     |   3.9 |  1.99
Comm    | 22.359     | 40.718     | 78.089     | 342.9 | 13.58
Output  | 0.27376    | 0.27409    | 0.27442    |   0.1 |  0.09
Modify  | 109.59     | 158.82     | 180.83     | 229.3 | 52.97
Other   |            | 57.91      |            |       | 19.31

Nlocal:         625.25 ave         876 max         375 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:           1.75 ave           3 max           1 min
Histogram: 2 0 0 0 0 1 0 0 0 1
Neighs:         313.25 ave         627 max           0 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 1253
Ave neighs/atom = 0.5009996
Neighbor list builds = 166
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 28

#variable lat0 equal 1                    #
variable lat1 equal 3+(300*0.01)+(v_ind*0.01)  # .491+(v_ind*0.001)       # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 500*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 6.28                                                               
Lattice spacing in x,y,z = 6.28 6.28 6.28

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -4710 ${n1e1} -100 100 -100 100 units box
region box block -4710 4710 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -4710 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -4710 4710 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-4710 -100 -100) to (4710 100 100)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 1500 atoms
  using lattice units in orthogonal box = (-4710 -100 -100) to (4710 100 100)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 1500 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 1001 atoms
  using lattice units in orthogonal box = (-4710 -100 -100) to (4710 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  1500 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  1500 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  1001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  1001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
1500 atoms in group substrate
group slider1 region slider1
1001 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 1001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_28_*.dump id type diameter mass xu yu zu fx fy fz

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 6078 130 130
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 118.8 | 118.9 | 118.9 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   9420           200            200            0              0              0              0              0              0              0              1.1965779e-13  0              6            
    100000   9420           200            200            0.0021420993  -6.4314718e-36  0              0.0064262979   578429.45      0              5.5860576e+10  1.1965779e-13  0              3.3317578    
    200000   9420           200            200            0.00072556111  1.7150768e-35  0              0.0021766833   131312.29      0              1.2681201e+10  1.1965779e-13  0              3.0832851    
    300000   9420           200            200           -5.4581635e-06  1.4215719e-39  0             -1.637449e-05   16.34411       0              1578397.2      1.1965779e-13  0              3.043978     
    400000   9420           200            200           -5.5558903e-06  1.0290377e-33  0             -1.6667671e-05  17.388636      0              1679270        1.1965779e-13  0              3.0055926    
    500000   9420           200            200            0.00090048023  0.00075772437  0              0.0019437163   202.67153      0              19572566       1.1965779e-13  0              2.9970941    
    600000   9420           200            200            0.0040825298   0.0022345222   0              0.010013067    100.04504      0              9661634.2      1.1965779e-13  0              2.9934647    
    700000   9420           200            200            0.0031353525   0.002455986    0              0.0069500714   1.2701519      0              122662.17      1.1965779e-13  0              2.994562     
    800000   9420           200            200            0.0035717037   0.0024196179   0              0.0082954932   0.72498082     0              70013.459      1.1965779e-13  0              2.994054     
    900000   9420           200            200            0.0034374036   0.0024081669   0              0.007904044    0.40244443     0              38865.202      1.1965779e-13  0              2.9942004    
   1000000   9420           200            200            0.0034483171   0.0024091699   0              0.0079357813   0.055065676    0              5317.8489      1.1965779e-13  0              2.9941874    
   1100000   9420           200            200            0.0034604406   0.0024101481   0              0.0079711737   0.0018594697   0              179.57428      1.1965779e-13  0              2.9941746    
   1200000   9420           200            200            0.0034523314   0.0024094767   0              0.0079475174   6.4377149e-05  0              6.2170842      1.1965779e-13  0              2.9941834    
   1300000   9420           200            200            0.0034551447   0.0024097129   0              0.0079557212   0.00010440212  0              10.082409      1.1965779e-13  0              2.9941803    
   1400000   9420           200            200            0.0034546954   0.0024096738   0              0.0079544122   2.0445794e-05  0              1.9745084      1.1965779e-13  0              2.9941808    
   1500000   9420           200            200            0.0034545622   0.0024096634   0              0.0079540233   1.2136289e-06  0              0.1172036      1.1965779e-13  0              2.9941809    
   1600000   9420           200            200            0.0034546959   0.0024096744   0              0.0079544132   3.3518555e-11  0              3.2369821e-06  1.1965779e-13  0              2.9941808    
   1700000   9420           200            200            0.0034546405   0.0024096698   0              0.0079542518   2.3044946e-08  0              0.0022255159   1.1965779e-13  0              2.9941808    
   1800000   9420           200            200            0.0034546529   0.0024096708   0              0.0079542878   6.8036397e-09  0              0.00065704682  1.1965779e-13  0              2.9941808    
   1900000   9420           200            200            0.0034546536   0.0024096709   0              0.0079542898   6.1316903e-10  0              5.9215476e-05  1.1965779e-13  0              2.9941808    
   2000000   9420           200            200            0.0034546515   0.0024096707   0              0.0079542838   6.0201722e-12  0              5.8138514e-07  1.1965779e-13  0              2.9941808    
   2100000   9420           200            200            0.0034546525   0.0024096708   0              0.0079542869   3.9814672e-12  0              3.845016e-07   1.1965779e-13  0              2.9941808    
   2200000   9420           200            200            0.0034546523   0.0024096708   0              0.007954286    2.0306849e-12  0              1.9610901e-07  1.1965779e-13  0              2.9941808    
   2300000   9420           200            200            0.0034546523   0.0024096708   0              0.0079542861   2.6263128e-13  0              2.5363049e-08  1.1965779e-13  0              2.9941808    
   2400000   9420           200            200            0.0034546523   0.0024096708   0              0.0079542861   7.9248134e-15  0              7.6532176e-10  1.1965779e-13  0              2.9941808    
   2500000   9420           200            200            0.0034546523   0.0024096708   0              0.0079542861   4.2300205e-16  0              4.0850511e-11  1.1965779e-13  0              2.9941808    
   2600000   9420           200            200            0.0034546523   0.0024096708   0              0.0079542861   5.1143905e-16  0              4.9391123e-11  1.1965779e-13  0              2.9941808    
   2700000   9420           200            200            0.0034546523   0.0024096708   0              0.0079542861   9.3101254e-17  0              8.9910527e-12  1.1965779e-13  0              2.9941808    
   2800000   9420           200            200            0.0034546523   0.0024096708   0              0.0079542861   1.9214382e-18  0              1.8555875e-13  1.1965779e-13  0              2.9941808    
   2900000   9420           200            200            0.0034546523   0.0024096708   0              0.0079542861   1.8364137e-18  0              1.773477e-13   1.1965779e-13  0              2.9941808    
   3000000   9420           200            200            0.0034546523   0.0024096708   0              0.0079542861   6.3027148e-18  0              6.0867108e-13  1.1965779e-13  0              2.9941808    
Loop time of 297.16 on 4 procs for 3000000 steps with 2501 atoms

Performance: 8722573.684 ns/day, 0.000 hours/ns, 10095.571 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 11.025     | 36.232     | 61.556     | 413.2 | 12.19
Neigh   | 5.8863     | 5.9916     | 6.1014     |   4.1 |  2.02
Comm    | 22.585     | 40.679     | 77.609     | 339.0 | 13.69
Output  | 0.27136    | 0.27166    | 0.27199    |   0.1 |  0.09
Modify  | 109.98     | 157.52     | 177.57     | 221.1 | 53.01
Other   |            | 56.47      |            |       | 19.00

Nlocal:         625.25 ave         876 max         375 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:           1.75 ave           3 max           1 min
Histogram: 2 0 0 0 0 1 0 0 0 1
Neighs:         312.75 ave         626 max           0 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 1251
Ave neighs/atom = 0.50019992
Neighbor list builds = 166
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 29

#variable lat0 equal 1                    #
variable lat1 equal 3+(300*0.01)+(v_ind*0.01)  # .491+(v_ind*0.001)       # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 500*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 6.29                                                               
Lattice spacing in x,y,z = 6.29 6.29 6.29

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -4717.5 ${n1e1} -100 100 -100 100 units box
region box block -4717.5 4717.5 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -4717.5 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -4717.5 4717.5 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-4717.5 -100 -100) to (4717.5 100 100)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 1500 atoms
  using lattice units in orthogonal box = (-4717.5 -100 -100) to (4717.5 100 100)
  create_atoms CPU = 0.000 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 1500 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 1001 atoms
  using lattice units in orthogonal box = (-4717.5 -100 -100) to (4717.5 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  1500 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  1500 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  1001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  1001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
1500 atoms in group substrate
group slider1 region slider1
1001 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 1001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_29_*.dump id type diameter mass xu yu zu fx fy fz

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 6088 130 130
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 119 | 119 | 119 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   9435           200            200            0              0              0              0              0              0              0              1.1965779e-13  0              6            
    100000   9435           200            200            0.0021385908   4.2808625e-36  0              0.0064157723   578380.55      0              5.5855854e+10  1.1965779e-13  0              3.331849     
    200000   9435           200            200            0.00072399004  3.4247469e-35  0              0.0021719701   131189.35      0              1.2669329e+10  1.1965779e-13  0              3.0834743    
    300000   9435           200            200           -5.6144199e-06 -6.8491181e-35  0             -1.684326e-05   17.363772      0              1676868.8      1.1965779e-13  0              3.0440237    
    400000   9435           200            200           -4.3039841e-06  6.0632495e-40  0             -1.2911952e-05  10.383297      0              1002744.5      1.1965779e-13  0              3.0056371    
    500000   9435           200            200            0.00039164098 -0.00056835837  0              0.0017432813   92.111049      0              8895425.8      1.1965779e-13  0              2.9972678    
    600000   9435           200            200            0.0035792862  -9.0551785e-05  0              0.01082841     20.681857      0              1997305.7      1.1965779e-13  0              2.9932328    
    700000   9435           200            200            0.0030056493   0.00037586547  0              0.0086410824   15.249586      0              1472695.9      1.1965779e-13  0              2.9939652    
    800000   9435           200            200            0.0027563935   0.00043771859  0              0.007831462    3.1827444      0              307366.67      1.1965779e-13  0              2.9942507    
    900000   9435           200            200            0.0027502379   0.00044479446  0              0.0078059191   0.043536624    0              4204.4555      1.1965779e-13  0              2.9942577    
   1000000   9435           200            200            0.0027800172   0.00044036756  0              0.007899684    0.023488938    0              2268.3935      1.1965779e-13  0              2.9942231    
   1100000   9435           200            200            0.0027936506   0.00043845197  0              0.0079424999   0.0085140978   0              822.23063      1.1965779e-13  0              2.9942077    
   1200000   9435           200            200            0.0027953165   0.00043823341  0              0.0079477161   0.00031954289  0              30.859165      1.1965779e-13  0              2.9942059    
   1300000   9435           200            200            0.0027941708   0.00043839777  0              0.0079441147   2.4767069e-05  0              2.3918262      1.1965779e-13  0              2.9942072    
   1400000   9435           200            200            0.0027934676   0.00043849604  0              0.0079419067   2.0172618e-05  0              1.9481271      1.1965779e-13  0              2.994208     
   1500000   9435           200            200            0.0027933282   0.00043851492  0              0.0079414696   1.4545377e-06  0              0.14046884     1.1965779e-13  0              2.9942082    
   1600000   9435           200            200            0.0027933648   0.00043850955  0              0.0079415848   1.0359194e-08  0              0.0010004168   1.1965779e-13  0              2.9942081    
   1700000   9435           200            200            0.0027933989   0.00043850476  0              0.0079416918   4.2125514e-08  0              0.0040681806   1.1965779e-13  0              2.9942081    
   1800000   9435           200            200            0.0027934082   0.00043850348  0              0.0079417211   5.1927475e-09  0              0.00050147839  1.1965779e-13  0              2.9942081    
   1900000   9435           200            200            0.0027934075   0.00043850359  0              0.0079417189   5.9178905e-12  0              5.7150751e-07  1.1965779e-13  0              2.9942081    
   2000000   9435           200            200            0.0027934059   0.00043850381  0              0.007941714    7.5758834e-11  0              7.3162459e-06  1.1965779e-13  0              2.9942081    
   2100000   9435           200            200            0.0027934054   0.00043850389  0              0.0079417122   1.5733662e-11  0              1.5194444e-06  1.1965779e-13  0              2.9942081    
   2200000   9435           200            200            0.0027934054   0.00043850389  0              0.0079417122   2.3436133e-13  0              2.263294e-08   1.1965779e-13  0              2.9942081    
   2300000   9435           200            200            0.0027934054   0.00043850388  0              0.0079417124   1.1092416e-13  0              1.0712261e-08  1.1965779e-13  0              2.9942081    
   2400000   9435           200            200            0.0027934054   0.00043850387  0              0.0079417125   4.1819833e-14  0              4.0386602e-09  1.1965779e-13  0              2.9942081    
   2500000   9435           200            200            0.0027934055   0.00043850387  0              0.0079417125   1.7701001e-15  0              1.7094359e-10  1.1965779e-13  0              2.9942081    
   2600000   9435           200            200            0.0027934055   0.00043850387  0              0.0079417125   9.6883734e-17  0              9.3563376e-12  1.1965779e-13  0              2.9942081    
   2700000   9435           200            200            0.0027934054   0.00043850387  0              0.0079417125   8.9579999e-17  0              8.6509952e-12  1.1965779e-13  0              2.9942081    
   2800000   9435           200            200            0.0027934054   0.00043850387  0              0.0079417125   9.8465876e-18  0              9.5091296e-13  1.1965779e-13  0              2.9942081    
   2900000   9435           200            200            0.0027934054   0.00043850387  0              0.0079417125   3.110029e-19   0              3.0034434e-14  1.1965779e-13  0              2.9942081    
   3000000   9435           200            200            0.0027934054   0.00043850387  0              0.0079417125   1.8245489e-18  0              1.7620187e-13  1.1965779e-13  0              2.9942081    
Loop time of 296.528 on 4 procs for 3000000 steps with 2501 atoms

Performance: 8741153.798 ns/day, 0.000 hours/ns, 10117.076 timesteps/s
99.9% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 10.983     | 36.082     | 61.287     | 410.9 | 12.17
Neigh   | 5.893      | 5.996      | 6.1014     |   3.8 |  2.02
Comm    | 22.67      | 40.498     | 77.21      | 337.5 | 13.66
Output  | 0.27308    | 0.27341    | 0.27379    |   0.1 |  0.09
Modify  | 109.33     | 157.07     | 177.88     | 222.7 | 52.97
Other   |            | 56.61      |            |       | 19.09

Nlocal:         625.25 ave         876 max         375 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:           1.75 ave           3 max           1 min
Histogram: 2 0 0 0 0 1 0 0 0 1
Neighs:         312.25 ave         625 max           0 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 1249
Ave neighs/atom = 0.49940024
Neighbor list builds = 166
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 30

#variable lat0 equal 1                    #
variable lat1 equal 3+(300*0.01)+(v_ind*0.01)  # .491+(v_ind*0.001)       # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 500*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 6.3                                                               
Lattice spacing in x,y,z = 6.3 6.3 6.3

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -4725 ${n1e1} -100 100 -100 100 units box
region box block -4725 4725 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -4725 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -4725 4725 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-4725 -100 -100) to (4725 100 100)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 1500 atoms
  using lattice units in orthogonal box = (-4725 -100 -100) to (4725 100 100)
  create_atoms CPU = 0.000 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 1500 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 1001 atoms
  using lattice units in orthogonal box = (-4725 -100 -100) to (4725 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  1500 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  1500 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  1001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  1001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
1500 atoms in group substrate
group slider1 region slider1
1001 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 1001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_30_*.dump id type diameter mass xu yu zu fx fy fz

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 6097 130 130
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 119.2 | 119.2 | 119.2 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   9450           200            200            0              0              0              0              0              0              0              1.1965779e-13  0              6            
    100000   9450           200            200            0.0021345786   1.0685107e-36  0              0.0064037359   578123.5       0              5.583103e+10   1.1965779e-13  0              3.332099     
    200000   9450           200            200            0.00072442281 -1.709598e-35   0              0.0021732684   131667.1       0              1.2715466e+10  1.1965779e-13  0              3.082505     
    300000   9450           200            200           -2.2728546e-05 -1.709589e-35   0             -6.8185639e-05  300.1252       0              28983944       1.1965779e-13  0              3.0434354    
    400000   9450           200            200            0.0011314127   2.7112434e-40  0              0.003394238    8655.4344      0              8.358799e+08   1.1965779e-13  0              2.9970871    
    500000   9450           200            200            0.001225571    1.0257713e-34  0              0.0036767129   835.32926      0              80670121       1.1965779e-13  0              2.9971709    
    600000   9450           200            200            0.0018248638   5.1288633e-35  0              0.0054745914   23.695169      0              2288309.9      1.1965779e-13  0              2.9962197    
    700000   9450           200            200            0.0024819081   4.2740546e-35  0              0.0074457244   19.728401      0              1905227.7      1.1965779e-13  0              2.9953622    
    800000   9450           200            200            0.0026584926   1.7096282e-35  0              0.0079754779   3.4048553      0              328816.55      1.1965779e-13  0              2.9951491    
    900000   9450           200            200            0.0026740989  -4.2739349e-36  0              0.0080222967   0.25225196     0              24360.689      1.1965779e-13  0              2.9951323    
   1000000   9450           200            200            0.0026600063   4.2741228e-36  0              0.0079800189   0.0028234115   0              272.66487      1.1965779e-13  0              2.9951501    
   1100000   9450           200            200            0.0026495046   8.0984007e-41  0              0.0079485139   0.0012762503   0              123.25112      1.1965779e-13  0              2.9951631    
   1200000   9450           200            200            0.0026450926   7.6738327e-41  0              0.0079352778   0.00082175465  0              79.359182      1.1965779e-13  0              2.9951684    
   1300000   9450           200            200            0.0026438535  -1.3348871e-37  0              0.0079315604   0.00015463117  0              14.933172      1.1965779e-13  0              2.9951699    
   1400000   9450           200            200            0.0026437028   7.2727906e-41  0              0.0079311084   1.3083037e-05  0              1.263466       1.1965779e-13  0              2.9951701    
   1500000   9450           200            200            0.0026437793   6.4111319e-36  0              0.0079313379   2.4920352e-07  0              0.024066292    1.1965779e-13  0              2.99517      
   1600000   9450           200            200            0.0026438457  -1.7096089e-35  0              0.0079315371   3.5203128e-08  0              0.0033996662   1.1965779e-13  0              2.9951699    
   1700000   9450           200            200            0.0026438754   8.5481516e-36  0              0.0079316261   3.2511707e-08  0              0.0031397479   1.1965779e-13  0              2.9951699    
   1800000   9450           200            200            0.0026438842   4.2741115e-36  0              0.0079316527   6.9253983e-09  0              0.0006688054   1.1965779e-13  0              2.9951699    
   1900000   9450           200            200            0.0026438856  -8.5480089e-36  0              0.0079316568   6.6365611e-10  0              6.4091157e-05  1.1965779e-13  0              2.9951699    
   2000000   9450           200            200            0.0026438852  -8.5480088e-36  0              0.0079316556   1.8291089e-11  0              1.7664225e-06  1.1965779e-13  0              2.9951699    
   2100000   9450           200            200            0.0026438848   1.1112511e-34  0              0.0079316543   8.1367738e-13  0              7.8579137e-08  1.1965779e-13  0              2.9951699    
   2200000   9450           200            200            0.0026438846  -4.2740329e-35  0              0.0079316537   1.2542366e-12  0              1.211252e-07   1.1965779e-13  0              2.9951699    
   2300000   9450           200            200            0.0026438845   4.2740472e-35  0              0.0079316536   3.0514726e-13  0              2.9468938e-08  1.1965779e-13  0              2.9951699    
   2400000   9450           200            200            0.0026438845  -1.8805769e-34  0              0.0079316535   3.2992484e-14  0              3.186178e-09   1.1965779e-13  0              2.9951699    
   2500000   9450           200            200            0.0026438845  -5.1288409e-35  0              0.0079316535   1.2131617e-15  0              1.1715848e-10  1.1965779e-13  0              2.9951699    
   2600000   9450           200            200            0.0026438845   3.4192392e-35  0              0.0079316535   1.6530603e-17  0              1.5964073e-12  1.1965779e-13  0              2.9951699    
   2700000   9450           200            200            0.0026438845   1.7096231e-35  0              0.0079316535   3.832326e-17   0              3.7009861e-12  1.1965779e-13  0              2.9951699    
   2800000   9450           200            200            0.0026438845   6.8384712e-35  0              0.0079316535   1.2532138e-17  0              1.2102642e-12  1.1965779e-13  0              2.9951699    
   2900000   9450           200            200            0.0026438845  -1.7096092e-35  0              0.0079316535   1.5348661e-18  0              1.4822638e-13  1.1965779e-13  0              2.9951699    
   3000000   9450           200            200            0.0026438845  -6.8384571e-35  0              0.0079316535   1.3629955e-18  0              1.3162835e-13  1.1965779e-13  0              2.9951699    
Loop time of 294.562 on 4 procs for 3000000 steps with 2501 atoms

Performance: 8799491.486 ns/day, 0.000 hours/ns, 10184.597 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 11.089     | 34.947     | 59.057     | 399.6 | 11.86
Neigh   | 5.897      | 6.0022     | 6.1075     |   3.9 |  2.04
Comm    | 22.221     | 39.892     | 75.5       | 330.5 | 13.54
Output  | 0.29642    | 0.29672    | 0.29706    |   0.1 |  0.10
Modify  | 109.65     | 157.02     | 177.55     | 222.4 | 53.31
Other   |            | 56.41      |            |       | 19.15

Nlocal:         625.25 ave         876 max         375 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:           1.75 ave           3 max           1 min
Histogram: 2 0 0 0 0 1 0 0 0 1
Neighs:         309.25 ave         619 max           0 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 1237
Ave neighs/atom = 0.49460216
Neighbor list builds = 166
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 31

#variable lat0 equal 1                    #
variable lat1 equal 3+(300*0.01)+(v_ind*0.01)  # .491+(v_ind*0.001)       # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 500*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 6.31                                                               
Lattice spacing in x,y,z = 6.31 6.31 6.31

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -4732.5 ${n1e1} -100 100 -100 100 units box
region box block -4732.5 4732.5 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -4732.5 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -4732.5 4732.5 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-4732.5 -100 -100) to (4732.5 100 100)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 1500 atoms
  using lattice units in orthogonal box = (-4732.5 -100 -100) to (4732.5 100 100)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 1500 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 1001 atoms
  using lattice units in orthogonal box = (-4732.5 -100 -100) to (4732.5 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  1500 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  1500 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  1001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  1001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
1500 atoms in group substrate
group slider1 region slider1
1001 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 1001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_31_*.dump id type diameter mass xu yu zu fx fy fz

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 6107 130 130
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 119.4 | 119.4 | 119.4 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   9465           200            200            0              0              0              0              0              0              0              1.1965779e-13  0              6            
    100000   9465           200            200            0.0021313038   4.0575627e-41  0              0.0063939115   578181.47      0              5.5836628e+10  1.1965779e-13  0              3.3319498    
    200000   9465           200            200            0.00072059348  6.4904458e-41  0              0.0021617804   130878.5       0              1.2639309e+10  1.1965779e-13  0              3.0836461    
    300000   9465           200            200           -7.1784528e-06 -1.7069014e-35  0             -2.1535358e-05  28.78264       0              2779621.4      1.1965779e-13  0              3.0438582    
    400000   9465           200            200           -8.4752106e-06  8.3662451e-41  0             -2.5425632e-05  41.379472      0              3996133.2      1.1965779e-13  0              3.005485     
    500000   9465           200            200            0.00022198465 -0.0015246655   0              0.0021906195   331.48797      0              32012735       1.1965779e-13  0              2.9968386    
    600000   9465           200            200            0.0029333943  -0.0019187328   0              0.010718916    30.073707      0              2904303.4      1.1965779e-13  0              2.9931557    
    700000   9465           200            200            0.0020861667  -0.0012859917   0              0.0075444918   22.366555      0              2160001.8      1.1965779e-13  0              2.9942422    
    800000   9465           200            200            0.0020301765  -0.0014447415   0              0.007535271    0.059839069    0              5778.829       1.1965779e-13  0              2.9942382    
    900000   9465           200            200            0.0021322888  -0.0015050027   0              0.0079018691   0.46216662     0              44632.744      1.1965779e-13  0              2.9941021    
   1000000   9465           200            200            0.0021524994  -0.0015081871   0              0.0079656853   0.0061120842   0              590.26134      1.1965779e-13  0              2.9940796    
   1100000   9465           200            200            0.0021400628  -0.00150614     0              0.0079263285   0.0062064428   0              599.37382      1.1965779e-13  0              2.9940942    
   1200000   9465           200            200            0.0021353023  -0.0015053543   0              0.007911261    0.00055806409  0              53.893836      1.1965779e-13  0              2.9940996    
   1300000   9465           200            200            0.0021361833  -0.00150551     0              0.0079140598   4.4878147e-05  0              4.3340102      1.1965779e-13  0              2.9940986    
   1400000   9465           200            200            0.0021369719  -0.0015056422   0              0.0079165581   1.8496573e-05  0              1.7862666      1.1965779e-13  0              2.9940977    
   1500000   9465           200            200            0.0021369842  -0.0015056433   0              0.0079165957   3.5717859e-08  0              0.0034493752   1.1965779e-13  0              2.9940977    
   1600000   9465           200            200            0.0021368798  -0.0015056256   0              0.007916265    3.7406988e-07  0              0.036124992    1.1965779e-13  0              2.9940978    
   1700000   9465           200            200            0.0021368608  -0.0015056225   0              0.0079162049   5.799862e-09   0              0.00056010915  1.1965779e-13  0              2.9940978    
   1800000   9465           200            200            0.0021368717  -0.0015056244   0              0.0079162395   4.879552e-09   0              0.00047123221  1.1965779e-13  0              2.9940978    
   1900000   9465           200            200            0.0021368761  -0.0015056251   0              0.0079162534   4.7891921e-10  0              4.6250589e-05  1.1965779e-13  0              2.9940978    
   2000000   9465           200            200            0.0021368753  -0.001505625    0              0.007916251    3.3486488e-11  0              3.2338853e-06  1.1965779e-13  0              2.9940978    
   2100000   9465           200            200            0.0021368746  -0.0015056249   0              0.0079162488   1.5323545e-11  0              1.4798383e-06  1.1965779e-13  0              2.9940978    
   2200000   9465           200            200            0.0021368746  -0.0015056249   0              0.0079162487   1.6795937e-14  0              1.6220314e-09  1.1965779e-13  0              2.9940978    
   2300000   9465           200            200            0.0021368747  -0.0015056249   0              0.007916249    3.0243494e-13  0              2.9207001e-08  1.1965779e-13  0              2.9940978    
   2400000   9465           200            200            0.0021368747  -0.0015056249   0              0.0079162491   5.354215e-15   0              5.1707176e-10  1.1965779e-13  0              2.9940978    
   2500000   9465           200            200            0.0021368747  -0.0015056249   0              0.007916249    3.879697e-15   0              3.7467337e-10  1.1965779e-13  0              2.9940978    
   2600000   9465           200            200            0.0021368747  -0.0015056249   0              0.007916249    3.7330147e-16  0              3.6050784e-11  1.1965779e-13  0              2.9940978    
   2700000   9465           200            200            0.0021368747  -0.0015056249   0              0.007916249    1.4456448e-17  0              1.3961003e-12  1.1965779e-13  0              2.9940978    
   2800000   9465           200            200            0.0021368747  -0.0015056249   0              0.007916249    1.3606379e-17  0              1.3140067e-12  1.1965779e-13  0              2.9940978    
   2900000   9465           200            200            0.0021368747  -0.0015056249   0              0.007916249    6.3193936e-20  0              6.1028181e-15  1.1965779e-13  0              2.9940978    
   3000000   9465           200            200            0.0021368747  -0.0015056249   0              0.007916249    2.0083645e-18  0              1.9395347e-13  1.1965779e-13  0              2.9940978    
Loop time of 297.934 on 4 procs for 3000000 steps with 2501 atoms

Performance: 8699919.271 ns/day, 0.000 hours/ns, 10069.351 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 11.101     | 36.128     | 62.114     | 413.1 | 12.13
Neigh   | 5.9013     | 6.0091     | 6.1202     |   4.0 |  2.02
Comm    | 22.447     | 41.015     | 78.555     | 343.4 | 13.77
Output  | 0.2694     | 0.26971    | 0.27004    |   0.1 |  0.09
Modify  | 110.62     | 158.37     | 178.57     | 221.3 | 53.16
Other   |            | 56.14      |            |       | 18.84

Nlocal:         625.25 ave         876 max         375 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:           1.75 ave           3 max           1 min
Histogram: 2 0 0 0 0 1 0 0 0 1
Neighs:         312.25 ave         625 max           0 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 1249
Ave neighs/atom = 0.49940024
Neighbor list builds = 166
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 32

#variable lat0 equal 1                    #
variable lat1 equal 3+(300*0.01)+(v_ind*0.01)  # .491+(v_ind*0.001)       # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 500*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 6.32                                                               
Lattice spacing in x,y,z = 6.32 6.32 6.32

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -4740 ${n1e1} -100 100 -100 100 units box
region box block -4740 4740 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -4740 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -4740 4740 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-4740 -100 -100) to (4740 100 100)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 1500 atoms
  using lattice units in orthogonal box = (-4740 -100 -100) to (4740 100 100)
  create_atoms CPU = 0.000 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 1500 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 1001 atoms
  using lattice units in orthogonal box = (-4740 -100 -100) to (4740 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  1500 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  1500 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  1001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  1001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
1500 atoms in group substrate
group slider1 region slider1
1001 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 1001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_32_*.dump id type diameter mass xu yu zu fx fy fz

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 6117 130 130
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 119.6 | 119.6 | 119.6 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   9480           200            200            0              0              0              0              0              0              0              1.1965779e-13  0              6            
    100000   9480           200            200            0.002128239   -8.5210074e-35  0              0.006384717    578306.86      0              5.5848737e+10  1.1965779e-13  0              3.3318495    
    200000   9480           200            200            0.00072019709 -2.1302513e-36  0              0.0021605913   131091.25      0              1.2659855e+10  1.1965779e-13  0              3.0834706    
    300000   9480           200            200           -6.2574334e-06 -6.8167863e-35  0             -1.87723e-05    21.851102      0              2110223        1.1965779e-13  0              3.043918     
    400000   9480           200            200           -5.8700666e-06 -3.4083655e-35  0             -1.76102e-05    19.69632       0              1902129.6      1.1965779e-13  0              3.0055456    
    500000   9480           200            200            0.00047559182 -0.00049258299  0              0.0019193584   195.79699      0              18908672       1.1965779e-13  0              2.9970544    
    600000   9480           200            200            0.0025216272  -0.0026204503   0              0.010185332    77.804108      0              7513763.9      1.1965779e-13  0              2.993335     
    700000   9480           200            200            0.0014881495  -0.0024210692   0              0.0068855176   0.14140271     0              13655.662      1.1965779e-13  0              2.994523     
    800000   9480           200            200            0.0019002159  -0.0025027573   0              0.008203405    1.3037227      0              125904.2       1.1965779e-13  0              2.9940202    
    900000   9480           200            200            0.001799728   -0.0024841352   0              0.0078833193   0.45263831     0              43712.568      1.1965779e-13  0              2.9941415    
   1000000   9480           200            200            0.0017967762  -0.0024838017   0              0.0078741303   0.042281211    0              4083.2168      1.1965779e-13  0              2.9941436    
   1100000   9480           200            200            0.0018119234  -0.0024865802   0              0.0079223504   0.00035189446  0              33.983448      1.1965779e-13  0              2.994126     
   1200000   9480           200            200            0.0018042671  -0.0024851514   0              0.0078979527   0.00031577359  0              30.495154      1.1965779e-13  0              2.9941351    
   1300000   9480           200            200            0.0018062997  -0.002485539    0              0.0079044381   0.00014383213  0              13.890278      1.1965779e-13  0              2.9941326    
   1400000   9480           200            200            0.00180625    -0.0024855257   0              0.0079042756   1.5905328e-05  0              1.5360227      1.1965779e-13  0              2.9941327    
   1500000   9480           200            200            0.0018060022  -0.0024854805   0              0.0079034871   2.5553825e-07  0              0.024678055    1.1965779e-13  0              2.994133     
   1600000   9480           200            200            0.0018061408  -0.0024855064   0              0.0079039289   7.2303007e-08  0              0.0069825069   1.1965779e-13  0              2.9941328    
   1700000   9480           200            200            0.0018061005  -0.0024854987   0              0.0079038001   4.4680268e-08  0              0.0043149004   1.1965779e-13  0              2.9941329    
   1800000   9480           200            200            0.0018061033  -0.0024854993   0              0.0079038091   5.8177055e-09  0              0.00056183235  1.1965779e-13  0              2.9941329    
   1900000   9480           200            200            0.0018061072  -0.0024855      0              0.0079038216   1.4629049e-10  0              1.4127689e-05  1.1965779e-13  0              2.9941328    
   2000000   9480           200            200            0.0018061047  -0.0024854996   0              0.0079038137   1.4823705e-11  0              1.4315673e-06  1.1965779e-13  0              2.9941329    
   2100000   9480           200            200            0.0018061055  -0.0024854997   0              0.0079038162   1.3559091e-11  0              1.3094399e-06  1.1965779e-13  0              2.9941328    
   2200000   9480           200            200            0.0018061054  -0.0024854997   0              0.007903816    2.0775415e-12  0              2.0063408e-07  1.1965779e-13  0              2.9941328    
   2300000   9480           200            200            0.0018061054  -0.0024854997   0              0.0079038158   7.3095312e-14  0              7.059022e-09   1.1965779e-13  0              2.9941328    
   2400000   9480           200            200            0.0018061054  -0.0024854997   0              0.0079038159   2.4881527e-15  0              2.4028798e-10  1.1965779e-13  0              2.9941328    
   2500000   9480           200            200            0.0018061054  -0.0024854997   0              0.0079038159   4.0337385e-15  0              3.8954959e-10  1.1965779e-13  0              2.9941328    
   2600000   9480           200            200            0.0018061054  -0.0024854997   0              0.0079038159   7.1931618e-16  0              6.9466408e-11  1.1965779e-13  0              2.9941328    
   2700000   9480           200            200            0.0018061054  -0.0024854997   0              0.0079038159   1.8502151e-17  0              1.7868053e-12  1.1965779e-13  0              2.9941328    
   2800000   9480           200            200            0.0018061054  -0.0024854997   0              0.0079038159   1.9015605e-18  0              1.8363911e-13  1.1965779e-13  0              2.9941328    
   2900000   9480           200            200            0.0018061054  -0.0024854997   0              0.0079038159   3.9892649e-18  0              3.8525465e-13  1.1965779e-13  0              2.9941328    
   3000000   9480           200            200            0.0018061054  -0.0024854997   0              0.0079038159   6.181173e-18   0              5.9693344e-13  1.1965779e-13  0              2.9941328    
Loop time of 297.916 on 4 procs for 3000000 steps with 2501 atoms

Performance: 8700430.096 ns/day, 0.000 hours/ns, 10069.942 timesteps/s
99.9% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 11.145     | 35.833     | 61.15      | 409.5 | 12.03
Neigh   | 5.9435     | 6.0523     | 6.1636     |   4.1 |  2.03
Comm    | 22.406     | 40.734     | 77.729     | 339.6 | 13.67
Output  | 0.26949    | 0.26979    | 0.27011    |   0.1 |  0.09
Modify  | 110.44     | 158.3      | 179.12     | 222.7 | 53.14
Other   |            | 56.72      |            |       | 19.04

Nlocal:         625.25 ave         876 max         375 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:           1.75 ave           3 max           1 min
Histogram: 2 0 0 0 0 1 0 0 0 1
Neighs:         312.25 ave         625 max           0 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 1249
Ave neighs/atom = 0.49940024
Neighbor list builds = 166
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 33

#variable lat0 equal 1                    #
variable lat1 equal 3+(300*0.01)+(v_ind*0.01)  # .491+(v_ind*0.001)       # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 500*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 6.33                                                               
Lattice spacing in x,y,z = 6.33 6.33 6.33

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -4747.5 ${n1e1} -100 100 -100 100 units box
region box block -4747.5 4747.5 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -4747.5 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -4747.5 4747.5 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-4747.5 -100 -100) to (4747.5 100 100)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 1500 atoms
  using lattice units in orthogonal box = (-4747.5 -100 -100) to (4747.5 100 100)
  create_atoms CPU = 0.000 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 1500 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 1001 atoms
  using lattice units in orthogonal box = (-4747.5 -100 -100) to (4747.5 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  1500 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  1500 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  1001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  1001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
1500 atoms in group substrate
group slider1 region slider1
1001 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 1001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_33_*.dump id type diameter mass xu yu zu fx fy fz

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 6126 130 130
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 119.7 | 119.7 | 119.7 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   9495           200            200            0              0              0              0              0              0              0              1.1965779e-13  0              6            
    100000   9495           200            200            0.0021251879  -6.3806734e-35  0              0.0063755636   578434.25      0              5.5861039e+10  1.1965779e-13  0              3.331745     
    200000   9495           200            200            0.00071971633  1.1919145e-40  0              0.002159149    131279.71      0              1.2678055e+10  1.1965779e-13  0              3.0833118    
    300000   9495           200            200           -6.4228682e-06  7.6080681e-41  0             -1.9268605e-05  23.112835      0              2232072.2      1.1965779e-13  0              3.0439758    
    400000   9495           200            200           -9.3456654e-06  1.5951691e-36  0             -2.8036996e-05  50.787701      0              4904712.6      1.1965779e-13  0              3.0055867    
    500000   9495           200            200            9.3590427e-05 -0.0019042424   0              0.0021850137   351.81243      0              33975526       1.1965779e-13  0              2.9969404    
    600000   9495           200            200            0.0011328936  -0.0061738047   0              0.0095724854   131.44601      0              12694115       1.1965779e-13  0              2.993653     
    700000   9495           200            200            0.0003142109  -0.0059341034   0              0.0068767361   0.27329928     0              26393.289      1.1965779e-13  0              2.9946217    
    800000   9495           200            200            0.00064853224 -0.0061156992   0              0.0080612959   2.7735625      0              267850.82      1.1965779e-13  0              2.9941666    
    900000   9495           200            200            0.00063054105 -0.0061015976   0              0.0079932207   0.22951691     0              22165.1        1.1965779e-13  0              2.9941947    
   1000000   9495           200            200            0.00058784685 -0.0060829745   0              0.0078465151   0.014615246    0              1411.4359      1.1965779e-13  0              2.9942484    
   1100000   9495           200            200            0.00059964348 -0.0060884838   0              0.0078874142   0.0081198008   0              784.15224      1.1965779e-13  0              2.9942329    
   1200000   9495           200            200            0.0006028877  -0.0060898935   0              0.0078985566   7.3410889e-06  0              0.70894982     1.1965779e-13  0              2.9942289    
   1300000   9495           200            200            0.00060060747 -0.0060888585   0              0.0078906809   0.00013422895  0              12.962871      1.1965779e-13  0              2.9942319    
   1400000   9495           200            200            0.00060065152 -0.0060888871   0              0.0078908417   7.9065256e-06  0              0.76355565     1.1965779e-13  0              2.9942318    
   1500000   9495           200            200            0.00060094976 -0.0060890208   0              0.0078918701   9.3960895e-07  0              0.090740707    1.1965779e-13  0              2.9942314    
   1600000   9495           200            200            0.00060088085 -0.0060889887   0              0.0078916313   3.4109803e-07  0              0.032940806    1.1965779e-13  0              2.9942315    
   1700000   9495           200            200            0.00060085516 -0.0060889775   0              0.007891543    5.552198e-11   0              5.3619154e-06  1.1965779e-13  0              2.9942315    
   1800000   9495           200            200            0.00060086988 -0.0060889842   0              0.0078915938   6.4587921e-09  0              0.00062374391  1.1965779e-13  0              2.9942315    
   1900000   9495           200            200            0.00060087024 -0.0060889843   0              0.007891595    2.5486682e-10  0              2.4613213e-05  1.1965779e-13  0              2.9942315    
   2000000   9495           200            200            0.00060086818 -0.0060889834   0              0.0078915879   5.581598e-11   0              5.3903078e-06  1.1965779e-13  0              2.9942315    
   2100000   9495           200            200            0.00060086857 -0.0060889835   0              0.0078915892   1.3921846e-11  0              1.3444723e-06  1.1965779e-13  0              2.9942315    
   2200000   9495           200            200            0.00060086876 -0.0060889836   0              0.0078915899   4.8474253e-14  0              4.6812964e-09  1.1965779e-13  0              2.9942315    
   2300000   9495           200            200            0.00060086867 -0.0060889836   0              0.0078915896   3.0232744e-13  0              2.919662e-08   1.1965779e-13  0              2.9942315    
   2400000   9495           200            200            0.00060086866 -0.0060889836   0              0.0078915896   7.4614527e-15  0              7.2057369e-10  1.1965779e-13  0              2.9942315    
   2500000   9495           200            200            0.00060086868 -0.0060889836   0              0.0078915896   3.1823449e-15  0              3.0732809e-10  1.1965779e-13  0              2.9942315    
   2600000   9495           200            200            0.00060086867 -0.0060889836   0              0.0078915896   5.4422768e-16  0              5.2557613e-11  1.1965779e-13  0              2.9942315    
   2700000   9495           200            200            0.00060086867 -0.0060889836   0              0.0078915896   1.5715741e-17  0              1.5177138e-12  1.1965779e-13  0              2.9942315    
   2800000   9495           200            200            0.00060086867 -0.0060889836   0              0.0078915896   1.1216362e-17  0              1.083196e-12   1.1965779e-13  0              2.9942315    
   2900000   9495           200            200            0.00060086867 -0.0060889836   0              0.0078915896   9.7689966e-19  0              9.4341977e-14  1.1965779e-13  0              2.9942315    
   3000000   9495           200            200            0.00060086867 -0.0060889836   0              0.0078915896   2.6160237e-19  0              2.5263684e-14  1.1965779e-13  0              2.9942315    
Loop time of 300.99 on 4 procs for 3000000 steps with 2501 atoms

Performance: 8611585.971 ns/day, 0.000 hours/ns, 9967.113 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 11.223     | 36.431     | 62.205     | 415.5 | 12.10
Neigh   | 5.9192     | 6.0306     | 6.1443     |   4.2 |  2.00
Comm    | 22.303     | 40.981     | 78.682     | 345.1 | 13.62
Output  | 0.27178    | 0.27212    | 0.2725     |   0.1 |  0.09
Modify  | 112.97     | 160.78     | 180.96     | 220.0 | 53.42
Other   |            | 56.49      |            |       | 18.77

Nlocal:         625.25 ave         876 max         375 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:           1.75 ave           3 max           1 min
Histogram: 2 0 0 0 0 1 0 0 0 1
Neighs:         313.75 ave         628 max           0 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 1255
Ave neighs/atom = 0.50179928
Neighbor list builds = 166
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 34

#variable lat0 equal 1                    #
variable lat1 equal 3+(300*0.01)+(v_ind*0.01)  # .491+(v_ind*0.001)       # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 500*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 6.34                                                               
Lattice spacing in x,y,z = 6.34 6.34 6.34

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -4755 ${n1e1} -100 100 -100 100 units box
region box block -4755 4755 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -4755 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -4755 4755 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-4755 -100 -100) to (4755 100 100)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 1500 atoms
  using lattice units in orthogonal box = (-4755 -100 -100) to (4755 100 100)
  create_atoms CPU = 0.000 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 1500 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 1001 atoms
  using lattice units in orthogonal box = (-4755 -100 -100) to (4755 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  1500 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  1500 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  1001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  1001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
1500 atoms in group substrate
group slider1 region slider1
1001 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 1001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_34_*.dump id type diameter mass xu yu zu fx fy fz

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 6136 130 130
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 119.9 | 119.9 | 119.9 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   9510           200            200            0              0              0              0              0              0              0              1.1965779e-13  0              6            
    100000   9510           200            200            0.0021206802   1.200435e-42   0              0.0063620405   577960.32      0              5.5815271e+10  1.1965779e-13  0              3.332133     
    200000   9510           200            200            0.00071605224  2.1235389e-35  0              0.0021481567   130554.55      0              1.2608024e+10  1.1965779e-13  0              3.0839017    
    300000   9510           200            200           -8.2109036e-06  1.6988398e-35  0             -2.4632711e-05  38.17595       0              3686760        1.1965779e-13  0              3.0437462    
    400000   9510           200            200           -9.7316011e-06  1.0193135e-34  0             -2.9194803e-05  55.322799      0              5342679.9      1.1965779e-13  0              3.0053857    
    500000   9510           200            200            0.0010933184   0.00064428349  0              0.0026356716   537.61848      0              51919344       1.1965779e-13  0              2.9964526    
    600000   9510           200            200            0.0030720251   0.00075298077  0              0.0084630946   183.71813      0              17742182       1.1965779e-13  0              2.9938192    
    700000   9510           200            200            0.0026312911   0.00071951813  0              0.0071743553   13.627146      0              1316012.2      1.1965779e-13  0              2.9942784    
    800000   9510           200            200            0.0030167692   0.000790457    0              0.0082598507   0.023073587    0              2228.2818      1.1965779e-13  0              2.9938737    
    900000   9510           200            200            0.0028487094   0.00077236801  0              0.0077737603   0.19501454     0              18833.109      1.1965779e-13  0              2.9940547    
   1000000   9510           200            200            0.0028846733   0.00077258951  0              0.0078814304   0.062055756    0              5992.9007      1.1965779e-13  0              2.9940133    
   1100000   9510           200            200            0.0028879433   0.00077259709  0              0.0078912328   0.0046754517   0              451.52166      1.1965779e-13  0              2.9940101    
   1200000   9510           200            200            0.0028814172   0.0007725786   0              0.007871673    2.3189523e-06  0              0.22394781     1.1965779e-13  0              2.9940173    
   1300000   9510           200            200            0.0028843323   0.00077258783  0              0.0078804092   7.1242251e-05  0              6.8800667      1.1965779e-13  0              2.994014     
   1400000   9510           200            200            0.0028837148   0.00077258596  0              0.0078785585   2.0636798e-05  0              1.9929542      1.1965779e-13  0              2.9940147    
   1500000   9510           200            200            0.0028836388   0.00077258575  0              0.0078783308   1.4297755e-06  0              0.13807749     1.1965779e-13  0              2.9940148    
   1600000   9510           200            200            0.0028837612   0.00077258611  0              0.0078786975   2.4935973e-12  0              2.4081378e-07  1.1965779e-13  0              2.9940146    
   1700000   9510           200            200            0.0028837086   0.00077258595  0              0.0078785397   2.5764022e-08  0              0.0024881048   1.1965779e-13  0              2.9940147    
   1800000   9510           200            200            0.0028837191   0.00077258599  0              0.0078785713   6.8388652e-09  0              0.00066044865  1.1965779e-13  0              2.9940147    
   1900000   9510           200            200            0.0028837208   0.00077258599  0              0.0078785764   4.3433931e-10  0              4.1945382e-05  1.1965779e-13  0              2.9940147    
   2000000   9510           200            200            0.0028837185   0.00077258598  0              0.0078785695   1.999679e-13   0              1.9311469e-08  1.1965779e-13  0              2.9940147    
   2100000   9510           200            200            0.0028837194   0.00077258599  0              0.0078785724   9.2529466e-12  0              8.9358335e-07  1.1965779e-13  0              2.9940147    
   2200000   9510           200            200            0.0028837193   0.00077258599  0              0.0078785718   2.2587019e-12  0              2.1812926e-07  1.1965779e-13  0              2.9940147    
   2300000   9510           200            200            0.0028837192   0.00077258599  0              0.0078785717   1.3082172e-13  0              1.2633825e-08  1.1965779e-13  0              2.9940147    
   2400000   9510           200            200            0.0028837193   0.00077258599  0              0.0078785718   2.7299574e-16  0              2.6363975e-11  1.1965779e-13  0              2.9940147    
   2500000   9510           200            200            0.0028837193   0.00077258599  0              0.0078785718   3.3525701e-15  0              3.2376723e-10  1.1965779e-13  0              2.9940147    
   2600000   9510           200            200            0.0028837193   0.00077258599  0              0.0078785718   7.3889749e-16  0              7.135743e-11   1.1965779e-13  0              2.9940147    
   2700000   9510           200            200            0.0028837193   0.00077258599  0              0.0078785718   2.2949432e-17  0              2.2162919e-12  1.1965779e-13  0              2.9940147    
   2800000   9510           200            200            0.0028837193   0.00077258599  0              0.0078785718   1.5514133e-18  0              1.4982439e-13  1.1965779e-13  0              2.9940147    
   2900000   9510           200            200            0.0028837193   0.00077258599  0              0.0078785718   6.6611501e-19  0              6.432862e-14   1.1965779e-13  0              2.9940147    
   3000000   9510           200            200            0.0028837193   0.00077258599  0              0.0078785718   4.4820057e-18  0              4.3284003e-13  1.1965779e-13  0              2.9940147    
Loop time of 300.135 on 4 procs for 3000000 steps with 2501 atoms

Performance: 8636122.638 ns/day, 0.000 hours/ns, 9995.512 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 11.244     | 36.515     | 62.908     | 414.1 | 12.17
Neigh   | 5.9229     | 6.0358     | 6.1507     |   4.2 |  2.01
Comm    | 21.798     | 42.992     | 82.277     | 354.1 | 14.32
Output  | 0.27026    | 0.27057    | 0.27091    |   0.1 |  0.09
Modify  | 109        | 157.9      | 177.46     | 225.8 | 52.61
Other   |            | 56.42      |            |       | 18.80

Nlocal:         625.25 ave         876 max         375 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:           1.75 ave           3 max           1 min
Histogram: 2 0 0 0 0 1 0 0 0 1
Neighs:         311.75 ave         624 max           0 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 1247
Ave neighs/atom = 0.49860056
Neighbor list builds = 166
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 35

#variable lat0 equal 1                    #
variable lat1 equal 3+(300*0.01)+(v_ind*0.01)  # .491+(v_ind*0.001)       # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 500*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 6.35                                                               
Lattice spacing in x,y,z = 6.35 6.35 6.35

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -4762.5 ${n1e1} -100 100 -100 100 units box
region box block -4762.5 4762.5 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -4762.5 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -4762.5 4762.5 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-4762.5 -100 -100) to (4762.5 100 100)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 1500 atoms
  using lattice units in orthogonal box = (-4762.5 -100 -100) to (4762.5 100 100)
  create_atoms CPU = 0.000 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 1500 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 1001 atoms
  using lattice units in orthogonal box = (-4762.5 -100 -100) to (4762.5 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  1500 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  1500 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  1001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  1001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
1500 atoms in group substrate
group slider1 region slider1
1001 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 1001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_35_*.dump id type diameter mass xu yu zu fx fy fz

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 6146 130 130
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 120 | 120 | 120.1 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   9525           200            200            0              0              0              0              0              0              0              1.1965779e-13  0              6            
    100000   9525           200            200            0.0021176558   1.186042e-41   0              0.0063529674   578090.08      0              5.5827802e+10  1.1965779e-13  0              3.3320247    
    200000   9525           200            200            0.00071563167 -1.6961443e-35  0              0.002146895    130757.63      0              1.2627636e+10  1.1965779e-13  0              3.0837337    
    300000   9525           200            200           -7.4387841e-06  4.2403942e-36  0             -2.2316352e-05  31.341072      0              3026696.4      1.1965779e-13  0              3.043807     
    400000   9525           200            200           -9.2606876e-06  3.357448e-40   0             -2.7782063e-05  50.179789      0              4846004.9      1.1965779e-13  0              3.0054373    
    500000   9525           200            200            0.0010460191   0.00070609408  0              0.0024319633   447.69468      0              43235147       1.1965779e-13  0              2.9966379    
    600000   9525           200            200            0.0024401135  -0.0012135043   0              0.008533845    180.17396      0              17399911       1.1965779e-13  0              2.9938464    
    700000   9525           200            200            0.0021379376  -0.0013202648   0              0.0077340776   24.961614      0              2410614        1.1965779e-13  0              2.9941198    
    800000   9525           200            200            0.002197848   -0.0012925698   0              0.0078861138   3.4107418      0              329385.03      1.1965779e-13  0              2.994072     
    900000   9525           200            200            0.0021905267  -0.0012915442   0              0.0078631244   0.46093705     0              44514.001      1.1965779e-13  0              2.994077     
   1000000   9525           200            200            0.0021913717  -0.0012914415   0              0.0078655566   0.062164679    0              6003.4197      1.1965779e-13  0              2.9940775    
   1100000   9525           200            200            0.0021918526  -0.0012916855   0              0.0078672435   0.0083633998   0              807.67729      1.1965779e-13  0              2.9940763    
   1200000   9525           200            200            0.0021914078  -0.0012915261   0              0.0078657494   0.0011222671   0              108.38052      1.1965779e-13  0              2.9940771    
   1300000   9525           200            200            0.0021916721  -0.0012916109   0              0.0078666274   0.00015023369  0              14.508494      1.1965779e-13  0              2.9940767    
   1400000   9525           200            200            0.0021915384  -0.0012915702   0              0.0078661856   2.0060019e-05  0              1.9372531      1.1965779e-13  0              2.9940768    
   1500000   9525           200            200            0.002191601   -0.0012915887   0              0.0078663916   2.6718138e-06  0              0.25802465     1.1965779e-13  0              2.9940768    
   1600000   9525           200            200            0.0021915731  -0.0012915806   0              0.0078663      3.5494694e-07  0              0.034278235    1.1965779e-13  0              2.9940768    
   1700000   9525           200            200            0.0021915851  -0.0012915841   0              0.0078663395   4.7031931e-08  0              0.0045420072   1.1965779e-13  0              2.9940768    
   1800000   9525           200            200            0.0021915801  -0.0012915826   0              0.0078663228   6.2154337e-09  0              0.0006002421   1.1965779e-13  0              2.9940768    
   1900000   9525           200            200            0.0021915822  -0.0012915832   0              0.0078663297   8.1917902e-10  0              7.9110447e-05  1.1965779e-13  0              2.9940768    
   2000000   9525           200            200            0.0021915813  -0.001291583    0              0.0078663269   1.0765061e-10  0              1.0396126e-05  1.1965779e-13  0              2.9940768    
   2100000   9525           200            200            0.0021915817  -0.0012915831   0              0.007866328    1.4107912e-11  0              1.3624411e-06  1.1965779e-13  0              2.9940768    
   2200000   9525           200            200            0.0021915815  -0.001291583    0              0.0078663276   1.8427959e-12  0              1.7796404e-07  1.1965779e-13  0              2.9940768    
   2300000   9525           200            200            0.0021915816  -0.0012915831   0              0.0078663278   2.3999624e-13  0              2.3177119e-08  1.1965779e-13  0              2.9940768    
   2400000   9525           200            200            0.0021915816  -0.001291583    0              0.0078663277   3.11018e-14    0              3.0035893e-09  1.1965779e-13  0              2.9940768    
   2500000   9525           200            200            0.0021915816  -0.001291583    0              0.0078663277   4.0224162e-15  0              3.8845616e-10  1.1965779e-13  0              2.9940768    
   2600000   9525           200            200            0.0021915816  -0.001291583    0              0.0078663277   4.9780049e-16  0              4.8074008e-11  1.1965779e-13  0              2.9940768    
   2700000   9525           200            200            0.0021915816  -0.001291583    0              0.0078663277   7.5940327e-17  0              7.3337732e-12  1.1965779e-13  0              2.9940768    
   2800000   9525           200            200            0.0021915816  -0.001291583    0              0.0078663277   1.1745667e-17  0              1.1343125e-12  1.1965779e-13  0              2.9940768    
   2900000   9525           200            200            0.0021915816  -0.001291583    0              0.0078663277   3.2455479e-18  0              3.1343179e-13  1.1965779e-13  0              2.9940768    
   3000000   9525           200            200            0.0021915816  -0.001291583    0              0.0078663277   7.2060607e-18  0              6.9590977e-13  1.1965779e-13  0              2.9940768    
Loop time of 297.829 on 4 procs for 3000000 steps with 2501 atoms

Performance: 8702990.897 ns/day, 0.000 hours/ns, 10072.906 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 11.383     | 35.796     | 60.796     | 407.9 | 12.02
Neigh   | 5.9103     | 6.0173     | 6.1244     |   4.0 |  2.02
Comm    | 22.184     | 41.989     | 79.55      | 341.8 | 14.10
Output  | 0.27284    | 0.27314    | 0.27347    |   0.1 |  0.09
Modify  | 108.86     | 157.17     | 177.63     | 224.5 | 52.77
Other   |            | 56.58      |            |       | 19.00

Nlocal:         625.25 ave         876 max         375 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:           1.75 ave           3 max           1 min
Histogram: 2 0 0 0 0 1 0 0 0 1
Neighs:         310.75 ave         622 max           0 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 1243
Ave neighs/atom = 0.4970012
Neighbor list builds = 166
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 36

#variable lat0 equal 1                    #
variable lat1 equal 3+(300*0.01)+(v_ind*0.01)  # .491+(v_ind*0.001)       # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 500*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 6.36                                                               
Lattice spacing in x,y,z = 6.36 6.36 6.36

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -4770 ${n1e1} -100 100 -100 100 units box
region box block -4770 4770 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -4770 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -4770 4770 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-4770 -100 -100) to (4770 100 100)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 1500 atoms
  using lattice units in orthogonal box = (-4770 -100 -100) to (4770 100 100)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 1500 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 1001 atoms
  using lattice units in orthogonal box = (-4770 -100 -100) to (4770 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  1500 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  1500 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  1001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  1001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
1500 atoms in group substrate
group slider1 region slider1
1001 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 1001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_36_*.dump id type diameter mass xu yu zu fx fy fz

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 6155 130 130
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 120.2 | 120.2 | 120.2 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   9540           200            200            0              0              0              0              0              0              0              1.1965779e-13  0              6            
    100000   9540           200            200            0.0021146812   7.7409588e-41  0              0.0063440436   578239.89      0              5.584227e+10   1.1965779e-13  0              3.3318746    
    200000   9540           200            200            0.00071532331  1.6935129e-35  0              0.0021459699   130993.66      0              1.265043e+10   1.1965779e-13  0              3.0835178    
    300000   9540           200            200           -7.1237316e-06 -6.7738936e-35  0             -2.1371195e-05  28.796433      0              2780953.4      1.1965779e-13  0              3.0438717    
    400000   9540           200            200           -8.9669306e-06 -5.7578546e-34  0             -2.6900792e-05  47.149124      0              4553324.9      1.1965779e-13  0              3.0054868    
    500000   9540           200            200            0.00063875612 -0.00054155175  0              0.0024578201   580.58937      0              56069166       1.1965779e-13  0              2.996556     
    600000   9540           200            200            0.0026687112  -0.0028235887   0              0.010829722    0.21034807     0              20313.911      1.1965779e-13  0              2.9931932    
    700000   9540           200            200            0.001909881   -0.0024107928   0              0.0081404358   24.013731      0              2319074.3      1.1965779e-13  0              2.9941266    
    800000   9540           200            200            0.00172571    -0.0023725675   0              0.0075496975   1.2527003      0              120976.83      1.1965779e-13  0              2.9943382    
    900000   9540           200            200            0.0017822719  -0.0023857342   0              0.0077325499   0.12458181     0              12031.22       1.1965779e-13  0              2.9942683    
   1000000   9540           200            200            0.0018225556  -0.0023943765   0              0.0078620433   0.061753686    0              5963.729       1.1965779e-13  0              2.9942207    
   1100000   9540           200            200            0.0018259643  -0.0023950323   0              0.0078729253   0.00042529473  0              41.071921      1.1965779e-13  0              2.9942171    
   1200000   9540           200            200            0.0018214488  -0.0023940644   0              0.007858411    0.00077562865  0              74.904664      1.1965779e-13  0              2.9942225    
   1300000   9540           200            200            0.0018197495  -0.0023937093   0              0.0078529579   0.00010904071  0              10.530372      1.1965779e-13  0              2.9942244    
   1400000   9540           200            200            0.0018198909  -0.0023937424   0              0.0078534151   7.8172835e-07  0              0.075493729    1.1965779e-13  0              2.9942243    
   1500000   9540           200            200            0.001820159   -0.0023937995   0              0.0078542765   2.7290525e-06  0              0.26355236     1.1965779e-13  0              2.9942239    
   1600000   9540           200            200            0.0018202137  -0.0023938107   0              0.0078544518   1.1234898e-07  0              0.01084986     1.1965779e-13  0              2.9942239    
   1700000   9540           200            200            0.0018201926  -0.0023938061   0              0.0078543838   1.7070316e-08  0              0.0016485289   1.1965779e-13  0              2.9942239    
   1800000   9540           200            200            0.0018201794  -0.0023938033   0              0.0078543415   6.5870817e-09  0              0.0006361332   1.1965779e-13  0              2.9942239    
   1900000   9540           200            200            0.0018201786  -0.0023938032   0              0.007854339    2.2107632e-11  0              2.1349968e-06  1.1965779e-13  0              2.9942239    
   2000000   9540           200            200            0.0018201802  -0.0023938035   0              0.007854344    9.3226327e-11  0              9.0031313e-06  1.1965779e-13  0              2.9942239    
   2100000   9540           200            200            0.0018201807  -0.0023938036   0              0.0078543458   1.082861e-11   0              1.0457496e-06  1.1965779e-13  0              2.9942239    
   2200000   9540           200            200            0.0018201806  -0.0023938036   0              0.0078543456   1.5790938e-13  0              1.5249758e-08  1.1965779e-13  0              2.9942239    
   2300000   9540           200            200            0.0018201806  -0.0023938036   0              0.0078543453   3.0596341e-13  0              2.9547756e-08  1.1965779e-13  0              2.9942239    
   2400000   9540           200            200            0.0018201805  -0.0023938036   0              0.0078543452   9.7406704e-15  0              9.4068423e-10  1.1965779e-13  0              2.9942239    
   2500000   9540           200            200            0.0018201805  -0.0023938036   0              0.0078543452   2.3216603e-15  0              2.2420934e-10  1.1965779e-13  0              2.9942239    
   2600000   9540           200            200            0.0018201805  -0.0023938036   0              0.0078543453   6.7738906e-16  0              6.5417387e-11  1.1965779e-13  0              2.9942239    
   2700000   9540           200            200            0.0018201805  -0.0023938036   0              0.0078543453   2.7031203e-18  0              2.6104801e-13  1.1965779e-13  0              2.9942239    
   2800000   9540           200            200            0.0018201805  -0.0023938036   0              0.0078543452   6.3000766e-18  0              6.0841631e-13  1.1965779e-13  0              2.9942239    
   2900000   9540           200            200            0.0018201805  -0.0023938036   0              0.0078543453   7.4492279e-18  0              7.1939311e-13  1.1965779e-13  0              2.9942239    
   3000000   9540           200            200            0.0018201805  -0.0023938036   0              0.0078543453   1.3611313e-18  0              1.3144832e-13  1.1965779e-13  0              2.9942239    
Loop time of 298.575 on 4 procs for 3000000 steps with 2501 atoms

Performance: 8681238.787 ns/day, 0.000 hours/ns, 10047.730 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 11.28      | 36.428     | 61.456     | 411.1 | 12.20
Neigh   | 5.9763     | 6.0835     | 6.1929     |   4.0 |  2.04
Comm    | 22.864     | 40.841     | 77.524     | 336.2 | 13.68
Output  | 0.27934    | 0.27964    | 0.27996    |   0.1 |  0.09
Modify  | 111.26     | 158.12     | 178.64     | 218.1 | 52.96
Other   |            | 56.83      |            |       | 19.03

Nlocal:         625.25 ave         876 max         375 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:           1.75 ave           3 max           1 min
Histogram: 2 0 0 0 0 1 0 0 0 1
Neighs:         311.75 ave         624 max           0 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 1247
Ave neighs/atom = 0.49860056
Neighbor list builds = 166
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 37

#variable lat0 equal 1                    #
variable lat1 equal 3+(300*0.01)+(v_ind*0.01)  # .491+(v_ind*0.001)       # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 500*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 6.37                                                               
Lattice spacing in x,y,z = 6.37 6.37 6.37

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -4777.5 ${n1e1} -100 100 -100 100 units box
region box block -4777.5 4777.5 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -4777.5 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -4777.5 4777.5 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-4777.5 -100 -100) to (4777.5 100 100)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 1500 atoms
  using lattice units in orthogonal box = (-4777.5 -100 -100) to (4777.5 100 100)
  create_atoms CPU = 0.000 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 1500 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 1001 atoms
  using lattice units in orthogonal box = (-4777.5 -100 -100) to (4777.5 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  1500 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  1500 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  1001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  1001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
1500 atoms in group substrate
group slider1 region slider1
1001 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 1001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_37_*.dump id type diameter mass xu yu zu fx fy fz

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 6165 130 130
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 120.4 | 120.4 | 120.4 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   9555           200            200            0              0              0              0              0              0              0              1.1965779e-13  0              6            
    100000   9555           200            200            0.0021112194  -1.5217447e-34  0              0.0063336583   578174.14      0              5.583592e+10   1.1965779e-13  0              3.3319814    
    200000   9555           200            200            0.00071322083  1.690841e-35   0              0.0021396625   130704.84      0              1.2622538e+10  1.1965779e-13  0              3.0838997    
    300000   9555           200            200           -9.2129372e-06 -1.690822e-35   0             -2.7638812e-05  48.687349      0              4701875.7      1.1965779e-13  0              3.043926     
    400000   9555           200            200           -1.2611192e-05  1.6908658e-35  0             -3.7833575e-05  94.596905      0              9135492        1.1965779e-13  0              3.0055522    
    500000   9555           200            200            0.00080419429  7.3515292e-05  0              0.0023390676   427.56753      0              41291412       1.1965779e-13  0              2.9968438    
    600000   9555           200            200            0.0039296048   0.0023042122   0              0.0094846023   133.35209      0              12878191       1.1965779e-13  0              2.9936679    
    700000   9555           200            200            0.0030188822   0.0022029013   0              0.0068537452   1.3113468      0              126640.49      1.1965779e-13  0              2.9946211    
    800000   9555           200            200            0.0034785577   0.0022814332   0              0.0081542399   1.1188564      0              108051.14      1.1965779e-13  0              2.9941215    
    900000   9555           200            200            0.0033701937   0.002280911    0              0.0078296702   0.46138274     0              44557.042      1.1965779e-13  0              2.9942449    
   1000000   9555           200            200            0.0033612804   0.0022783059   0              0.0078055354   0.031427163    0              3035.0105      1.1965779e-13  0              2.9942527    
   1100000   9555           200            200            0.0033808055   0.0022816536   0              0.007860763    7.6540968e-05  0              7.3917788      1.1965779e-13  0              2.9942322    
   1200000   9555           200            200            0.0033728344   0.0022802607   0              0.0078382424   0.00078523656  0              75.832526      1.1965779e-13  0              2.9942407    
   1300000   9555           200            200            0.0033739242   0.0022804591   0              0.0078413134   0.00014197168  0              13.710609      1.1965779e-13  0              2.9942395    
   1400000   9555           200            200            0.00337449     0.0022805541   0              0.007842916    3.193405e-06   0              0.30839619     1.1965779e-13  0              2.9942389    
   1500000   9555           200            200            0.0033740786   0.0022804829   0              0.0078417529   5.9679644e-07  0              0.057634329    1.1965779e-13  0              2.9942393    
   1600000   9555           200            200            0.0033741945   0.0022805034   0              0.0078420802   3.6249963e-07  0              0.035007619    1.1965779e-13  0              2.9942392    
   1700000   9555           200            200            0.0033741959   0.0022805034   0              0.0078420842   3.1370254e-08  0              0.0030295146   1.1965779e-13  0              2.9942392    
   1800000   9555           200            200            0.0033741796   0.0022805006   0              0.0078420382   2.3558192e-12  0              2.2750816e-07  1.1965779e-13  0              2.9942392    
   1900000   9555           200            200            0.003374187    0.0022805019   0              0.0078420591   5.3725522e-10  0              5.1884264e-05  1.1965779e-13  0              2.9942392    
   2000000   9555           200            200            0.0033741857   0.0022805017   0              0.0078420555   1.2183751e-10  0              1.1766195e-05  1.1965779e-13  0              2.9942392    
   2100000   9555           200            200            0.0033741853   0.0022805016   0              0.0078420544   4.1249752e-12  0              3.9836058e-07  1.1965779e-13  0              2.9942392    
   2200000   9555           200            200            0.0033741857   0.0022805017   0              0.0078420554   2.9177601e-13  0              2.8177639e-08  1.1965779e-13  0              2.9942392    
   2300000   9555           200            200            0.0033741856   0.0022805017   0              0.0078420551   2.771738e-13   0              2.6767461e-08  1.1965779e-13  0              2.9942392    
   2400000   9555           200            200            0.0033741856   0.0022805017   0              0.0078420551   2.9844345e-14  0              2.8821532e-09  1.1965779e-13  0              2.9942392    
   2500000   9555           200            200            0.0033741856   0.0022805017   0              0.0078420551   8.4969383e-17  0              8.2057348e-12  1.1965779e-13  0              2.9942392    
   2600000   9555           200            200            0.0033741856   0.0022805017   0              0.0078420551   3.3296477e-16  0              3.2155354e-11  1.1965779e-13  0              2.9942392    
   2700000   9555           200            200            0.0033741856   0.0022805017   0              0.0078420551   9.8075838e-17  0              9.4714624e-12  1.1965779e-13  0              2.9942392    
   2800000   9555           200            200            0.0033741856   0.0022805017   0              0.0078420551   1.2246245e-18  0              1.1826547e-13  1.1965779e-13  0              2.9942392    
   2900000   9555           200            200            0.0033741856   0.0022805017   0              0.0078420551   2.4033054e-19  0              2.3209404e-14  1.1965779e-13  0              2.9942392    
   3000000   9555           200            200            0.0033741856   0.0022805017   0              0.0078420551   4.5185864e-18  0              4.3637273e-13  1.1965779e-13  0              2.9942392    
Loop time of 296.905 on 4 procs for 3000000 steps with 2501 atoms

Performance: 8730077.331 ns/day, 0.000 hours/ns, 10104.256 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 11.069     | 36.108     | 61.719     | 412.4 | 12.16
Neigh   | 5.9746     | 6.0891     | 6.2077     |   4.3 |  2.05
Comm    | 22.674     | 41.027     | 78.292     | 340.7 | 13.82
Output  | 0.27261    | 0.27292    | 0.27326    |   0.1 |  0.09
Modify  | 109.39     | 157.09     | 177.32     | 222.1 | 52.91
Other   |            | 56.31      |            |       | 18.97

Nlocal:         625.25 ave         876 max         375 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:           1.75 ave           3 max           1 min
Histogram: 2 0 0 0 0 1 0 0 0 1
Neighs:         311.75 ave         624 max           0 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 1247
Ave neighs/atom = 0.49860056
Neighbor list builds = 166
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 38

#variable lat0 equal 1                    #
variable lat1 equal 3+(300*0.01)+(v_ind*0.01)  # .491+(v_ind*0.001)       # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 500*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 6.38                                                               
Lattice spacing in x,y,z = 6.38 6.38 6.38

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -4785 ${n1e1} -100 100 -100 100 units box
region box block -4785 4785 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -4785 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -4785 4785 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-4785 -100 -100) to (4785 100 100)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 1500 atoms
  using lattice units in orthogonal box = (-4785 -100 -100) to (4785 100 100)
  create_atoms CPU = 0.000 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 1500 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 1001 atoms
  using lattice units in orthogonal box = (-4785 -100 -100) to (4785 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  1500 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  1500 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  1001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  1001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
1500 atoms in group substrate
group slider1 region slider1
1001 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 1001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_38_*.dump id type diameter mass xu yu zu fx fy fz

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 6175 130 130
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 120.6 | 120.6 | 120.6 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   9570           200            200            0              0              0              0              0              0              0              1.1965779e-13  0              6            
    100000   9570           200            200            0.0021073156   8.4409931e-36  0              0.0063219467   577936.19      0              5.581294e+10   1.1965779e-13  0              3.3321215    
    200000   9570           200            200            0.00071091929  1.0129126e-34  0              0.0021327579   130367.82      0              1.2589991e+10  1.1965779e-13  0              3.0840806    
    300000   9570           200            200           -1.1033501e-05 -5.0645216e-35  0             -3.3100504e-05  70.45966       0              6804489.7      1.1965779e-13  0              3.0437281    
    400000   9570           200            200           -1.8213065e-05  1.6882078e-35  0             -5.4639194e-05  200.87092      0              19398676       1.1965779e-13  0              3.0053124    
    500000   9570           200            200            0.00016425544 -0.0035951008   0              0.0040878671   1019.257       0              98432545       1.1965779e-13  0              2.9957172    
    600000   9570           200            200            0.00082817615 -0.0039880809   0              0.0064726093   141.55812      0              13670670       1.1965779e-13  0              2.9946914    
    700000   9570           200            200            0.0012010805  -0.0044787657   0              0.0080820073   23.956547      0              2313551.8      1.1965779e-13  0              2.9940296    
    800000   9570           200            200            0.0011615434  -0.0044383141   0              0.0079229443   3.2466914      0              313542.21      1.1965779e-13  0              2.9940989    
    900000   9570           200            200            0.0010997749  -0.0044286023   0              0.0077279269   0.21713957     0              20969.786      1.1965779e-13  0              2.9941693    
   1000000   9570           200            200            0.0011448333  -0.0044450934   0              0.0078795932   0.0020644632   0              199.37108      1.1965779e-13  0              2.9941126    
   1100000   9570           200            200            0.0011248148  -0.004437858    0              0.0078123025   0.0012279469   0              118.58632      1.1965779e-13  0              2.9941381    
   1200000   9570           200            200            0.0011310497  -0.0044401769   0              0.0078333261   0.00076997876  0              74.359037      1.1965779e-13  0              2.99413      
   1300000   9570           200            200            0.0011298973  -0.0044397369   0              0.0078294289   0.00015336292  0              14.810693      1.1965779e-13  0              2.9941315    
   1400000   9570           200            200            0.0011297663  -0.0044396969   0              0.0078289956   1.5167889e-05  0              1.4648061      1.1965779e-13  0              2.9941317    
   1500000   9570           200            200            0.0011300026  -0.004439781    0              0.0078297888   5.3478808e-07  0              0.051646005    1.1965779e-13  0              2.9941314    
   1600000   9570           200            200            0.0011298745  -0.0044397345   0              0.0078293581   5.5375474e-09  0              0.00053477669  1.1965779e-13  0              2.9941316    
   1700000   9570           200            200            0.0011299216  -0.0044397518   0              0.0078295167   2.0897618e-08  0              0.0020181423   1.1965779e-13  0              2.9941315    
   1800000   9570           200            200            0.0011299098  -0.0044397474   0              0.007829477    6.2600288e-09  0              0.00060454877  1.1965779e-13  0              2.9941315    
   1900000   9570           200            200            0.0011299108  -0.0044397478   0              0.0078294801   8.582128e-10   0              8.288005e-05   1.1965779e-13  0              2.9941315    
   2000000   9570           200            200            0.0011299118  -0.0044397482   0              0.0078294835   5.4675203e-11  0              5.2801397e-06  1.1965779e-13  0              2.9941315    
   2100000   9570           200            200            0.001129911   -0.0044397479   0              0.007829481    3.7002633e-13  0              3.5734495e-08  1.1965779e-13  0              2.9941315    
   2200000   9570           200            200            0.0011299114  -0.004439748    0              0.0078294821   3.8753358e-13  0              3.742522e-08   1.1965779e-13  0              2.9941315    
   2300000   9570           200            200            0.0011299113  -0.004439748    0              0.0078294818   2.169051e-13   0              2.0947142e-08  1.1965779e-13  0              2.9941315    
   2400000   9570           200            200            0.0011299113  -0.004439748    0              0.0078294818   4.1381119e-14  0              3.9962923e-09  1.1965779e-13  0              2.9941315    
   2500000   9570           200            200            0.0011299113  -0.004439748    0              0.0078294818   3.89183e-15    0              3.7584509e-10  1.1965779e-13  0              2.9941315    
   2600000   9570           200            200            0.0011299113  -0.004439748    0              0.0078294818   1.3073071e-16  0              1.2625037e-11  1.1965779e-13  0              2.9941315    
   2700000   9570           200            200            0.0011299113  -0.004439748    0              0.0078294818   8.0553134e-18  0              7.7792451e-13  1.1965779e-13  0              2.9941315    
   2800000   9570           200            200            0.0011299113  -0.004439748    0              0.0078294818   1.0024625e-17  0              9.6810657e-13  1.1965779e-13  0              2.9941315    
   2900000   9570           200            200            0.0011299113  -0.004439748    0              0.0078294818   2.9548281e-18  0              2.8535615e-13  1.1965779e-13  0              2.9941315    
   3000000   9570           200            200            0.0011299113  -0.004439748    0              0.0078294818   4.5298697e-18  0              4.3746239e-13  1.1965779e-13  0              2.9941315    
Loop time of 299.351 on 4 procs for 3000000 steps with 2501 atoms

Performance: 8658723.261 ns/day, 0.000 hours/ns, 10021.670 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 11.524     | 36.343     | 61.809     | 410.8 | 12.14
Neigh   | 5.9827     | 6.0865     | 6.1916     |   3.8 |  2.03
Comm    | 22.221     | 42.585     | 80.922     | 346.6 | 14.23
Output  | 0.27236    | 0.27267    | 0.27302    |   0.1 |  0.09
Modify  | 108.99     | 157.57     | 177.34     | 224.9 | 52.64
Other   |            | 56.5       |            |       | 18.87

Nlocal:         625.25 ave         876 max         375 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:           1.75 ave           3 max           1 min
Histogram: 2 0 0 0 0 1 0 0 0 1
Neighs:         312.25 ave         625 max           0 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 1249
Ave neighs/atom = 0.49940024
Neighbor list builds = 166
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 39

#variable lat0 equal 1                    #
variable lat1 equal 3+(300*0.01)+(v_ind*0.01)  # .491+(v_ind*0.001)       # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 500*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 6.39                                                               
Lattice spacing in x,y,z = 6.39 6.39 6.39

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -4792.5 ${n1e1} -100 100 -100 100 units box
region box block -4792.5 4792.5 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -4792.5 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -4792.5 4792.5 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-4792.5 -100 -100) to (4792.5 100 100)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 1500 atoms
  using lattice units in orthogonal box = (-4792.5 -100 -100) to (4792.5 100 100)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 1500 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 1001 atoms
  using lattice units in orthogonal box = (-4792.5 -100 -100) to (4792.5 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  1500 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  1500 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  1001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  1001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
1500 atoms in group substrate
group slider1 region slider1
1001 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 1001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_39_*.dump id type diameter mass xu yu zu fx fy fz

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 6184 130 130
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 120.7 | 120.7 | 120.7 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   9585           200            200            0              0              0              0              0              0              0              1.1965779e-13  0              6            
    100000   9585           200            200            0.0021042606   1.9163433e-42  0              0.0063127817   578034.63      0              5.5822447e+10  1.1965779e-13  0              3.332055     
    200000   9585           200            200            0.00071057921  1.5169844e-33  0              0.0021317376   130591.4       0              1.2611583e+10  1.1965779e-13  0              3.0838864    
    300000   9585           200            200           -9.2718447e-06 -8.4276499e-36  0             -2.7815534e-05  49.641316      0              4794003        1.1965779e-13  0              3.043781     
    400000   9585           200            200           -1.4722922e-05  6.7422077e-35  0             -4.4168767e-05  130.51167      0              12603883       1.1965779e-13  0              3.0053862    
    500000   9585           200            200            0.0014700936   0.0015576993   0              0.0028525815   650.87141      0              62856502       1.1965779e-13  0              2.9963852    
    600000   9585           200            200            0.0038593693   0.0027200758   0              0.0088580321   168.57244      0              16279520       1.1965779e-13  0              2.9937685    
    700000   9585           200            200            0.003136668    0.0025972411   0              0.0068127628   0.53099411     0              51279.61       1.1965779e-13  0              2.9945135    
    800000   9585           200            200            0.0035475788   0.0027050488   0              0.0079376877   3.0968093      0              299067.67      1.1965779e-13  0              2.9940795    
    900000   9585           200            200            0.0035449519   0.0026928503   0              0.0079420055   0.09931044     0              9590.6915      1.1965779e-13  0              2.9940809    
   1000000   9585           200            200            0.0034905194   0.0026834107   0              0.0077881474   0.042057539    0              4061.616       1.1965779e-13  0              2.9941379    
   1100000   9585           200            200            0.0034958878   0.0026844301   0              0.0078032333   0.0038842411   0              375.1122       1.1965779e-13  0              2.9941319    
   1200000   9585           200            200            0.0035027059   0.0026856271   0              0.0078224904   0.00046872368  0              45.265978      1.1965779e-13  0              2.9941248    
   1300000   9585           200            200            0.0035013228   0.0026853755   0              0.0078185929   0.00011037788  0              10.659505      1.1965779e-13  0              2.9941263    
   1400000   9585           200            200            0.0035005369   0.0026852387   0              0.0078163722   3.6241409e-06  0              0.34999358     1.1965779e-13  0              2.9941271    
   1500000   9585           200            200            0.0035007996   0.0026852859   0              0.0078171128   2.5650403e-06  0              0.24771323     1.1965779e-13  0              2.9941268    
   1600000   9585           200            200            0.0035008802   0.0026852998   0              0.0078173408   1.037069e-08   0              0.001001527    1.1965779e-13  0              2.9941267    
   1700000   9585           200            200            0.003500837    0.0026852921   0              0.0078172188   5.1041845e-08  0              0.004929256    1.1965779e-13  0              2.9941268    
   1800000   9585           200            200            0.0035008303   0.0026852909   0              0.0078171998   6.6041874e-11  0              6.3778515e-06  1.1965779e-13  0              2.9941268    
   1900000   9585           200            200            0.0035008367   0.0026852921   0              0.0078172181   8.8166442e-10  0              8.5144839e-05  1.1965779e-13  0              2.9941268    
   2000000   9585           200            200            0.003500837    0.0026852921   0              0.0078172189   1.5763617e-11  0              1.5223373e-06  1.1965779e-13  0              2.9941268    
   2100000   9585           200            200            0.0035008361   0.002685292    0              0.0078172164   1.3117016e-11  0              1.2667475e-06  1.1965779e-13  0              2.9941268    
   2200000   9585           200            200            0.0035008362   0.002685292    0              0.0078172165   7.8538319e-13  0              7.5846687e-08  1.1965779e-13  0              2.9941268    
   2300000   9585           200            200            0.0035008363   0.002685292    0              0.0078172168   1.6187978e-13  0              1.563319e-08   1.1965779e-13  0              2.9941268    
   2400000   9585           200            200            0.0035008363   0.002685292    0              0.0078172168   2.5321996e-14  0              2.4454171e-09  1.1965779e-13  0              2.9941268    
   2500000   9585           200            200            0.0035008363   0.002685292    0              0.0078172168   1.5745177e-15  0              1.5205565e-10  1.1965779e-13  0              2.9941268    
   2600000   9585           200            200            0.0035008363   0.002685292    0              0.0078172168   6.216675e-16   0              6.0036198e-11  1.1965779e-13  0              2.9941268    
   2700000   9585           200            200            0.0035008363   0.002685292    0              0.0078172168   1.7918714e-17  0              1.7304612e-12  1.1965779e-13  0              2.9941268    
   2800000   9585           200            200            0.0035008363   0.002685292    0              0.0078172168   9.1968103e-18  0              8.8816211e-13  1.1965779e-13  0              2.9941268    
   2900000   9585           200            200            0.0035008363   0.002685292    0              0.0078172168   3.9824397e-21  0              3.8459553e-16  1.1965779e-13  0              2.9941268    
   3000000   9585           200            200            0.0035008363   0.002685292    0              0.0078172168   3.8491368e-18  0              3.7172208e-13  1.1965779e-13  0              2.9941268    
Loop time of 298.769 on 4 procs for 3000000 steps with 2501 atoms

Performance: 8675604.603 ns/day, 0.000 hours/ns, 10041.209 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 11.464     | 36.353     | 62.004     | 411.6 | 12.17
Neigh   | 5.9842     | 6.0944     | 6.2063     |   4.1 |  2.04
Comm    | 22.144     | 40.996     | 78.814     | 346.2 | 13.72
Output  | 0.27062    | 0.27094    | 0.27128    |   0.1 |  0.09
Modify  | 109.72     | 158.09     | 178.68     | 224.8 | 52.91
Other   |            | 56.97      |            |       | 19.07

Nlocal:         625.25 ave         876 max         375 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:           1.75 ave           3 max           1 min
Histogram: 2 0 0 0 0 1 0 0 0 1
Neighs:         312.25 ave         625 max           0 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 1249
Ave neighs/atom = 0.49940024
Neighbor list builds = 166
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 40

#variable lat0 equal 1                    #
variable lat1 equal 3+(300*0.01)+(v_ind*0.01)  # .491+(v_ind*0.001)       # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 500*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 6.4                                                               
Lattice spacing in x,y,z = 6.4 6.4 6.4

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -4800 ${n1e1} -100 100 -100 100 units box
region box block -4800 4800 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -4800 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -4800 4800 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-4800 -100 -100) to (4800 100 100)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 1500 atoms
  using lattice units in orthogonal box = (-4800 -100 -100) to (4800 100 100)
  create_atoms CPU = 0.000 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 1500 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 1001 atoms
  using lattice units in orthogonal box = (-4800 -100 -100) to (4800 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  1500 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  1500 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  1001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  1001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
1500 atoms in group substrate
group slider1 region slider1
1001 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 1001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_40_*.dump id type diameter mass xu yu zu fx fy fz

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 6194 130 130
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 120.8 | 120.9 | 120.9 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   9600           200            200            0              0              0              0              0              0              0              1.1965779e-13  0              6            
    100000   9600           200            200            0.0021013812  -3.3657859e-35  0              0.0063041436   578206.8       0              5.5839074e+10  1.1965779e-13  0              3.3318916    
    200000   9600           200            200            0.00070956288 -3.3657298e-35  0              0.0021286886   130615.93      0              1.2613952e+10  1.1965779e-13  0              3.0839248    
    300000   9600           200            200           -4.8048819e-06  4.4275082e-40  0             -1.4414646e-05  13.110781      0              1266145.4      1.1965779e-13  0              3.0438632    
    400000   9600           200            200            5.4879744e-06  5.0487245e-35  0              1.6463923e-05  17.903613      0              1729002.8      1.1965779e-13  0              3.0053929    
    500000   9600           200            200            0.0056093658   0.00021426478  0              0.016613833    14.603521      0              1410303.5      1.1965779e-13  0              2.9910026    
    600000   9600           200            200            0.0032570415   2.2380525e-05  0              0.0097487439   76.705831      0              7407700.1      1.1965779e-13  0              2.9928101    
    700000   9600           200            200            0.0027218362   1.6829136e-35  0              0.0081655087   17.206439      0              1661674.7      1.1965779e-13  0              2.993421     
    800000   9600           200            200            0.0026972174   8.4146098e-36  0              0.0080916522   0.068533523    0              6618.4771      1.1965779e-13  0              2.9934688    
    900000   9600           200            200            0.0026253813   4.2073163e-36  0              0.0078761439   0.22087344     0              21330.376      1.1965779e-13  0              2.993587     
   1000000   9600           200            200            0.0025980795   5.2595173e-37  0              0.0077942386   0.05055264     0              4882.0121      1.1965779e-13  0              2.9936311    
   1100000   9600           200            200            0.0025966987   3.6416048e-41  0              0.0077900961   0.00075771206  0              73.174407      1.1965779e-13  0              2.9936329    
   1200000   9600           200            200            0.0025998232   2.5243584e-35  0              0.0077994695   0.00036986166  0              35.718592      1.1965779e-13  0              2.9936277    
   1300000   9600           200            200            0.0026012744   1.2621811e-35  0              0.0078038232   0.00013215705  0              12.762782      1.1965779e-13  0              2.9936254    
   1400000   9600           200            200            0.0026014393  -1.2621737e-35  0              0.0078043179   4.2099927e-06  0              0.40657096     1.1965779e-13  0              2.9936251    
   1500000   9600           200            200            0.00260131    -4.2072209e-36  0              0.0078039299   5.2225295e-07  0              0.050435452    1.1965779e-13  0              2.9936253    
   1600000   9600           200            200            0.0026012354   8.4145527e-36  0              0.0078037063   3.241453e-07   0              0.031303633    1.1965779e-13  0              2.9936254    
   1700000   9600           200            200            0.0026012227   1.6829069e-35  0              0.0078036682   1.7597449e-08  0              0.0016994356   1.1965779e-13  0              2.9936255    
   1800000   9600           200            200            0.0026012277   2.5243585e-35  0              0.007803683    5.3998554e-10  0              5.2147938e-05  1.1965779e-13  0              2.9936255    
   1900000   9600           200            200            0.0026012314  -3.281661e-34   0              0.0078036941   7.4593836e-10  0              7.2037388e-05  1.1965779e-13  0              2.9936254    
   2000000   9600           200            200            0.0026012322   1.6829069e-35  0              0.0078036966   6.2518777e-11  0              6.037616e-06   1.1965779e-13  0              2.9936254    
   2100000   9600           200            200            0.002601232    3.6217966e-41  0              0.0078036961   2.4071433e-13  0              2.3246467e-08  1.1965779e-13  0              2.9936254    
   2200000   9600           200            200            0.0026012319   5.0487134e-35  0              0.0078036956   1.6030857e-12  0              1.5481454e-07  1.1965779e-13  0              2.9936254    
   2300000   9600           200            200            0.0026012318   3.3658102e-35  0              0.0078036955   1.9848872e-13  0              1.916862e-08   1.1965779e-13  0              2.9936254    
   2400000   9600           200            200            0.0026012318   3.3658101e-35  0              0.0078036955   7.7210246e-17  0              7.4564129e-12  1.1965779e-13  0              2.9936254    
   2500000   9600           200            200            0.0026012318  -5.0487062e-35  0              0.0078036955   3.1608921e-15  0              3.0525633e-10  1.1965779e-13  0              2.9936254    
   2600000   9600           200            200            0.0026012318   3.3658101e-35  0              0.0078036955   5.9676835e-16  0              5.7631616e-11  1.1965779e-13  0              2.9936254    
   2700000   9600           200            200            0.0026012318   6.7316167e-35  0              0.0078036955   2.264979e-17   0              2.1873546e-12  1.1965779e-13  0              2.9936254    
   2800000   9600           200            200            0.0026012318   1.6829069e-35  0              0.0078036955   2.2388659e-18  0              2.1621365e-13  1.1965779e-13  0              2.9936254    
   2900000   9600           200            200            0.0026012318  -3.3658029e-35  0              0.0078036955   5.7794365e-18  0              5.5813661e-13  1.1965779e-13  0              2.9936254    
   3000000   9600           200            200            0.0026012318   3.7469141e-41  0              0.0078036955   3.0703603e-18  0              2.9651342e-13  1.1965779e-13  0              2.9936254    
Loop time of 295.577 on 4 procs for 3000000 steps with 2501 atoms

Performance: 8769301.431 ns/day, 0.000 hours/ns, 10149.654 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 11.082     | 34.444     | 58.391     | 394.0 | 11.65
Neigh   | 5.9869     | 6.092      | 6.1981     |   3.9 |  2.06
Comm    | 22.695     | 39.993     | 74.672     | 321.5 | 13.53
Output  | 0.2729     | 0.27322    | 0.27356    |   0.1 |  0.09
Modify  | 109.29     | 157.17     | 180.07     | 226.0 | 53.17
Other   |            | 57.61      |            |       | 19.49

Nlocal:         625.25 ave         876 max         375 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:           1.75 ave           3 max           1 min
Histogram: 2 0 0 0 0 1 0 0 0 1
Neighs:         305.25 ave         611 max           0 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 1221
Ave neighs/atom = 0.48820472
Neighbor list builds = 166
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 41

#variable lat0 equal 1                    #
variable lat1 equal 3+(300*0.01)+(v_ind*0.01)  # .491+(v_ind*0.001)       # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 500*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 6.41                                                               
Lattice spacing in x,y,z = 6.41 6.41 6.41

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -4807.5 ${n1e1} -100 100 -100 100 units box
region box block -4807.5 4807.5 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -4807.5 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -4807.5 4807.5 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-4807.5 -100 -100) to (4807.5 100 100)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 1500 atoms
  using lattice units in orthogonal box = (-4807.5 -100 -100) to (4807.5 100 100)
  create_atoms CPU = 0.000 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 1500 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 1001 atoms
  using lattice units in orthogonal box = (-4807.5 -100 -100) to (4807.5 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  1500 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  1500 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  1001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  1001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
1500 atoms in group substrate
group slider1 region slider1
1001 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 1001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_41_*.dump id type diameter mass xu yu zu fx fy fz

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 6204 130 130
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 121 | 121 | 121.1 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   9615           200            200            0              0              0              0              0              0              0              1.1965779e-13  0              6            
    100000   9615           200            200            0.0020978301  -4.2006675e-36  0              0.0062934902   578081.88      0              5.582701e+10   1.1965779e-13  0              3.3320804    
    200000   9615           200            200            0.00070857053 -1.6802613e-35  0              0.0021257116   130647.42      0              1.2616992e+10  1.1965779e-13  0              3.0839371    
    300000   9615           200            200           -8.4288598e-06  5.8809762e-35  0             -2.5286579e-05  41.164537      0              3975376.3      1.1965779e-13  0              3.0438879    
    400000   9615           200            200           -1.0425395e-05  5.0408493e-35  0             -3.1276186e-05  65.060312      0              6283059.3      1.1965779e-13  0              3.0055223    
    500000   9615           200            200            0.00047870373 -0.00077972435  0              0.0022158355   370.37125      0              35767804       1.1965779e-13  0              2.9968583    
    600000   9615           200            200            0.0022353539  -0.0026429905   0              0.0093490523   138.2174       0              13348048       1.1965779e-13  0              2.9936281    
    700000   9615           200            200            0.0012000826  -0.0032124678   0              0.0068127158   1.4715166      0              142108.54      1.1965779e-13  0              2.9945537    
    800000   9615           200            200            0.0016703344  -0.0030793247   0              0.0080903279   1.2996429      0              125510.21      1.1965779e-13  0              2.9940608    
    900000   9615           200            200            0.0015683072  -0.0030914492   0              0.0077963708   0.46497607     0              44904.061      1.1965779e-13  0              2.9941734    
   1000000   9615           200            200            0.001553763   -0.0030898526   0              0.0077511415   0.020843823    0              2012.9472      1.1965779e-13  0              2.9941893    
   1100000   9615           200            200            0.0015728277  -0.0030921219   0              0.007810605    0.00085794147  0              82.853846      1.1965779e-13  0              2.994167     
   1200000   9615           200            200            0.0015665305  -0.0030913382   0              0.0077909296   0.0010369877   0              100.14485      1.1965779e-13  0              2.9941745    
   1300000   9615           200            200            0.0015666925  -0.0030913647   0              0.0077914423   0.00010048194  0              9.7038266      1.1965779e-13  0              2.9941742    
   1400000   9615           200            200            0.001567472   -0.0030914579   0              0.0077938738   2.8534516e-11  0              2.7556593e-06  1.1965779e-13  0              2.9941733    
   1500000   9615           200            200            0.0015671119  -0.0030914139   0              0.0077927496   1.8227827e-06  0              0.17603131     1.1965779e-13  0              2.9941738    
   1600000   9615           200            200            0.001567163   -0.0030914204   0              0.0077929094   3.4409611e-07  0              0.033230339    1.1965779e-13  0              2.9941737    
   1700000   9615           200            200            0.0015671894  -0.0030914235   0              0.0077929917   5.2424256e-09  0              0.00050627594  1.1965779e-13  0              2.9941737    
   1800000   9615           200            200            0.001567171   -0.0030914213   0              0.0077929344   2.2772386e-09  0              0.0002199194   1.1965779e-13  0              2.9941737    
   1900000   9615           200            200            0.0015671754  -0.0030914218   0              0.0077929482   9.2881085e-10  0              8.9697903e-05  1.1965779e-13  0              2.9941737    
   2000000   9615           200            200            0.001567176   -0.0030914219   0              0.0077929499   4.6066368e-11  0              4.44876e-06    1.1965779e-13  0              2.9941737    
   2100000   9615           200            200            0.0015671752  -0.0030914218   0              0.0077929473   1.3608623e-12  0              1.3142234e-07  1.1965779e-13  0              2.9941737    
   2200000   9615           200            200            0.0015671755  -0.0030914218   0              0.0077929482   2.0216314e-12  0              1.9523469e-07  1.1965779e-13  0              2.9941737    
   2300000   9615           200            200            0.0015671755  -0.0030914218   0              0.0077929482   2.1108634e-13  0              2.0385208e-08  1.1965779e-13  0              2.9941737    
   2400000   9615           200            200            0.0015671754  -0.0030914218   0              0.0077929481   6.5042073e-17  0              6.2812979e-12  1.1965779e-13  0              2.9941737    
   2500000   9615           200            200            0.0015671754  -0.0030914218   0              0.0077929481   3.4826862e-15  0              3.363329e-10   1.1965779e-13  0              2.9941737    
   2600000   9615           200            200            0.0015671754  -0.0030914218   0              0.0077929481   6.9525885e-16  0              6.7143123e-11  1.1965779e-13  0              2.9941737    
   2700000   9615           200            200            0.0015671754  -0.0030914218   0              0.0077929481   3.6780575e-18  0              3.5520047e-13  1.1965779e-13  0              2.9941737    
   2800000   9615           200            200            0.0015671754  -0.0030914218   0              0.0077929481   6.9044974e-18  0              6.6678694e-13  1.1965779e-13  0              2.9941737    
   2900000   9615           200            200            0.0015671754  -0.0030914218   0              0.0077929481   6.7590381e-18  0              6.5273952e-13  1.1965779e-13  0              2.9941737    
   3000000   9615           200            200            0.0015671754  -0.0030914218   0              0.0077929481   1.0308354e-18  0              9.9550706e-14  1.1965779e-13  0              2.9941737    
Loop time of 296.522 on 4 procs for 3000000 steps with 2501 atoms

Performance: 8741332.338 ns/day, 0.000 hours/ns, 10117.283 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 11.039     | 35.885     | 61.276     | 411.2 | 12.10
Neigh   | 5.9768     | 6.083      | 6.1926     |   4.0 |  2.05
Comm    | 22.232     | 40.519     | 77.77      | 342.6 | 13.66
Output  | 0.26931    | 0.26962    | 0.26992    |   0.1 |  0.09
Modify  | 109.08     | 157.25     | 177.45     | 224.8 | 53.03
Other   |            | 56.52      |            |       | 19.06

Nlocal:         625.25 ave         876 max         375 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:           1.75 ave           3 max           1 min
Histogram: 2 0 0 0 0 1 0 0 0 1
Neighs:         311.25 ave         623 max           0 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 1245
Ave neighs/atom = 0.49780088
Neighbor list builds = 166
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 42

#variable lat0 equal 1                    #
variable lat1 equal 3+(300*0.01)+(v_ind*0.01)  # .491+(v_ind*0.001)       # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 500*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 6.42                                                               
Lattice spacing in x,y,z = 6.42 6.42 6.42

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -4815 ${n1e1} -100 100 -100 100 units box
region box block -4815 4815 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -4815 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -4815 4815 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-4815 -100 -100) to (4815 100 100)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 1500 atoms
  using lattice units in orthogonal box = (-4815 -100 -100) to (4815 100 100)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 1500 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 1001 atoms
  using lattice units in orthogonal box = (-4815 -100 -100) to (4815 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  1500 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  1500 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  1001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  1001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
1500 atoms in group substrate
group slider1 region slider1
1001 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 1001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_42_*.dump id type diameter mass xu yu zu fx fy fz

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 6213 130 130
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 121.2 | 121.3 | 121.3 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   9630           200            200            0              0              0              0              0              0              0              1.1965779e-13  0              6            
    100000   9630           200            200            0.0020940651   4.1941687e-36  0              0.0062821953   577884.94      0              5.5807991e+10  1.1965779e-13  0              3.3321715    
    200000   9630           200            200            0.00070697992  1.2448061e-40  0              0.0021209398   130514.69      0              1.2604175e+10  1.1965779e-13  0              3.0838563    
    300000   9630           200            200           -8.4487342e-06 -3.3553013e-35  0             -2.5346203e-05  41.499341      0              4007709.3      1.1965779e-13  0              3.0436569    
    400000   9630           200            200           -1.2928802e-05  6.4599484e-45  0             -3.8786407e-05  101.12499      0              9765927.5      1.1965779e-13  0              3.0052734    
    500000   9630           200            200            0.00071587043 -0.0021829062   0              0.0043305175   1060.3059      0              1.0239675e+08  1.1965779e-13  0              2.9954485    
    600000   9630           200            200            0.001164173   -0.0025807098   0              0.0060732289   109.88973      0              10612363       1.1965779e-13  0              2.9946637    
    700000   9630           200            200            0.0015030361  -0.0029490283   0              0.0074581365   23.397731      0              2259585.4      1.1965779e-13  0              2.9940615    
    800000   9630           200            200            0.0017260026  -0.0029740505   0              0.0081520582   0.16000157     0              15451.806      1.1965779e-13  0              2.9938093    
    900000   9630           200            200            0.0016160102  -0.0029632676   0              0.0078112981   0.44089474     0              42578.458      1.1965779e-13  0              2.9939363    
   1000000   9630           200            200            0.001590646   -0.0029589055   0              0.0077308436   0.0033271984   0              321.317        1.1965779e-13  0              2.9939655    
   1100000   9630           200            200            0.001604671   -0.0029614338   0              0.007775447    0.0079030449   0              763.21951      1.1965779e-13  0              2.9939486    
   1200000   9630           200            200            0.0016082622  -0.0029620522   0              0.0077868388   7.6677657e-05  0              7.4049793      1.1965779e-13  0              2.9939444    
   1300000   9630           200            200            0.0016064057  -0.0029617181   0              0.0077809353   0.00014159388  0              13.674124      1.1965779e-13  0              2.9939467    
   1400000   9630           200            200            0.0016059014  -0.0029616311   0              0.0077793354   1.7189321e-06  0              0.16600216     1.1965779e-13  0              2.9939473    
   1500000   9630           200            200            0.0016061463  -0.0029616752   0              0.0077801142   2.5311924e-06  0              0.24444445     1.1965779e-13  0              2.993947     
   1600000   9630           200            200            0.001606217   -0.0029616874   0              0.0077803385   3.7735668e-08  0              0.0036442407   1.1965779e-13  0              2.9939469    
   1700000   9630           200            200            0.0016061848  -0.0029616816   0              0.0077802359   4.5162743e-08  0              0.0043614945   1.1965779e-13  0              2.9939469    
   1800000   9630           200            200            0.0016061749  -0.0029616799   0              0.0077802045   8.1381857e-10  0              7.8592773e-05  1.1965779e-13  0              2.9939469    
   1900000   9630           200            200            0.0016061791  -0.0029616807   0              0.007780218    8.0420791e-10  0              7.7664644e-05  1.1965779e-13  0              2.9939469    
   2000000   9630           200            200            0.0016061805  -0.0029616809   0              0.0077802224   1.729273e-11   0              1.6700081e-06  1.1965779e-13  0              2.9939469    
   2100000   9630           200            200            0.0016061799  -0.0029616808   0              0.0077802206   1.4294258e-11  0              1.3804371e-06  1.1965779e-13  0              2.9939469    
   2200000   9630           200            200            0.0016061798  -0.0029616808   0              0.00778022     3.6252705e-13  0              3.5010267e-08  1.1965779e-13  0              2.9939469    
   2300000   9630           200            200            0.0016061798  -0.0029616808   0              0.0077802203   2.5368097e-13  0              2.4498692e-08  1.1965779e-13  0              2.9939469    
   2400000   9630           200            200            0.0016061799  -0.0029616808   0              0.0077802204   7.3886089e-15  0              7.1353897e-10  1.1965779e-13  0              2.9939469    
   2500000   9630           200            200            0.0016061798  -0.0029616808   0              0.0077802203   4.5022373e-15  0              4.3479385e-10  1.1965779e-13  0              2.9939469    
   2600000   9630           200            200            0.0016061798  -0.0029616808   0              0.0077802203   1.502101e-16   0              1.4506217e-11  1.1965779e-13  0              2.9939469    
   2700000   9630           200            200            0.0016061798  -0.0029616808   0              0.0077802203   6.3508487e-17  0              6.1331951e-12  1.1965779e-13  0              2.9939469    
   2800000   9630           200            200            0.0016061798  -0.0029616808   0              0.0077802203   6.2541337e-18  0              6.0397947e-13  1.1965779e-13  0              2.9939469    
   2900000   9630           200            200            0.0016061798  -0.0029616808   0              0.0077802203   3.4218262e-18  0              3.3045548e-13  1.1965779e-13  0              2.9939469    
   3000000   9630           200            200            0.0016061798  -0.0029616808   0              0.0077802203   5.800824e-18   0              5.6020206e-13  1.1965779e-13  0              2.9939469    
Loop time of 299.927 on 4 procs for 3000000 steps with 2501 atoms

Performance: 8642090.552 ns/day, 0.000 hours/ns, 10002.420 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 11.183     | 36.606     | 63.056     | 417.6 | 12.20
Neigh   | 5.8882     | 5.9933     | 6.0997     |   3.9 |  2.00
Comm    | 22.338     | 41.418     | 79.803     | 349.5 | 13.81
Output  | 0.27398    | 0.27429    | 0.27461    |   0.1 |  0.09
Modify  | 110.2      | 158.61     | 179.25     | 224.0 | 52.88
Other   |            | 57.02      |            |       | 19.01

Nlocal:         625.25 ave         876 max         375 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:           1.75 ave           3 max           1 min
Histogram: 2 0 0 0 0 1 0 0 0 1
Neighs:         312.75 ave         626 max           0 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 1251
Ave neighs/atom = 0.50019992
Neighbor list builds = 166
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 43

#variable lat0 equal 1                    #
variable lat1 equal 3+(300*0.01)+(v_ind*0.01)  # .491+(v_ind*0.001)       # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 500*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 6.43                                                               
Lattice spacing in x,y,z = 6.43 6.43 6.43

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -4822.5 ${n1e1} -100 100 -100 100 units box
region box block -4822.5 4822.5 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -4822.5 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -4822.5 4822.5 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-4822.5 -100 -100) to (4822.5 100 100)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 1500 atoms
  using lattice units in orthogonal box = (-4822.5 -100 -100) to (4822.5 100 100)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 1500 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 1001 atoms
  using lattice units in orthogonal box = (-4822.5 -100 -100) to (4822.5 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  1500 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  1500 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  1001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  1001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
1500 atoms in group substrate
group slider1 region slider1
1001 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 1001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_43_*.dump id type diameter mass xu yu zu fx fy fz

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 6223 130 130
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 121.4 | 121.4 | 121.4 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   9645           200            200            0              0              0              0              0              0              0              1.1965779e-13  0              6            
    100000   9645           200            200            0.0020912454  -1.2562878e-35  0              0.0062737362   578070.49      0              5.5825911e+10  1.1965779e-13  0              3.3319916    
    200000   9645           200            200            0.00070990418  8.3752764e-36  0              0.0021297125   131709.37      0              1.2719548e+10  1.1965779e-13  0              3.0823586    
    300000   9645           200            200            1.060697e-06  -3.3500669e-35  0              3.1820911e-06  0.71814052     0              69352.871      1.1965779e-13  0              3.0434023    
    400000   9645           200            200            5.4501365e-06  1.0050386e-34  0              1.6350409e-05  17.830155      0              1721908.7      1.1965779e-13  0              3.0049241    
    500000   9645           200            200            0.00033801547 -0.0014883639   0              0.0025024103   454.74674      0              43916185       1.1965779e-13  0              2.9960097    
    600000   9645           200            200           -0.00096783512 -0.010994606    0              0.008091101    186.16485      0              17978469       1.1965779e-13  0              2.9933479    
    700000   9645           200            200           -0.001605851   -0.011976918    0              0.0071593653   15.921121      0              1537547.9      1.1965779e-13  0              2.9936804    
    800000   9645           200            200           -0.0014261045  -0.012386541    0              0.0081082274   0.54237915     0              52379.096      1.1965779e-13  0              2.9933222    
    900000   9645           200            200           -0.0015210549  -0.012195617    0              0.0076324521   0.0036365326   0              351.19029      1.1965779e-13  0              2.9935017    
   1000000   9645           200            200           -0.0014865071  -0.012267267    0              0.007807746    0.019218437    0              1855.9791      1.1965779e-13  0              2.9934343    
   1100000   9645           200            200           -0.0014962216  -0.0122474      0              0.007758735    0.0065410898   0              631.69163      1.1965779e-13  0              2.9934534    
   1200000   9645           200            200           -0.0014947295  -0.0122507      0              0.0077665115   0.0011073175   0              106.9368       1.1965779e-13  0              2.9934502    
   1300000   9645           200            200           -0.0014943833  -0.012251278    0              0.0077681284   0.00010948463  0              10.573241      1.1965779e-13  0              2.9934497    
   1400000   9645           200            200           -0.001494807   -0.012250462    0              0.0077660415   4.9812389e-06  0              0.4810524      1.1965779e-13  0              2.9934504    
   1500000   9645           200            200           -0.0014945815  -0.012250909    0              0.0077671641   4.8789326e-10  0              4.7117239e-05  1.1965779e-13  0              2.99345      
   1600000   9645           200            200           -0.0014946692  -0.012250732    0              0.0077667245   8.2330783e-08  0              0.0079509178   1.1965779e-13  0              2.9934502    
   1700000   9645           200            200           -0.0014946433  -0.012250785    0              0.0077668554   3.5082889e-08  0              0.0033880543   1.1965779e-13  0              2.9934501    
   1800000   9645           200            200           -0.0014946481  -0.012250775    0              0.0077668306   6.660308e-09   0              0.00064320487  1.1965779e-13  0              2.9934502    
   1900000   9645           200            200           -0.0014946485  -0.012250774    0              0.0077668289   7.3740013e-10  0              7.1212827e-05  1.1965779e-13  0              2.9934502    
   2000000   9645           200            200           -0.0014946476  -0.012250776    0              0.0077668333   4.1397334e-11  0              3.9978582e-06  1.1965779e-13  0              2.9934501    
   2100000   9645           200            200           -0.0014946481  -0.012250775    0              0.0077668307   2.2045054e-13  0              2.1289536e-08  1.1965779e-13  0              2.9934502    
   2200000   9645           200            200           -0.0014946479  -0.012250775    0              0.0077668318   3.209294e-13   0              3.0993064e-08  1.1965779e-13  0              2.9934502    
   2300000   9645           200            200           -0.001494648   -0.012250775    0              0.0077668315   1.8272695e-13  0              1.7646461e-08  1.1965779e-13  0              2.9934502    
   2400000   9645           200            200           -0.0014946479  -0.012250775    0              0.0077668315   3.9146239e-14  0              3.7804635e-09  1.1965779e-13  0              2.9934502    
   2500000   9645           200            200           -0.0014946479  -0.012250775    0              0.0077668315   4.8512129e-15  0              4.6849541e-10  1.1965779e-13  0              2.9934502    
   2600000   9645           200            200           -0.0014946479  -0.012250775    0              0.0077668315   3.3613308e-16  0              3.2461327e-11  1.1965779e-13  0              2.9934502    
   2700000   9645           200            200           -0.0014946479  -0.012250775    0              0.0077668315   3.8366918e-19  0              3.7052023e-14  1.1965779e-13  0              2.9934502    
   2800000   9645           200            200           -0.0014946479  -0.012250775    0              0.0077668315   4.0414273e-18  0              3.9029212e-13  1.1965779e-13  0              2.9934502    
   2900000   9645           200            200           -0.0014946479  -0.012250775    0              0.0077668315   8.2588176e-19  0              7.9757749e-14  1.1965779e-13  0              2.9934502    
   3000000   9645           200            200           -0.001494648   -0.012250775    0              0.0077668315   3.6622875e-19  0              3.5367752e-14  1.1965779e-13  0              2.9934502    
Loop time of 299.062 on 4 procs for 3000000 steps with 2501 atoms

Performance: 8667112.420 ns/day, 0.000 hours/ns, 10031.380 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 11.114     | 36.039     | 61.152     | 411.9 | 12.05
Neigh   | 6.0375     | 6.1479     | 6.262      |   4.1 |  2.06
Comm    | 22.863     | 40.884     | 77.716     | 337.3 | 13.67
Output  | 0.27302    | 0.27336    | 0.27368    |   0.1 |  0.09
Modify  | 110.98     | 158.26     | 180.35     | 220.5 | 52.92
Other   |            | 57.46      |            |       | 19.21

Nlocal:         625.25 ave         876 max         375 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:           1.75 ave           3 max           1 min
Histogram: 2 0 0 0 0 1 0 0 0 1
Neighs:         313.25 ave         627 max           0 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 1253
Ave neighs/atom = 0.5009996
Neighbor list builds = 166
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 44

#variable lat0 equal 1                    #
variable lat1 equal 3+(300*0.01)+(v_ind*0.01)  # .491+(v_ind*0.001)       # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 500*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 6.44                                                               
Lattice spacing in x,y,z = 6.44 6.44 6.44

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -4830 ${n1e1} -100 100 -100 100 units box
region box block -4830 4830 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -4830 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -4830 4830 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-4830 -100 -100) to (4830 100 100)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 1500 atoms
  using lattice units in orthogonal box = (-4830 -100 -100) to (4830 100 100)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 1500 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 1001 atoms
  using lattice units in orthogonal box = (-4830 -100 -100) to (4830 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  1500 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  1500 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  1001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  1001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
1500 atoms in group substrate
group slider1 region slider1
1001 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 1001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_44_*.dump id type diameter mass xu yu zu fx fy fz

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 6233 130 130
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 121.6 | 121.6 | 121.6 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   9660           200            200            0              0              0              0              0              0              0              1.1965779e-13  0              6            
    100000   9660           200            200            0.0020879612   2.6188988e-41  0              0.0062638837   578047.81      0              5.582372e+10   1.1965779e-13  0              3.3320639    
    200000   9660           200            200            0.00070487402  6.2915734e-40  0              0.002114622    130533.44      0              1.2605985e+10  1.1965779e-13  0              3.0840035    
    300000   9660           200            200           -9.6051484e-06  4.181146e-36   0             -2.8815445e-05  54.181085      0              5232421.4      1.1965779e-13  0              3.0438358    
    400000   9660           200            200           -1.351804e-05  -1.3379508e-34  0             -4.0554121e-05  111.42064      0              10760207       1.1965779e-13  0              3.0054621    
    500000   9660           200            200            0.0010793364   0.00072166007  0              0.0025163491   512.97825      0              49539768       1.1965779e-13  0              2.9966499    
    600000   9660           200            200            0.0032012044   0.00077533182  0              0.0088282814   165.69185      0              16001333       1.1965779e-13  0              2.9938017    
    700000   9660           200            200            0.0026645829   0.0010751068   0              0.006918642    8.0545224      0              777848.12      1.1965779e-13  0              2.9945028    
    800000   9660           200            200            0.0030382481   0.00098352348  0              0.0081312207   0.032790148    0              3166.6378      1.1965779e-13  0              2.9940393    
    900000   9660           200            200            0.0028845881   0.00098976817  0              0.0076639962   0.24861687     0              24009.638      1.1965779e-13  0              2.9942169    
   1000000   9660           200            200            0.0029151263   0.00098815608  0              0.0077572227   0.062694099    0              6054.5473      1.1965779e-13  0              2.9941802    
   1100000   9660           200            200            0.0029189438   0.00098799357  0              0.0077688378   0.0049005012   0              473.25533      1.1965779e-13  0              2.9941763    
   1200000   9660           200            200            0.0029127311   0.00098828783  0              0.0077499054   2.1231349e-05  0              2.0503717      1.1965779e-13  0              2.9941834    
   1300000   9660           200            200            0.0029156256   0.00098814753  0              0.0077587291   4.7819456e-05  0              4.6180607      1.1965779e-13  0              2.99418      
   1400000   9660           200            200            0.0029148759   0.0009881844   0              0.0077564434   1.9488375e-05  0              1.8820477      1.1965779e-13  0              2.9941809    
   1500000   9660           200            200            0.0029148965   0.00098818303  0              0.0077565066   2.2155194e-06  0              0.21395901     1.1965779e-13  0              2.9941809    
   1600000   9660           200            200            0.0029149864   0.0009881788   0              0.0077567803   4.8765195e-08  0              0.0047093934   1.1965779e-13  0              2.9941808    
   1700000   9660           200            200            0.0029149343   0.0009881813   0              0.0077566216   6.3509703e-09  0              0.00061333125  1.1965779e-13  0              2.9941808    
   1800000   9660           200            200            0.0029149507   0.0009881805   0              0.0077566717   5.4029762e-09  0              0.00052178077  1.1965779e-13  0              2.9941808    
   1900000   9660           200            200            0.0029149488   0.0009881806   0              0.0077566656   8.7410711e-10  0              8.4415008e-05  1.1965779e-13  0              2.9941808    
   2000000   9660           200            200            0.0029149476   0.00098818066  0              0.0077566622   3.9685827e-11  0              3.8325731e-06  1.1965779e-13  0              2.9941808    
   2100000   9660           200            200            0.0029149485   0.00098818061  0              0.0077566649   2.8455378e-13  0              2.7480167e-08  1.1965779e-13  0              2.9941808    
   2200000   9660           200            200            0.0029149482   0.00098818063  0              0.0077566639   1.3044562e-12  0              1.2597505e-07  1.1965779e-13  0              2.9941808    
   2300000   9660           200            200            0.0029149482   0.00098818063  0              0.0077566641   3.0759261e-13  0              2.9705092e-08  1.1965779e-13  0              2.9941808    
   2400000   9660           200            200            0.0029149483   0.00098818063  0              0.0077566641   2.2447502e-14  0              2.1678191e-09  1.1965779e-13  0              2.9941808    
   2500000   9660           200            200            0.0029149482   0.00098818063  0              0.0077566641   4.8934976e-17  0              4.7257897e-12  1.1965779e-13  0              2.9941808    
   2600000   9660           200            200            0.0029149482   0.00098818063  0              0.0077566641   2.4228898e-16  0              2.3398536e-11  1.1965779e-13  0              2.9941808    
   2700000   9660           200            200            0.0029149482   0.00098818063  0              0.0077566641   9.9178723e-17  0              9.5779712e-12  1.1965779e-13  0              2.9941808    
   2800000   9660           200            200            0.0029149482   0.00098818063  0              0.0077566641   6.0014299e-18  0              5.7957514e-13  1.1965779e-13  0              2.9941808    
   2900000   9660           200            200            0.0029149482   0.00098818063  0              0.0077566641   7.6330102e-20  0              7.3714149e-15  1.1965779e-13  0              2.9941808    
   3000000   9660           200            200            0.0029149482   0.00098818063  0              0.0077566641   4.3996847e-18  0              4.2489006e-13  1.1965779e-13  0              2.9941808    
Loop time of 297.945 on 4 procs for 3000000 steps with 2501 atoms

Performance: 8699596.959 ns/day, 0.000 hours/ns, 10068.978 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 11.157     | 35.68      | 60.826     | 408.0 | 11.98
Neigh   | 6.0122     | 6.1198     | 6.2299     |   4.0 |  2.05
Comm    | 22.729     | 40.64      | 77.337     | 336.9 | 13.64
Output  | 0.2706     | 0.2709     | 0.27123    |   0.1 |  0.09
Modify  | 109.29     | 157.62     | 180.06     | 226.1 | 52.90
Other   |            | 57.62      |            |       | 19.34

Nlocal:         625.25 ave         876 max         375 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:           1.75 ave           3 max           1 min
Histogram: 2 0 0 0 0 1 0 0 0 1
Neighs:         310.75 ave         622 max           0 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 1243
Ave neighs/atom = 0.4970012
Neighbor list builds = 166
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 45

#variable lat0 equal 1                    #
variable lat1 equal 3+(300*0.01)+(v_ind*0.01)  # .491+(v_ind*0.001)       # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 500*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 6.45                                                               
Lattice spacing in x,y,z = 6.45 6.45 6.45

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -4837.5 ${n1e1} -100 100 -100 100 units box
region box block -4837.5 4837.5 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -4837.5 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -4837.5 4837.5 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-4837.5 -100 -100) to (4837.5 100 100)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 1500 atoms
  using lattice units in orthogonal box = (-4837.5 -100 -100) to (4837.5 100 100)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 1500 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 1001 atoms
  using lattice units in orthogonal box = (-4837.5 -100 -100) to (4837.5 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  1500 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  1500 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  1001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  1001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
1500 atoms in group substrate
group slider1 region slider1
1001 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 1001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_45_*.dump id type diameter mass xu yu zu fx fy fz

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 6242 130 130
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 121.7 | 121.7 | 121.7 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   9675           200            200            0              0              0              0              0              0              0              1.1965779e-13  0              6            
    100000   9675           200            200            0.0020840523   5.9363688e-42  0              0.0062521568   577775.44      0              5.5797417e+10  1.1965779e-13  0              3.3322291    
    200000   9675           200            200            0.00070233697  8.3493511e-36  0              0.0021070109   130116.22      0              1.2565693e+10  1.1965779e-13  0              3.0842653    
    300000   9675           200            200           -1.1222785e-05  1.6698788e-35  0             -3.3668355e-05  74.580727      0              7202472.7      1.1965779e-13  0              3.0435972    
    400000   9675           200            200           -2.0346268e-05  2.5417803e-40  0             -6.1038805e-05  257.72162      0              24888909       1.1965779e-13  0              3.0051706    
    500000   9675           200            200            0.00058766407 -1.1688971e-34  0              0.0017629922   36.879939      0              3561600.5      1.1965779e-13  0              2.9970764    
    600000   9675           200            200            0.0023787708   0.00095625949  0              0.0061800529   140.60883      0              13578995       1.1965779e-13  0              2.9945443    
    700000   9675           200            200            0.0033288557   0.0018244907   0              0.0081620764   22.22399       0              2146233.9      1.1965779e-13  0              2.993819     
    800000   9675           200            200            0.0031669584   0.0017903247   0              0.0077105505   3.5030508      0              338299.57      1.1965779e-13  0              2.9939801    
    900000   9675           200            200            0.0031645512   0.0017905086   0              0.0077031451   0.44177931     0              42663.884      1.1965779e-13  0              2.9939793    
   1000000   9675           200            200            0.0031905459   0.0017953349   0              0.0077763028   0.04193001     0              4049.3002      1.1965779e-13  0              2.9939555    
   1100000   9675           200            200            0.0031731445   0.0017920323   0              0.0077274013   0.0025904793   0              250.16995      1.1965779e-13  0              2.9939718    
   1200000   9675           200            200            0.0031816221   0.0017936644   0              0.0077512018   5.4535276e-05  0              5.2666266      1.1965779e-13  0              2.9939638    
   1300000   9675           200            200            0.0031781447   0.0017929917   0              0.0077414423   3.2134325e-06  0              0.31033031     1.1965779e-13  0              2.9939671    
   1400000   9675           200            200            0.0031793908   0.0017932346   0              0.0077449379   4.9627614e-06  0              0.47926798     1.1965779e-13  0              2.9939659    
   1500000   9675           200            200            0.0031790035   0.0017931585   0              0.0077438519   1.6615495e-06  0              0.16046056     1.1965779e-13  0              2.9939663    
   1600000   9675           200            200            0.0031791016   0.001793178    0              0.0077441267   3.4260279e-07  0              0.033086125    1.1965779e-13  0              2.9939662    
   1700000   9675           200            200            0.0031790864   0.0017931749   0              0.0077440843   5.2151139e-08  0              0.0050363837   1.1965779e-13  0              2.9939662    
   1800000   9675           200            200            0.0031790836   0.0017931744   0              0.0077440764   6.0815136e-09  0              0.00058730905  1.1965779e-13  0              2.9939662    
   1900000   9675           200            200            0.0031790876   0.0017931752   0              0.0077440875   5.1930875e-10  0              5.0151122e-05  1.1965779e-13  0              2.9939662    
   2000000   9675           200            200            0.0031790852   0.0017931747   0              0.0077440809   2.6441655e-11  0              2.5535457e-06  1.1965779e-13  0              2.9939662    
   2100000   9675           200            200            0.0031790863   0.0017931749   0              0.007744084    2.1158252e-13  0              2.0433126e-08  1.1965779e-13  0              2.9939662    
   2200000   9675           200            200            0.0031790859   0.0017931748   0              0.0077440828   1.4231452e-13  0              1.3743718e-08  1.1965779e-13  0              2.9939662    
   2300000   9675           200            200            0.003179086    0.0017931749   0              0.0077440832   1.0297031e-13  0              9.9441352e-09  1.1965779e-13  0              2.9939662    
   2400000   9675           200            200            0.003179086    0.0017931749   0              0.0077440831   2.8754874e-14  0              2.7769399e-09  1.1965779e-13  0              2.9939662    
   2500000   9675           200            200            0.003179086    0.0017931749   0              0.0077440831   5.4102519e-15  0              5.224834e-10   1.1965779e-13  0              2.9939662    
   2600000   9675           200            200            0.003179086    0.0017931749   0              0.0077440831   7.6598623e-16  0              7.3973467e-11  1.1965779e-13  0              2.9939662    
   2700000   9675           200            200            0.003179086    0.0017931749   0              0.0077440831   7.8118813e-17  0              7.5441558e-12  1.1965779e-13  0              2.9939662    
   2800000   9675           200            200            0.003179086    0.0017931749   0              0.0077440831   1.6513457e-18  0              1.5947514e-13  1.1965779e-13  0              2.9939662    
   2900000   9675           200            200            0.003179086    0.0017931749   0              0.0077440831   6.354224e-18   0              6.1364548e-13  1.1965779e-13  0              2.9939662    
   3000000   9675           200            200            0.003179086    0.0017931749   0              0.0077440831   2.4373571e-19  0              2.353825e-14   1.1965779e-13  0              2.9939662    
Loop time of 296.809 on 4 procs for 3000000 steps with 2501 atoms

Performance: 8732881.285 ns/day, 0.000 hours/ns, 10107.501 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 11.057     | 36.237     | 61.98      | 414.7 | 12.21
Neigh   | 6.0252     | 6.1289     | 6.2351     |   3.9 |  2.06
Comm    | 22.579     | 40.944     | 78.551     | 343.9 | 13.79
Output  | 0.27537    | 0.27568    | 0.27602    |   0.1 |  0.09
Modify  | 109.25     | 157        | 177.08     | 222.3 | 52.90
Other   |            | 56.22      |            |       | 18.94

Nlocal:         625.25 ave         876 max         375 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:           1.75 ave           3 max           1 min
Histogram: 2 0 0 0 0 1 0 0 0 1
Neighs:         313.75 ave         628 max           0 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 1255
Ave neighs/atom = 0.50179928
Neighbor list builds = 166
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 46

#variable lat0 equal 1                    #
variable lat1 equal 3+(300*0.01)+(v_ind*0.01)  # .491+(v_ind*0.001)       # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 500*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 6.46                                                               
Lattice spacing in x,y,z = 6.46 6.46 6.46

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -4845 ${n1e1} -100 100 -100 100 units box
region box block -4845 4845 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -4845 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -4845 4845 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-4845 -100 -100) to (4845 100 100)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 1500 atoms
  using lattice units in orthogonal box = (-4845 -100 -100) to (4845 100 100)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 1500 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 1001 atoms
  using lattice units in orthogonal box = (-4845 -100 -100) to (4845 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  1500 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  1500 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  1001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  1001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
1500 atoms in group substrate
group slider1 region slider1
1001 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 1001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_46_*.dump id type diameter mass xu yu zu fx fy fz

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 6252 130 130
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 121.9 | 121.9 | 121.9 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   9690           200            200            0              0              0              0              0              0              0              1.1965779e-13  0              6            
    100000   9690           200            200            0.002080976   -3.1261349e-36  0              0.0062429279   577833.15      0              5.5802989e+10  1.1965779e-13  0              3.3322176    
    200000   9690           200            200            0.00070197381 -6.2522701e-36  0              0.0021059214   130328.71      0              1.2586214e+10  1.1965779e-13  0              3.0840641    
    300000   9690           200            200           -1.0346887e-05  1.4238965e-40  0             -3.1040662e-05  63.424358      0              6125070.5      1.1965779e-13  0              3.043661     
    400000   9690           200            200           -1.5989065e-05 -4.584997e-35   0             -4.7967195e-05  157.91563      0              15250361       1.1965779e-13  0              3.0052718    
    500000   9690           200            200           -0.00071380466 -0.0055212676   0              0.0033798536   836.35205      0              80768894       1.1965779e-13  0              2.9959834    
    600000   9690           200            200            0.00062417554 -0.0055280858   0              0.0074006124   187.82619      0              18138909       1.1965779e-13  0              2.9941909    
    700000   9690           200            200            0.00086547182 -0.0047137067   0              0.0073101221   21.271896      0              2054287.5      1.1965779e-13  0              2.994198     
    800000   9690           200            200            0.0011164225  -0.0047285492   0              0.0080778167   0.54767666     0              52890.692      1.1965779e-13  0              2.9939125    
    900000   9690           200            200            0.00094938132 -0.0047583529   0              0.0076064968   0.066595464    0              6431.3133      1.1965779e-13  0              2.9940904    
   1000000   9690           200            200            0.00099882308 -0.0047538666   0              0.0077503359   0.053975003    0              5212.5195      1.1965779e-13  0              2.9940347    
   1100000   9690           200            200            0.00099530193 -0.0047541744   0              0.0077400801   0.0069842243   0              674.48639      1.1965779e-13  0              2.994039     
   1200000   9690           200            200            0.00099044154 -0.0047545538   0              0.0077258785   0.00012688916  0              12.254046      1.1965779e-13  0              2.9940443    
   1300000   9690           200            200            0.00099339752 -0.0047543162   0              0.0077345088   3.0584439e-05  0              2.9536262      1.1965779e-13  0              2.994041     
   1400000   9690           200            200            0.00099254667 -0.0047543854   0              0.0077320254   1.8827979e-05  0              1.8182715      1.1965779e-13  0              2.994042     
   1500000   9690           200            200            0.00099258165 -0.004754382    0              0.0077321269   2.1490212e-06  0              0.20753709     1.1965779e-13  0              2.994042     
   1600000   9690           200            200            0.00099267862 -0.0047543744   0              0.0077324102   2.6216575e-08  0              0.0025318091   1.1965779e-13  0              2.9940418    
   1700000   9690           200            200            0.00099262447 -0.0047543787   0              0.0077322521   1.3279546e-08  0              0.0012824435   1.1965779e-13  0              2.9940419    
   1800000   9690           200            200            0.00099263899 -0.0047543775   0              0.0077322945   6.4949194e-09  0              0.00062723283  1.1965779e-13  0              2.9940419    
   1900000   9690           200            200            0.00099263889 -0.0047543776   0              0.0077322942   6.5215011e-10  0              6.297999e-05   1.1965779e-13  0              2.9940419    
   2000000   9690           200            200            0.00099263698 -0.0047543777   0              0.0077322886   4.6034941e-12  0              4.4457251e-07  1.1965779e-13  0              2.9940419    
   2100000   9690           200            200            0.00099263797 -0.0047543776   0              0.0077322915   5.5305228e-12  0              5.3409831e-07  1.1965779e-13  0              2.9940419    
   2200000   9690           200            200            0.00099263772 -0.0047543776   0              0.0077322908   2.2148625e-12  0              2.1389556e-07  1.1965779e-13  0              2.9940419    
   2300000   9690           200            200            0.00099263772 -0.0047543776   0              0.0077322908   1.945905e-13   0              1.8792157e-08  1.1965779e-13  0              2.9940419    
   2400000   9690           200            200            0.00099263775 -0.0047543776   0              0.0077322909   5.8868633e-16  0              5.6851112e-11  1.1965779e-13  0              2.9940419    
   2500000   9690           200            200            0.00099263773 -0.0047543776   0              0.0077322908   2.2789049e-15  0              2.2008033e-10  1.1965779e-13  0              2.9940419    
   2600000   9690           200            200            0.00099263774 -0.0047543776   0              0.0077322909   7.4312558e-16  0              7.1765749e-11  1.1965779e-13  0              2.9940419    
   2700000   9690           200            200            0.00099263774 -0.0047543776   0              0.0077322909   4.0295209e-17  0              3.8914228e-12  1.1965779e-13  0              2.9940419    
   2800000   9690           200            200            0.00099263774 -0.0047543776   0              0.0077322909   4.8867603e-19  0              4.7192833e-14  1.1965779e-13  0              2.9940419    
   2900000   9690           200            200            0.00099263774 -0.0047543776   0              0.0077322909   8.2149341e-19  0              7.9333954e-14  1.1965779e-13  0              2.9940419    
   3000000   9690           200            200            0.00099263774 -0.0047543776   0              0.0077322909   4.3574621e-18  0              4.208125e-13   1.1965779e-13  0              2.9940419    
Loop time of 298.257 on 4 procs for 3000000 steps with 2501 atoms

Performance: 8690496.702 ns/day, 0.000 hours/ns, 10058.445 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 11.198     | 35.839     | 61.308     | 411.3 | 12.02
Neigh   | 6.0321     | 6.1417     | 6.2545     |   4.1 |  2.06
Comm    | 22.11      | 42.363     | 80.512     | 345.8 | 14.20
Output  | 0.26948    | 0.2698     | 0.27015    |   0.1 |  0.09
Modify  | 108.6      | 157.25     | 177.2      | 225.7 | 52.72
Other   |            | 56.39      |            |       | 18.91

Nlocal:         625.25 ave         876 max         375 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:           1.75 ave           3 max           1 min
Histogram: 2 0 0 0 0 1 0 0 0 1
Neighs:         310.75 ave         622 max           0 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 1243
Ave neighs/atom = 0.4970012
Neighbor list builds = 166
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 47

#variable lat0 equal 1                    #
variable lat1 equal 3+(300*0.01)+(v_ind*0.01)  # .491+(v_ind*0.001)       # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 500*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 6.47                                                               
Lattice spacing in x,y,z = 6.47 6.47 6.47

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -4852.5 ${n1e1} -100 100 -100 100 units box
region box block -4852.5 4852.5 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -4852.5 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -4852.5 4852.5 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-4852.5 -100 -100) to (4852.5 100 100)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 1500 atoms
  using lattice units in orthogonal box = (-4852.5 -100 -100) to (4852.5 100 100)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 1500 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 1001 atoms
  using lattice units in orthogonal box = (-4852.5 -100 -100) to (4852.5 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  1500 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  1500 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  1001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  1001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
1500 atoms in group substrate
group slider1 region slider1
1001 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 1001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_47_*.dump id type diameter mass xu yu zu fx fy fz

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 6262 130 130
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 122 | 122.1 | 122.1 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   9705           200            200            0              0              0              0              0              0              0              1.1965779e-13  0              6            
    100000   9705           200            200            0.0020779904   2.012842e-42   0              0.0062339712   577929.55      0              5.5812299e+10  1.1965779e-13  0              3.3321398    
    200000   9705           200            200            0.00070139913  8.3235341e-36  0              0.0021041974   130477.6       0              1.2600592e+10  1.1965779e-13  0              3.0839487    
    300000   9705           200            200           -9.399972e-06   3.3295113e-35  0             -2.8199916e-05  52.35268       0              5055847.1      1.1965779e-13  0              3.0437124    
    400000   9705           200            200           -1.4494688e-05 -1.6646691e-35  0             -4.3484064e-05  129.6734       0              12522928       1.1965779e-13  0              3.0053248    
    500000   9705           200            200            0.0019019192   0.0023547723   0              0.0033509853   822.80494      0              79460612       1.1965779e-13  0              2.9960225    
    600000   9705           200            200            0.0035873437   0.003599115    0              0.0071629163   182.0695       0              17582969       1.1965779e-13  0              2.9942939    
    700000   9705           200            200            0.0037958749   0.0038010073   0              0.0075866174   25.078333      0              2421885.9      1.1965779e-13  0              2.9940979    
    800000   9705           200            200            0.0038745257   0.0037672423   0              0.0078563348   2.9796267      0              287751.02      1.1965779e-13  0              2.9940037    
    900000   9705           200            200            0.0037975692   0.0037450781   0              0.0076476294   0.33183996     0              32046.728      1.1965779e-13  0              2.9940808    
   1000000   9705           200            200            0.0038368088   0.0037565153   0              0.0077539111   0.034596716    0              3341.1032      1.1965779e-13  0              2.9940408    
   1100000   9705           200            200            0.0038190818   0.0037513577   0              0.0077058879   0.0032052333   0              309.53849      1.1965779e-13  0              2.994059     
   1200000   9705           200            200            0.0038266329   0.0037535766   0              0.0077263222   0.00025248404  0              24.383101      1.1965779e-13  0              2.9940512    
   1300000   9705           200            200            0.0038235635   0.0037526726   0              0.007718018    1.4847198e-05  0              1.4338361      1.1965779e-13  0              2.9940544    
   1400000   9705           200            200            0.0038247654   0.0037530281   0              0.0077212682   4.1489107e-07  0              0.04006721     1.1965779e-13  0              2.9940531    
   1500000   9705           200            200            0.0038243101   0.0037528931   0              0.0077200371   2.9077123e-09  0              0.00028080604  1.1965779e-13  0              2.9940536    
   1600000   9705           200            200            0.0038244773   0.0037529428   0              0.0077204892   1.5854208e-08  0              0.0015310859   1.1965779e-13  0              2.9940534    
   1700000   9705           200            200            0.0038244178   0.0037529251   0              0.0077203282   7.0251073e-09  0              0.00067843458  1.1965779e-13  0              2.9940535    
   1800000   9705           200            200            0.0038244383   0.0037529312   0              0.0077203837   1.905114e-09   0              0.00018398227  1.1965779e-13  0              2.9940535    
   1900000   9705           200            200            0.0038244315   0.0037529292   0              0.0077203653   4.1079788e-10  0              3.9671918e-05  1.1965779e-13  0              2.9940535    
   2000000   9705           200            200            0.0038244336   0.0037529298   0              0.0077203711   7.6983864e-11  0              7.4345505e-06  1.1965779e-13  0              2.9940535    
   2100000   9705           200            200            0.003824433    0.0037529296   0              0.0077203694   1.3051784e-11  0              1.2604479e-06  1.1965779e-13  0              2.9940535    
   2200000   9705           200            200            0.0038244332   0.0037529297   0              0.0077203698   2.0446596e-12  0              1.9745859e-07  1.1965779e-13  0              2.9940535    
   2300000   9705           200            200            0.0038244331   0.0037529297   0              0.0077203697   2.9928626e-13  0              2.8902925e-08  1.1965779e-13  0              2.9940535    
   2400000   9705           200            200            0.0038244331   0.0037529297   0              0.0077203697   4.1135147e-14  0              3.972538e-09   1.1965779e-13  0              2.9940535    
   2500000   9705           200            200            0.0038244331   0.0037529297   0              0.0077203697   5.3319849e-15  0              5.1492494e-10  1.1965779e-13  0              2.9940535    
   2600000   9705           200            200            0.0038244331   0.0037529297   0              0.0077203697   6.3308869e-16  0              6.1139174e-11  1.1965779e-13  0              2.9940535    
   2700000   9705           200            200            0.0038244331   0.0037529297   0              0.0077203697   5.3316248e-17  0              5.1489016e-12  1.1965779e-13  0              2.9940535    
   2800000   9705           200            200            0.0038244331   0.0037529297   0              0.0077203697   1.9008567e-18  0              1.8357113e-13  1.1965779e-13  0              2.9940535    
   2900000   9705           200            200            0.0038244331   0.0037529297   0              0.0077203697   3.3202279e-18  0              3.2064384e-13  1.1965779e-13  0              2.9940535    
   3000000   9705           200            200            0.0038244331   0.0037529297   0              0.0077203697   1.1344904e-18  0              1.0956096e-13  1.1965779e-13  0              2.9940535    
Loop time of 298.612 on 4 procs for 3000000 steps with 2501 atoms

Performance: 8680171.230 ns/day, 0.000 hours/ns, 10046.494 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 11.038     | 35.696     | 60.908     | 409.5 | 11.95
Neigh   | 6.0457     | 6.1531     | 6.263      |   4.0 |  2.06
Comm    | 22.903     | 40.726     | 77.42      | 336.4 | 13.64
Output  | 0.27165    | 0.27196    | 0.27229    |   0.1 |  0.09
Modify  | 109.43     | 157.83     | 180.81     | 226.5 | 52.85
Other   |            | 57.94      |            |       | 19.40

Nlocal:         625.25 ave         876 max         375 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:           1.75 ave           3 max           1 min
Histogram: 2 0 0 0 0 1 0 0 0 1
Neighs:         311.25 ave         623 max           0 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 1245
Ave neighs/atom = 0.49780088
Neighbor list builds = 166
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 48

#variable lat0 equal 1                    #
variable lat1 equal 3+(300*0.01)+(v_ind*0.01)  # .491+(v_ind*0.001)       # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 500*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 6.48                                                               
Lattice spacing in x,y,z = 6.48 6.48 6.48

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -4860 ${n1e1} -100 100 -100 100 units box
region box block -4860 4860 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -4860 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -4860 4860 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-4860 -100 -100) to (4860 100 100)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 1500 atoms
  using lattice units in orthogonal box = (-4860 -100 -100) to (4860 100 100)
  create_atoms CPU = 0.000 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 1500 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 1001 atoms
  using lattice units in orthogonal box = (-4860 -100 -100) to (4860 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  1500 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  1500 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  1001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  1001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
1500 atoms in group substrate
group slider1 region slider1
1001 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 1001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_48_*.dump id type diameter mass xu yu zu fx fy fz

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 6271 130 130
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 122.2 | 122.2 | 122.2 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   9720           200            200            0              0              0              0              0              0              0              1.1965779e-13  0              6            
    100000   9720           200            200            0.0020746732  -1.6620783e-35  0              0.0062240196   577875.45      0              5.5807074e+10  1.1965779e-13  0              3.3322415    
    200000   9720           200            200            0.00069986755  2.6594099e-34  0              0.0020996026   130340.79      0              1.258738e+10   1.1965779e-13  0              3.0841776    
    300000   9720           200            200           -9.7761237e-06  1.6621402e-35  0             -2.9328371e-05  56.870148      0              5492111.9      1.1965779e-13  0              3.0437937    
    400000   9720           200            200           -1.30736e-05    4.9864131e-35  0             -3.92208e-05    105.4117       0              10179908       1.1965779e-13  0              3.0054166    
    500000   9720           200            200            0.00073001841 -0.00050706038  0              0.0026971156   690.28648      0              66662927       1.1965779e-13  0              2.9963897    
    600000   9720           200            200            0.0028376573  -0.0021161828   0              0.010629155    0.5779683      0              55816.042      1.1965779e-13  0              2.9931948    
    700000   9720           200            200            0.0020335173  -0.0018037903   0              0.0079043423   24.965273      0              2410967.3      1.1965779e-13  0              2.9941583    
    800000   9720           200            200            0.0018711779  -0.0017782454   0              0.007391779    0.98082094     0              94720.666      1.1965779e-13  0              2.9943449    
    900000   9720           200            200            0.0019354134  -0.0017894188   0              0.007595659    0.16095417     0              15543.801      1.1965779e-13  0              2.9942658    
   1000000   9720           200            200            0.0019749691  -0.0017957735   0              0.0077206808   0.059697295    0              5765.1375      1.1965779e-13  0              2.9942192    
   1100000   9720           200            200            0.0019771232  -0.0017960672   0              0.0077274367   0.00016788744  0              16.213367      1.1965779e-13  0              2.994217     
   1200000   9720           200            200            0.0019723652  -0.0017953028   0              0.0077123985   0.00086395362  0              83.434457      1.1965779e-13  0              2.9942227    
   1300000   9720           200            200            0.0019707684  -0.0017950526   0              0.0077073577   9.6686366e-05  0              9.3372772      1.1965779e-13  0              2.9942245    
   1400000   9720           200            200            0.0019709706  -0.0017950871   0              0.0077079989   1.5874658e-06  0              0.15330608     1.1965779e-13  0              2.9942243    
   1500000   9720           200            200            0.0019712417  -0.0017951304   0              0.0077088554   2.7994885e-06  0              0.27035456     1.1965779e-13  0              2.9942239    
   1600000   9720           200            200            0.0019712889  -0.0017951376   0              0.0077090045   8.428304e-08   0              0.0081394527   1.1965779e-13  0              2.9942239    
   1700000   9720           200            200            0.0019712654  -0.0017951338   0              0.00770893     2.127342e-08   0              0.0020544347   1.1965779e-13  0              2.9942239    
   1800000   9720           200            200            0.0019712525  -0.0017951318   0              0.0077088893   6.2868728e-09  0              0.00060714118  1.1965779e-13  0              2.9942239    
   1900000   9720           200            200            0.0019712522  -0.0017951317   0              0.0077088882   4.5649194e-12  0              4.4084724e-07  1.1965779e-13  0              2.9942239    
   2000000   9720           200            200            0.0019712538  -0.001795132    0              0.0077088934   1.0220047e-10  0              9.8697899e-06  1.1965779e-13  0              2.9942239    
   2100000   9720           200            200            0.0019712543  -0.0017951321   0              0.007708895    9.4206828e-12  0              9.0978211e-07  1.1965779e-13  0              2.9942239    
   2200000   9720           200            200            0.0019712542  -0.001795132    0              0.0077088947   2.7010122e-13  0              2.6084443e-08  1.1965779e-13  0              2.9942239    
   2300000   9720           200            200            0.0019712541  -0.001795132    0              0.0077088944   3.1010313e-13  0              2.9947541e-08  1.1965779e-13  0              2.9942239    
   2400000   9720           200            200            0.0019712541  -0.001795132    0              0.0077088944   6.9656982e-15  0              6.7269727e-10  1.1965779e-13  0              2.9942239    
   2500000   9720           200            200            0.0019712541  -0.001795132    0              0.0077088944   2.7885974e-15  0              2.6930277e-10  1.1965779e-13  0              2.9942239    
   2600000   9720           200            200            0.0019712541  -0.001795132    0              0.0077088944   6.2060203e-16  0              5.9933302e-11  1.1965779e-13  0              2.9942239    
   2700000   9720           200            200            0.0019712541  -0.001795132    0              0.0077088944   5.207473e-19   0              5.0290047e-14  1.1965779e-13  0              2.9942239    
   2800000   9720           200            200            0.0019712541  -0.001795132    0              0.0077088944   7.6314654e-18  0              7.369923e-13   1.1965779e-13  0              2.9942239    
   2900000   9720           200            200            0.0019712541  -0.001795132    0              0.0077088944   4.4718523e-18  0              4.3185949e-13  1.1965779e-13  0              2.9942239    
   3000000   9720           200            200            0.0019712541  -0.001795132    0              0.0077088944   1.7938445e-18  0              1.7323667e-13  1.1965779e-13  0              2.9942239    
Loop time of 297.287 on 4 procs for 3000000 steps with 2501 atoms

Performance: 8718843.042 ns/day, 0.000 hours/ns, 10091.254 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 11.081     | 35.702     | 60.312     | 408.5 | 12.01
Neigh   | 6.0913     | 6.2016     | 6.3152     |   4.1 |  2.09
Comm    | 22.645     | 40.537     | 76.957     | 335.1 | 13.64
Output  | 0.27112    | 0.27142    | 0.27173    |   0.1 |  0.09
Modify  | 110.67     | 158.12     | 178.51     | 220.9 | 53.19
Other   |            | 56.46      |            |       | 18.99

Nlocal:         625.25 ave         876 max         375 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:           1.75 ave           3 max           1 min
Histogram: 2 0 0 0 0 1 0 0 0 1
Neighs:         310.25 ave         621 max           0 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 1241
Ave neighs/atom = 0.49620152
Neighbor list builds = 166
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 49

#variable lat0 equal 1                    #
variable lat1 equal 3+(300*0.01)+(v_ind*0.01)  # .491+(v_ind*0.001)       # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 500*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 6.49                                                               
Lattice spacing in x,y,z = 6.49 6.49 6.49

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -4867.5 ${n1e1} -100 100 -100 100 units box
region box block -4867.5 4867.5 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -4867.5 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -4867.5 4867.5 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-4867.5 -100 -100) to (4867.5 100 100)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 1500 atoms
  using lattice units in orthogonal box = (-4867.5 -100 -100) to (4867.5 100 100)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 1500 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 1001 atoms
  using lattice units in orthogonal box = (-4867.5 -100 -100) to (4867.5 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  1500 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  1500 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  1001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  1001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
1500 atoms in group substrate
group slider1 region slider1
1001 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 1001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_49_*.dump id type diameter mass xu yu zu fx fy fz

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 6281 130 130
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 122.4 | 122.4 | 122.4 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   9735           200            200            0              0              0              0              0              0              0              1.1965779e-13  0              6            
    100000   9735           200            200            0.0020711274  -2.0744564e-36  0              0.0062133823   577742.06      0              5.5794193e+10  1.1965779e-13  0              3.3322545    
    200000   9735           200            200            0.00069846706  2.0744586e-36  0              0.0020954012   130255.9       0              1.2579182e+10  1.1965779e-13  0              3.0840359    
    300000   9735           200            200           -1.0272257e-05 -2.5930711e-36  0             -3.081677e-05   63.094359      0              6093201.5      1.1965779e-13  0              3.043546     
    400000   9735           200            200           -1.9457405e-05  4.1489279e-36  0             -5.8372215e-05  238.19031      0              23002715       1.1965779e-13  0              3.0050898    
    500000   9735           200            200            0.0012236057  -0.0031657975   0              0.0068366146   1388.3928      0              1.3408104e+08  1.1965779e-13  0              2.9942554    
    600000   9735           200            200            0.0010814394  -0.001919432    0              0.0051637502   4.4303326      0              427849.81      1.1965779e-13  0              2.9950498    
    700000   9735           200            200            0.0018158243  -0.0028467703   0              0.0082942432   16.514073      0              1594811        1.1965779e-13  0              2.9937389    
    800000   9735           200            200            0.0016368313  -0.0027836354   0              0.0076941293   3.3920011      0              327575.19      1.1965779e-13  0              2.9939621    
    900000   9735           200            200            0.0016135914  -0.0027720063   0              0.0076127805   0.27295662     0              26360.197      1.1965779e-13  0              2.9939979    
   1000000   9735           200            200            0.0016536875  -0.0027832999   0              0.0077443624   0.0024773827   0              239.24789      1.1965779e-13  0              2.9939451    
   1100000   9735           200            200            0.0016340033  -0.0027782313   0              0.0076802413   0.0017297166   0              167.04365      1.1965779e-13  0              2.9939703    
   1200000   9735           200            200            0.0016397864  -0.0027797819   0              0.0076991412   0.00093144913  0              89.95269       1.1965779e-13  0              2.993963     
   1300000   9735           200            200            0.001639107   -0.0027795919   0              0.0076969131   0.00014268099  0              13.779109      1.1965779e-13  0              2.9939638    
   1400000   9735           200            200            0.0016387231  -0.0027794769   0              0.007695646    7.6059396e-06  0              0.73452721     1.1965779e-13  0              2.9939643    
   1500000   9735           200            200            0.0016390363  -0.0027795673   0              0.0076966761   5.8285326e-10  0              5.6287796e-05  1.1965779e-13  0              2.9939639    
   1600000   9735           200            200            0.0016389078  -0.0027795308   0              0.0076962542   1.4900787e-07  0              0.014390113    1.1965779e-13  0              2.9939641    
   1700000   9735           200            200            0.0016389395  -0.0027795396   0              0.007696358    4.7934963e-08  0              0.0046292156   1.1965779e-13  0              2.993964     
   1800000   9735           200            200            0.0016389386  -0.0027795394   0              0.0076963552   5.4674095e-09  0              0.00052800327  1.1965779e-13  0              2.993964     
   1900000   9735           200            200            0.0016389348  -0.0027795383   0              0.0076963428   1.6956104e-10  0              1.6374992e-05  1.1965779e-13  0              2.993964     
   2000000   9735           200            200            0.0016389371  -0.002779539    0              0.0076963503   6.1585823e-12  0              5.9475179e-07  1.1965779e-13  0              2.993964     
   2100000   9735           200            200            0.0016389363  -0.0027795387   0              0.0076963477   1.0148097e-11  0              9.8003053e-07  1.1965779e-13  0              2.993964     
   2200000   9735           200            200            0.0016389365  -0.0027795388   0              0.0076963482   2.2463284e-12  0              2.1693432e-07  1.1965779e-13  0              2.993964     
   2300000   9735           200            200            0.0016389365  -0.0027795388   0              0.0076963482   1.8739447e-13  0              1.8097217e-08  1.1965779e-13  0              2.993964     
   2400000   9735           200            200            0.0016389364  -0.0027795388   0              0.0076963481   2.132846e-15   0              2.05975e-10    1.1965779e-13  0              2.993964     
   2500000   9735           200            200            0.0016389365  -0.0027795388   0              0.0076963482   9.9273393e-16  0              9.5871137e-11  1.1965779e-13  0              2.993964     
   2600000   9735           200            200            0.0016389365  -0.0027795388   0              0.0076963482   5.8204135e-16  0              5.6209387e-11  1.1965779e-13  0              2.993964     
   2700000   9735           200            200            0.0016389365  -0.0027795388   0              0.0076963482   9.9029003e-17  0              9.5635123e-12  1.1965779e-13  0              2.993964     
   2800000   9735           200            200            0.0016389365  -0.0027795388   0              0.0076963482   9.0485409e-18  0              8.7384331e-13  1.1965779e-13  0              2.993964     
   2900000   9735           200            200            0.0016389365  -0.0027795388   0              0.0076963482   9.5551991e-20  0              9.2277274e-15  1.1965779e-13  0              2.993964     
   3000000   9735           200            200            0.0016389365  -0.0027795388   0              0.0076963482   1.3805209e-20  0              1.3332083e-15  1.1965779e-13  0              2.993964     
Loop time of 298.408 on 4 procs for 3000000 steps with 2501 atoms

Performance: 8686084.281 ns/day, 0.000 hours/ns, 10053.338 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 11.214     | 35.651     | 60.595     | 408.6 | 11.95
Neigh   | 6.0887     | 6.1974     | 6.3072     |   4.0 |  2.08
Comm    | 22.362     | 42.111     | 79.715     | 341.5 | 14.11
Output  | 0.27204    | 0.27234    | 0.27267    |   0.1 |  0.09
Modify  | 108.92     | 157.44     | 178.11     | 225.5 | 52.76
Other   |            | 56.73      |            |       | 19.01

Nlocal:         625.25 ave         876 max         375 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:           1.75 ave           3 max           1 min
Histogram: 2 0 0 0 0 1 0 0 0 1
Neighs:         310.75 ave         622 max           0 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 1243
Ave neighs/atom = 0.4970012
Neighbor list builds = 166
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 50

#variable lat0 equal 1                    #
variable lat1 equal 3+(300*0.01)+(v_ind*0.01)  # .491+(v_ind*0.001)       # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 500*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 6.5                                                               
Lattice spacing in x,y,z = 6.5 6.5 6.5

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -4875 ${n1e1} -100 100 -100 100 units box
region box block -4875 4875 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -4875 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -4875 4875 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-4875 -100 -100) to (4875 100 100)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 1500 atoms
  using lattice units in orthogonal box = (-4875 -100 -100) to (4875 100 100)
  create_atoms CPU = 0.000 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 1500 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 1001 atoms
  using lattice units in orthogonal box = (-4875 -100 -100) to (4875 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  1500 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  1500 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  1001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  1001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
1500 atoms in group substrate
group slider1 region slider1
1001 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 1001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_50_*.dump id type diameter mass xu yu zu fx fy fz

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 6291 130 130
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 122.6 | 122.6 | 122.6 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   9750           200            200            0              0              0              0              0              0              0              1.1965779e-13  0              6            
    100000   9750           200            200            0.0020632285   2.4855228e-35  0              0.0061896856   575448.62      0              5.5572708e+10  1.1965779e-13  0              3.3364405    
    200000   9750           200            200            0.00067214579  1.7732262e-40  0              0.0020164374   122682.43      0              1.1847791e+10  1.1965779e-13  0              3.0954749    
    300000   9750           200            200           -3.2240151e-05  3.3140541e-35  0             -9.6720454e-05  657.37156      0              63484240       1.1965779e-13  0              3.0458932    
    400000   9750           200            200            5.7866306e-07  1.6570382e-35  0              1.7359892e-06  0.2408532      0              23259.878      1.1965779e-13  0              3.0081346    
    500000   9750           200            200            0.00034142096  8.2850784e-35  0              0.0010242629   440.56157      0              42546283       1.1965779e-13  0              2.9990484    
    600000   9750           200            200            0.0035053867  -1.6569974e-35  0              0.01051616     80.616784      0              7785391.9      1.1965779e-13  0              2.9957271    
    700000   9750           200            200            0.0022656094  -8.2849211e-36  0              0.0067968283   13.950306      0              1347220.7      1.1965779e-13  0              2.996804     
    800000   9750           200            200            0.0024625792  -4.9710257e-35  0              0.0073877376   2.3043619      0              222538.78      1.1965779e-13  0              2.9966147    
    900000   9750           200            200            0.002606204   -4.1425221e-35  0              0.007818612    0.22886213     0              22101.867      1.1965779e-13  0              2.9964855    
   1000000   9750           200            200            0.0025767633   1.6570201e-35  0              0.00773029     0.044831486    0              4329.5041      1.1965779e-13  0              2.9965128    
   1100000   9750           200            200            0.0025578164   8.2851169e-36  0              0.0076734491   0.0038352542   0              370.38139      1.1965779e-13  0              2.9965298    
   1200000   9750           200            200            0.0025619971  -2.0712222e-36  0              0.0076859912   0.00085407134  0              82.480096      1.1965779e-13  0              2.9965259    
   1300000   9750           200            200            0.0025645045   2.071306e-36   0              0.0076935136   6.4328478e-05  0              6.212384       1.1965779e-13  0              2.9965237    
   1400000   9750           200            200            0.0025639125  -6.2137574e-36  0              0.0076917376   1.624398e-05   0              1.5687273      1.1965779e-13  0              2.9965242    
   1500000   9750           200            200            0.0025635812  -3.1068595e-36  0              0.0076907437   1.0725439e-06  0              0.10357861     1.1965779e-13  0              2.9965245    
   1600000   9750           200            200            0.0025636648  -1.0355946e-36  0              0.0076909943   3.080106e-07   0              0.029745459    1.1965779e-13  0              2.9965244    
   1700000   9750           200            200            0.0025637085  -5.1777824e-37  0              0.0076911255   1.777982e-08   0              0.0017170477   1.1965779e-13  0              2.9965244    
   1800000   9750           200            200            0.0025636967   2.5894636e-37  0              0.0076910902   5.8244899e-09  0              0.00056248754  1.1965779e-13  0              2.9965244    
   1900000   9750           200            200            0.002563691    1.1391999e-35  0              0.0076910729   2.9285662e-10  0              2.8281996e-05  1.1965779e-13  0              2.9965244    
   2000000   9750           200            200            0.0025636926   3.8216531e-41  0              0.0076910779   1.0985059e-10  0              1.0608583e-05  1.1965779e-13  0              2.9965244    
   2100000   9750           200            200            0.0025636934   2.0713037e-36  0              0.0076910802   4.7909383e-12  0              4.6267452e-07  1.1965779e-13  0              2.9965244    
   2200000   9750           200            200            0.0025636932   3.8103576e-41  0              0.0076910795   2.0657272e-12  0              1.9949314e-07  1.1965779e-13  0              2.9965244    
   2300000   9750           200            200            0.0025636931   6.2138348e-36  0              0.0076910792   7.7444349e-14  0              7.4790209e-09  1.1965779e-13  0              2.9965244    
   2400000   9750           200            200            0.0025636931  -8.2850241e-36  0              0.0076910793   3.8813451e-14  0              3.7483253e-09  1.1965779e-13  0              2.9965244    
   2500000   9750           200            200            0.0025636931   4.1425693e-36  0              0.0076910793   1.2321545e-15  0              1.1899267e-10  1.1965779e-13  0              2.9965244    
   2600000   9750           200            200            0.0025636931  -2.899768e-35   0              0.0076910793   7.5179622e-16  0              7.2603097e-11  1.1965779e-13  0              2.9965244    
   2700000   9750           200            200            0.0025636931   3.8466405e-41  0              0.0076910793   1.0054764e-17  0              9.7101718e-13  1.1965779e-13  0              2.9965244    
   2800000   9750           200            200            0.0025636931  -8.2850243e-36  0              0.0076910793   1.3988462e-17  0              1.3509055e-12  1.1965779e-13  0              2.9965244    
   2900000   9750           200            200            0.0025636931   1.2427631e-35  0              0.0076910793   1.1541269e-18  0              1.1145731e-13  1.1965779e-13  0              2.9965244    
   3000000   9750           200            200            0.0025636931  -4.1424911e-36  0              0.0076910793   9.9314781e-19  0              9.5911107e-14  1.1965779e-13  0              2.9965244    
Loop time of 297.011 on 4 procs for 3000000 steps with 2501 atoms

Performance: 8726960.054 ns/day, 0.000 hours/ns, 10100.648 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 11.01      | 35.953     | 61.499     | 412.3 | 12.10
Neigh   | 6.0719     | 6.184      | 6.2999     |   4.1 |  2.08
Comm    | 22.915     | 41.08      | 78.328     | 340.1 | 13.83
Output  | 0.27724    | 0.27754    | 0.27787    |   0.1 |  0.09
Modify  | 109.11     | 156.97     | 177.83     | 223.2 | 52.85
Other   |            | 56.54      |            |       | 19.04

Nlocal:         625.25 ave         876 max         375 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:           1.75 ave           3 max           1 min
Histogram: 2 0 0 0 0 1 0 0 0 1
Neighs:         307.75 ave         616 max           0 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 1231
Ave neighs/atom = 0.49220312
Neighbor list builds = 166
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 51

#variable lat0 equal 1                    #
variable lat1 equal 3+(300*0.01)+(v_ind*0.01)  # .491+(v_ind*0.001)       # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 500*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 6.51                                                               
Lattice spacing in x,y,z = 6.51 6.51 6.51

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -4882.5 ${n1e1} -100 100 -100 100 units box
region box block -4882.5 4882.5 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -4882.5 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -4882.5 4882.5 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-4882.5 -100 -100) to (4882.5 100 100)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 1500 atoms
  using lattice units in orthogonal box = (-4882.5 -100 -100) to (4882.5 100 100)
  create_atoms CPU = 0.000 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 1500 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 1001 atoms
  using lattice units in orthogonal box = (-4882.5 -100 -100) to (4882.5 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  1500 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  1500 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  1001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  1001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
1500 atoms in group substrate
group slider1 region slider1
1001 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 1001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_51_*.dump id type diameter mass xu yu zu fx fy fz

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 6300 130 130
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 122.8 | 122.8 | 122.8 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   9765           200            200            0              0              0              0              0              0              0              1.1965779e-13  0              6            
    100000   9765           200            200            0.0020652412   2.4817085e-35  0              0.0061957235   577945.95      0              5.5813883e+10  1.1965779e-13  0              3.332064     
    200000   9765           200            200            0.00069760379 -1.5510625e-36  0              0.0020928114   130635.87      0              1.2615877e+10  1.1965779e-13  0              3.0836662    
    300000   9765           200            200           -8.5361499e-06 -3.308911e-35   0             -2.560845e-05   43.591761      0              4209780.2      1.1965779e-13  0              3.0436051    
    400000   9765           200            200           -1.6293811e-05 -3.3088059e-35  0             -4.8881434e-05  166.73678      0              16102245       1.1965779e-13  0              3.0051762    
    500000   9765           200            200            0.0028181353   0.0026688521   0              0.0057855538   1312.7862      0              1.2677949e+08  1.1965779e-13  0              2.9946924    
    600000   9765           200            200            0.0024251371   0.002131902    0              0.0051435093   0.34057441     0              32890.238      1.1965779e-13  0              2.9950596    
    700000   9765           200            200            0.0039464052   0.0031705426   0              0.0086686732   1.2531864      0              121023.77      1.1965779e-13  0              2.9935823    
    800000   9765           200            200            0.0034086833   0.0029142342   0              0.0073118157   0.055897129    0              5398.1446      1.1965779e-13  0              2.9940991    
    900000   9765           200            200            0.0035986732   0.0029885639   0              0.0078074556   7.5571556e-06  0              0.729816       1.1965779e-13  0              2.9939051    
   1000000   9765           200            200            0.0035313211   0.0029700156   0              0.0076239476   0.001270779    0              122.72274      1.1965779e-13  0              2.9939764    
   1100000   9765           200            200            0.0035556621   0.0029769377   0              0.0076900485   0.0006577551   0              63.521279      1.1965779e-13  0              2.9939506    
   1200000   9765           200            200            0.0035470514   0.0029745093   0              0.007666645    0.00019145044  0              18.488913      1.1965779e-13  0              2.9939597    
   1300000   9765           200            200            0.0035500318   0.0029753556   0              0.0076747397   4.3653683e-05  0              4.2157602      1.1965779e-13  0              2.9939566    
   1400000   9765           200            200            0.0035490258   0.0029750694   0              0.0076720081   8.6355427e-06  0              0.83395891     1.1965779e-13  0              2.9939576    
   1500000   9765           200            200            0.0035493555   0.0029751636   0              0.0076729028   1.5529332e-06  0              0.14997118     1.1965779e-13  0              2.9939573    
   1600000   9765           200            200            0.0035492514   0.0029751337   0              0.0076726206   2.6005608e-07  0              0.025114355    1.1965779e-13  0              2.9939574    
   1700000   9765           200            200            0.0035492826   0.0029751428   0              0.0076727052   4.112983e-08   0              0.0039720246   1.1965779e-13  0              2.9939574    
   1800000   9765           200            200            0.003549274    0.0029751402   0              0.0076726817   6.1959367e-09  0              0.00059835922  1.1965779e-13  0              2.9939574    
   1900000   9765           200            200            0.0035492761   0.0029751408   0              0.0076726873   8.9363767e-10  0              8.630113e-05   1.1965779e-13  0              2.9939574    
   2000000   9765           200            200            0.0035492757   0.0029751407   0              0.0076726864   1.2374181e-10  0              1.1950098e-05  1.1965779e-13  0              2.9939574    
   2100000   9765           200            200            0.0035492757   0.0029751407   0              0.0076726863   1.6468123e-11  0              1.5903734e-06  1.1965779e-13  0              2.9939574    
   2200000   9765           200            200            0.0035492758   0.0029751407   0              0.0076726865   2.1051411e-12  0              2.0329946e-07  1.1965779e-13  0              2.9939574    
   2300000   9765           200            200            0.0035492757   0.0029751407   0              0.0076726864   2.5807047e-13  0              2.4922599e-08  1.1965779e-13  0              2.9939574    
   2400000   9765           200            200            0.0035492757   0.0029751407   0              0.0076726865   3.0268671e-14  0              2.9231316e-09  1.1965779e-13  0              2.9939574    
   2500000   9765           200            200            0.0035492757   0.0029751407   0              0.0076726864   3.3185835e-15  0              3.2048504e-10  1.1965779e-13  0              2.9939574    
   2600000   9765           200            200            0.0035492757   0.0029751407   0              0.0076726864   3.2868368e-16  0              3.1741917e-11  1.1965779e-13  0              2.9939574    
   2700000   9765           200            200            0.0035492757   0.0029751407   0              0.0076726864   1.6865373e-17  0              1.628737e-12   1.1965779e-13  0              2.9939574    
   2800000   9765           200            200            0.0035492757   0.0029751407   0              0.0076726864   3.1545396e-19  0              3.0464285e-14  1.1965779e-13  0              2.9939574    
   2900000   9765           200            200            0.0035492757   0.0029751407   0              0.0076726864   1.3687373e-20  0              1.3218285e-15  1.1965779e-13  0              2.9939574    
   3000000   9765           200            200            0.0035492757   0.0029751407   0              0.0076726864   2.0422995e-18  0              1.9723066e-13  1.1965779e-13  0              2.9939574    
Loop time of 296.567 on 4 procs for 3000000 steps with 2501 atoms

Performance: 8740026.232 ns/day, 0.000 hours/ns, 10115.771 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 10.989     | 35.633     | 60.606     | 408.2 | 12.02
Neigh   | 6.065      | 6.1719     | 6.2807     |   3.9 |  2.08
Comm    | 22.927     | 40.675     | 77.168     | 334.8 | 13.72
Output  | 0.27224    | 0.27255    | 0.27289    |   0.1 |  0.09
Modify  | 109.08     | 156.88     | 178.4      | 223.7 | 52.90
Other   |            | 56.93      |            |       | 19.20

Nlocal:         625.25 ave         876 max         375 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:           1.75 ave           3 max           1 min
Histogram: 2 0 0 0 0 1 0 0 0 1
Neighs:         311.75 ave         624 max           0 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 1247
Ave neighs/atom = 0.49860056
Neighbor list builds = 166
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 52

#variable lat0 equal 1                    #
variable lat1 equal 3+(300*0.01)+(v_ind*0.01)  # .491+(v_ind*0.001)       # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 500*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 6.52                                                               
Lattice spacing in x,y,z = 6.52 6.52 6.52

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -4890 ${n1e1} -100 100 -100 100 units box
region box block -4890 4890 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -4890 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -4890 4890 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-4890 -100 -100) to (4890 100 100)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 1500 atoms
  using lattice units in orthogonal box = (-4890 -100 -100) to (4890 100 100)
  create_atoms CPU = 0.000 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 1500 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 1001 atoms
  using lattice units in orthogonal box = (-4890 -100 -100) to (4890 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  1500 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  1500 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  1001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  1001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
1500 atoms in group substrate
group slider1 region slider1
1001 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 1001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_52_*.dump id type diameter mass xu yu zu fx fy fz

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 6310 130 130
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 122.9 | 122.9 | 122.9 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   9780           200            200            0              0              0              0              0              0              0              1.1965779e-13  0              6            
    100000   9780           200            200            0.0020614401   5.1622806e-37  0              0.0061843204   577674.19      0              5.5787638e+10  1.1965779e-13  0              3.3323206    
    200000   9780           200            200            0.00069425056  8.2596968e-36  0              0.0020827517   129955.36      0              1.2550159e+10  1.1965779e-13  0              3.0844002    
    300000   9780           200            200           -1.2301929e-05 -1.6519164e-35  0             -3.6905787e-05  91.886268      0              8873718        1.1965779e-13  0              3.043577     
    400000   9780           200            200           -2.1527741e-05 -8.2595827e-36  0             -6.4583224e-05  295.85031      0              28571105       1.1965779e-13  0              3.005118     
    500000   9780           200            200            0.0008968054  -0.0029828459   0              0.0056732621   1308.4742      0              1.2636308e+08  1.1965779e-13  0              2.9948273    
    600000   9780           200            200            0.00092260647 -0.0024855532   0              0.0052533726   22.742331      0              2196291.5      1.1965779e-13  0              2.9950859    
    700000   9780           200            200            0.0020241888  -0.0025708996   0              0.0086434661   1.3152654      0              127018.92      1.1965779e-13  0              2.9936781    
    800000   9780           200            200            0.0015959754  -0.0025908123   0              0.0073787386   1.3625772      0              131587.96      1.1965779e-13  0              2.9941649    
    900000   9780           200            200            0.0017039638  -0.0026069664   0              0.0077188579   0.3774476      0              36451.188      1.1965779e-13  0              2.9940327    
   1000000   9780           200            200            0.0016854843  -0.0026042956   0              0.0076607485   0.062013488    0              5988.8188      1.1965779e-13  0              2.9940543    
   1100000   9780           200            200            0.0016832415  -0.0026038846   0              0.0076536091   0.0068319255   0              659.77847      1.1965779e-13  0              2.9940576    
   1200000   9780           200            200            0.0016872395  -0.0026045199   0              0.0076662383   0.00045537156  0              43.976526      1.1965779e-13  0              2.9940525    
   1300000   9780           200            200            0.0016848876  -0.0026041535   0              0.0076588164   9.1598358e-06  0              0.88459137     1.1965779e-13  0              2.9940554    
   1400000   9780           200            200            0.0016859113  -0.0026043113   0              0.0076620451   7.5269134e-07  0              0.072689542    1.1965779e-13  0              2.9940541    
   1500000   9780           200            200            0.0016855483  -0.0026042559   0              0.0076609007   9.7006716e-07  0              0.093682142    1.1965779e-13  0              2.9940546    
   1600000   9780           200            200            0.0016856514  -0.0026042714   0              0.0076612256   2.8890258e-07  0              0.027900144    1.1965779e-13  0              2.9940545    
   1700000   9780           200            200            0.0016856318  -0.0026042686   0              0.0076611641   5.0316342e-08  0              0.0048591921   1.1965779e-13  0              2.9940545    
   1800000   9780           200            200            0.0016856309  -0.0026042684   0              0.0076611611   5.8598714e-09  0              0.00056590444  1.1965779e-13  0              2.9940545    
   1900000   9780           200            200            0.0016856342  -0.0026042689   0              0.0076611714   4.246729e-10   0              4.1011869e-05  1.1965779e-13  0              2.9940545    
   2000000   9780           200            200            0.0016856321  -0.0026042686   0              0.007661165    1.1336685e-11  0              1.0948159e-06  1.1965779e-13  0              2.9940545    
   2100000   9780           200            200            0.001685633   -0.0026042687   0              0.0076611678   2.9434467e-13  0              2.8425701e-08  1.1965779e-13  0              2.9940545    
   2200000   9780           200            200            0.0016856327  -0.0026042686   0              0.0076611668   6.6413307e-13  0              6.4137218e-08  1.1965779e-13  0              2.9940545    
   2300000   9780           200            200            0.0016856328  -0.0026042687   0              0.0076611671   2.1928325e-13  0              2.1176806e-08  1.1965779e-13  0              2.9940545    
   2400000   9780           200            200            0.0016856328  -0.0026042687   0              0.007661167    4.0569654e-14  0              3.9179268e-09  1.1965779e-13  0              2.9940545    
   2500000   9780           200            200            0.0016856328  -0.0026042687   0              0.007661167    4.9888199e-15  0              4.8178451e-10  1.1965779e-13  0              2.9940545    
   2600000   9780           200            200            0.0016856328  -0.0026042687   0              0.0076611671   3.7163705e-16  0              3.5890046e-11  1.1965779e-13  0              2.9940545    
   2700000   9780           200            200            0.0016856328  -0.0026042687   0              0.007661167    2.219362e-17   0              2.143301e-12   1.1965779e-13  0              2.9940545    
   2800000   9780           200            200            0.0016856328  -0.0026042687   0              0.007661167    4.1828454e-19  0              4.0394927e-14  1.1965779e-13  0              2.9940545    
   2900000   9780           200            200            0.0016856328  -0.0026042687   0              0.007661167    7.858139e-20   0              7.5888282e-15  1.1965779e-13  0              2.9940545    
   3000000   9780           200            200            0.0016856328  -0.0026042687   0              0.007661167    1.3493609e-18  0              1.3031162e-13  1.1965779e-13  0              2.9940545    
Loop time of 297.455 on 4 procs for 3000000 steps with 2501 atoms

Performance: 8713934.409 ns/day, 0.000 hours/ns, 10085.572 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 11.018     | 35.76      | 61.199     | 410.6 | 12.02
Neigh   | 6.0828     | 6.1888     | 6.297      |   3.9 |  2.08
Comm    | 22.648     | 40.879     | 77.928     | 339.3 | 13.74
Output  | 0.27232    | 0.27261    | 0.27294    |   0.1 |  0.09
Modify  | 109.73     | 157.64     | 178.7      | 223.2 | 53.00
Other   |            | 56.72      |            |       | 19.07

Nlocal:         625.25 ave         876 max         375 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:           1.75 ave           3 max           1 min
Histogram: 2 0 0 0 0 1 0 0 0 1
Neighs:         309.75 ave         620 max           0 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 1239
Ave neighs/atom = 0.49540184
Neighbor list builds = 166
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 53

#variable lat0 equal 1                    #
variable lat1 equal 3+(300*0.01)+(v_ind*0.01)  # .491+(v_ind*0.001)       # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 500*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 6.53                                                               
Lattice spacing in x,y,z = 6.53 6.53 6.53

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -4897.5 ${n1e1} -100 100 -100 100 units box
region box block -4897.5 4897.5 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -4897.5 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -4897.5 4897.5 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-4897.5 -100 -100) to (4897.5 100 100)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 1500 atoms
  using lattice units in orthogonal box = (-4897.5 -100 -100) to (4897.5 100 100)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 1500 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 1001 atoms
  using lattice units in orthogonal box = (-4897.5 -100 -100) to (4897.5 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  1500 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  1500 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  1001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  1001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
1500 atoms in group substrate
group slider1 region slider1
1001 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 1001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_53_*.dump id type diameter mass xu yu zu fx fy fz

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 6320 130 130
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 123.1 | 123.1 | 123.1 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   9795           200            200            0              0              0              0              0              0              0              1.1965779e-13  0              6            
    100000   9795           200            200            0.0020584246  -4.1234913e-36  0              0.0061752738   577738.96      0              5.5793893e+10  1.1965779e-13  0              3.3322303    
    200000   9795           200            200            0.00069386757  1.6494153e-34  0              0.0020816027   130160.46      0              1.2569966e+10  1.1965779e-13  0              3.0841311    
    300000   9795           200            200           -1.0367736e-05 -4.9481869e-34  0             -3.1103207e-05  65.099773      0              6286870.1      1.1965779e-13  0              3.0435344    
    400000   9795           200            200           -2.2490999e-05  3.2988174e-35  0             -6.7472997e-05  324.7283       0              31359935       1.1965779e-13  0              3.0050102    
    500000   9795           200            200            0.0024933441   0.0012365901   0              0.0062434423   1360.4988      0              1.3138723e+08  1.1965779e-13  0              2.9945508    
    600000   9795           200            200            0.0019664806   0.00071703834  0              0.0051824034   13.082598      0              1263423.6      1.1965779e-13  0              2.9950911    
    700000   9795           200            200            0.0032630304   0.0011355763   0              0.0086535148   0.40614047     0              39222.139      1.1965779e-13  0              2.9936474    
    800000   9795           200            200            0.0028081966   0.0011036654   0              0.0073209243   0.61847399     0              59727.791      1.1965779e-13  0              2.99416      
    900000   9795           200            200            0.0029544604   0.0011206821   0              0.0077426991   0.24022177     0              23198.899      1.1965779e-13  0              2.9939946    
   1000000   9795           200            200            0.0029156592   0.0011166557   0              0.0076303218   0.053107846    0              5128.7756      1.1965779e-13  0              2.9940377    
   1100000   9795           200            200            0.0029223698   0.0011173314   0              0.0076497781   0.0083720176   0              808.50953      1.1965779e-13  0              2.9940305    
   1200000   9795           200            200            0.0029230259   0.0011174187   0              0.0076516589   0.00098772138  0              95.387061      1.1965779e-13  0              2.9940296    
   1300000   9795           200            200            0.0029216748   0.0011172684   0              0.0076477561   8.3393272e-05  0              8.0535253      1.1965779e-13  0              2.9940312    
   1400000   9795           200            200            0.00292251     0.0011173594   0              0.0076501706   4.0037227e-06  0              0.38665088     1.1965779e-13  0              2.9940302    
   1500000   9795           200            200            0.0029221216   0.0011173175   0              0.0076490472   1.8303185e-08  0              0.0017675906   1.1965779e-13  0              2.9940307    
   1600000   9795           200            200            0.0029222743   0.0011173339   0              0.0076494892   3.1510483e-08  0              0.0030430569   1.1965779e-13  0              2.9940305    
   1700000   9795           200            200            0.0029222223   0.0011173283   0              0.0076493387   1.9479448e-08  0              0.0018811857   1.1965779e-13  0              2.9940306    
   1800000   9795           200            200            0.0029222373   0.0011173299   0              0.0076493819   5.1026749e-09  0              0.00049277981  1.1965779e-13  0              2.9940305    
   1900000   9795           200            200            0.0029222341   0.0011173296   0              0.0076493727   8.992307e-10   0              8.6841264e-05  1.1965779e-13  0              2.9940306    
   2000000   9795           200            200            0.0029222342   0.0011173296   0              0.0076493731   1.1785233e-10  0              1.1381334e-05  1.1965779e-13  0              2.9940306    
   2100000   9795           200            200            0.0029222346   0.0011173296   0              0.0076493741   1.1375823e-11  0              1.0985956e-06  1.1965779e-13  0              2.9940306    
   2200000   9795           200            200            0.0029222343   0.0011173296   0              0.0076493734   7.0517445e-13  0              6.8100701e-08  1.1965779e-13  0              2.9940306    
   2300000   9795           200            200            0.0029222344   0.0011173296   0              0.0076493737   1.406477e-14   0              1.3582748e-09  1.1965779e-13  0              2.9940306    
   2400000   9795           200            200            0.0029222344   0.0011173296   0              0.0076493736   1.0883463e-15  0              1.051047e-10   1.1965779e-13  0              2.9940306    
   2500000   9795           200            200            0.0029222344   0.0011173296   0              0.0076493736   1.4578267e-15  0              1.4078647e-10  1.1965779e-13  0              2.9940306    
   2600000   9795           200            200            0.0029222344   0.0011173296   0              0.0076493736   4.6480253e-16  0              4.4887301e-11  1.1965779e-13  0              2.9940306    
   2700000   9795           200            200            0.0029222344   0.0011173296   0              0.0076493736   8.1961704e-17  0              7.9152747e-12  1.1965779e-13  0              2.9940306    
   2800000   9795           200            200            0.0029222344   0.0011173296   0              0.0076493736   1.2788995e-17  0              1.2350696e-12  1.1965779e-13  0              2.9940306    
   2900000   9795           200            200            0.0029222344   0.0011173296   0              0.0076493736   5.9192576e-18  0              5.7163953e-13  1.1965779e-13  0              2.9940306    
   3000000   9795           200            200            0.0029222344   0.0011173296   0              0.0076493736   4.5346938e-18  0              4.3792826e-13  1.1965779e-13  0              2.9940306    
Loop time of 297.78 on 4 procs for 3000000 steps with 2501 atoms

Performance: 8704424.725 ns/day, 0.000 hours/ns, 10074.566 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 11.274     | 35.797     | 60.964     | 408.3 | 12.02
Neigh   | 6.088      | 6.1966     | 6.3071     |   4.0 |  2.08
Comm    | 22.525     | 40.701     | 77.572     | 338.5 | 13.67
Output  | 0.27158    | 0.27189    | 0.27222    |   0.1 |  0.09
Modify  | 110.51     | 158.28     | 178.82     | 222.6 | 53.15
Other   |            | 56.53      |            |       | 18.98

Nlocal:         625.25 ave         876 max         375 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:           1.75 ave           3 max           1 min
Histogram: 2 0 0 0 0 1 0 0 0 1
Neighs:         309.75 ave         620 max           0 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 1239
Ave neighs/atom = 0.49540184
Neighbor list builds = 166
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 54

#variable lat0 equal 1                    #
variable lat1 equal 3+(300*0.01)+(v_ind*0.01)  # .491+(v_ind*0.001)       # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 500*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 6.54                                                               
Lattice spacing in x,y,z = 6.54 6.54 6.54

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -4905 ${n1e1} -100 100 -100 100 units box
region box block -4905 4905 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -4905 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -4905 4905 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-4905 -100 -100) to (4905 100 100)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 1500 atoms
  using lattice units in orthogonal box = (-4905 -100 -100) to (4905 100 100)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 1500 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 1001 atoms
  using lattice units in orthogonal box = (-4905 -100 -100) to (4905 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  1500 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  1500 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  1001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  1001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
1500 atoms in group substrate
group slider1 region slider1
1001 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 1001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_54_*.dump id type diameter mass xu yu zu fx fy fz

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 6330 130 130
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 123.2 | 123.2 | 123.3 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   9810           200            200            0              0              0              0              0              0              0              1.1965779e-13  0              6            
    100000   9810           200            200            0.0020553683  -1.6468737e-35  0              0.0061661049   577768.84      0              5.5796779e+10  1.1965779e-13  0              3.3322694    
    200000   9810           200            200            0.00069280639  3.2937831e-35  0              0.0020784192   130155.35      0              1.2569472e+10  1.1965779e-13  0              3.0842469    
    300000   9810           200            200           -1.0611915e-05  1.6468936e-35  0             -3.1835744e-05  68.46035       0              6611410.6      1.1965779e-13  0              3.0436511    
    400000   9810           200            200           -1.5796163e-05 -1.6468719e-34  0             -4.738849e-05   157.97053      0              15255663       1.1965779e-13  0              3.0052707    
    500000   9810           200            200            0.00076705344 -0.0010439251   0              0.0033450854   827.96191      0              79958635       1.1965779e-13  0              2.9959986    
    600000   9810           200            200            0.0022944431  -0.00064990006  0              0.0075332295   191.78526      0              18521248       1.1965779e-13  0              2.9940816    
    700000   9810           200            200            0.0020090607  -0.00067885602  0              0.0067060381   3.2967514      0              318376.65      1.1965779e-13  0              2.9943854    
    800000   9810           200            200            0.0024161976  -0.00045490095  0              0.0077034938   3.340403       0              322592.21      1.1965779e-13  0              2.9939936    
    900000   9810           200            200            0.0024297839  -0.00048522699  0              0.0077745788   0.0015650451   0              151.14085      1.1965779e-13  0              2.9939695    
   1000000   9810           200            200            0.002388082   -0.00048971442  0              0.0076539603   0.05642341     0              5448.9691      1.1965779e-13  0              2.9940152    
   1100000   9810           200            200            0.0023771376  -0.00049098239  0              0.0076223953   0.0025945155   0              250.55974      1.1965779e-13  0              2.9940269    
   1200000   9810           200            200            0.0023806526  -0.00049054874  0              0.0076325066   0.00049336513  0              47.645673      1.1965779e-13  0              2.994023     
   1300000   9810           200            200            0.0023828086  -0.00049029435  0              0.0076387201   0.00012444318  0              12.017831      1.1965779e-13  0              2.9940207    
   1400000   9810           200            200            0.00238275    -0.00049030313  0              0.0076385531   7.1770786e-07  0              0.069311088    1.1965779e-13  0              2.9940207    
   1500000   9810           200            200            0.0023824479  -0.00049033902  0              0.0076376826   2.782767e-06   0              0.26873972     1.1965779e-13  0              2.9940211    
   1600000   9810           200            200            0.0023823976  -0.00049034476  0              0.0076375374   4.2929992e-08  0              0.0041458714   1.1965779e-13  0              2.9940211    
   1700000   9810           200            200            0.0023824286  -0.00049034102  0              0.0076376269   3.4268002e-08  0              0.0033093584   1.1965779e-13  0              2.9940211    
   1800000   9810           200            200            0.0023824414  -0.00049033952  0              0.0076376637   4.0483551e-09  0              0.00039096116  1.1965779e-13  0              2.9940211    
   1900000   9810           200            200            0.0023824397  -0.00049033974  0              0.0076376587   1.6159121e-10  0              1.5605322e-05  1.1965779e-13  0              2.9940211    
   2000000   9810           200            200            0.0023824376  -0.00049033998  0              0.0076376528   1.2174097e-10  0              1.1756871e-05  1.1965779e-13  0              2.9940211    
   2100000   9810           200            200            0.0023824374  -0.00049034     0              0.0076376523   1.6923496e-13  0              1.6343501e-08  1.1965779e-13  0              2.9940211    
   2200000   9810           200            200            0.0023824377  -0.00049033997  0              0.007637653    1.9856411e-12  0              1.91759e-07    1.1965779e-13  0              2.9940211    
   2300000   9810           200            200            0.0023824378  -0.00049033996  0              0.0076376532   1.071112e-13   0              1.0344033e-08  1.1965779e-13  0              2.9940211    
   2400000   9810           200            200            0.0023824377  -0.00049033997  0              0.0076376532   1.6284279e-14  0              1.5726191e-09  1.1965779e-13  0              2.9940211    
   2500000   9810           200            200            0.0023824377  -0.00049033997  0              0.0076376531   4.7638099e-15  0              4.6005467e-10  1.1965779e-13  0              2.9940211    
   2600000   9810           200            200            0.0023824377  -0.00049033997  0              0.0076376531   1.1564648e-17  0              1.1168309e-12  1.1965779e-13  0              2.9940211    
   2700000   9810           200            200            0.0023824377  -0.00049033997  0              0.0076376531   9.3536567e-17  0              9.0330922e-12  1.1965779e-13  0              2.9940211    
   2800000   9810           200            200            0.0023824377  -0.00049033997  0              0.0076376531   4.3481717e-18  0              4.199153e-13   1.1965779e-13  0              2.9940211    
   2900000   9810           200            200            0.0023824377  -0.00049033997  0              0.0076376531   6.0276754e-18  0              5.8210975e-13  1.1965779e-13  0              2.9940211    
   3000000   9810           200            200            0.0023824377  -0.00049033997  0              0.0076376531   4.8814361e-18  0              4.7141416e-13  1.1965779e-13  0              2.9940211    
Loop time of 299.567 on 4 procs for 3000000 steps with 2501 atoms

Performance: 8652478.859 ns/day, 0.000 hours/ns, 10014.443 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 11.252     | 36.182     | 62.022     | 411.5 | 12.08
Neigh   | 6.1288     | 6.2463     | 6.3669     |   4.4 |  2.09
Comm    | 22.263     | 42.819     | 81.416     | 348.1 | 14.29
Output  | 0.27274    | 0.27304    | 0.27337    |   0.1 |  0.09
Modify  | 108.8      | 157.63     | 177.58     | 226.1 | 52.62
Other   |            | 56.42      |            |       | 18.83

Nlocal:         625.25 ave         876 max         375 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:           1.75 ave           3 max           1 min
Histogram: 2 0 0 0 0 1 0 0 0 1
Neighs:         312.25 ave         625 max           0 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 1249
Ave neighs/atom = 0.49940024
Neighbor list builds = 166
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 55

#variable lat0 equal 1                    #
variable lat1 equal 3+(300*0.01)+(v_ind*0.01)  # .491+(v_ind*0.001)       # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 500*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 6.55                                                               
Lattice spacing in x,y,z = 6.55 6.55 6.55

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -4912.5 ${n1e1} -100 100 -100 100 units box
region box block -4912.5 4912.5 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -4912.5 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -4912.5 4912.5 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-4912.5 -100 -100) to (4912.5 100 100)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 1500 atoms
  using lattice units in orthogonal box = (-4912.5 -100 -100) to (4912.5 100 100)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 1500 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 1001 atoms
  using lattice units in orthogonal box = (-4912.5 -100 -100) to (4912.5 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  1500 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  1500 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  1001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  1001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
1500 atoms in group substrate
group slider1 region slider1
1001 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 1001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_55_*.dump id type diameter mass xu yu zu fx fy fz

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 6339 130 130
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 123.4 | 123.4 | 123.4 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   9825           200            200            0              0              0              0              0              0              0              1.1965779e-13  0              6            
    100000   9825           200            200            0.0020523261   8.2218591e-36  0              0.0061569782   577802.86      0              5.5800065e+10  1.1965779e-13  0              3.3322895    
    200000   9825           200            200            0.00069193937  8.2218586e-36  0              0.0020758181   130209.08      0              1.2574661e+10  1.1965779e-13  0              3.0842624    
    300000   9825           200            200           -1.0176356e-05  3.2887619e-35  0             -3.0529067e-05  63.06402       0              6090271.7      1.1965779e-13  0              3.0437251    
    400000   9825           200            200           -1.281667e-05   2.4665523e-35  0             -3.845001e-05   103.47882      0              9993243.4      1.1965779e-13  0              3.005374     
    500000   9825           200            200            0.00023982075 -0.0018037075   0              0.0025231697   528.94163      0              51081396       1.1965779e-13  0              2.9965166    
    600000   9825           200            200            0.0018926471  -0.0024071715   0              0.0080851127   185.24511      0              17889647       1.1965779e-13  0              2.9939189    
    700000   9825           200            200            0.0017235167  -0.0023953182   0              0.0075658683   25.269809      0              2440377.2      1.1965779e-13  0              2.994093     
    800000   9825           200            200            0.0017395071  -0.0024016401   0              0.0076201615   3.4159759      0              329890.51      1.1965779e-13  0              2.9940819    
    900000   9825           200            200            0.0017433142  -0.0024023298   0              0.0076322726   0.45976758     0              44401.062      1.1965779e-13  0              2.9940734    
   1000000   9825           200            200            0.0017400344  -0.0024018934   0              0.0076219967   0.061677119    0              5956.3347      1.1965779e-13  0              2.9940788    
   1100000   9825           200            200            0.0017420443  -0.0024021324   0              0.0076282652   0.0082586003   0              797.5565       1.1965779e-13  0              2.9940758    
   1200000   9825           200            200            0.0017410336  -0.0024020181   0              0.007625119    0.0011027071   0              106.49156      1.1965779e-13  0              2.9940772    
   1300000   9825           200            200            0.0017415071  -0.0024020701   0              0.0076265913   0.00014688784  0              14.185376      1.1965779e-13  0              2.9940766    
   1400000   9825           200            200            0.0017412962  -0.0024020474   0              0.007625936    1.951494e-05   0              1.8846132      1.1965779e-13  0              2.9940769    
   1500000   9825           200            200            0.0017413872  -0.002402057    0              0.0076262186   2.5860243e-06  0              0.24973972     1.1965779e-13  0              2.9940767    
   1600000   9825           200            200            0.0017413488  -0.002402053    0              0.0076260995   3.4177542e-07  0              0.033006224    1.1965779e-13  0              2.9940768    
   1700000   9825           200            200            0.0017413647  -0.0024020547   0              0.0076261488   4.5048243e-08  0              0.0043504369   1.1965779e-13  0              2.9940768    
   1800000   9825           200            200            0.0017413582  -0.002402054    0              0.0076261287   5.9211994e-09  0              0.00057182705  1.1965779e-13  0              2.9940768    
   1900000   9825           200            200            0.0017413609  -0.0024020543   0              0.0076261368   7.7607582e-10  0              7.4947847e-05  1.1965779e-13  0              2.9940768    
   2000000   9825           200            200            0.0017413598  -0.0024020542   0              0.0076261336   1.0141952e-10  0              9.7943715e-06  1.1965779e-13  0              2.9940768    
   2100000   9825           200            200            0.0017413602  -0.0024020542   0              0.0076261349   1.321563e-11   0              1.276271e-06   1.1965779e-13  0              2.9940768    
   2200000   9825           200            200            0.0017413601  -0.0024020542   0              0.0076261344   1.716252e-12   0              1.6574333e-07  1.1965779e-13  0              2.9940768    
   2300000   9825           200            200            0.0017413601  -0.0024020542   0              0.0076261346   2.217936e-13   0              2.1419238e-08  1.1965779e-13  0              2.9940768    
   2400000   9825           200            200            0.0017413601  -0.0024020542   0              0.0076261345   2.8622317e-14  0              2.7641385e-09  1.1965779e-13  0              2.9940768    
   2500000   9825           200            200            0.0017413601  -0.0024020542   0              0.0076261345   3.6832465e-15  0              3.5570159e-10  1.1965779e-13  0              2.9940768    
   2600000   9825           200            200            0.0017413601  -0.0024020542   0              0.0076261345   4.5057955e-16  0              4.3513747e-11  1.1965779e-13  0              2.9940768    
   2700000   9825           200            200            0.0017413601  -0.0024020542   0              0.0076261345   6.8860027e-17  0              6.6500085e-12  1.1965779e-13  0              2.9940768    
   2800000   9825           200            200            0.0017413601  -0.0024020542   0              0.0076261345   1.0911913e-17  0              1.0537945e-12  1.1965779e-13  0              2.9940768    
   2900000   9825           200            200            0.0017413601  -0.0024020542   0              0.0076261345   1.8224515e-19  0              1.7599933e-14  1.1965779e-13  0              2.9940768    
   3000000   9825           200            200            0.0017413601  -0.0024020542   0              0.0076261345   1.4309114e-18  0              1.3818718e-13  1.1965779e-13  0              2.9940768    
Loop time of 296.903 on 4 procs for 3000000 steps with 2501 atoms

Performance: 8730112.445 ns/day, 0.000 hours/ns, 10104.297 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 11.178     | 35.709     | 61.061     | 408.1 | 12.03
Neigh   | 6.0465     | 6.1628     | 6.2816     |   4.3 |  2.08
Comm    | 22.425     | 40.842     | 77.888     | 339.7 | 13.76
Output  | 0.27161    | 0.27192    | 0.27225    |   0.1 |  0.09
Modify  | 109.56     | 157.57     | 177.99     | 224.0 | 53.07
Other   |            | 56.35      |            |       | 18.98

Nlocal:         625.25 ave         876 max         375 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:           1.75 ave           3 max           1 min
Histogram: 2 0 0 0 0 1 0 0 0 1
Neighs:         309.75 ave         620 max           0 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 1239
Ave neighs/atom = 0.49540184
Neighbor list builds = 166
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 56

#variable lat0 equal 1                    #
variable lat1 equal 3+(300*0.01)+(v_ind*0.01)  # .491+(v_ind*0.001)       # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 500*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 6.56                                                               
Lattice spacing in x,y,z = 6.56 6.56 6.56

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -4920 ${n1e1} -100 100 -100 100 units box
region box block -4920 4920 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -4920 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -4920 4920 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-4920 -100 -100) to (4920 100 100)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 1500 atoms
  using lattice units in orthogonal box = (-4920 -100 -100) to (4920 100 100)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 1500 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 1001 atoms
  using lattice units in orthogonal box = (-4920 -100 -100) to (4920 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  1500 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  1500 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  1001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  1001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
1500 atoms in group substrate
group slider1 region slider1
1001 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 1001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_56_*.dump id type diameter mass xu yu zu fx fy fz

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 6349 130 130
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 123.6 | 123.6 | 123.6 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   9840           200            200            0              0              0              0              0              0              0              1.1965779e-13  0              6            
    100000   9840           200            200            0.002048581    2.0523248e-36  0              0.0061457429   577542.21      0              5.5774893e+10  1.1965779e-13  0              3.3324962    
    200000   9840           200            200            0.00068952143  6.5674769e-35  0              0.0020685643   129806.24      0              1.2535758e+10  1.1965779e-13  0              3.0845734    
    300000   9840           200            200           -1.2487772e-05  8.2093572e-36  0             -3.7463316e-05  95.919302      0              9263199.6      1.1965779e-13  0              3.043572     
    400000   9840           200            200           -2.1623851e-05  8.2093341e-36  0             -6.4871553e-05  302.34303      0              29198126       1.1965779e-13  0              3.0051114    
    500000   9840           200            200            0.0018479481  -0.00012389388  0              0.0056677381   1311.8253      0              1.266867e+08   1.1965779e-13  0              2.9948143    
    600000   9840           200            200            0.0017980451   0.00017663354  0              0.0052175017   22.207019      0              2144595        1.1965779e-13  0              2.9950875    
    700000   9840           200            200            0.0024980613  -0.0010955643   0              0.0085897483   1.3685185      0              132161.72      1.1965779e-13  0              2.9936785    
    800000   9840           200            200            0.0021473127  -0.0008928263   0              0.0073347644   1.3780164      0              133078.96      1.1965779e-13  0              2.9941644    
    900000   9840           200            200            0.0022490228  -0.00092417117  0              0.0076712396   0.3790968      0              36610.455      1.1965779e-13  0              2.9940329    
   1000000   9840           200            200            0.0022316298  -0.00091937219  0              0.0076142615   0.062016319    0              5989.0922      1.1965779e-13  0              2.9940542    
   1100000   9840           200            200            0.002229427   -0.0009185845   0              0.0076068656   0.0068024734   0              656.93419      1.1965779e-13  0              2.9940576    
   1200000   9840           200            200            0.0022332484  -0.00091976727  0              0.0076195126   0.00045030243  0              43.486985      1.1965779e-13  0              2.9940525    
   1300000   9840           200            200            0.0022310081  -0.00091908894  0              0.0076121134   8.8293745e-06  0              0.85267779     1.1965779e-13  0              2.9940554    
   1400000   9840           200            200            0.0022319813  -0.00091938065  0              0.0076153246   7.8876547e-07  0              0.076173323    1.1965779e-13  0              2.9940542    
   1500000   9840           200            200            0.0022316368  -0.00091927844  0              0.0076141888   9.8235898e-07  0              0.094869199    1.1965779e-13  0              2.9940546    
   1600000   9840           200            200            0.0022317344  -0.00091930703  0              0.0076145103   2.9036817e-07  0              0.028041679    1.1965779e-13  0              2.9940545    
   1700000   9840           200            200            0.002231716   -0.00091930182  0              0.0076144499   5.0345556e-08  0              0.0048620135   1.1965779e-13  0              2.9940545    
   1800000   9840           200            200            0.0022317151  -0.00091930142  0              0.0076144467   5.8384259e-09  0              0.00056383338  1.1965779e-13  0              2.9940545    
   1900000   9840           200            200            0.0022317182  -0.00091930239  0              0.0076144569   4.2045231e-10  0              4.0604275e-05  1.1965779e-13  0              2.9940545    
   2000000   9840           200            200            0.0022317162  -0.0009193018   0              0.0076144505   1.1006437e-11  0              1.0629229e-06  1.1965779e-13  0              2.9940545    
   2100000   9840           200            200            0.0022317171  -0.00091930206  0              0.0076144534   3.1523187e-13  0              3.0442838e-08  1.1965779e-13  0              2.9940545    
   2200000   9840           200            200            0.0022317168  -0.00091930197  0              0.0076144524   6.7341299e-13  0              6.5033407e-08  1.1965779e-13  0              2.9940545    
   2300000   9840           200            200            0.0022317169  -0.00091930199  0              0.0076144527   2.2063521e-13  0              2.130737e-08   1.1965779e-13  0              2.9940545    
   2400000   9840           200            200            0.0022317169  -0.00091930199  0              0.0076144526   4.0602251e-14  0              3.9210747e-09  1.1965779e-13  0              2.9940545    
   2500000   9840           200            200            0.0022317169  -0.00091930199  0              0.0076144526   4.9754158e-15  0              4.8049004e-10  1.1965779e-13  0              2.9940545    
   2600000   9840           200            200            0.0022317169  -0.00091930199  0              0.0076144526   3.7067173e-16  0              3.5796822e-11  1.1965779e-13  0              2.9940545    
   2700000   9840           200            200            0.0022317169  -0.00091930199  0              0.0076144526   2.2296024e-17  0              2.1531905e-12  1.1965779e-13  0              2.9940545    
   2800000   9840           200            200            0.0022317169  -0.00091930199  0              0.0076144526   3.5825477e-19  0              3.4597681e-14  1.1965779e-13  0              2.9940545    
   2900000   9840           200            200            0.0022317169  -0.00091930199  0              0.0076144526   1.1542584e-18  0              1.1147001e-13  1.1965779e-13  0              2.9940545    
   3000000   9840           200            200            0.0022317169  -0.00091930198  0              0.0076144526   1.0029791e-18  0              9.6860539e-14  1.1965779e-13  0              2.9940545    
Loop time of 297.249 on 4 procs for 3000000 steps with 2501 atoms

Performance: 8719953.502 ns/day, 0.000 hours/ns, 10092.539 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 11.156     | 35.736     | 61.193     | 408.7 | 12.02
Neigh   | 6.1048     | 6.2132     | 6.3252     |   4.0 |  2.09
Comm    | 22.404     | 40.92      | 78.112     | 340.8 | 13.77
Output  | 0.27111    | 0.27142    | 0.27175    |   0.1 |  0.09
Modify  | 109.55     | 157.66     | 177.66     | 224.4 | 53.04
Other   |            | 56.45      |            |       | 18.99

Nlocal:         625.25 ave         876 max         375 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:           1.75 ave           3 max           1 min
Histogram: 2 0 0 0 0 1 0 0 0 1
Neighs:         309.25 ave         619 max           0 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 1237
Ave neighs/atom = 0.49460216
Neighbor list builds = 166
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 57

#variable lat0 equal 1                    #
variable lat1 equal 3+(300*0.01)+(v_ind*0.01)  # .491+(v_ind*0.001)       # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 500*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 6.57                                                               
Lattice spacing in x,y,z = 6.57 6.57 6.57

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -4927.5 ${n1e1} -100 100 -100 100 units box
region box block -4927.5 4927.5 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -4927.5 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -4927.5 4927.5 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-4927.5 -100 -100) to (4927.5 100 100)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 1500 atoms
  using lattice units in orthogonal box = (-4927.5 -100 -100) to (4927.5 100 100)
  create_atoms CPU = 0.000 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 1500 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 1001 atoms
  using lattice units in orthogonal box = (-4927.5 -100 -100) to (4927.5 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  1500 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  1500 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  1001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  1001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
1500 atoms in group substrate
group slider1 region slider1
1001 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 1001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_57_*.dump id type diameter mass xu yu zu fx fy fz

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 6359 130 130
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 123.8 | 123.8 | 123.8 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   9855           200            200            0              0              0              0              0              0              0              1.1965779e-13  0              6            
    100000   9855           200            200            0.0020457055   8.4070615e-41  0              0.0061371165   577648.71      0              5.5785178e+10  1.1965779e-13  0              3.3323839    
    200000   9855           200            200            0.00068903078 -1.3934535e-34  0              0.0020670924   129973.35      0              1.2551896e+10  1.1965779e-13  0              3.0844056    
    300000   9855           200            200           -1.1467185e-05 -1.2295178e-35  0             -3.4401554e-05  80.895529      0              7812311.2      1.1965779e-13  0              3.0435975    
    400000   9855           200            200           -1.8952569e-05  1.3114903e-34  0             -5.6857706e-05  231.42657      0              22349522       1.1965779e-13  0              3.0051743    
    500000   9855           200            200            0.0015015413   0.00022623323  0              0.0042783907   1090.3284      0              1.0529612e+08  1.1965779e-13  0              2.9954448    
    600000   9855           200            200            0.0022163944   0.00027724358  0              0.0063719398   148.69133      0              14359544       1.1965779e-13  0              2.9945346    
    700000   9855           200            200            0.0025176035   0.00021122559  0              0.0073415849   23.993553      0              2317125.6      1.1965779e-13  0              2.9941109    
    800000   9855           200            200            0.0027103834   0.00017202593  0              0.0079591244   0.27842469     0              26888.264      1.1965779e-13  0              2.9938815    
    900000   9855           200            200            0.0025716016   0.00020378744  0              0.0075110175   0.24366398     0              23531.323      1.1965779e-13  0              2.9940528    
   1000000   9855           200            200            0.0025958721   0.0002023381   0              0.0075852783   0.055057324    0              5317.0423      1.1965779e-13  0              2.994023     
   1100000   9855           200            200            0.0026075567   0.00020178402  0              0.0076208861   0.00010742286  0              10.374131      1.1965779e-13  0              2.9940096    
   1200000   9855           200            200            0.0026004338   0.00020212517  0              0.0075991761   0.00079907459  0              77.168904      1.1965779e-13  0              2.994018     
   1300000   9855           200            200            0.0026011954   0.00020208525  0              0.007601501    0.00011392827  0              11.002377      1.1965779e-13  0              2.9940171    
   1400000   9855           200            200            0.0026019058   0.00020205119  0              0.0076036663   9.706966e-08   0              0.009374293    1.1965779e-13  0              2.9940162    
   1500000   9855           200            200            0.00260157     0.00020206768  0              0.0076026422   2.3786452e-06  0              0.22971253     1.1965779e-13  0              2.9940166    
   1600000   9855           200            200            0.0026015843   0.00020206686  0              0.0076026861   2.1532709e-07  0              0.020794749    1.1965779e-13  0              2.9940166    
   1700000   9855           200            200            0.0026016249   0.0002020649   0              0.0076028099   3.1149575e-09  0              0.0003008203   1.1965779e-13  0              2.9940166    
   1800000   9855           200            200            0.0026016097   0.00020206565  0              0.0076027633   6.5477119e-09  0              0.00063233115  1.1965779e-13  0              2.9940166    
   1900000   9855           200            200            0.0026016092   0.00020206567  0              0.0076027619   3.6182965e-10  0              3.4942918e-05  1.1965779e-13  0              2.9940166    
   2000000   9855           200            200            0.0026016114   0.00020206556  0              0.0076027687   2.185554e-11   0              2.1106516e-06  1.1965779e-13  0              2.9940166    
   2100000   9855           200            200            0.0026016107   0.0002020656   0              0.0076027666   1.681235e-11   0              1.6236164e-06  1.1965779e-13  0              2.9940166    
   2200000   9855           200            200            0.0026016107   0.0002020656   0              0.0076027664   5.106437e-13   0              4.9314314e-08  1.1965779e-13  0              2.9940166    
   2300000   9855           200            200            0.0026016108   0.00020206559  0              0.0076027667   1.0184741e-13  0              9.8356938e-09  1.1965779e-13  0              2.9940166    
   2400000   9855           200            200            0.0026016108   0.00020206559  0              0.0076027667   4.0351622e-14  0              3.8968708e-09  1.1965779e-13  0              2.9940166    
   2500000   9855           200            200            0.0026016107   0.0002020656   0              0.0076027666   5.1903918e-16  0              5.0125089e-11  1.1965779e-13  0              2.9940166    
   2600000   9855           200            200            0.0026016107   0.00020206559  0              0.0076027667   3.608441e-16   0              3.484774e-11   1.1965779e-13  0              2.9940166    
   2700000   9855           200            200            0.0026016107   0.00020206559  0              0.0076027667   8.1470541e-17  0              7.8678417e-12  1.1965779e-13  0              2.9940166    
   2800000   9855           200            200            0.0026016107   0.00020206559  0              0.0076027667   1.5001215e-19  0              1.44871e-14    1.1965779e-13  0              2.9940166    
   2900000   9855           200            200            0.0026016107   0.00020206559  0              0.0076027667   1.7445675e-18  0              1.6847784e-13  1.1965779e-13  0              2.9940166    
   3000000   9855           200            200            0.0026016107   0.0002020656   0              0.0076027667   7.1225799e-18  0              6.8784778e-13  1.1965779e-13  0              2.9940166    
Loop time of 300.594 on 4 procs for 3000000 steps with 2501 atoms

Performance: 8622933.065 ns/day, 0.000 hours/ns, 9980.247 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 11.148     | 36.186     | 62.087     | 413.8 | 12.04
Neigh   | 6.1243     | 6.234      | 6.3473     |   4.1 |  2.07
Comm    | 22.657     | 41.279     | 78.941     | 343.4 | 13.73
Output  | 0.29078    | 0.29108    | 0.29139    |   0.1 |  0.10
Modify  | 111.3      | 159.64     | 180.86     | 223.5 | 53.11
Other   |            | 56.97      |            |       | 18.95

Nlocal:         625.25 ave         876 max         375 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:           1.75 ave           3 max           1 min
Histogram: 2 0 0 0 0 1 0 0 0 1
Neighs:         310.75 ave         622 max           0 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 1243
Ave neighs/atom = 0.4970012
Neighbor list builds = 166
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 58

#variable lat0 equal 1                    #
variable lat1 equal 3+(300*0.01)+(v_ind*0.01)  # .491+(v_ind*0.001)       # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 500*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 6.58                                                               
Lattice spacing in x,y,z = 6.58 6.58 6.58

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -4935 ${n1e1} -100 100 -100 100 units box
region box block -4935 4935 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -4935 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -4935 4935 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-4935 -100 -100) to (4935 100 100)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 1500 atoms
  using lattice units in orthogonal box = (-4935 -100 -100) to (4935 100 100)
  create_atoms CPU = 0.000 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 1500 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 1001 atoms
  using lattice units in orthogonal box = (-4935 -100 -100) to (4935 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  1500 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  1500 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  1001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  1001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
1500 atoms in group substrate
group slider1 region slider1
1001 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 1001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_58_*.dump id type diameter mass xu yu zu fx fy fz

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 6368 130 130
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 123.9 | 123.9 | 123.9 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   9870           200            200            0              0              0              0              0              0              0              1.1965779e-13  0              6            
    100000   9870           200            200            0.002042914   -4.092156e-36   0              0.0061287421   577797.18      0              5.5799515e+10  1.1965779e-13  0              3.3321644    
    200000   9870           200            200            0.00068914102  3.7168058e-41  0              0.0020674231   130325.74      0              1.2585927e+10  1.1965779e-13  0              3.0839294    
    300000   9870           200            200           -1.0485659e-05  1.636906e-35   0             -3.1456978e-05  67.654158      0              6533554.3      1.1965779e-13  0              3.0435246    
    400000   9870           200            200           -2.0182304e-05 -4.0921404e-36  0             -6.0546913e-05  264.08752      0              25503682       1.1965779e-13  0              3.0050582    
    500000   9870           200            200            0.0019107689  -0.0012642828   0              0.0069965894   1398.1478      0              1.350231e+08   1.1965779e-13  0              2.9941453    
    600000   9870           200            200            0.0014883457  -0.00063665775  0              0.0051016947   4.5096089      0              435505.75      1.1965779e-13  0              2.9950465    
    700000   9870           200            200            0.0024690515  -0.00089703754  0              0.0083041921   12.58001       0              1214887.3      1.1965779e-13  0              2.9936883    
    800000   9870           200            200            0.0021628305  -0.00094216826  0              0.0074306597   2.7481592      0              265397.55      1.1965779e-13  0              2.994022     
    900000   9870           200            200            0.0022201751  -0.00094802569  0              0.0076085511   0.45127717     0              43581.119      1.1965779e-13  0              2.9939546    
   1000000   9870           200            200            0.0022172522  -0.00094804159  0              0.0075997982   0.059602659    0              5755.9982      1.1965779e-13  0              2.9939567    
   1100000   9870           200            200            0.0022114804  -0.0009481072   0              0.0075825485   0.0063692551   0              615.09707      1.1965779e-13  0              2.9939641    
   1200000   9870           200            200            0.0022159254  -0.00094805813  0              0.0075958344   0.00052002652  0              50.220439      1.1965779e-13  0              2.9939586    
   1300000   9870           200            200            0.0022136034  -0.00094808287  0              0.007588893    2.6540498e-05  0              2.5630913      1.1965779e-13  0              2.9939614    
   1400000   9870           200            200            0.0022146252  -0.00094807195  0              0.0075919477   2.713111e-07   0              0.026201284    1.1965779e-13  0              2.9939602    
   1500000   9870           200            200            0.002214225   -0.00094807617  0              0.0075907513   1.0983878e-07  0              0.010607443    1.1965779e-13  0              2.9939607    
   1600000   9870           200            200            0.0022143666  -0.00094807468  0              0.0075911745   9.1021029e-08  0              0.0087901595   1.1965779e-13  0              2.9939605    
   1700000   9870           200            200            0.0022143217  -0.00094807515  0              0.0075910404   2.7537946e-08  0              0.0026594177   1.1965779e-13  0              2.9939606    
   1800000   9870           200            200            0.002214334   -0.00094807503  0              0.0075910769   5.6501011e-09  0              0.00054564632  1.1965779e-13  0              2.9939606    
   1900000   9870           200            200            0.0022143315  -0.00094807505  0              0.0075910695   9.0576991e-10  0              8.7472775e-05  1.1965779e-13  0              2.9939606    
   2000000   9870           200            200            0.0022143316  -0.00094807505  0              0.0075910698   1.1821207e-10  0              1.1416075e-05  1.1965779e-13  0              2.9939606    
   2100000   9870           200            200            0.0022143318  -0.00094807505  0              0.0075910706   1.2469779e-11  0              1.204242e-06   1.1965779e-13  0              2.9939606    
   2200000   9870           200            200            0.0022143316  -0.00094807505  0              0.00759107     9.9740174e-13  0              9.6321921e-08  1.1965779e-13  0              2.9939606    
   2300000   9870           200            200            0.0022143317  -0.00094807505  0              0.0075910703   4.8578697e-14  0              4.6913828e-09  1.1965779e-13  0              2.9939606    
   2400000   9870           200            200            0.0022143317  -0.00094807505  0              0.0075910702   3.3292597e-16  0              3.2151608e-11  1.1965779e-13  0              2.9939606    
   2500000   9870           200            200            0.0022143317  -0.00094807505  0              0.0075910702   2.7610401e-16  0              2.6664149e-11  1.1965779e-13  0              2.9939606    
   2600000   9870           200            200            0.0022143317  -0.00094807505  0              0.0075910702   1.9873466e-16  0              1.9192371e-11  1.1965779e-13  0              2.9939606    
   2700000   9870           200            200            0.0022143317  -0.00094807505  0              0.0075910702   3.9709351e-17  0              3.8348449e-12  1.1965779e-13  0              2.9939606    
   2800000   9870           200            200            0.0022143317  -0.00094807505  0              0.0075910702   5.6670676e-18  0              5.4728483e-13  1.1965779e-13  0              2.9939606    
   2900000   9870           200            200            0.0022143317  -0.00094807505  0              0.0075910702   4.7176999e-18  0              4.5560169e-13  1.1965779e-13  0              2.9939606    
   3000000   9870           200            200            0.0022143317  -0.00094807505  0              0.0075910702   6.6665471e-18  0              6.438074e-13   1.1965779e-13  0              2.9939606    
Loop time of 296.653 on 4 procs for 3000000 steps with 2501 atoms

Performance: 8737479.248 ns/day, 0.000 hours/ns, 10112.823 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 11.072     | 35.913     | 60.945     | 410.0 | 12.11
Neigh   | 6.1102     | 6.2268     | 6.3464     |   4.3 |  2.10
Comm    | 22.828     | 40.83      | 77.509     | 336.2 | 13.76
Output  | 0.27251    | 0.27281    | 0.27312    |   0.1 |  0.09
Modify  | 109.69     | 157.17     | 177.26     | 221.3 | 52.98
Other   |            | 56.24      |            |       | 18.96

Nlocal:         625.25 ave         876 max         375 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:           1.75 ave           3 max           1 min
Histogram: 2 0 0 0 0 1 0 0 0 1
Neighs:         310.25 ave         621 max           0 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 1241
Ave neighs/atom = 0.49620152
Neighbor list builds = 166
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 59

#variable lat0 equal 1                    #
variable lat1 equal 3+(300*0.01)+(v_ind*0.01)  # .491+(v_ind*0.001)       # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 500*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 6.59                                                               
Lattice spacing in x,y,z = 6.59 6.59 6.59

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -4942.5 ${n1e1} -100 100 -100 100 units box
region box block -4942.5 4942.5 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -4942.5 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -4942.5 4942.5 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-4942.5 -100 -100) to (4942.5 100 100)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 1500 atoms
  using lattice units in orthogonal box = (-4942.5 -100 -100) to (4942.5 100 100)
  create_atoms CPU = 0.000 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 1500 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 1001 atoms
  using lattice units in orthogonal box = (-4942.5 -100 -100) to (4942.5 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  1500 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  1500 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  1001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  1001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
1500 atoms in group substrate
group slider1 region slider1
1001 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 1001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_59_*.dump id type diameter mass xu yu zu fx fy fz

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 6378 130 130
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 124 | 124.1 | 124.1 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   9885           200            200            0              0              0              0              0              0              0              1.1965779e-13  0              6            
    100000   9885           200            200            0.0020393277   1.0638787e-40  0              0.0061179831   577606.44      0              5.5781096e+10  1.1965779e-13  0              3.3321993    
    200000   9885           200            200            0.00068716809 -3.2687461e-35  0              0.0020615043   130057.84      0              1.2560055e+10  1.1965779e-13  0              3.0839702    
    300000   9885           200            200           -1.1943604e-05 -3.2686341e-35  0             -3.5830813e-05  88.442331      0              8541127.3      1.1965779e-13  0              3.0432677    
    400000   9885           200            200           -2.5319103e-05 -1.6343427e-35  0             -7.5957309e-05  422.35787      0              40788300       1.1965779e-13  0              3.0047072    
    500000   9885           200            200            0.0036249686  -0.00028552432  0              0.01116043     1086.8758      0              1.0496268e+08  1.1965779e-13  0              2.9924339    
    600000   9885           200            200            0.0019448063  -0.0010429157   0              0.0068773345   175.20119      0              16919677       1.1965779e-13  0              2.99405      
    700000   9885           200            200            0.0019344196  -0.0010087814   0              0.0068120402   8.6150097      0              831975.97      1.1965779e-13  0              2.9941033    
    800000   9885           200            200            0.0023156604  -0.00097697377  0              0.007923955    0.27129618     0              26199.843      1.1965779e-13  0              2.9936454    
    900000   9885           200            200            0.002181354   -0.00098053409  0              0.0075245962   0.37820463     0              36524.296      1.1965779e-13  0              2.9938027    
   1000000   9885           200            200            0.0021927698  -0.00098065183  0              0.0075589612   0.049983005    0              4827.0009      1.1965779e-13  0              2.9937901    
   1100000   9885           200            200            0.0022052385  -0.00098033971  0              0.0075960552   0.00058867713  0              56.850224      1.1965779e-13  0              2.9937748    
   1200000   9885           200            200            0.0021977186  -0.00098051941  0              0.0075736752   0.0003434371   0              33.166697      1.1965779e-13  0              2.9937838    
   1300000   9885           200            200            0.0021996471  -0.00098047328  0              0.0075794145   0.00014810104  0              14.302539      1.1965779e-13  0              2.9937816    
   1400000   9885           200            200            0.0021997359  -0.00098047064  0              0.0075796783   1.1162979e-05  0              1.0780406      1.1965779e-13  0              2.9937815    
   1500000   9885           200            200            0.0021994331  -0.00098047808  0              0.0075787772   1.4580363e-09  0              0.00014080671  1.1965779e-13  0              2.9937818    
   1600000   9885           200            200            0.0021995664  -0.00098047486  0              0.0075791742   2.2008765e-07  0              0.02125449     1.1965779e-13  0              2.9937817    
   1700000   9885           200            200            0.0021995433  -0.0009804754   0              0.0075791052   4.8421875e-08  0              0.0046762381   1.1965779e-13  0              2.9937817    
   1800000   9885           200            200            0.0021995364  -0.00098047558  0              0.0075790848   1.7920097e-09  0              0.00017305947  1.1965779e-13  0              2.9937817    
   1900000   9885           200            200            0.0021995428  -0.00098047542  0              0.0075791039   8.779533e-11   0              8.4786446e-06  1.1965779e-13  0              2.9937817    
   2000000   9885           200            200            0.0021995407  -0.00098047547  0              0.0075790975   1.0422927e-10  0              1.0065717e-05  1.1965779e-13  0              2.9937817    
   2100000   9885           200            200            0.0021995408  -0.00098047547  0              0.007579098    1.3224393e-11  0              1.2771172e-06  1.1965779e-13  0              2.9937817    
   2200000   9885           200            200            0.002199541   -0.00098047546  0              0.0075790986   1.3552013e-13  0              1.3087564e-08  1.1965779e-13  0              2.9937817    
   2300000   9885           200            200            0.0021995409  -0.00098047547  0              0.0075790982   9.8358538e-14  0              9.4987636e-09  1.1965779e-13  0              2.9937817    
   2400000   9885           200            200            0.002199541   -0.00098047547  0              0.0075790983   4.0167484e-14  0              3.8790881e-09  1.1965779e-13  0              2.9937817    
   2500000   9885           200            200            0.002199541   -0.00098047547  0              0.0075790983   2.8157408e-15  0              2.7192409e-10  1.1965779e-13  0              2.9937817    
   2600000   9885           200            200            0.0021995409  -0.00098047547  0              0.0075790983   5.3246424e-18  0              5.1421585e-13  1.1965779e-13  0              2.9937817    
   2700000   9885           200            200            0.002199541   -0.00098047547  0              0.0075790983   4.9744755e-17  0              4.8039924e-12  1.1965779e-13  0              2.9937817    
   2800000   9885           200            200            0.002199541   -0.00098047547  0              0.0075790983   1.313827e-17   0              1.2688e-12     1.1965779e-13  0              2.9937817    
   2900000   9885           200            200            0.002199541   -0.00098047547  0              0.0075790983   2.5737798e-19  0              2.4855723e-14  1.1965779e-13  0              2.9937817    
   3000000   9885           200            200            0.002199541   -0.00098047547  0              0.0075790983   1.0143482e-18  0              9.7958486e-14  1.1965779e-13  0              2.9937817    
Loop time of 296.633 on 4 procs for 3000000 steps with 2501 atoms

Performance: 8738065.074 ns/day, 0.000 hours/ns, 10113.501 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 11.033     | 35.774     | 60.967     | 409.5 | 12.06
Neigh   | 6.1504     | 6.2659     | 6.3868     |   4.4 |  2.11
Comm    | 22.84      | 40.795     | 77.562     | 336.9 | 13.75
Output  | 0.27087    | 0.27117    | 0.27149    |   0.1 |  0.09
Modify  | 109.22     | 157.05     | 177.83     | 223.4 | 52.94
Other   |            | 56.48      |            |       | 19.04

Nlocal:         625.25 ave         876 max         375 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:           1.75 ave           3 max           1 min
Histogram: 2 0 0 0 0 1 0 0 0 1
Neighs:         308.75 ave         618 max           0 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 1235
Ave neighs/atom = 0.49380248
Neighbor list builds = 166
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 60

#variable lat0 equal 1                    #
variable lat1 equal 3+(300*0.01)+(v_ind*0.01)  # .491+(v_ind*0.001)       # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 500*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 6.6                                                               
Lattice spacing in x,y,z = 6.6 6.6 6.6

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -4950 ${n1e1} -100 100 -100 100 units box
region box block -4950 4950 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -4950 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -4950 4950 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-4950 -100 -100) to (4950 100 100)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 1500 atoms
  using lattice units in orthogonal box = (-4950 -100 -100) to (4950 100 100)
  create_atoms CPU = 0.000 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 1500 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 1001 atoms
  using lattice units in orthogonal box = (-4950 -100 -100) to (4950 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  1500 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  1500 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  1001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  1001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
1500 atoms in group substrate
group slider1 region slider1
1001 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 1001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_60_*.dump id type diameter mass xu yu zu fx fy fz

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 6388 130 130
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 124.2 | 124.2 | 124.2 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   9900           200            200            0              0              0              0              0              0              0              1.1965779e-13  0              6            
    100000   9900           200            200            0.0020317641   8.1595808e-36  0              0.0060952924   575031.88      0              5.5532463e+10  1.1965779e-13  0              3.3392135    
    200000   9900           200            200            0.00067280522  1.9203084e-40  0              0.0020184157   125839.38      0              1.2152667e+10  1.1965779e-13  0              3.0934991    
    300000   9900           200            200           -1.1569388e-05  1.6319338e-35  0             -3.4708163e-05  82.911863      0              8007034.3      1.1965779e-13  0              3.0475756    
    400000   9900           200            200            5.4467849e-05  3.2638363e-35  0              0.00016340355  1674.826       0              1.6174271e+08  1.1965779e-13  0              3.0071137    
    500000   9900           200            200            0.0060673505  -1.6318907e-35  0              0.018202052    81.632649      0              7883496.9      1.1965779e-13  0              2.9944262    
    600000   9900           200            200            0.0013954783  -3.2637986e-35  0              0.004186435    2.7259338      0              263251.17      1.1965779e-13  0              2.9979045    
    700000   9900           200            200            0.0024686527   5.711684e-35   0              0.0074059582   31.562321      0              3048063.1      1.1965779e-13  0              2.9969315    
    800000   9900           200            200            0.0026665775   8.159649e-36   0              0.0079997325   1.0674835      0              103089.92      1.1965779e-13  0              2.9967745    
    900000   9900           200            200            0.0025744371  -8.1594328e-36  0              0.0077233113   0.19199009     0              18541.029      1.1965779e-13  0              2.9968508    
   1000000   9900           200            200            0.0025217374   3.2638202e-35  0              0.0075652122   0.076255594    0              7364.2195      1.1965779e-13  0              2.9968938    
   1100000   9900           200            200            0.0025174499   8.1595853e-36  0              0.0075523496   0.00082558519  0              79.729108      1.1965779e-13  0              2.9968971    
   1200000   9900           200            200            0.0025231678   1.2239338e-35  0              0.0075695035   0.00078867627  0              76.164709      1.1965779e-13  0              2.9968923    
   1300000   9900           200            200            0.0025255648  -6.1196092e-36  0              0.0075766945   0.0001636229   0              15.801528      1.1965779e-13  0              2.9968903    
   1400000   9900           200            200            0.0025255553   4.0798041e-36  0              0.0075766658   7.7083524e-08  0              0.007444175    1.1965779e-13  0              2.9968904    
   1500000   9900           200            200            0.0025252293   4.079804e-36   0              0.0075756878   2.6742959e-06  0              0.25826436     1.1965779e-13  0              2.9968906    
   1600000   9900           200            200            0.002525127    2.0399212e-36  0              0.0075753811   3.099252e-07   0              0.029930357    1.1965779e-13  0              2.9968907    
   1700000   9900           200            200            0.0025251385   4.0798039e-36  0              0.0075754154   1.8971839e-09  0              0.00018321644  1.1965779e-13  0              2.9968907    
   1800000   9900           200            200            0.0025251559  -4.0797271e-36  0              0.0075754677   7.892925e-09   0              0.0007622422   1.1965779e-13  0              2.9968907    
   1900000   9900           200            200            0.0025251599  -5.0993225e-37  0              0.0075754796   4.9923976e-10  0              4.8213003e-05  1.1965779e-13  0              2.9968907    
   2000000   9900           200            200            0.0025251588   3.8418429e-41  0              0.0075754764   2.3770334e-11  0              2.2955687e-06  1.1965779e-13  0              2.9968907    
   2100000   9900           200            200            0.0025251579  -1.5298736e-36  0              0.0075754738   2.0784845e-11  0              2.0072516e-06  1.1965779e-13  0              2.9968907    
   2200000   9900           200            200            0.0025251578  -5.0993226e-37  0              0.0075754734   6.2577396e-13  0              6.043277e-08   1.1965779e-13  0              2.9968907    
   2300000   9900           200            200            0.0025251579   8.1595694e-36  0              0.0075754736   1.3159535e-13  0              1.2708537e-08  1.1965779e-13  0              2.9968907    
   2400000   9900           200            200            0.0025251579  -1.0199029e-36  0              0.0075754737   4.9276788e-14  0              4.7587995e-09  1.1965779e-13  0              2.9968907    
   2500000   9900           200            200            0.0025251579  -4.0797272e-36  0              0.0075754737   5.1888935e-16  0              5.0110619e-11  1.1965779e-13  0              2.9968907    
   2600000   9900           200            200            0.0025251579  -6.1196099e-36  0              0.0075754737   5.2273189e-16  0              5.0481704e-11  1.1965779e-13  0              2.9968907    
   2700000   9900           200            200            0.0025251579  -1.4279141e-35  0              0.0075754737   8.372278e-17   0              8.0853468e-12  1.1965779e-13  0              2.9968907    
   2800000   9900           200            200            0.0025251579   1.2239335e-35  0              0.0075754737   9.7380723e-19  0              9.4043332e-14  1.1965779e-13  0              2.9968907    
   2900000   9900           200            200            0.0025251579   4.0798049e-36  0              0.0075754737   3.0978916e-18  0              2.991722e-13   1.1965779e-13  0              2.9968907    
   3000000   9900           200            200            0.0025251579  -4.0797615e-35  0              0.0075754737   1.2383162e-19  0              1.1958771e-14  1.1965779e-13  0              2.9968907    
Loop time of 299.68 on 4 procs for 3000000 steps with 2501 atoms

Performance: 8649231.055 ns/day, 0.000 hours/ns, 10010.684 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 11.1       | 37.191     | 63.067     | 422.6 | 12.41
Neigh   | 6.1411     | 6.2566     | 6.377      |   4.3 |  2.09
Comm    | 23.381     | 41.443     | 79.461     | 345.1 | 13.83
Output  | 0.26887    | 0.26916    | 0.26947    |   0.1 |  0.09
Modify  | 110.02     | 157.78     | 178.23     | 221.6 | 52.65
Other   |            | 56.74      |            |       | 18.94

Nlocal:         625.25 ave         876 max         375 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:           1.75 ave           3 max           1 min
Histogram: 2 0 0 0 0 1 0 0 0 1
Neighs:         318.25 ave         637 max           0 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 1273
Ave neighs/atom = 0.5089964
Neighbor list builds = 166
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 61

#variable lat0 equal 1                    #
variable lat1 equal 3+(300*0.01)+(v_ind*0.01)  # .491+(v_ind*0.001)       # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 500*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 6.61                                                               
Lattice spacing in x,y,z = 6.61 6.61 6.61

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -4957.5 ${n1e1} -100 100 -100 100 units box
region box block -4957.5 4957.5 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -4957.5 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -4957.5 4957.5 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-4957.5 -100 -100) to (4957.5 100 100)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 1500 atoms
  using lattice units in orthogonal box = (-4957.5 -100 -100) to (4957.5 100 100)
  create_atoms CPU = 0.000 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 1500 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 1001 atoms
  using lattice units in orthogonal box = (-4957.5 -100 -100) to (4957.5 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  1500 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  1500 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  1001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  1001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
1500 atoms in group substrate
group slider1 region slider1
1001 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 1001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_61_*.dump id type diameter mass xu yu zu fx fy fz

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 6397 130 130
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 124.4 | 124.5 | 124.5 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   9915           200            200            0              0              0              0              0              0              0              1.1965779e-13  0              6            
    100000   9915           200            200            0.0020334991   2.434944e-41   0              0.0061004973   577752.26      0              5.5795178e+10  1.1965779e-13  0              3.3320822    
    200000   9915           200            200            0.00068577717 -8.1471626e-36  0              0.0020573315   130262.24      0              1.2579795e+10  1.1965779e-13  0              3.0838262    
    300000   9915           200            200           -1.0783743e-05 -6.5176927e-35  0             -3.2351229e-05  72.293562      0              6981594.8      1.1965779e-13  0              3.0433576    
    400000   9915           200            200           -2.173934e-05   1.6294731e-35  0             -6.521802e-05   310.52597      0              29988376       1.1965779e-13  0              3.0048669    
    500000   9915           200            200            0.0024442987  -0.0013815541   0              0.0087144501   1363.1241      0              1.3164077e+08  1.1965779e-13  0              2.9933149    
    600000   9915           200            200            0.0017745059  -0.00014649327  0              0.005470011    61.072707      0              5897964.9      1.1965779e-13  0              2.9947062    
    700000   9915           200            200            0.0023971116  -0.0005265323   0              0.0077178673   24.578306      0              2373596.9      1.1965779e-13  0              2.9937543    
    800000   9915           200            200            0.0023833053  -0.00052133642  0              0.0076712524   3.0137114      0              291042.68      1.1965779e-13  0              2.9937626    
    900000   9915           200            200            0.0023319142  -0.00046955276  0              0.0074652955   0.23118934     0              22326.612      1.1965779e-13  0              2.9938482    
   1000000   9915           200            200            0.0023712058  -0.00048727237  0              0.0076008897   0.0083176744   0              803.26146      1.1965779e-13  0              2.9937931    
   1100000   9915           200            200            0.0023515708  -0.00048385486  0              0.0075385673   1.3118839e-05  0              1.2669235      1.1965779e-13  0              2.9938181    
   1200000   9915           200            200            0.0023589707  -0.00048518978  0              0.0075621018   0.00021680922  0              20.937883      1.1965779e-13  0              2.9938087    
   1300000   9915           200            200            0.0023566355  -0.0004847806   0              0.0075546871   8.8418316e-05  0              8.5388081      1.1965779e-13  0              2.9938116    
   1400000   9915           200            200            0.0023572045  -0.00048487916  0              0.0075564928   1.8769928e-05  0              1.8126653      1.1965779e-13  0              2.9938109    
   1500000   9915           200            200            0.0023571371  -0.0004848685   0              0.0075562798   2.6977103e-06  0              0.26052555     1.1965779e-13  0              2.993811     
   1600000   9915           200            200            0.0023571056  -0.00048486239  0              0.0075561793   2.6950171e-07  0              0.026026547    1.1965779e-13  0              2.993811     
   1700000   9915           200            200            0.0023571359  -0.00048486793  0              0.0075562755   1.6188017e-08  0              0.0015633228   1.1965779e-13  0              2.993811     
   1800000   9915           200            200            0.0023571198  -0.00048486503  0              0.0075562244   2.3875193e-10  0              2.3056953e-05  1.1965779e-13  0              2.993811     
   1900000   9915           200            200            0.0023571265  -0.00048486623  0              0.0075562458   4.6022273e-11  0              4.4445017e-06  1.1965779e-13  0              2.993811     
   2000000   9915           200            200            0.0023571242  -0.00048486582  0              0.0075562383   4.4133172e-11  0              4.2620658e-06  1.1965779e-13  0              2.993811     
   2100000   9915           200            200            0.0023571248  -0.00048486593  0              0.0075562405   1.2590489e-11  0              1.2158993e-06  1.1965779e-13  0              2.993811     
   2200000   9915           200            200            0.0023571247  -0.00048486591  0              0.00755624     2.214094e-12   0              2.1382136e-07  1.1965779e-13  0              2.993811     
   2300000   9915           200            200            0.0023571247  -0.00048486591  0              0.00755624     2.7174618e-13  0              2.6243301e-08  1.1965779e-13  0              2.993811     
   2400000   9915           200            200            0.0023571247  -0.00048486591  0              0.0075562401   2.2309625e-14  0              2.1545039e-09  1.1965779e-13  0              2.993811     
   2500000   9915           200            200            0.0023571247  -0.00048486591  0              0.00755624     8.7551514e-16  0              8.4550986e-11  1.1965779e-13  0              2.993811     
   2600000   9915           200            200            0.0023571247  -0.00048486591  0              0.0075562401   6.0632223e-19  0              5.8554262e-14  1.1965779e-13  0              2.993811     
   2700000   9915           200            200            0.0023571247  -0.00048486591  0              0.0075562401   7.6238753e-18  0              7.362593e-13   1.1965779e-13  0              2.993811     
   2800000   9915           200            200            0.0023571247  -0.00048486591  0              0.0075562401   2.266184e-18   0              2.1885183e-13  1.1965779e-13  0              2.993811     
   2900000   9915           200            200            0.0023571247  -0.00048486591  0              0.0075562401   3.5751961e-18  0              3.4526685e-13  1.1965779e-13  0              2.993811     
   3000000   9915           200            200            0.0023571247  -0.00048486591  0              0.0075562401   4.5951544e-18  0              4.4376713e-13  1.1965779e-13  0              2.993811     
Loop time of 299.437 on 4 procs for 3000000 steps with 2501 atoms

Performance: 8656256.672 ns/day, 0.000 hours/ns, 10018.816 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 11.027     | 35.982     | 61.48      | 412.6 | 12.02
Neigh   | 6.1474     | 6.2574     | 6.3704     |   4.1 |  2.09
Comm    | 22.792     | 41.026     | 78.247     | 340.2 | 13.70
Output  | 0.26953    | 0.26982    | 0.27014    |   0.1 |  0.09
Modify  | 111.36     | 159.35     | 180.05     | 222.3 | 53.22
Other   |            | 56.55      |            |       | 18.89

Nlocal:         625.25 ave         876 max         375 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:           1.75 ave           3 max           1 min
Histogram: 2 0 0 0 0 1 0 0 0 1
Neighs:         309.25 ave         619 max           0 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 1237
Ave neighs/atom = 0.49460216
Neighbor list builds = 166
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 62

#variable lat0 equal 1                    #
variable lat1 equal 3+(300*0.01)+(v_ind*0.01)  # .491+(v_ind*0.001)       # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 500*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 6.62                                                               
Lattice spacing in x,y,z = 6.62 6.62 6.62

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -4965 ${n1e1} -100 100 -100 100 units box
region box block -4965 4965 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -4965 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -4965 4965 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-4965 -100 -100) to (4965 100 100)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 1500 atoms
  using lattice units in orthogonal box = (-4965 -100 -100) to (4965 100 100)
  create_atoms CPU = 0.000 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 1500 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 1001 atoms
  using lattice units in orthogonal box = (-4965 -100 -100) to (4965 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  1500 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  1500 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  1001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  1001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
1500 atoms in group substrate
group slider1 region slider1
1001 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 1001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_62_*.dump id type diameter mass xu yu zu fx fy fz

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 6407 130 130
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 124.6 | 124.6 | 124.6 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   9930           200            200            0              0              0              0              0              0              0              1.1965779e-13  0              6            
    100000   9930           200            200            0.0020296685   4.0674589e-36  0              0.0060890055   577402.26      0              5.5761377e+10  1.1965779e-13  0              3.3325534    
    200000   9930           200            200            0.00068256582  8.1349663e-36  0              0.0020476975   129599.13      0              1.2515756e+10  1.1965779e-13  0              3.0846593    
    300000   9930           200            200           -1.3460505e-05 -2.2370918e-35  0             -4.0381514e-05  113.84574      0              10994406       1.1965779e-13  0              3.0434225    
    400000   9930           200            200           -2.4654998e-05  3.2540895e-35  0             -7.3964994e-05  403.54288      0              38971283       1.1965779e-13  0              3.0049062    
    500000   9930           200            200            0.0033514117   0.0023916712   0              0.007662564    1405.4621      0              1.3572947e+08  1.1965779e-13  0              2.9938603    
    600000   9930           200            200            0.0022056151   0.0015070157   0              0.0051098295   11.148152      0              1076608.8      1.1965779e-13  0              2.9950253    
    700000   9930           200            200            0.0034410047   0.0021399676   0              0.0081830464   15.030905      0              1451577.2      1.1965779e-13  0              2.9937161    
    800000   9930           200            200            0.0031526449   0.0020410637   0              0.0074168709   2.9848019      0              288250.81      1.1965779e-13  0              2.9940094    
    900000   9930           200            200            0.0031952354   0.0020356843   0              0.0075500219   0.45802976     0              44233.236      1.1965779e-13  0              2.9939596    
   1000000   9930           200            200            0.0031984402   0.0020369301   0              0.0075583906   0.056914728    0              5496.4171      1.1965779e-13  0              2.9939549    
   1100000   9930           200            200            0.0031898833   0.0020343714   0              0.0075352786   0.0056566228   0              546.27614      1.1965779e-13  0              2.9939646    
   1200000   9930           200            200            0.0031954488   0.0020360004   0              0.007550346    0.00041409222  0              39.990062      1.1965779e-13  0              2.9939585    
   1300000   9930           200            200            0.0031927208   0.0020352121   0              0.0075429503   1.6465969e-05  0              1.5901654      1.1965779e-13  0              2.9939615    
   1400000   9930           200            200            0.0031938752   0.0020355439   0              0.0075460816   7.780453e-09   0              0.00075138046  1.1965779e-13  0              2.9939602    
   1500000   9930           200            200            0.0031934373   0.0020354188   0              0.0075448929   2.3612441e-07  0              0.022803205    1.1965779e-13  0              2.9939607    
   1600000   9930           200            200            0.0031935873   0.0020354614   0              0.0075453004   1.2334611e-07  0              0.011911885    1.1965779e-13  0              2.9939605    
   1700000   9930           200            200            0.0031935416   0.0020354486   0              0.0075451763   3.2280974e-08  0              0.0031174654   1.1965779e-13  0              2.9939606    
   1800000   9930           200            200            0.0031935533   0.0020354518   0              0.007545208    6.0948328e-09  0              0.00058859532  1.1965779e-13  0              2.9939606    
   1900000   9930           200            200            0.0031935513   0.0020354513   0              0.0075452026   9.1632146e-10  0              8.8491768e-05  1.1965779e-13  0              2.9939606    
   2000000   9930           200            200            0.0031935511   0.0020354512   0              0.0075452021   1.1243247e-10  0              1.0857923e-05  1.1965779e-13  0              2.9939606    
   2100000   9930           200            200            0.0031935515   0.0020354513   0              0.0075452032   1.1020276e-11  0              1.0642594e-06  1.1965779e-13  0              2.9939606    
   2200000   9930           200            200            0.0031935512   0.0020354512   0              0.0075452025   7.8727712e-13  0              7.6029589e-08  1.1965779e-13  0              2.9939606    
   2300000   9930           200            200            0.0031935514   0.0020354513   0              0.0075452028   2.9326492e-14  0              2.8321427e-09  1.1965779e-13  0              2.9939606    
   2400000   9930           200            200            0.0031935513   0.0020354513   0              0.0075452027   7.0791793e-19  0              6.8365647e-14  1.1965779e-13  0              2.9939606    
   2500000   9930           200            200            0.0031935513   0.0020354513   0              0.0075452027   5.4061087e-16  0              5.2208328e-11  1.1965779e-13  0              2.9939606    
   2600000   9930           200            200            0.0031935513   0.0020354513   0              0.0075452027   2.5629806e-16  0              2.4751432e-11  1.1965779e-13  0              2.9939606    
   2700000   9930           200            200            0.0031935513   0.0020354513   0              0.0075452027   4.937856e-17   0              4.7686279e-12  1.1965779e-13  0              2.9939606    
   2800000   9930           200            200            0.0031935513   0.0020354513   0              0.0075452027   7.1560261e-18  0              6.9107778e-13  1.1965779e-13  0              2.9939606    
   2900000   9930           200            200            0.0031935513   0.0020354513   0              0.0075452027   4.4244199e-18  0              4.2727881e-13  1.1965779e-13  0              2.9939606    
   3000000   9930           200            200            0.0031935513   0.0020354513   0              0.0075452027   7.1974596e-18  0              6.9507913e-13  1.1965779e-13  0              2.9939606    
Loop time of 296.586 on 4 procs for 3000000 steps with 2501 atoms

Performance: 8739452.237 ns/day, 0.000 hours/ns, 10115.107 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 11.078     | 35.718     | 61.113     | 409.1 | 12.04
Neigh   | 6.1698     | 6.2856     | 6.406      |   4.3 |  2.12
Comm    | 22.717     | 40.905     | 77.839     | 338.2 | 13.79
Output  | 0.27369    | 0.27399    | 0.27431    |   0.1 |  0.09
Modify  | 108.88     | 156.86     | 177.83     | 224.2 | 52.89
Other   |            | 56.54      |            |       | 19.06

Nlocal:         625.25 ave         876 max         375 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:           1.75 ave           3 max           1 min
Histogram: 2 0 0 0 0 1 0 0 0 1
Neighs:         309.25 ave         619 max           0 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 1237
Ave neighs/atom = 0.49460216
Neighbor list builds = 166
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 63

#variable lat0 equal 1                    #
variable lat1 equal 3+(300*0.01)+(v_ind*0.01)  # .491+(v_ind*0.001)       # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 500*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 6.63                                                               
Lattice spacing in x,y,z = 6.63 6.63 6.63

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -4972.5 ${n1e1} -100 100 -100 100 units box
region box block -4972.5 4972.5 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -4972.5 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -4972.5 4972.5 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-4972.5 -100 -100) to (4972.5 100 100)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 1500 atoms
  using lattice units in orthogonal box = (-4972.5 -100 -100) to (4972.5 100 100)
  create_atoms CPU = 0.000 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 1500 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 1001 atoms
  using lattice units in orthogonal box = (-4972.5 -100 -100) to (4972.5 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  1500 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  1500 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  1001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  1001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
1500 atoms in group substrate
group slider1 region slider1
1001 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 1001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_63_*.dump id type diameter mass xu yu zu fx fy fz

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 6417 130 130
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 124.8 | 124.8 | 124.8 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   9945           200            200            0              0              0              0              0              0              0              1.1965779e-13  0              6            
    100000   9945           200            200            0.0020267384   4.0613267e-36  0              0.0060802151   577448.05      0              5.57658e+10    1.1965779e-13  0              3.3325925    
    200000   9945           200            200            0.00068169256  1.6245594e-35  0              0.0020450777   129640.45      0              1.2519746e+10  1.1965779e-13  0              3.0847455    
    300000   9945           200            200           -1.2836531e-05  1.2996273e-34  0             -3.8509592e-05  103.6672       0              10011436       1.1965779e-13  0              3.0435509    
    400000   9945           200            200           -2.0549236e-05  3.4521098e-35  0             -6.1647709e-05  278.30454      0              26876661       1.1965779e-13  0              3.0051235    
    500000   9945           200            200            0.0019559272   0.0014685407   0              0.0043992409   1125.1753      0              1.0866137e+08  1.1965779e-13  0              2.9953621    
    600000   9945           200            200            0.0026702617   0.0017643204   0              0.0062464646   143.72878      0              13880297       1.1965779e-13  0              2.9945639    
    700000   9945           200            200            0.0031608652   0.0021774283   0              0.0073051673   24.370034      0              2353483.4      1.1965779e-13  0              2.994099     
    800000   9945           200            200            0.003357533    0.0021888913   0              0.0078837078   0.34113304     0              32944.187      1.1965779e-13  0              2.9938829    
    900000   9945           200            200            0.003206077    0.0021782268   0              0.0074400042   0.2291186      0              22126.635      1.1965779e-13  0              2.994054     
   1000000   9945           200            200            0.0032335876   0.0021826715   0              0.0075180914   0.05629497     0              5436.5653      1.1965779e-13  0              2.9940224    
   1100000   9945           200            200            0.0032454479   0.0021844911   0              0.0075518526   0.00017540232  0              16.939101      1.1965779e-13  0              2.9940097    
   1200000   9945           200            200            0.0032378392   0.0021832875   0              0.00753023     0.00076597031  0              73.97193       1.1965779e-13  0              2.9940181    
   1300000   9945           200            200            0.0032387375   0.0021834368   0              0.0075327756   0.00011811137  0              11.40635       1.1965779e-13  0              2.994017     
   1400000   9945           200            200            0.0032394689   0.00218355     0              0.0075348567   2.8229792e-08  0              0.0027262312   1.1965779e-13  0              2.9940162    
   1500000   9945           200            200            0.0032391077   0.0021834927   0              0.0075338304   2.3146046e-06  0              0.22352795     1.1965779e-13  0              2.9940167    
   1600000   9945           200            200            0.0032391275   0.0021834962   0              0.0075338864   2.2709061e-07  0              0.021930786    1.1965779e-13  0              2.9940166    
   1700000   9945           200            200            0.0032391698   0.0021835028   0              0.0075340065   2.3900307e-09  0              0.00023081206  1.1965779e-13  0              2.9940166    
   1800000   9945           200            200            0.0032391532   0.0021835001   0              0.0075339595   6.4534001e-09  0              0.00062322319  1.1965779e-13  0              2.9940166    
   1900000   9945           200            200            0.003239153    0.0021835001   0              0.0075339588   3.9060882e-10  0              3.7722204e-05  1.1965779e-13  0              2.9940166    
   2000000   9945           200            200            0.0032391553   0.0021835005   0              0.0075339653   1.8947407e-11  0              1.829805e-06   1.1965779e-13  0              2.9940166    
   2100000   9945           200            200            0.0032391546   0.0021835004   0              0.0075339633   1.6761258e-11  0              1.6186824e-06  1.1965779e-13  0              2.9940166    
   2200000   9945           200            200            0.0032391545   0.0021835004   0              0.0075339631   5.7098458e-13  0              5.5141604e-08  1.1965779e-13  0              2.9940166    
   2300000   9945           200            200            0.0032391546   0.0021835004   0              0.0075339634   9.2897685e-14  0              8.9713934e-09  1.1965779e-13  0              2.9940166    
   2400000   9945           200            200            0.0032391546   0.0021835004   0              0.0075339633   4.0712526e-14  0              3.9317244e-09  1.1965779e-13  0              2.9940166    
   2500000   9945           200            200            0.0032391546   0.0021835004   0              0.0075339633   6.2271742e-16  0              6.0137591e-11  1.1965779e-13  0              2.9940166    
   2600000   9945           200            200            0.0032391546   0.0021835004   0              0.0075339633   3.354524e-16   0              3.2395592e-11  1.1965779e-13  0              2.9940166    
   2700000   9945           200            200            0.0032391546   0.0021835004   0              0.0075339633   8.5175619e-17  0              8.2256516e-12  1.1965779e-13  0              2.9940166    
   2800000   9945           200            200            0.0032391546   0.0021835004   0              0.0075339633   1.0914105e-19  0              1.0540061e-14  1.1965779e-13  0              2.9940166    
   2900000   9945           200            200            0.0032391546   0.0021835004   0              0.0075339633   1.0605012e-18  0              1.0241561e-13  1.1965779e-13  0              2.9940166    
   3000000   9945           200            200            0.0032391546   0.0021835004   0              0.0075339633   4.2462576e-18  0              4.1007316e-13  1.1965779e-13  0              2.9940166    
Loop time of 300.42 on 4 procs for 3000000 steps with 2501 atoms

Performance: 8627933.696 ns/day, 0.000 hours/ns, 9986.034 timesteps/s
99.9% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 10.996     | 36.042     | 61.558     | 413.1 | 12.00
Neigh   | 6.1441     | 6.2642     | 6.3881     |   4.5 |  2.09
Comm    | 23.149     | 41.032     | 78.07      | 338.1 | 13.66
Output  | 0.35378    | 0.35409    | 0.35443    |   0.1 |  0.12
Modify  | 110.65     | 159.01     | 181.41     | 224.8 | 52.93
Other   |            | 57.72      |            |       | 19.21

Nlocal:         625.25 ave         876 max         375 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:           1.75 ave           3 max           1 min
Histogram: 2 0 0 0 0 1 0 0 0 1
Neighs:         310.25 ave         621 max           0 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 1241
Ave neighs/atom = 0.49620152
Neighbor list builds = 166
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 64

#variable lat0 equal 1                    #
variable lat1 equal 3+(300*0.01)+(v_ind*0.01)  # .491+(v_ind*0.001)       # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 500*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 6.64                                                               
Lattice spacing in x,y,z = 6.64 6.64 6.64

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -4980 ${n1e1} -100 100 -100 100 units box
region box block -4980 4980 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -4980 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -4980 4980 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-4980 -100 -100) to (4980 100 100)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 1500 atoms
  using lattice units in orthogonal box = (-4980 -100 -100) to (4980 100 100)
  create_atoms CPU = 0.000 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 1500 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 1001 atoms
  using lattice units in orthogonal box = (-4980 -100 -100) to (4980 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  1500 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  1500 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  1001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  1001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
1500 atoms in group substrate
group slider1 region slider1
1001 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 1001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_64_*.dump id type diameter mass xu yu zu fx fy fz

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 6426 130 130
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 124.9 | 124.9 | 124.9 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   9960           200            200            0              0              0              0              0              0              0              1.1965779e-13  0              6            
    100000   9960           200            200            0.0020238946  -2.0275926e-36  0              0.0060716839   577539.99      0              5.5774678e+10  1.1965779e-13  0              3.3324998    
    200000   9960           200            200            0.00068120937 -4.866185e-35   0              0.0020436281   129804.85      0              1.2535623e+10  1.1965779e-13  0              3.0845751    
    300000   9960           200            200           -1.2340245e-05 -4.8662097e-35  0             -3.7020734e-05  95.965626      0              9267673.3      1.1965779e-13  0              3.043572     
    400000   9960           200            200           -2.1366159e-05  3.2441623e-35  0             -6.4098478e-05  302.4255       0              29206090       1.1965779e-13  0              3.0051113    
    500000   9960           200            200            0.0022578303   0.001173663    0              0.005599828    1311.869       0              1.2669092e+08  1.1965779e-13  0              2.9948141    
    600000   9960           200            200            0.0021120448   0.0011815437   0              0.0051545907   22.200043      0              2143921.2      1.1965779e-13  0              2.9950876    
    700000   9960           200            200            0.0029687503   0.00042000691  0              0.0084862441   1.3692235      0              132229.81      1.1965779e-13  0              2.9936785    
    800000   9960           200            200            0.0025952317   0.00053928808  0              0.007246407    1.3782192      0              133098.55      1.1965779e-13  0              2.9941644    
    900000   9960           200            200            0.0027009767   0.00052412225  0              0.0075788079   0.37911839     0              36612.541      1.1965779e-13  0              2.9940329    
   1000000   9960           200            200            0.0026829831   0.00052642294  0              0.0075225263   0.062016348    0              5989.095       1.1965779e-13  0              2.9940542    
   1100000   9960           200            200            0.0026806725   0.00052680183  0              0.0075152156   0.0068020867   0              656.89685      1.1965779e-13  0              2.9940576    
   1200000   9960           200            200            0.0026846483   0.00052623341  0              0.0075277115   0.00045023608  0              43.480578      1.1965779e-13  0              2.9940525    
   1300000   9960           200            200            0.0026823201   0.00052655931  0              0.0075204011   8.8250769e-06  0              0.85226276     1.1965779e-13  0              2.9940554    
   1400000   9960           200            200            0.0026833309   0.00052641915  0              0.0075235737   7.8924467e-07  0              0.076219601    1.1965779e-13  0              2.9940542    
   1500000   9960           200            200            0.0026829733   0.00052646825  0              0.0075224516   9.8252084e-07  0              0.09488483     1.1965779e-13  0              2.9940546    
   1600000   9960           200            200            0.0026830746   0.00052645452  0              0.0075227692   2.9038744e-07  0              0.02804354     1.1965779e-13  0              2.9940545    
   1700000   9960           200            200            0.0026830555   0.00052645702  0              0.0075227095   5.0346243e-08  0              0.0048620797   1.1965779e-13  0              2.9940545    
   1800000   9960           200            200            0.0026830545   0.00052645721  0              0.0075227063   5.8381926e-09  0              0.00056381085  1.1965779e-13  0              2.9940545    
   1900000   9960           200            200            0.0026830577   0.00052645674  0              0.0075227165   4.2043864e-10  0              4.0602955e-05  1.1965779e-13  0              2.9940545    
   2000000   9960           200            200            0.0026830557   0.00052645703  0              0.0075227102   1.1004364e-11  0              1.0627227e-06  1.1965779e-13  0              2.9940545    
   2100000   9960           200            200            0.0026830566   0.0005264569   0              0.007522713    3.1537801e-13  0              3.0456951e-08  1.1965779e-13  0              2.9940545    
   2200000   9960           200            200            0.0026830563   0.00052645695  0              0.007522712    6.7351009e-13  0              6.5042783e-08  1.1965779e-13  0              2.9940545    
   2300000   9960           200            200            0.0026830564   0.00052645693  0              0.0075227123   2.2057421e-13  0              2.1301478e-08  1.1965779e-13  0              2.9940545    
   2400000   9960           200            200            0.0026830564   0.00052645694  0              0.0075227122   4.0587523e-14  0              3.9196524e-09  1.1965779e-13  0              2.9940545    
   2500000   9960           200            200            0.0026830564   0.00052645694  0              0.0075227122   4.9837382e-15  0              4.8129376e-10  1.1965779e-13  0              2.9940545    
   2600000   9960           200            200            0.0026830564   0.00052645694  0              0.0075227122   3.7397085e-16  0              3.6115428e-11  1.1965779e-13  0              2.9940545    
   2700000   9960           200            200            0.0026830564   0.00052645694  0              0.0075227122   2.1774507e-17  0              2.102826e-12   1.1965779e-13  0              2.9940545    
   2800000   9960           200            200            0.0026830564   0.00052645694  0              0.0075227122   3.430612e-19   0              3.3130395e-14  1.1965779e-13  0              2.9940545    
   2900000   9960           200            200            0.0026830564   0.00052645694  0              0.0075227122   9.0233131e-19  0              8.7140699e-14  1.1965779e-13  0              2.9940545    
   3000000   9960           200            200            0.0026830564   0.00052645694  0              0.0075227122   7.3743514e-21  0              7.1216207e-16  1.1965779e-13  0              2.9940545    
Loop time of 297.508 on 4 procs for 3000000 steps with 2501 atoms

Performance: 8712364.616 ns/day, 0.000 hours/ns, 10083.755 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 11.125     | 35.912     | 61.698     | 410.5 | 12.07
Neigh   | 6.1974     | 6.3086     | 6.4228     |   4.1 |  2.12
Comm    | 22.828     | 41.326     | 78.638     | 340.0 | 13.89
Output  | 0.27434    | 0.27465    | 0.27496    |   0.1 |  0.09
Modify  | 108.81     | 157.09     | 177.77     | 225.2 | 52.80
Other   |            | 56.6       |            |       | 19.02

Nlocal:         625.25 ave         876 max         375 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:           1.75 ave           3 max           1 min
Histogram: 2 0 0 0 0 1 0 0 0 1
Neighs:         309.25 ave         619 max           0 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 1237
Ave neighs/atom = 0.49460216
Neighbor list builds = 166
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 65

#variable lat0 equal 1                    #
variable lat1 equal 3+(300*0.01)+(v_ind*0.01)  # .491+(v_ind*0.001)       # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 500*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 6.65                                                               
Lattice spacing in x,y,z = 6.65 6.65 6.65

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -4987.5 ${n1e1} -100 100 -100 100 units box
region box block -4987.5 4987.5 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -4987.5 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -4987.5 4987.5 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-4987.5 -100 -100) to (4987.5 100 100)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 1500 atoms
  using lattice units in orthogonal box = (-4987.5 -100 -100) to (4987.5 100 100)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 1500 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 1001 atoms
  using lattice units in orthogonal box = (-4987.5 -100 -100) to (4987.5 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  1500 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  1500 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  1001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  1001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
1500 atoms in group substrate
group slider1 region slider1
1001 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 1001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_65_*.dump id type diameter mass xu yu zu fx fy fz

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 6436 130 130
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 125.1 | 125.1 | 125.1 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   9975           200            200            0              0              0              0              0              0              0              1.1965779e-13  0              6            
    100000   9975           200            200            0.0020203795  -4.0490851e-36  0              0.0060611384   577353.33      0              5.5756652e+10  1.1965779e-13  0              3.3325339    
    200000   9975           200            200            0.00067925408 -8.098148e-36   0              0.0020377622   129533.25      0              1.2509394e+10  1.1965779e-13  0              3.0846278    
    300000   9975           200            200           -1.437113e-05   8.0982241e-35  0             -4.3113391e-05  131.30274      0              12680278       1.1965779e-13  0              3.0433157    
    400000   9975           200            200           -2.8500162e-05 -7.2883566e-35  0             -8.5500486e-05  549.55559      0              53072145       1.1965779e-13  0              3.0047026    
    500000   9975           200            200            0.0040731447   0.0017072953   0              0.010512139    1167.8864      0              1.127861e+08   1.1965779e-13  0              2.9927416    
    600000   9975           200            200            0.0029333303   0.0016031798   0              0.0071968111   183.60857      0              17731602       1.1965779e-13  0              2.994036     
    700000   9975           200            200            0.0028609361   0.0016934108   0              0.0068893976   14.06086       0              1357897.2      1.1965779e-13  0              2.994183     
    800000   9975           200            200            0.0029590866   0.0017052838   0              0.0071719761   0.11779159     0              11375.468      1.1965779e-13  0              2.9940674    
    900000   9975           200            200            0.0030363577   0.0017089816   0              0.0074000916   0.10342966     0              9988.4965      1.1965779e-13  0              2.9939719    
   1000000   9975           200            200            0.0030682311   0.0017105385   0              0.0074941549   0.052604172    0              5080.1344      1.1965779e-13  0              2.9939323    
   1100000   9975           200            200            0.0030758095   0.0017109167   0              0.0075165116   0.0074562846   0              720.0746       1.1965779e-13  0              2.9939227    
   1200000   9975           200            200            0.0030757842   0.0017109197   0              0.007516433    0.00032006591  0              30.909674      1.1965779e-13  0              2.9939227    
   1300000   9975           200            200            0.0030747474   0.0017108704   0              0.0075133718   2.3436861e-06  0              0.22633642     1.1965779e-13  0              2.9939239    
   1400000   9975           200            200            0.0030741644   0.001710842    0              0.0075116512   1.0758426e-05  0              1.0389718      1.1965779e-13  0              2.9939246    
   1500000   9975           200            200            0.0030739745   0.0017108327   0              0.0075110909   2.7192153e-06  0              0.26260235     1.1965779e-13  0              2.9939249    
   1600000   9975           200            200            0.0030739458   0.0017108312   0              0.0075110061   2.4038418e-07  0              0.023214584    1.1965779e-13  0              2.9939249    
   1700000   9975           200            200            0.0030739551   0.0017108316   0              0.0075110337   3.0090695e-09  0              0.0002905944   1.1965779e-13  0              2.9939249    
   1800000   9975           200            200            0.0030739643   0.0017108321   0              0.0075110608   1.2338784e-09  0              0.00011915915  1.1965779e-13  0              2.9939249    
   1900000   9975           200            200            0.0030739682   0.0017108323   0              0.0075110724   7.438957e-10   0              7.1840123e-05  1.1965779e-13  0              2.9939249    
   2000000   9975           200            200            0.0030739692   0.0017108323   0              0.0075110753   1.1427629e-10  0              1.1035986e-05  1.1965779e-13  0              2.9939249    
   2100000   9975           200            200            0.0030739692   0.0017108323   0              0.0075110753   5.6052507e-12  0              5.4131499e-07  1.1965779e-13  0              2.9939249    
   2200000   9975           200            200            0.0030739691   0.0017108323   0              0.007511075    1.0770175e-14  0              1.0401064e-09  1.1965779e-13  0              2.9939249    
   2300000   9975           200            200            0.003073969    0.0017108323   0              0.0075110748   1.4288285e-13  0              1.3798603e-08  1.1965779e-13  0              2.9939249    
   2400000   9975           200            200            0.003073969    0.0017108323   0              0.0075110747   3.9906805e-14  0              3.8539136e-09  1.1965779e-13  0              2.9939249    
   2500000   9975           200            200            0.003073969    0.0017108323   0              0.0075110747   3.8722435e-15  0              3.7395356e-10  1.1965779e-13  0              2.9939249    
   2600000   9975           200            200            0.003073969    0.0017108323   0              0.0075110747   7.2248802e-17  0              6.9772722e-12  1.1965779e-13  0              2.9939249    
   2700000   9975           200            200            0.003073969    0.0017108323   0              0.0075110747   2.8224507e-17  0              2.7257208e-12  1.1965779e-13  0              2.9939249    
   2800000   9975           200            200            0.003073969    0.0017108323   0              0.0075110747   1.2945677e-17  0              1.2502008e-12  1.1965779e-13  0              2.9939249    
   2900000   9975           200            200            0.003073969    0.0017108323   0              0.0075110747   4.2118152e-18  0              4.0674697e-13  1.1965779e-13  0              2.9939249    
   3000000   9975           200            200            0.003073969    0.0017108323   0              0.0075110747   3.3128814e-18  0              3.1993437e-13  1.1965779e-13  0              2.9939249    
Loop time of 297.642 on 4 procs for 3000000 steps with 2501 atoms

Performance: 8708444.241 ns/day, 0.000 hours/ns, 10079.218 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 11.35      | 35.703     | 60.987     | 406.8 | 12.00
Neigh   | 6.1983     | 6.3197     | 6.4429     |   4.4 |  2.12
Comm    | 22.809     | 41.153     | 78.085     | 337.4 | 13.83
Output  | 0.2693     | 0.26963    | 0.26996    |   0.1 |  0.09
Modify  | 108.99     | 157.09     | 178.85     | 224.9 | 52.78
Other   |            | 57.1       |            |       | 19.19

Nlocal:         625.25 ave         876 max         375 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:           1.75 ave           3 max           1 min
Histogram: 2 0 0 0 0 1 0 0 0 1
Neighs:         308.25 ave         617 max           0 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 1233
Ave neighs/atom = 0.4930028
Neighbor list builds = 166
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 66

#variable lat0 equal 1                    #
variable lat1 equal 3+(300*0.01)+(v_ind*0.01)  # .491+(v_ind*0.001)       # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 500*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 6.66                                                               
Lattice spacing in x,y,z = 6.66 6.66 6.66

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -4995 ${n1e1} -100 100 -100 100 units box
region box block -4995 4995 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -4995 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -4995 4995 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-4995 -100 -100) to (4995 100 100)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 1500 atoms
  using lattice units in orthogonal box = (-4995 -100 -100) to (4995 100 100)
  create_atoms CPU = 0.000 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 1500 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 1001 atoms
  using lattice units in orthogonal box = (-4995 -100 -100) to (4995 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  1500 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  1500 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  1001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  1001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
1500 atoms in group substrate
group slider1 region slider1
1001 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 1001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_66_*.dump id type diameter mass xu yu zu fx fy fz

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 6446 130 130
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 125.2 | 125.3 | 125.3 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   9990           200            200            0              0              0              0              0              0              0              1.1965779e-13  0              6            
    100000   9990           200            200            0.0020174848  -2.0215012e-36  0              0.0060524544   577405.68      0              5.5761707e+10  1.1965779e-13  0              3.332546     
    200000   9990           200            200            0.00067849063  3.2344237e-35  0              0.0020354719   129606.63      0              1.2516481e+10  1.1965779e-13  0              3.0846486    
    300000   9990           200            200           -1.3296321e-05  6.4689006e-35  0             -3.9888962e-05  112.40616      0              10855382       1.1965779e-13  0              3.0434231    
    400000   9990           200            200           -2.4163332e-05  9.7032815e-35  0             -7.2489997e-05  391.96925      0              37853584       1.1965779e-13  0              3.0049171    
    500000   9990           200            200            0.00099729744 -0.0045019578   0              0.0074938501   1408.9035      0              1.3606181e+08  1.1965779e-13  0              2.9938905    
    600000   9990           200            200            0.0006080268  -0.00323063     0              0.0050547104   1.7014988      0              164318.58      1.1965779e-13  0              2.9950419    
    700000   9990           200            200            0.0017350666  -0.0032821039   0              0.0084873038   1.1127816      0              107464.49      1.1965779e-13  0              2.9935645    
    800000   9990           200            200            0.0012559253  -0.0035491114   0              0.0073168872   2.5125919      0              242648.15      1.1965779e-13  0              2.9940155    
    900000   9990           200            200            0.0013162101  -0.0035029009   0              0.0074515313   0.4023815      0              38859.125      1.1965779e-13  0              2.9939588    
   1000000   9990           200            200            0.0013470577  -0.0035052952   0              0.0075464682   0.0056355043   0              544.23667      1.1965779e-13  0              2.9939226    
   1100000   9990           200            200            0.0013271736  -0.0035036549   0              0.0074851757   0.0026732295   0              258.16137      1.1965779e-13  0              2.9939466    
   1200000   9990           200            200            0.0013320503  -0.0035040473   0              0.0075001983   0.0011266591   0              108.80467      1.1965779e-13  0              2.9939406    
   1300000   9990           200            200            0.0013325232  -0.003504081    0              0.0075016507   6.7860508e-05  0              6.5534821      1.1965779e-13  0              2.9939401    
   1400000   9990           200            200            0.0013316512  -0.0035040119   0              0.0074989655   6.3116101e-07  0              0.060953013    1.1965779e-13  0              2.9939411    
   1500000   9990           200            200            0.0013319827  -0.0035040387   0              0.0074999868   2.1652421e-06  0              0.20910358     1.1965779e-13  0              2.9939407    
   1600000   9990           200            200            0.0013319501  -0.0035040359   0              0.0074998861   3.1340939e-07  0              0.030266835    1.1965779e-13  0              2.9939408    
   1700000   9990           200            200            0.0013319201  -0.0035040335   0              0.007499794    3.0522345e-09  0              0.00029476296  1.1965779e-13  0              2.9939408    
   1800000   9990           200            200            0.0013319381  -0.003504035    0              0.0074998493   2.54879e-09    0              0.0002461439   1.1965779e-13  0              2.9939408    
   1900000   9990           200            200            0.001331934   -0.0035040346   0              0.0074998367   9.204362e-10   0              8.888914e-05   1.1965779e-13  0              2.9939408    
   2000000   9990           200            200            0.0013319334  -0.0035040346   0              0.0074998349   4.8175825e-11  0              4.6524764e-06  1.1965779e-13  0              2.9939408    
   2100000   9990           200            200            0.0013319343  -0.0035040346   0              0.0074998374   8.9594699e-13  0              8.6524148e-08  1.1965779e-13  0              2.9939408    
   2200000   9990           200            200            0.001331934   -0.0035040346   0              0.0074998365   1.864911e-12   0              1.8009976e-07  1.1965779e-13  0              2.9939408    
   2300000   9990           200            200            0.001331934   -0.0035040346   0              0.0074998366   2.4139687e-13  0              2.3312382e-08  1.1965779e-13  0              2.9939408    
   2400000   9990           200            200            0.001331934   -0.0035040346   0              0.0074998367   1.4489017e-15  0              1.3992456e-10  1.1965779e-13  0              2.9939408    
   2500000   9990           200            200            0.001331934   -0.0035040346   0              0.0074998366   2.4006616e-15  0              2.3183871e-10  1.1965779e-13  0              2.9939408    
   2600000   9990           200            200            0.001331934   -0.0035040346   0              0.0074998366   7.4552739e-16  0              7.1997699e-11  1.1965779e-13  0              2.9939408    
   2700000   9990           200            200            0.001331934   -0.0035040346   0              0.0074998366   2.0372714e-17  0              1.9674509e-12  1.1965779e-13  0              2.9939408    
   2800000   9990           200            200            0.001331934   -0.0035040346   0              0.0074998366   2.8256126e-18  0              2.7287744e-13  1.1965779e-13  0              2.9939408    
   2900000   9990           200            200            0.001331934   -0.0035040346   0              0.0074998366   2.2630726e-18  0              2.1855135e-13  1.1965779e-13  0              2.9939408    
   3000000   9990           200            200            0.001331934   -0.0035040346   0              0.0074998366   5.0660493e-18  0              4.8924278e-13  1.1965779e-13  0              2.9939408    
Loop time of 296.979 on 4 procs for 3000000 steps with 2501 atoms

Performance: 8727890.791 ns/day, 0.000 hours/ns, 10101.725 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 11.437     | 36.129     | 61.679     | 410.2 | 12.17
Neigh   | 6.1653     | 6.279      | 6.3962     |   4.2 |  2.11
Comm    | 22.508     | 41.14      | 78.621     | 342.5 | 13.85
Output  | 0.27097    | 0.27127    | 0.27159    |   0.1 |  0.09
Modify  | 109.05     | 156.88     | 177.25     | 222.9 | 52.82
Other   |            | 56.28      |            |       | 18.95

Nlocal:         625.25 ave         876 max         375 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:           1.75 ave           3 max           1 min
Histogram: 2 0 0 0 0 1 0 0 0 1
Neighs:         310.75 ave         622 max           0 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 1243
Ave neighs/atom = 0.4970012
Neighbor list builds = 166
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 67

#variable lat0 equal 1                    #
variable lat1 equal 3+(300*0.01)+(v_ind*0.01)  # .491+(v_ind*0.001)       # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 500*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 6.67                                                               
Lattice spacing in x,y,z = 6.67 6.67 6.67

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -5002.5 ${n1e1} -100 100 -100 100 units box
region box block -5002.5 5002.5 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -5002.5 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -5002.5 5002.5 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-5002.5 -100 -100) to (5002.5 100 100)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 1500 atoms
  using lattice units in orthogonal box = (-5002.5 -100 -100) to (5002.5 100 100)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 1500 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 1001 atoms
  using lattice units in orthogonal box = (-5002.5 -100 -100) to (5002.5 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  1500 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  1500 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  1001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  1001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
1500 atoms in group substrate
group slider1 region slider1
1001 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 1001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_67_*.dump id type diameter mass xu yu zu fx fy fz

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 6455 130 130
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 125.4 | 125.4 | 125.4 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   10005          200            200            0              0              0              0              0              0              0              1.1965779e-13  0              6            
    100000   10005          200            200            0.0020146916   6.4591245e-35  0              0.0060440749   577502.09      0              5.5771018e+10  1.1965779e-13  0              3.3324924    
    200000   10005          200            200            0.00067782867  1.2210762e-39  0              0.002033486    129711.63      0              1.2526621e+10  1.1965779e-13  0              3.0846045    
    300000   10005          200            200           -1.468069e-05   7.7198763e-40  0             -4.4042071e-05  137.95882      0              13323075       1.1965779e-13  0              3.0434914    
    400000   10005          200            200           -3.0001855e-05 -3.2294806e-35  0             -9.0005566e-05  615.0218       0              59394403       1.1965779e-13  0              3.0048247    
    500000   10005          200            200            0.0031255273   0.00075217552  0              0.0086244065   1371.5147      0              1.3245107e+08  1.1965779e-13  0              2.9936303    
    600000   10005          200            200            0.0021095414   0.001139259    0              0.0051893652   31.198559      0              3012933.5      1.1965779e-13  0              2.9951267    
    700000   10005          200            200            0.0029036055   0.00092578936  0              0.0077850271   23.149875      0              2235649.2      1.1965779e-13  0              2.9940126    
    800000   10005          200            200            0.0028640205   0.00094011711  0              0.0076519443   2.6655246      0              257417.28      1.1965779e-13  0              2.9940563    
    900000   10005          200            200            0.002763838    0.00092806423  0              0.0073634497   0.026703843    0              2578.866       1.1965779e-13  0              2.9941761    
   1000000   10005          200            200            0.0028187431   0.00092713952  0              0.0075290897   0.019076179    0              1842.2408      1.1965779e-13  0              2.9941086    
   1100000   10005          200            200            0.0028045385   0.00092740589  0              0.0074862097   0.008174743    0              789.45816      1.1965779e-13  0              2.9941256    
   1200000   10005          200            200            0.0028041578   0.00092741572  0              0.0074850578   0.00068471773  0              66.125138      1.1965779e-13  0              2.9941263    
   1300000   10005          200            200            0.0028062634   0.00092737615  0              0.007491414    5.8339721e-07  0              0.056340327    1.1965779e-13  0              2.9941237    
   1400000   10005          200            200            0.002805272    0.00092739447  0              0.0074884214   9.9384086e-06  0              0.95978036     1.1965779e-13  0              2.9941249    
   1500000   10005          200            200            0.002805479    0.00092739076  0              0.0074890462   2.7715598e-06  0              0.26765741     1.1965779e-13  0              2.9941246    
   1600000   10005          200            200            0.0028055102   0.00092739013  0              0.0074891405   1.5948504e-07  0              0.015401924    1.1965779e-13  0              2.9941246    
   1700000   10005          200            200            0.0028054668   0.00092739094  0              0.0074890095   7.1784638e-10  0              6.9324465e-05  1.1965779e-13  0              2.9941246    
   1800000   10005          200            200            0.0028054841   0.00092739063  0              0.0074890617   4.5100546e-09  0              0.0004355488   1.1965779e-13  0              2.9941246    
   1900000   10005          200            200            0.0028054814   0.00092739067  0              0.0074890535   8.7934427e-10  0              8.4920776e-05  1.1965779e-13  0              2.9941246    
   2000000   10005          200            200            0.0028054804   0.00092739069  0              0.0074890505   3.1687317e-11  0              3.0601343e-06  1.1965779e-13  0              2.9941246    
   2100000   10005          200            200            0.0028054812   0.00092739068  0              0.0074890531   1.4698302e-12  0              1.4194568e-07  1.1965779e-13  0              2.9941246    
   2200000   10005          200            200            0.002805481    0.00092739068  0              0.0074890522   1.8500844e-12  0              1.7866791e-07  1.1965779e-13  0              2.9941246    
   2300000   10005          200            200            0.002805481    0.00092739068  0              0.0074890523   2.6047129e-13  0              2.5154453e-08  1.1965779e-13  0              2.9941246    
   2400000   10005          200            200            0.002805481    0.00092739068  0              0.0074890524   4.8177568e-15  0              4.6526447e-10  1.1965779e-13  0              2.9941246    
   2500000   10005          200            200            0.002805481    0.00092739068  0              0.0074890523   1.2217035e-15  0              1.1798338e-10  1.1965779e-13  0              2.9941246    
   2600000   10005          200            200            0.002805481    0.00092739068  0              0.0074890523   6.9824594e-16  0              6.7431595e-11  1.1965779e-13  0              2.9941246    
   2700000   10005          200            200            0.002805481    0.00092739068  0              0.0074890523   8.2338022e-17  0              7.9516168e-12  1.1965779e-13  0              2.9941246    
   2800000   10005          200            200            0.002805481    0.00092739068  0              0.0074890523   2.0193245e-18  0              1.950119e-13   1.1965779e-13  0              2.9941246    
   2900000   10005          200            200            0.002805481    0.00092739068  0              0.0074890523   5.1972738e-20  0              5.019155e-15   1.1965779e-13  0              2.9941246    
   3000000   10005          200            200            0.002805481    0.00092739068  0              0.0074890523   1.0884685e-18  0              1.051165e-13   1.1965779e-13  0              2.9941246    
Loop time of 297.131 on 4 procs for 3000000 steps with 2501 atoms

Performance: 8723413.439 ns/day, 0.000 hours/ns, 10096.543 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 11.195     | 35.84      | 61.314     | 409.0 | 12.06
Neigh   | 6.2692     | 6.3892     | 6.513      |   4.4 |  2.15
Comm    | 22.827     | 41.249     | 78.356     | 338.6 | 13.88
Output  | 0.27302    | 0.27335    | 0.27367    |   0.1 |  0.09
Modify  | 109.19     | 157.09     | 177.54     | 223.3 | 52.87
Other   |            | 56.29      |            |       | 18.95

Nlocal:         625.25 ave         876 max         375 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:           1.75 ave           3 max           1 min
Histogram: 2 0 0 0 0 1 0 0 0 1
Neighs:         309.75 ave         620 max           0 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 1239
Ave neighs/atom = 0.49540184
Neighbor list builds = 166
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 68

#variable lat0 equal 1                    #
variable lat1 equal 3+(300*0.01)+(v_ind*0.01)  # .491+(v_ind*0.001)       # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 500*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 6.68                                                               
Lattice spacing in x,y,z = 6.68 6.68 6.68

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -5010 ${n1e1} -100 100 -100 100 units box
region box block -5010 5010 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -5010 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -5010 5010 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-5010 -100 -100) to (5010 100 100)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 1500 atoms
  using lattice units in orthogonal box = (-5010 -100 -100) to (5010 100 100)
  create_atoms CPU = 0.000 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 1500 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 1001 atoms
  using lattice units in orthogonal box = (-5010 -100 -100) to (5010 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  1500 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  1500 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  1001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  1001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
1500 atoms in group substrate
group slider1 region slider1
1001 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 1001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_68_*.dump id type diameter mass xu yu zu fx fy fz

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 6465 130 130
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 125.6 | 125.6 | 125.6 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   10020          200            200            0              0              0              0              0              0              0              1.1965779e-13  0              6            
    100000   10020          200            200            0.002011098   -1.0077257e-36  0              0.006033294    577263.86      0              5.5748011e+10  1.1965779e-13  0              3.3326049    
    200000   10020          200            200            0.00067575697  6.4494663e-35  0              0.0020272709   129398.95      0              1.2496424e+10  1.1965779e-13  0              3.0847333    
    300000   10020          200            200           -1.4371282e-05 -3.2246746e-35  0             -4.3113846e-05  132.52005      0              12797838       1.1965779e-13  0              3.0432691    
    400000   10020          200            200           -2.7610253e-05  1.6123699e-35  0             -8.2830759e-05  519.46056      0              50165782       1.1965779e-13  0              3.0046838    
    500000   10020          200            200            0.0023756967  -0.0026294222   0              0.0097565123   1262.6546      0              1.2193815e+08  1.1965779e-13  0              2.9929478    
    600000   10020          200            200            0.0011890057  -0.0023217886   0              0.0058888056   114.92719      0              11098845       1.1965779e-13  0              2.9945418    
    700000   10020          200            200            0.0015609074  -0.0020117624   0              0.0066944846   7.300181       0              704999.23      1.1965779e-13  0              2.9942076    
    800000   10020          200            200            0.0019143564  -0.0019266779   0              0.007669747    2.3754239      0              229401.44      1.1965779e-13  0              2.9937964    
    900000   10020          200            200            0.0018860695  -0.0019245787   0              0.0075827873   0.14263744     0              13774.903      1.1965779e-13  0              2.9938291    
   1000000   10020          200            200            0.0018428618  -0.0019211979   0              0.0074497834   0.04098654     0              3958.1866      1.1965779e-13  0              2.9938841    
   1100000   10020          200            200            0.0018472815  -0.0019215084   0              0.0074633529   0.0028713158   0              277.29113      1.1965779e-13  0              2.9938789    
   1200000   10020          200            200            0.0018530497  -0.0019219514   0              0.0074811006   0.00070777196  0              68.35155       1.1965779e-13  0              2.9938715    
   1300000   10020          200            200            0.0018523758  -0.0019219031   0              0.0074790305   5.7674059e-05  0              5.5697478      1.1965779e-13  0              2.9938723    
   1400000   10020          200            200            0.0018516066  -0.0019218439   0              0.0074766637   1.2153038e-05  0              1.1736534      1.1965779e-13  0              2.9938733    
   1500000   10020          200            200            0.001851708   -0.0019218512   0              0.0074769752   1.1495074e-06  0              0.1110112      1.1965779e-13  0              2.9938732    
   1600000   10020          200            200            0.0018518104  -0.0019218591   0              0.0074772904   2.0775945e-07  0              0.020063921    1.1965779e-13  0              2.9938731    
   1700000   10020          200            200            0.0018517954  -0.001921858    0              0.007477244    2.2763191e-08  0              0.0021983061   1.1965779e-13  0              2.9938731    
   1800000   10020          200            200            0.0018517817  -0.0019218569   0              0.0074772021   3.5343248e-09  0              0.00034131979  1.1965779e-13  0              2.9938731    
   1900000   10020          200            200            0.001851784   -0.0019218571   0              0.007477209    4.480501e-10   0              4.3269472e-05  1.1965779e-13  0              2.9938731    
   2000000   10020          200            200            0.0018517858  -0.0019218572   0              0.0074772145   5.9806616e-11  0              5.7756949e-06  1.1965779e-13  0              2.9938731    
   2100000   10020          200            200            0.0018517854  -0.0019218572   0              0.0074772135   8.7698382e-12  0              8.469282e-07   1.1965779e-13  0              2.9938731    
   2200000   10020          200            200            0.0018517852  -0.0019218572   0              0.0074772128   1.0068559e-12  0              9.723494e-08   1.1965779e-13  0              2.9938731    
   2300000   10020          200            200            0.0018517852  -0.0019218572   0              0.0074772129   1.7094706e-13  0              1.6508843e-08  1.1965779e-13  0              2.9938731    
   2400000   10020          200            200            0.0018517853  -0.0019218572   0              0.007477213    1.6756573e-14  0              1.6182299e-09  1.1965779e-13  0              2.9938731    
   2500000   10020          200            200            0.0018517853  -0.0019218572   0              0.007477213    3.2681567e-15  0              3.1561519e-10  1.1965779e-13  0              2.9938731    
   2600000   10020          200            200            0.0018517853  -0.0019218572   0              0.007477213    2.9128026e-16  0              2.8129763e-11  1.1965779e-13  0              2.9938731    
   2700000   10020          200            200            0.0018517853  -0.0019218572   0              0.007477213    7.6784365e-17  0              7.4152843e-12  1.1965779e-13  0              2.9938731    
   2800000   10020          200            200            0.0018517853  -0.0019218572   0              0.007477213    8.1279242e-19  0              7.8493674e-14  1.1965779e-13  0              2.9938731    
   2900000   10020          200            200            0.0018517853  -0.0019218572   0              0.007477213    9.4502764e-19  0              9.1264006e-14  1.1965779e-13  0              2.9938731    
   3000000   10020          200            200            0.0018517853  -0.0019218572   0              0.007477213    2.5748261e-18  0              2.4865828e-13  1.1965779e-13  0              2.9938731    
Loop time of 297.636 on 4 procs for 3000000 steps with 2501 atoms

Performance: 8708633.293 ns/day, 0.000 hours/ns, 10079.437 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 11.109     | 35.681     | 60.892     | 408.1 | 11.99
Neigh   | 6.2701     | 6.3826     | 6.499      |   4.1 |  2.14
Comm    | 23.094     | 41.136     | 77.814     | 334.9 | 13.82
Output  | 0.27124    | 0.27153    | 0.27185    |   0.1 |  0.09
Modify  | 109.68     | 157.55     | 178.38     | 223.2 | 52.93
Other   |            | 56.61      |            |       | 19.02

Nlocal:         625.25 ave         876 max         375 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:           1.75 ave           3 max           1 min
Histogram: 2 0 0 0 0 1 0 0 0 1
Neighs:         308.25 ave         617 max           0 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 1233
Ave neighs/atom = 0.4930028
Neighbor list builds = 166
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 69

#variable lat0 equal 1                    #
variable lat1 equal 3+(300*0.01)+(v_ind*0.01)  # .491+(v_ind*0.001)       # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 500*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 6.69                                                               
Lattice spacing in x,y,z = 6.69 6.69 6.69

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -5017.5 ${n1e1} -100 100 -100 100 units box
region box block -5017.5 5017.5 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -5017.5 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -5017.5 5017.5 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-5017.5 -100 -100) to (5017.5 100 100)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 1500 atoms
  using lattice units in orthogonal box = (-5017.5 -100 -100) to (5017.5 100 100)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 1500 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 1001 atoms
  using lattice units in orthogonal box = (-5017.5 -100 -100) to (5017.5 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  1500 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  1500 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  1001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  1001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
1500 atoms in group substrate
group slider1 region slider1
1001 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 1001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_69_*.dump id type diameter mass xu yu zu fx fy fz

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 6475 130 130
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 125.8 | 125.8 | 125.8 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   10035          200            200            0              0              0              0              0              0              0              1.1965779e-13  0              6            
    100000   10035          200            200            0.0020082656  -8.0497272e-36  0              0.0060247969   577335.67      0              5.5754947e+10  1.1965779e-13  0              3.3325706    
    200000   10035          200            200            0.00067501003  5.3194128e-40  0              0.0020250301   129475.82      0              1.2503848e+10  1.1965779e-13  0              3.084726     
    300000   10035          200            200           -1.3255904e-05 -9.0157229e-34  0             -3.9767711e-05  112.74446      0              10888053       1.1965779e-13  0              3.0433465    
    400000   10035          200            200           -2.6553132e-05 -2.4149179e-35  0             -7.9659395e-05  480.64425      0              46417181       1.1965779e-13  0              3.0047575    
    500000   10035          200            200            0.0048225961   0.0025566754   0              0.011911113    918.87566      0              88738435       1.1965779e-13  0              2.9922341    
    600000   10035          200            200            0.0032027166   0.0014446012   0              0.0081635487   174.0898       0              16812347       1.1965779e-13  0              2.9935933    
    700000   10035          200            200            0.0025975827   0.0012544521   0              0.006538296    0.55362141     0              53464.793      1.1965779e-13  0              2.994283     
    800000   10035          200            200            0.0029976395   0.0014058122   0              0.0075871064   2.9987582      0              289598.6       1.1965779e-13  0              2.9938452    
    900000   10035          200            200            0.0029898718   0.0014237014   0              0.007545914    0.27627494     0              26680.656      1.1965779e-13  0              2.9938585    
   1000000   10035          200            200            0.0029457036   0.0014179209   0              0.00741919     0.0010499871   0              101.40024      1.1965779e-13  0              2.993911     
   1100000   10035          200            200            0.0029645621   0.0014204118   0              0.0074732744   0.0069238403   0              668.65493      1.1965779e-13  0              2.993889     
   1200000   10035          200            200            0.0029633084   0.0014202667   0              0.0074696587   0.00075647729  0              73.055162      1.1965779e-13  0              2.9938903    
   1300000   10035          200            200            0.0029612447   0.0014199922   0              0.0074637419   4.7098734e-07  0              0.045484586    1.1965779e-13  0              2.9938928    
   1400000   10035          200            200            0.002962205    0.0014201173   0              0.0074664978   1.5791776e-05  0              1.5250567      1.1965779e-13  0              2.9938917    
   1500000   10035          200            200            0.0029621155   0.0014201064   0              0.00746624     2.0456838e-06  0              0.1975575      1.1965779e-13  0              2.9938918    
   1600000   10035          200            200            0.0029620202   0.0014200937   0              0.0074659669   1.4216316e-10  0              1.37291e-05    1.1965779e-13  0              2.9938919    
   1700000   10035          200            200            0.0029620688   0.0014201001   0              0.0074661064   3.5500828e-08  0              0.0034284158   1.1965779e-13  0              2.9938918    
   1800000   10035          200            200            0.002962063    0.0014200993   0              0.0074660898   5.4485106e-09  0              0.00052617816  1.1965779e-13  0              2.9938918    
   1900000   10035          200            200            0.0029620587   0.0014200988   0              0.0074660773   8.2052897e-12  0              7.9240815e-07  1.1965779e-13  0              2.9938918    
   2000000   10035          200            200            0.0029620611   0.0014200991   0              0.0074660843   7.8538603e-11  0              7.5846961e-06  1.1965779e-13  0              2.9938918    
   2100000   10035          200            200            0.0029620608   0.001420099    0              0.0074660833   1.4307663e-11  0              1.3817316e-06  1.1965779e-13  0              2.9938918    
   2200000   10035          200            200            0.0029620606   0.001420099    0              0.0074660828   6.4423784e-14  0              6.2215879e-09  1.1965779e-13  0              2.9938918    
   2300000   10035          200            200            0.0029620607   0.001420099    0              0.0074660831   1.706208e-13   0              1.6477335e-08  1.1965779e-13  0              2.9938918    
   2400000   10035          200            200            0.0029620607   0.001420099    0              0.0074660831   3.7099833e-14  0              3.5828363e-09  1.1965779e-13  0              2.9938918    
   2500000   10035          200            200            0.0029620607   0.001420099    0              0.007466083    2.9217609e-16  0              2.8216276e-11  1.1965779e-13  0              2.9938918    
   2600000   10035          200            200            0.0029620607   0.001420099    0              0.0074660831   3.6897119e-16  0              3.5632597e-11  1.1965779e-13  0              2.9938918    
   2700000   10035          200            200            0.0029620607   0.001420099    0              0.0074660831   9.8368984e-17  0              9.4997724e-12  1.1965779e-13  0              2.9938918    
   2800000   10035          200            200            0.0029620607   0.001420099    0              0.0074660831   3.5734888e-18  0              3.4510197e-13  1.1965779e-13  0              2.9938918    
   2900000   10035          200            200            0.0029620607   0.001420099    0              0.0074660831   6.6108204e-20  0              6.3842571e-15  1.1965779e-13  0              2.9938918    
   3000000   10035          200            200            0.0029620607   0.001420099    0              0.0074660831   8.2466712e-19  0              7.9640448e-14  1.1965779e-13  0              2.9938918    
Loop time of 297.546 on 4 procs for 3000000 steps with 2501 atoms

Performance: 8711260.805 ns/day, 0.000 hours/ns, 10082.478 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 11.226     | 35.906     | 61.489     | 410.2 | 12.07
Neigh   | 6.244      | 6.3587     | 6.4757     |   4.2 |  2.14
Comm    | 22.948     | 41.438     | 78.727     | 339.4 | 13.93
Output  | 0.27356    | 0.27386    | 0.27417    |   0.1 |  0.09
Modify  | 109.16     | 157.08     | 177.84     | 223.5 | 52.79
Other   |            | 56.49      |            |       | 18.99

Nlocal:         625.25 ave         876 max         375 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:           1.75 ave           3 max           1 min
Histogram: 2 0 0 0 0 1 0 0 0 1
Neighs:         309.25 ave         619 max           0 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 1237
Ave neighs/atom = 0.49460216
Neighbor list builds = 166
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 70

#variable lat0 equal 1                    #
variable lat1 equal 3+(300*0.01)+(v_ind*0.01)  # .491+(v_ind*0.001)       # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 500*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 6.7                                                               
Lattice spacing in x,y,z = 6.7 6.7 6.7

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -5025 ${n1e1} -100 100 -100 100 units box
region box block -5025 5025 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -5025 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -5025 5025 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-5025 -100 -100) to (5025 100 100)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 1500 atoms
  using lattice units in orthogonal box = (-5025 -100 -100) to (5025 100 100)
  create_atoms CPU = 0.000 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 1500 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 1001 atoms
  using lattice units in orthogonal box = (-5025 -100 -100) to (5025 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  1500 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  1500 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  1001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  1001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
1500 atoms in group substrate
group slider1 region slider1
1001 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 1001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_70_*.dump id type diameter mass xu yu zu fx fy fz

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 6484 130 130
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 125.9 | 125.9 | 125.9 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   10050          200            200            0              0              0              0              0              0              0              1.1965779e-13  0              6            
    100000   10050          200            200            0.0020054662  -2.0094298e-36  0              0.0060163985   577418.61      0              5.5762956e+10  1.1965779e-13  0              3.3325233    
    200000   10050          200            200            0.00067445722  7.0003612e-40  0              0.0020233717   129612.06      0              1.2517005e+10  1.1965779e-13  0              3.0846397    
    300000   10050          200            200           -1.3039448e-05  2.4113327e-35  0             -3.9118343e-05  109.35361      0              10560589       1.1965779e-13  0              3.0434234    
    400000   10050          200            200           -2.3615223e-05 -3.2150536e-35  0             -7.084567e-05   378.51249      0              36554027       1.1965779e-13  0              3.0049329    
    500000   10050          200            200            0.0041652138   0.0051659261   0              0.0073297154   1373.105       0              1.3260465e+08  1.1965779e-13  0              2.9939413    
    600000   10050          200            200            0.0045396456   0.0038140286   0              0.0098049083   33.433094      0              3228728.9      1.1965779e-13  0              2.9929714    
    700000   10050          200            200            0.0036160566   0.0036482137   0              0.0071999562   22.222908      0              2146129.4      1.1965779e-13  0              2.9940676    
    800000   10050          200            200            0.0036516258   0.0036597907   0              0.0072950866   2.5391053      0              245208.62      1.1965779e-13  0              2.9940139    
    900000   10050          200            200            0.0037522297   0.0036847839   0              0.0075719051   0.036355866    0              3510.9893      1.1965779e-13  0              2.9938928    
   1000000   10050          200            200            0.0036955998   0.0036706101   0              0.0074161892   0.013757873    0              1328.6369      1.1965779e-13  0              2.9939623    
   1100000   10050          200            200            0.0037113712   0.0036746807   0              0.0074594328   0.0074602992   0              720.46229      1.1965779e-13  0              2.9939426    
   1200000   10050          200            200            0.0037108597   0.0036745148   0              0.0074580645   0.00082983812  0              80.139826      1.1965779e-13  0              2.9939434    
   1300000   10050          200            200            0.0037089961   0.0036740536   0              0.0074529347   1.0454729e-05  0              1.0096429      1.1965779e-13  0              2.9939456    
   1400000   10050          200            200            0.0037100287   0.0036743145   0              0.0074557715   4.912013e-06   0              0.47436705     1.1965779e-13  0              2.9939443    
   1500000   10050          200            200            0.0037097465   0.0036742419   0              0.0074549975   2.5027926e-06  0              0.2417018      1.1965779e-13  0              2.9939447    
   1600000   10050          200            200            0.003709753    0.0036742443   0              0.0074550147   2.6899409e-07  0              0.025977524    1.1965779e-13  0              2.9939447    
   1700000   10050          200            200            0.0037097877   0.0036742529   0              0.0074551103   2.9788816e-09  0              0.00028767906  1.1965779e-13  0              2.9939446    
   1800000   10050          200            200            0.0037097689   0.0036742481   0              0.0074550585   1.7460383e-09  0              0.00016861988  1.1965779e-13  0              2.9939447    
   1900000   10050          200            200            0.0037097739   0.0036742494   0              0.0074550724   8.3900524e-10  0              8.1025121e-05  1.1965779e-13  0              2.9939447    
   2000000   10050          200            200            0.0037097739   0.0036742494   0              0.0074550722   8.7101489e-11  0              8.4116384e-06  1.1965779e-13  0              2.9939447    
   2100000   10050          200            200            0.0037097732   0.0036742492   0              0.0074550704   8.3741838e-13  0              8.0871873e-08  1.1965779e-13  0              2.9939447    
   2200000   10050          200            200            0.0037097736   0.0036742493   0              0.0074550714   6.1867477e-13  0              5.9747181e-08  1.1965779e-13  0              2.9939447    
   2300000   10050          200            200            0.0037097735   0.0036742493   0              0.0074550711   2.8100383e-13  0              2.7137339e-08  1.1965779e-13  0              2.9939447    
   2400000   10050          200            200            0.0037097735   0.0036742493   0              0.0074550711   2.8221984e-14  0              2.7254772e-09  1.1965779e-13  0              2.9939447    
   2500000   10050          200            200            0.0037097735   0.0036742493   0              0.0074550712   2.3413245e-16  0              2.2610836e-11  1.1965779e-13  0              2.9939447    
   2600000   10050          200            200            0.0037097735   0.0036742493   0              0.0074550711   2.1104064e-16  0              2.0380795e-11  1.1965779e-13  0              2.9939447    
   2700000   10050          200            200            0.0037097735   0.0036742493   0              0.0074550712   9.6813785e-17  0              9.3495824e-12  1.1965779e-13  0              2.9939447    
   2800000   10050          200            200            0.0037097735   0.0036742493   0              0.0074550712   4.3262421e-18  0              4.1779749e-13  1.1965779e-13  0              2.9939447    
   2900000   10050          200            200            0.0037097735   0.0036742493   0              0.0074550712   9.2996521e-20  0              8.9809384e-15  1.1965779e-13  0              2.9939447    
   3000000   10050          200            200            0.0037097735   0.0036742493   0              0.0074550712   3.5916856e-20  0              3.4685928e-15  1.1965779e-13  0              2.9939447    
Loop time of 296.964 on 4 procs for 3000000 steps with 2501 atoms

Performance: 8728335.979 ns/day, 0.000 hours/ns, 10102.241 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 11.191     | 35.329     | 60.211     | 403.6 | 11.90
Neigh   | 6.2978     | 6.418      | 6.5415     |   4.4 |  2.16
Comm    | 22.985     | 41.107     | 77.404     | 331.9 | 13.84
Output  | 0.27324    | 0.27356    | 0.27386    |   0.1 |  0.09
Modify  | 109.3      | 157.1      | 178.28     | 223.7 | 52.90
Other   |            | 56.74      |            |       | 19.11

Nlocal:         625.25 ave         876 max         375 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:           1.75 ave           3 max           1 min
Histogram: 2 0 0 0 0 1 0 0 0 1
Neighs:         306.25 ave         613 max           0 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 1225
Ave neighs/atom = 0.48980408
Neighbor list builds = 166
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 71

#variable lat0 equal 1                    #
variable lat1 equal 3+(300*0.01)+(v_ind*0.01)  # .491+(v_ind*0.001)       # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 500*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 6.71                                                               
Lattice spacing in x,y,z = 6.71 6.71 6.71

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -5032.5 ${n1e1} -100 100 -100 100 units box
region box block -5032.5 5032.5 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -5032.5 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -5032.5 5032.5 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-5032.5 -100 -100) to (5032.5 100 100)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 1500 atoms
  using lattice units in orthogonal box = (-5032.5 -100 -100) to (5032.5 100 100)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 1500 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 1001 atoms
  using lattice units in orthogonal box = (-5032.5 -100 -100) to (5032.5 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  1500 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  1500 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  1001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  1001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
1500 atoms in group substrate
group slider1 region slider1
1001 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 1001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_71_*.dump id type diameter mass xu yu zu fx fy fz

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 6494 130 130
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 126.1 | 126.1 | 126.1 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   10065          200            200            0              0              0              0              0              0              0              1.1965779e-13  0              6            
    100000   10065          200            200            0.002001937    8.0257754e-35  0              0.006005811    577193.32      0              5.57412e+10    1.1965779e-13  0              3.3326406    
    200000   10065          200            200            0.00067236911  2.0064495e-36  0              0.0020171073   129289.46      0              1.2485851e+10  1.1965779e-13  0              3.0847921    
    300000   10065          200            200           -1.5038035e-05 -6.4206131e-34  0             -4.5114105e-05  146.70049      0              14167284       1.1965779e-13  0              3.0432006    
    400000   10065          200            200           -2.918486e-05   1.0032216e-35  0             -8.7554581e-05  588.15184      0              56799495       1.1965779e-13  0              3.0045762    
    500000   10065          200            200            0.0045734644   0.0020771493   0              0.011643244    969.15012      0              93593582       1.1965779e-13  0              2.9922561    
    600000   10065          200            200            0.003110955    0.0020492913   0              0.0072835738   186.8312       0              18042820       1.1965779e-13  0              2.9938727    
    700000   10065          200            200            0.0027320013   0.0016783519   0              0.006517652    0.00054097759  0              52.243743      1.1965779e-13  0              2.9942241    
    800000   10065          200            200            0.0030378107   0.0016179485   0              0.0074954837   3.3024251      0              318924.58      1.1965779e-13  0              2.9938086    
    900000   10065          200            200            0.0030551299   0.0016038225   0              0.0075615671   0.066807589    0              6451.7987      1.1965779e-13  0              2.9937783    
   1000000   10065          200            200            0.0030068164   0.0016056068   0              0.0074148426   0.038632315    0              3730.8324      1.1965779e-13  0              2.9938388    
   1100000   10065          200            200            0.0030132148   0.0016063923   0              0.0074332521   0.0051594681   0              498.2645       1.1965779e-13  0              2.9938316    
   1200000   10065          200            200            0.0030188556   0.0016070349   0              0.0074495321   0.00016674926  0              16.10345       1.1965779e-13  0              2.9938248    
   1300000   10065          200            200            0.0030169265   0.0016068182   0              0.0074439613   0.00014749064  0              14.24359       1.1965779e-13  0              2.993827     
   1400000   10065          200            200            0.0030165312   0.0016067717   0              0.007442822    3.1647218e-07  0              0.030562618    1.1965779e-13  0              2.9938275    
   1500000   10065          200            200            0.0030168664   0.0016068095   0              0.0074437898   2.3467769e-06  0              0.22663491     1.1965779e-13  0              2.9938271    
   1600000   10065          200            200            0.0030168562   0.0016068086   0              0.0074437599   1.34416e-07    0              0.012980936    1.1965779e-13  0              2.9938271    
   1700000   10065          200            200            0.0030168129   0.0016068036   0              0.007443635    1.8804118e-08  0              0.0018159672   1.1965779e-13  0              2.9938272    
   1800000   10065          200            200            0.0030168225   0.0016068047   0              0.0074436627   5.6992103e-09  0              0.00055038893  1.1965779e-13  0              2.9938272    
   1900000   10065          200            200            0.0030168265   0.0016068052   0              0.0074436743   1.7441962e-11  0              1.6844199e-06  1.1965779e-13  0              2.9938272    
   2000000   10065          200            200            0.0030168244   0.0016068049   0              0.0074436684   1.2053943e-10  0              1.1640835e-05  1.1965779e-13  0              2.9938272    
   2100000   10065          200            200            0.0030168243   0.0016068049   0              0.0074436679   2.3104285e-12  0              2.2312465e-07  1.1965779e-13  0              2.9938272    
   2200000   10065          200            200            0.0030168246   0.0016068049   0              0.0074436688   1.4226745e-12  0              1.3739172e-07  1.1965779e-13  0              2.9938272    
   2300000   10065          200            200            0.0030168246   0.0016068049   0              0.0074436687   1.8640669e-13  0              1.8001824e-08  1.1965779e-13  0              2.9938272    
   2400000   10065          200            200            0.0030168245   0.0016068049   0              0.0074436686   6.1508398e-15  0              5.9400408e-10  1.1965779e-13  0              2.9938272    
   2500000   10065          200            200            0.0030168245   0.0016068049   0              0.0074436687   5.3685738e-15  0              5.1845843e-10  1.1965779e-13  0              2.9938272    
   2600000   10065          200            200            0.0030168245   0.0016068049   0              0.0074436687   7.7270036e-18  0              7.462187e-13   1.1965779e-13  0              2.9938272    
   2700000   10065          200            200            0.0030168245   0.0016068049   0              0.0074436687   7.2018511e-17  0              6.9550323e-12  1.1965779e-13  0              2.9938272    
   2800000   10065          200            200            0.0030168245   0.0016068049   0              0.0074436687   7.9060823e-18  0              7.6351284e-13  1.1965779e-13  0              2.9938272    
   2900000   10065          200            200            0.0030168245   0.0016068049   0              0.0074436687   2.7582346e-18  0              2.6637055e-13  1.1965779e-13  0              2.9938272    
   3000000   10065          200            200            0.0030168245   0.0016068049   0              0.0074436687   1.0054427e-18  0              9.709846e-14   1.1965779e-13  0              2.9938272    
Loop time of 297.947 on 4 procs for 3000000 steps with 2501 atoms

Performance: 8699545.212 ns/day, 0.000 hours/ns, 10068.918 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 11.088     | 35.809     | 61.026     | 409.4 | 12.02
Neigh   | 6.3182     | 6.4275     | 6.541      |   4.0 |  2.16
Comm    | 23.051     | 41.263     | 78.164     | 336.5 | 13.85
Output  | 0.29402    | 0.29432    | 0.29465    |   0.1 |  0.10
Modify  | 109.67     | 157.64     | 178.11     | 223.5 | 52.91
Other   |            | 56.51      |            |       | 18.97

Nlocal:         625.25 ave         876 max         375 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:           1.75 ave           3 max           1 min
Histogram: 2 0 0 0 0 1 0 0 0 1
Neighs:         308.25 ave         617 max           0 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 1233
Ave neighs/atom = 0.4930028
Neighbor list builds = 166
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 72

#variable lat0 equal 1                    #
variable lat1 equal 3+(300*0.01)+(v_ind*0.01)  # .491+(v_ind*0.001)       # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 500*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 6.72                                                               
Lattice spacing in x,y,z = 6.72 6.72 6.72

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -5040 ${n1e1} -100 100 -100 100 units box
region box block -5040 5040 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -5040 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -5040 5040 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-5040 -100 -100) to (5040 100 100)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 1500 atoms
  using lattice units in orthogonal box = (-5040 -100 -100) to (5040 100 100)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 1500 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 1001 atoms
  using lattice units in orthogonal box = (-5040 -100 -100) to (5040 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  1500 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  1500 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  1001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  1001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
1500 atoms in group substrate
group slider1 region slider1
1001 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 1001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_72_*.dump id type diameter mass xu yu zu fx fy fz

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 6504 130 130
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 126.3 | 126.3 | 126.3 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   10080          200            200            0              0              0              0              0              0              0              1.1965779e-13  0              6            
    100000   10080          200            200            0.0019991758  -4.006911e-35   0              0.0059975273   577287.9       0              5.5750333e+10  1.1965779e-13  0              3.3325637    
    200000   10080          200            200            0.00067191755  2.056431e-43   0              0.0020157526   129455.49      0              1.2501885e+10  1.1965779e-13  0              3.0846621    
    300000   10080          200            200           -1.4369567e-05 -3.2054911e-35  0             -4.3108701e-05  134.10994      0              12951378       1.1965779e-13  0              3.0432707    
    400000   10080          200            200           -2.6728752e-05  1.6027754e-34  0             -8.0186256e-05  491.78118      0              47492706       1.1965779e-13  0              3.0047021    
    500000   10080          200            200            0.0054592381   0.0047777467   0              0.011599968    970.88455      0              93761080       1.1965779e-13  0              2.9923774    
    600000   10080          200            200            0.0025210518   0.0022789716   0              0.005284184    52.68839       0              5088267.6      1.1965779e-13  0              2.9948909    
    700000   10080          200            200            0.0034970324   0.002691321    0              0.0077997763   21.73956       0              2099451.1      1.1965779e-13  0              2.9938364    
    800000   10080          200            200            0.0033764301   0.0026687532   0              0.0074605371   3.3759755      0              326027.55      1.1965779e-13  0              2.9939633    
    900000   10080          200            200            0.003341689    0.002660762    0              0.0073643051   0.32557003     0              31441.223      1.1965779e-13  0              2.9940061    
   1000000   10080          200            200            0.0033810059   0.0026692593   0              0.0074737585   0.015872687    0              1532.8705      1.1965779e-13  0              2.9939605    
   1100000   10080          200            200            0.0033601285   0.0026648404   0              0.007415545    2.8248379e-05  0              2.7280262      1.1965779e-13  0              2.9939844    
   1200000   10080          200            200            0.003368488    0.0026666015   0              0.0074388627   0.00018254156  0              17.628558      1.1965779e-13  0              2.9939749    
   1300000   10080          200            200            0.0033658353   0.0026660492   0              0.0074314567   9.1306904e-05  0              8.8177673      1.1965779e-13  0              2.9939779    
   1400000   10080          200            200            0.0033664428   0.0026661734   0              0.007433155    1.9616365e-05  0              1.8944081      1.1965779e-13  0              2.9939772    
   1500000   10080          200            200            0.0033664033   0.0026661667   0              0.0074330431   2.586874e-06   0              0.24982178     1.1965779e-13  0              2.9939772    
   1600000   10080          200            200            0.0033663472   0.0026661543   0              0.0074328872   2.0674071e-07  0              0.019965538    1.1965779e-13  0              2.9939773    
   1700000   10080          200            200            0.0033663892   0.0026661633   0              0.0074330043   6.4750914e-09  0              0.00062531798  1.1965779e-13  0              2.9939773    
   1800000   10080          200            200            0.0033663693   0.0026661591   0              0.0074329487   7.573862e-11   0              7.3142938e-06  1.1965779e-13  0              2.9939773    
   1900000   10080          200            200            0.0033663767   0.0026661607   0              0.0074329693   2.7393711e-10  0              2.6454886e-05  1.1965779e-13  0              2.9939773    
   2000000   10080          200            200            0.0033663745   0.0026661602   0              0.0074329633   9.3200851e-11  0              9.000671e-06   1.1965779e-13  0              2.9939773    
   2100000   10080          200            200            0.0033663749   0.0026661603   0              0.0074329645   1.6675476e-11  0              1.6103981e-06  1.1965779e-13  0              2.9939773    
   2200000   10080          200            200            0.0033663749   0.0026661603   0              0.0074329645   1.8734359e-12  0              1.8092303e-07  1.1965779e-13  0              2.9939773    
   2300000   10080          200            200            0.0033663749   0.0026661603   0              0.0074329643   1.1899585e-13  0              1.1491768e-08  1.1965779e-13  0              2.9939773    
   2400000   10080          200            200            0.0033663749   0.0026661603   0              0.0074329644   1.6215012e-15  0              1.5659298e-10  1.1965779e-13  0              2.9939773    
   2500000   10080          200            200            0.0033663749   0.0026661603   0              0.0074329644   4.1095431e-16  0              3.9687026e-11  1.1965779e-13  0              2.9939773    
   2600000   10080          200            200            0.0033663749   0.0026661603   0              0.0074329644   3.4521435e-16  0              3.3338331e-11  1.1965779e-13  0              2.9939773    
   2700000   10080          200            200            0.0033663749   0.0026661603   0              0.0074329644   7.6665484e-17  0              7.4038037e-12  1.1965779e-13  0              2.9939773    
   2800000   10080          200            200            0.0033663749   0.0026661603   0              0.0074329644   1.2855858e-17  0              1.2415267e-12  1.1965779e-13  0              2.9939773    
   2900000   10080          200            200            0.0033663749   0.0026661603   0              0.0074329644   3.5722877e-18  0              3.4498597e-13  1.1965779e-13  0              2.9939773    
   3000000   10080          200            200            0.0033663749   0.0026661603   0              0.0074329644   7.5316418e-18  0              7.2735206e-13  1.1965779e-13  0              2.9939773    
Loop time of 298.906 on 4 procs for 3000000 steps with 2501 atoms

Performance: 8671629.007 ns/day, 0.000 hours/ns, 10036.608 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 11.242     | 35.617     | 60.688     | 406.3 | 11.92
Neigh   | 6.3615     | 6.4784     | 6.601      |   4.3 |  2.17
Comm    | 23.034     | 41.322     | 78.045     | 334.9 | 13.82
Output  | 0.26928    | 0.26958    | 0.2699     |   0.1 |  0.09
Modify  | 110.24     | 158.34     | 179.22     | 224.3 | 52.97
Other   |            | 56.88      |            |       | 19.03

Nlocal:         625.25 ave         876 max         375 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:           1.75 ave           3 max           1 min
Histogram: 2 0 0 0 0 1 0 0 0 1
Neighs:         307.75 ave         616 max           0 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 1231
Ave neighs/atom = 0.49220312
Neighbor list builds = 166
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 73

#variable lat0 equal 1                    #
variable lat1 equal 3+(300*0.01)+(v_ind*0.01)  # .491+(v_ind*0.001)       # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 500*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 6.73                                                               
Lattice spacing in x,y,z = 6.73 6.73 6.73

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -5047.5 ${n1e1} -100 100 -100 100 units box
region box block -5047.5 5047.5 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -5047.5 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -5047.5 5047.5 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-5047.5 -100 -100) to (5047.5 100 100)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 1500 atoms
  using lattice units in orthogonal box = (-5047.5 -100 -100) to (5047.5 100 100)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 1500 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 1001 atoms
  using lattice units in orthogonal box = (-5047.5 -100 -100) to (5047.5 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  1500 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  1500 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  1001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  1001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
1500 atoms in group substrate
group slider1 region slider1
1001 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 1001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_73_*.dump id type diameter mass xu yu zu fx fy fz

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 6513 130 130
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 126.5 | 126.5 | 126.5 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   10095          200            200            0              0              0              0              0              0              0              1.1965779e-13  0              6            
    100000   10095          200            200            0.0019963287   1.0002414e-36  0              0.0059889862   577334.62      0              5.5754845e+10  1.1965779e-13  0              3.332577     
    200000   10095          200            200            0.00067106976 -3.2007455e-35  0              0.0020132093   129498.02      0              1.2505991e+10  1.1965779e-13  0              3.0846979    
    300000   10095          200            200           -1.3743064e-05  2.3321585e-40  0             -4.1229193e-05  122.82812      0              11861861       1.1965779e-13  0              3.0433463    
    400000   10095          200            200           -2.590902e-05  -7.0416518e-34  0             -7.7727059e-05  462.52232      0              44667096       1.1965779e-13  0              3.004794     
    500000   10095          200            200            0.0048378775   0.005973108    0              0.0085405244   1363.2865      0              1.3165645e+08  1.1965779e-13  0              2.9934183    
    600000   10095          200            200            0.003127071    0.0037089752   0              0.0056722378   96.753184      0              9343729.9      1.1965779e-13  0              2.9946695    
    700000   10095          200            200            0.0036833271   0.004215439    0              0.0068345424   14.919879      0              1440855.1      1.1965779e-13  0              2.9941698    
    800000   10095          200            200            0.004049261    0.0044085662   0              0.0077392168   0.63405815     0              61232.798      1.1965779e-13  0              2.9937863    
    900000   10095          200            200            0.0039426143   0.004384639    0              0.007443204    0.44124418     0              42612.204      1.1965779e-13  0              2.993905     
   1000000   10095          200            200            0.0039185878   0.0043804608   0              0.0073753025   0.00087068547  0              84.084571      1.1965779e-13  0              2.9939341    
   1100000   10095          200            200            0.003938113    0.0043853008   0              0.0074290381   0.0068693545   0              663.39309      1.1965779e-13  0              2.993912     
   1200000   10095          200            200            0.0039371539   0.004385041    0              0.0074264206   0.00050204316  0              48.483735      1.1965779e-13  0              2.9939129    
   1300000   10095          200            200            0.003934667    0.0043842548   0              0.0074197462   3.8322286e-05  0              3.7008921      1.1965779e-13  0              2.9939157    
   1400000   10095          200            200            0.0039353505   0.0043844647   0              0.0074215867   1.9377623e-05  0              1.8713521      1.1965779e-13  0              2.9939149    
   1500000   10095          200            200            0.0039355337   0.0043845239   0              0.0074220773   2.1110684e-08  0              0.0020387187   1.1965779e-13  0              2.9939147    
   1600000   10095          200            200            0.0039354007   0.0043844824   0              0.0074217197   3.1539902e-07  0              0.03045898     1.1965779e-13  0              2.9939149    
   1700000   10095          200            200            0.0039354056   0.0043844836   0              0.0074217331   2.0941797e-08  0              0.0020224089   1.1965779e-13  0              2.9939149    
   1800000   10095          200            200            0.0039354225   0.004384489    0              0.0074217784   1.8958471e-09  0              0.00018308734  1.1965779e-13  0              2.9939148    
   1900000   10095          200            200            0.003935418    0.0043844876   0              0.0074217665   8.5417542e-10  0              8.2490148e-05  1.1965779e-13  0              2.9939148    
   2000000   10095          200            200            0.0039354167   0.0043844872   0              0.007421763    4.0395615e-13  0              3.9011194e-08  1.1965779e-13  0              2.9939148    
   2100000   10095          200            200            0.0039354176   0.0043844875   0              0.0074217654   1.4455262e-11  0              1.3959857e-06  1.1965779e-13  0              2.9939148    
   2200000   10095          200            200            0.0039354176   0.0043844875   0              0.0074217653   8.7028153e-13  0              8.4045561e-08  1.1965779e-13  0              2.9939148    
   2300000   10095          200            200            0.0039354175   0.0043844874   0              0.007421765    9.3009086e-14  0              8.9821518e-09  1.1965779e-13  0              2.9939148    
   2400000   10095          200            200            0.0039354175   0.0043844874   0              0.0074217651   3.7510092e-14  0              3.6224562e-09  1.1965779e-13  0              2.9939148    
   2500000   10095          200            200            0.0039354175   0.0043844874   0              0.0074217651   1.5146905e-18  0              1.4627796e-13  1.1965779e-13  0              2.9939148    
   2600000   10095          200            200            0.0039354175   0.0043844874   0              0.0074217651   6.5567159e-16  0              6.3320069e-11  1.1965779e-13  0              2.9939148    
   2700000   10095          200            200            0.0039354175   0.0043844874   0              0.0074217651   5.1954077e-17  0              5.0173529e-12  1.1965779e-13  0              2.9939148    
   2800000   10095          200            200            0.0039354175   0.0043844874   0              0.0074217651   9.3635771e-19  0              9.0426725e-14  1.1965779e-13  0              2.9939148    
   2900000   10095          200            200            0.0039354175   0.0043844874   0              0.0074217651   5.6767814e-18  0              5.4822292e-13  1.1965779e-13  0              2.9939148    
   3000000   10095          200            200            0.0039354175   0.0043844874   0              0.0074217651   7.6672741e-18  0              7.4045046e-13  1.1965779e-13  0              2.9939148    
Loop time of 298.829 on 4 procs for 3000000 steps with 2501 atoms

Performance: 8673865.703 ns/day, 0.000 hours/ns, 10039.196 timesteps/s
99.9% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 11.205     | 35.983     | 61.543     | 410.1 | 12.04
Neigh   | 6.1918     | 6.2997     | 6.412      |   4.0 |  2.11
Comm    | 22.78      | 41.222     | 78.478     | 339.9 | 13.79
Output  | 0.27289    | 0.27319    | 0.2735     |   0.1 |  0.09
Modify  | 110.2      | 158.27     | 179.15     | 223.6 | 52.96
Other   |            | 56.78      |            |       | 19.00

Nlocal:         625.25 ave         876 max         375 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:           1.75 ave           3 max           1 min
Histogram: 2 0 0 0 0 1 0 0 0 1
Neighs:         308.75 ave         618 max           0 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 1235
Ave neighs/atom = 0.49380248
Neighbor list builds = 166
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 74

#variable lat0 equal 1                    #
variable lat1 equal 3+(300*0.01)+(v_ind*0.01)  # .491+(v_ind*0.001)       # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 500*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 6.74                                                               
Lattice spacing in x,y,z = 6.74 6.74 6.74

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -5055 ${n1e1} -100 100 -100 100 units box
region box block -5055 5055 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -5055 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -5055 5055 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-5055 -100 -100) to (5055 100 100)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 1500 atoms
  using lattice units in orthogonal box = (-5055 -100 -100) to (5055 100 100)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 1500 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 1001 atoms
  using lattice units in orthogonal box = (-5055 -100 -100) to (5055 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  1500 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  1500 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  1001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  1001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
1500 atoms in group substrate
group slider1 region slider1
1001 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 1001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_74_*.dump id type diameter mass xu yu zu fx fy fz

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 6523 130 130
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 126.6 | 126.6 | 126.6 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   10110          200            200            0              0              0              0              0              0              0              1.1965779e-13  0              6            
    100000   10110          200            200            0.0019928546  -7.9899901e-36  0              0.0059785638   577123.8       0              5.5734485e+10  1.1965779e-13  0              3.3326587    
    200000   10110          200            200            0.00066904794  1.598031e-35   0              0.0020071438   129192.26      0              1.2476463e+10  1.1965779e-13  0              3.0848149    
    300000   10110          200            200           -1.5319314e-05  3.0807552e-40  0             -4.5957943e-05  153.75501      0              14848559       1.1965779e-13  0              3.0431132    
    400000   10110          200            200           -3.0561043e-05 -3.1958969e-35  0             -9.1683129e-05  653.22611      0              63083902       1.1965779e-13  0              3.0044444    
    500000   10110          200            200            0.0088761318   0.014629608    0              0.011998787    887.33829      0              85692780       1.1965779e-13  0              2.9920703    
    600000   10110          200            200            0.0053558284   0.0088040384   0              0.0072634468   186.8449       0              18044143       1.1965779e-13  0              2.9938189    
    700000   10110          200            200            0.0048098481   0.0079376405   0              0.0064919038   0.38701245     0              37374.892      1.1965779e-13  0              2.9941713    
    800000   10110          200            200            0.0053034912   0.0083648247   0              0.0075456488   2.8736009      0              277511.81      1.1965779e-13  0              2.9937254    
    900000   10110          200            200            0.0052995325   0.0083912487   0              0.0075073489   0.18661586     0              18022.024      1.1965779e-13  0              2.9937379    
   1000000   10110          200            200            0.0052431015   0.0083583765   0              0.0073709281   0.017949352    0              1733.42        1.1965779e-13  0              2.9937948    
   1100000   10110          200            200            0.0052575809   0.0083667537   0              0.007405989    0.0076586434   0              739.61696      1.1965779e-13  0              2.9937806    
   1200000   10110          200            200            0.0052620497   0.0083694325   0              0.0074167165   1.1697327e-06  0              0.11296441     1.1965779e-13  0              2.993776     
   1300000   10110          200            200            0.0052591204   0.0083677281   0              0.007409633    0.00013391636  0              12.932684      1.1965779e-13  0              2.9937789    
   1400000   10110          200            200            0.0052591596   0.0083677406   0              0.0074097381   7.1897989e-06  0              0.69433931     1.1965779e-13  0              2.9937789    
   1500000   10110          200            200            0.0052595463   0.0083679681   0              0.0074106708   9.4866248e-07  0              0.091615032    1.1965779e-13  0              2.9937785    
   1600000   10110          200            200            0.0052594563   0.0083679166   0              0.0074104523   3.308628e-07   0              0.031952361    1.1965779e-13  0              2.9937786    
   1700000   10110          200            200            0.0052594238   0.0083678972   0              0.0074103743   2.9115547e-11  0              2.8117711e-06  1.1965779e-13  0              2.9937787    
   1800000   10110          200            200            0.0052594431   0.0083679084   0              0.0074104209   6.2088223e-09  0              0.00059960362  1.1965779e-13  0              2.9937786    
   1900000   10110          200            200            0.0052594432   0.0083679086   0              0.0074104212   2.7343166e-10  0              2.6406072e-05  1.1965779e-13  0              2.9937786    
   2000000   10110          200            200            0.0052594406   0.008367907    0              0.0074104148   4.9122658e-11  0              4.7439147e-06  1.1965779e-13  0              2.9937786    
   2100000   10110          200            200            0.0052594412   0.0083679073   0              0.0074104162   1.4190505e-11  0              1.3704174e-06  1.1965779e-13  0              2.9937786    
   2200000   10110          200            200            0.0052594414   0.0083679075   0              0.0074104167   1.4499078e-14  0              1.4002172e-09  1.1965779e-13  0              2.9937786    
   2300000   10110          200            200            0.0052594413   0.0083679074   0              0.0074104164   2.8583023e-13  0              2.7603437e-08  1.1965779e-13  0              2.9937786    
   2400000   10110          200            200            0.0052594413   0.0083679074   0              0.0074104164   1.0103701e-14  0              9.757431e-10   1.1965779e-13  0              2.9937786    
   2500000   10110          200            200            0.0052594413   0.0083679074   0              0.0074104165   2.4753671e-15  0              2.3905323e-10  1.1965779e-13  0              2.9937786    
   2600000   10110          200            200            0.0052594413   0.0083679074   0              0.0074104165   6.0248931e-16  0              5.8184105e-11  1.1965779e-13  0              2.9937786    
   2700000   10110          200            200            0.0052594413   0.0083679074   0              0.0074104165   2.4839693e-19  0              2.3988398e-14  1.1965779e-13  0              2.9937786    
   2800000   10110          200            200            0.0052594413   0.0083679074   0              0.0074104165   8.6438452e-18  0              8.347607e-13   1.1965779e-13  0              2.9937786    
   2900000   10110          200            200            0.0052594413   0.0083679074   0              0.0074104165   2.7677868e-19  0              2.6729304e-14  1.1965779e-13  0              2.9937786    
   3000000   10110          200            200            0.0052594413   0.0083679074   0              0.0074104165   1.0672864e-18  0              1.0307089e-13  1.1965779e-13  0              2.9937786    
Loop time of 300.227 on 4 procs for 3000000 steps with 2501 atoms

Performance: 8633461.168 ns/day, 0.000 hours/ns, 9992.432 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 11.449     | 36.022     | 61.226     | 407.8 | 12.00
Neigh   | 6.3635     | 6.4859     | 6.6135     |   4.5 |  2.16
Comm    | 23.066     | 41.412     | 78.539     | 338.0 | 13.79
Output  | 0.27425    | 0.27457    | 0.27488    |   0.1 |  0.09
Modify  | 111.64     | 159.48     | 179.58     | 221.8 | 53.12
Other   |            | 56.55      |            |       | 18.84

Nlocal:         625.25 ave         876 max         375 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:           1.75 ave           3 max           1 min
Histogram: 2 0 0 0 0 1 0 0 0 1
Neighs:         308.25 ave         617 max           0 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 1233
Ave neighs/atom = 0.4930028
Neighbor list builds = 166
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 75

#variable lat0 equal 1                    #
variable lat1 equal 3+(300*0.01)+(v_ind*0.01)  # .491+(v_ind*0.001)       # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 500*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 6.75                                                               
Lattice spacing in x,y,z = 6.75 6.75 6.75

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -5062.5 ${n1e1} -100 100 -100 100 units box
region box block -5062.5 5062.5 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -5062.5 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -5062.5 5062.5 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-5062.5 -100 -100) to (5062.5 100 100)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 1500 atoms
  using lattice units in orthogonal box = (-5062.5 -100 -100) to (5062.5 100 100)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 1500 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 1001 atoms
  using lattice units in orthogonal box = (-5062.5 -100 -100) to (5062.5 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  1500 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  1500 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  1001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  1001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
1500 atoms in group substrate
group slider1 region slider1
1001 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 1001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_75_*.dump id type diameter mass xu yu zu fx fy fz

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 6533 130 130
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 126.8 | 126.8 | 126.8 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   10125          200            200            0              0              0              0              0              0              0              1.1965779e-13  0              6            
    100000   10125          200            200            0.0019948805   2.3934674e-35  0              0.0059846416   578662.32      0              5.5883065e+10  1.1965779e-13  0              3.3360528    
    200000   10125          200            200            0.0006772447   1.5956563e-35  0              0.0020317341   131737.11      0              1.2722227e+10  1.1965779e-13  0              3.0884038    
    300000   10125          200            200            1.6056881e-05 -4.7869013e-35  0              4.8170643e-05  160.06508      0              15457940       1.1965779e-13  0              3.0487337    
    400000   10125          200            200            0.0001200822   3.1913053e-35  0              0.00036024659  7615.1631      0              7.3541795e+08  1.1965779e-13  0              3.0017236    
    500000   10125          200            200            0.00015857398 -3.1912643e-35  0              0.00047572195  585.71377      0              56564044       1.1965779e-13  0              2.9996219    
    600000   10125          200            200            0.0015418691   1.1293186e-40  0              0.0046256072   112.90605      0              10903658       1.1965779e-13  0              2.9979995    
    700000   10125          200            200            0.0020027801  -1.5956298e-35  0              0.0060083404   0.059111717    0              5708.5865      1.1965779e-13  0              2.9976317    
    800000   10125          200            200            0.0023937409  -3.191272e-35   0              0.0071812226   3.7026876      0              357579.07      1.1965779e-13  0              2.9973341    
    900000   10125          200            200            0.002509517    1.5956497e-35  0              0.007528551    0.38277491     0              36965.661      1.1965779e-13  0              2.9972475    
   1000000   10125          200            200            0.0024924109   7.9782596e-36  0              0.0074772328   0.0038381503   0              370.66109      1.1965779e-13  0              2.9972594    
   1100000   10125          200            200            0.0024713043   3.1094222e-41  0              0.007413913    0.0106047      0              1024.1261      1.1965779e-13  0              2.9972749    
   1200000   10125          200            200            0.0024668819   1.1967337e-35  0              0.0074006458   0.00060277145  0              58.211352      1.1965779e-13  0              2.9972782    
   1300000   10125          200            200            0.0024683072   1.9945758e-36  0              0.0074049217   3.6282239e-05  0              3.5038789      1.1965779e-13  0              2.9972772    
   1400000   10125          200            200            0.0024693583   2.3572641e-41  0              0.007408075    2.7354022e-05  0              2.6416556      1.1965779e-13  0              2.9972764    
   1500000   10125          200            200            0.0024695021  -1.9945286e-36  0              0.0074085063   7.3816651e-07  0              0.071286838    1.1965779e-13  0              2.9972763    
   1600000   10125          200            200            0.0024694065   5.9836794e-36  0              0.0074082194   1.8479771e-07  0              0.01784644     1.1965779e-13  0              2.9972764    
   1700000   10125          200            200            0.0024693566   3.9891274e-36  0              0.0074080697   6.3997245e-08  0              0.0061803958   1.1965779e-13  0              2.9972764    
   1800000   10125          200            200            0.0024693535  -9.9727367e-36  0              0.0074080605   5.2466912e-10  0              5.0668788e-05  1.1965779e-13  0              2.9972764    
   1900000   10125          200            200            0.0024693593  -9.9725264e-37  0              0.0074080778   7.1558727e-10  0              6.9106296e-05  1.1965779e-13  0              2.9972764    
   2000000   10125          200            200            0.0024693615   1.9945754e-36  0              0.0074080845   1.3519659e-10  0              1.3056319e-05  1.1965779e-13  0              2.9972764    
   2100000   10125          200            200            0.0024693614  -4.9861469e-37  0              0.0074080843   1.2390768e-14  0              1.1966117e-09  1.1965779e-13  0              2.9972764    
   2200000   10125          200            200            0.0024693611   1.7452564e-36  0              0.0074080834   2.3417603e-12  0              2.2615045e-07  1.1965779e-13  0              2.9972764    
   2300000   10125          200            200            0.002469361   -6.2306366e-38  0              0.0074080831   2.537391e-13   0              2.4504306e-08  1.1965779e-13  0              2.9972764    
   2400000   10125          200            200            0.002469361    6.2332096e-37  0              0.0074080831   1.9259466e-15  0              1.8599414e-10  1.1965779e-13  0              2.9972764    
   2500000   10125          200            200            0.0024693611  -6.4822706e-36  0              0.0074080832   6.726271e-15   0              6.4957511e-10  1.1965779e-13  0              2.9972764    
   2600000   10125          200            200            0.0024693611   2.3376123e-41  0              0.0074080832   3.8201505e-16  0              3.689228e-11   1.1965779e-13  0              2.9972764    
   2700000   10125          200            200            0.0024693611   2.9918514e-36  0              0.0074080832   3.4738029e-18  0              3.3547502e-13  1.1965779e-13  0              2.9972764    
   2800000   10125          200            200            0.0024693611  -6.9809085e-36  0              0.0074080832   1.2103098e-17  0              1.1688305e-12  1.1965779e-13  0              2.9972764    
   2900000   10125          200            200            0.0024693611   2.9918516e-36  0              0.0074080832   1.6818405e-19  0              1.6242012e-14  1.1965779e-13  0              2.9972764    
   3000000   10125          200            200            0.0024693611   7.9782315e-36  0              0.0074080832   3.8134706e-19  0              3.682777e-14   1.1965779e-13  0              2.9972764    
Loop time of 301.959 on 4 procs for 3000000 steps with 2501 atoms

Performance: 8583937.639 ns/day, 0.000 hours/ns, 9935.113 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 11.079     | 38.217     | 65.776     | 435.3 | 12.66
Neigh   | 6.3302     | 6.4524     | 6.5781     |   4.4 |  2.14
Comm    | 23.373     | 42.711     | 83.088     | 361.0 | 14.14
Output  | 0.2717     | 0.27203    | 0.27234    |   0.1 |  0.09
Modify  | 109.31     | 158.01     | 177.26     | 224.5 | 52.33
Other   |            | 56.29      |            |       | 18.64

Nlocal:         625.25 ave         876 max         375 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:           1.75 ave           3 max           1 min
Histogram: 2 0 0 0 0 1 0 0 0 1
Neighs:         333.25 ave         667 max           0 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 1333
Ave neighs/atom = 0.53298681
Neighbor list builds = 166
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 76

#variable lat0 equal 1                    #
variable lat1 equal 3+(300*0.01)+(v_ind*0.01)  # .491+(v_ind*0.001)       # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 500*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 6.76                                                               
Lattice spacing in x,y,z = 6.76 6.76 6.76

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -5070 ${n1e1} -100 100 -100 100 units box
region box block -5070 5070 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -5070 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -5070 5070 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-5070 -100 -100) to (5070 100 100)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 1500 atoms
  using lattice units in orthogonal box = (-5070 -100 -100) to (5070 100 100)
  create_atoms CPU = 0.000 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 1500 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 1001 atoms
  using lattice units in orthogonal box = (-5070 -100 -100) to (5070 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  1500 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  1500 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  1001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  1001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
1500 atoms in group substrate
group slider1 region slider1
1001 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 1001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_76_*.dump id type diameter mass xu yu zu fx fy fz

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 6542 130 130
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 126.9 | 126.9 | 126.9 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   10140          200            200            0              0              0              0              0              0              0              1.1965779e-13  0              6            
    100000   10140          200            200            0.001987298    1.9916064e-36  0              0.0059618941   577263.86      0              5.5748011e+10  1.1965779e-13  0              3.3326049    
    200000   10140          200            200            0.00066775984 -1.5932513e-35  0              0.0020032795   129398.95      0              1.2496424e+10  1.1965779e-13  0              3.0847333    
    300000   10140          200            200           -1.4201208e-05  7.1983321e-40  0             -4.2603623e-05  132.52005      0              12797838       1.1965779e-13  0              3.0432691    
    400000   10140          200            200           -2.7283505e-05 -7.966338e-36   0             -8.1850514e-05  519.46056      0              50165782       1.1965779e-13  0              3.0046838    
    500000   10140          200            200           -0.001035189   -0.012746618    0              0.0096410506   1262.6546      0              1.2193815e+08  1.1965779e-13  0              2.9929478    
    600000   10140          200            200           -0.00064294743 -0.0077479579   0              0.0058191156   114.92719      0              11098845       1.1965779e-13  0              2.9945418    
    700000   10140          200            200           -0.00048415435 -0.008067723    0              0.0066152599   7.300181       0              704999.23      1.1965779e-13  0              2.9942076    
    800000   10140          200            200           -0.00026872967 -0.0083851698   0              0.0075789808   2.3754239      0              229401.44      1.1965779e-13  0              2.9937964    
    900000   10140          200            200           -0.00029217152 -0.0083695648   0              0.0074930502   0.14263744     0              13774.903      1.1965779e-13  0              2.9938291    
   1000000   10140          200            200           -0.00032692945 -0.0083424087   0              0.0073616203   0.04098654     0              3958.1866      1.1965779e-13  0              2.9938841    
   1100000   10140          200            200           -0.00032333077 -0.0083450215   0              0.0073750292   0.0028713158   0              277.29113      1.1965779e-13  0              2.9938789    
   1200000   10140          200            200           -0.00031871249 -0.0083487043   0              0.0073925668   0.00070777196  0              68.35155       1.1965779e-13  0              2.9938715    
   1300000   10140          200            200           -0.00031926126 -0.0083483051   0              0.0073905213   5.7674058e-05  0              5.5697477      1.1965779e-13  0              2.9938723    
   1400000   10140          200            200           -0.00031987735 -0.0083478145   0              0.0073881824   1.2153039e-05  0              1.1736535      1.1965779e-13  0              2.9938733    
   1500000   10140          200            200           -0.00031979493 -0.0083478751   0              0.0073884903   1.1495076e-06  0              0.11101122     1.1965779e-13  0              2.9938732    
   1600000   10140          200            200           -0.00031971292 -0.0083479405   0              0.0073888017   2.0775947e-07  0              0.020063923    1.1965779e-13  0              2.9938731    
   1700000   10140          200            200           -0.00031972516 -0.0083479314   0              0.0073887559   2.2763207e-08  0              0.0021983076   1.1965779e-13  0              2.9938731    
   1800000   10140          200            200           -0.00031973606 -0.0083479227   0              0.0073887145   3.5343232e-09  0              0.00034131963  1.1965779e-13  0              2.9938731    
   1900000   10140          200            200           -0.00031973426 -0.0083479241   0              0.0073887213   4.4805305e-10  0              4.3269756e-05  1.1965779e-13  0              2.9938731    
   2000000   10140          200            200           -0.00031973281 -0.0083479252   0              0.0073887268   5.9805763e-11  0              5.7756125e-06  1.1965779e-13  0              2.9938731    
   2100000   10140          200            200           -0.00031973308 -0.008347925    0              0.0073887258   8.7696736e-12  0              8.469123e-07   1.1965779e-13  0              2.9938731    
   2200000   10140          200            200           -0.00031973327 -0.0083479249   0              0.0073887251   1.0070207e-12  0              9.7250849e-08  1.1965779e-13  0              2.9938731    
   2300000   10140          200            200           -0.00031973323 -0.0083479249   0              0.0073887252   1.7088169e-13  0              1.6502531e-08  1.1965779e-13  0              2.9938731    
   2400000   10140          200            200           -0.00031973321 -0.0083479249   0              0.0073887253   1.6824074e-14  0              1.6247487e-09  1.1965779e-13  0              2.9938731    
   2500000   10140          200            200           -0.00031973321 -0.0083479249   0              0.0073887253   3.2166972e-15  0              3.1064559e-10  1.1965779e-13  0              2.9938731    
   2600000   10140          200            200           -0.00031973321 -0.0083479249   0              0.0073887253   2.9156592e-16  0              2.8157349e-11  1.1965779e-13  0              2.9938731    
   2700000   10140          200            200           -0.00031973321 -0.0083479249   0              0.0073887253   7.6973024e-17  0              7.4335037e-12  1.1965779e-13  0              2.9938731    
   2800000   10140          200            200           -0.00031973321 -0.0083479249   0              0.0073887253   1.1281125e-18  0              1.0894503e-13  1.1965779e-13  0              2.9938731    
   2900000   10140          200            200           -0.00031973321 -0.0083479249   0              0.0073887253   4.5176254e-19  0              4.3627992e-14  1.1965779e-13  0              2.9938731    
   3000000   10140          200            200           -0.00031973322 -0.0083479249   0              0.0073887253   9.6423231e-19  0              9.3118655e-14  1.1965779e-13  0              2.9938731    
Loop time of 298.638 on 4 procs for 3000000 steps with 2501 atoms

Performance: 8679404.675 ns/day, 0.000 hours/ns, 10045.607 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 11.258     | 35.734     | 60.529     | 408.1 | 11.97
Neigh   | 6.3561     | 6.4723     | 6.5931     |   4.3 |  2.17
Comm    | 22.784     | 42.528     | 79.98      | 338.7 | 14.24
Output  | 0.27732    | 0.27762    | 0.27794    |   0.1 |  0.09
Modify  | 109.09     | 157.29     | 176.87     | 223.9 | 52.67
Other   |            | 56.34      |            |       | 18.87

Nlocal:         625.25 ave         876 max         375 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:           1.75 ave           3 max           1 min
Histogram: 2 0 0 0 0 1 0 0 0 1
Neighs:         307.75 ave         616 max           0 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 1231
Ave neighs/atom = 0.49220312
Neighbor list builds = 166
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 77

#variable lat0 equal 1                    #
variable lat1 equal 3+(300*0.01)+(v_ind*0.01)  # .491+(v_ind*0.001)       # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 500*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 6.77                                                               
Lattice spacing in x,y,z = 6.77 6.77 6.77

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -5077.5 ${n1e1} -100 100 -100 100 units box
region box block -5077.5 5077.5 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -5077.5 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -5077.5 5077.5 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-5077.5 -100 -100) to (5077.5 100 100)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 1500 atoms
  using lattice units in orthogonal box = (-5077.5 -100 -100) to (5077.5 100 100)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 1500 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 1001 atoms
  using lattice units in orthogonal box = (-5077.5 -100 -100) to (5077.5 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  1500 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  1500 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  1001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  1001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
1500 atoms in group substrate
group slider1 region slider1
1001 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 1001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_77_*.dump id type diameter mass xu yu zu fx fy fz

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 6552 130 130
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 127.1 | 127.1 | 127.1 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   10155          200            200            0              0              0              0              0              0              0              1.1965779e-13  0              6            
    100000   10155          200            200            0.0019838592   1.1931973e-35  0              0.0059515776   577054.56      0              5.5727799e+10  1.1965779e-13  0              3.3326953    
    200000   10155          200            200            0.00066569972 -3.1818377e-35  0              0.0019970992   129076.38      0              1.2465273e+10  1.1965779e-13  0              3.0848857    
    300000   10155          200            200           -1.5940768e-05  9.5456211e-35  0             -4.7822303e-05  168.28096      0              16251370       1.1965779e-13  0              3.0430486    
    400000   10155          200            200           -3.2694452e-05  2.2799053e-41  0             -9.8083356e-05  758.67752      0              73267645       1.1965779e-13  0              3.0043072    
    500000   10155          200            200            0.0032187279  -0.0038449532   0              0.013501137    520.17666      0              50234938       1.1965779e-13  0              2.9915486    
    600000   10155          200            200            0.0022642647  -0.0017184442   0              0.0085112382   150.46427      0              14530762       1.1965779e-13  0              2.9932804    
    700000   10155          200            200            0.0018688281  -0.0010423094   0              0.0066487936   9.5654386      0              923761.59      1.1965779e-13  0              2.9940649    
    800000   10155          200            200            0.0019981151  -0.0011605603   0              0.0071549056   1.8988261      0              183375.04      1.1965779e-13  0              2.9938531    
    900000   10155          200            200            0.0020981627  -0.0011805849   0              0.0074750732   0.18722481     0              18080.832      1.1965779e-13  0              2.9937171    
   1000000   10155          200            200            0.002076126   -0.0011777319   0              0.0074061098   0.037212658    0              3593.7321      1.1965779e-13  0              2.9937449    
   1100000   10155          200            200            0.0020629491  -0.0011750461   0              0.0073638935   0.0030238839   0              292.02507      1.1965779e-13  0              2.9937628    
   1200000   10155          200            200            0.0020660812  -0.001175658    0              0.0073739017   0.00072674405  0              70.183739      1.1965779e-13  0              2.9937587    
   1300000   10155          200            200            0.0020678057  -0.0011760107   0              0.0073794278   4.8408432e-05  0              4.6749399      1.1965779e-13  0              2.9937564    
   1400000   10155          200            200            0.0020673532  -0.0011759222   0              0.0073779818   1.412156e-05   0              1.3637592      1.1965779e-13  0              2.993757     
   1500000   10155          200            200            0.0020671283  -0.0011758762   0              0.0073772611   7.6380621e-07  0              0.073762937    1.1965779e-13  0              2.9937573    
   1600000   10155          200            200            0.0020671932  -0.0011758889   0              0.0073774686   2.7262112e-07  0              0.026327797    1.1965779e-13  0              2.9937572    
   1700000   10155          200            200            0.0020672225  -0.0011758949   0              0.0073775623   1.186418e-08   0              0.0011457576   1.1965779e-13  0              2.9937571    
   1800000   10155          200            200            0.0020672132  -0.0011758931   0              0.0073775327   5.2318006e-09  0              0.00050524986  1.1965779e-13  0              2.9937571    
   1900000   10155          200            200            0.0020672094  -0.0011758923   0              0.0073775206   1.8090483e-10  0              1.7470493e-05  1.1965779e-13  0              2.9937572    
   2000000   10155          200            200            0.0020672107  -0.0011758926   0              0.0073775248   9.9830166e-11  0              9.6408829e-06  1.1965779e-13  0              2.9937572    
   2100000   10155          200            200            0.0020672112  -0.0011758927   0              0.0073775263   2.6979641e-12  0              2.6055006e-07  1.1965779e-13  0              2.9937572    
   2200000   10155          200            200            0.002067211   -0.0011758926   0              0.0073775257   1.8943522e-12  0              1.8294297e-07  1.1965779e-13  0              2.9937572    
   2300000   10155          200            200            0.002067211   -0.0011758926   0              0.0073775255   3.8845874e-14  0              3.7514565e-09  1.1965779e-13  0              2.9937572    
   2400000   10155          200            200            0.002067211   -0.0011758926   0              0.0073775256   3.5808571e-14  0              3.4581355e-09  1.1965779e-13  0              2.9937572    
   2500000   10155          200            200            0.002067211   -0.0011758926   0              0.0073775256   5.5461838e-16  0              5.3561073e-11  1.1965779e-13  0              2.9937572    
   2600000   10155          200            200            0.002067211   -0.0011758926   0              0.0073775256   6.7712134e-16  0              6.5391533e-11  1.1965779e-13  0              2.9937572    
   2700000   10155          200            200            0.002067211   -0.0011758926   0              0.0073775256   6.6203631e-19  0              6.3934728e-14  1.1965779e-13  0              2.9937572    
   2800000   10155          200            200            0.002067211   -0.0011758926   0              0.0073775256   1.2963431e-17  0              1.2519153e-12  1.1965779e-13  0              2.9937572    
   2900000   10155          200            200            0.002067211   -0.0011758926   0              0.0073775256   4.5961179e-19  0              4.4386017e-14  1.1965779e-13  0              2.9937572    
   3000000   10155          200            200            0.002067211   -0.0011758926   0              0.0073775256   2.9524842e-19  0              2.8512979e-14  1.1965779e-13  0              2.9937572    
Loop time of 300.222 on 4 procs for 3000000 steps with 2501 atoms

Performance: 8633601.219 ns/day, 0.000 hours/ns, 9992.594 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 11.289     | 35.884     | 61.172     | 409.1 | 11.95
Neigh   | 6.3709     | 6.4885     | 6.6109     |   4.3 |  2.16
Comm    | 22.764     | 43.125     | 81.211     | 342.4 | 14.36
Output  | 0.27298    | 0.27328    | 0.27361    |   0.1 |  0.09
Modify  | 109.24     | 157.95     | 177.86     | 225.6 | 52.61
Other   |            | 56.5       |            |       | 18.82

Nlocal:         625.25 ave         876 max         375 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:           1.75 ave           3 max           1 min
Histogram: 2 0 0 0 0 1 0 0 0 1
Neighs:         307.75 ave         616 max           0 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 1231
Ave neighs/atom = 0.49220312
Neighbor list builds = 166
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 78

#variable lat0 equal 1                    #
variable lat1 equal 3+(300*0.01)+(v_ind*0.01)  # .491+(v_ind*0.001)       # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 500*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 6.78                                                               
Lattice spacing in x,y,z = 6.78 6.78 6.78

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -5085 ${n1e1} -100 100 -100 100 units box
region box block -5085 5085 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -5085 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -5085 5085 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-5085 -100 -100) to (5085 100 100)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 1500 atoms
  using lattice units in orthogonal box = (-5085 -100 -100) to (5085 100 100)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 1500 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 1001 atoms
  using lattice units in orthogonal box = (-5085 -100 -100) to (5085 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  1500 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  1500 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  1001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  1001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
1500 atoms in group substrate
group slider1 region slider1
1001 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 1001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_78_*.dump id type diameter mass xu yu zu fx fy fz

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 6562 130 130
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 127.2 | 127.3 | 127.3 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   10170          200            200            0              0              0              0              0              0              0              1.1965779e-13  0              6            
    100000   10170          200            200            0.0019811109   7.9429195e-36  0              0.0059433328   577128.71      0              5.573496e+10   1.1965779e-13  0              3.3326623    
    200000   10170          200            200            0.00066507865 -2.978589e-36   0              0.0019952359   129184.65      0              1.2475728e+10  1.1965779e-13  0              3.0848403    
    300000   10170          200            200           -1.5344973e-05  4.0785989e-40  0             -4.6034918e-05  156.15328      0              15080166       1.1965779e-13  0              3.0431303    
    400000   10170          200            200           -3.0862122e-05  6.3543549e-35  0             -9.2586367e-05  674.90807      0              65177791       1.1965779e-13  0              3.0044461    
    500000   10170          200            200            0.0034946815  -0.0021037961   0              0.012587841    755.12294      0              72924369       1.1965779e-13  0              2.9919       
    600000   10170          200            200            0.0024992646   0.00049532244  0              0.0070024712   186.11169      0              17973335       1.1965779e-13  0              2.9939151    
    700000   10170          200            200            0.0025675643   0.00054217368  0              0.0071605191   24.139266      0              2331197.5      1.1965779e-13  0              2.9938779    
    800000   10170          200            200            0.002588754    0.00038282251  0              0.0073834393   3.3775228      0              326176.98      1.1965779e-13  0              2.9937767    
    900000   10170          200            200            0.0025970091   0.00040702497  0              0.0073840023   0.44939236     0              43399.098      1.1965779e-13  0              2.9937802    
   1000000   10170          200            200            0.0025864248   0.00040826588  0              0.0073510084   0.05515735     0              5326.7021      1.1965779e-13  0              2.9937922    
   1100000   10170          200            200            0.0025942992   0.00040727918  0              0.0073756183   0.0061983314   0              598.59048      1.1965779e-13  0              2.9937827    
   1200000   10170          200            200            0.0025900773   0.00040781466  0              0.0073624173   0.00062301843  0              60.16666       1.1965779e-13  0              2.9937879    
   1300000   10170          200            200            0.0025920561   0.00040755977  0              0.0073686085   5.4027053e-05  0              5.2175461      1.1965779e-13  0              2.9937854    
   1400000   10170          200            200            0.0025912012   0.00040767038  0              0.0073659333   3.6977023e-06  0              0.35709762     1.1965779e-13  0              2.9937865    
   1500000   10170          200            200            0.0025915496   0.00040762502  0              0.0073670238   1.5415931e-07  0              0.014887602    1.1965779e-13  0              2.9937861    
   1600000   10170          200            200            0.0025914141   0.00040764273  0              0.0073665997   5.3783789e-10  0              5.1940534e-05  1.1965779e-13  0              2.9937862    
   1700000   10170          200            200            0.0025914646   0.0004076361   0              0.0073667578   1.3161101e-09  0              0.0001271005   1.1965779e-13  0              2.9937862    
   1800000   10170          200            200            0.0025914466   0.00040763848  0              0.0073667012   8.5522793e-10  0              8.2591792e-05  1.1965779e-13  0              2.9937862    
   1900000   10170          200            200            0.0025914528   0.00040763766  0              0.0073667206   2.6105546e-10  0              2.5210868e-05  1.1965779e-13  0              2.9937862    
   2000000   10170          200            200            0.0025914507   0.00040763793  0              0.0073667143   5.9061383e-11  0              5.7037256e-06  1.1965779e-13  0              2.9937862    
   2100000   10170          200            200            0.0025914514   0.00040763784  0              0.0073667162   1.1241637e-11  0              1.0856369e-06  1.1965779e-13  0              2.9937862    
   2200000   10170          200            200            0.0025914512   0.00040763787  0              0.0073667157   1.8952483e-12  0              1.8302951e-07  1.1965779e-13  0              2.9937862    
   2300000   10170          200            200            0.0025914512   0.00040763786  0              0.0073667158   2.9002807e-13  0              2.8008836e-08  1.1965779e-13  0              2.9937862    
   2400000   10170          200            200            0.0025914512   0.00040763786  0              0.0073667158   4.0811837e-14  0              3.9413151e-09  1.1965779e-13  0              2.9937862    
   2500000   10170          200            200            0.0025914512   0.00040763786  0              0.0073667158   5.3039139e-15  0              5.1221404e-10  1.1965779e-13  0              2.9937862    
   2600000   10170          200            200            0.0025914512   0.00040763786  0              0.0073667158   6.2891092e-16  0              6.0735715e-11  1.1965779e-13  0              2.9937862    
   2700000   10170          200            200            0.0025914512   0.00040763786  0              0.0073667158   5.0005528e-17  0              4.8291759e-12  1.1965779e-13  0              2.9937862    
   2800000   10170          200            200            0.0025914512   0.00040763786  0              0.0073667158   1.4223102e-18  0              1.3735654e-13  1.1965779e-13  0              2.9937862    
   2900000   10170          200            200            0.0025914512   0.00040763786  0              0.0073667158   3.4374623e-18  0              3.3196551e-13  1.1965779e-13  0              2.9937862    
   3000000   10170          200            200            0.0025914512   0.00040763787  0              0.0073667158   1.2474636e-18  0              1.2047111e-13  1.1965779e-13  0              2.9937862    
Loop time of 297.733 on 4 procs for 3000000 steps with 2501 atoms

Performance: 8705788.302 ns/day, 0.000 hours/ns, 10076.144 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 11.157     | 36.069     | 61.199     | 411.3 | 12.11
Neigh   | 6.2586     | 6.3676     | 6.4816     |   4.0 |  2.14
Comm    | 23.167     | 41.165     | 78.071     | 336.7 | 13.83
Output  | 0.27006    | 0.27036    | 0.27069    |   0.1 |  0.09
Modify  | 109.48     | 157.18     | 177.91     | 222.6 | 52.79
Other   |            | 56.68      |            |       | 19.04

Nlocal:         625.25 ave         876 max         375 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:           1.75 ave           3 max           1 min
Histogram: 2 0 0 0 0 1 0 0 0 1
Neighs:         309.75 ave         620 max           0 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 1239
Ave neighs/atom = 0.49540184
Neighbor list builds = 166
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 79

#variable lat0 equal 1                    #
variable lat1 equal 3+(300*0.01)+(v_ind*0.01)  # .491+(v_ind*0.001)       # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 500*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 6.79                                                               
Lattice spacing in x,y,z = 6.79 6.79 6.79

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -5092.5 ${n1e1} -100 100 -100 100 units box
region box block -5092.5 5092.5 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -5092.5 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -5092.5 5092.5 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-5092.5 -100 -100) to (5092.5 100 100)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 1500 atoms
  using lattice units in orthogonal box = (-5092.5 -100 -100) to (5092.5 100 100)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 1500 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 1001 atoms
  using lattice units in orthogonal box = (-5092.5 -100 -100) to (5092.5 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  1500 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  1500 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  1001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  1001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
1500 atoms in group substrate
group slider1 region slider1
1001 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 1001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_79_*.dump id type diameter mass xu yu zu fx fy fz

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 6571 130 130
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 127.4 | 127.4 | 127.4 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   10185          200            200            0              0              0              0              0              0              0              1.1965779e-13  0              6            
    100000   10185          200            200            0.0019783253  -4.9570045e-37  0              0.005934976    577181.09      0              5.5740019e+10  1.1965779e-13  0              3.3326606    
    200000   10185          200            200            0.00066439728  1.9828025e-36  0              0.0019931918   129274         0              1.2484358e+10  1.1965779e-13  0              3.0848087    
    300000   10185          200            200           -1.4514509e-05  1.2690293e-34  0             -4.3543527e-05  139.81129      0              13501974       1.1965779e-13  0              3.0432079    
    400000   10185          200            200           -2.9483054e-05 -3.1724156e-35  0             -8.8449163e-05  615.64023      0              59454127       1.1965779e-13  0              3.0045429    
    500000   10185          200            200            0.0042922118  -0.00043294454  0              0.01330958     537.13812      0              51872954       1.1965779e-13  0              2.9916719    
    600000   10185          200            200            0.0032641236  -7.5141129e-06  0              0.0097998848   26.070125      0              2517666.1      1.1965779e-13  0              2.9928916    
    700000   10185          200            200            0.0026882579   7.5207272e-05  0              0.0079895663   13.23803       0              1278434.2      1.1965779e-13  0              2.9936019    
    800000   10185          200            200            0.0024605423  -4.4618279e-05  0              0.0074262452   3.1916667      0              308228.32      1.1965779e-13  0              2.9938405    
    900000   10185          200            200            0.0024167472  -5.991044e-05   0              0.0073101521   0.39306986     0              37959.873      1.1965779e-13  0              2.9938919    
   1000000   10185          200            200            0.0024195197  -5.957075e-05   0              0.00731813     0.019441414    0              1877.5127      1.1965779e-13  0              2.9938893    
   1100000   10185          200            200            0.0024267337  -5.9091846e-05  0              0.007339293    2.1010617e-07  0              0.02029055     1.1965779e-13  0              2.9938804    
   1200000   10185          200            200            0.0024306886  -5.899788e-05   0              0.0073510638   0.00036522891  0              35.271194      1.1965779e-13  0              2.9938754    
   1300000   10185          200            200            0.002432117   -5.8966616e-05  0              0.0073553176   0.00013173246  0              12.721779      1.1965779e-13  0              2.9938736    
   1400000   10185          200            200            0.0024324458  -5.8959512e-05  0              0.0073562968   1.8925247e-05  0              1.8276649      1.1965779e-13  0              2.9938732    
   1500000   10185          200            200            0.0024324516  -5.8959308e-05  0              0.007356314    1.1612184e-06  0              0.11214216     1.1965779e-13  0              2.9938732    
   1600000   10185          200            200            0.0024324107  -5.8960138e-05  0              0.0073561922   4.0374696e-09  0              0.00038990991  1.1965779e-13  0              2.9938732    
   1700000   10185          200            200            0.0024323852  -5.8960667e-05  0              0.0073561163   1.1459708e-08  0              0.0011066966   1.1965779e-13  0              2.9938732    
   1800000   10185          200            200            0.0024323754  -5.8960874e-05  0              0.007356087    5.3588307e-09  0              0.00051751751  1.1965779e-13  0              2.9938732    
   1900000   10185          200            200            0.0024323729  -5.8960928e-05  0              0.0073560795   8.8504991e-10  0              8.5471785e-05  1.1965779e-13  0              2.9938733    
   2000000   10185          200            200            0.0024323727  -5.8960932e-05  0              0.0073560789   6.5328147e-11  0              6.3089248e-06  1.1965779e-13  0              2.9938733    
   2100000   10185          200            200            0.0024323729  -5.8960928e-05  0              0.0073560796   7.4852356e-13  0              7.2287048e-08  1.1965779e-13  0              2.9938733    
   2200000   10185          200            200            0.002432373   -5.8960924e-05  0              0.0073560801   3.2326303e-13  0              3.121843e-08   1.1965779e-13  0              2.9938733    
   2300000   10185          200            200            0.0024323731  -5.8960923e-05  0              0.0073560803   2.1165125e-13  0              2.0439763e-08  1.1965779e-13  0              2.9938733    
   2400000   10185          200            200            0.0024323731  -5.8960923e-05  0              0.0073560803   4.0333466e-14  0              3.8951174e-09  1.1965779e-13  0              2.9938733    
   2500000   10185          200            200            0.0024323731  -5.8960923e-05  0              0.0073560803   3.5237811e-15  0              3.4030156e-10  1.1965779e-13  0              2.9938733    
   2600000   10185          200            200            0.0024323731  -5.8960923e-05  0              0.0073560803   7.934702e-17   0              7.6627673e-12  1.1965779e-13  0              2.9938733    
   2700000   10185          200            200            0.0024323731  -5.8960923e-05  0              0.0073560803   2.0150643e-17  0              1.9460049e-12  1.1965779e-13  0              2.9938733    
   2800000   10185          200            200            0.0024323731  -5.8960923e-05  0              0.0073560803   1.1107865e-17  0              1.0727181e-12  1.1965779e-13  0              2.9938733    
   2900000   10185          200            200            0.0024323731  -5.8960923e-05  0              0.0073560803   4.9227878e-18  0              4.7540761e-13  1.1965779e-13  0              2.9938733    
   3000000   10185          200            200            0.0024323731  -5.8960924e-05  0              0.0073560803   5.0013216e-18  0              4.8299185e-13  1.1965779e-13  0              2.9938733    
Loop time of 297.31 on 4 procs for 3000000 steps with 2501 atoms

Performance: 8718172.459 ns/day, 0.000 hours/ns, 10090.477 timesteps/s
99.9% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 11.031     | 35.671     | 60.781     | 408.4 | 12.00
Neigh   | 6.4046     | 6.5251     | 6.6484     |   4.3 |  2.19
Comm    | 22.995     | 41.169     | 77.96      | 335.9 | 13.85
Output  | 0.27151    | 0.27181    | 0.27214    |   0.1 |  0.09
Modify  | 109.64     | 157.38     | 177.4      | 222.6 | 52.93
Other   |            | 56.3       |            |       | 18.94

Nlocal:         625.25 ave         876 max         375 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:           1.75 ave           3 max           1 min
Histogram: 2 0 0 0 0 1 0 0 0 1
Neighs:         308.25 ave         617 max           0 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 1233
Ave neighs/atom = 0.4930028
Neighbor list builds = 166
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 80

#variable lat0 equal 1                    #
variable lat1 equal 3+(300*0.01)+(v_ind*0.01)  # .491+(v_ind*0.001)       # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 500*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 6.8                                                               
Lattice spacing in x,y,z = 6.8 6.8 6.8

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -5100 ${n1e1} -100 100 -100 100 units box
region box block -5100 5100 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -5100 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -5100 5100 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-5100 -100 -100) to (5100 100 100)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 1500 atoms
  using lattice units in orthogonal box = (-5100 -100 -100) to (5100 100 100)
  create_atoms CPU = 0.000 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 1500 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 1001 atoms
  using lattice units in orthogonal box = (-5100 -100 -100) to (5100 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  1500 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  1500 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  1001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  1001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
1500 atoms in group substrate
group slider1 region slider1
1001 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 1001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_80_*.dump id type diameter mass xu yu zu fx fy fz

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 6581 130 130
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 127.6 | 127.6 | 127.7 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   10200          200            200            0              0              0              0              0              0              0              1.1965779e-13  0              6            
    100000   10200          200            200            0.0019751297   3.9597888e-36  0              0.0059253891   577057.62      0              5.5728094e+10  1.1965779e-13  0              3.332744     
    200000   10200          200            200            0.00066157964  5.3456933e-35  0              0.0019847389   128704.88      0              1.2429396e+10  1.1965779e-13  0              3.0853962    
    300000   10200          200            200           -1.5210056e-05  4.2324659e-40  0             -4.5630167e-05  154.28259      0              14899508       1.1965779e-13  0              3.043192     
    400000   10200          200            200           -1.9424926e-05  1.5839355e-35  0             -5.8274779e-05  261.24257      0              25228937       1.1965779e-13  0              3.0048271    
    500000   10200          200            200            0.0023304451   9.5034722e-35  0              0.0069913352   1293.0269      0              1.2487128e+08  1.1965779e-13  0              2.9936364    
    600000   10200          200            200            0.0020646246   1.6207463e-40  0              0.0061938738   111.94761      0              10811098       1.1965779e-13  0              2.9940771    
    700000   10200          200            200            0.0024797145   6.4165807e-06  0              0.007432727    22.055192      0              2129932.6      1.1965779e-13  0              2.9932771    
    800000   10200          200            200            0.0023722852  -1.583897e-35   0              0.0071168556   0.84414881     0              81521.85       1.1965779e-13  0              2.9934719    
    900000   10200          200            200            0.0024330224   1.9799756e-36  0              0.0072990673   0.31345962     0              30271.687      1.1965779e-13  0              2.9933616    
   1000000   10200          200            200            0.0024602113   5.5641714e-07  0              0.0073800775   0.00087634193  0              84.630831      1.1965779e-13  0              2.9933143    
   1100000   10200          200            200            0.0024441908   7.9196052e-36  0              0.0073325723   0.0016587541   0              160.1906       1.1965779e-13  0              2.9933426    
   1200000   10200          200            200            0.0024491449  -1.5839036e-35  0              0.0073474348   0.00044081545  0              42.5708        1.1965779e-13  0              2.9933335    
   1300000   10200          200            200            0.0024476625   1.5839142e-35  0              0.0073429876   8.9935243e-05  0              8.6853021      1.1965779e-13  0              2.9933362    
   1400000   10200          200            200            0.0024480514   3.9597776e-35  0              0.0073441543   1.5472599e-05  0              1.4942328      1.1965779e-13  0              2.9933355    
   1500000   10200          200            200            0.0024479741  -7.9194929e-36  0              0.0073439222   2.3309826e-06  0              0.22510961     1.1965779e-13  0              2.9933357    
   1600000   10200          200            200            0.0024479768  -7.9194929e-36  0              0.0073439303   3.1190873e-07  0              0.030121913    1.1965779e-13  0              2.9933356    
   1700000   10200          200            200            0.0024479853   5.196453e-41   0              0.0073439559   3.7028198e-08  0              0.0035759183   1.1965779e-13  0              2.9933356    
   1800000   10200          200            200            0.0024479788   3.1678231e-35  0              0.0073439365   3.8339191e-09  0              0.00037025246  1.1965779e-13  0              2.9933356    
   1900000   10200          200            200            0.0024479823   1.5839141e-35  0              0.0073439469   3.3148146e-10  0              3.2012107e-05  1.1965779e-13  0              2.9933356    
   2000000   10200          200            200            0.0024479807   4.7517321e-35  0              0.0073439421   2.1462346e-11  0              2.0726797e-06  1.1965779e-13  0              2.9933356    
   2100000   10200          200            200            0.0024479814   5.1918187e-41  0              0.0073439441   7.1921751e-13  0              6.9456879e-08  1.1965779e-13  0              2.9933356    
   2200000   10200          200            200            0.0024479811   1.5839142e-35  0              0.0073439433   4.0922782e-16  0              3.9520293e-11  1.1965779e-13  0              2.9933356    
   2300000   10200          200            200            0.0024479812   1.5839141e-35  0              0.0073439436   1.6573335e-14  0              1.6005341e-09  1.1965779e-13  0              2.9933356    
   2400000   10200          200            200            0.0024479812   4.7517321e-35  0              0.0073439435   7.9651519e-15  0              7.6921736e-10  1.1965779e-13  0              2.9933356    
   2500000   10200          200            200            0.0024479812   3.1678231e-35  0              0.0073439436   2.2027085e-15  0              2.1272182e-10  1.1965779e-13  0              2.9933356    
   2600000   10200          200            200            0.0024479812   5.1926039e-41  0              0.0073439436   4.6422353e-16  0              4.4831386e-11  1.1965779e-13  0              2.9933356    
   2700000   10200          200            200            0.0024479812   3.1678231e-35  0              0.0073439436   8.6578077e-17  0              8.361091e-12   1.1965779e-13  0              2.9933356    
   2800000   10200          200            200            0.0024479812   5.1629526e-41  0              0.0073439436   1.2153763e-17  0              1.1737235e-12  1.1965779e-13  0              2.9933356    
   2900000   10200          200            200            0.0024479812   2.5342548e-34  0              0.0073439436   6.8146408e-18  0              6.5810923e-13  1.1965779e-13  0              2.9933356    
   3000000   10200          200            200            0.0024479812  -6.3356304e-35  0              0.0073439436   5.8191519e-18  0              5.6197204e-13  1.1965779e-13  0              2.9933356    
Loop time of 295.517 on 4 procs for 3000000 steps with 2501 atoms

Performance: 8771070.468 ns/day, 0.000 hours/ns, 10151.702 timesteps/s
99.9% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 11.486     | 34.682     | 58.941     | 393.4 | 11.74
Neigh   | 6.3965     | 6.5205     | 6.648      |   4.5 |  2.21
Comm    | 23.126     | 41.083     | 76.363     | 323.3 | 13.90
Output  | 0.27298    | 0.27328    | 0.27358    |   0.1 |  0.09
Modify  | 109.16     | 156.39     | 177.83     | 222.2 | 52.92
Other   |            | 56.57      |            |       | 19.14

Nlocal:         625.25 ave         876 max         375 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:           1.75 ave           3 max           1 min
Histogram: 2 0 0 0 0 1 0 0 0 1
Neighs:         301.25 ave         603 max           0 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 1205
Ave neighs/atom = 0.48180728
Neighbor list builds = 166
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 81

#variable lat0 equal 1                    #
variable lat1 equal 3+(300*0.01)+(v_ind*0.01)  # .491+(v_ind*0.001)       # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 500*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 6.81                                                               
Lattice spacing in x,y,z = 6.81 6.81 6.81

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -5107.5 ${n1e1} -100 100 -100 100 units box
region box block -5107.5 5107.5 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -5107.5 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -5107.5 5107.5 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-5107.5 -100 -100) to (5107.5 100 100)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 1500 atoms
  using lattice units in orthogonal box = (-5107.5 -100 -100) to (5107.5 100 100)
  create_atoms CPU = 0.000 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 1500 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 1001 atoms
  using lattice units in orthogonal box = (-5107.5 -100 -100) to (5107.5 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  1500 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  1500 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  1001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  1001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
1500 atoms in group substrate
group slider1 region slider1
1001 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 1001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_81_*.dump id type diameter mass xu yu zu fx fy fz

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 6591 130 130
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 127.8 | 127.8 | 127.8 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   10215          200            200            0              0              0              0              0              0              0              1.1965779e-13  0              6            
    100000   10215          200            200            0.0019722847   2.6867423e-41  0              0.005916854    577079.33      0              5.5730191e+10  1.1965779e-13  0              3.3327456    
    200000   10215          200            200            0.00066159825 -4.744709e-35   0              0.0019847948   129011.24      0              1.2458982e+10  1.1965779e-13  0              3.085083     
    300000   10215          200            200           -1.630765e-05  -9.489489e-35   0             -4.8922951e-05  178.40453      0              17229033       1.1965779e-13  0              3.0431689    
    400000   10215          200            200           -3.1483684e-05 -9.4894696e-35  0             -9.4451051e-05  709.9399       0              68560914       1.1965779e-13  0              3.0044798    
    500000   10215          200            200            0.0041887589   0.00122696     0              0.011339317    996.00915      0              96187435       1.1965779e-13  0              2.9923462    
    600000   10215          200            200            0.0017518694  -0.0011125917   0              0.0063681999   162.49061      0              15692180       1.1965779e-13  0              2.9942693    
    700000   10215          200            200            0.0019323604  -0.0010847001   0              0.0068817812   19.144264      0              1848816        1.1965779e-13  0              2.9940741    
    800000   10215          200            200            0.0022367819  -0.00092289071  0              0.0076332366   0.87771761     0              84763.684      1.1965779e-13  0              2.9937544    
    900000   10215          200            200            0.0020832598  -0.00095775498  0              0.0072075344   0.0002307547   0              22.284637      1.1965779e-13  0              2.9939304    
   1000000   10215          200            200            0.0021416989  -0.00095109969  0              0.0073761965   0.013211736    0              1275.8949      1.1965779e-13  0              2.9938608    
   1100000   10215          200            200            0.0021239618  -0.0009529434   0              0.0073248288   0.0057615751   0              556.41169      1.1965779e-13  0              2.9938817    
   1200000   10215          200            200            0.0021275015  -0.00095257475  0              0.0073350791   0.0011139454   0              107.57688      1.1965779e-13  0              2.9938776    
   1300000   10215          200            200            0.0021276177  -0.00095255629  0              0.0073354093   0.00012636969  0              12.203881      1.1965779e-13  0              2.9938774    
   1400000   10215          200            200            0.0021270656  -0.00095261757  0              0.0073338145   7.4699081e-06  0              0.72139026     1.1965779e-13  0              2.9938781    
   1500000   10215          200            200            0.0021274054  -0.00095258059  0              0.0073347967   5.8902075e-08  0              0.0056883408   1.1965779e-13  0              2.9938777    
   1600000   10215          200            200            0.0021272612  -0.00095259612  0              0.0073343796   4.5173056e-08  0              0.0043624904   1.1965779e-13  0              2.9938778    
   1700000   10215          200            200            0.0021273082  -0.00095259111  0              0.0073345156   2.8752522e-08  0              0.0027767128   1.1965779e-13  0              2.9938778    
   1800000   10215          200            200            0.0021272974  -0.00095259224  0              0.0073344843   6.4767048e-09  0              0.00062547379  1.1965779e-13  0              2.9938778    
   1900000   10215          200            200            0.002127298   -0.00095259219  0              0.0073344861   8.3679616e-10  0              8.0811784e-05  1.1965779e-13  0              2.9938778    
   2000000   10215          200            200            0.002127299   -0.00095259207  0              0.0073344892   6.0259064e-11  0              5.8193891e-06  1.1965779e-13  0              2.9938778    
   2100000   10215          200            200            0.0021272983  -0.00095259215  0              0.007334487    1.1970564e-12  0              1.1560314e-07  1.1965779e-13  0              2.9938778    
   2200000   10215          200            200            0.0021272986  -0.00095259212  0              0.007334488    1.1763048e-13  0              1.135991e-08   1.1965779e-13  0              2.9938778    
   2300000   10215          200            200            0.0021272985  -0.00095259213  0              0.0073344876   1.3558398e-13  0              1.309373e-08   1.1965779e-13  0              2.9938778    
   2400000   10215          200            200            0.0021272985  -0.00095259213  0              0.0073344877   3.6418103e-14  0              3.5169998e-09  1.1965779e-13  0              2.9938778    
   2500000   10215          200            200            0.0021272985  -0.00095259213  0              0.0073344877   5.3660891e-15  0              5.1821848e-10  1.1965779e-13  0              2.9938778    
   2600000   10215          200            200            0.0021272985  -0.00095259213  0              0.0073344877   4.3370511e-16  0              4.1884136e-11  1.1965779e-13  0              2.9938778    
   2700000   10215          200            200            0.0021272985  -0.00095259213  0              0.0073344877   2.4574345e-17  0              2.3732144e-12  1.1965779e-13  0              2.9938778    
   2800000   10215          200            200            0.0021272985  -0.00095259213  0              0.0073344877   1.9754528e-19  0              1.9077509e-14  1.1965779e-13  0              2.9938778    
   2900000   10215          200            200            0.0021272985  -0.00095259213  0              0.0073344877   2.8779979e-18  0              2.7793644e-13  1.1965779e-13  0              2.9938778    
   3000000   10215          200            200            0.0021272985  -0.00095259212  0              0.0073344877   1.3688256e-18  0              1.3219138e-13  1.1965779e-13  0              2.9938778    
Loop time of 298.05 on 4 procs for 3000000 steps with 2501 atoms

Performance: 8696526.109 ns/day, 0.000 hours/ns, 10065.424 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 11.411     | 36.087     | 61.909     | 410.3 | 12.11
Neigh   | 6.3965     | 6.5141     | 6.6357     |   4.2 |  2.19
Comm    | 23.097     | 41.829     | 79.38      | 340.4 | 14.03
Output  | 0.27426    | 0.27457    | 0.27492    |   0.1 |  0.09
Modify  | 108.93     | 156.9      | 177.58     | 223.7 | 52.64
Other   |            | 56.45      |            |       | 18.94

Nlocal:         625.25 ave         876 max         375 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:           1.75 ave           3 max           1 min
Histogram: 2 0 0 0 0 1 0 0 0 1
Neighs:         308.25 ave         617 max           0 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 1233
Ave neighs/atom = 0.4930028
Neighbor list builds = 166
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 82

#variable lat0 equal 1                    #
variable lat1 equal 3+(300*0.01)+(v_ind*0.01)  # .491+(v_ind*0.001)       # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 500*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 6.82                                                               
Lattice spacing in x,y,z = 6.82 6.82 6.82

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -5115 ${n1e1} -100 100 -100 100 units box
region box block -5115 5115 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -5115 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -5115 5115 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-5115 -100 -100) to (5115 100 100)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 1500 atoms
  using lattice units in orthogonal box = (-5115 -100 -100) to (5115 100 100)
  create_atoms CPU = 0.000 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 1500 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 1001 atoms
  using lattice units in orthogonal box = (-5115 -100 -100) to (5115 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  1500 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  1500 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  1001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  1001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
1500 atoms in group substrate
group slider1 region slider1
1001 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 1001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_82_*.dump id type diameter mass xu yu zu fx fy fz

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 6600 130 130
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 128 | 128 | 128 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   10230          200            200            0              0              0              0              0              0              0              1.1965779e-13  0              6            
    100000   10230          200            200            0.0019695201   3.1585522e-35  0              0.0059085602   577133.97      0              5.5735468e+10  1.1965779e-13  0              3.3327119    
    200000   10230          200            200            0.00066101428 -1.184447e-35   0              0.0019830428   129129.98      0              1.2470449e+10  1.1965779e-13  0              3.0849828    
    300000   10230          200            200           -1.5849896e-05  3.1586274e-35  0             -4.7549688e-05  168.82827      0              16304226       1.1965779e-13  0              3.0432017    
    400000   10230          200            200           -3.2452483e-05 -1.5792222e-35  0             -9.7357449e-05  758.48671      0              73249218       1.1965779e-13  0              3.004454     
    500000   10230          200            200            0.0066566009   0.00723303     0              0.012736773    688.16568      0              66458116       1.1965779e-13  0              2.9919038    
    600000   10230          200            200            0.0054412832   0.008081298    0              0.0082425517   162.85102      0              15726986       1.1965779e-13  0              2.9935084    
    700000   10230          200            200            0.0051813554   0.0090094669   0              0.0065345993   6.7755249      0              654331.7       1.1965779e-13  0              2.99424      
    800000   10230          200            200            0.0053522019   0.0088890447   0              0.0071675611   2.6370957      0              254671.83      1.1965779e-13  0              2.9939721    
    900000   10230          200            200            0.0054402865   0.0088792081   0              0.0074416513   0.059625067    0              5758.1622      1.1965779e-13  0              2.9938545    
   1000000   10230          200            200            0.0054014451   0.0088693376   0              0.0073349978   0.057416868    0              5544.9101      1.1965779e-13  0              2.9938984    
   1100000   10230          200            200            0.0053912325   0.008866707    0              0.0073069906   0.00016395187  0              15.833298      1.1965779e-13  0              2.9939106    
   1200000   10230          200            200            0.0053972998   0.0088682095   0              0.0073236898   0.0011155232   0              107.72924      1.1965779e-13  0              2.9939036    
   1300000   10230          200            200            0.0053981709   0.0088684389   0              0.0073260736   1.156407e-06   0              0.11167751     1.1965779e-13  0              2.9939026    
   1400000   10230          200            200            0.0053972784   0.0088682159   0              0.0073236193   1.9504647e-05  0              1.8836192      1.1965779e-13  0              2.9939036    
   1500000   10230          200            200            0.0053972358   0.0088682037   0              0.0073235038   2.661051e-07   0              0.025698526    1.1965779e-13  0              2.9939036    
   1600000   10230          200            200            0.0053973598   0.0088682348   0              0.0073238447   3.0538376e-07  0              0.029491777    1.1965779e-13  0              2.9939035    
   1700000   10230          200            200            0.0053973552   0.0088682338   0              0.0073238316   1.3455455e-08  0              0.0012994315   1.1965779e-13  0              2.9939035    
   1800000   10230          200            200            0.0053973388   0.0088682297   0              0.0073237867   4.2026248e-09  0              0.00040585942  1.1965779e-13  0              2.9939035    
   1900000   10230          200            200            0.0053973408   0.0088682302   0              0.0073237923   4.4496102e-10  0              4.2971151e-05  1.1965779e-13  0              2.9939035    
   2000000   10230          200            200            0.0053973428   0.0088682307   0              0.0073237979   4.8675551e-11  0              4.7007363e-06  1.1965779e-13  0              2.9939035    
   2100000   10230          200            200            0.0053973424   0.0088682306   0              0.0073237967   1.1777744e-11  0              1.1374102e-06  1.1965779e-13  0              2.9939035    
   2200000   10230          200            200            0.0053973422   0.0088682305   0              0.007323796    4.2661323e-13  0              4.1199252e-08  1.1965779e-13  0              2.9939035    
   2300000   10230          200            200            0.0053973423   0.0088682305   0              0.0073237962   2.6823513e-13  0              2.5904228e-08  1.1965779e-13  0              2.9939035    
   2400000   10230          200            200            0.0053973423   0.0088682305   0              0.0073237963   1.9802981e-15  0              1.9124301e-10  1.1965779e-13  0              2.9939035    
   2500000   10230          200            200            0.0053973423   0.0088682305   0              0.0073237963   5.4494675e-15  0              5.2627056e-10  1.1965779e-13  0              2.9939035    
   2600000   10230          200            200            0.0053973423   0.0088682305   0              0.0073237962   4.2003594e-21  0              4.0564065e-16  1.1965779e-13  0              2.9939035    
   2700000   10230          200            200            0.0053973423   0.0088682305   0              0.0073237963   9.2131628e-17  0              8.8974132e-12  1.1965779e-13  0              2.9939035    
   2800000   10230          200            200            0.0053973423   0.0088682305   0              0.0073237963   2.7266815e-18  0              2.6332338e-13  1.1965779e-13  0              2.9939035    
   2900000   10230          200            200            0.0053973423   0.0088682305   0              0.0073237963   7.6970918e-18  0              7.4333003e-13  1.1965779e-13  0              2.9939035    
   3000000   10230          200            200            0.0053973423   0.0088682305   0              0.0073237963   6.3560503e-18  0              6.1382185e-13  1.1965779e-13  0              2.9939035    
Loop time of 303.236 on 4 procs for 3000000 steps with 2501 atoms

Performance: 8547793.890 ns/day, 0.000 hours/ns, 9893.280 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 11.362     | 36.399     | 61.275     | 406.0 | 12.00
Neigh   | 6.3964     | 6.5235     | 6.6541     |   4.6 |  2.15
Comm    | 24.052     | 41.408     | 77.471     | 327.7 | 13.66
Output  | 0.26886    | 0.26916    | 0.26949    |   0.1 |  0.09
Modify  | 112.11     | 160.22     | 182.99     | 223.7 | 52.84
Other   |            | 58.41      |            |       | 19.26

Nlocal:         625.25 ave         876 max         375 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:           1.75 ave           3 max           1 min
Histogram: 2 0 0 0 0 1 0 0 0 1
Neighs:         308.25 ave         617 max           0 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 1233
Ave neighs/atom = 0.4930028
Neighbor list builds = 166
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 83

#variable lat0 equal 1                    #
variable lat1 equal 3+(300*0.01)+(v_ind*0.01)  # .491+(v_ind*0.001)       # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 500*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 6.83                                                               
Lattice spacing in x,y,z = 6.83 6.83 6.83

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -5122.5 ${n1e1} -100 100 -100 100 units box
region box block -5122.5 5122.5 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -5122.5 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -5122.5 5122.5 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-5122.5 -100 -100) to (5122.5 100 100)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 1500 atoms
  using lattice units in orthogonal box = (-5122.5 -100 -100) to (5122.5 100 100)
  create_atoms CPU = 0.000 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 1500 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 1001 atoms
  using lattice units in orthogonal box = (-5122.5 -100 -100) to (5122.5 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  1500 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  1500 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  1001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  1001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
1500 atoms in group substrate
group slider1 region slider1
1001 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 1001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_83_*.dump id type diameter mass xu yu zu fx fy fz

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 6610 130 130
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 128.1 | 128.1 | 128.1 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   10245          200            200            0              0              0              0              0              0              0              1.1965779e-13  0              6            
    100000   10245          200            200            0.0019663347   7.8848676e-36  0              0.005899004    576987.17      0              5.5721291e+10  1.1965779e-13  0              3.3329317    
    200000   10245          200            200            0.00065957289  6.8743752e-41  0              0.0019787187   128980.54      0              1.2456017e+10  1.1965779e-13  0              3.0851887    
    300000   10245          200            200           -1.5596717e-05  1.5902424e-41  0             -4.6790151e-05  163.8546       0              15823905       1.1965779e-13  0              3.0432297    
    400000   10245          200            200           -2.9252035e-05  4.7188533e-40  0             -8.7756105e-05  613.07469      0              59206365       1.1965779e-13  0              3.0046023    
    500000   10245          200            200            0.0052823712   0.0055067136   0              0.0103404      1159.9771      0              1.1202229e+08  1.1965779e-13  0              2.9926885    
    600000   10245          200            200            0.0030950373   0.0034138952   0              0.0058712166   127.17724      0              12281867       1.1965779e-13  0              2.9944986    
    700000   10245          200            200            0.0034772168   0.0034441019   0              0.0069875486   21.957904      0              2120537.2      1.1965779e-13  0              2.9940312    
    800000   10245          200            200            0.0037292901   0.0035670161   0              0.0076208542   0.70163706     0              67759.085      1.1965779e-13  0              2.9937594    
    900000   10245          200            200            0.0035759429   0.0035379381   0              0.0071898907   0.025024791    0              2416.7152      1.1965779e-13  0              2.9939382    
   1000000   10245          200            200            0.0036312294   0.0035523967   0              0.0073412914   0.039487013    0              3813.3731      1.1965779e-13  0              2.9938757    
   1100000   10245          200            200            0.0036211429   0.0035497934   0              0.0073136352   0.0082903142   0              800.61921      1.1965779e-13  0              2.9938867    
   1200000   10245          200            200            0.0036193863   0.0035492843   0              0.0073088748   0.00061836243  0              59.717017      1.1965779e-13  0              2.9938889    
   1300000   10245          200            200            0.0036217453   0.0035499251   0              0.0073153108   3.340295e-06   0              0.32258178     1.1965779e-13  0              2.9938861    
   1400000   10245          200            200            0.003620644    0.0035496303   0              0.0073123018   5.3748908e-06  0              0.51906849     1.1965779e-13  0              2.9938874    
   1500000   10245          200            200            0.0036209507   0.0035497111   0              0.0073131409   2.4405784e-06  0              0.23569359     1.1965779e-13  0              2.9938871    
   1600000   10245          200            200            0.0036209252   0.003549705    0              0.0073130707   3.2914106e-07  0              0.031786088    1.1965779e-13  0              2.9938871    
   1700000   10245          200            200            0.0036208983   0.0035496976   0              0.0073129973   1.3173674e-08  0              0.0012722192   1.1965779e-13  0              2.9938871    
   1800000   10245          200            200            0.003620917    0.0035497026   0              0.0073130484   1.5070019e-10  0              1.4553546e-05  1.1965779e-13  0              2.9938871    
   1900000   10245          200            200            0.00362091     0.0035497008   0              0.0073130293   5.0413192e-10  0              4.8685453e-05  1.1965779e-13  0              2.9938871    
   2000000   10245          200            200            0.0036209115   0.0035497011   0              0.0073130333   1.2288564e-10  0              1.1867416e-05  1.1965779e-13  0              2.9938871    
   2100000   10245          200            200            0.0036209116   0.0035497012   0              0.0073130336   1.0636169e-11  0              1.0271651e-06  1.1965779e-13  0              2.9938871    
   2200000   10245          200            200            0.0036209113   0.0035497011   0              0.0073130329   1.2558876e-13  0              1.2128464e-08  1.1965779e-13  0              2.9938871    
   2300000   10245          200            200            0.0036209115   0.0035497011   0              0.0073130332   5.7146277e-14  0              5.5187784e-09  1.1965779e-13  0              2.9938871    
   2400000   10245          200            200            0.0036209114   0.0035497011   0              0.0073130331   3.359712e-14   0              3.2445694e-09  1.1965779e-13  0              2.9938871    
   2500000   10245          200            200            0.0036209114   0.0035497011   0              0.0073130331   5.1515224e-15  0              4.9749716e-10  1.1965779e-13  0              2.9938871    
   2600000   10245          200            200            0.0036209114   0.0035497011   0              0.0073130331   2.3426166e-16  0              2.2623314e-11  1.1965779e-13  0              2.9938871    
   2700000   10245          200            200            0.0036209114   0.0035497011   0              0.0073130331   7.2042445e-19  0              6.9573436e-14  1.1965779e-13  0              2.9938871    
   2800000   10245          200            200            0.0036209114   0.0035497011   0              0.0073130331   1.6321084e-18  0              1.5761735e-13  1.1965779e-13  0              2.9938871    
   2900000   10245          200            200            0.0036209114   0.0035497011   0              0.0073130331   5.7089976e-18  0              5.5133413e-13  1.1965779e-13  0              2.9938871    
   3000000   10245          200            200            0.0036209114   0.0035497011   0              0.0073130331   6.3060236e-18  0              6.0899062e-13  1.1965779e-13  0              2.9938871    
Loop time of 301.472 on 4 procs for 3000000 steps with 2501 atoms

Performance: 8597805.900 ns/day, 0.000 hours/ns, 9951.164 timesteps/s
99.9% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 11.062     | 36.03      | 61.08      | 411.7 | 11.95
Neigh   | 6.5167     | 6.6311     | 6.7484     |   4.1 |  2.20
Comm    | 23.204     | 41.438     | 78.443     | 336.8 | 13.75
Output  | 0.33861    | 0.33895    | 0.33929    |   0.1 |  0.11
Modify  | 111.45     | 159.93     | 180.61     | 225.0 | 53.05
Other   |            | 57.11      |            |       | 18.94

Nlocal:         625.25 ave         876 max         375 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:           1.75 ave           3 max           1 min
Histogram: 2 0 0 0 0 1 0 0 0 1
Neighs:         306.75 ave         614 max           0 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 1227
Ave neighs/atom = 0.49060376
Neighbor list builds = 166
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 84

#variable lat0 equal 1                    #
variable lat1 equal 3+(300*0.01)+(v_ind*0.01)  # .491+(v_ind*0.001)       # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 500*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 6.84                                                               
Lattice spacing in x,y,z = 6.84 6.84 6.84

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -5130 ${n1e1} -100 100 -100 100 units box
region box block -5130 5130 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -5130 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -5130 5130 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-5130 -100 -100) to (5130 100 100)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 1500 atoms
  using lattice units in orthogonal box = (-5130 -100 -100) to (5130 100 100)
  create_atoms CPU = 0.000 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 1500 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 1001 atoms
  using lattice units in orthogonal box = (-5130 -100 -100) to (5130 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  1500 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  1500 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  1001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  1001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
1500 atoms in group substrate
group slider1 region slider1
1001 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 1001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_84_*.dump id type diameter mass xu yu zu fx fy fz

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 6620 130 130
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 128.3 | 128.3 | 128.3 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   10260          200            200            0              0              0              0              0              0              0              1.1965779e-13  0              6            
    100000   10260          200            200            0.0019636625  -1.9683025e-36  0              0.0058909876   577080.8       0              5.5730333e+10  1.1965779e-13  0              3.3328253    
    200000   10260          200            200            0.00065923621 -4.7239155e-35  0              0.0019777086   129176.19      0              1.2474911e+10  1.1965779e-13  0              3.0849779    
    300000   10260          200            200           -1.4652574e-05  3.1493862e-35  0             -4.3957723e-05  144.68078      0              13972234       1.1965779e-13  0              3.0432572    
    400000   10260          200            200           -2.6695262e-05  7.8005293e-41  0             -8.0085785e-05  508.79434      0              49135716       1.1965779e-13  0              3.0046848    
    500000   10260          200            200            0.0048514296   0.0030948366   0              0.011459452    958.38397      0              92553864       1.1965779e-13  0              2.9923554    
    600000   10260          200            200            0.0022270213   0.001478864    0              0.0052021999   54.176806      0              5232008.2      1.1965779e-13  0              2.9948857    
    700000   10260          200            200            0.0031319968   0.001741087    0              0.0076549033   21.899785      0              2114924.5      1.1965779e-13  0              2.9938397    
    800000   10260          200            200            0.0030199323   0.0017270056   0              0.0073327913   3.3707526      0              325523.16      1.1965779e-13  0              2.993962     
    900000   10260          200            200            0.0029852536   0.0017216314   0              0.0072341295   0.32181612     0              31078.698      1.1965779e-13  0              2.9940065    
   1000000   10260          200            200            0.0030233496   0.0017271891   0              0.0073428598   0.015385823    0              1485.8527      1.1965779e-13  0              2.9939604    
   1100000   10260          200            200            0.0030032519   0.0017243189   0              0.0072854367   2.0127609e-05  0              1.9437804      1.1965779e-13  0              2.9939844    
   1200000   10260          200            200            0.0030112639   0.0017254577   0              0.007308334    0.0001901755   0              18.365789      1.1965779e-13  0              2.9939749    
   1300000   10260          200            200            0.0030087329   0.0017251023   0              0.0073010964   9.2670859e-05  0              8.9494882      1.1965779e-13  0              2.9939779    
   1400000   10260          200            200            0.0030093076   0.0017251815   0              0.0073027413   1.969434e-05   0              1.9019384      1.1965779e-13  0              2.9939772    
   1500000   10260          200            200            0.0030092731   0.0017251777   0              0.0073026416   2.5745371e-06  0              0.24863037     1.1965779e-13  0              2.9939772    
   1600000   10260          200            200            0.0030092181   0.0017251695   0              0.0073024849   2.0339123e-07  0              0.019642069    1.1965779e-13  0              2.9939773    
   1700000   10260          200            200            0.0030092587   0.0017251754   0              0.0073026009   6.172674e-09   0              0.00059611267  1.1965779e-13  0              2.9939773    
   1800000   10260          200            200            0.0030092396   0.0017251726   0              0.0073025461   8.9267283e-11  0              8.6207952e-06  1.1965779e-13  0              2.9939773    
   1900000   10260          200            200            0.0030092466   0.0017251736   0              0.0073025663   2.816414e-10   0              2.7198911e-05  1.1965779e-13  0              2.9939773    
   2000000   10260          200            200            0.0030092446   0.0017251734   0              0.0073025605   9.4183594e-11  0              9.0955774e-06  1.1965779e-13  0              2.9939773    
   2100000   10260          200            200            0.003009245    0.0017251734   0              0.0073025616   1.6684187e-11  0              1.6112394e-06  1.1965779e-13  0              2.9939773    
   2200000   10260          200            200            0.003009245    0.0017251734   0              0.0073025616   1.8580814e-12  0              1.7944021e-07  1.1965779e-13  0              2.9939773    
   2300000   10260          200            200            0.0030092449   0.0017251734   0              0.0073025614   1.1655969e-13  0              1.12565e-08    1.1965779e-13  0              2.9939773    
   2400000   10260          200            200            0.003009245    0.0017251734   0              0.0073025616   1.4779749e-15  0              1.4273223e-10  1.1965779e-13  0              2.9939773    
   2500000   10260          200            200            0.003009245    0.0017251734   0              0.0073025615   4.4488732e-16  0              4.2964033e-11  1.1965779e-13  0              2.9939773    
   2600000   10260          200            200            0.003009245    0.0017251734   0              0.0073025615   3.602945e-16   0              3.4794663e-11  1.1965779e-13  0              2.9939773    
   2700000   10260          200            200            0.003009245    0.0017251734   0              0.0073025615   7.8555418e-17  0              7.58632e-12    1.1965779e-13  0              2.9939773    
   2800000   10260          200            200            0.003009245    0.0017251734   0              0.0073025615   1.291592e-17   0              1.2473271e-12  1.1965779e-13  0              2.9939773    
   2900000   10260          200            200            0.003009245    0.0017251734   0              0.0073025615   6.1892196e-18  0              5.9771053e-13  1.1965779e-13  0              2.9939773    
   3000000   10260          200            200            0.003009245    0.0017251734   0              0.0073025615   4.4159968e-18  0              4.2646537e-13  1.1965779e-13  0              2.9939773    
Loop time of 300.765 on 4 procs for 3000000 steps with 2501 atoms

Performance: 8618035.457 ns/day, 0.000 hours/ns, 9974.578 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 11.03      | 35.559     | 60.563     | 407.1 | 11.82
Neigh   | 6.441      | 6.5643     | 6.6913     |   4.4 |  2.18
Comm    | 23.74      | 41.412     | 77.73      | 330.2 | 13.77
Output  | 0.2734     | 0.27371    | 0.27403    |   0.1 |  0.09
Modify  | 111.81     | 159.61     | 181.81     | 222.3 | 53.07
Other   |            | 57.34      |            |       | 19.07

Nlocal:         625.25 ave         876 max         375 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:           1.75 ave           3 max           1 min
Histogram: 2 0 0 0 0 1 0 0 0 1
Neighs:         307.25 ave         615 max           0 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 1229
Ave neighs/atom = 0.49140344
Neighbor list builds = 166
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 85

#variable lat0 equal 1                    #
variable lat1 equal 3+(300*0.01)+(v_ind*0.01)  # .491+(v_ind*0.001)       # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 500*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 6.85                                                               
Lattice spacing in x,y,z = 6.85 6.85 6.85

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -5137.5 ${n1e1} -100 100 -100 100 units box
region box block -5137.5 5137.5 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -5137.5 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -5137.5 5137.5 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-5137.5 -100 -100) to (5137.5 100 100)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 1500 atoms
  using lattice units in orthogonal box = (-5137.5 -100 -100) to (5137.5 100 100)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 1500 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 1001 atoms
  using lattice units in orthogonal box = (-5137.5 -100 -100) to (5137.5 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  1500 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  1500 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  1001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  1001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
1500 atoms in group substrate
group slider1 region slider1
1001 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 1001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_85_*.dump id type diameter mass xu yu zu fx fy fz

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 6630 130 130
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 128.4 | 128.4 | 128.5 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   10275          200            200            0              0              0              0              0              0              0              1.1965779e-13  0              6            
    100000   10275          200            200            0.0019609122   3.1447038e-35  0              0.0058827365   577132.27      0              5.5735304e+10  1.1965779e-13  0              3.3327833    
    200000   10275          200            200            0.0006587666  -1.965434e-35   0              0.0019762998   129330.44      0              1.2489808e+10  1.1965779e-13  0              3.0848039    
    300000   10275          200            200           -1.3129797e-05  3.1447489e-35  0             -3.9389391e-05  116.03062      0              11205407       1.1965779e-13  0              3.0432555    
    400000   10275          200            200           -2.4218341e-05 -4.7170252e-35  0             -7.2655024e-05  417.36937      0              40306546       1.1965779e-13  0              3.0047322    
    500000   10275          200            200            0.0027143196  -0.0015169171   0              0.0096598759   1241.1784      0              1.1986412e+08  1.1965779e-13  0              2.9928156    
    600000   10275          200            200            0.0016110153  -0.001547556    0              0.0063806018   161.43673      0              15590404       1.1965779e-13  0              2.9941809    
    700000   10275          200            200            0.0016518294  -0.0015534262   0              0.0065089143   6.2602366      0              604568.85      1.1965779e-13  0              2.9941394    
    800000   10275          200            200            0.0018002801  -0.0015588491   0              0.0069596894   0.028316093    0              2734.5656      1.1965779e-13  0              2.9939434    
    900000   10275          200            200            0.0018799049  -0.0015613016   0              0.0072010162   0.20231609     0              19538.24       1.1965779e-13  0              2.9938387    
   1000000   10275          200            200            0.0019070649  -0.001562188    0              0.0072833825   0.058559868    0              5655.2929      1.1965779e-13  0              2.9938027    
   1100000   10275          200            200            0.0019121967  -0.0015623624   0              0.0072989526   0.0065976031   0              637.14929      1.1965779e-13  0              2.9937958    
   1200000   10275          200            200            0.0019115345  -0.0015623433   0              0.0072969468   0.00022459046  0              21.689339      1.1965779e-13  0              2.9937965    
   1300000   10275          200            200            0.001910454   -0.0015623086   0              0.0072936706   4.7032259e-06  0              0.4542039      1.1965779e-13  0              2.9937979    
   1400000   10275          200            200            0.0019099097  -0.0015622908   0              0.0072920199   1.0852373e-05  0              1.0480445      1.1965779e-13  0              2.9937986    
   1500000   10275          200            200            0.0019097362  -0.0015622851   0              0.0072914936   2.6892624e-06  0              0.25970971     1.1965779e-13  0              2.9937988    
   1600000   10275          200            200            0.0019097078  -0.0015622841   0              0.0072914076   2.6779579e-07  0              0.025861801    1.1965779e-13  0              2.9937989    
   1700000   10275          200            200            0.0019097146  -0.0015622843   0              0.0072914282   6.7715791e-09  0              0.00065395064  1.1965779e-13  0              2.9937989    
   1800000   10275          200            200            0.0019097224  -0.0015622846   0              0.0072914519   4.646803e-10   0              4.4875497e-05  1.1965779e-13  0              2.9937989    
   1900000   10275          200            200            0.0019097261  -0.0015622847   0              0.007291463    5.6406511e-10  0              5.4473371e-05  1.1965779e-13  0              2.9937989    
   2000000   10275          200            200            0.0019097272  -0.0015622847   0              0.0072914663   1.2152261e-10  0              1.1735784e-05  1.1965779e-13  0              2.9937989    
   2100000   10275          200            200            0.0019097273  -0.0015622847   0              0.0072914668   1.064345e-11   0              1.0278682e-06  1.1965779e-13  0              2.9937989    
   2200000   10275          200            200            0.0019097273  -0.0015622847   0              0.0072914666   1.8142013e-13  0              1.7520257e-08  1.1965779e-13  0              2.9937989    
   2300000   10275          200            200            0.0019097272  -0.0015622847   0              0.0072914664   3.6229067e-14  0              3.498744e-09   1.1965779e-13  0              2.9937989    
   2400000   10275          200            200            0.0019097272  -0.0015622847   0              0.0072914663   2.8534095e-14  0              2.7556186e-09  1.1965779e-13  0              2.9937989    
   2500000   10275          200            200            0.0019097272  -0.0015622847   0              0.0072914663   5.379849e-15   0              5.1954731e-10  1.1965779e-13  0              2.9937989    
   2600000   10275          200            200            0.0019097272  -0.0015622847   0              0.0072914663   3.8722027e-16  0              3.7394962e-11  1.1965779e-13  0              2.9937989    
   2700000   10275          200            200            0.0019097272  -0.0015622847   0              0.0072914663   6.5433801e-20  0              6.3191282e-15  1.1965779e-13  0              2.9937989    
   2800000   10275          200            200            0.0019097272  -0.0015622847   0              0.0072914663   5.9971519e-18  0              5.79162e-13    1.1965779e-13  0              2.9937989    
   2900000   10275          200            200            0.0019097272  -0.0015622847   0              0.0072914663   2.4703779e-18  0              2.3857142e-13  1.1965779e-13  0              2.9937989    
   3000000   10275          200            200            0.0019097272  -0.0015622847   0              0.0072914663   2.371278e-18   0              2.2900106e-13  1.1965779e-13  0              2.9937989    
Loop time of 300.503 on 4 procs for 3000000 steps with 2501 atoms

Performance: 8625536.503 ns/day, 0.000 hours/ns, 9983.260 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 11.308     | 35.549     | 60.273     | 405.3 | 11.83
Neigh   | 6.4408     | 6.5585     | 6.6809     |   4.3 |  2.18
Comm    | 23.121     | 42.827     | 79.937     | 334.6 | 14.25
Output  | 0.27219    | 0.2725     | 0.27283    |   0.1 |  0.09
Modify  | 109.91     | 158.42     | 178.99     | 224.9 | 52.72
Other   |            | 56.88      |            |       | 18.93

Nlocal:         625.25 ave         876 max         375 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:           1.75 ave           3 max           1 min
Histogram: 2 0 0 0 0 1 0 0 0 1
Neighs:         307.25 ave         615 max           0 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 1229
Ave neighs/atom = 0.49140344
Neighbor list builds = 166
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 86

#variable lat0 equal 1                    #
variable lat1 equal 3+(300*0.01)+(v_ind*0.01)  # .491+(v_ind*0.001)       # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 500*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 6.86                                                               
Lattice spacing in x,y,z = 6.86 6.86 6.86

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -5145 ${n1e1} -100 100 -100 100 units box
region box block -5145 5145 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -5145 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -5145 5145 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-5145 -100 -100) to (5145 100 100)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 1500 atoms
  using lattice units in orthogonal box = (-5145 -100 -100) to (5145 100 100)
  create_atoms CPU = 0.000 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 1500 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 1001 atoms
  using lattice units in orthogonal box = (-5145 -100 -100) to (5145 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  1500 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  1500 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  1001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  1001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
1500 atoms in group substrate
group slider1 region slider1
1001 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 1001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_86_*.dump id type diameter mass xu yu zu fx fy fz

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 6639 130 130
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 128.6 | 128.6 | 128.6 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   10290          200            200            0              0              0              0              0              0              0              1.1965779e-13  0              6            
    100000   10290          200            200            0.0019575259   1.9625738e-36  0              0.0058725777   576902.16      0              5.5713081e+10  1.1965779e-13  0              3.3329428    
    200000   10290          200            200            0.00065559619  3.1401535e-35  0              0.0019667886   128641.87      0              1.2423311e+10  1.1965779e-13  0              3.0854965    
    300000   10290          200            200           -1.835602e-05  -6.2801703e-35  0             -5.5068059e-05  230.66969      0              22276427       1.1965779e-13  0              3.0431398    
    400000   10290          200            200           -3.5957268e-05  1.2775408e-39  0             -0.00010787181  951.18345      0              91858489       1.1965779e-13  0              3.0043034    
    500000   10290          200            200            0.010857343    0.021366063    0              0.011205967    1015.7383      0              98092733       1.1965779e-13  0              2.9924598    
    600000   10290          200            200            0.004800579    0.0088053394   0              0.0055963976   103.07357      0              9954108        1.1965779e-13  0              2.9946875    
    700000   10290          200            200            0.0058812509   0.010292479    0              0.0073512733   25.248339      0              2438303.8      1.1965779e-13  0              2.9939392    
    800000   10290          200            200            0.0059688147   0.01053773     0              0.0073687143   3.1716138      0              306291.76      1.1965779e-13  0              2.9939218    
    900000   10290          200            200            0.0058825644   0.010436503    0              0.0072111901   0.31460584     0              30382.38       1.1965779e-13  0              2.9939904    
   1000000   10290          200            200            0.0059316952   0.010477317    0              0.0073177684   0.023373204    0              2257.2168      1.1965779e-13  0              2.9939452    
   1100000   10290          200            200            0.0059076236   0.010457698    0              0.007265173    0.00095488626  0              92.21608       1.1965779e-13  0              2.9939672    
   1200000   10290          200            200            0.0059178516   0.010466036    0              0.0072875184   9.4695028e-07  0              0.09144968     1.1965779e-13  0              2.9939579    
   1300000   10290          200            200            0.0059139667   0.010462892    0              0.0072790079   1.2185963e-05  0              1.1768331      1.1965779e-13  0              2.9939615    
   1400000   10290          200            200            0.0059153007   0.010463968    0              0.0072819344   6.5995453e-06  0              0.63733685     1.1965779e-13  0              2.9939603    
   1500000   10290          200            200            0.0059148935   0.010463642    0              0.0072810391   1.7496522e-06  0              0.16896889     1.1965779e-13  0              2.9939606    
   1600000   10290          200            200            0.0059149979   0.010463724    0              0.0072812694   3.329448e-07   0              0.032153426    1.1965779e-13  0              2.9939605    
   1700000   10290          200            200            0.00591498     0.010463711    0              0.0072812294   5.0370397e-08  0              0.0048644124   1.1965779e-13  0              2.9939606    
   1800000   10290          200            200            0.0059149784   0.010463709    0              0.0072812262   6.2188901e-09  0              0.0006005759   1.1965779e-13  0              2.9939606    
   1900000   10290          200            200            0.0059149819   0.010463712    0              0.0072812338   6.1421158e-10  0              5.9316158e-05  1.1965779e-13  0              2.9939606    
   2000000   10290          200            200            0.0059149797   0.01046371     0              0.0072812289   4.4424624e-11  0              4.2902122e-06  1.1965779e-13  0              2.9939606    
   2100000   10290          200            200            0.0059149808   0.010463711    0              0.0072812313   1.7156387e-12  0              1.6568411e-07  1.1965779e-13  0              2.9939606    
   2200000   10290          200            200            0.0059149803   0.010463711    0              0.0072812303   2.3265897e-16  0              2.2468538e-11  1.1965779e-13  0              2.9939606    
   2300000   10290          200            200            0.0059149805   0.010463711    0              0.0072812307   2.7381227e-14  0              2.6442829e-09  1.1965779e-13  0              2.9939606    
   2400000   10290          200            200            0.0059149804   0.010463711    0              0.0072812306   1.37491e-14    0              1.3277896e-09  1.1965779e-13  0              2.9939606    
   2500000   10290          200            200            0.0059149804   0.010463711    0              0.0072812306   3.5295245e-15  0              3.4085622e-10  1.1965779e-13  0              2.9939606    
   2600000   10290          200            200            0.0059149804   0.010463711    0              0.0072812306   6.5356085e-16  0              6.3116229e-11  1.1965779e-13  0              2.9939606    
   2700000   10290          200            200            0.0059149804   0.010463711    0              0.0072812306   9.6581216e-17  0              9.3271225e-12  1.1965779e-13  0              2.9939606    
   2800000   10290          200            200            0.0059149804   0.010463711    0              0.0072812306   1.3472424e-17  0              1.3010703e-12  1.1965779e-13  0              2.9939606    
   2900000   10290          200            200            0.0059149804   0.010463711    0              0.0072812306   1.7692534e-18  0              1.7086183e-13  1.1965779e-13  0              2.9939606    
   3000000   10290          200            200            0.0059149804   0.010463711    0              0.0072812306   4.9042185e-18  0              4.7361432e-13  1.1965779e-13  0              2.9939606    
Loop time of 298.669 on 4 procs for 3000000 steps with 2501 atoms

Performance: 8678511.801 ns/day, 0.000 hours/ns, 10044.574 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 10.993     | 35.668     | 60.919     | 409.1 | 11.94
Neigh   | 6.5498     | 6.6629     | 6.7807     |   4.1 |  2.23
Comm    | 23.516     | 41.775     | 78.693     | 334.6 | 13.99
Output  | 0.2719     | 0.27223    | 0.27256    |   0.1 |  0.09
Modify  | 109.45     | 157.59     | 178.26     | 224.7 | 52.76
Other   |            | 56.7       |            |       | 18.98

Nlocal:         625.25 ave         876 max         375 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:           1.75 ave           3 max           1 min
Histogram: 2 0 0 0 0 1 0 0 0 1
Neighs:         307.25 ave         615 max           0 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 1229
Ave neighs/atom = 0.49140344
Neighbor list builds = 166
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 87

#variable lat0 equal 1                    #
variable lat1 equal 3+(300*0.01)+(v_ind*0.01)  # .491+(v_ind*0.001)       # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 500*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 6.87                                                               
Lattice spacing in x,y,z = 6.87 6.87 6.87

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -5152.5 ${n1e1} -100 100 -100 100 units box
region box block -5152.5 5152.5 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -5152.5 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -5152.5 5152.5 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-5152.5 -100 -100) to (5152.5 100 100)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 1500 atoms
  using lattice units in orthogonal box = (-5152.5 -100 -100) to (5152.5 100 100)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 1500 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 1001 atoms
  using lattice units in orthogonal box = (-5152.5 -100 -100) to (5152.5 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  1500 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  1500 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  1001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  1001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
1500 atoms in group substrate
group slider1 region slider1
1001 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 1001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_87_*.dump id type diameter mass xu yu zu fx fy fz

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 6649 130 130
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 128.8 | 128.8 | 128.8 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   10305          200            200            0              0              0              0              0              0              0              1.1965779e-13  0              6            
    100000   10305          200            200            0.001954904   -7.838755e-36   0              0.0058647121   577001.67      0              5.5722692e+10  1.1965779e-13  0              3.3328725    
    200000   10305          200            200            0.00065575129  4.0273526e-41  0              0.0019672539   128988.71      0              1.2456806e+10  1.1965779e-13  0              3.0851289    
    300000   10305          200            200           -1.5483283e-05  1.3113135e-40  0             -4.6449849e-05  163.37196      0              15777295       1.1965779e-13  0              3.0431847    
    400000   10305          200            200           -2.9572381e-05  3.135557e-35   0             -8.8717144e-05  634.7594       0              61300519       1.1965779e-13  0              3.0045392    
    500000   10305          200            200            0.0051495102   0.0040563062   0              0.011392224    962.26852      0              92929006       1.1965779e-13  0              2.9922556    
    600000   10305          200            200            0.0031785425   0.0021595339   0              0.0073760936   187.5304       0              18110344       1.1965779e-13  0              2.9937761    
    700000   10305          200            200            0.0027421898   0.0018383194   0              0.0063882501   1.6304242      0              157454.7       1.1965779e-13  0              2.994224     
    800000   10305          200            200            0.0031849203   0.0020068449   0              0.007547916    1.2096747      0              116821.72      1.1965779e-13  0              2.9937271    
    900000   10305          200            200            0.0030820352   0.0019865381   0              0.0072595676   0.45227305     0              43677.294      1.1965779e-13  0              2.9938442    
   1000000   10305          200            200            0.0030743616   0.001984922    0              0.007238163    0.030863233    0              2980.5501      1.1965779e-13  0              2.9938545    
   1100000   10305          200            200            0.0030918115   0.001988172    0              0.0072872625   3.5908693e-05  0              3.4678045      1.1965779e-13  0              2.9938336    
   1200000   10305          200            200            0.003084454    0.0019868369   0              0.007266525    0.00070781247  0              68.355462      1.1965779e-13  0              2.9938423    
   1300000   10305          200            200            0.0030856486   0.0019870473   0              0.0072698987   0.0001445643   0              13.960985      1.1965779e-13  0              2.9938409    
   1400000   10305          200            200            0.0030860653   0.0019871268   0              0.007271069    4.8783092e-06  0              0.47111218     1.1965779e-13  0              2.9938404    
   1500000   10305          200            200            0.0030857032   0.0019870601   0              0.0072700495   3.1040424e-07  0              0.02997662     1.1965779e-13  0              2.9938408    
   1600000   10305          200            200            0.0030858216   0.0019870815   0              0.0072703833   3.2115716e-07  0              0.03101506     1.1965779e-13  0              2.9938407    
   1700000   10305          200            200            0.0030858133   0.0019870802   0              0.0072703599   3.9257285e-08  0              0.0037911876   1.1965779e-13  0              2.9938407    
   1800000   10305          200            200            0.0030858014   0.0019870779   0              0.0072703261   3.6443321e-10  0              3.5194351e-05  1.1965779e-13  0              2.9938407    
   1900000   10305          200            200            0.0030858083   0.0019870792   0              0.0072703455   3.0721584e-10  0              2.9668707e-05  1.1965779e-13  0              2.9938407    
   2000000   10305          200            200            0.0030858065   0.0019870789   0              0.0072703407   1.2163502e-10  0              1.174664e-05   1.1965779e-13  0              2.9938407    
   2100000   10305          200            200            0.0030858064   0.0019870789   0              0.0072703404   8.7250851e-12  0              8.4260627e-07  1.1965779e-13  0              2.9938407    
   2200000   10305          200            200            0.0030858067   0.0019870789   0              0.0072703412   3.996538e-15   0              3.8595703e-10  1.1965779e-13  0              2.9938407    
   2300000   10305          200            200            0.0030858066   0.0019870789   0              0.0072703409   1.8400038e-13  0              1.776944e-08   1.1965779e-13  0              2.9938407    
   2400000   10305          200            200            0.0030858066   0.0019870789   0              0.0072703409   3.9351491e-14  0              3.8002853e-09  1.1965779e-13  0              2.9938407    
   2500000   10305          200            200            0.0030858066   0.0019870789   0              0.007270341    1.3797693e-15  0              1.3324824e-10  1.1965779e-13  0              2.9938407    
   2600000   10305          200            200            0.0030858066   0.0019870789   0              0.0072703409   8.2423153e-17  0              7.9598381e-12  1.1965779e-13  0              2.9938407    
   2700000   10305          200            200            0.0030858066   0.0019870789   0              0.0072703409   7.2674739e-17  0              7.0184061e-12  1.1965779e-13  0              2.9938407    
   2800000   10305          200            200            0.0030858066   0.0019870789   0              0.0072703409   1.3012891e-17  0              1.2566918e-12  1.1965779e-13  0              2.9938407    
   2900000   10305          200            200            0.0030858066   0.0019870789   0              0.0072703409   8.9760351e-20  0              8.6684122e-15  1.1965779e-13  0              2.9938407    
   3000000   10305          200            200            0.0030858066   0.0019870789   0              0.0072703409   1.0473134e-19  0              1.0114203e-14  1.1965779e-13  0              2.9938407    
Loop time of 298.55 on 4 procs for 3000000 steps with 2501 atoms

Performance: 8681975.636 ns/day, 0.000 hours/ns, 10048.583 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 11.033     | 35.733     | 61.196     | 409.8 | 11.97
Neigh   | 6.5331     | 6.6505     | 6.7703     |   4.2 |  2.23
Comm    | 23.547     | 41.911     | 78.988     | 335.5 | 14.04
Output  | 0.27331    | 0.27362    | 0.27396    |   0.1 |  0.09
Modify  | 109.24     | 157.26     | 178.29     | 224.0 | 52.68
Other   |            | 56.72      |            |       | 19.00

Nlocal:         625.25 ave         876 max         375 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:           1.75 ave           3 max           1 min
Histogram: 2 0 0 0 0 1 0 0 0 1
Neighs:         308.25 ave         617 max           0 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 1233
Ave neighs/atom = 0.4930028
Neighbor list builds = 166
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 88

#variable lat0 equal 1                    #
variable lat1 equal 3+(300*0.01)+(v_ind*0.01)  # .491+(v_ind*0.001)       # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 500*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 6.88                                                               
Lattice spacing in x,y,z = 6.88 6.88 6.88

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -5160 ${n1e1} -100 100 -100 100 units box
region box block -5160 5160 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -5160 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -5160 5160 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-5160 -100 -100) to (5160 100 100)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 1500 atoms
  using lattice units in orthogonal box = (-5160 -100 -100) to (5160 100 100)
  create_atoms CPU = 0.000 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 1500 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 1001 atoms
  using lattice units in orthogonal box = (-5160 -100 -100) to (5160 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  1500 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  1500 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  1001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  1001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
1500 atoms in group substrate
group slider1 region slider1
1001 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 1001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_88_*.dump id type diameter mass xu yu zu fx fy fz

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 6659 130 130
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 129 | 129 | 129 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   10320          200            200            0              0              0              0              0              0              0              1.1965779e-13  0              6            
    100000   10320          200            200            0.0019522599   2.3482424e-35  0              0.0058567797   577086.55      0              5.5730888e+10  1.1965779e-13  0              3.3328241    
    200000   10320          200            200            0.00065529243  1.5655047e-35  0              0.0019658773   129141.01      0              1.2471514e+10  1.1965779e-13  0              3.0850237    
    300000   10320          200            200           -1.4447002e-05  3.1310073e-35  0             -4.3341005e-05  142.25286      0              13737763       1.1965779e-13  0              3.0432565    
    400000   10320          200            200           -2.7204381e-05 -3.1309388e-35  0             -8.1613142e-05  535.49889      0              51714650       1.1965779e-13  0              3.0046676    
    500000   10320          200            200            0.0016381824  -0.0046225927   0              0.00953714     1255.4772      0              1.21245e+08    1.1965779e-13  0              2.9929247    
    600000   10320          200            200            0.0014711105  -0.0013189691   0              0.0057323007   116.39647      0              11240738       1.1965779e-13  0              2.9945349    
    700000   10320          200            200            0.0016105941  -0.0016640782   0              0.0064958605   7.1172934      0              687337.25      1.1965779e-13  0              2.9942093    
    800000   10320          200            200            0.0018368383  -0.0019339274   0              0.0074444424   2.4009543      0              231866.98      1.1965779e-13  0              2.9937974    
    900000   10320          200            200            0.0018126537  -0.0019249852   0              0.0073629464   0.13918776     0              13441.758      1.1965779e-13  0              2.9938288    
   1000000   10320          200            200            0.001774953   -0.0019086656   0              0.0072335247   0.041464841    0              4004.3776      1.1965779e-13  0              2.993884     
   1100000   10320          200            200            0.0017787079  -0.0019101883   0              0.0072463121   0.0028070104   0              271.08097      1.1965779e-13  0              2.9938789    
   1200000   10320          200            200            0.0017837259  -0.0019124089   0              0.0072635866   0.00071668787  0              69.212585      1.1965779e-13  0              2.9938716    
   1300000   10320          200            200            0.001783151   -0.0019121755   0              0.0072616286   5.6477982e-05  0              5.4542392      1.1965779e-13  0              2.9938723    
   1400000   10320          200            200            0.0017824814  -0.0019118798   0              0.007259324    1.2318272e-05  0              1.1896105      1.1965779e-13  0              2.9938733    
   1500000   10320          200            200            0.0017825681  -0.0019119153   0              0.0072596197   1.1274008e-06  0              0.1088763      1.1965779e-13  0              2.9938732    
   1600000   10320          200            200            0.0017826573  -0.0019119548   0              0.0072599266   2.1080432e-07  0              0.020357973    1.1965779e-13  0              2.9938731    
   1700000   10320          200            200            0.0017826444  -0.0019119494   0              0.0072598825   2.2356664e-08  0              0.0021590466   1.1965779e-13  0              2.9938731    
   1800000   10320          200            200            0.0017826325  -0.0019119442   0              0.0072598417   3.5900734e-09  0              0.00034670359  1.1965779e-13  0              2.9938731    
   1900000   10320          200            200            0.0017826344  -0.001911945    0              0.0072598482   4.4063585e-10  0              4.2553457e-05  1.1965779e-13  0              2.9938731    
   2000000   10320          200            200            0.001782636   -0.0019119457   0              0.0072598536   6.0820439e-11  0              5.8736027e-06  1.1965779e-13  0              2.9938731    
   2100000   10320          200            200            0.0017826357  -0.0019119455   0              0.0072598527   8.6352041e-12  0              8.3392621e-07  1.1965779e-13  0              2.9938731    
   2200000   10320          200            200            0.0017826355  -0.0019119455   0              0.007259852    1.0252622e-12  0              9.9012488e-08  1.1965779e-13  0              2.9938731    
   2300000   10320          200            200            0.0017826355  -0.0019119455   0              0.0072598521   1.6851903e-13  0              1.6274362e-08  1.1965779e-13  0              2.9938731    
   2400000   10320          200            200            0.0017826356  -0.0019119455   0              0.0072598522   1.7099099e-14  0              1.6513086e-09  1.1965779e-13  0              2.9938731    
   2500000   10320          200            200            0.0017826356  -0.0019119455   0              0.0072598522   3.2219555e-15  0              3.111534e-10   1.1965779e-13  0              2.9938731    
   2600000   10320          200            200            0.0017826356  -0.0019119455   0              0.0072598522   2.99643e-16    0              2.8937376e-11  1.1965779e-13  0              2.9938731    
   2700000   10320          200            200            0.0017826356  -0.0019119455   0              0.0072598522   7.423437e-17   0              7.1690241e-12  1.1965779e-13  0              2.9938731    
   2800000   10320          200            200            0.0017826356  -0.0019119455   0              0.0072598522   1.0625968e-18  0              1.0261799e-13  1.1965779e-13  0              2.9938731    
   2900000   10320          200            200            0.0017826356  -0.0019119455   0              0.0072598522   5.4033759e-18  0              5.2181937e-13  1.1965779e-13  0              2.9938731    
   3000000   10320          200            200            0.0017826356  -0.0019119455   0              0.0072598522   7.3739828e-18  0              7.1212648e-13  1.1965779e-13  0              2.9938731    
Loop time of 298.295 on 4 procs for 3000000 steps with 2501 atoms

Performance: 8689385.710 ns/day, 0.000 hours/ns, 10057.159 timesteps/s
99.9% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 11.015     | 35.705     | 60.988     | 408.9 | 11.97
Neigh   | 6.5279     | 6.6381     | 6.7523     |   4.0 |  2.23
Comm    | 23.4       | 41.634     | 78.554     | 335.2 | 13.96
Output  | 0.27977    | 0.28007    | 0.28039    |   0.1 |  0.09
Modify  | 109.09     | 157.34     | 177.86     | 225.3 | 52.75
Other   |            | 56.7       |            |       | 19.01

Nlocal:         625.25 ave         876 max         375 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:           1.75 ave           3 max           1 min
Histogram: 2 0 0 0 0 1 0 0 0 1
Neighs:         306.75 ave         614 max           0 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 1227
Ave neighs/atom = 0.49060376
Neighbor list builds = 166
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 89

#variable lat0 equal 1                    #
variable lat1 equal 3+(300*0.01)+(v_ind*0.01)  # .491+(v_ind*0.001)       # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 500*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 6.89                                                               
Lattice spacing in x,y,z = 6.89 6.89 6.89

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -5167.5 ${n1e1} -100 100 -100 100 units box
region box block -5167.5 5167.5 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -5167.5 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -5167.5 5167.5 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-5167.5 -100 -100) to (5167.5 100 100)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 1500 atoms
  using lattice units in orthogonal box = (-5167.5 -100 -100) to (5167.5 100 100)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 1500 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 1001 atoms
  using lattice units in orthogonal box = (-5167.5 -100 -100) to (5167.5 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  1500 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  1500 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  1001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  1001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
1500 atoms in group substrate
group slider1 region slider1
1001 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 1001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_89_*.dump id type diameter mass xu yu zu fx fy fz

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 6668 130 130
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 129.1 | 129.1 | 129.1 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   10335          200            200            0              0              0              0              0              0              0              1.1965779e-13  0              6            
    100000   10335          200            200            0.0019489142   2.3448391e-35  0              0.0058467426   576866.59      0              5.5709646e+10  1.1965779e-13  0              3.3329441    
    200000   10335          200            200            0.00065320252  6.2529347e-35  0              0.0019596076   128791.45      0              1.2437757e+10  1.1965779e-13  0              3.0852252    
    300000   10335          200            200           -1.7062732e-05 -1.5631881e-35  0             -5.1188196e-05  200.43847      0              19356913       1.1965779e-13  0              3.0430428    
    400000   10335          200            200           -3.5780129e-05  2.6284985e-40  0             -0.00010734039  950.13337      0              91757080       1.1965779e-13  0              3.0041679    
    500000   10335          200            200            0.0055165103   0.0020735414   0              0.01447599     167.64627      0              16190077       1.1965779e-13  0              2.9912347    
    600000   10335          200            200            0.0036367807   0.0011914785   0              0.0097188635   21.124658      0              2040068.3      1.1965779e-13  0              2.9928364    
    700000   10335          200            200            0.0028863145   0.0012218088   0              0.0074371346   23.821904      0              2300548.9      1.1965779e-13  0              2.9937409    
    800000   10335          200            200            0.002717189    0.0011785067   0              0.0069730602   1.0986802      0              106102.67      1.1965779e-13  0              2.9939462    
    900000   10335          200            200            0.0027801267   0.0011896089   0              0.0071507713   0.15981404     0              15433.696      1.1965779e-13  0              2.9938713    
   1000000   10335          200            200            0.0028202913   0.0011966499   0              0.007264224    0.054697767    0              5282.3188      1.1965779e-13  0              2.9938223    
   1100000   10335          200            200            0.0028209118   0.0011968566   0              0.0072658787   3.2207918e-06  0              0.31104102     1.1965779e-13  0              2.9938212    
   1200000   10335          200            200            0.0028158264   0.0011965882   0              0.007250891    0.0010208316   0              98.584608      1.1965779e-13  0              2.9938276    
   1300000   10335          200            200            0.002814618    0.0011965201   0              0.0072473339   4.7329715e-05  0              4.5707651      1.1965779e-13  0              2.9938292    
   1400000   10335          200            200            0.0028150349   0.0011965424   0              0.0072485622   7.7141403e-06  0              0.74497646     1.1965779e-13  0              2.9938287    
   1500000   10335          200            200            0.0028152909   0.0011965566   0              0.0072493161   2.3947336e-06  0              0.23126623     1.1965779e-13  0              2.9938283    
   1600000   10335          200            200            0.0028152917   0.0011965568   0              0.0072493184   8.896772e-10   0              8.5918656e-05  1.1965779e-13  0              2.9938283    
   1700000   10335          200            200            0.0028152574   0.0011965549   0              0.0072492172   4.6423784e-08  0              0.0044832767   1.1965779e-13  0              2.9938284    
   1800000   10335          200            200            0.0028152496   0.0011965545   0              0.0072491943   1.9364026e-09  0              0.0001870039   1.1965779e-13  0              2.9938284    
   1900000   10335          200            200            0.0028152525   0.0011965546   0              0.0072492029   3.7111576e-10  0              3.5839704e-05  1.1965779e-13  0              2.9938284    
   2000000   10335          200            200            0.0028152542   0.0011965547   0              0.0072492079   1.0469384e-10  0              1.0110581e-05  1.1965779e-13  0              2.9938284    
   2100000   10335          200            200            0.0028152542   0.0011965547   0              0.0072492078   1.0150164e-13  0              9.802302e-09   1.1965779e-13  0              2.9938284    
   2200000   10335          200            200            0.0028152539   0.0011965547   0              0.0072492071   2.1078105e-12  0              2.0355725e-07  1.1965779e-13  0              2.9938284    
   2300000   10335          200            200            0.0028152539   0.0011965547   0              0.007249207    7.8460779e-14  0              7.5771804e-09  1.1965779e-13  0              2.9938284    
   2400000   10335          200            200            0.0028152539   0.0011965547   0              0.0072492071   1.7905579e-14  0              1.7291927e-09  1.1965779e-13  0              2.9938284    
   2500000   10335          200            200            0.0028152539   0.0011965547   0              0.0072492071   4.4847829e-15  0              4.3310823e-10  1.1965779e-13  0              2.9938284    
   2600000   10335          200            200            0.0028152539   0.0011965547   0              0.0072492071   8.1132547e-18  0              7.8352006e-13  1.1965779e-13  0              2.9938284    
   2700000   10335          200            200            0.0028152539   0.0011965547   0              0.0072492071   9.806983e-17   0              9.4708822e-12  1.1965779e-13  0              2.9938284    
   2800000   10335          200            200            0.0028152539   0.0011965547   0              0.0072492071   2.8780894e-19  0              2.7794527e-14  1.1965779e-13  0              2.9938284    
   2900000   10335          200            200            0.0028152539   0.0011965547   0              0.0072492071   1.9589552e-18  0              1.8918187e-13  1.1965779e-13  0              2.9938284    
   3000000   10335          200            200            0.0028152539   0.0011965547   0              0.0072492071   2.897102e-18   0              2.7978137e-13  1.1965779e-13  0              2.9938284    
Loop time of 298.228 on 4 procs for 3000000 steps with 2501 atoms

Performance: 8691335.576 ns/day, 0.000 hours/ns, 10059.416 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 11.057     | 35.691     | 61.142     | 409.2 | 11.97
Neigh   | 6.5372     | 6.6462     | 6.759      |   3.9 |  2.23
Comm    | 23.581     | 41.886     | 78.884     | 334.9 | 14.04
Output  | 0.27291    | 0.27321    | 0.27351    |   0.1 |  0.09
Modify  | 109.18     | 157.14     | 177.97     | 223.8 | 52.69
Other   |            | 56.59      |            |       | 18.98

Nlocal:         625.25 ave         876 max         375 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:           1.75 ave           3 max           1 min
Histogram: 2 0 0 0 0 1 0 0 0 1
Neighs:         307.25 ave         615 max           0 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 1229
Ave neighs/atom = 0.49140344
Neighbor list builds = 166
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 90

#variable lat0 equal 1                    #
variable lat1 equal 3+(300*0.01)+(v_ind*0.01)  # .491+(v_ind*0.001)       # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 500*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 6.9                                                               
Lattice spacing in x,y,z = 6.9 6.9 6.9

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -5175 ${n1e1} -100 100 -100 100 units box
region box block -5175 5175 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -5175 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -5175 5175 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-5175 -100 -100) to (5175 100 100)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 1500 atoms
  using lattice units in orthogonal box = (-5175 -100 -100) to (5175 100 100)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 1500 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 1001 atoms
  using lattice units in orthogonal box = (-5175 -100 -100) to (5175 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  1500 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  1500 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  1001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  1001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
1500 atoms in group substrate
group slider1 region slider1
1001 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 1001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_90_*.dump id type diameter mass xu yu zu fx fy fz

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 6678 130 130
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 129.3 | 129.3 | 129.3 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   10350          200            200            0              0              0              0              0              0              0              1.1965779e-13  0              6            
    100000   10350          200            200            0.0019462284  -3.9023706e-36  0              0.0058386851   576908.13      0              5.5713657e+10  1.1965779e-13  0              3.3330594    
    200000   10350          200            200            0.00065557208 -1.5609191e-35  0              0.0019667162   129844.55      0              1.2539458e+10  1.1965779e-13  0              3.0838792    
    300000   10350          200            200           -2.76398e-05    1.5609759e-35  0             -8.2919401e-05  542.01248      0              52343686       1.1965779e-13  0              3.0425875    
    400000   10350          200            200            0.0045107997   4.6828814e-35  0              0.013532399    7928.2198      0              7.6565072e+08  1.1965779e-13  0              2.9921111    
    500000   10350          200            200            0.0015748139   3.1219207e-35  0              0.0047244417   1141.1911      0              1.1020807e+08  1.1965779e-13  0              2.9960824    
    600000   10350          200            200            0.0018845736  -7.8046243e-36  0              0.0056537209   95.550875      0              9227619.6      1.1965779e-13  0              2.9956734    
    700000   10350          200            200            0.0026882674   1.1649955e-40  0              0.0080648022   3.1178888      0              301103.38      1.1965779e-13  0              2.9944898    
    800000   10350          200            200            0.0023073743  -7.8046638e-36  0              0.006922123    0.0059811915   0              577.62067      1.1965779e-13  0              2.9950265    
    900000   10350          200            200            0.0024496328  -3.9023093e-36  0              0.0073488985   0.080037182    0              7729.4181      1.1965779e-13  0              2.9948245    
   1000000   10350          200            200            0.0024037962  -3.9023344e-36  0              0.0072113887   0.032799683    0              3167.5587      1.1965779e-13  0              2.9948886    
   1100000   10350          200            200            0.0024156693  -9.7555225e-37  0              0.007247008    0.0072408054   0              699.26515      1.1965779e-13  0              2.9948722    
   1200000   10350          200            200            0.0024137758   9.7564021e-37  0              0.0072413275   0.0011159814   0              107.77349      1.1965779e-13  0              2.9948747    
   1300000   10350          200            200            0.0024134617   9.7563942e-37  0              0.007240385    0.00012619621  0              12.187127      1.1965779e-13  0              2.9948752    
   1400000   10350          200            200            0.0024139311   4.3416049e-41  0              0.0072417933   9.8015335e-06  0              0.94656195     1.1965779e-13  0              2.9948745    
   1500000   10350          200            200            0.0024136543  -1.170711e-35   0              0.0072409629   3.7551537e-07  0              0.036264586    1.1965779e-13  0              2.9948749    
   1600000   10350          200            200            0.0024137792  -7.8047254e-36  0              0.0072413376   3.3935513e-11  0              3.2772489e-06  1.1965779e-13  0              2.9948747    
   1700000   10350          200            200            0.0024137316   7.804812e-36   0              0.0072411949   7.5120595e-09  0              0.00072546094  1.1965779e-13  0              2.9948748    
   1800000   10350          200            200            0.0024137471   1.1707197e-35  0              0.0072412413   3.3820552e-09  0              0.00032661468  1.1965779e-13  0              2.9948748    
   1900000   10350          200            200            0.002413743    1.5609581e-35  0              0.007241229    7.7563706e-10  0              7.4905475e-05  1.1965779e-13  0              2.9948748    
   2000000   10350          200            200            0.0024137437   5.4633425e-35  0              0.0072412311   1.2300365e-10  0              1.1878813e-05  1.1965779e-13  0              2.9948748    
   2100000   10350          200            200            0.0024137438  -2.3414263e-35  0              0.0072412313   1.4311962e-11  0              1.3821468e-06  1.1965779e-13  0              2.9948748    
   2200000   10350          200            200            0.0024137436  -4.6828569e-35  0              0.0072412309   1.1572779e-12  0              1.1176162e-07  1.1965779e-13  0              2.9948748    
   2300000   10350          200            200            0.0024137437   3.1219118e-35  0              0.0072412312   4.8796437e-14  0              4.7124106e-09  1.1965779e-13  0              2.9948748    
   2400000   10350          200            200            0.0024137437   3.1219118e-35  0              0.007241231    2.4001231e-17  0              2.3178671e-12  1.1965779e-13  0              2.9948748    
   2500000   10350          200            200            0.0024137437  -1.5609494e-35  0              0.0072412311   7.2754089e-16  0              7.0260692e-11  1.1965779e-13  0              2.9948748    
   2600000   10350          200            200            0.0024137437   1.5609581e-35  0              0.0072412311   3.6548008e-16  0              3.529545e-11   1.1965779e-13  0              2.9948748    
   2700000   10350          200            200            0.0024137437   6.2438193e-35  0              0.0072412311   7.0263599e-17  0              6.7855555e-12  1.1965779e-13  0              2.9948748    
   2800000   10350          200            200            0.0024137437  -3.1219032e-35  0              0.0072412311   1.3218506e-17  0              1.2765487e-12  1.1965779e-13  0              2.9948748    
   2900000   10350          200            200            0.0024137437  -3.1219033e-35  0              0.0072412311   2.5440231e-19  0              2.4568354e-14  1.1965779e-13  0              2.9948748    
   3000000   10350          200            200            0.0024137437   3.1219116e-35  0              0.0072412311   6.0910073e-19  0              5.8822589e-14  1.1965779e-13  0              2.9948748    
Loop time of 295.672 on 4 procs for 3000000 steps with 2501 atoms

Performance: 8766464.409 ns/day, 0.000 hours/ns, 10146.371 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 11.112     | 34.86      | 59.481     | 399.0 | 11.79
Neigh   | 6.5613     | 6.6677     | 6.7757     |   3.8 |  2.26
Comm    | 23.298     | 41.261     | 76.997     | 326.4 | 13.95
Output  | 0.27133    | 0.27163    | 0.27196    |   0.1 |  0.09
Modify  | 109.17     | 156.47     | 177.11     | 221.9 | 52.92
Other   |            | 56.14      |            |       | 18.99

Nlocal:         625.25 ave         876 max         375 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:           1.75 ave           3 max           1 min
Histogram: 2 0 0 0 0 1 0 0 0 1
Neighs:         304.75 ave         610 max           0 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 1219
Ave neighs/atom = 0.48740504
Neighbor list builds = 166
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 91

#variable lat0 equal 1                    #
variable lat1 equal 3+(300*0.01)+(v_ind*0.01)  # .491+(v_ind*0.001)       # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 500*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 6.91                                                               
Lattice spacing in x,y,z = 6.91 6.91 6.91

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -5182.5 ${n1e1} -100 100 -100 100 units box
region box block -5182.5 5182.5 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -5182.5 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -5182.5 5182.5 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-5182.5 -100 -100) to (5182.5 100 100)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 1500 atoms
  using lattice units in orthogonal box = (-5182.5 -100 -100) to (5182.5 100 100)
  create_atoms CPU = 0.000 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 1500 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 1001 atoms
  using lattice units in orthogonal box = (-5182.5 -100 -100) to (5182.5 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  1500 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  1500 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  1001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  1001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
1500 atoms in group substrate
group slider1 region slider1
1001 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 1001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_91_*.dump id type diameter mass xu yu zu fx fy fz

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 6688 130 130
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 129.5 | 129.5 | 129.5 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   10365          200            200            0              0              0              0              0              0              0              1.1965779e-13  0              6            
    100000   10365          200            200            0.0019431766  -9.74184e-37    0              0.0058295298   576818.82      0              5.5705032e+10  1.1965779e-13  0              3.3330168    
    200000   10365          200            200            0.00065094601 -7.7933728e-36  0              0.001952838    128674.63      0              1.2426475e+10  1.1965779e-13  0              3.0853883    
    300000   10365          200            200           -1.7298497e-05 -1.1690182e-35  0             -5.1895491e-05  207.36466      0              20025794       1.1965779e-13  0              3.0430692    
    400000   10365          200            200           -3.6174558e-05 -4.8709195e-37  0             -0.00010852367  978.10012      0              94457908       1.1965779e-13  0              3.004175     
    500000   10365          200            200            0.0043766578  -0.00095659225  0              0.014086566    281.05294      0              27142081       1.1965779e-13  0              2.9913849    
    600000   10365          200            200            0.0028553842  -0.00065604303  0              0.0092221956   77.252209      0              7460465.4      1.1965779e-13  0              2.9930435    
    700000   10365          200            200            0.001968648   -0.0009983321   0              0.0069042761   22.022091      0              2126735.9      1.1965779e-13  0              2.9939885    
    800000   10365          200            200            0.0019511424  -0.0010465559   0              0.0068999832   0.092879521    0              8969.6393      1.1965779e-13  0              2.9939983    
    900000   10365          200            200            0.0020696964  -0.0010322614   0              0.0072413508   0.44948458     0              43408.003      1.1965779e-13  0              2.9938508    
   1000000   10365          200            200            0.0020798701  -0.0010340794   0              0.0072736895   0.00014655153  0              14.152898      1.1965779e-13  0              2.9938359    
   1100000   10365          200            200            0.0020647767  -0.001033758    0              0.007228088    0.0082481572   0              796.54799      1.1965779e-13  0              2.9938552    
   1200000   10365          200            200            0.0020627939  -0.0010337844   0              0.0072221662   2.245936e-06   0              0.21689642     1.1965779e-13  0              2.9938579    
   1300000   10365          200            200            0.0020647822  -0.0010337595   0              0.007228106    0.00014891617  0              14.381257      1.1965779e-13  0              2.9938554    
   1400000   10365          200            200            0.0020651185  -0.0010337549   0              0.0072291105   3.8604646e-07  0              0.037281604    1.1965779e-13  0              2.9938549    
   1500000   10365          200            200            0.0020648617  -0.0010337583   0              0.0072283433   2.6415868e-06  0              0.25510554     1.1965779e-13  0              2.9938553    
   1600000   10365          200            200            0.0020648075  -0.001033759    0              0.0072281814   1.9500059e-08  0              0.0018831761   1.1965779e-13  0              2.9938553    
   1700000   10365          200            200            0.0020648403  -0.0010337586   0              0.0072282794   4.6015683e-08  0              0.0044438653   1.1965779e-13  0              2.9938553    
   1800000   10365          200            200            0.0020648487  -0.0010337585   0              0.0072283046   6.8689434e-10  0              6.6335339e-05  1.1965779e-13  0              2.9938553    
   1900000   10365          200            200            0.0020648446  -0.0010337585   0              0.0072282922   7.8653575e-10  0              7.5957993e-05  1.1965779e-13  0              2.9938553    
   2000000   10365          200            200            0.0020648433  -0.0010337585   0              0.0072282884   2.024687e-11   0              1.9552978e-06  1.1965779e-13  0              2.9938553    
   2100000   10365          200            200            0.0020648438  -0.0010337585   0              0.00722829     1.3178225e-11  0              1.2726587e-06  1.1965779e-13  0              2.9938553    
   2200000   10365          200            200            0.002064844   -0.0010337585   0              0.0072282905   5.3576607e-13  0              5.1740453e-08  1.1965779e-13  0              2.9938553    
   2300000   10365          200            200            0.0020648439  -0.0010337585   0              0.0072282903   2.1596775e-13  0              2.0856619e-08  1.1965779e-13  0              2.9938553    
   2400000   10365          200            200            0.0020648439  -0.0010337585   0              0.0072282903   1.3175304e-14  0              1.2723766e-09  1.1965779e-13  0              2.9938553    
   2500000   10365          200            200            0.0020648439  -0.0010337585   0              0.0072282903   3.36792e-15    0              3.2524961e-10  1.1965779e-13  0              2.9938553    
   2600000   10365          200            200            0.0020648439  -0.0010337585   0              0.0072282903   3.170101e-16   0              3.0614567e-11  1.1965779e-13  0              2.9938553    
   2700000   10365          200            200            0.0020648439  -0.0010337585   0              0.0072282903   6.6850561e-17  0              6.4559487e-12  1.1965779e-13  0              2.9938553    
   2800000   10365          200            200            0.0020648439  -0.0010337585   0              0.0072282903   2.445869e-18   0              2.3620452e-13  1.1965779e-13  0              2.9938553    
   2900000   10365          200            200            0.0020648439  -0.0010337585   0              0.0072282903   7.2891507e-19  0              7.03934e-14    1.1965779e-13  0              2.9938553    
   3000000   10365          200            200            0.0020648439  -0.0010337585   0              0.0072282903   1.9735324e-18  0              1.9058964e-13  1.1965779e-13  0              2.9938553    
Loop time of 297.602 on 4 procs for 3000000 steps with 2501 atoms

Performance: 8709605.990 ns/day, 0.000 hours/ns, 10080.562 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 11.078     | 35.746     | 61.015     | 409.3 | 12.01
Neigh   | 6.5768     | 6.6935     | 6.8127     |   4.1 |  2.25
Comm    | 23.428     | 41.846     | 78.904     | 335.7 | 14.06
Output  | 0.27362    | 0.27392    | 0.27426    |   0.1 |  0.09
Modify  | 109.12     | 156.88     | 177        | 222.7 | 52.71
Other   |            | 56.17      |            |       | 18.87

Nlocal:         625.25 ave         876 max         375 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:           1.75 ave           3 max           1 min
Histogram: 2 0 0 0 0 1 0 0 0 1
Neighs:         306.75 ave         614 max           0 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 1227
Ave neighs/atom = 0.49060376
Neighbor list builds = 166
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 92

#variable lat0 equal 1                    #
variable lat1 equal 3+(300*0.01)+(v_ind*0.01)  # .491+(v_ind*0.001)       # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 500*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 6.92                                                               
Lattice spacing in x,y,z = 6.92 6.92 6.92

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -5190 ${n1e1} -100 100 -100 100 units box
region box block -5190 5190 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -5190 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -5190 5190 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-5190 -100 -100) to (5190 100 100)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 1500 atoms
  using lattice units in orthogonal box = (-5190 -100 -100) to (5190 100 100)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 1500 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 1001 atoms
  using lattice units in orthogonal box = (-5190 -100 -100) to (5190 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  1500 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  1500 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  1001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  1001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
1500 atoms in group substrate
group slider1 region slider1
1001 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 1001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_92_*.dump id type diameter mass xu yu zu fx fy fz

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 6697 130 130
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 129.7 | 129.7 | 129.7 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   10380          200            200            0              0              0              0              0              0              0              1.1965779e-13  0              6            
    100000   10380          200            200            0.001940537   -1.9455523e-36  0              0.005821611    576888         0              5.5711713e+10  1.1965779e-13  0              3.3330055    
    200000   10380          200            200            0.0006505016  -1.5564245e-35  0              0.0019515048   128827.71      0              1.2441258e+10  1.1965779e-13  0              3.0852963    
    300000   10380          200            200           -1.6424726e-05 -1.0895076e-34  0             -4.9274179e-05  187.05675      0              18064602       1.1965779e-13  0              3.0431604    
    400000   10380          200            200           -3.0893127e-05 -6.225659e-35   0             -9.2679381e-05  705.65043      0              68146668       1.1965779e-13  0              3.0044859    
    500000   10380          200            200            0.0033523317  -0.00011105648  0              0.010168052    1166.0836      0              1.12612e+08    1.1965779e-13  0              2.9926827    
    600000   10380          200            200            0.0024302625   0.0014294681   0              0.0058613192   131.45531      0              12695013       1.1965779e-13  0              2.9944581    
    700000   10380          200            200            0.002583282    0.0013303594   0              0.0064194865   5.2678162      0              508727.98      1.1965779e-13  0              2.9942261    
    800000   10380          200            200            0.0028723253   0.0012411117   0              0.0073758642   2.6556994      0              256468.44      1.1965779e-13  0              2.9938083    
    900000   10380          200            200            0.0028560413   0.0012420214   0              0.0073261027   0.10412446     0              10055.595      1.1965779e-13  0              2.9938265    
   1000000   10380          200            200            0.002813344    0.0012449904   0              0.0071950417   0.04628773     0              4470.1376      1.1965779e-13  0              2.9938825    
   1100000   10380          200            200            0.0028161427   0.0012448122   0              0.0072036161   0.0021479301   0              207.43172      1.1965779e-13  0              2.9938793    
   1200000   10380          200            200            0.0028218546   0.0012444024   0              0.0072211615   0.00080735507  0              77.968574      1.1965779e-13  0              2.9938717    
   1300000   10380          200            200            0.0028214003   0.0012444316   0              0.0072197692   4.4116868e-05  0              4.2604913      1.1965779e-13  0              2.9938723    
   1400000   10380          200            200            0.0028206355   0.0012444863   0              0.0072174203   1.4012539e-05  0              1.3532307      1.1965779e-13  0              2.9938733    
   1500000   10380          200            200            0.0028207073   0.0012444816   0              0.0072176402   8.971107e-07   0              0.08663653     1.1965779e-13  0              2.9938732    
   1600000   10380          200            200            0.0028208095   0.0012444743   0              0.0072179541   2.4227433e-07  0              0.02339712     1.1965779e-13  0              2.9938731    
   1700000   10380          200            200            0.0028207984   0.001244475    0              0.0072179202   1.8091525e-08  0              0.00174715     1.1965779e-13  0              2.9938731    
   1800000   10380          200            200            0.0028207848   0.001244476    0              0.0072178783   4.1712682e-09  0              0.00040283123  1.1965779e-13  0              2.9938731    
   1900000   10380          200            200            0.0028207864   0.0012444759   0              0.0072178834   3.6207302e-10  0              3.496642e-05   1.1965779e-13  0              2.9938731    
   2000000   10380          200            200            0.0028207883   0.0012444757   0              0.007217889    7.1497747e-11  0              6.9047406e-06  1.1965779e-13  0              2.9938731    
   2100000   10380          200            200            0.002820788    0.0012444757   0              0.0072178883   7.195683e-12   0              6.9490756e-07  1.1965779e-13  0              2.9938731    
   2200000   10380          200            200            0.0028207878   0.0012444758   0              0.0072178875   1.2190552e-12  0              1.1772763e-07  1.1965779e-13  0              2.9938731    
   2300000   10380          200            200            0.0028207878   0.0012444758   0              0.0072178876   1.425386e-13   0              1.3765357e-08  1.1965779e-13  0              2.9938731    
   2400000   10380          200            200            0.0028207878   0.0012444758   0              0.0072178877   2.0683355e-14  0              1.9974504e-09  1.1965779e-13  0              2.9938731    
   2500000   10380          200            200            0.0028207878   0.0012444758   0              0.0072178877   2.7120198e-15  0              2.6190746e-10  1.1965779e-13  0              2.9938731    
   2600000   10380          200            200            0.0028207878   0.0012444758   0              0.0072178877   3.6235961e-16  0              3.4994097e-11  1.1965779e-13  0              2.9938731    
   2700000   10380          200            200            0.0028207878   0.0012444758   0              0.0072178877   6.7431047e-17  0              6.5120079e-12  1.1965779e-13  0              2.9938731    
   2800000   10380          200            200            0.0028207878   0.0012444758   0              0.0072178877   1.8118699e-18  0              1.7497743e-13  1.1965779e-13  0              2.9938731    
   2900000   10380          200            200            0.0028207878   0.0012444758   0              0.0072178877   2.691863e-18   0              2.5996086e-13  1.1965779e-13  0              2.9938731    
   3000000   10380          200            200            0.0028207878   0.0012444758   0              0.0072178877   5.7554936e-18  0              5.5582438e-13  1.1965779e-13  0              2.9938731    
Loop time of 297.821 on 4 procs for 3000000 steps with 2501 atoms

Performance: 8703222.155 ns/day, 0.000 hours/ns, 10073.174 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 11.027     | 35.577     | 60.754     | 407.6 | 11.95
Neigh   | 6.6021     | 6.721      | 6.841      |   4.2 |  2.26
Comm    | 23.597     | 41.646     | 78.314     | 332.7 | 13.98
Output  | 0.27277    | 0.27308    | 0.27341    |   0.1 |  0.09
Modify  | 109.07     | 157.01     | 177.97     | 224.1 | 52.72
Other   |            | 56.6       |            |       | 19.00

Nlocal:         625.25 ave         876 max         375 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:           1.75 ave           3 max           1 min
Histogram: 2 0 0 0 0 1 0 0 0 1
Neighs:         306.25 ave         613 max           0 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 1225
Ave neighs/atom = 0.48980408
Neighbor list builds = 166
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 93

#variable lat0 equal 1                    #
variable lat1 equal 3+(300*0.01)+(v_ind*0.01)  # .491+(v_ind*0.001)       # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 500*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 6.93                                                               
Lattice spacing in x,y,z = 6.93 6.93 6.93

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -5197.5 ${n1e1} -100 100 -100 100 units box
region box block -5197.5 5197.5 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -5197.5 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -5197.5 5197.5 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-5197.5 -100 -100) to (5197.5 100 100)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 1500 atoms
  using lattice units in orthogonal box = (-5197.5 -100 -100) to (5197.5 100 100)
  create_atoms CPU = 0.000 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 1500 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 1001 atoms
  using lattice units in orthogonal box = (-5197.5 -100 -100) to (5197.5 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  1500 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  1500 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  1001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  1001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
1500 atoms in group substrate
group slider1 region slider1
1001 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 1001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_93_*.dump id type diameter mass xu yu zu fx fy fz

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 6707 130 130
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 129.8 | 129.8 | 129.8 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   10395          200            200            0              0              0              0              0              0              0              1.1965779e-13  0              6            
    100000   10395          200            200            0.0019379132   8.2356353e-41  0              0.0058137396   576963.88      0              5.5719042e+10  1.1965779e-13  0              3.3329664    
    200000   10395          200            200            0.00064975375  4.6671797e-42  0              0.0019492613   128884.13      0              1.2446707e+10  1.1965779e-13  0              3.0853195    
    300000   10395          200            200           -1.5632234e-05 -6.2167552e-35  0             -4.6896703e-05  169.57312      0              16376158       1.1965779e-13  0              3.0432512    
    400000   10395          200            200           -2.8707385e-05  3.1084471e-35  0             -8.6122155e-05  607.66786      0              58684212       1.1965779e-13  0              3.0046356    
    500000   10395          200            200            0.0025763708  -0.0015012082   0              0.0092303207   1284.9627      0              1.240925e+08   1.1965779e-13  0              2.9930707    
    600000   10395          200            200            0.0017533875  -0.00032165367  0              0.0055818162   106.59524      0              10294205       1.1965779e-13  0              2.9946302    
    700000   10395          200            200            0.0022094662  -0.00045071971  0              0.0070791182   24.741491      0              2389356.1      1.1965779e-13  0              2.9939821    
    800000   10395          200            200            0.0022913994  -0.00053408673  0              0.007408285    2.201344       0              212590.04      1.1965779e-13  0              2.9938346    
    900000   10395          200            200            0.002199218   -0.000498135    0              0.0070957889   0.088037763    0              8502.057       1.1965779e-13  0              2.9939679    
   1000000   10395          200            200            0.0022489018  -0.00050695314  0              0.0072536586   1.3693607e-05  0              1.3224306      1.1965779e-13  0              2.9939011    
   1100000   10395          200            200            0.0022296149  -0.0005037064   0              0.007192551    0.0018047324   0              174.28814      1.1965779e-13  0              2.9939266    
   1200000   10395          200            200            0.0022355078  -0.00050470483  0              0.0072112284   0.00074771398  0              72.208864      1.1965779e-13  0              2.9939189    
   1300000   10395          200            200            0.0022342438  -0.00050449714  0              0.0072072285   0.00014835561  0              14.327123      1.1965779e-13  0              2.9939205    
   1400000   10395          200            200            0.0022342765  -0.00050449929  0              0.0072073288   1.8413544e-05  0              1.7782483      1.1965779e-13  0              2.9939205    
   1500000   10395          200            200            0.0022344256  -0.00050452595  0              0.0072078029   1.3643668e-06  0              0.13176078     1.1965779e-13  0              2.9939203    
   1600000   10395          200            200            0.0022343235  -0.00050450819  0              0.0072074788   3.4711483e-08  0              0.0033521866   1.1965779e-13  0              2.9939204    
   1700000   10395          200            200            0.0022343703  -0.00050451623  0              0.0072076272   1.26257e-09    0              0.00012192998  1.1965779e-13  0              2.9939204    
   1800000   10395          200            200            0.0022343534  -0.00050451336  0              0.0072075737   2.3443703e-09  0              0.0002264025   1.1965779e-13  0              2.9939204    
   1900000   10395          200            200            0.0022343582  -0.00050451415  0              0.0072075887   7.2516683e-10  0              7.0031422e-05  1.1965779e-13  0              2.9939204    
   2000000   10395          200            200            0.0022343574  -0.00050451402  0              0.0072075861   1.2344716e-10  0              1.1921643e-05  1.1965779e-13  0              2.9939204    
   2100000   10395          200            200            0.0022343573  -0.000504514    0              0.0072075858   1.3291175e-11  0              1.2835666e-06  1.1965779e-13  0              2.9939204    
   2200000   10395          200            200            0.0022343574  -0.00050451403  0              0.0072075863   7.9178242e-13  0              7.6464678e-08  1.1965779e-13  0              2.9939204    
   2300000   10395          200            200            0.0022343573  -0.00050451401  0              0.007207586    8.3342684e-15  0              8.0486399e-10  1.1965779e-13  0              2.9939204    
   2400000   10395          200            200            0.0022343574  -0.00050451402  0              0.0072075861   3.6163107e-15  0              3.492374e-10   1.1965779e-13  0              2.9939204    
   2500000   10395          200            200            0.0022343574  -0.00050451402  0              0.0072075861   2.648233e-15   0              2.5574739e-10  1.1965779e-13  0              2.9939204    
   2600000   10395          200            200            0.0022343574  -0.00050451402  0              0.0072075861   6.5208857e-16  0              6.2974046e-11  1.1965779e-13  0              2.9939204    
   2700000   10395          200            200            0.0022343574  -0.00050451402  0              0.0072075861   9.9109297e-17  0              9.5712665e-12  1.1965779e-13  0              2.9939204    
   2800000   10395          200            200            0.0022343574  -0.00050451402  0              0.0072075861   1.251239e-17   0              1.208357e-12   1.1965779e-13  0              2.9939204    
   2900000   10395          200            200            0.0022343574  -0.00050451402  0              0.0072075861   1.8030667e-18  0              1.7412728e-13  1.1965779e-13  0              2.9939204    
   3000000   10395          200            200            0.0022343574  -0.00050451402  0              0.0072075861   6.0681582e-18  0              5.8601928e-13  1.1965779e-13  0              2.9939204    
Loop time of 298.182 on 4 procs for 3000000 steps with 2501 atoms

Performance: 8692670.788 ns/day, 0.000 hours/ns, 10060.962 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 11.049     | 35.863     | 61.118     | 411.2 | 12.03
Neigh   | 6.438      | 6.5655     | 6.6946     |   4.6 |  2.20
Comm    | 23.376     | 41.474     | 78.484     | 336.4 | 13.91
Output  | 0.27134    | 0.27163    | 0.27193    |   0.1 |  0.09
Modify  | 109.06     | 157.19     | 178.32     | 224.9 | 52.72
Other   |            | 56.82      |            |       | 19.05

Nlocal:         625.25 ave         876 max         375 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:           1.75 ave           3 max           1 min
Histogram: 2 0 0 0 0 1 0 0 0 1
Neighs:         307.25 ave         615 max           0 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 1229
Ave neighs/atom = 0.49140344
Neighbor list builds = 166
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 94

#variable lat0 equal 1                    #
variable lat1 equal 3+(300*0.01)+(v_ind*0.01)  # .491+(v_ind*0.001)       # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 500*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 6.94                                                               
Lattice spacing in x,y,z = 6.94 6.94 6.94

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -5205 ${n1e1} -100 100 -100 100 units box
region box block -5205 5205 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -5205 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -5205 5205 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-5205 -100 -100) to (5205 100 100)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 1500 atoms
  using lattice units in orthogonal box = (-5205 -100 -100) to (5205 100 100)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 1500 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 1001 atoms
  using lattice units in orthogonal box = (-5205 -100 -100) to (5205 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  1500 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  1500 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  1001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  1001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
1500 atoms in group substrate
group slider1 region slider1
1001 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 1001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_94_*.dump id type diameter mass xu yu zu fx fy fz

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 6717 130 130
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 130 | 130 | 130 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   10410          200            200            0              0              0              0              0              0              0              1.1965779e-13  0              6            
    100000   10410          200            200            0.0019345348   4.6558747e-35  0              0.0058036044   576719.12      0              5.5695404e+10  1.1965779e-13  0              3.3330337    
    200000   10410          200            200            0.00064755502  6.2078345e-34  0              0.001942665    128497.59      0              1.2409378e+10  1.1965779e-13  0              3.0854624    
    300000   10410          200            200           -1.7996441e-05 -3.1038815e-35  0             -5.3989322e-05  226.86615      0              21909109       1.1965779e-13  0              3.0429404    
    400000   10410          200            200           -3.6790334e-05  3.2450082e-42  0             -0.000110371    1022.6443      0              98759668       1.1965779e-13  0              3.0040389    
    500000   10410          200            200            0.0064137128   0.0054660219   0              0.013775116    352.59217      0              34050828       1.1965779e-13  0              2.99138      
    600000   10410          200            200            0.0035992226   0.0024524799   0              0.0083451879   148.47786      0              14338929       1.1965779e-13  0              2.9932869    
    700000   10410          200            200            0.0025625593   0.0013233905   0              0.0063642873   3.8829536      0              374987.87      1.1965779e-13  0              2.9941402    
    800000   10410          200            200            0.0028786893   0.001486055    0              0.0071500127   3.287211       0              317455.31      1.1965779e-13  0              2.9938014    
    900000   10410          200            200            0.0029400234   0.0015010281   0              0.0073190421   0.010966293    0              1059.0461      1.1965779e-13  0              2.9937266    
   1000000   10410          200            200            0.0028880265   0.0014877219   0              0.0071763576   0.049165866    0              4748.0874      1.1965779e-13  0              2.993787     
   1100000   10410          200            200            0.0028911142   0.0014884454   0              0.0071848973   0.003923453    0              378.89901      1.1965779e-13  0              2.9937838    
   1200000   10410          200            200            0.0028974565   0.0014901257   0              0.0072022438   0.00026267191  0              25.366973      1.1965779e-13  0              2.9937764    
   1300000   10410          200            200            0.0028956522   0.0014896622   0              0.0071972943   0.00014410539  0              13.916667      1.1965779e-13  0              2.9937784    
   1400000   10410          200            200            0.0028951919   0.0014895375   0              0.0071960382   1.9672733e-07  0              0.018998518    1.1965779e-13  0              2.993779     
   1500000   10410          200            200            0.0028955362   0.0014896274   0              0.0071969812   2.3182415e-06  0              0.22387917     1.1965779e-13  0              2.9937786    
   1600000   10410          200            200            0.0028955229   0.0014896246   0              0.0071969441   1.5480065e-07  0              0.014949539    1.1965779e-13  0              2.9937786    
   1700000   10410          200            200            0.0028954793   0.0014896131   0              0.0071968249   1.4217984e-08  0              0.0013730711   1.1965779e-13  0              2.9937786    
   1800000   10410          200            200            0.0028954907   0.001489616    0              0.007196856    6.2748061e-09  0              0.00060597586  1.1965779e-13  0              2.9937786    
   1900000   10410          200            200            0.0028954941   0.0014896169   0              0.0071968653   1.6040723e-12  0              1.5490983e-07  1.1965779e-13  0              2.9937786    
   2000000   10410          200            200            0.0028954918   0.0014896163   0              0.0071968591   1.0838249e-10  0              1.0466805e-05  1.1965779e-13  0              2.9937786    
   2100000   10410          200            200            0.0028954918   0.0014896163   0              0.0071968592   6.0112732e-12  0              5.8052574e-07  1.1965779e-13  0              2.9937786    
   2200000   10410          200            200            0.0028954921   0.0014896164   0              0.00719686     7.5287512e-13  0              7.2707291e-08  1.1965779e-13  0              2.9937786    
   2300000   10410          200            200            0.0028954921   0.0014896164   0              0.0071968598   2.7118936e-13  0              2.6189527e-08  1.1965779e-13  0              2.9937786    
   2400000   10410          200            200            0.002895492    0.0014896163   0              0.0071968597   8.0346751e-18  0              7.7593141e-13  1.1965779e-13  0              2.9937786    
   2500000   10410          200            200            0.002895492    0.0014896163   0              0.0071968598   4.9641922e-15  0              4.7940615e-10  1.1965779e-13  0              2.9937786    
   2600000   10410          200            200            0.002895492    0.0014896163   0              0.0071968598   2.2186009e-16  0              2.1425659e-11  1.1965779e-13  0              2.9937786    
   2700000   10410          200            200            0.002895492    0.0014896163   0              0.0071968598   2.5039039e-17  0              2.4180911e-12  1.1965779e-13  0              2.9937786    
   2800000   10410          200            200            0.002895492    0.0014896163   0              0.0071968598   1.3394461e-17  0              1.2935412e-12  1.1965779e-13  0              2.9937786    
   2900000   10410          200            200            0.002895492    0.0014896163   0              0.0071968598   1.932545e-20   0              1.8663137e-15  1.1965779e-13  0              2.9937786    
   3000000   10410          200            200            0.002895492    0.0014896164   0              0.0071968598   1.010566e-18   0              9.7593227e-14  1.1965779e-13  0              2.9937786    
Loop time of 298.556 on 4 procs for 3000000 steps with 2501 atoms

Performance: 8681776.607 ns/day, 0.000 hours/ns, 10048.353 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 11.134     | 35.684     | 61.161     | 408.6 | 11.95
Neigh   | 6.518      | 6.645      | 6.7744     |   4.6 |  2.23
Comm    | 23.32      | 41.826     | 78.924     | 336.3 | 14.01
Output  | 0.27109    | 0.27139    | 0.27172    |   0.1 |  0.09
Modify  | 109.17     | 157.45     | 178.25     | 225.2 | 52.74
Other   |            | 56.68      |            |       | 18.98

Nlocal:         625.25 ave         876 max         375 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:           1.75 ave           3 max           1 min
Histogram: 2 0 0 0 0 1 0 0 0 1
Neighs:         306.75 ave         614 max           0 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 1227
Ave neighs/atom = 0.49060376
Neighbor list builds = 166
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 95

#variable lat0 equal 1                    #
variable lat1 equal 3+(300*0.01)+(v_ind*0.01)  # .491+(v_ind*0.001)       # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 500*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 6.95                                                               
Lattice spacing in x,y,z = 6.95 6.95 6.95

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -5212.5 ${n1e1} -100 100 -100 100 units box
region box block -5212.5 5212.5 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -5212.5 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -5212.5 5212.5 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-5212.5 -100 -100) to (5212.5 100 100)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 1500 atoms
  using lattice units in orthogonal box = (-5212.5 -100 -100) to (5212.5 100 100)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 1500 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 1001 atoms
  using lattice units in orthogonal box = (-5212.5 -100 -100) to (5212.5 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  1500 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  1500 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  1001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  1001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
1500 atoms in group substrate
group slider1 region slider1
1001 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 1001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_95_*.dump id type diameter mass xu yu zu fx fy fz

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 6726 130 130
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 130.1 | 130.1 | 130.1 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   10425          200            200            0              0              0              0              0              0              0              1.1965779e-13  0              6            
    100000   10425          200            200            0.0019317627   8.8521078e-42  0              0.0057952882   576731.07      0              5.5696558e+10  1.1965779e-13  0              3.3329738    
    200000   10425          200            200            0.00064668026  3.0712675e-41  0              0.0019400408   128518.42      0              1.241139e+10   1.1965779e-13  0              3.0853779    
    300000   10425          200            200           -1.8231111e-05 -1.5496801e-35  0             -5.4693332e-05  233.66051      0              22565259       1.1965779e-13  0              3.0428826    
    400000   10425          200            200           -3.8787179e-05  7.7486889e-36  0             -0.00011636154  1146.2198      0              1.106937e+08   1.1965779e-13  0              3.0038784    
    500000   10425          200            200            0.0041421622  -0.0024569735   0              0.01488346     5.7251697      0              552895.91      1.1965779e-13  0              2.9910049    
    600000   10425          200            200            0.0025706194  -0.001940072    0              0.0096519304   17.642254      0              1703762.6      1.1965779e-13  0              2.9927463    
    700000   10425          200            200            0.0019614995  -0.0019635235   0              0.0078480221   11.352631      0              1096355.9      1.1965779e-13  0              2.993463     
    800000   10425          200            200            0.0017798754  -0.0019274851   0              0.0072671112   3.1188666      0              301197.81      1.1965779e-13  0              2.9937162    
    900000   10425          200            200            0.0017431015  -0.0019196904   0              0.0071489949   0.39958048     0              38588.623      1.1965779e-13  0              2.9937672    
   1000000   10425          200            200            0.0017441143  -0.0019200476   0              0.0071523904   0.02335751     0              2255.7012      1.1965779e-13  0              2.9937649    
   1100000   10425          200            200            0.0017496949  -0.0019213303   0              0.0071704151   8.4518558e-05  0              8.1621974      1.1965779e-13  0              2.9937566    
   1200000   10425          200            200            0.0017530162  -0.001922074    0              0.0071811226   0.00022346252  0              21.58041       1.1965779e-13  0              2.9937518    
   1300000   10425          200            200            0.0017543171  -0.001922361    0              0.0071853122   0.00010992359  0              10.615634      1.1965779e-13  0              2.9937499    
   1400000   10425          200            200            0.0017546731  -0.0019224381   0              0.0071864575   1.9938417e-05  0              1.9255096      1.1965779e-13  0              2.9937494    
   1500000   10425          200            200            0.0017547176  -0.0019224472   0              0.0071866001   1.8117244e-06  0              0.17496338     1.1965779e-13  0              2.9937493    
   1600000   10425          200            200            0.0017546971  -0.0019224423   0              0.0071865338   5.2743489e-08  0              0.0050935886   1.1965779e-13  0              2.9937494    
   1700000   10425          200            200            0.0017546785  -0.0019224381   0              0.0071864735   1.5715367e-09  0              0.00015176777  1.1965779e-13  0              2.9937494    
   1800000   10425          200            200            0.0017546697  -0.0019224362   0              0.0071864452   3.0807446e-09  0              0.00029751626  1.1965779e-13  0              2.9937494    
   1900000   10425          200            200            0.0017546668  -0.0019224355   0              0.0071864358   8.3922238e-10  0              8.104609e-05   1.1965779e-13  0              2.9937494    
   2000000   10425          200            200            0.0017546661  -0.0019224354   0              0.0071864338   1.0860125e-10  0              1.0487932e-05  1.1965779e-13  0              2.9937494    
   2100000   10425          200            200            0.0017546662  -0.0019224354   0              0.0071864339   6.4229911e-12  0              6.2028651e-07  1.1965779e-13  0              2.9937494    
   2200000   10425          200            200            0.0017546662  -0.0019224354   0              0.0071864342   2.5932321e-14  0              2.504358e-09   1.1965779e-13  0              2.9937494    
   2300000   10425          200            200            0.0017546663  -0.0019224354   0              0.0071864343   5.9024734e-14  0              5.7001863e-09  1.1965779e-13  0              2.9937494    
   2400000   10425          200            200            0.0017546663  -0.0019224354   0              0.0071864344   2.9599789e-14  0              2.8585358e-09  1.1965779e-13  0              2.9937494    
   2500000   10425          200            200            0.0017546663  -0.0019224354   0              0.0071864344   5.3953179e-15  0              5.2104118e-10  1.1965779e-13  0              2.9937494    
   2600000   10425          200            200            0.0017546663  -0.0019224354   0              0.0071864344   4.9488129e-16  0              4.7792092e-11  1.1965779e-13  0              2.9937494    
   2700000   10425          200            200            0.0017546663  -0.0019224354   0              0.0071864344   3.0900628e-17  0              2.9841615e-12  1.1965779e-13  0              2.9937494    
   2800000   10425          200            200            0.0017546663  -0.0019224354   0              0.0071864344   3.6026589e-19  0              3.4791901e-14  1.1965779e-13  0              2.9937494    
   2900000   10425          200            200            0.0017546663  -0.0019224354   0              0.0071864344   6.5242502e-19  0              6.3006539e-14  1.1965779e-13  0              2.9937494    
   3000000   10425          200            200            0.0017546663  -0.0019224354   0              0.0071864344   2.0918552e-18  0              2.020164e-13   1.1965779e-13  0              2.9937494    
Loop time of 298.231 on 4 procs for 3000000 steps with 2501 atoms

Performance: 8691250.552 ns/day, 0.000 hours/ns, 10059.318 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 11.013     | 35.342     | 60.187     | 405.0 | 11.85
Neigh   | 6.6433     | 6.7517     | 6.8635     |   3.9 |  2.26
Comm    | 23.841     | 41.6       | 77.771     | 328.4 | 13.95
Output  | 0.26754    | 0.26785    | 0.26818    |   0.1 |  0.09
Modify  | 109.12     | 157.19     | 178.77     | 225.4 | 52.71
Other   |            | 57.07      |            |       | 19.14

Nlocal:         625.25 ave         876 max         375 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:           1.75 ave           3 max           1 min
Histogram: 2 0 0 0 0 1 0 0 0 1
Neighs:         306.25 ave         613 max           0 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 1225
Ave neighs/atom = 0.48980408
Neighbor list builds = 166
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 96

#variable lat0 equal 1                    #
variable lat1 equal 3+(300*0.01)+(v_ind*0.01)  # .491+(v_ind*0.001)       # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 500*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 6.96                                                               
Lattice spacing in x,y,z = 6.96 6.96 6.96

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -5220 ${n1e1} -100 100 -100 100 units box
region box block -5220 5220 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -5220 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -5220 5220 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-5220 -100 -100) to (5220 100 100)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 1500 atoms
  using lattice units in orthogonal box = (-5220 -100 -100) to (5220 100 100)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 1500 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 1001 atoms
  using lattice units in orthogonal box = (-5220 -100 -100) to (5220 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  1500 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  1500 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  1001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  1001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
1500 atoms in group substrate
group slider1 region slider1
1001 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 1001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_96_*.dump id type diameter mass xu yu zu fx fy fz

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 6736 130 130
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 130.3 | 130.3 | 130.3 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   10440          200            200            0              0              0              0              0              0              0              1.1965779e-13  0              6            
    100000   10440          200            200            0.0019287195  -4.6424846e-35  0              0.0057861586   576605.3       0              5.5684413e+10  1.1965779e-13  0              3.3331161    
    200000   10440          200            200            0.00064493638  1.5475046e-35  0              0.0019348091   128259.19      0              1.2386354e+10  1.1965779e-13  0              3.0856845    
    300000   10440          200            200           -1.9495649e-05  3.5701935e-41  0             -5.8486946e-05  268.86582      0              25965136       1.1965779e-13  0              3.0428822    
    400000   10440          200            200           -3.8454199e-05  1.0210858e-40  0             -0.0001153626   1129.0037      0              1.0903109e+08  1.1965779e-13  0              3.0039283    
    500000   10440          200            200            0.0042978615  -0.0017016458   0              0.01459523     0.98313023     0              94943.681      1.1965779e-13  0              2.9910922    
    600000   10440          200            200            0.0028137315  -0.0010609158   0              0.0095021105   31.900447      0              3080716.8      1.1965779e-13  0              2.992929     
    700000   10440          200            200            0.002047934   -0.00091762302  0              0.0070614251   24.607633      0              2376429        1.1965779e-13  0              2.9939336    
    800000   10440          200            200            0.0019782375  -0.00091093477  0              0.0068456472   0.038662713    0              3733.7681      1.1965779e-13  0              2.9940351    
    900000   10440          200            200            0.0020737487  -0.00091924142  0              0.0071404876   0.41279987     0              39865.257      1.1965779e-13  0              2.993908     
   1000000   10440          200            200            0.0020982974  -0.00092134098  0              0.0072162331   0.01416433     0              1367.8896      1.1965779e-13  0              2.9938744    
   1100000   10440          200            200            0.0020887919  -0.00092057313  0              0.0071869489   0.0048709968   0              470.40601      1.1965779e-13  0              2.9938868    
   1200000   10440          200            200            0.0020841333  -0.00092018068  0              0.0071725807   0.00067583042  0              65.266864      1.1965779e-13  0              2.993893     
   1300000   10440          200            200            0.0020847507  -0.00092022898  0              0.0071744811   3.259176e-05   0              3.1474789      1.1965779e-13  0              2.9938923    
   1400000   10440          200            200            0.0020854673  -0.00092028888  0              0.0071766908   1.868052e-05   0              1.8040309      1.1965779e-13  0              2.9938913    
   1500000   10440          200            200            0.0020854862  -0.00092029091  0              0.0071767495   2.3758197e-08  0              0.0022943967   1.1965779e-13  0              2.9938913    
   1600000   10440          200            200            0.0020853922  -0.00092028312  0              0.0071764597   3.6623985e-07  0              0.035368823    1.1965779e-13  0              2.9938914    
   1700000   10440          200            200            0.0020853762  -0.00092028173  0              0.0071764105   4.2883235e-09  0              0.00041413559  1.1965779e-13  0              2.9938914    
   1800000   10440          200            200            0.0020853867  -0.00092028259  0              0.0071764425   5.2306213e-09  0              0.00050513596  1.1965779e-13  0              2.9938914    
   1900000   10440          200            200            0.0020853903  -0.00092028289  0              0.0071764538   3.6664641e-10  0              3.5408086e-05  1.1965779e-13  0              2.9938914    
   2000000   10440          200            200            0.0020853894  -0.00092028282  0              0.007176451    4.9404342e-11  0              4.7711177e-06  1.1965779e-13  0              2.9938914    
   2100000   10440          200            200            0.0020853888  -0.00092028277  0              0.0071764491   1.2856928e-11  0              1.2416301e-06  1.1965779e-13  0              2.9938914    
   2200000   10440          200            200            0.0020853888  -0.00092028277  0              0.0071764492   1.9104583e-13  0              1.8449839e-08  1.1965779e-13  0              2.9938914    
   2300000   10440          200            200            0.0020853889  -0.00092028278  0              0.0071764495   2.9821975e-13  0              2.8799929e-08  1.1965779e-13  0              2.9938914    
   2400000   10440          200            200            0.0020853889  -0.00092028278  0              0.0071764495   3.8691592e-16  0              3.736557e-11   1.1965779e-13  0              2.9938914    
   2500000   10440          200            200            0.0020853889  -0.00092028278  0              0.0071764495   5.0903427e-15  0              4.9158886e-10  1.1965779e-13  0              2.9938914    
   2600000   10440          200            200            0.0020853889  -0.00092028278  0              0.0071764495   1.5812725e-16  0              1.5270798e-11  1.1965779e-13  0              2.9938914    
   2700000   10440          200            200            0.0020853889  -0.00092028278  0              0.0071764495   7.4672329e-17  0              7.2113191e-12  1.1965779e-13  0              2.9938914    
   2800000   10440          200            200            0.0020853889  -0.00092028278  0              0.0071764495   3.4004405e-18  0              3.283902e-13   1.1965779e-13  0              2.9938914    
   2900000   10440          200            200            0.0020853889  -0.00092028278  0              0.0071764495   2.0914151e-18  0              2.019739e-13   1.1965779e-13  0              2.9938914    
   3000000   10440          200            200            0.0020853889  -0.00092028278  0              0.0071764495   4.7113028e-18  0              4.549839e-13   1.1965779e-13  0              2.9938914    
Loop time of 297.682 on 4 procs for 3000000 steps with 2501 atoms

Performance: 8707267.340 ns/day, 0.000 hours/ns, 10077.856 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 11.04      | 35.272     | 60.072     | 404.6 | 11.85
Neigh   | 6.6621     | 6.7769     | 6.8956     |   4.1 |  2.28
Comm    | 23.805     | 41.574     | 77.733     | 328.4 | 13.97
Output  | 0.27653    | 0.27682    | 0.27714    |   0.1 |  0.09
Modify  | 109.25     | 156.92     | 178.45     | 223.4 | 52.71
Other   |            | 56.87      |            |       | 19.10

Nlocal:         625.25 ave         876 max         375 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:           1.75 ave           3 max           1 min
Histogram: 2 0 0 0 0 1 0 0 0 1
Neighs:         306.25 ave         613 max           0 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 1225
Ave neighs/atom = 0.48980408
Neighbor list builds = 166
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 97

#variable lat0 equal 1                    #
variable lat1 equal 3+(300*0.01)+(v_ind*0.01)  # .491+(v_ind*0.001)       # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 500*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 6.97                                                               
Lattice spacing in x,y,z = 6.97 6.97 6.97

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -5227.5 ${n1e1} -100 100 -100 100 units box
region box block -5227.5 5227.5 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -5227.5 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -5227.5 5227.5 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-5227.5 -100 -100) to (5227.5 100 100)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 1500 atoms
  using lattice units in orthogonal box = (-5227.5 -100 -100) to (5227.5 100 100)
  create_atoms CPU = 0.000 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 1500 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 1001 atoms
  using lattice units in orthogonal box = (-5227.5 -100 -100) to (5227.5 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  1500 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  1500 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  1001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  1001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
1500 atoms in group substrate
group slider1 region slider1
1001 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 1001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_97_*.dump id type diameter mass xu yu zu fx fy fz

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 6746 130 130
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 130.4 | 130.5 | 130.5 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   10455          200            200            0              0              0              0              0              0              0              1.1965779e-13  0              6            
    100000   10455          200            200            0.0019263572   1.390752e-34   0              0.0057790716   576773.88      0              5.5700693e+10  1.1965779e-13  0              3.3330795    
    200000   10455          200            200            0.0006451779   7.7264982e-36  0              0.0019355337   128622.18      0              1.242141e+10   1.1965779e-13  0              3.0854499    
    300000   10455          200            200           -1.7214858e-05 -1.2362067e-34  0             -5.1644575e-05  208.98173      0              20181960       1.1965779e-13  0              3.0430717    
    400000   10455          200            200           -3.404147e-05   6.1811558e-35  0             -0.00010212441  877.01397      0              84695732       1.1965779e-13  0              3.0042718    
    500000   10455          200            200            0.0039751658  -0.00094388638  0              0.012869384    591.30351      0              57103861       1.1965779e-13  0              2.9917216    
    600000   10455          200            200            0.0027708979   0.00036136615  0              0.0079513274   168.56491      0              16278793       1.1965779e-13  0              2.993495     
    700000   10455          200            200            0.0021176551   1.2365474e-05  0              0.0063405998   3.8437333      0              371200.25      1.1965779e-13  0              2.9942053    
    800000   10455          200            200            0.0023771678   6.0826632e-05  0              0.0070706768   3.0778796      0              297239.58      1.1965779e-13  0              2.9938855    
    900000   10455          200            200            0.0024494117   5.9005946e-05  0              0.0072892291   0.0026951338   0              260.27673      1.1965779e-13  0              2.9937892    
   1000000   10455          200            200            0.002405578    5.8060918e-05  0              0.0071586731   0.059785       0              5773.6074      1.1965779e-13  0              2.9938445    
   1100000   10455          200            200            0.0024028979   5.7976608e-05  0              0.007150717    0.0011637121   0              112.38299      1.1965779e-13  0              2.9938483    
   1200000   10455          200            200            0.0024093786   5.8523502e-05  0              0.0071696122   0.00074123553  0              71.583222      1.1965779e-13  0              2.9938402    
   1300000   10455          200            200            0.0024086539   5.8465681e-05  0              0.0071674961   8.4873938e-05  0              8.1965175      1.1965779e-13  0              2.9938411    
   1400000   10455          200            200            0.0024079017   5.8401117e-05  0              0.007165304    4.4682852e-06  0              0.431515       1.1965779e-13  0              2.993842     
   1500000   10455          200            200            0.0024081268   5.8419816e-05  0              0.0071659606   2.5627567e-06  0              0.2474927      1.1965779e-13  0              2.9938417    
   1600000   10455          200            200            0.0024081902   5.8425358e-05  0              0.0071661453   2.0295864e-10  0              1.9600293e-05  1.1965779e-13  0              2.9938416    
   1700000   10455          200            200            0.0024081491   5.8421895e-05  0              0.0071660254   4.7707191e-08  0              0.004607219    1.1965779e-13  0              2.9938417    
   1800000   10455          200            200            0.0024081475   5.8421734e-05  0              0.0071660208   1.2284885e-09  0              0.00011863862  1.1965779e-13  0              2.9938417    
   1900000   10455          200            200            0.0024081533   5.8422228e-05  0              0.0071660378   5.540899e-10   0              5.3510036e-05  1.1965779e-13  0              2.9938417    
   2000000   10455          200            200            0.0024081526   5.8422166e-05  0              0.0071660355   7.5927911e-11  0              7.3325742e-06  1.1965779e-13  0              2.9938417    
   2100000   10455          200            200            0.0024081519   5.842211e-05   0              0.0071660336   2.8943948e-12  0              2.7951993e-07  1.1965779e-13  0              2.9938417    
   2200000   10455          200            200            0.0024081521   5.8422128e-05  0              0.0071660342   2.1413628e-12  0              2.0679749e-07  1.1965779e-13  0              2.9938417    
   2300000   10455          200            200            0.0024081522   5.8422132e-05  0              0.0071660344   3.5644904e-16  0              3.4423297e-11  1.1965779e-13  0              2.9938417    
   2400000   10455          200            200            0.0024081521   5.8422129e-05  0              0.0071660343   3.7781447e-14  0              3.6486617e-09  1.1965779e-13  0              2.9938417    
   2500000   10455          200            200            0.0024081521   5.8422129e-05  0              0.0071660343   1.1627187e-15  0              1.1228705e-10  1.1965779e-13  0              2.9938417    
   2600000   10455          200            200            0.0024081521   5.842213e-05   0              0.0071660343   4.1530737e-16  0              4.0107413e-11  1.1965779e-13  0              2.9938417    
   2700000   10455          200            200            0.0024081521   5.842213e-05   0              0.0071660343   7.9519279e-17  0              7.6794028e-12  1.1965779e-13  0              2.9938417    
   2800000   10455          200            200            0.0024081521   5.842213e-05   0              0.0071660343   2.5228355e-20  0              2.436374e-15   1.1965779e-13  0              2.9938417    
   2900000   10455          200            200            0.0024081521   5.842213e-05   0              0.0071660343   4.2809647e-18  0              4.1342493e-13  1.1965779e-13  0              2.9938417    
   3000000   10455          200            200            0.0024081521   5.842213e-05   0              0.0071660343   5.8202912e-18  0              5.6208207e-13  1.1965779e-13  0              2.9938417    
Loop time of 300.488 on 4 procs for 3000000 steps with 2501 atoms

Performance: 8625960.440 ns/day, 0.000 hours/ns, 9983.751 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 11.253     | 35.631     | 60.412     | 407.3 | 11.86
Neigh   | 6.5956     | 6.7201     | 6.8467     |   4.5 |  2.24
Comm    | 23.388     | 43.14      | 80.472     | 335.3 | 14.36
Output  | 0.27308    | 0.2734     | 0.27375    |   0.1 |  0.09
Modify  | 109.62     | 158.11     | 178.16     | 224.8 | 52.62
Other   |            | 56.61      |            |       | 18.84

Nlocal:         625.25 ave         876 max         375 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:           1.75 ave           3 max           1 min
Histogram: 2 0 0 0 0 1 0 0 0 1
Neighs:         306.25 ave         613 max           0 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 1225
Ave neighs/atom = 0.48980408
Neighbor list builds = 166
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 98

#variable lat0 equal 1                    #
variable lat1 equal 3+(300*0.01)+(v_ind*0.01)  # .491+(v_ind*0.001)       # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 500*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 6.98                                                               
Lattice spacing in x,y,z = 6.98 6.98 6.98

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -5235 ${n1e1} -100 100 -100 100 units box
region box block -5235 5235 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -5235 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -5235 5235 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-5235 -100 -100) to (5235 100 100)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 1500 atoms
  using lattice units in orthogonal box = (-5235 -100 -100) to (5235 100 100)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 1500 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 1001 atoms
  using lattice units in orthogonal box = (-5235 -100 -100) to (5235 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  1500 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  1500 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  1001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  1001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
1500 atoms in group substrate
group slider1 region slider1
1001 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 1001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_98_*.dump id type diameter mass xu yu zu fx fy fz

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 6755 130 130
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 130.6 | 130.6 | 130.6 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   10470          200            200            0              0              0              0              0              0              0              1.1965779e-13  0              6            
    100000   10470          200            200            0.001924195   -4.6291718e-35  0              0.005772585    577021.86      0              5.5724641e+10  1.1965779e-13  0              3.3330356    
    200000   10470          200            200            0.00064579967  2.4783612e-40  0              0.001937399    129100.7       0              1.2467621e+10  1.1965779e-13  0              3.085222     
    300000   10470          200            200           -1.3760127e-05 -3.0860266e-35  0             -4.128038e-05   132.63656      0              12809090       1.1965779e-13  0              3.0433978    
    400000   10470          200            200           -2.4186349e-05  3.0862485e-35  0             -7.2559046e-05  432.64409      0              41781669       1.1965779e-13  0              3.0048766    
    500000   10470          200            200            0.0015490256  -0.0027404569   0              0.0073875337   1404.2056      0              1.3560813e+08  1.1965779e-13  0              2.9938106    
    600000   10470          200            200            0.0011283137  -0.0014695397   0              0.0048544809   12.613236      0              1218096.1      1.1965779e-13  0              2.9950207    
    700000   10470          200            200            0.001900878   -0.0020459031   0              0.0077485371   15.460735      0              1493087.2      1.1965779e-13  0              2.9937212    
    800000   10470          200            200            0.001678513   -0.0020041465   0              0.0070396854   3.0226098      0              291902.02      1.1965779e-13  0              2.9940071    
    900000   10470          200            200            0.0017162897  -0.0020096371   0              0.0071585062   0.4584325      0              44272.129      1.1965779e-13  0              2.9939605    
   1000000   10470          200            200            0.0017194699  -0.0020108987   0              0.0071693082   0.056345224    0              5441.4184      1.1965779e-13  0              2.9939546    
   1100000   10470          200            200            0.0017125519  -0.0020087475   0              0.0071464031   0.0055248213   0              533.54769      1.1965779e-13  0              2.9939647    
   1200000   10470          200            200            0.0017169691  -0.0020100871   0              0.0071609943   0.0003958456   0              38.227935      1.1965779e-13  0              2.9939584    
   1300000   10470          200            200            0.0017148194  -0.0020094445   0              0.0071539026   1.490089e-05   0              1.4390213      1.1965779e-13  0              2.9939615    
   1400000   10470          200            200            0.0017157242  -0.0020097131   0              0.0071568858   1.2885403e-10  0              1.24438e-05    1.1965779e-13  0              2.9939602    
   1500000   10470          200            200            0.0017153824  -0.0020096124   0              0.0071557595   2.6308634e-07  0              0.025406995    1.1965779e-13  0              2.9939607    
   1600000   10470          200            200            0.001715499   -0.0020096465   0              0.0071561434   1.2937407e-07  0              0.012494022    1.1965779e-13  0              2.9939605    
   1700000   10470          200            200            0.0017154637  -0.0020096363   0              0.0071560273   3.3105074e-08  0              0.0031970511   1.1965779e-13  0              2.9939606    
   1800000   10470          200            200            0.0017154726  -0.0020096388   0              0.0071560566   6.1648564e-09  0              0.00059535771  1.1965779e-13  0              2.9939606    
   1900000   10470          200            200            0.0017154711  -0.0020096384   0              0.0071560518   9.1662611e-10  0              8.8521189e-05  1.1965779e-13  0              2.9939606    
   2000000   10470          200            200            0.001715471   -0.0020096383   0              0.0071560512   1.1122622e-10  0              1.0741432e-05  1.1965779e-13  0              2.9939606    
   2100000   10470          200            200            0.0017154713  -0.0020096384   0              0.0071560523   1.0753631e-11  0              1.0385088e-06  1.1965779e-13  0              2.9939606    
   2200000   10470          200            200            0.0017154711  -0.0020096384   0              0.0071560516   7.5132577e-13  0              7.2557665e-08  1.1965779e-13  0              2.9939606    
   2300000   10470          200            200            0.0017154712  -0.0020096384   0              0.0071560519   2.636452e-14   0              2.5460966e-09  1.1965779e-13  0              2.9939606    
   2400000   10470          200            200            0.0017154711  -0.0020096384   0              0.0071560518   1.6537788e-17  0              1.5971012e-12  1.1965779e-13  0              2.9939606    
   2500000   10470          200            200            0.0017154712  -0.0020096384   0              0.0071560519   5.9769377e-16  0              5.7720986e-11  1.1965779e-13  0              2.9939606    
   2600000   10470          200            200            0.0017154711  -0.0020096384   0              0.0071560518   2.7063637e-16  0              2.6136124e-11  1.1965779e-13  0              2.9939606    
   2700000   10470          200            200            0.0017154711  -0.0020096384   0              0.0071560518   5.3098677e-17  0              5.1278901e-12  1.1965779e-13  0              2.9939606    
   2800000   10470          200            200            0.0017154711  -0.0020096384   0              0.0071560518   7.6979273e-18  0              7.4341072e-13  1.1965779e-13  0              2.9939606    
   2900000   10470          200            200            0.0017154711  -0.0020096384   0              0.0071560518   3.010632e-18   0              2.9074529e-13  1.1965779e-13  0              2.9939606    
   3000000   10470          200            200            0.0017154711  -0.0020096384   0              0.0071560518   4.3095016e-18  0              4.1618082e-13  1.1965779e-13  0              2.9939606    
Loop time of 300.707 on 4 procs for 3000000 steps with 2501 atoms

Performance: 8619692.185 ns/day, 0.000 hours/ns, 9976.496 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 11.291     | 35.768     | 60.803     | 408.2 | 11.89
Neigh   | 6.6293     | 6.7501     | 6.8727     |   4.3 |  2.24
Comm    | 23.372     | 43.284     | 80.909     | 337.3 | 14.39
Output  | 0.26983    | 0.27014    | 0.27046    |   0.1 |  0.09
Modify  | 109.5      | 157.91     | 178.31     | 224.5 | 52.51
Other   |            | 56.73      |            |       | 18.86

Nlocal:         625.25 ave         876 max         375 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:           1.75 ave           3 max           1 min
Histogram: 2 0 0 0 0 1 0 0 0 1
Neighs:         306.25 ave         613 max           0 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 1225
Ave neighs/atom = 0.48980408
Neighbor list builds = 166
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 99

#variable lat0 equal 1                    #
variable lat1 equal 3+(300*0.01)+(v_ind*0.01)  # .491+(v_ind*0.001)       # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 500*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 6.99                                                               
Lattice spacing in x,y,z = 6.99 6.99 6.99

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -5242.5 ${n1e1} -100 100 -100 100 units box
region box block -5242.5 5242.5 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -5242.5 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -5242.5 5242.5 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-5242.5 -100 -100) to (5242.5 100 100)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 1500 atoms
  using lattice units in orthogonal box = (-5242.5 -100 -100) to (5242.5 100 100)
  create_atoms CPU = 0.000 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 1500 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 1001 atoms
  using lattice units in orthogonal box = (-5242.5 -100 -100) to (5242.5 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  1500 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  1500 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  1001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  1001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
1500 atoms in group substrate
group slider1 region slider1
1001 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 1001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_99_*.dump id type diameter mass xu yu zu fx fy fz

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 6765 130 130
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 130.8 | 130.8 | 130.9 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   10485          200            200            0              0              0              0              0              0              0              1.1965779e-13  0              6            
    100000   10485          200            200            0.0019213371  -9.6303402e-37  0              0.0057640114   576944.51      0              5.5717171e+10  1.1965779e-13  0              3.3333183    
    200000   10485          200            200            0.00064388335 -1.5408379e-35  0              0.00193165     128770.92      0              1.2435774e+10  1.1965779e-13  0              3.0858805    
    300000   10485          200            200           -1.5104302e-05 -1.2326806e-34  0             -4.5312905e-05  160.8486       0              15533607       1.1965779e-13  0              3.0436665    
    400000   10485          200            200           -2.1773852e-05 -9.2450433e-35  0             -6.5321555e-05  349.38026      0              33740644       1.1965779e-13  0              3.0052443    
    500000   10485          200            200            0.00060832018 -0.0011149987   0              0.0029399593   790.67747      0              76357970       1.1965779e-13  0              2.9962625    
    600000   10485          200            200            0.0023946593  -0.00054056955  0              0.0077245474   184.06626      0              17775802       1.1965779e-13  0              2.9940192    
    700000   10485          200            200            0.0018286872  -0.00082901512  0              0.0063150767   5.2817523      0              510073.83      1.1965779e-13  0              2.9945798    
    800000   10485          200            200            0.002257041   -0.00063454731  0              0.0074056703   1.5420238      0              148917.62      1.1965779e-13  0              2.9941247    
    900000   10485          200            200            0.0021732597  -0.0006797044   0              0.0071994836   0.39050462     0              37712.141      1.1965779e-13  0              2.9942108    
   1000000   10485          200            200            0.0021391072  -0.00068272125  0              0.0071000428   0.001027062    0              99.186294      1.1965779e-13  0              2.9942506    
   1100000   10485          200            200            0.0021563089  -0.00068017191  0              0.0071490987   0.0082844024   0              800.04828      1.1965779e-13  0              2.9942303    
   1200000   10485          200            200            0.0021573776  -0.00068003964  0              0.0071521724   0.00022196082  0              21.435387      1.1965779e-13  0              2.9942292    
   1300000   10485          200            200            0.0021548334  -0.000680398    0              0.0071448983   8.3408281e-05  0              8.0549748      1.1965779e-13  0              2.9942322    
   1400000   10485          200            200            0.0021552269  -0.0006803399   0              0.0071460205   1.5509085e-05  0              1.4977565      1.1965779e-13  0              2.9942317    
   1500000   10485          200            200            0.0021554871  -0.00068030363  0              0.0071467648   1.6047398e-07  0              0.015497428    1.1965779e-13  0              2.9942314    
   1600000   10485          200            200            0.002155379   -0.0006803191   0              0.0071464562   3.7932594e-07  0              0.036632584    1.1965779e-13  0              2.9942315    
   1700000   10485          200            200            0.0021553668  -0.00068032073  0              0.007146421    5.7769455e-09  0              0.00055789604  1.1965779e-13  0              2.9942315    
   1800000   10485          200            200            0.0021553839  -0.0006803183   0              0.0071464701   4.4946011e-09  0              0.0004340564   1.1965779e-13  0              2.9942315    
   1900000   10485          200            200            0.002155382   -0.00068031859  0              0.0071464645   5.9588661e-10  0              5.7546464e-05  1.1965779e-13  0              2.9942315    
   2000000   10485          200            200            0.0021553801  -0.00068031886  0              0.007146459    1.5135647e-11  0              1.4616924e-06  1.1965779e-13  0              2.9942315    
   2100000   10485          200            200            0.0021553807  -0.00068031876  0              0.0071464609   1.6931523e-11  0              1.6351253e-06  1.1965779e-13  0              2.9942315    
   2200000   10485          200            200            0.0021553808  -0.00068031874  0              0.0071464613   1.1834271e-13  0              1.1428692e-08  1.1965779e-13  0              2.9942315    
   2300000   10485          200            200            0.0021553807  -0.00068031876  0              0.0071464609   2.3282546e-13  0              2.2484616e-08  1.1965779e-13  0              2.9942315    
   2400000   10485          200            200            0.0021553807  -0.00068031876  0              0.0071464609   2.1928657e-14  0              2.1177127e-09  1.1965779e-13  0              2.9942315    
   2500000   10485          200            200            0.0021553807  -0.00068031876  0              0.007146461    1.2270143e-15  0              1.1849626e-10  1.1965779e-13  0              2.9942315    
   2600000   10485          200            200            0.0021553807  -0.00068031876  0              0.007146461    7.2661904e-16  0              7.0171666e-11  1.1965779e-13  0              2.9942315    
   2700000   10485          200            200            0.0021553807  -0.00068031876  0              0.007146461    6.5062245e-20  0              6.2832459e-15  1.1965779e-13  0              2.9942315    
   2800000   10485          200            200            0.0021553807  -0.00068031876  0              0.007146461    1.3676026e-17  0              1.3207327e-12  1.1965779e-13  0              2.9942315    
   2900000   10485          200            200            0.0021553807  -0.00068031876  0              0.007146461    8.0624933e-19  0              7.7861789e-14  1.1965779e-13  0              2.9942315    
   3000000   10485          200            200            0.0021553807  -0.00068031876  0              0.007146461    1.8735026e-19  0              1.8092947e-14  1.1965779e-13  0              2.9942315    
Loop time of 297.846 on 4 procs for 3000000 steps with 2501 atoms

Performance: 8702477.894 ns/day, 0.000 hours/ns, 10072.312 timesteps/s
99.9% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 11.026     | 35.754     | 60.958     | 409.5 | 12.00
Neigh   | 6.6478     | 6.7628     | 6.8791     |   4.0 |  2.27
Comm    | 23.591     | 41.874     | 78.867     | 334.9 | 14.06
Output  | 0.27151    | 0.27184    | 0.27219    |   0.1 |  0.09
Modify  | 109        | 156.84     | 177        | 223.4 | 52.66
Other   |            | 56.34      |            |       | 18.92

Nlocal:         625.25 ave         876 max         375 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:           1.75 ave           3 max           1 min
Histogram: 2 0 0 0 0 1 0 0 0 1
Neighs:         305.25 ave         611 max           0 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 1221
Ave neighs/atom = 0.48820472
Neighbor list builds = 166
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop
Total wall time: 8:19:38

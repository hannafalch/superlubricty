LAMMPS (23 Jun 2022 - Update 1)
  using 1 OpenMP thread(s) per MPI task
variable num index 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99

label startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 0

#variable lat0 equal 1                    #
variable lat1 equal 3+(v_ind*0.01)        # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 250*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 3                                                               
Lattice spacing in x,y,z = 3 3 3

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -1125 ${n1e1} -100 100 -100 100 units box
region box block -1125 1125 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -1125 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -1125 1125 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-1125 -100 -100) to (1125 100 100)
  2 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 750 atoms
  using lattice units in orthogonal box = (-1125 -100 -100) to (1125 100 100)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -750 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -750 750 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 501 atoms
  using lattice units in orthogonal box = (-1125 -100 -100) to (1125 100 100)
  create_atoms CPU = 0.000 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  750 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  750 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  501 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  501 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
750 atoms in group substrate
group slider1 region slider1
501 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 501 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_0_*.dump id type diameter mass xu yu zu fx fy fz

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 1452 130 130
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 63.67 | 63.67 | 63.67 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   2250           200            200            0              0              0              0              0              0              0              0              0              6            
    100000   2250           200            200            0.0046233954   2.2438778e-36  0              0.013870186    302473.68      0              5.8421485e+10  0              0              3.3133694    
    200000   2250           200            200            0.0018334286  -4.4877253e-36  0              0.0055002858   87934.309      0              1.6984132e+10  0              0              3.0485929    
    300000   2250           200            200            0.00052352332  1.4024199e-37  0              0.00157057     12013.958      0              2.3204442e+09  0              0              3.0324106    
    400000   2250           200            200            0.006840467   -2.243863e-36   0              0.020521401    6656.0885      0              1.2855948e+09  0              0              2.999305     
    500000   2250           200            200           -8.3367477e-05  2.0442773e-43  0             -0.00025010243  490.02863      0              94646914       0              0              3.0014947    
    600000   2250           200            200            0.011735713    2.8048404e-37  0              0.035207139    141.30762      0              27292958       0              0              2.9989635    
    700000   2250           200            200            0.0083772146  -3.6462903e-36  0              0.025131644    9.9677248      0              1925223        0              0              2.9991735    
    800000   2250           200            200            0.0066957238  -1.4024191e-37  0              0.020087171    0.46134953     0              89107.672      0              0              2.9992887    
    900000   2250           200            200            0.0058806936  -7.0120951e-38  0              0.017642081    0.28432459     0              54916.068      0              0              2.9993477    
   1000000   2250           200            200            0.0056141931  -1.4024193e-37  0              0.016842579    0.074694866    0              14426.991      0              0              2.9993676    
   1100000   2250           200            200            0.0055540149   4.3825614e-39  0              0.016662045    0.010665516    0              2059.9984      0              0              2.9993722    
   1200000   2250           200            200            0.0055516508  -1.7530242e-38  0              0.016654952    0.0008403168   0              162.30356      0              0              2.9993724    
   1300000   2250           200            200            0.0055582452   3.9926634e-48  0              0.016674736    2.081864e-05   0              4.0210305      0              0              2.9993719    
   1400000   2250           200            200            0.0055627518   5.8433421e-51  0              0.016688255    9.7457429e-07  0              0.18823482     0              0              2.9993716    
   1500000   2250           200            200            0.0055647282  -3.5060485e-38  0              0.016694184    1.5303882e-06  0              0.29558787     0              0              2.9993714    
   1600000   2250           200            200            0.0055653784   3.5060485e-38  0              0.016696135    4.2577481e-07  0              0.082236567    0              0              2.9993714    
   1700000   2250           200            200            0.0055655263  -1.7530242e-38  0              0.016696579    6.1638664e-08  0              0.011905242    0              0              2.9993714    
   1800000   2250           200            200            0.0055655331  -1.7530242e-38  0              0.016696599    4.9172312e-09  0              0.00094974199  0              0              2.9993714    
   1900000   2250           200            200            0.0055655175   5.845462e-53   0              0.016696553    1.2638734e-10  0              2.441117e-05   0              0              2.9993714    
   2000000   2250           200            200            0.0055655068   9.840938e-54   0              0.01669652     5.0960544e-12  0              9.8428092e-07  0              0              2.9993714    
   2100000   2250           200            200            0.0055655021   1.4649933e-54  0              0.016696506    8.62116e-12    0              1.6651399e-06  0              0              2.9993714    
   2200000   2250           200            200            0.0055655005  -1.7530242e-38  0              0.016696501    2.4350745e-12  0              4.7032413e-07  0              0              2.9993714    
   2300000   2250           200            200            0.0055655001   3.91906e-55    0              0.0166965      3.5575659e-13  0              6.8712851e-08  0              0              2.9993714    
   2400000   2250           200            200            0.0055655001  -1.7530242e-38  0              0.0166965      2.900343e-14   0              5.6018873e-09  0              0              2.9993714    
   2500000   2250           200            200            0.0055655002   2.1962454e-54  0              0.0166965      7.6361689e-16  0              1.4748931e-10  0              0              2.9993714    
   2600000   2250           200            200            0.0055655002   1.0518145e-37  0              0.016696501    3.38624e-17    0              6.5403764e-12  0              0              2.9993714    
   2700000   2250           200            200            0.0055655002   2.1532661e-54  0              0.016696501    6.7590277e-17  0              1.305477e-11   0              0              2.9993714    
   2800000   2250           200            200            0.0055655002   1.7530242e-38  0              0.016696501    1.5678936e-18  0              3.0283188e-13  0              0              2.9993714    
   2900000   2250           200            200            0.0055655002  -3.5060485e-38  0              0.016696501    5.2634428e-19  0              1.0166113e-13  0              0              2.9993714    
   3000000   2250           200            200            0.0055655002  -8.7651212e-38  0              0.016696501    1.7770927e-18  0              3.4323779e-13  0              0              2.9993714    
Loop time of 256.756 on 2 procs for 3000000 steps with 1251 atoms

Performance: 10095188.330 ns/day, 0.000 hours/ns, 11684.246 timesteps/s
99.9% CPU use with 2 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 111.69     | 112.4      | 113.11     |   6.7 | 43.78
Neigh   | 3.0082     | 3.0089     | 3.0095     |   0.0 |  1.17
Comm    | 15.146     | 15.866     | 16.586     |  18.1 |  6.18
Output  | 0.23712    | 0.23719    | 0.23725    |   0.0 |  0.09
Modify  | 111.95     | 111.96     | 111.98     |   0.2 | 43.61
Other   |            | 13.28      |            |       |  5.17

Nlocal:          625.5 ave         626 max         625 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Nghost:            4.5 ave           5 max           4 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Neighs:          875.5 ave         876 max         875 min
Histogram: 1 0 0 0 0 0 0 0 0 1

Total # of neighbors = 1751
Ave neighs/atom = 1.3996803
Neighbor list builds = 174
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 1

#variable lat0 equal 1                    #
variable lat1 equal 3+(v_ind*0.01)        # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 250*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 3.01                                                               
Lattice spacing in x,y,z = 3.01 3.01 3.01

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -1128.75 ${n1e1} -100 100 -100 100 units box
region box block -1128.75 1128.75 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -1128.75 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -1128.75 1128.75 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-1128.75 -100 -100) to (1128.75 100 100)
  2 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 750 atoms
  using lattice units in orthogonal box = (-1128.75 -100 -100) to (1128.75 100 100)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -750 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -750 750 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 501 atoms
  using lattice units in orthogonal box = (-1128.75 -100 -100) to (1128.75 100 100)
  create_atoms CPU = 0.000 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  750 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  750 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  501 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  501 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
750 atoms in group substrate
group slider1 region slider1
501 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 501 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_1_*.dump id type diameter mass xu yu zu fx fy fz

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 1457 130 130
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 63.88 | 63.88 | 63.88 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   2257.5         200            200            0              0              0              0              0              0              0              0              0              6            
    100000   2257.5         200            200            0.0044897615   1.073511e-34   0              0.013469285    291052.29      0              5.6215494e+10  0              0              3.3294708    
    200000   2257.5         200            200            0.0015509482   8.9457294e-36  0              0.0046528445   68158.126      0              1.3164448e+10  0              0              3.079556     
    300000   2257.5         200            200            4.1684339e-05 -2.2364111e-36  0              0.00012505302  106.76056      0              20620342       0              0              3.0451965    
    400000   2257.5         200            200            0.00012576246 -7.8274543e-36  0              0.00037728739  924.18965      0              1.7850324e+08  0              0              3.0046531    
    500000   2257.5         200            200            0.012253964    0.0064718816   0              0.030290011    391.40305      0              75597809       0              0              2.9929049    
    600000   2257.5         200            200            0.0040793048   0.0017130151   0              0.010524899    0.1517809      0              29315.825      0              0              2.9958367    
    700000   2257.5         200            200            0.0070276851   0.0026992588   0              0.018383797    6.3744185      0              1231191.4      0              0              2.9944903    
    800000   2257.5         200            200            0.0063862572   0.0025396497   0              0.016619122    1.8417969      0              355735.12      0              0              2.9947688    
    900000   2257.5         200            200            0.0063017052   0.0025357569   0              0.016369359    0.1059621      0              20466.121      0              0              2.9948052    
   1000000   2257.5         200            200            0.0064276154   0.0025499038   0              0.016732943    0.00072247786  0              139.54348      0              0              2.9947483    
   1100000   2257.5         200            200            0.006379005    0.0025444843   0              0.016592531    0.0032447485   0              626.70917      0              0              2.9947706    
   1200000   2257.5         200            200            0.0063852807   0.0025452247   0              0.016610617    0.00055957945  0              108.08036      0              0              2.9947676    
   1300000   2257.5         200            200            0.0063888414   0.0025456107   0              0.016620913    1.3183331e-05  0              2.5463035      0              0              2.994766     
   1400000   2257.5         200            200            0.0063862892   0.0025453263   0              0.016613541    2.1239265e-06  0              0.41022723     0              0              2.9947672    
   1500000   2257.5         200            200            0.0063870303   0.0025454104   0              0.016615681    1.4122017e-06  0              0.27276066     0              0              2.9947668    
   1600000   2257.5         200            200            0.0063870202   0.0025454086   0              0.016615652    1.3849277e-07  0              0.026749281    0              0              2.9947668    
   1700000   2257.5         200            200            0.006386925    0.0025453981   0              0.016615377    3.1170015e-10  0              6.0203538e-05  0              0              2.9947669    
   1800000   2257.5         200            200            0.0063869719   0.0025454034   0              0.016615512    1.7490552e-09  0              0.00033782246  0              0              2.9947668    
   1900000   2257.5         200            200            0.0063869623   0.0025454023   0              0.016615485    5.0226794e-10  0              9.7010885e-05  0              0              2.9947669    
   2000000   2257.5         200            200            0.0063869606   0.0025454021   0              0.01661548     2.5823544e-11  0              4.9877061e-06  0              0              2.9947669    
   2100000   2257.5         200            200            0.0063869627   0.0025454023   0              0.016615486    3.5294655e-13  0              6.8170104e-08  0              0              2.9947669    
   2200000   2257.5         200            200            0.0063869619   0.0025454022   0              0.016615484    9.4352562e-13  0              1.822379e-07   0              0              2.9947669    
   2300000   2257.5         200            200            0.006386962    0.0025454023   0              0.016615484    1.4801302e-13  0              2.8588076e-08  0              0              2.9947669    
   2400000   2257.5         200            200            0.0063869621   0.0025454023   0              0.016615484    2.7958235e-15  0              5.4000124e-10  0              0              2.9947669    
   2500000   2257.5         200            200            0.006386962    0.0025454023   0              0.016615484    7.4970051e-16  0              1.4480142e-10  0              0              2.9947669    
   2600000   2257.5         200            200            0.006386962    0.0025454023   0              0.016615484    3.8766437e-16  0              7.4875701e-11  0              0              2.9947669    
   2700000   2257.5         200            200            0.006386962    0.0025454023   0              0.016615484    3.5797215e-17  0              6.9140777e-12  0              0              2.9947669    
   2800000   2257.5         200            200            0.006386962    0.0025454023   0              0.016615484    1.8954008e-20  0              3.6608848e-15  0              0              2.9947669    
   2900000   2257.5         200            200            0.006386962    0.0025454023   0              0.016615484    5.1737272e-21  0              9.9928309e-16  0              0              2.9947669    
   3000000   2257.5         200            200            0.006386962    0.0025454023   0              0.016615484    1.1429386e-19  0              2.2075366e-14  0              0              2.9947669    
Loop time of 202.265 on 2 procs for 3000000 steps with 1251 atoms

Performance: 12814900.977 ns/day, 0.000 hours/ns, 14832.061 timesteps/s
99.9% CPU use with 2 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 59.432     | 60.242     | 61.052     |  10.4 | 29.78
Neigh   | 2.8454     | 2.8454     | 2.8454     |   0.0 |  1.41
Comm    | 14.974     | 15.762     | 16.55      |  19.8 |  7.79
Output  | 0.21843    | 0.21848    | 0.21853    |   0.0 |  0.11
Modify  | 109.5      | 109.74     | 109.99     |   2.3 | 54.26
Other   |            | 13.45      |            |       |  6.65

Nlocal:          625.5 ave         626 max         625 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Nghost:            4.5 ave           5 max           4 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Neighs:          731.5 ave         732 max         731 min
Histogram: 1 0 0 0 0 0 0 0 0 1

Total # of neighbors = 1463
Ave neighs/atom = 1.1694644
Neighbor list builds = 164
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 2

#variable lat0 equal 1                    #
variable lat1 equal 3+(v_ind*0.01)        # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 250*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 3.02                                                               
Lattice spacing in x,y,z = 3.02 3.02 3.02

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -1132.5 ${n1e1} -100 100 -100 100 units box
region box block -1132.5 1132.5 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -1132.5 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -1132.5 1132.5 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-1132.5 -100 -100) to (1132.5 100 100)
  2 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 750 atoms
  using lattice units in orthogonal box = (-1132.5 -100 -100) to (1132.5 100 100)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -750 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -750 750 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 501 atoms
  using lattice units in orthogonal box = (-1132.5 -100 -100) to (1132.5 100 100)
  create_atoms CPU = 0.000 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  750 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  750 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  501 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  501 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
750 atoms in group substrate
group slider1 region slider1
501 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 501 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_2_*.dump id type diameter mass xu yu zu fx fy fz

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 1462 130 130
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 64.02 | 64.02 | 64.02 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   2265           200            200            0              0              0              0              0              0              0              0              0              6            
    100000   2265           200            200            0.0045014694  -3.5664105e-35  0              0.013504408    293641.22      0              5.6715535e+10  0              0              3.3254496    
    200000   2265           200            200            0.00160842     8.9160578e-36  0              0.00482526     72526.616      0              1.4008203e+10  0              0              3.0724454    
    300000   2265           200            200            0.00013948428 -3.3435148e-36  0              0.00041845285  1104.3466      0              2.1329977e+08  0              0              3.0455053    
    400000   2265           200            200            0.013395578    0.0027025294   0              0.037484206    4598.0088      0              8.8808555e+08  0              0              2.9936481    
    500000   2265           200            200            0.0029104424   0.00055059675  0              0.0081807305   666.18         0              1.2866979e+08  0              0              2.9969471    
    600000   2265           200            200            0.0035204575   0.00064723249  0              0.0099141401   12.614732      0              2436481.1      0              0              2.9966864    
    700000   2265           200            200            0.0066873738   0.0010731833   0              0.018988938    4.3310188      0              836517.58      0              0              2.9954277    
    800000   2265           200            200            0.0056060861   0.00099274935  0              0.015825509    0.94781325     0              183066.04      0              0              2.9958223    
    900000   2265           200            200            0.0059070442   0.0010063918   0              0.016714741    0.23218619     0              44845.761      0              0              2.9957072    
   1000000   2265           200            200            0.0058612964   0.0010042393   0              0.01657965     0.03654884     0              7059.2507      0              0              2.9957237    
   1100000   2265           200            200            0.0058460148   0.0010034461   0              0.016534598    0.0030322403   0              585.66414      0              0              2.99573      
   1200000   2265           200            200            0.0058624219   0.0010042268   0              0.016583039    8.2595767e-05  0              15.953016      0              0              2.9957235    
   1300000   2265           200            200            0.0058543054   0.0010038495   0              0.016559067    2.5738116e-06  0              0.4971206      0              0              2.9957267    
   1400000   2265           200            200            0.0058572262   0.0010039783   0              0.0165677      5.0282684e-06  0              0.97118834     0              0              2.9957256    
   1500000   2265           200            200            0.0058564636   0.001003946    0              0.016565445    1.4627623e-06  0              0.28252622     0              0              2.9957258    
   1600000   2265           200            200            0.0058565544   0.0010039496   0              0.016565714    2.1769576e-07  0              0.042046996    0              0              2.9957258    
   1700000   2265           200            200            0.0058565996   0.0010039517   0              0.016565847    1.7816656e-08  0              0.0034412102   0              0              2.9957258    
   1800000   2265           200            200            0.0058565586   0.0010039499   0              0.016565726    4.796853e-10   0              9.2649146e-05  0              0              2.9957258    
   1900000   2265           200            200            0.0058565786   0.0010039507   0              0.016565785    1.6754142e-11  0              3.2359902e-06  0              0              2.9957258    
   2000000   2265           200            200            0.0058565714   0.0010039504   0              0.016565764    3.0932794e-11  0              5.9745356e-06  0              0              2.9957258    
   2100000   2265           200            200            0.0058565733   0.0010039505   0              0.016565769    8.911334e-12   0              1.7211857e-06  0              0              2.9957258    
   2200000   2265           200            200            0.005856573    0.0010039505   0              0.016565769    1.3174614e-12  0              2.5446198e-07  0              0              2.9957258    
   2300000   2265           200            200            0.0058565729   0.0010039505   0              0.016565768    1.0698656e-13  0              2.0663992e-08  0              0              2.9957258    
   2400000   2265           200            200            0.005856573    0.0010039505   0              0.016565769    2.8777788e-15  0              5.5583056e-10  0              0              2.9957258    
   2500000   2265           200            200            0.005856573    0.0010039505   0              0.016565768    1.0096061e-16  0              1.9500107e-11  0              0              2.9957258    
   2600000   2265           200            200            0.005856573    0.0010039505   0              0.016565769    2.0163174e-16  0              3.89443e-11    0              0              2.9957258    
   2700000   2265           200            200            0.005856573    0.0010039505   0              0.016565769    5.9595176e-17  0              1.1510551e-11  0              0              2.9957258    
   2800000   2265           200            200            0.005856573    0.0010039505   0              0.016565769    5.9200499e-18  0              1.1434321e-12  0              0              2.9957258    
   2900000   2265           200            200            0.005856573    0.0010039505   0              0.016565769    2.5488681e-18  0              4.9230287e-13  0              0              2.9957258    
   3000000   2265           200            200            0.005856573    0.0010039505   0              0.016565769    2.3980242e-18  0              4.6316802e-13  0              0              2.9957258    
Loop time of 200.927 on 2 procs for 3000000 steps with 1251 atoms

Performance: 12900239.031 ns/day, 0.000 hours/ns, 14930.832 timesteps/s
99.9% CPU use with 2 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 60.076     | 60.373     | 60.67      |   3.8 | 30.05
Neigh   | 2.8522     | 2.8525     | 2.8529     |   0.0 |  1.42
Comm    | 14.642     | 14.94      | 15.238     |   7.7 |  7.44
Output  | 0.21207    | 0.21212    | 0.21217    |   0.0 |  0.11
Modify  | 108.7      | 108.9      | 109.1      |   1.9 | 54.20
Other   |            | 13.65      |            |       |  6.79

Nlocal:          625.5 ave         626 max         625 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Nghost:            4.5 ave           5 max           4 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Neighs:          743.5 ave         744 max         743 min
Histogram: 1 0 0 0 0 0 0 0 0 1

Total # of neighbors = 1487
Ave neighs/atom = 1.1886491
Neighbor list builds = 164
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 3

#variable lat0 equal 1                    #
variable lat1 equal 3+(v_ind*0.01)        # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 250*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 3.03                                                               
Lattice spacing in x,y,z = 3.03 3.03 3.03

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -1136.25 ${n1e1} -100 100 -100 100 units box
region box block -1136.25 1136.25 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -1136.25 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -1136.25 1136.25 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-1136.25 -100 -100) to (1136.25 100 100)
  2 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 750 atoms
  using lattice units in orthogonal box = (-1136.25 -100 -100) to (1136.25 100 100)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -750 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -750 750 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 501 atoms
  using lattice units in orthogonal box = (-1136.25 -100 -100) to (1136.25 100 100)
  create_atoms CPU = 0.000 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  750 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  750 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  501 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  501 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
750 atoms in group substrate
group slider1 region slider1
501 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 501 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_3_*.dump id type diameter mass xu yu zu fx fy fz

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 1467 130 130
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 64.23 | 64.23 | 64.23 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   2272.5         200            200            0              0              0              0              0              0              0              0              0              6            
    100000   2272.5         200            200            0.0044929528  -4.4432974e-36  0              0.013478858    294262.69      0              5.6835569e+10  0              0              3.3244731    
    200000   2272.5         200            200            0.0016180379  -1.1108262e-35  0              0.0048541136   73584.22       0              1.4212475e+10  0              0              3.0706993    
    300000   2272.5         200            200            0.00016299092  8.8866314e-36  0              0.00048897275  1489.6628      0              2.8772194e+08  0              0              3.0452734    
    400000   2272.5         200            200            0.028463694    0.0058505484   0              0.079540534    1219.7844      0              2.3559609e+08  0              0              2.9911211    
    500000   2272.5         200            200            0.00056782087  2.0800516e-05  0              0.0016826621   107.2885       0              20722311       0              0              2.9987553    
    600000   2272.5         200            200            0.0062715119   0.00078779184  0              0.018026744    111.75707      0              21585396       0              0              2.9957499    
    700000   2272.5         200            200            0.0057978328   0.00064209782  0              0.016751401    15.518135      0              2997260.8      0              0              2.995909     
    800000   2272.5         200            200            0.0054416791   0.00061044567  0              0.015714592    0.93228404     0              180066.64      0              0              2.99604      
    900000   2272.5         200            200            0.0055897436   0.00062072467  0              0.016148506    0.036465602    0              7043.1737      0              0              2.995988     
   1000000   2272.5         200            200            0.0057087781   0.00062449479  0              0.016501839    0.038029017    0              7345.1405      0              0              2.9959449    
   1100000   2272.5         200            200            0.0057278288   0.00062507632  0              0.01655841     0.0012947425   0              250.07393      0              0              2.9959379    
   1200000   2272.5         200            200            0.0057176808   0.00062478404  0              0.016528258    0.00022400116  0              43.264858      0              0              2.9959414    
   1300000   2272.5         200            200            0.0057119094   0.00062461243  0              0.016511116    9.1902885e-05  0              17.750646      0              0              2.9959435    
   1400000   2272.5         200            200            0.0057114551   0.00062459791  0              0.016509767    1.0199353e-06  0              0.19699609     0              0              2.9959437    
   1500000   2272.5         200            200            0.0057120906   0.00062461656  0              0.016511655    9.5098032e-07  0              0.18367775     0              0              2.9959435    
   1600000   2272.5         200            200            0.0057123529   0.00062462441  0              0.016512434    1.9770077e-07  0              0.03818505     0              0              2.9959434    
   1700000   2272.5         200            200            0.00571235     0.00062462437  0              0.016512426    7.8834656e-11  0              1.5226574e-05  0              0              2.9959434    
   1800000   2272.5         200            200            0.0057123137   0.0006246233   0              0.016512318    3.2752537e-09  0              0.00063260111  0              0              2.9959434    
   1900000   2272.5         200            200            0.0057123026   0.00062462297  0              0.016512285    3.7210219e-10  0              7.1869932e-05  0              0              2.9959434    
   2000000   2272.5         200            200            0.005712304    0.00062462301  0              0.016512289    2.6558651e-12  0              5.1296888e-07  0              0              2.9959434    
   2100000   2272.5         200            200            0.0057123059   0.00062462307  0              0.016512295    9.7337581e-12  0              1.8800334e-06  0              0              2.9959434    
   2200000   2272.5         200            200            0.0057123063   0.00062462308  0              0.016512296    5.8734365e-13  0              1.1344289e-07  0              0              2.9959434    
   2300000   2272.5         200            200            0.0057123062   0.00062462307  0              0.016512296    3.2321842e-14  0              6.2428243e-09  0              0              2.9959434    
   2400000   2272.5         200            200            0.0057123061   0.00062462307  0              0.016512295    2.5629934e-14  0              4.9503111e-09  0              0              2.9959434    
   2500000   2272.5         200            200            0.0057123061   0.00062462307  0              0.016512295    7.0747605e-16  0              1.3664595e-10  0              0              2.9959434    
   2600000   2272.5         200            200            0.0057123061   0.00062462307  0              0.016512295    1.9334994e-16  0              3.7344707e-11  0              0              2.9959434    
   2700000   2272.5         200            200            0.0057123061   0.00062462307  0              0.016512295    6.1972449e-17  0              1.1969711e-11  0              0              2.9959434    
   2800000   2272.5         200            200            0.0057123061   0.00062462307  0              0.016512295    1.7491309e-18  0              3.3783708e-13  0              0              2.9959434    
   2900000   2272.5         200            200            0.0057123061   0.00062462307  0              0.016512295    1.029285e-18   0              1.9880196e-13  0              0              2.9959434    
   3000000   2272.5         200            200            0.0057123061   0.00062462307  0              0.016512295    1.9413096e-18  0              3.7495557e-13  0              0              2.9959434    
Loop time of 200.205 on 2 procs for 3000000 steps with 1251 atoms

Performance: 12946709.825 ns/day, 0.000 hours/ns, 14984.618 timesteps/s
99.9% CPU use with 2 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 60.666     | 60.81      | 60.954     |   1.8 | 30.37
Neigh   | 2.8892     | 2.8896     | 2.89       |   0.0 |  1.44
Comm    | 14.486     | 14.63      | 14.774     |   3.8 |  7.31
Output  | 0.21413    | 0.21415    | 0.21417    |   0.0 |  0.11
Modify  | 108.44     | 108.5      | 108.56     |   0.6 | 54.20
Other   |            | 13.16      |            |       |  6.57

Nlocal:          625.5 ave         626 max         625 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Nghost:            4.5 ave           5 max           4 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Neighs:          757.5 ave         758 max         757 min
Histogram: 1 0 0 0 0 0 0 0 0 1

Total # of neighbors = 1515
Ave neighs/atom = 1.2110312
Neighbor list builds = 166
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 4

#variable lat0 equal 1                    #
variable lat1 equal 3+(v_ind*0.01)        # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 250*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 3.04                                                               
Lattice spacing in x,y,z = 3.04 3.04 3.04

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -1140 ${n1e1} -100 100 -100 100 units box
region box block -1140 1140 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -1140 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -1140 1140 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-1140 -100 -100) to (1140 100 100)
  2 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 750 atoms
  using lattice units in orthogonal box = (-1140 -100 -100) to (1140 100 100)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -750 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -750 750 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 501 atoms
  using lattice units in orthogonal box = (-1140 -100 -100) to (1140 100 100)
  create_atoms CPU = 0.000 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  750 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  750 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  501 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  501 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
750 atoms in group substrate
group slider1 region slider1
501 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 501 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_4_*.dump id type diameter mass xu yu zu fx fy fz

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 1471 130 130
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 64.36 | 64.36 | 64.36 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   2280           200            200            0              0              0              0              0              0              0              0              0              6            
    100000   2280           200            200            0.0044810256   2.2143505e-36  0              0.013443077    294543.47      0              5.68898e+10    0              0              3.32403      
    200000   2280           200            200            0.001619417   -4.4286915e-36  0              0.0048582511   74062.21       0              1.4304796e+10  0              0              3.0699074    
    300000   2280           200            200            0.0001733611   2.9448871e-43  0              0.00052008331  1682.2412      0              3.2491762e+08  0              0              3.045129     
    400000   2280           200            200            0.03187122     0.0052687332   0              0.090344926    96.840976      0              18704417       0              0              2.9907268    
    500000   2280           200            200            0.0023292688   7.1364217e-05  0              0.0069164421   638.32267      0              1.2328927e+08  0              0              2.9974826    
    600000   2280           200            200            0.0032879237   0.00028006997  0              0.0095837012   14.218626      0              2746266.3      0              0              2.9969898    
    700000   2280           200            200            0.0049587554   0.00044053236  0              0.014435734    7.4633399      0              1441511.9      0              0              2.9963068    
    800000   2280           200            200            0.0054287989   0.0004604158   0              0.015825981    1.3223761      0              255411.23      0              0              2.9961272    
    900000   2280           200            200            0.0055828319   0.00046356854  0              0.016284927    0.22470303     0              43400.42       0              0              2.996069     
   1000000   2280           200            200            0.0056278499   0.00046445279  0              0.016419097    0.035168245    0              6792.5947      0              0              2.996052     
   1100000   2280           200            200            0.005639392    0.00046467956  0              0.016453497    0.0051100161   0              986.97756      0              0              2.9960476    
   1200000   2280           200            200            0.0056416486   0.00046472543  0              0.016460221    0.00069323825  0              133.89598      0              0              2.9960467    
   1300000   2280           200            200            0.0056417218   0.00046472807  0              0.016460437    8.785842e-05   0              16.969475      0              0              2.9960467    
   1400000   2280           200            200            0.0056414702   0.0004647238   0              0.016459687    1.0356023e-05  0              2.0002212      0              0              2.9960467    
   1500000   2280           200            200            0.0056412786   0.00046472036  0              0.016459115    1.1231563e-06  0              0.2169328      0              0              2.9960468    
   1600000   2280           200            200            0.0056411741   0.00046471845  0              0.016458804    1.097566e-07   0              0.021199014    0              0              2.9960468    
   1700000   2280           200            200            0.0056411245   0.00046471753  0              0.016458656    9.2734774e-09  0              0.0017911321   0              0              2.9960469    
   1800000   2280           200            200            0.0056411027   0.00046471713  0              0.016458591    6.1767713e-10  0              0.00011930167  0              0              2.9960469    
   1900000   2280           200            200            0.0056410937   0.00046471696  0              0.016458564    2.4561909e-11  0              4.7440267e-06  0              0              2.9960469    
   2000000   2280           200            200            0.0056410901   0.00046471689  0              0.016458553    5.0815571e-14  0              9.8148082e-09  0              0              2.9960469    
   2100000   2280           200            200            0.0056410887   0.00046471687  0              0.016458549    2.5607826e-13  0              4.9460411e-08  0              0              2.9960469    
   2200000   2280           200            200            0.0056410882   0.00046471686  0              0.016458548    1.5704536e-13  0              3.0332633e-08  0              0              2.9960469    
   2300000   2280           200            200            0.005641088    0.00046471686  0              0.016458547    4.7571039e-14  0              9.1881409e-09  0              0              2.9960469    
   2400000   2280           200            200            0.005641088    0.00046471686  0              0.016458547    1.0939559e-14  0              2.1129287e-09  0              0              2.9960469    
   2500000   2280           200            200            0.005641088    0.00046471685  0              0.016458547    2.1389411e-15  0              4.1312725e-10  0              0              2.9960469    
   2600000   2280           200            200            0.0056410879   0.00046471685  0              0.016458547    3.864027e-16   0              7.4632014e-11  0              0              2.9960469    
   2700000   2280           200            200            0.0056410879   0.00046471685  0              0.016458547    5.0681598e-17  0              9.788932e-12   0              0              2.9960469    
   2800000   2280           200            200            0.0056410879   0.00046471685  0              0.016458547    6.4064883e-18  0              1.2373856e-12  0              0              2.9960469    
   2900000   2280           200            200            0.0056410879   0.00046471685  0              0.016458547    1.630519e-18   0              3.1492771e-13  0              0              2.9960469    
   3000000   2280           200            200            0.0056410879   0.00046471686  0              0.016458547    2.3715062e-20  0              4.5804619e-15  0              0              2.9960469    
Loop time of 201.345 on 2 procs for 3000000 steps with 1251 atoms

Performance: 12873398.712 ns/day, 0.000 hours/ns, 14899.767 timesteps/s
99.9% CPU use with 2 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 60.739     | 61.008     | 61.277     |   3.4 | 30.30
Neigh   | 2.8904     | 2.8905     | 2.8905     |   0.0 |  1.44
Comm    | 14.56      | 14.82      | 15.081     |   6.8 |  7.36
Output  | 0.20948    | 0.20951    | 0.20953    |   0.0 |  0.10
Modify  | 109.18     | 109.19     | 109.2      |   0.1 | 54.23
Other   |            | 13.23      |            |       |  6.57

Nlocal:          625.5 ave         626 max         625 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Nghost:            4.5 ave           5 max           4 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Neighs:          761.5 ave         762 max         761 min
Histogram: 1 0 0 0 0 0 0 0 0 1

Total # of neighbors = 1523
Ave neighs/atom = 1.2174261
Neighbor list builds = 166
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 5

#variable lat0 equal 1                    #
variable lat1 equal 3+(v_ind*0.01)        # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 250*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 3.05                                                               
Lattice spacing in x,y,z = 3.05 3.05 3.05

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -1143.75 ${n1e1} -100 100 -100 100 units box
region box block -1143.75 1143.75 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -1143.75 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -1143.75 1143.75 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-1143.75 -100 -100) to (1143.75 100 100)
  2 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 750 atoms
  using lattice units in orthogonal box = (-1143.75 -100 -100) to (1143.75 100 100)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -750 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -750 750 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 501 atoms
  using lattice units in orthogonal box = (-1143.75 -100 -100) to (1143.75 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  750 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  750 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  501 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  501 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
750 atoms in group substrate
group slider1 region slider1
501 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 501 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_5_*.dump id type diameter mass xu yu zu fx fy fz

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 1476 130 130
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 64.5 | 64.5 | 64.5 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   2287.5         200            200            0              0              0              0              0              0              0              0              0              6            
    100000   2287.5         200            200            0.004467278    3.9230069e-42  0              0.013401834    294630.7       0              5.6906649e+10  0              0              3.3239801    
    200000   2287.5         200            200            0.001616945    2.3350224e-42  0              0.0048508351   74264.284      0              1.4343826e+10  0              0              3.0696228    
    300000   2287.5         200            200            0.00017837238  4.2246621e-41  0              0.00053511714  1785.0171      0              3.4476836e+08  0              0              3.04506      
    400000   2287.5         200            200            0.031949925    0.0043467156   0              0.09150306     32.59202       0              6295008        0              0              2.9907842    
    500000   2287.5         200            200            0.0048634495   0.00019848366  0              0.014391865    857.61438      0              1.6564452e+08  0              0              2.9963857    
    600000   2287.5         200            200            0.0055341859   0.00028316567  0              0.016319392    117.80927      0              22754351       0              0              2.9961067    
    700000   2287.5         200            200            0.0065644306   0.00039913606  0              0.019294156    1.7744669      0              342730.62      0              0              2.9957562    
    800000   2287.5         200            200            0.0052383172   0.00033606356  0              0.015378888    0.17681458     0              34150.974      0              0              2.9962056    
    900000   2287.5         200            200            0.0057082376   0.00035337168  0              0.016771341    0.049686854    0              9596.8015      0              0              2.9960385    
   1000000   2287.5         200            200            0.0055415088   0.00034934813  0              0.016275178    0.0085729129   0              1655.8211      0              0              2.9960965    
   1100000   2287.5         200            200            0.0056004626   0.00035039215  0              0.016450996    0.0014196191   0              274.1933       0              0              2.9960758    
   1200000   2287.5         200            200            0.005579474    0.00035003387  0              0.016388388    0.00022709182  0              43.861805      0              0              2.9960831    
   1300000   2287.5         200            200            0.0055869071   0.00035016216  0              0.016410559    3.5721529e-05  0              6.8994592      0              0              2.9960805    
   1400000   2287.5         200            200            0.0055842854   0.00035011717  0              0.016402739    5.5214749e-06  0              1.0664491      0              0              2.9960815    
   1500000   2287.5         200            200            0.0055852054   0.00035013296  0              0.016405483    8.4156844e-07  0              0.16254531     0              0              2.9960811    
   1600000   2287.5         200            200            0.0055848843   0.00035012746  0              0.016404526    1.266326e-07   0              0.02445854     0              0              2.9960812    
   1700000   2287.5         200            200            0.0055849957   0.00035012937  0              0.016404858    1.8839266e-08  0              0.0036387229   0              0              2.9960812    
   1800000   2287.5         200            200            0.0055849573   0.00035012871  0              0.016404743    2.7738784e-09  0              0.00053576264  0              0              2.9960812    
   1900000   2287.5         200            200            0.0055849705   0.00035012894  0              0.016404782    4.0456301e-10  0              7.81396e-05    0              0              2.9960812    
   2000000   2287.5         200            200            0.005584966    0.00035012886  0              0.016404769    5.8486512e-11  0              1.1296417e-05  0              0              2.9960812    
   2100000   2287.5         200            200            0.0055849675   0.00035012889  0              0.016404774    8.3847779e-12  0              1.6194837e-06  0              0              2.9960812    
   2200000   2287.5         200            200            0.005584967    0.00035012888  0              0.016404772    1.1929273e-12  0              2.3040875e-07  0              0              2.9960812    
   2300000   2287.5         200            200            0.0055849672   0.00035012888  0              0.016404773    1.6823489e-13  0              3.2493844e-08  0              0              2.9960812    
   2400000   2287.5         200            200            0.0055849671   0.00035012888  0              0.016404773    2.3624908e-14  0              4.5630491e-09  0              0              2.9960812    
   2500000   2287.5         200            200            0.0055849671   0.00035012888  0              0.016404773    3.3071444e-15  0              6.3876067e-10  0              0              2.9960812    
   2600000   2287.5         200            200            0.0055849671   0.00035012888  0              0.016404773    4.5334614e-16  0              8.7561851e-11  0              0              2.9960812    
   2700000   2287.5         200            200            0.0055849671   0.00035012888  0              0.016404773    6.2528621e-17  0              1.2077133e-11  0              0              2.9960812    
   2800000   2287.5         200            200            0.0055849671   0.00035012888  0              0.016404773    7.5877211e-18  0              1.4655356e-12  0              0              2.9960812    
   2900000   2287.5         200            200            0.0055849671   0.00035012888  0              0.016404773    2.4456465e-18  0              4.7236607e-13  0              0              2.9960812    
   3000000   2287.5         200            200            0.0055849671   0.00035012888  0              0.016404773    1.4022023e-18  0              2.7082932e-13  0              0              2.9960812    
Loop time of 201.551 on 2 procs for 3000000 steps with 1251 atoms

Performance: 12860272.837 ns/day, 0.000 hours/ns, 14884.575 timesteps/s
99.9% CPU use with 2 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 61.492     | 61.562     | 61.632     |   0.9 | 30.54
Neigh   | 2.9063     | 2.9066     | 2.9069     |   0.0 |  1.44
Comm    | 14.764     | 14.845     | 14.925     |   2.1 |  7.37
Output  | 0.21173    | 0.21177    | 0.21181    |   0.0 |  0.11
Modify  | 108.69     | 108.73     | 108.76     |   0.3 | 53.94
Other   |            | 13.3       |            |       |  6.60

Nlocal:          625.5 ave         626 max         625 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Nghost:            4.5 ave           5 max           4 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Neighs:          755.5 ave         756 max         755 min
Histogram: 1 0 0 0 0 0 0 0 0 1

Total # of neighbors = 1511
Ave neighs/atom = 1.2078337
Neighbor list builds = 166
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 6

#variable lat0 equal 1                    #
variable lat1 equal 3+(v_ind*0.01)        # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 250*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 3.06                                                               
Lattice spacing in x,y,z = 3.06 3.06 3.06

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -1147.5 ${n1e1} -100 100 -100 100 units box
region box block -1147.5 1147.5 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -1147.5 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -1147.5 1147.5 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-1147.5 -100 -100) to (1147.5 100 100)
  2 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 750 atoms
  using lattice units in orthogonal box = (-1147.5 -100 -100) to (1147.5 100 100)
  create_atoms CPU = 0.000 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -750 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -750 750 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 501 atoms
  using lattice units in orthogonal box = (-1147.5 -100 -100) to (1147.5 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  750 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  750 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  501 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  501 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
750 atoms in group substrate
group slider1 region slider1
501 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 501 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_6_*.dump id type diameter mass xu yu zu fx fy fz

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 1481 130 130
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 64.71 | 64.71 | 64.71 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   2295           200            200            0              0              0              0              0              0              0              0              0              6            
    100000   2295           200            200            0.004444087   -2.1998719e-36  0              0.013332261    293796.19      0              5.6745466e+10  0              0              3.3250545    
    200000   2295           200            200            0.0015904603   3.2998109e-36  0              0.0047713808   72749.144      0              1.4051183e+10  0              0              3.071934     
    300000   2295           200            200            0.00013983372  8.427577e-42   0              0.00041950115  1137.5229      0              2.1970764e+08  0              0              3.0454422    
    400000   2295           200            200            0.01292317     0.00094211917  0              0.037827389    4549.4415      0              8.78705e+08    0              0              2.9935657    
    500000   2295           200            200            0.0025486069   0.00018065426  0              0.0074651664   641.83188      0              1.2396706e+08  0              0              2.9970439    
    600000   2295           200            200            0.0035268814   0.00024359825  0              0.010337046    31.980188      0              6176835.3      0              0              2.9965981    
    700000   2295           200            200            0.0059581119   0.00036637362  0              0.017507962    12.499163      0              2414159.3      0              0              2.9956028    
    800000   2295           200            200            0.005509166    0.00036032575  0              0.016167172    1.9741009      0              381289.07      0              0              2.99577      
    900000   2295           200            200            0.0055610228   0.00036100601  0              0.016322062    0.27304901     0              52738.238      0              0              2.9957525    
   1000000   2295           200            200            0.0055841399   0.00036139812  0              0.016391022    0.033441544    0              6459.0899      0              0              2.9957423    
   1100000   2295           200            200            0.0055613758   0.00036103929  0              0.016323088    0.0035848788   0              692.40387      0              0              2.9957516    
   1200000   2295           200            200            0.0055745586   0.00036124382  0              0.016362432    0.00032592762  0              62.951513      0              0              2.9957463    
   1300000   2295           200            200            0.0055682318   0.00036114669  0              0.016343549    2.2997505e-05  0              4.4418688      0              0              2.9957489    
   1400000   2295           200            200            0.0055709671   0.00036118847  0              0.016351713    9.6992065e-07  0              0.18733599     0              0              2.9957478    
   1500000   2295           200            200            0.0055698693   0.00036117179  0              0.016348436    3.0468946e-09  0              0.00058849455  0              0              2.9957482    
   1600000   2295           200            200            0.0055702834   0.00036117806  0              0.016349672    8.7616388e-09  0              0.0016922727   0              0              2.995748     
   1700000   2295           200            200            0.0055701362   0.00036117584  0              0.016349233    5.5140658e-09  0              0.001065018    0              0              2.9957481    
   1800000   2295           200            200            0.0055701853   0.00036117657  0              0.016349379    1.6285264e-09  0              0.00031454285  0              0              2.9957481    
   1900000   2295           200            200            0.0055701701   0.00036117635  0              0.016349334    3.5238991e-10  0              6.806259e-05   0              0              2.9957481    
   2000000   2295           200            200            0.0055701743   0.00036117641  0              0.016349347    6.3162718e-11  0              1.2199606e-05  0              0              2.9957481    
   2100000   2295           200            200            0.0055701734   0.0003611764   0              0.016349344    9.8396144e-12  0              1.9004791e-06  0              0              2.9957481    
   2200000   2295           200            200            0.0055701735   0.0003611764   0              0.016349344    1.3581721e-12  0              2.6232507e-07  0              0              2.9957481    
   2300000   2295           200            200            0.0055701735   0.0003611764   0              0.016349344    1.666374e-13   0              3.2185294e-08  0              0              2.9957481    
   2400000   2295           200            200            0.0055701735   0.0003611764   0              0.016349344    1.7869241e-14  0              3.4513669e-09  0              0              2.9957481    
   2500000   2295           200            200            0.0055701735   0.0003611764   0              0.016349344    1.6234814e-15  0              3.1356842e-10  0              0              2.9957481    
   2600000   2295           200            200            0.0055701735   0.0003611764   0              0.016349344    1.2965843e-16  0              2.5042967e-11  0              0              2.9957481    
   2700000   2295           200            200            0.0055701735   0.0003611764   0              0.016349344    1.5755366e-18  0              3.043081e-13   0              0              2.9957481    
   2800000   2295           200            200            0.0055701735   0.0003611764   0              0.016349344    1.3016221e-19  0              2.5140268e-14  0              0              2.9957481    
   2900000   2295           200            200            0.0055701735   0.0003611764   0              0.016349344    3.8169036e-20  0              7.3721846e-15  0              0              2.9957481    
   3000000   2295           200            200            0.0055701735   0.0003611764   0              0.016349344    1.7288703e-19  0              3.3392385e-14  0              0              2.9957481    
Loop time of 200.343 on 2 procs for 3000000 steps with 1251 atoms

Performance: 12937779.832 ns/day, 0.000 hours/ns, 14974.282 timesteps/s
99.9% CPU use with 2 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 60.344     | 60.443     | 60.541     |   1.3 | 30.17
Neigh   | 2.89       | 2.89       | 2.8901     |   0.0 |  1.44
Comm    | 14.694     | 14.749     | 14.803     |   1.4 |  7.36
Output  | 0.21145    | 0.21149    | 0.21153    |   0.0 |  0.11
Modify  | 108.73     | 108.82     | 108.91     |   0.8 | 54.32
Other   |            | 13.23      |            |       |  6.60

Nlocal:          625.5 ave         626 max         625 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Nghost:            4.5 ave           5 max           4 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Neighs:          755.5 ave         756 max         755 min
Histogram: 1 0 0 0 0 0 0 0 0 1

Total # of neighbors = 1511
Ave neighs/atom = 1.2078337
Neighbor list builds = 164
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 7

#variable lat0 equal 1                    #
variable lat1 equal 3+(v_ind*0.01)        # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 250*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 3.07                                                               
Lattice spacing in x,y,z = 3.07 3.07 3.07

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -1151.25 ${n1e1} -100 100 -100 100 units box
region box block -1151.25 1151.25 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -1151.25 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -1151.25 1151.25 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-1151.25 -100 -100) to (1151.25 100 100)
  2 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 750 atoms
  using lattice units in orthogonal box = (-1151.25 -100 -100) to (1151.25 100 100)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -750 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -750 750 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 501 atoms
  using lattice units in orthogonal box = (-1151.25 -100 -100) to (1151.25 100 100)
  create_atoms CPU = 0.000 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  750 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  750 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  501 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  501 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
750 atoms in group substrate
group slider1 region slider1
501 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 501 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_7_*.dump id type diameter mass xu yu zu fx fy fz

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 1486 130 130
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 64.85 | 64.85 | 64.85 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   2302.5         200            200            0              0              0              0              0              0              0              0              0              6            
    100000   2302.5         200            200            0.0044309492  -8.7707057e-36  0              0.013292848    293918.64      0              5.6769116e+10  0              0              3.3250138    
    200000   2302.5         200            200            0.0015887711   6.8355622e-42  0              0.0047663134   72995.985      0              1.409886e+10   0              0              3.0716732    
    300000   2302.5         200            200            0.00014770738  5.4817748e-37  0              0.00044312215  1269.0098      0              2.4510377e+08  0              0              3.0454172    
    400000   2302.5         200            200            0.019371618    0.0023629466   0              0.055751909    3327.4528      0              6.4268315e+08  0              0              2.9923299    
    500000   2302.5         200            200            0.00077732591  0.00051461513  0              0.0018173626   132.40863      0              25574156       0              0              2.998558     
    600000   2302.5         200            200            0.0056801001   0.0011626862   0              0.015877614    113.41931      0              21906450       0              0              2.9959009    
    700000   2302.5         200            200            0.0051718102   0.0010993026   0              0.014416128    8.0572434      0              1556221.8      0              0              2.996076     
    800000   2302.5         200            200            0.0061814015   0.0012271906   0              0.017317014    0.010035803    0              1938.3721      0              0              2.9956988    
    900000   2302.5         200            200            0.0057253279   0.0011832558   0              0.015992728    0.089221975    0              17232.839      0              0              2.9958697    
   1000000   2302.5         200            200            0.0058423405   0.0011930114   0              0.01633401     0.034430299    0              6650.0637      0              0              2.9958244    
   1100000   2302.5         200            200            0.0058361907   0.001192447    0              0.016316125    0.0043122255   0              832.88774      0              0              2.9958271    
   1200000   2302.5         200            200            0.0058239134   0.0011914957   0              0.016280244    0.00015578739  0              30.089663      0              0              2.9958317    
   1300000   2302.5         200            200            0.0058317714   0.0011921178   0              0.016303196    2.9954071e-06  0              0.57854995     0              0              2.9958287    
   1400000   2302.5         200            200            0.005828938    0.0011918913   0              0.016294923    7.1557211e-06  0              1.3820967      0              0              2.9958298    
   1500000   2302.5         200            200            0.0058294964   0.0011919369   0              0.016296552    1.6781548e-06  0              0.32412836     0              0              2.9958296    
   1600000   2302.5         200            200            0.0058295598   0.0011919414   0              0.016296738    1.4384481e-07  0              0.027783005    0              0              2.9958295    
   1700000   2302.5         200            200            0.0058294482   0.0011919327   0              0.016296412    1.7525764e-09  0              0.00033850258  0              0              2.9958296    
   1800000   2302.5         200            200            0.0058295034   0.0011919371   0              0.016296573    7.445428e-10   0              0.00014380523  0              0              2.9958296    
   1900000   2302.5         200            200            0.0058294869   0.0011919357   0              0.016296525    4.516026e-10   0              8.7225093e-05  0              0              2.9958296    
   2000000   2302.5         200            200            0.0058294889   0.0011919359   0              0.016296531    7.1625461e-11  0              1.3834149e-05  0              0              2.9958296    
   2100000   2302.5         200            200            0.00582949     0.001191936    0              0.016296534    3.872426e-12   0              7.4794237e-07  0              0              2.9958296    
   2200000   2302.5         200            200            0.0058294891   0.0011919359   0              0.016296531    3.2352695e-16  0              6.2487835e-11  0              0              2.9958296    
   2300000   2302.5         200            200            0.0058294895   0.001191936    0              0.016296532    7.6247493e-14  0              1.4726874e-08  0              0              2.9958296    
   2400000   2302.5         200            200            0.0058294894   0.0011919359   0              0.016296532    2.4105862e-14  0              4.6559432e-09  0              0              2.9958296    
   2500000   2302.5         200            200            0.0058294894   0.0011919359   0              0.016296532    2.6800482e-15  0              5.1763975e-10  0              0              2.9958296    
   2600000   2302.5         200            200            0.0058294894   0.001191936    0              0.016296532    7.9410213e-17  0              1.533774e-11   0              0              2.9958296    
   2700000   2302.5         200            200            0.0058294894   0.0011919359   0              0.016296532    1.686148e-19   0              3.256722e-14   0              0              2.9958296    
   2800000   2302.5         200            200            0.0058294894   0.001191936    0              0.016296532    2.4226898e-18  0              4.6793207e-13  0              0              2.9958296    
   2900000   2302.5         200            200            0.0058294894   0.001191936    0              0.016296532    3.2700036e-18  0              6.3158708e-13  0              0              2.9958296    
   3000000   2302.5         200            200            0.0058294894   0.001191936    0              0.016296532    2.9011107e-18  0              5.6033701e-13  0              0              2.9958296    
Loop time of 200.316 on 2 procs for 3000000 steps with 1251 atoms

Performance: 12939570.350 ns/day, 0.000 hours/ns, 14976.355 timesteps/s
99.9% CPU use with 2 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 60.319     | 60.535     | 60.752     |   2.8 | 30.22
Neigh   | 2.8882     | 2.8884     | 2.8886     |   0.0 |  1.44
Comm    | 14.586     | 14.71      | 14.834     |   3.2 |  7.34
Output  | 0.21687    | 0.21689    | 0.21691    |   0.0 |  0.11
Modify  | 108.66     | 108.75     | 108.84     |   0.9 | 54.29
Other   |            | 13.21      |            |       |  6.60

Nlocal:          625.5 ave         626 max         625 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Nghost:            4.5 ave           5 max           4 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Neighs:          747.5 ave         748 max         747 min
Histogram: 1 0 0 0 0 0 0 0 0 1

Total # of neighbors = 1495
Ave neighs/atom = 1.195044
Neighbor list builds = 164
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 8

#variable lat0 equal 1                    #
variable lat1 equal 3+(v_ind*0.01)        # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 250*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 3.08                                                               
Lattice spacing in x,y,z = 3.08 3.08 3.08

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -1155 ${n1e1} -100 100 -100 100 units box
region box block -1155 1155 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -1155 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -1155 1155 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-1155 -100 -100) to (1155 100 100)
  2 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 750 atoms
  using lattice units in orthogonal box = (-1155 -100 -100) to (1155 100 100)
  create_atoms CPU = 0.000 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -750 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -750 750 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 501 atoms
  using lattice units in orthogonal box = (-1155 -100 -100) to (1155 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  750 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  750 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  501 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  501 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
750 atoms in group substrate
group slider1 region slider1
501 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 501 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_8_*.dump id type diameter mass xu yu zu fx fy fz

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 1491 130 130
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 65.06 | 65.06 | 65.06 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   2310           200            200            0              0              0              0              0              0              0              0              0              6            
    100000   2310           200            200            0.0044185397  -2.185586e-36   0              0.013255619    294115.72      0              5.6807182e+10  0              0              3.3247027    
    200000   2310           200            200            0.0015883041   4.7718492e-43  0              0.0047649122   73334.117      0              1.4164168e+10  0              0              3.0711114    
    300000   2310           200            200            0.00015480446 -1.7074911e-38  0              0.00046441339  1394.5651      0              2.6935422e+08  0              0              3.0453359    
    400000   2310           200            200            0.023687916    0.001837709    0              0.06922604     2118.6984      0              4.0921744e+08  0              0              2.9915597    
    500000   2310           200            200            0.00036385114  6.7699619e-06  0              0.0010847835   1.0864266      0              209838.62      0              0              2.9989267    
    600000   2310           200            200            0.0082830294   0.0003555441   0              0.024493544    0.54962151     0              106157.02      0              0              2.9949545    
    700000   2310           200            200            0.0050793578   0.00023225859  0              0.015005815    11.901894      0              2298799.5      0              0              2.9960613    
    800000   2310           200            200            0.0055735367   0.00023919239  0              0.016481418    1.9247683      0              371760.7       0              0              2.995857     
    900000   2310           200            200            0.0054702849   0.00023815523  0              0.016172699    0.26521749     0              51225.615      0              0              2.9959005    
   1000000   2310           200            200            0.0055001239   0.00023846643  0              0.016261905    0.036592258    0              7067.6368      0              0              2.9958877    
   1100000   2310           200            200            0.0054928577   0.00023838773  0              0.016240185    0.0050059049   0              966.86894      0              0              2.9958909    
   1200000   2310           200            200            0.0054942193   0.00023840428  0              0.016244254    0.00068038263  0              131.41297      0              0              2.9958902    
   1300000   2310           200            200            0.0054942118   0.00023840288  0              0.016244232    9.1833778e-05  0              17.737298      0              0              2.9958903    
   1400000   2310           200            200            0.0054940347   0.00023840169  0              0.016243703    1.2309942e-05  0              2.3776121      0              0              2.9958903    
   1500000   2310           200            200            0.0054941658   0.00023840275  0              0.016244095    1.6386994e-06  0              0.31650773     0              0              2.9958903    
   1600000   2310           200            200            0.0054940936   0.00023840213  0              0.016243879    2.1660993e-07  0              0.041837273    0              0              2.9958903    
   1700000   2310           200            200            0.0054941289   0.00023840244  0              0.016243984    2.8427202e-08  0              0.0054905914   0              0              2.9958903    
   1800000   2310           200            200            0.0054941127   0.0002384023   0              0.016243936    3.7031827e-09  0              0.00071525377  0              0              2.9958903    
   1900000   2310           200            200            0.0054941198   0.00023840236  0              0.016243957    4.7870776e-10  0              9.2460338e-05  0              0              2.9958903    
   2000000   2310           200            200            0.0054941168   0.00023840234  0              0.016243948    6.1380825e-11  0              1.1855441e-05  0              0              2.9958903    
   2100000   2310           200            200            0.0054941181   0.00023840235  0              0.016243952    7.8064846e-12  0              1.5077888e-06  0              0              2.9958903    
   2200000   2310           200            200            0.0054941176   0.00023840234  0              0.01624395     9.8421125e-13  0              1.9009616e-07  0              0              2.9958903    
   2300000   2310           200            200            0.0054941178   0.00023840234  0              0.016243951    1.2309306e-13  0              2.3774893e-08  0              0              2.9958903    
   2400000   2310           200            200            0.0054941177   0.00023840234  0              0.016243951    1.5148734e-14  0              2.9259126e-09  0              0              2.9958903    
   2500000   2310           200            200            0.0054941177   0.00023840234  0              0.016243951    1.8251887e-15  0              3.5252731e-10  0              0              2.9958903    
   2600000   2310           200            200            0.0054941177   0.00023840234  0              0.016243951    2.3732754e-16  0              4.583879e-11   0              0              2.9958903    
   2700000   2310           200            200            0.0054941177   0.00023840234  0              0.016243951    3.8737542e-17  0              7.4819891e-12  0              0              2.9958903    
   2800000   2310           200            200            0.0054941177   0.00023840234  0              0.016243951    5.2738746e-18  0              1.0186261e-12  0              0              2.9958903    
   2900000   2310           200            200            0.0054941177   0.00023840234  0              0.016243951    9.7928632e-19  0              1.8914493e-13  0              0              2.9958903    
   3000000   2310           200            200            0.0054941177   0.00023840234  0              0.016243951    1.3009439e-18  0              2.5127169e-13  0              0              2.9958903    
Loop time of 199.922 on 2 procs for 3000000 steps with 1251 atoms

Performance: 12965081.734 ns/day, 0.000 hours/ns, 15005.882 timesteps/s
99.9% CPU use with 2 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 60.15      | 60.444     | 60.738     |   3.8 | 30.23
Neigh   | 2.8874     | 2.8878     | 2.8881     |   0.0 |  1.44
Comm    | 14.422     | 14.653     | 14.884     |   6.0 |  7.33
Output  | 0.21274    | 0.21277    | 0.2128     |   0.0 |  0.11
Modify  | 108.5      | 108.59     | 108.69     |   0.9 | 54.32
Other   |            | 13.13      |            |       |  6.57

Nlocal:          625.5 ave         626 max         625 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Nghost:            4.5 ave           5 max           4 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Neighs:          751.5 ave         752 max         751 min
Histogram: 1 0 0 0 0 0 0 0 0 1

Total # of neighbors = 1503
Ave neighs/atom = 1.2014388
Neighbor list builds = 164
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 9

#variable lat0 equal 1                    #
variable lat1 equal 3+(v_ind*0.01)        # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 250*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 3.09                                                               
Lattice spacing in x,y,z = 3.09 3.09 3.09

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -1158.75 ${n1e1} -100 100 -100 100 units box
region box block -1158.75 1158.75 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -1158.75 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -1158.75 1158.75 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-1158.75 -100 -100) to (1158.75 100 100)
  2 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 750 atoms
  using lattice units in orthogonal box = (-1158.75 -100 -100) to (1158.75 100 100)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -750 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -750 750 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 501 atoms
  using lattice units in orthogonal box = (-1158.75 -100 -100) to (1158.75 100 100)
  create_atoms CPU = 0.000 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  750 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  750 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  501 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  501 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
750 atoms in group substrate
group slider1 region slider1
501 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 501 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_9_*.dump id type diameter mass xu yu zu fx fy fz

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 1496 130 130
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 65.2 | 65.2 | 65.2 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   2317.5         200            200            0              0              0              0              0              0              0              0              0              6            
    100000   2317.5         200            200            0.004405711    2.1785307e-36  0              0.013217133    294262.69      0              5.6835569e+10  0              0              3.3244731    
    200000   2317.5         200            200            0.0015866197   2.4940871e-43  0              0.004759859    73584.22       0              1.4212475e+10  0              0              3.0706993    
    300000   2317.5         200            200            0.00015982605 -2.7231429e-37  0              0.00047947814  1489.6628      0              2.8772194e+08  0              0              3.0452734    
    400000   2317.5         200            200            0.027359698    0.0040830353   0              0.077996057    1219.7844      0              2.3559609e+08  0              0              2.9911211    
    500000   2317.5         200            200            0.00052215722 -8.3517374e-05  0              0.001649989    107.2885       0              20722311       0              0              2.9987553    
    600000   2317.5         200            200            0.0059414035   0.00014750064  0              0.01767671     111.75707      0              21585396       0              0              2.9957499    
    700000   2317.5         200            200            0.0056762627   0.00060265749  0              0.016426131    15.518135      0              2997260.8      0              0              2.995909     
    800000   2317.5         200            200            0.0053003872   0.00049170748  0              0.015409454    0.93228404     0              180066.64      0              0              2.99604      
    900000   2317.5         200            200            0.005457116    0.00053640509  0              0.015834943    0.036465602    0              7043.1737      0              0              2.995988     
   1000000   2317.5         200            200            0.005574341    0.00054160774  0              0.016181415    0.038029017    0              7345.1405      0              0              2.9959449    
   1100000   2317.5         200            200            0.0055930678   0.00054231591  0              0.016236888    0.0012947425   0              250.07393      0              0              2.9959379    
   1200000   2317.5         200            200            0.0055830949   0.00054196337  0              0.016207321    0.00022400116  0              43.264858      0              0              2.9959414    
   1300000   2317.5         200            200            0.0055774217   0.00054175328  0              0.016190512    9.1902883e-05  0              17.750645      0              0              2.9959435    
   1400000   2317.5         200            200            0.0055769749   0.00054173539  0              0.016189189    1.0199354e-06  0              0.19699611     0              0              2.9959437    
   1500000   2317.5         200            200            0.0055775997   0.00054175834  0              0.016191041    9.5097984e-07  0              0.18367765     0              0              2.9959435    
   1600000   2317.5         200            200            0.0055778575   0.000541768    0              0.016191804    1.9770052e-07  0              0.038185003    0              0              2.9959434    
   1700000   2317.5         200            200            0.0055778546   0.00054176796  0              0.016191796    7.883765e-11   0              1.5227152e-05  0              0              2.9959434    
   1800000   2317.5         200            200            0.0055778189   0.00054176664  0              0.01619169     3.2752514e-09  0              0.00063260067  0              0              2.9959434    
   1900000   2317.5         200            200            0.005577808    0.00054176623  0              0.016191658    3.7210045e-10  0              7.1869597e-05  0              0              2.9959434    
   2000000   2317.5         200            200            0.0055778094   0.00054176628  0              0.016191662    2.6559153e-12  0              5.1297857e-07  0              0              2.9959434    
   2100000   2317.5         200            200            0.0055778113   0.00054176635  0              0.016191668    9.733617e-12   0              1.8800061e-06  0              0              2.9959434    
   2200000   2317.5         200            200            0.0055778117   0.00054176637  0              0.016191669    5.8729206e-13  0              1.1343293e-07  0              0              2.9959434    
   2300000   2317.5         200            200            0.0055778116   0.00054176636  0              0.016191668    3.2338997e-14  0              6.2461377e-09  0              0              2.9959434    
   2400000   2317.5         200            200            0.0055778115   0.00054176636  0              0.016191668    2.5626703e-14  0              4.949687e-09   0              0              2.9959434    
   2500000   2317.5         200            200            0.0055778115   0.00054176636  0              0.016191668    7.0613972e-16  0              1.3638784e-10  0              0              2.9959434    
   2600000   2317.5         200            200            0.0055778115   0.00054176636  0              0.016191668    1.9334155e-16  0              3.7343086e-11  0              0              2.9959434    
   2700000   2317.5         200            200            0.0055778115   0.00054176636  0              0.016191668    6.1857619e-17  0              1.1947532e-11  0              0              2.9959434    
   2800000   2317.5         200            200            0.0055778115   0.00054176636  0              0.016191668    1.400129e-18   0              2.7042887e-13  0              0              2.9959434    
   2900000   2317.5         200            200            0.0055778115   0.00054176636  0              0.016191668    1.0425316e-18  0              2.0136048e-13  0              0              2.9959434    
   3000000   2317.5         200            200            0.0055778115   0.00054176636  0              0.016191668    2.7024565e-18  0              5.219678e-13   0              0              2.9959434    
Loop time of 201.047 on 2 procs for 3000000 steps with 1251 atoms

Performance: 12892528.227 ns/day, 0.000 hours/ns, 14921.908 timesteps/s
99.9% CPU use with 2 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 61.3       | 61.595     | 61.89      |   3.8 | 30.64
Neigh   | 2.931      | 2.9313     | 2.9316     |   0.0 |  1.46
Comm    | 14.424     | 14.649     | 14.874     |   5.9 |  7.29
Output  | 0.21522    | 0.21525    | 0.21528    |   0.0 |  0.11
Modify  | 108.35     | 108.51     | 108.68     |   1.6 | 53.97
Other   |            | 13.14      |            |       |  6.54

Nlocal:          625.5 ave         626 max         625 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Nghost:            4.5 ave           5 max           4 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Neighs:          757.5 ave         758 max         757 min
Histogram: 1 0 0 0 0 0 0 0 0 1

Total # of neighbors = 1515
Ave neighs/atom = 1.2110312
Neighbor list builds = 166
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 10

#variable lat0 equal 1                    #
variable lat1 equal 3+(v_ind*0.01)        # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 250*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 3.1                                                               
Lattice spacing in x,y,z = 3.1 3.1 3.1

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -1162.5 ${n1e1} -100 100 -100 100 units box
region box block -1162.5 1162.5 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -1162.5 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -1162.5 1162.5 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-1162.5 -100 -100) to (1162.5 100 100)
  2 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 750 atoms
  using lattice units in orthogonal box = (-1162.5 -100 -100) to (1162.5 100 100)
  create_atoms CPU = 0.000 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -750 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -750 750 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 501 atoms
  using lattice units in orthogonal box = (-1162.5 -100 -100) to (1162.5 100 100)
  create_atoms CPU = 0.000 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  750 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  750 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  501 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  501 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
750 atoms in group substrate
group slider1 region slider1
501 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 501 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_10_*.dump id type diameter mass xu yu zu fx fy fz

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 1500 130 130
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 65.41 | 65.41 | 65.41 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   2325           200            200            0              0              0              0              0              0              0              0              0              6            
    100000   2325           200            200            0.0043917304   8.685965e-36   0              0.013175191    294279.53      0              5.683882e+10   0              0              3.3245393    
    200000   2325           200            200            0.0015824053   1.2006918e-42  0              0.0047472159   73647.911      0              1.4224776e+10  0              0              3.0706733    
    300000   2325           200            200            0.00016151653  1.3082741e-44  0              0.00048454959  1528.5045      0              2.9522405e+08  0              0              3.0452925    
    400000   2325           200            200            0.028972819    0.0021249543   0              0.084793503    514.42575      0              99359114       0              0              2.9908081    
    500000   2325           200            200            0.00050746901  3.2572321e-36  0              0.001522407    97.952964      0              18919192       0              0              2.998821     
    600000   2325           200            200            0.0029933711   0.00014364927  0              0.0088364641   1.801435       0              347939.4       0              0              2.9970403    
    700000   2325           200            200            0.0061173312   0.0002447714   0              0.018107222    8.7940058      0              1698524.3      0              0              2.9958269    
    800000   2325           200            200            0.0054379767   0.00023928854  0              0.016074642    2.1237066      0              410184.76      0              0              2.9960627    
    900000   2325           200            200            0.0053848636   0.00023871164  0              0.015915879    0.19041594     0              36778.017      0              0              2.9960847    
   1000000   2325           200            200            0.0055057011   0.00023986774  0              0.016277235    0.0032540773   0              628.51099      0              0              2.9960401    
   1100000   2325           200            200            0.0054433157   0.0002392861   0              0.016090661    0.00066879439  0              129.17475      0              0              2.9960628    
   1200000   2325           200            200            0.0054632406   0.00023947128  0              0.01615025     0.00051662164  0              99.78324       0              0              2.9960556    
   1300000   2325           200            200            0.0054600768   0.00023944288  0              0.016140788    9.4384189e-05  0              18.229899      0              0              2.9960567    
   1400000   2325           200            200            0.0054592248   0.00023943445  0              0.01613824     6.6425428e-06  0              1.2829785      0              0              2.996057     
   1500000   2325           200            200            0.0054601473   0.00023944319  0              0.016140999    3.4643831e-08  0              0.0066913065   0              0              2.9960567    
   1600000   2325           200            200            0.0054597262   0.00023943925  0              0.016139739    5.7513149e-08  0              0.011108416    0              0              2.9960568    
   1700000   2325           200            200            0.0054598464   0.00023944036  0              0.016140099    2.7061184e-08  0              0.0052267509   0              0              2.9960568    
   1800000   2325           200            200            0.0054598334   0.00023944024  0              0.01614006     3.9969859e-09  0              0.00077200057  0              0              2.9960568    
   1900000   2325           200            200            0.0054598247   0.00023944016  0              0.016140034    2.11147e-10    0              4.0782132e-05  0              0              2.9960568    
   2000000   2325           200            200            0.0054598315   0.00023944022  0              0.016140054    8.2891035e-15  0              1.6010046e-09  0              0              2.9960568    
   2100000   2325           200            200            0.0054598287   0.0002394402   0              0.016140046    4.0598248e-12  0              7.8413765e-07  0              0              2.9960568    
   2200000   2325           200            200            0.0054598294   0.0002394402   0              0.016140048    1.3425836e-12  0              2.5931423e-07  0              0              2.9960568    
   2300000   2325           200            200            0.0054598294   0.0002394402   0              0.016140048    1.6094009e-13  0              3.1084883e-08  0              0              2.9960568    
   2400000   2325           200            200            0.0054598293   0.0002394402   0              0.016140048    5.9038719e-15  0              1.1403074e-09  0              0              2.9960568    
   2500000   2325           200            200            0.0054598294   0.0002394402   0              0.016140048    8.6603661e-17  0              1.6727123e-11  0              0              2.9960568    
   2600000   2325           200            200            0.0054598294   0.0002394402   0              0.016140048    2.4262106e-16  0              4.6861211e-11  0              0              2.9960568    
   2700000   2325           200            200            0.0054598294   0.0002394402   0              0.016140048    6.1690384e-17  0              1.1915231e-11  0              0              2.9960568    
   2800000   2325           200            200            0.0054598294   0.0002394402   0              0.016140048    2.0996266e-18  0              4.0553381e-13  0              0              2.9960568    
   2900000   2325           200            200            0.0054598294   0.0002394402   0              0.016140048    5.0854433e-21  0              9.8223143e-16  0              0              2.9960568    
   3000000   2325           200            200            0.0054598294   0.0002394402   0              0.016140048    2.0986242e-18  0              4.053402e-13   0              0              2.9960568    
Loop time of 187.823 on 2 procs for 3000000 steps with 1251 atoms

Performance: 13800261.947 ns/day, 0.000 hours/ns, 15972.525 timesteps/s
99.9% CPU use with 2 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 47.415     | 47.598     | 47.78      |   2.6 | 25.34
Neigh   | 2.9526     | 2.9527     | 2.9528     |   0.0 |  1.57
Comm    | 14.419     | 14.593     | 14.766     |   4.5 |  7.77
Output  | 0.21068    | 0.21072    | 0.21075    |   0.0 |  0.11
Modify  | 109.25     | 109.31     | 109.36     |   0.5 | 58.20
Other   |            | 13.16      |            |       |  7.01

Nlocal:          625.5 ave         626 max         625 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Nghost:            4.5 ave           5 max           4 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Neighs:            500 ave         507 max         493 min
Histogram: 1 0 0 0 0 0 0 0 0 1

Total # of neighbors = 1000
Ave neighs/atom = 0.79936051
Neighbor list builds = 166
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 11

#variable lat0 equal 1                    #
variable lat1 equal 3+(v_ind*0.01)        # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 250*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 3.11                                                               
Lattice spacing in x,y,z = 3.11 3.11 3.11

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -1166.25 ${n1e1} -100 100 -100 100 units box
region box block -1166.25 1166.25 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -1166.25 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -1166.25 1166.25 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-1166.25 -100 -100) to (1166.25 100 100)
  2 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 750 atoms
  using lattice units in orthogonal box = (-1166.25 -100 -100) to (1166.25 100 100)
  create_atoms CPU = 0.000 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -750 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -750 750 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 501 atoms
  using lattice units in orthogonal box = (-1166.25 -100 -100) to (1166.25 100 100)
  create_atoms CPU = 0.000 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  750 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  750 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  501 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  501 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
750 atoms in group substrate
group slider1 region slider1
501 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 501 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_11_*.dump id type diameter mass xu yu zu fx fy fz

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 1505 130 130
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 65.55 | 65.55 | 65.55 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   2332.5         200            200            0              0              0              0              0              0              0              0              0              6            
    100000   2332.5         200            200            0.0043729987   4.3290435e-36  0              0.013118996    293822.3       0              5.6750509e+10  0              0              3.3251604    
    200000   2332.5         200            200            0.0015660876   7.9544083e-42  0              0.0046982627   72832.618      0              1.4067306e+10  0              0              3.0719383    
    300000   2332.5         200            200            0.00014217333 -1.0822494e-36  0              0.00042651998  1210.0903      0              2.3372372e+08  0              0              3.0454491    
    400000   2332.5         200            200            0.016470674    0.001288813    0              0.04812321     3848.9428      0              7.4340669e+08  0              0              2.9927718    
    500000   2332.5         200            200            0.0011592644   0.00042227701  0              0.0030555162   308.90292      0              59663266       0              0              2.9981028    
    600000   2332.5         200            200            0.0048424213   0.0011609275   0              0.013366336    97.714287      0              18873093       0              0              2.9961803    
    700000   2332.5         200            200            0.0049821275   0.0010859971   0              0.013860385    4.948829       0              955844.97      0              0              2.9960908    
    800000   2332.5         200            200            0.0059088179   0.0010780174   0              0.016648436    1.4130526      0              272925.02      0              0              2.9957211    
    900000   2332.5         200            200            0.0058187895   0.0010664682   0              0.0163899      0.094974649    0              18343.944      0              0              2.9957565    
   1000000   2332.5         200            200            0.005689743    0.0010635048   0              0.016005724    0.023928128    0              4621.6147      0              0              2.995806     
   1100000   2332.5         200            200            0.0057036744   0.0010638398   0              0.016047183    0.0019365731   0              374.04073      0              0              2.9958003    
   1200000   2332.5         200            200            0.0057208462   0.00106423     0              0.016098308    0.00040834449  0              78.869975      0              0              2.9957937    
   1300000   2332.5         200            200            0.005718695    0.0010641784   0              0.016091907    3.9243305e-05  0              7.5796751      0              0              2.9957946    
   1400000   2332.5         200            200            0.0057164099   0.0010641264   0              0.016085103    6.9141484e-06  0              1.3354379      0              0              2.9957955    
   1500000   2332.5         200            200            0.0057167365   0.0010641342   0              0.016086075    7.8754441e-07  0              0.1521108      0              0              2.9957953    
   1600000   2332.5         200            200            0.0057170399   0.0010641411   0              0.016086979    1.163237e-07   0              0.02246742     0              0              2.9957952    
   1700000   2332.5         200            200            0.005716991    0.00106414     0              0.016086833    1.5681901e-08  0              0.0030288914   0              0              2.9957952    
   1800000   2332.5         200            200            0.0057169508   0.0010641391   0              0.016086713    1.9428063e-09  0              0.00037524466  0              0              2.9957952    
   1900000   2332.5         200            200            0.0057169581   0.0010641392   0              0.016086735    3.1000538e-10  0              5.9876201e-05  0              0              2.9957952    
   2000000   2332.5         200            200            0.0057169634   0.0010641393   0              0.016086751    3.2197239e-11  0              6.2187577e-06  0              0              2.9957952    
   2100000   2332.5         200            200            0.0057169623   0.0010641393   0              0.016086748    6.0880107e-12  0              1.175873e-06   0              0              2.9957952    
   2200000   2332.5         200            200            0.0057169616   0.0010641393   0              0.016086746    5.287576e-13   0              1.0212725e-07  0              0              2.9957952    
   2300000   2332.5         200            200            0.0057169618   0.0010641393   0              0.016086746    1.1882617e-13  0              2.2950762e-08  0              0              2.9957952    
   2400000   2332.5         200            200            0.0057169619   0.0010641393   0              0.016086746    8.5707243e-15  0              1.6553984e-09  0              0              2.9957952    
   2500000   2332.5         200            200            0.0057169618   0.0010641393   0              0.016086746    2.3136952e-15  0              4.4688024e-10  0              0              2.9957952    
   2600000   2332.5         200            200            0.0057169618   0.0010641393   0              0.016086746    1.4328487e-16  0              2.7674855e-11  0              0              2.9957952    
   2700000   2332.5         200            200            0.0057169618   0.0010641393   0              0.016086746    5.3114756e-17  0              1.0258886e-11  0              0              2.9957952    
   2800000   2332.5         200            200            0.0057169618   0.0010641393   0              0.016086746    4.9900121e-19  0              9.6379931e-14  0              0              2.9957952    
   2900000   2332.5         200            200            0.0057169618   0.0010641393   0              0.016086746    1.1929195e-18  0              2.3040725e-13  0              0              2.9957952    
   3000000   2332.5         200            200            0.0057169618   0.0010641393   0              0.016086746    3.4074595e-19  0              6.5813609e-14  0              0              2.9957952    
Loop time of 179.862 on 2 procs for 3000000 steps with 1251 atoms

Performance: 14411024.407 ns/day, 0.000 hours/ns, 16679.426 timesteps/s
99.9% CPU use with 2 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 41.225     | 41.413     | 41.602     |   2.9 | 23.03
Neigh   | 2.9438     | 2.9446     | 2.9453     |   0.0 |  1.64
Comm    | 13.743     | 13.758     | 13.773     |   0.4 |  7.65
Output  | 0.21123    | 0.21125    | 0.21127    |   0.0 |  0.12
Modify  | 108.59     | 108.79     | 108.99     |   1.9 | 60.49
Other   |            | 12.74      |            |       |  7.08

Nlocal:          625.5 ave         626 max         625 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Nghost:            2.5 ave           3 max           2 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Neighs:          374.5 ave         375 max         374 min
Histogram: 1 0 0 0 0 0 0 0 0 1

Total # of neighbors = 749
Ave neighs/atom = 0.59872102
Neighbor list builds = 164
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 12

#variable lat0 equal 1                    #
variable lat1 equal 3+(v_ind*0.01)        # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 250*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 3.12                                                               
Lattice spacing in x,y,z = 3.12 3.12 3.12

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -1170 ${n1e1} -100 100 -100 100 units box
region box block -1170 1170 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -1170 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -1170 1170 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-1170 -100 -100) to (1170 100 100)
  2 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 750 atoms
  using lattice units in orthogonal box = (-1170 -100 -100) to (1170 100 100)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -750 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -750 750 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 501 atoms
  using lattice units in orthogonal box = (-1170 -100 -100) to (1170 100 100)
  create_atoms CPU = 0.000 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  750 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  750 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  501 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  501 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
750 atoms in group substrate
group slider1 region slider1
501 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 501 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_12_*.dump id type diameter mass xu yu zu fx fy fz

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 1510 130 130
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 65.69 | 65.69 | 65.69 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   2340           200            200            0              0              0              0              0              0              0              0              0              6            
    100000   2340           200            200            0.0043602576  -2.6969595e-37  0              0.013080773    293949.32      0              5.6775043e+10  0              0              3.3249849    
    200000   2340           200            200            0.0015641462   4.6364822e-47  0              0.0046924387   73056.812      0              1.4110608e+10  0              0              3.0715798    
    300000   2340           200            200            0.00014884769  8.7495104e-43  0              0.00044654306  1327.2728      0              2.5635701e+08  0              0              3.0453325    
    400000   2340           200            200            0.017197175    0.00081861483  0              0.050772909    3709.5715      0              7.1648774e+08  0              0              2.9927327    
    500000   2340           200            200            0.00049887639 -2.6969603e-37  0              0.0014966292   0.88159362     0              170276         0              0              2.9988602    
    600000   2340           200            200            0.0043824013   0.0001232513   0              0.013023953    101.72587      0              19647913       0              0              2.9962208    
    700000   2340           200            200            0.0044586449   0.00021058156  0              0.013165353    0.04149131     0              8013.8675      0              0              2.9961879    
    800000   2340           200            200            0.0051538817   0.00022100072  0              0.015240644    0.99303709     0              191800.83      0              0              2.9959321    
    900000   2340           200            200            0.0054110434   0.00022403886  0              0.016009091    0.28832581     0              55688.886      0              0              2.9958422    
   1000000   2340           200            200            0.0054510724   0.00022446685  0              0.01612875     0.022922156    0              4427.3156      0              0              2.9958288    
   1100000   2340           200            200            0.0054377107   0.00022431311  0              0.016088819    7.3635441e-05  0              14.222368      0              0              2.9958336    
   1200000   2340           200            200            0.0054252011   0.00022417302  0              0.01605143     0.00025046095  0              48.375452      0              0              2.995838     
   1300000   2340           200            200            0.0054203057   0.00022411867  0              0.016036798    9.2937347e-05  0              17.950447      0              0              2.9958397    
   1400000   2340           200            200            0.0054193698   0.0002241085   0              0.016034001    9.1894595e-06  0              1.7749045      0              0              2.99584      
   1500000   2340           200            200            0.0054195288   0.00022411039  0              0.016034476    1.0468367e-07  0              0.020219198    0              0              2.99584      
   1600000   2340           200            200            0.0054197404   0.00022411278  0              0.016035109    5.5607909e-08  0              0.010740428    0              0              2.9958399    
   1700000   2340           200            200            0.0054198324   0.0002241138   0              0.016035383    2.8930366e-08  0              0.0055877754   0              0              2.9958399    
   1800000   2340           200            200            0.0054198531   0.00022411403  0              0.016035445    3.5213929e-09  0              0.00068014183  0              0              2.9958399    
   1900000   2340           200            200            0.0054198518   0.00022411401  0              0.016035442    7.8281839e-11  0              1.5119799e-05  0              0              2.9958399    
   2000000   2340           200            200            0.0054198483   0.00022411398  0              0.016035431    1.0683164e-11  0              2.063407e-06   0              0              2.9958399    
   2100000   2340           200            200            0.0054198466   0.00022411396  0              0.016035426    8.6833791e-12  0              1.6771572e-06  0              0              2.9958399    
   2200000   2340           200            200            0.0054198462   0.00022411395  0              0.016035425    1.2963794e-12  0              2.5039008e-07  0              0              2.9958399    
   2300000   2340           200            200            0.0054198462   0.00022411395  0              0.016035425    4.491954e-14   0              8.6760153e-09  0              0              2.9958399    
   2400000   2340           200            200            0.0054198463   0.00022411395  0              0.016035425    1.5513125e-15  0              2.9962932e-10  0              0              2.9958399    
   2500000   2340           200            200            0.0054198463   0.00022411395  0              0.016035425    2.4808524e-15  0              4.7916594e-10  0              0              2.9958399    
   2600000   2340           200            200            0.0054198463   0.00022411395  0              0.016035425    4.6564907e-16  0              8.9938108e-11  0              0              2.9958399    
   2700000   2340           200            200            0.0054198463   0.00022411395  0              0.016035425    9.1277952e-18  0              1.7629943e-12  0              0              2.9958399    
   2800000   2340           200            200            0.0054198463   0.00022411395  0              0.016035425    1.3173427e-18  0              2.5443906e-13  0              0              2.9958399    
   2900000   2340           200            200            0.0054198463   0.00022411395  0              0.016035425    2.4699054e-18  0              4.7705156e-13  0              0              2.9958399    
   3000000   2340           200            200            0.0054198463   0.00022411395  0              0.016035425    1.1595046e-18  0              2.239533e-13   0              0              2.9958399    
Loop time of 179.578 on 2 procs for 3000000 steps with 1251 atoms

Performance: 14433872.956 ns/day, 0.000 hours/ns, 16705.871 timesteps/s
99.9% CPU use with 2 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 41.455     | 41.524     | 41.592     |   1.1 | 23.12
Neigh   | 2.9777     | 2.979      | 2.9803     |   0.1 |  1.66
Comm    | 13.266     | 13.316     | 13.365     |   1.4 |  7.42
Output  | 0.21511    | 0.21514    | 0.21517    |   0.0 |  0.12
Modify  | 108.77     | 108.81     | 108.85     |   0.4 | 60.59
Other   |            | 12.74      |            |       |  7.09

Nlocal:          625.5 ave         626 max         625 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Nghost:            2.5 ave           3 max           2 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Neighs:          373.5 ave         374 max         373 min
Histogram: 1 0 0 0 0 0 0 0 0 1

Total # of neighbors = 747
Ave neighs/atom = 0.5971223
Neighbor list builds = 164
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 13

#variable lat0 equal 1                    #
variable lat1 equal 3+(v_ind*0.01)        # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 250*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 3.13                                                               
Lattice spacing in x,y,z = 3.13 3.13 3.13

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -1173.75 ${n1e1} -100 100 -100 100 units box
region box block -1173.75 1173.75 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -1173.75 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -1173.75 1173.75 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-1173.75 -100 -100) to (1173.75 100 100)
  2 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 750 atoms
  using lattice units in orthogonal box = (-1173.75 -100 -100) to (1173.75 100 100)
  create_atoms CPU = 0.000 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -750 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -750 750 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 501 atoms
  using lattice units in orthogonal box = (-1173.75 -100 -100) to (1173.75 100 100)
  create_atoms CPU = 0.000 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  750 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  750 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  501 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  501 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
750 atoms in group substrate
group slider1 region slider1
501 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 501 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_13_*.dump id type diameter mass xu yu zu fx fy fz

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 1515 130 130
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 65.89 | 65.89 | 65.89 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   2347.5         200            200            0              0              0              0              0              0              0              0              0              6            
    100000   2347.5         200            200            0.0043476008   1.2642372e-44  0              0.013042802    294079.55      0              5.6800196e+10  0              0              3.3247623    
    200000   2347.5         200            200            0.0015621784   2.1506757e-36  0              0.0046865353   73279.002      0              1.4153523e+10  0              0              3.071199     
    300000   2347.5         200            200            0.0001509102  -1.075337e-36   0              0.00045273059  1370.2227      0              2.646526e+08   0              0              3.0453568    
    400000   2347.5         200            200            0.022484371    0.00088238822  0              0.066570724    2237.2522      0              4.3211561e+08  0              0              2.9916071    
    500000   2347.5         200            200            0.00060227952  0.00074721061  0              0.001059628    20.572824      0              3973552.2      0              0              2.9988763    
    600000   2347.5         200            200            0.0055733155  -0.002503362    0              0.019223308    94.211295      0              18196505       0              0              2.99551      
    700000   2347.5         200            200            0.0036328345  -0.0025850137   0              0.013483517    1.7599138      0              339919.75      0              0              2.9962466    
    800000   2347.5         200            200            0.0046658314  -0.0028925651   0              0.016890059    0.37227038     0              71902.417      0              0              2.9957863    
    900000   2347.5         200            200            0.0043498493  -0.0028184317   0              0.015867979    0.24849877     0              47996.466      0              0              2.9959219    
   1000000   2347.5         200            200            0.004366283   -0.0028221264   0              0.015920975    0.029418319    0              5682.0214      0              0              2.9959139    
   1100000   2347.5         200            200            0.0044012042  -0.0028286555   0              0.016032268    0.00037124647  0              71.704653      0              0              2.9958994    
   1200000   2347.5         200            200            0.0043813833  -0.0028248895   0              0.015969039    0.00018101152  0              34.961593      0              0              2.9959078    
   1300000   2347.5         200            200            0.0043866706  -0.0028259165   0              0.015985928    8.8212422e-05  0              17.037849      0              0              2.9959055    
   1400000   2347.5         200            200            0.0043866772  -0.0028259086   0              0.01598594     8.5443572e-06  0              1.6503057      0              0              2.9959055    
   1500000   2347.5         200            200            0.0043859598  -0.0028257741   0              0.015983654    4.2820474e-08  0              0.0082705898   0              0              2.9959058    
   1600000   2347.5         200            200            0.004386321   -0.002825843    0              0.015984806    8.4270026e-08  0              0.016276392    0              0              2.9959057    
   1700000   2347.5         200            200            0.0043862356  -0.0028258264   0              0.015984533    3.043412e-08   0              0.005878219    0              0              2.9959057    
   1800000   2347.5         200            200            0.0043862299  -0.0028258255   0              0.015984515    2.3858372e-09  0              0.00046081415  0              0              2.9959057    
   1900000   2347.5         200            200            0.0043862443  -0.0028258282   0              0.015984561    1.1961193e-12  0              2.3102529e-07  0              0              2.9959057    
   2000000   2347.5         200            200            0.0043862378  -0.002825827    0              0.01598454     3.6535399e-11  0              7.0566546e-06  0              0              2.9959057    
   2100000   2347.5         200            200            0.0043862392  -0.0028258272   0              0.015984545    1.0228307e-11  0              1.9755534e-06  0              0              2.9959057    
   2200000   2347.5         200            200            0.0043862394  -0.0028258273   0              0.015984545    6.3606546e-13  0              1.228533e-07   0              0              2.9959057    
   2300000   2347.5         200            200            0.0043862391  -0.0028258272   0              0.015984544    8.7894788e-16  0              1.6976499e-10  0              0              2.9959057    
   2400000   2347.5         200            200            0.0043862392  -0.0028258272   0              0.015984545    1.4966464e-14  0              2.890708e-09   0              0              2.9959057    
   2500000   2347.5         200            200            0.0043862392  -0.0028258272   0              0.015984545    3.3560535e-15  0              6.4820725e-10  0              0              2.9959057    
   2600000   2347.5         200            200            0.0043862392  -0.0028258272   0              0.015984545    1.6520177e-16  0              3.1908009e-11  0              0              2.9959057    
   2700000   2347.5         200            200            0.0043862392  -0.0028258272   0              0.015984545    5.1266604e-22  0              9.9019232e-17  0              0              2.9959057    
   2800000   2347.5         200            200            0.0043862392  -0.0028258272   0              0.015984545    3.2737679e-18  0              6.3231414e-13  0              0              2.9959057    
   2900000   2347.5         200            200            0.0043862392  -0.0028258272   0              0.015984545    1.7732827e-18  0              3.425019e-13   0              0              2.9959057    
   3000000   2347.5         200            200            0.0043862392  -0.0028258272   0              0.015984545    4.9260825e-19  0              9.5145157e-14  0              0              2.9959057    
Loop time of 179.482 on 2 procs for 3000000 steps with 1251 atoms

Performance: 14441570.609 ns/day, 0.000 hours/ns, 16714.781 timesteps/s
99.9% CPU use with 2 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 41.214     | 41.23      | 41.247     |   0.3 | 22.97
Neigh   | 2.9771     | 2.9771     | 2.9772     |   0.0 |  1.66
Comm    | 13.29      | 13.381     | 13.472     |   2.5 |  7.46
Output  | 0.21611    | 0.21614    | 0.21617    |   0.0 |  0.12
Modify  | 108.91     | 108.94     | 108.97     |   0.3 | 60.70
Other   |            | 12.73      |            |       |  7.09

Nlocal:          625.5 ave         626 max         625 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Nghost:            2.5 ave           3 max           2 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Neighs:          376.5 ave         377 max         376 min
Histogram: 1 0 0 0 0 0 0 0 0 1

Total # of neighbors = 753
Ave neighs/atom = 0.60191847
Neighbor list builds = 164
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 14

#variable lat0 equal 1                    #
variable lat1 equal 3+(v_ind*0.01)        # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 250*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 3.14                                                               
Lattice spacing in x,y,z = 3.14 3.14 3.14

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -1177.5 ${n1e1} -100 100 -100 100 units box
region box block -1177.5 1177.5 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -1177.5 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -1177.5 1177.5 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-1177.5 -100 -100) to (1177.5 100 100)
  2 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 750 atoms
  using lattice units in orthogonal box = (-1177.5 -100 -100) to (1177.5 100 100)
  create_atoms CPU = 0.000 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -750 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -750 750 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 501 atoms
  using lattice units in orthogonal box = (-1177.5 -100 -100) to (1177.5 100 100)
  create_atoms CPU = 0.000 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  750 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  750 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  501 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  501 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
750 atoms in group substrate
group slider1 region slider1
501 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 501 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_14_*.dump id type diameter mass xu yu zu fx fy fz

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 1520 130 130
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 66.03 | 66.03 | 66.03 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   2355           200            200            0              0              0              0              0              0              0              0              0              6            
    100000   2355           200            200            0.0043347314  -2.1438248e-36  0              0.013004194    294178.83      0              5.6819371e+10  0              0              3.3246054    
    200000   2355           200            200            0.0015593998  -1.3398909e-36  0              0.0046781994   73440.345      0              1.4184686e+10  0              0              3.0709383    
    300000   2355           200            200            0.00015421812  2.1438259e-36  0              0.00046265435  1435.7273      0              2.7730454e+08  0              0              3.0453091    
    400000   2355           200            200            0.023522611   -0.0012113598   0              0.071779192    1723.1805      0              3.3282488e+08  0              0              2.9913547    
    500000   2355           200            200            0.00039281536 -8.7091594e-06  0              0.0011871552   22.442962      0              4334761.2      0              0              2.9989078    
    600000   2355           200            200            0.0068317861  -0.0020940249   0              0.022589383    35.37257       0              6832059.2      0              0              2.9951342    
    700000   2355           200            200            0.0056658414  -0.0017454517   0              0.018742976    0.30551359     0              59008.631      0              0              2.9955757    
    800000   2355           200            200            0.0049591966  -0.0017134047   0              0.016590995    1.2252279      0              236647.49      0              0              2.995841     
    900000   2355           200            200            0.0047464775  -0.001687933    0              0.015927365    0.28050099     0              54177.556      0              0              2.9959254    
   1000000   2355           200            200            0.0047192699  -0.0016846698   0              0.015842479    0.020627121    0              3984.0395      0              0              2.9959358    
   1100000   2355           200            200            0.004732516   -0.0016864223   0              0.01588397     6.5157251e-05  0              12.584842      0              0              2.9959302    
   1200000   2355           200            200            0.0047435516  -0.0016878307   0              0.015918485    0.00022298122  0              43.06786       0              0              2.9959257    
   1300000   2355           200            200            0.0047478789  -0.0016883741   0              0.015932011    8.7636114e-05  0              16.926537      0              0              2.995924     
   1400000   2355           200            200            0.0047487847  -0.0016884852   0              0.015934839    1.0037245e-05  0              1.9386505      0              0              2.9959236    
   1500000   2355           200            200            0.0047487019  -0.0016884735   0              0.015934579    2.4060806e-07  0              0.046472409    0              0              2.9959236    
   1600000   2355           200            200            0.0047485338  -0.001688452    0              0.015934053    2.4379084e-08  0              0.0047087148   0              0              2.9959237    
   1700000   2355           200            200            0.0047484518  -0.0016884416   0              0.015933797    2.3320821e-08  0              0.004504316    0              0              2.9959238    
   1800000   2355           200            200            0.0047484291  -0.0016884388   0              0.015933726    4.0314078e-09  0              0.00077864902  0              0              2.9959238    
   1900000   2355           200            200            0.0047484276  -0.0016884386   0              0.015933722    2.1152147e-10  0              4.0854458e-05  0              0              2.9959238    
   2000000   2355           200            200            0.0047484299  -0.0016884389   0              0.015933729    2.691662e-13   0              5.198829e-08   0              0              2.9959238    
   2100000   2355           200            200            0.0047484313  -0.0016884391   0              0.015933733    5.0694647e-12  0              9.7914522e-07  0              0              2.9959238    
   2200000   2355           200            200            0.0047484318  -0.0016884392   0              0.015933735    1.3852042e-12  0              2.6754622e-07  0              0              2.9959238    
   2300000   2355           200            200            0.0047484319  -0.0016884392   0              0.015933735    1.211164e-13   0              2.339311e-08   0              0              2.9959238    
   2400000   2355           200            200            0.0047484319  -0.0016884392   0              0.015933735    1.0976993e-15  0              2.1201589e-10  0              0              2.9959238    
   2500000   2355           200            200            0.0047484318  -0.0016884392   0              0.015933735    8.4232678e-16  0              1.6269178e-10  0              0              2.9959238    
   2600000   2355           200            200            0.0047484318  -0.0016884392   0              0.015933735    4.0591536e-16  0              7.8400799e-11  0              0              2.9959238    
   2700000   2355           200            200            0.0047484318  -0.0016884392   0              0.015933735    4.4593224e-17  0              8.6129889e-12  0              0              2.9959238    
   2800000   2355           200            200            0.0047484318  -0.0016884392   0              0.015933735    2.9758191e-19  0              5.7476663e-14  0              0              2.9959238    
   2900000   2355           200            200            0.0047484318  -0.0016884392   0              0.015933735    7.8404028e-22  0              1.51434e-16    0              0              2.9959238    
   3000000   2355           200            200            0.0047484318  -0.0016884392   0              0.015933735    1.7757032e-18  0              3.4296942e-13  0              0              2.9959238    
Loop time of 183.305 on 2 procs for 3000000 steps with 1251 atoms

Performance: 14140384.787 ns/day, 0.000 hours/ns, 16366.186 timesteps/s
99.9% CPU use with 2 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 42.679     | 42.966     | 43.254     |   4.4 | 23.44
Neigh   | 2.9894     | 2.9897     | 2.9899     |   0.0 |  1.63
Comm    | 13.751     | 13.903     | 14.056     |   4.1 |  7.58
Output  | 0.21142    | 0.21146    | 0.2115     |   0.0 |  0.12
Modify  | 109.91     | 109.98     | 110.06     |   0.7 | 60.00
Other   |            | 13.25      |            |       |  7.23

Nlocal:          625.5 ave         626 max         625 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Nghost:            2.5 ave           3 max           2 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Neighs:          377.5 ave         378 max         377 min
Histogram: 1 0 0 0 0 0 0 0 0 1

Total # of neighbors = 755
Ave neighs/atom = 0.60351719
Neighbor list builds = 164
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 15

#variable lat0 equal 1                    #
variable lat1 equal 3+(v_ind*0.01)        # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 250*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 3.15                                                               
Lattice spacing in x,y,z = 3.15 3.15 3.15

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -1181.25 ${n1e1} -100 100 -100 100 units box
region box block -1181.25 1181.25 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -1181.25 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -1181.25 1181.25 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-1181.25 -100 -100) to (1181.25 100 100)
  2 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 750 atoms
  using lattice units in orthogonal box = (-1181.25 -100 -100) to (1181.25 100 100)
  create_atoms CPU = 0.000 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -750 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -750 750 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 501 atoms
  using lattice units in orthogonal box = (-1181.25 -100 -100) to (1181.25 100 100)
  create_atoms CPU = 0.000 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  750 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  750 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  501 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  501 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
750 atoms in group substrate
group slider1 region slider1
501 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 501 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_15_*.dump id type diameter mass xu yu zu fx fy fz

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 1525 130 130
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 66.24 | 66.24 | 66.24 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   2362.5         200            200            0              0              0              0              0              0              0              0              0              6            
    100000   2362.5         200            200            0.004317735    4.2740417e-36  0              0.012953205    293854.07      0              5.6756645e+10  0              0              3.3250434    
    200000   2362.5         200            200            0.0015477162   5.3425511e-37  0              0.0046431485   72947.434      0              1.4089482e+10  0              0              3.071617     
    300000   2362.5         200            200            0.00013555573 -1.0685071e-36  0              0.00040666719  1132.9696      0              2.1882819e+08  0              0              3.0455773    
    400000   2362.5         200            200            0.020428582    0.001099927    0              0.060185819    2977.1872      0              5.7503086e+08  0              0              2.9919384    
    500000   2362.5         200            200            0.00093625341 -2.9918277e-35  0              0.0028087602   125.16051      0              24174213       0              0              2.9984114    
    600000   2362.5         200            200            0.0045512839   3.7273693e-05  0              0.013616578    108.18159      0              20894807       0              0              2.9957957    
    700000   2362.5         200            200            0.0051821081   0.00010884339  0              0.015437481    15.594531      0              3012016.3      0              0              2.9955438    
    800000   2362.5         200            200            0.0056588261   0.00010057077  0              0.016875908    0.27700993     0              53503.272      0              0              2.9953801    
    900000   2362.5         200            200            0.0054207909   9.7480728e-05  0              0.016164892    0.13458123     0              25993.783      0              0              2.9954632    
   1000000   2362.5         200            200            0.0053121784   9.6275942e-05  0              0.015840259    0.034810826    0              6723.5608      0              0              2.9955012    
   1100000   2362.5         200            200            0.0053085204   9.6240674e-05  0              0.015829321    0.00015148099  0              29.257899      0              0              2.9955023    
   1200000   2362.5         200            200            0.0053218839   9.6399253e-05  0              0.015869252    0.00044597886  0              86.138892      0              0              2.9954975    
   1300000   2362.5         200            200            0.0053268181   9.645614e-05   0              0.015883998    7.4972402e-05  0              14.480596      0              0              2.9954958    
   1400000   2362.5         200            200            0.0053266467   9.6453761e-05  0              0.015883486    2.6680642e-10  0              5.1532508e-05  0              0              2.9954959    
   1500000   2362.5         200            200            0.0053259237   9.6445307e-05  0              0.015881326    1.3537417e-06  0              0.26146937     0              0              2.9954961    
   1600000   2362.5         200            200            0.0053257074   9.6442827e-05  0              0.015880679    1.5022654e-07  0              0.029015607    0              0              2.9954962    
   1700000   2362.5         200            200            0.0053257334   9.6443148e-05  0              0.015880757    8.2338957e-10  0              0.00015903414  0              0              2.9954962    
   1800000   2362.5         200            200            0.0053257712   9.6443589e-05  0              0.01588087     3.8231282e-09  0              0.00073842071  0              0              2.9954962    
   1900000   2362.5         200            200            0.0053257802   9.6443692e-05  0              0.015880897    2.7576804e-10  0              5.3263406e-05  0              0              2.9954962    
   2000000   2362.5         200            200            0.0053257781   9.6443666e-05  0              0.015880891    8.1051546e-12  0              1.5654756e-06  0              0              2.9954962    
   2100000   2362.5         200            200            0.0053257762   9.6443644e-05  0              0.015880885    1.0145124e-11  0              1.9594868e-06  0              0              2.9954962    
   2200000   2362.5         200            200            0.0053257758   9.644364e-05   0              0.015880884    4.4935306e-13  0              8.6790605e-08  0              0              2.9954962    
   2300000   2362.5         200            200            0.0053257759   9.6443642e-05  0              0.015880884    4.3016998e-14  0              8.3085475e-09  0              0              2.9954962    
   2400000   2362.5         200            200            0.005325776    9.6443643e-05  0              0.015880884    2.5388873e-14  0              4.9037513e-09  0              0              2.9954962    
   2500000   2362.5         200            200            0.0053257761   9.6443643e-05  0              0.015880885    6.4903989e-16  0              1.2535925e-10  0              0              2.9954962    
   2600000   2362.5         200            200            0.005325776    9.6443643e-05  0              0.015880884    1.5369244e-16  0              2.9685031e-11  0              0              2.9954962    
   2700000   2362.5         200            200            0.005325776    9.6443643e-05  0              0.015880884    5.4952008e-17  0              1.0613743e-11  0              0              2.9954962    
   2800000   2362.5         200            200            0.005325776    9.6443643e-05  0              0.015880884    1.4041458e-19  0              2.712047e-14   0              0              2.9954962    
   2900000   2362.5         200            200            0.005325776    9.6443643e-05  0              0.015880884    1.9753132e-18  0              3.8152322e-13  0              0              2.9954962    
   3000000   2362.5         200            200            0.005325776    9.6443643e-05  0              0.015880884    1.3693188e-18  0              2.6447801e-13  0              0              2.9954962    
Loop time of 181.383 on 2 procs for 3000000 steps with 1251 atoms

Performance: 14290232.255 ns/day, 0.000 hours/ns, 16539.621 timesteps/s
99.9% CPU use with 2 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 42.532     | 42.681     | 42.83      |   2.3 | 23.53
Neigh   | 2.989      | 2.9896     | 2.9903     |   0.0 |  1.65
Comm    | 13.986     | 14.023     | 14.06      |   1.0 |  7.73
Output  | 0.21321    | 0.21323    | 0.21325    |   0.0 |  0.12
Modify  | 108.56     | 108.72     | 108.89     |   1.6 | 59.94
Other   |            | 12.75      |            |       |  7.03

Nlocal:          625.5 ave         626 max         625 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Nghost:            2.5 ave           3 max           2 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Neighs:          380.5 ave         381 max         380 min
Histogram: 1 0 0 0 0 0 0 0 0 1

Total # of neighbors = 761
Ave neighs/atom = 0.60831335
Neighbor list builds = 166
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 16

#variable lat0 equal 1                    #
variable lat1 equal 3+(v_ind*0.01)        # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 250*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 3.16                                                               
Lattice spacing in x,y,z = 3.16 3.16 3.16

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -1185 ${n1e1} -100 100 -100 100 units box
region box block -1185 1185 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -1185 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -1185 1185 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-1185 -100 -100) to (1185 100 100)
  2 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 750 atoms
  using lattice units in orthogonal box = (-1185 -100 -100) to (1185 100 100)
  create_atoms CPU = 0.000 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -750 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -750 750 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 501 atoms
  using lattice units in orthogonal box = (-1185 -100 -100) to (1185 100 100)
  create_atoms CPU = 0.000 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  750 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  750 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  501 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  501 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
750 atoms in group substrate
group slider1 region slider1
501 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 501 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_16_*.dump id type diameter mass xu yu zu fx fy fz

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 1530 130 130
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 66.38 | 66.38 | 66.38 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   2370           200            200            0              0              0              0              0              0              0              0              0              6            
    100000   2370           200            200            0.0043044094   2.6628224e-36  0              0.012913228    293883.59      0              5.6762346e+10  0              0              3.3250703    
    200000   2370           200            200            0.001542804    9.1992466e-43  0              0.004628412    72943.121      0              1.4088649e+10  0              0              3.0717555    
    300000   2370           200            200            0.00014220472 -5.2008235e-40  0              0.00042661415  1247.5192      0              2.4095294e+08  0              0              3.0454314    
    400000   2370           200            200            0.01898988     0.0042280346   0              0.052741606    3440.7336      0              6.6456286e+08  0              0              2.9924063    
    500000   2370           200            200            0.00057294513 -0.0005363285   0              0.0022551639   199.79446      0              38589438       0              0              2.998386     
    600000   2370           200            200            0.0043826647   4.8431511e-05  0              0.013099563    95.090687      0              18366356       0              0              2.9962067    
    700000   2370           200            200            0.0059131469   0.00073920838  0              0.017000232    12.079741      0              2333149.8      0              0              2.9956336    
    800000   2370           200            200            0.0051885108   0.00067969519  0              0.014885837    0.010325307    0              1994.2886      0              0              2.9959294    
    900000   2370           200            200            0.0055099278   0.00070731608  0              0.015822467    0.27201759     0              52539.023      0              0              2.9957981    
   1000000   2370           200            200            0.0055565706   0.00071117569  0              0.015958536    0.0017732742   0              342.50026      0              0              2.9957784    
   1100000   2370           200            200            0.0055196534   0.0007082775   0              0.015850683    0.0041855751   0              808.42577      0              0              2.9957932    
   1200000   2370           200            200            0.0055083506   0.0007073552   0              0.015817697    0.00021108567  0              40.770286      0              0              2.9957979    
   1300000   2370           200            200            0.0055117852   0.00070762467  0              0.015827731    4.5542941e-05  0              8.7964225      0              0              2.9957965    
   1400000   2370           200            200            0.0055137821   0.00070778617  0              0.01583356     8.3257793e-06  0              1.6080883      0              0              2.9957957    
   1500000   2370           200            200            0.0055135913   0.00070777192  0              0.015833002    2.6709569e-07  0              0.05158838     0              0              2.9957958    
   1600000   2370           200            200            0.0055132955   0.00070774816  0              0.015832138    2.1193863e-07  0              0.040935032    0              0              2.9957959    
   1700000   2370           200            200            0.0055132809   0.00070774684  0              0.015832096    4.6683321e-11  0              9.016682e-06   0              0              2.9957959    
   1800000   2370           200            200            0.0055133188   0.00070774987  0              0.015832207    3.9826639e-09  0              0.00076923435  0              0              2.9957959    
   1900000   2370           200            200            0.005513326    0.00070775046  0              0.015832227    5.9421858e-11  0              1.1477076e-05  0              0              2.9957959    
   2000000   2370           200            200            0.0055133218   0.00070775013  0              0.015832215    5.5780602e-11  0              1.0773783e-05  0              0              2.9957959    
   2100000   2370           200            200            0.0055133203   0.00070775001  0              0.015832211    4.2528144e-12  0              8.2141276e-07  0              0              2.9957959    
   2200000   2370           200            200            0.0055133206   0.00070775003  0              0.015832212    5.2733374e-13  0              1.0185224e-07  0              0              2.9957959    
   2300000   2370           200            200            0.0055133209   0.00070775005  0              0.015832213    1.4307593e-13  0              2.7634498e-08  0              0              2.9957959    
   2400000   2370           200            200            0.0055133209   0.00070775005  0              0.015832213    2.174036e-15   0              4.1990568e-10  0              0              2.9957959    
   2500000   2370           200            200            0.0055133208   0.00070775005  0              0.015832212    3.2815169e-15  0              6.3381083e-10  0              0              2.9957959    
   2600000   2370           200            200            0.0055133208   0.00070775005  0              0.015832212    1.7294517e-18  0              3.3403613e-13  0              0              2.9957959    
   2700000   2370           200            200            0.0055133208   0.00070775005  0              0.015832212    5.0620239e-17  0              9.7770807e-12  0              0              2.9957959    
   2800000   2370           200            200            0.0055133208   0.00070775005  0              0.015832212    2.3955231e-18  0              4.6268494e-13  0              0              2.9957959    
   2900000   2370           200            200            0.0055133208   0.00070775005  0              0.015832212    7.2028034e-19  0              1.3911904e-13  0              0              2.9957959    
   3000000   2370           200            200            0.0055133208   0.00070775005  0              0.015832212    1.3796118e-19  0              2.6646606e-14  0              0              2.9957959    
Loop time of 179.541 on 2 procs for 3000000 steps with 1251 atoms

Performance: 14436814.816 ns/day, 0.000 hours/ns, 16709.276 timesteps/s
99.9% CPU use with 2 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 40.656     | 40.706     | 40.756     |   0.8 | 22.67
Neigh   | 2.9836     | 2.9842     | 2.9848     |   0.0 |  1.66
Comm    | 13.222     | 13.281     | 13.339     |   1.6 |  7.40
Output  | 0.21175    | 0.21178    | 0.21182    |   0.0 |  0.12
Modify  | 109.63     | 109.63     | 109.63     |   0.0 | 61.06
Other   |            | 12.73      |            |       |  7.09

Nlocal:          625.5 ave         626 max         625 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Nghost:            2.5 ave           3 max           2 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Neighs:          371.5 ave         372 max         371 min
Histogram: 1 0 0 0 0 0 0 0 0 1

Total # of neighbors = 743
Ave neighs/atom = 0.59392486
Neighbor list builds = 164
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 17

#variable lat0 equal 1                    #
variable lat1 equal 3+(v_ind*0.01)        # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 250*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 3.17                                                               
Lattice spacing in x,y,z = 3.17 3.17 3.17

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -1188.75 ${n1e1} -100 100 -100 100 units box
region box block -1188.75 1188.75 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -1188.75 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -1188.75 1188.75 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-1188.75 -100 -100) to (1188.75 100 100)
  2 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 750 atoms
  using lattice units in orthogonal box = (-1188.75 -100 -100) to (1188.75 100 100)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -750 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -750 750 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 501 atoms
  using lattice units in orthogonal box = (-1188.75 -100 -100) to (1188.75 100 100)
  create_atoms CPU = 0.000 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  750 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  750 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  501 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  501 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
750 atoms in group substrate
group slider1 region slider1
501 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 501 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_17_*.dump id type diameter mass xu yu zu fx fy fz

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 1534 130 130
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 66.52 | 66.52 | 66.52 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   2377.5         200            200            0              0              0              0              0              0              0              0              0              6            
    100000   2377.5         200            200            0.004291786    4.2470788e-36  0              0.012875358    293981.76      0              5.6781308e+10  0              0              3.324913     
    200000   2377.5         200            200            0.0015401267   1.0617689e-36  0              0.00462038     73105.338      0              1.4119981e+10  0              0              3.0714906    
    300000   2377.5         200            200            0.00014536821 -8.4940129e-36  0              0.00043610463  1308.0207      0              2.5263855e+08  0              0              3.045392     
    400000   2377.5         200            200            0.019358037    0.00053375633  0              0.057540354    3015.302       0              5.8239258e+08  0              0              2.9921149    
    500000   2377.5         200            200            0.00046011339  0.00016136571  0              0.0012189745   40.584222      0              7838667.4      0              0              2.9987912    
    600000   2377.5         200            200            0.0077831198   0.00027002626  0              0.023079333    19.158927      0              3700464.1      0              0              2.9949993    
    700000   2377.5         200            200            0.0057624358   0.00028855855  0              0.016998749    12.598415      0              2433329.5      0              0              2.9957043    
    800000   2377.5         200            200            0.0053566538   0.00014986671  0              0.015920095    2.0463003      0              395234.08      0              0              2.9958387    
    900000   2377.5         200            200            0.0052967362   0.00016790889  0              0.0157223      0.2723734      0              52607.746      0              0              2.995863     
   1000000   2377.5         200            200            0.0052967939   0.00016793417  0              0.015722447    0.030191712    0              5831.3989      0              0              2.9958625    
   1100000   2377.5         200            200            0.0053055061   0.00016809841  0              0.01574842     0.0026706577   0              515.82602      0              0              2.9958589    
   1200000   2377.5         200            200            0.0053116292   0.00016820838  0              0.015766679    0.00016535503  0              31.937611      0              0              2.9958565    
   1300000   2377.5         200            200            0.0053147591   0.0001682633   0              0.015776014    4.2406788e-06  0              0.81906881     0              0              2.9958553    
   1400000   2377.5         200            200            0.0053161326   0.0001682871   0              0.015780111    8.3573379e-08  0              0.016141837    0              0              2.9958547    
   1500000   2377.5         200            200            0.0053166754   0.00016829643  0              0.01578173     2.3163395e-07  0              0.044739098    0              0              2.9958545    
   1600000   2377.5         200            200            0.0053168714   0.00016829978  0              0.015782314    8.9551306e-08  0              0.017296448    0              0              2.9958545    
   1700000   2377.5         200            200            0.0053169359   0.00016830088  0              0.015782507    2.112676e-08   0              0.0040805425   0              0              2.9958544    
   1800000   2377.5         200            200            0.0053169548   0.0001683012   0              0.015782563    3.8137489e-09  0              0.00073660914  0              0              2.9958544    
   1900000   2377.5         200            200            0.0053169593   0.00016830127  0              0.015782577    5.6548222e-10  0              0.00010922045  0              0              2.9958544    
   2000000   2377.5         200            200            0.00531696     0.00016830128  0              0.015782579    7.0148638e-11  0              1.3548907e-05  0              0              2.9958544    
   2100000   2377.5         200            200            0.0053169598   0.00016830128  0              0.015782578    7.1611411e-12  0              1.3831435e-06  0              0              2.9958544    
   2200000   2377.5         200            200            0.0053169596   0.00016830127  0              0.015782578    5.6173311e-13  0              1.0849633e-07  0              0              2.9958544    
   2300000   2377.5         200            200            0.0053169595   0.00016830127  0              0.015782577    2.7370947e-14  0              5.2865803e-09  0              0              2.9958544    
   2400000   2377.5         200            200            0.0053169594   0.00016830127  0              0.015782577    2.2148149e-16  0              4.2778195e-11  0              0              2.9958544    
   2500000   2377.5         200            200            0.0053169594   0.00016830127  0              0.015782577    1.6063486e-16  0              3.1025931e-11  0              0              2.9958544    
   2600000   2377.5         200            200            0.0053169594   0.00016830127  0              0.015782577    1.0851367e-16  0              2.0958947e-11  0              0              2.9958544    
   2700000   2377.5         200            200            0.0053169594   0.00016830127  0              0.015782577    4.235707e-17   0              8.1810853e-12  0              0              2.9958544    
   2800000   2377.5         200            200            0.0053169594   0.00016830127  0              0.015782577    7.5476865e-18  0              1.4578031e-12  0              0              2.9958544    
   2900000   2377.5         200            200            0.0053169594   0.00016830127  0              0.015782577    3.0030888e-18  0              5.8003363e-13  0              0              2.9958544    
   3000000   2377.5         200            200            0.0053169594   0.00016830127  0              0.015782577    3.2935906e-18  0              6.3614281e-13  0              0              2.9958544    
Loop time of 179.448 on 2 procs for 3000000 steps with 1251 atoms

Performance: 14444299.181 ns/day, 0.000 hours/ns, 16717.939 timesteps/s
99.9% CPU use with 2 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 41.489     | 41.5       | 41.51      |   0.2 | 23.13
Neigh   | 2.9727     | 2.9733     | 2.9739     |   0.0 |  1.66
Comm    | 13.283     | 13.372     | 13.461     |   2.4 |  7.45
Output  | 0.21643    | 0.21647    | 0.2165     |   0.0 |  0.12
Modify  | 108.65     | 108.65     | 108.65     |   0.0 | 60.55
Other   |            | 12.74      |            |       |  7.10

Nlocal:          625.5 ave         626 max         625 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Nghost:            2.5 ave           3 max           2 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Neighs:          375.5 ave         376 max         375 min
Histogram: 1 0 0 0 0 0 0 0 0 1

Total # of neighbors = 751
Ave neighs/atom = 0.60031974
Neighbor list builds = 164
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 18

#variable lat0 equal 1                    #
variable lat1 equal 3+(v_ind*0.01)        # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 250*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 3.18                                                               
Lattice spacing in x,y,z = 3.18 3.18 3.18

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -1192.5 ${n1e1} -100 100 -100 100 units box
region box block -1192.5 1192.5 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -1192.5 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -1192.5 1192.5 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-1192.5 -100 -100) to (1192.5 100 100)
  2 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 750 atoms
  using lattice units in orthogonal box = (-1192.5 -100 -100) to (1192.5 100 100)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -750 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -750 750 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 501 atoms
  using lattice units in orthogonal box = (-1192.5 -100 -100) to (1192.5 100 100)
  create_atoms CPU = 0.000 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  750 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  750 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  501 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  501 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
750 atoms in group substrate
group slider1 region slider1
501 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 501 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_18_*.dump id type diameter mass xu yu zu fx fy fz

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 1539 130 130
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 66.73 | 66.73 | 66.73 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   2385           200            200            0              0              0              0              0              0              0              0              0              6            
    100000   2385           200            200            0.0042790926   2.1168616e-36  0              0.012837278    294064.34      0              5.6797257e+10  0              0              3.3247835    
    200000   2385           200            200            0.0015373087   5.292152e-37   0              0.0046119262   73256.244      0              1.4149127e+10  0              0              3.0712324    
    300000   2385           200            200            0.00014782898 -6.6151854e-38  0              0.00044348693  1357.9707      0              2.6228617e+08  0              0              3.0453645    
    400000   2385           200            200            0.022100759    0.0030858959   0              0.063216382    2502.8898      0              4.8342237e+08  0              0              2.9917908    
    500000   2385           200            200            0.00032288522 -0.00010974995  0              0.0010784056   0.04435193     0              8566.384       0              0              2.9989108    
    600000   2385           200            200            0.0079251866   0.00041566768  0              0.023359892    6.6907097      0              1292281.7      0              0              2.9949823    
    700000   2385           200            200            0.0061413357  -5.9875377e-05  0              0.018483883    0.4861154      0              93891.092      0              0              2.9955561    
    800000   2385           200            200            0.0055418194  -8.0164391e-05  0              0.016705623    0.17159066     0              33141.995      0              0              2.9957769    
    900000   2385           200            200            0.0053312223  -8.6212073e-05  0              0.016079879    0.036340455    0              7019.002       0              0              2.9958564    
   1000000   2385           200            200            0.0052560028  -8.8572318e-05  0              0.015856581    0.0068913066   0              1331.0261      0              0              2.9958851    
   1100000   2385           200            200            0.0052291481  -8.9440927e-05  0              0.015776885    0.0012312942   0              237.81917      0              0              2.9958953    
   1200000   2385           200            200            0.005219604   -8.975267e-05   0              0.015748565    0.00021065502  0              40.687108      0              0              2.995899     
   1300000   2385           200            200            0.0052162325  -8.9863064e-05  0              0.015738561    3.4825632e-05  0              6.7264205      0              0              2.9959002    
   1400000   2385           200            200            0.0052150497  -8.9901782e-05  0              0.015735051    5.5981343e-06  0              1.0812555      0              0              2.9959007    
   1500000   2385           200            200            0.005214638   -8.9915243e-05  0              0.015733829    8.7891049e-07  0              0.16975777     0              0              2.9959008    
   1600000   2385           200            200            0.0052144958  -8.991988e-05   0              0.015733407    1.3521866e-07  0              0.026116901    0              0              2.9959009    
   1700000   2385           200            200            0.0052144472  -8.9921461e-05  0              0.015733263    2.0436091e-08  0              0.0039471428   0              0              2.9959009    
   1800000   2385           200            200            0.0052144308  -8.9921994e-05  0              0.015733214    3.0398347e-09  0              0.00058713096  0              0              2.9959009    
   1900000   2385           200            200            0.0052144253  -8.9922172e-05  0              0.015733198    4.4569301e-10  0              8.6083681e-05  0              0              2.9959009    
   2000000   2385           200            200            0.0052144235  -8.9922229e-05  0              0.015733193    6.4482593e-11  0              1.2454535e-05  0              0              2.9959009    
   2100000   2385           200            200            0.005214423   -8.9922248e-05  0              0.015733191    9.2145439e-12  0              1.7797494e-06  0              0              2.9959009    
   2200000   2385           200            200            0.0052144228  -8.9922254e-05  0              0.015733191    1.3013834e-12  0              2.5135659e-07  0              0              2.9959009    
   2300000   2385           200            200            0.0052144227  -8.9922255e-05  0              0.01573319     1.8173864e-13  0              3.5102034e-08  0              0              2.9959009    
   2400000   2385           200            200            0.0052144227  -8.9922256e-05  0              0.01573319     2.5114806e-14  0              4.8508163e-09  0              0              2.9959009    
   2500000   2385           200            200            0.0052144227  -8.9922256e-05  0              0.01573319     3.4292736e-15  0              6.623494e-10   0              0              2.9959009    
   2600000   2385           200            200            0.0052144227  -8.9922256e-05  0              0.01573319     4.6628321e-16  0              9.006059e-11   0              0              2.9959009    
   2700000   2385           200            200            0.0052144227  -8.9922256e-05  0              0.01573319     5.7265721e-17  0              1.1060627e-11  0              0              2.9959009    
   2800000   2385           200            200            0.0052144227  -8.9922256e-05  0              0.01573319     6.4040079e-18  0              1.2369065e-12  0              0              2.9959009    
   2900000   2385           200            200            0.0052144227  -8.9922256e-05  0              0.01573319     3.8284543e-18  0              7.3944944e-13  0              0              2.9959009    
   3000000   2385           200            200            0.0052144227  -8.9922257e-05  0              0.01573319     1.6265038e-18  0              3.1415219e-13  0              0              2.9959009    
Loop time of 178.922 on 2 procs for 3000000 steps with 1251 atoms

Performance: 14486752.049 ns/day, 0.000 hours/ns, 16767.074 timesteps/s
99.9% CPU use with 2 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 41.471     | 41.551     | 41.632     |   1.2 | 23.22
Neigh   | 2.7929     | 2.7929     | 2.7929     |   0.0 |  1.56
Comm    | 13.098     | 13.129     | 13.161     |   0.9 |  7.34
Output  | 0.21311    | 0.21314    | 0.21318    |   0.0 |  0.12
Modify  | 108.48     | 108.5      | 108.51     |   0.1 | 60.64
Other   |            | 12.74      |            |       |  7.12

Nlocal:          625.5 ave         626 max         625 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Nghost:            2.5 ave           3 max           2 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Neighs:          379.5 ave         380 max         379 min
Histogram: 1 0 0 0 0 0 0 0 0 1

Total # of neighbors = 759
Ave neighs/atom = 0.60671463
Neighbor list builds = 166
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 19

#variable lat0 equal 1                    #
variable lat1 equal 3+(v_ind*0.01)        # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 250*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 3.19                                                               
Lattice spacing in x,y,z = 3.19 3.19 3.19

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -1196.25 ${n1e1} -100 100 -100 100 units box
region box block -1196.25 1196.25 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -1196.25 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -1196.25 1196.25 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-1196.25 -100 -100) to (1196.25 100 100)
  2 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 750 atoms
  using lattice units in orthogonal box = (-1196.25 -100 -100) to (1196.25 100 100)
  create_atoms CPU = 0.000 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -750 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -750 750 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 501 atoms
  using lattice units in orthogonal box = (-1196.25 -100 -100) to (1196.25 100 100)
  create_atoms CPU = 0.000 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  750 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  750 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  501 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  501 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
750 atoms in group substrate
group slider1 region slider1
501 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 501 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_19_*.dump id type diameter mass xu yu zu fx fy fz

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 1544 130 130
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 66.87 | 66.87 | 66.87 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   2392.5         200            200            0              0              0              0              0              0              0              0              0              6            
    100000   2392.5         200            200            0.0042630813   9.3134351e-43  0              0.012789244    293800.1       0              5.6746221e+10  0              0              3.3251435    
    200000   2392.5         200            200            0.001525988   -2.6377787e-37  0              0.0045779641   72772.268      0              1.405565e+10   0              0              3.0719934    
    300000   2392.5         200            200            0.0001365532   2.6377798e-36  0              0.0004096596   1176.5031      0              2.272365e+08   0              0              3.0454522    
    400000   2392.5         200            200            0.01586592     0.0050563101   0              0.042541451    4156.6858      0              8.0284592e+08  0              0              2.9930762    
    500000   2392.5         200            200            0.0013666438  -0.0010390223   0              0.0051389537   508.10325      0              98137951       0              0              2.9975298    
    600000   2392.5         200            200            0.0027047115  -0.00095962167  0              0.0090737561   1.0863022      0              209814.59      0              0              2.9967836    
    700000   2392.5         200            200            0.0060407529  -0.00017850843  0              0.018300767    0.99838809     0              192834.35      0              0              2.9954234    
    800000   2392.5         200            200            0.0048366822  -0.00039829696  0              0.014908344    0.70245559     0              135676.27      0              0              2.9958748    
    900000   2392.5         200            200            0.0051688378  -0.00038037075  0              0.015886884    0.1836077      0              35463.035      0              0              2.9957387    
   1000000   2392.5         200            200            0.005085058   -0.00038577523  0              0.015640949    0.03315421     0              6403.5926      0              0              2.995773     
   1100000   2392.5         200            200            0.0051001807  -0.0003847466   0              0.015685289    0.0050126459   0              968.17092      0              0              2.9957665    
   1200000   2392.5         200            200            0.0051008724  -0.000384726    0              0.015687343    0.00064339827  0              124.2696       0              0              2.9957664    
   1300000   2392.5         200            200            0.0050983511  -0.00038487835  0              0.015679932    6.9525545e-05  0              13.428559      0              0              2.9957674    
   1400000   2392.5         200            200            0.0051000384  -0.00038477351  0              0.015684889    6.0470313e-06  0              1.167958       0              0              2.9957667    
   1500000   2392.5         200            200            0.0050991883  -0.00038482689  0              0.015682392    3.7118627e-07  0              0.071693026    0              0              2.995767     
   1600000   2392.5         200            200            0.0050995604  -0.00038480337  0              0.015683484    9.5779548e-09  0              0.0018499406   0              0              2.9957669    
   1700000   2392.5         200            200            0.0050994126  -0.00038481276  0              0.015683051    1.7456657e-10  0              3.3716779e-05  0              0              2.995767     
   1800000   2392.5         200            200            0.0050994666  -0.00038480931  0              0.015683209    5.0804743e-10  0              9.8127168e-05  0              0              2.9957669    
   1900000   2392.5         200            200            0.0050994485  -0.00038481048  0              0.015683156    1.994243e-10   0              3.8517942e-05  0              0              2.9957669    
   2000000   2392.5         200            200            0.005099454   -0.00038481012  0              0.015683172    4.7912347e-11  0              9.2540631e-06  0              0              2.9957669    
   2100000   2392.5         200            200            0.0050994525  -0.00038481021  0              0.015683168    8.8659248e-12  0              1.7124151e-06  0              0              2.9957669    
   2200000   2392.5         200            200            0.0050994528  -0.0003848102   0              0.015683169    1.3609302e-12  0              2.6285779e-07  0              0              2.9957669    
   2300000   2392.5         200            200            0.0050994528  -0.0003848102   0              0.015683169    1.7738091e-13  0              3.4260357e-08  0              0              2.9957669    
   2400000   2392.5         200            200            0.0050994528  -0.0003848102   0              0.015683169    1.949153e-14   0              3.7647049e-09  0              0              2.9957669    
   2500000   2392.5         200            200            0.0050994528  -0.0003848102   0              0.015683169    1.7342657e-15  0              3.3496593e-10  0              0              2.9957669    
   2600000   2392.5         200            200            0.0050994528  -0.0003848102   0              0.015683169    1.163572e-16   0              2.2473892e-11  0              0              2.9957669    
   2700000   2392.5         200            200            0.0050994528  -0.0003848102   0              0.015683169    1.0901513e-17  0              2.1055801e-12  0              0              2.9957669    
   2800000   2392.5         200            200            0.0050994528  -0.0003848102   0              0.015683169    3.1698611e-19  0              6.1224499e-14  0              0              2.9957669    
   2900000   2392.5         200            200            0.0050994528  -0.0003848102   0              0.015683169    7.0227575e-19  0              1.3564153e-13  0              0              2.9957669    
   3000000   2392.5         200            200            0.0050994528  -0.0003848102   0              0.015683169    2.2968384e-18  0              4.4362442e-13  0              0              2.9957669    
Loop time of 179.233 on 2 procs for 3000000 steps with 1251 atoms

Performance: 14461654.335 ns/day, 0.000 hours/ns, 16738.026 timesteps/s
99.9% CPU use with 2 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 41.189     | 41.329     | 41.469     |   2.2 | 23.06
Neigh   | 3.0113     | 3.012      | 3.0127     |   0.0 |  1.68
Comm    | 13.274     | 13.292     | 13.309     |   0.5 |  7.42
Output  | 0.21366    | 0.21369    | 0.21372    |   0.0 |  0.12
Modify  | 108.63     | 108.64     | 108.65     |   0.1 | 60.61
Other   |            | 12.75      |            |       |  7.11

Nlocal:          625.5 ave         626 max         625 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Nghost:            2.5 ave           3 max           2 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Neighs:          373.5 ave         374 max         373 min
Histogram: 1 0 0 0 0 0 0 0 0 1

Total # of neighbors = 747
Ave neighs/atom = 0.5971223
Neighbor list builds = 164
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 20

#variable lat0 equal 1                    #
variable lat1 equal 3+(v_ind*0.01)        # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 250*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 3.2                                                               
Lattice spacing in x,y,z = 3.2 3.2 3.2

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -1200 ${n1e1} -100 100 -100 100 units box
region box block -1200 1200 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -1200 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -1200 1200 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-1200 -100 -100) to (1200 100 100)
  2 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 750 atoms
  using lattice units in orthogonal box = (-1200 -100 -100) to (1200 100 100)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -750 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -750 750 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 501 atoms
  using lattice units in orthogonal box = (-1200 -100 -100) to (1200 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  750 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  750 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  501 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  501 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
750 atoms in group substrate
group slider1 region slider1
501 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 501 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_20_*.dump id type diameter mass xu yu zu fx fy fz

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 1549 130 130
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 67.08 | 67.08 | 67.08 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   2400           200            200            0              0              0              0              0              0              0              0              0              6            
    100000   2400           200            200            0.0042505123  -5.2590674e-37  0              0.012751537    293879.84      0              5.6761623e+10  0              0              3.3249923    
    200000   2400           200            200            0.0015204496  -1.5777215e-36  0              0.0045613489   72709.458      0              1.4043518e+10  0              0              3.0723112    
    300000   2400           200            200            0.00014863515 -1.0518111e-36  0              0.00044590545  1388.3815      0              2.681599e+08   0              0              3.0450782    
    400000   2400           200            200            0.011894943    1.4277078e-05  0              0.035670552    4148.2316      0              8.0121303e+08  0              0              2.9931678    
    500000   2400           200            200            0.00076177654  7.8886091e-37  0              0.0022853296   66.084031      0              12763845       0              0              2.9989154    
    600000   2400           200            200            0.0059979301   3.2611496e-44  0              0.01799379     89.132507      0              17215559       0              0              2.995604     
    700000   2400           200            200            0.0052852573   2.6295364e-37  0              0.015855772    13.811107      0              2667555.7      0              0              2.9959369    
    800000   2400           200            200            0.0050695567  -1.8406754e-36  0              0.01520867     1.3688053      0              264378.84      0              0              2.9960573    
    900000   2400           200            200            0.0052941959   2.6295364e-37  0              0.015882588    0.08525778     0              16467.172      0              0              2.9959388    
   1000000   2400           200            200            0.0051753562   6.3973319e-47  0              0.015526069    0.0014796723   0              285.79233      0              0              2.9960004    
   1100000   2400           200            200            0.0052252368   9.4667749e-48  0              0.01567571     0.00017886381  0              34.546772      0              0              2.9959747    
   1200000   2400           200            200            0.0052075825  -5.2590727e-37  0              0.015622748    0.00020242013  0              39.096574      0              0              2.9959837    
   1300000   2400           200            200            0.0052127605   7.1977503e-47  0              0.015638282    6.0890362e-05  0              11.760711      0              0              2.9959811    
   1400000   2400           200            200            0.0052116481   3.2256875e-48  0              0.015634944    1.1205416e-05  0              2.1642778      0              0              2.9959817    
   1500000   2400           200            200            0.0052116998  -5.2590727e-37  0              0.015635099    1.4556214e-06  0              0.28114699     0              0              2.9959816    
   1600000   2400           200            200            0.0052118152   2.4025045e-48  0              0.015635446    1.3144711e-07  0              0.025388442    0              0              2.9959816    
   1700000   2400           200            200            0.0052117303  -2.6295364e-37  0              0.015635191    6.6997492e-09  0              0.0012940276   0              0              2.9959816    
   1800000   2400           200            200            0.005211772    1.0518145e-36  0              0.015635316    3.9645259e-11  0              7.6573107e-06  0              0              2.9959816    
   1900000   2400           200            200            0.0052117553   2.6295364e-37  0              0.015635266    4.6321828e-11  0              8.9468612e-06  0              0              2.9959816    
   2000000   2400           200            200            0.005211761   -5.2590727e-37  0              0.015635283    2.967072e-11   0              5.7307715e-06  0              0              2.9959816    
   2100000   2400           200            200            0.0052117594   5.2590727e-37  0              0.015635278    7.6127983e-12  0              1.4703791e-06  0              0              2.9959816    
   2200000   2400           200            200            0.0052117597  -1.3147682e-36  0              0.015635279    1.2709719e-12  0              2.4548275e-07  0              0              2.9959816    
   2300000   2400           200            200            0.0052117597  -2.6295364e-37  0              0.015635279    1.5116197e-13  0              2.9196283e-08  0              0              2.9959816    
   2400000   2400           200            200            0.0052117597   8.1038076e-48  0              0.015635279    1.2224617e-14  0              2.3611321e-09  0              0              2.9959816    
   2500000   2400           200            200            0.0052117597  -2.6295364e-37  0              0.015635279    4.6344227e-16  0              8.9511874e-11  0              0              2.9959816    
   2600000   2400           200            200            0.0052117597  -2.6295364e-37  0              0.015635279    3.9183141e-19  0              7.5680546e-14  0              0              2.9959816    
   2700000   2400           200            200            0.0052117597  -5.2590727e-37  0              0.015635279    1.3219463e-17  0              2.5532823e-12  0              0              2.9959816    
   2800000   2400           200            200            0.0052117597   7.8886091e-37  0              0.015635279    4.9366541e-18  0              9.5349343e-13  0              0              2.9959816    
   2900000   2400           200            200            0.0052117597  -2.6295363e-37  0              0.015635279    2.7787336e-18  0              5.367004e-13   0              0              2.9959816    
   3000000   2400           200            200            0.0052117597  -1.3147681e-36  0              0.015635279    3.4295585e-18  0              6.6240442e-13  0              0              2.9959816    
Loop time of 177.719 on 2 procs for 3000000 steps with 1251 atoms

Performance: 14584797.367 ns/day, 0.000 hours/ns, 16880.553 timesteps/s
99.9% CPU use with 2 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 38.938     | 39.062     | 39.186     |   2.0 | 21.98
Neigh   | 3.0542     | 3.0542     | 3.0542     |   0.0 |  1.72
Comm    | 13.976     | 14.03      | 14.083     |   1.4 |  7.89
Output  | 0.21099    | 0.21101    | 0.21103    |   0.0 |  0.12
Modify  | 108.43     | 108.62     | 108.81     |   1.8 | 61.12
Other   |            | 12.75      |            |       |  7.17

Nlocal:          625.5 ave         626 max         625 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Nghost:            2.5 ave           3 max           2 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Neighs:          358.5 ave         359 max         358 min
Histogram: 1 0 0 0 0 0 0 0 0 1

Total # of neighbors = 717
Ave neighs/atom = 0.57314149
Neighbor list builds = 166
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 21

#variable lat0 equal 1                    #
variable lat1 equal 3+(v_ind*0.01)        # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 250*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 3.21                                                               
Lattice spacing in x,y,z = 3.21 3.21 3.21

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -1203.75 ${n1e1} -100 100 -100 100 units box
region box block -1203.75 1203.75 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -1203.75 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -1203.75 1203.75 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-1203.75 -100 -100) to (1203.75 100 100)
  2 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 750 atoms
  using lattice units in orthogonal box = (-1203.75 -100 -100) to (1203.75 100 100)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -750 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -750 750 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 501 atoms
  using lattice units in orthogonal box = (-1203.75 -100 -100) to (1203.75 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  750 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  750 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  501 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  501 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
750 atoms in group substrate
group slider1 region slider1
501 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 501 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_21_*.dump id type diameter mass xu yu zu fx fy fz

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 1554 130 130
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 67.21 | 67.21 | 67.21 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   2407.5         200            200            0              0              0              0              0              0              0              0              0              6            
    100000   2407.5         200            200            0.0042376954   1.048541e-36   0              0.012713086    293918.23      0              5.6769037e+10  0              0              3.3250148    
    200000   2407.5         200            200            0.0015195473   2.5910653e-43  0              0.0045586419   73001.298      0              1.4099886e+10  0              0              3.0716571    
    300000   2407.5         200            200            0.00014087951  4.3037412e-44  0              0.00042263852  1262.4851      0              2.4384354e+08  0              0              3.0454322    
    400000   2407.5         200            200            0.01882983     0.0015489195   0              0.054940572    3186.317       0              6.1542337e+08  0              0              2.9922161    
    500000   2407.5         200            200            0.00036334377 -0.00020402075  0              0.001294052    50.563019      0              9766028.8      0              0              2.9987349    
    600000   2407.5         200            200            0.0072971763  -0.00015305121  0              0.02204458     37.425047      0              7228486.3      0              0              2.9950475    
    700000   2407.5         200            200            0.0054160933  -7.0460675e-05  0              0.01631874     14.463463      0              2793555.5      0              0              2.9957265    
    800000   2407.5         200            200            0.005273654   -8.8300453e-05  0              0.015909262    1.8768954      0              362514.25      0              0              2.9957756    
    900000   2407.5         200            200            0.005225105   -7.7604907e-05  0              0.01575292     0.22411633     0              43287.103      0              0              2.9957946    
   1000000   2407.5         200            200            0.00519565    -7.7715244e-05  0              0.015664665    0.025142248    0              4856.1166      0              0              2.9958056    
   1100000   2407.5         200            200            0.0051809006  -7.7780706e-05  0              0.015620482    0.0026253334   0              507.07181      0              0              2.9958112    
   1200000   2407.5         200            200            0.0051741627  -7.7813052e-05  0              0.015600301    0.00024996042  0              48.278777      0              0              2.9958138    
   1300000   2407.5         200            200            0.0051712614  -7.7827491e-05  0              0.015591612    2.0849268e-05  0              4.0269462      0              0              2.9958149    
   1400000   2407.5         200            200            0.005170064   -7.7833553e-05  0              0.015588026    1.3969908e-06  0              0.26982274     0              0              2.9958154    
   1500000   2407.5         200            200            0.005169586   -7.7835994e-05  0              0.015586594    5.8553737e-08  0              0.011309402    0              0              2.9958155    
   1600000   2407.5         200            200            0.0051694005  -7.7836946e-05  0              0.015586039    2.6143687e-10  0              5.0495404e-05  0              0              2.9958156    
   1700000   2407.5         200            200            0.0051693303  -7.7837308e-05  0              0.015585828    4.38036e-10    0              8.4604763e-05  0              0              2.9958156    
   1800000   2407.5         200            200            0.0051693044  -7.7837442e-05  0              0.015585751    3.0225191e-10  0              5.8378653e-05  0              0              2.9958157    
   1900000   2407.5         200            200            0.005169295   -7.783749e-05   0              0.015585723    9.6077098e-11  0              1.8556877e-05  0              0              2.9958157    
   2000000   2407.5         200            200            0.0051692917  -7.7837507e-05  0              0.015585713    2.2774168e-11  0              4.3987323e-06  0              0              2.9958157    
   2100000   2407.5         200            200            0.0051692906  -7.7837513e-05  0              0.015585709    4.5906174e-12  0              8.8665795e-07  0              0              2.9958157    
   2200000   2407.5         200            200            0.0051692902  -7.7837515e-05  0              0.015585708    8.320169e-13   0              1.6070047e-07  0              0              2.9958157    
   2300000   2407.5         200            200            0.0051692901  -7.7837516e-05  0              0.015585708    1.3925526e-13  0              2.6896552e-08  0              0              2.9958157    
   2400000   2407.5         200            200            0.0051692901  -7.7837516e-05  0              0.015585708    2.1884181e-14  0              4.2268351e-09  0              0              2.9958157    
   2500000   2407.5         200            200            0.00516929    -7.7837516e-05  0              0.015585708    3.2582172e-15  0              6.2931059e-10  0              0              2.9958157    
   2600000   2407.5         200            200            0.00516929    -7.7837516e-05  0              0.015585708    4.6318609e-16  0              8.9462395e-11  0              0              2.9958157    
   2700000   2407.5         200            200            0.00516929    -7.7837516e-05  0              0.015585708    6.0761711e-17  0              1.1735862e-11  0              0              2.9958157    
   2800000   2407.5         200            200            0.00516929    -7.7837516e-05  0              0.015585708    7.9680365e-18  0              1.5389919e-12  0              0              2.9958157    
   2900000   2407.5         200            200            0.00516929    -7.7837516e-05  0              0.015585708    1.783212e-18   0              3.444197e-13   0              0              2.9958157    
   3000000   2407.5         200            200            0.00516929    -7.7837516e-05  0              0.015585708    9.9067707e-21  0              1.91345e-15    0              0              2.9958157    
Loop time of 180.979 on 2 procs for 3000000 steps with 1251 atoms

Performance: 14322104.339 ns/day, 0.000 hours/ns, 16576.510 timesteps/s
99.9% CPU use with 2 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 41.845     | 41.922     | 41.998     |   1.2 | 23.16
Neigh   | 3.044      | 3.0446     | 3.0451     |   0.0 |  1.68
Comm    | 13.369     | 13.403     | 13.436     |   0.9 |  7.41
Output  | 0.21249    | 0.21253    | 0.21256    |   0.0 |  0.12
Modify  | 109.57     | 109.62     | 109.66     |   0.4 | 60.57
Other   |            | 12.78      |            |       |  7.06

Nlocal:          625.5 ave         626 max         625 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Nghost:            2.5 ave           3 max           2 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Neighs:          375.5 ave         376 max         375 min
Histogram: 1 0 0 0 0 0 0 0 0 1

Total # of neighbors = 751
Ave neighs/atom = 0.60031974
Neighbor list builds = 164
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 22

#variable lat0 equal 1                    #
variable lat1 equal 3+(v_ind*0.01)        # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 250*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 3.22                                                               
Lattice spacing in x,y,z = 3.22 3.22 3.22

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -1207.5 ${n1e1} -100 100 -100 100 units box
region box block -1207.5 1207.5 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -1207.5 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -1207.5 1207.5 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-1207.5 -100 -100) to (1207.5 100 100)
  2 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 750 atoms
  using lattice units in orthogonal box = (-1207.5 -100 -100) to (1207.5 100 100)
  create_atoms CPU = 0.000 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -750 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -750 750 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 501 atoms
  using lattice units in orthogonal box = (-1207.5 -100 -100) to (1207.5 100 100)
  create_atoms CPU = 0.000 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  750 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  750 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  501 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  501 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
750 atoms in group substrate
group slider1 region slider1
501 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 501 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_22_*.dump id type diameter mass xu yu zu fx fy fz

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 1559 130 130
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 67.42 | 67.42 | 67.42 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   2415           200            200            0              0              0              0              0              0              0              0              0              6            
    100000   2415           200            200            0.0042251876   1.0452828e-36  0              0.012675563    293985.62      0              5.6782054e+10  0              0              3.3249178    
    200000   2415           200            200            0.0015163888   1.1644083e-42  0              0.0045491665   73118.578      0              1.4122538e+10  0              0              3.071473     
    300000   2415           200            200            0.00014364429  1.6456155e-41  0              0.00043093288  1317.2078      0              2.5441301e+08  0              0              3.0453812    
    400000   2415           200            200            0.018434867   -0.0015336213   0              0.056838223    2994.185       0              5.7831391e+08  0              0              2.9920972    
    500000   2415           200            200            0.00048315453 -0.00011781242  0              0.001567276    104.02917      0              20092785       0              0              2.9986577    
    600000   2415           200            200            0.0051740207  -0.0001045766   0              0.015626639    114.24143      0              22065238       0              0              2.9958643    
    700000   2415           200            200            0.0044919368   0.00022333874  0              0.013252472    3.400531       0              656797.89      0              0              2.9961786    
    800000   2415           200            200            0.0055246984   0.00011986696  0              0.016454228    0.22412922     0              43289.591      0              0              2.9957359    
    900000   2415           200            200            0.00517144     0.00014063369  0              0.015373686    0.21627643     0              41772.859      0              0              2.9958831    
   1000000   2415           200            200            0.0052130882   0.00013779166  0              0.015501473    0.034749334    0              6711.684       0              0              2.9958647    
   1100000   2415           200            200            0.0052383567   0.00013625409  0              0.015578816    0.0013503121   0              260.80695      0              0              2.9958545    
   1200000   2415           200            200            0.0052192642   0.00013744648  0              0.015520346    3.0941549e-05  0              5.9762267      0              0              2.9958624    
   1300000   2415           200            200            0.0052260527   0.00013701492  0              0.015541143    6.291728e-05   0              12.152201      0              0              2.9958596    
   1400000   2415           200            200            0.0052250044   0.00013708366  0              0.01553793     1.2144646e-05  0              2.3456859      0              0              2.99586      
   1500000   2415           200            200            0.0052246474   0.00013710513  0              0.015536837    6.2421598e-07  0              0.12056462     0              0              2.9958602    
   1600000   2415           200            200            0.0052249797   0.00013708437  0              0.015537855    2.3664504e-09  0              0.00045706968  0              0              2.99586      
   1700000   2415           200            200            0.0052248504   0.00013709256  0              0.015537459    1.7602349e-08  0              0.0033998178   0              0              2.9958601    
   1800000   2415           200            200            0.0052248746   0.00013709099  0              0.015537533    4.1330315e-09  0              0.0007982772   0              0              2.9958601    
   1900000   2415           200            200            0.0052248791   0.00013709072  0              0.015537547    2.6956656e-10  0              5.2065619e-05  0              0              2.9958601    
   2000000   2415           200            200            0.0052248735   0.00013709108  0              0.015537529    7.5611649e-15  0              1.4604064e-09  0              0              2.9958601    
   2100000   2415           200            200            0.0052248759   0.00013709092  0              0.015537537    4.7120726e-12  0              9.1011649e-07  0              0              2.9958601    
   2200000   2415           200            200            0.0052248754   0.00013709096  0              0.015537535    1.371424e-12   0              2.6488463e-07  0              0              2.9958601    
   2300000   2415           200            200            0.0052248753   0.00013709096  0              0.015537535    1.1061283e-13  0              2.1364391e-08  0              0              2.9958601    
   2400000   2415           200            200            0.0052248754   0.00013709095  0              0.015537535    3.917215e-16   0              7.5659317e-11  0              0              2.9958601    
   2500000   2415           200            200            0.0052248754   0.00013709096  0              0.015537535    1.2199719e-15  0              2.356323e-10   0              0              2.9958601    
   2600000   2415           200            200            0.0052248754   0.00013709096  0              0.015537535    4.518537e-16   0              8.7273592e-11  0              0              2.9958601    
   2700000   2415           200            200            0.0052248754   0.00013709096  0              0.015537535    5.0372211e-17  0              9.7291752e-12  0              0              2.9958601    
   2800000   2415           200            200            0.0052248754   0.00013709096  0              0.015537535    1.3025482e-18  0              2.5158157e-13  0              0              2.9958601    
   2900000   2415           200            200            0.0052248754   0.00013709096  0              0.015537535    3.7030291e-19  0              7.1522409e-14  0              0              2.9958601    
   3000000   2415           200            200            0.0052248754   0.00013709096  0              0.015537535    4.7558735e-19  0              9.1857643e-14  0              0              2.9958601    
Loop time of 179.233 on 2 procs for 3000000 steps with 1251 atoms

Performance: 14461643.598 ns/day, 0.000 hours/ns, 16738.013 timesteps/s
99.9% CPU use with 2 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 41.364     | 41.576     | 41.789     |   3.3 | 23.20
Neigh   | 3.0413     | 3.0419     | 3.0424     |   0.0 |  1.70
Comm    | 13.191     | 13.282     | 13.373     |   2.5 |  7.41
Output  | 0.22879    | 0.22884    | 0.22889    |   0.0 |  0.13
Modify  | 108.36     | 108.37     | 108.38     |   0.1 | 60.46
Other   |            | 12.73      |            |       |  7.10

Nlocal:          625.5 ave         626 max         625 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Nghost:            2.5 ave           3 max           2 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Neighs:          373.5 ave         374 max         373 min
Histogram: 1 0 0 0 0 0 0 0 0 1

Total # of neighbors = 747
Ave neighs/atom = 0.5971223
Neighbor list builds = 164
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 23

#variable lat0 equal 1                    #
variable lat1 equal 3+(v_ind*0.01)        # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 250*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 3.23                                                               
Lattice spacing in x,y,z = 3.23 3.23 3.23

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -1211.25 ${n1e1} -100 100 -100 100 units box
region box block -1211.25 1211.25 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -1211.25 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -1211.25 1211.25 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-1211.25 -100 -100) to (1211.25 100 100)
  2 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 750 atoms
  using lattice units in orthogonal box = (-1211.25 -100 -100) to (1211.25 100 100)
  create_atoms CPU = 0.000 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -750 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -750 750 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 501 atoms
  using lattice units in orthogonal box = (-1211.25 -100 -100) to (1211.25 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  750 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  750 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  501 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  501 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
750 atoms in group substrate
group slider1 region slider1
501 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 501 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_23_*.dump id type diameter mass xu yu zu fx fy fz

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 1563 130 130
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 67.56 | 67.56 | 67.56 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   2422.5         200            200            0              0              0              0              0              0              0              0              0              6            
    100000   2422.5         200            200            0.0042098247  -3.1261345e-36  0              0.012629474    293751.02      0              5.6736741e+10  0              0              3.3252308    
    200000   2422.5         200            200            0.0015054479   5.8470914e-43  0              0.0045163437   72647.022      0              1.4031459e+10  0              0              3.0722555    
    300000   2422.5         200            200            0.00013262271 -4.1681344e-36  0              0.00039786813  1139.8731      0              2.2016158e+08  0              0              3.0455321    
    400000   2422.5         200            200            0.018853337   -0.00060079891  0              0.05716081     3030.9159      0              5.8540832e+08  0              0              2.9919808    
    500000   2422.5         200            200            0.00049522855  0.0001525376   0              0.001333148    42.961979      0              8297920.9      0              0              2.9986088    
    600000   2422.5         200            200            0.0067419841   0.0056861915   0              0.014539761    114.05745      0              22029705       0              0              2.9957693    
    700000   2422.5         200            200            0.0064748517   0.0056881696   0              0.013736386    8.8904538      0              1717152.8      0              0              2.9958897    
    800000   2422.5         200            200            0.0067202006   0.0056522152   0              0.014508387    0.012070376    0              2331.341       0              0              2.9957892    
    900000   2422.5         200            200            0.006996755    0.0056494195   0              0.015340845    0.23366244     0              45130.892      0              0              2.9956794    
   1000000   2422.5         200            200            0.0070753782   0.0056491387   0              0.015576996    0.021826158    0              4215.6283      0              0              2.9956484    
   1100000   2422.5         200            200            0.0070613757   0.0056482184   0              0.015535909    0.00038066629  0              73.524051      0              0              2.9956534    
   1200000   2422.5         200            200            0.0070460506   0.0056470514   0              0.0154911      0.00067390423  0              130.16169      0              0              2.9956592    
   1300000   2422.5         200            200            0.0070432184   0.0056468358   0              0.015482819    2.895975e-05   0              5.5934508      0              0              2.9956603    
   1400000   2422.5         200            200            0.0070444098   0.0056469218   0              0.015486308    3.3989522e-06  0              0.65649295     0              0              2.9956599    
   1500000   2422.5         200            200            0.0070451603   0.0056469776   0              0.015488503    1.6791716e-06  0              0.32432476     0              0              2.9956596    
   1600000   2422.5         200            200            0.0070452311   0.0056469832   0              0.01548871     2.2826657e-08  0              0.0044088703   0              0              2.9956595    
   1700000   2422.5         200            200            0.0070451516   0.0056469774   0              0.015488477    1.6468177e-08  0              0.0031807573   0              0              2.9956596    
   1800000   2422.5         200            200            0.0070451175   0.0056469748   0              0.015488378    3.6018434e-09  0              0.0006956805   0              0              2.9956596    
   1900000   2422.5         200            200            0.0070451177   0.0056469748   0              0.015488378    1.438651e-12   0              2.7786923e-07  0              0              2.9956596    
   2000000   2422.5         200            200            0.0070451224   0.0056469752   0              0.015488392    5.9799718e-11  0              1.1550057e-05  0              0              2.9956596    
   2100000   2422.5         200            200            0.0070451238   0.0056469753   0              0.015488396    6.4987348e-12  0              1.2552026e-06  0              0              2.9956596    
   2200000   2422.5         200            200            0.0070451236   0.0056469753   0              0.015488396    6.6194332e-14  0              1.278515e-08   0              0              2.9956596    
   2300000   2422.5         200            200            0.0070451234   0.0056469752   0              0.015488395    1.7943707e-13  0              3.4657496e-08  0              0              2.9956596    
   2400000   2422.5         200            200            0.0070451233   0.0056469752   0              0.015488395    9.215304e-15   0              1.7798962e-09  0              0              2.9956596    
   2500000   2422.5         200            200            0.0070451233   0.0056469752   0              0.015488395    7.5018923e-16  0              1.4489581e-10  0              0              2.9956596    
   2600000   2422.5         200            200            0.0070451233   0.0056469752   0              0.015488395    4.6265648e-16  0              8.9360103e-11  0              0              2.9956596    
   2700000   2422.5         200            200            0.0070451233   0.0056469752   0              0.015488395    1.6565474e-17  0              3.1995499e-12  0              0              2.9956596    
   2800000   2422.5         200            200            0.0070451233   0.0056469752   0              0.015488395    1.4445667e-18  0              2.7901182e-13  0              0              2.9956596    
   2900000   2422.5         200            200            0.0070451233   0.0056469752   0              0.015488395    2.3634184e-18  0              4.5648407e-13  0              0              2.9956596    
   3000000   2422.5         200            200            0.0070451233   0.0056469752   0              0.015488395    1.6393414e-19  0              3.1663171e-14  0              0              2.9956596    
Loop time of 180.447 on 2 procs for 3000000 steps with 1251 atoms

Performance: 14364347.561 ns/day, 0.000 hours/ns, 16625.402 timesteps/s
99.9% CPU use with 2 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 41.573     | 41.74      | 41.906     |   2.6 | 23.13
Neigh   | 3.0989     | 3.1002     | 3.1015     |   0.1 |  1.72
Comm    | 14.047     | 14.066     | 14.085     |   0.5 |  7.80
Output  | 0.21018    | 0.21022    | 0.21026    |   0.0 |  0.12
Modify  | 108.5      | 108.62     | 108.74     |   1.2 | 60.20
Other   |            | 12.71      |            |       |  7.04

Nlocal:          625.5 ave         626 max         625 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Nghost:            2.5 ave           3 max           2 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Neighs:          369.5 ave         370 max         369 min
Histogram: 1 0 0 0 0 0 0 0 0 1

Total # of neighbors = 739
Ave neighs/atom = 0.59072742
Neighbor list builds = 166
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 24

#variable lat0 equal 1                    #
variable lat1 equal 3+(v_ind*0.01)        # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 250*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 3.24                                                               
Lattice spacing in x,y,z = 3.24 3.24 3.24

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -1215 ${n1e1} -100 100 -100 100 units box
region box block -1215 1215 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -1215 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -1215 1215 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-1215 -100 -100) to (1215 100 100)
  2 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 750 atoms
  using lattice units in orthogonal box = (-1215 -100 -100) to (1215 100 100)
  create_atoms CPU = 0.000 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -750 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -750 750 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 501 atoms
  using lattice units in orthogonal box = (-1215 -100 -100) to (1215 100 100)
  create_atoms CPU = 0.000 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  750 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  750 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  501 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  501 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
750 atoms in group substrate
group slider1 region slider1
501 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 501 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_24_*.dump id type diameter mass xu yu zu fx fy fz

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 1568 130 130
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 67.7 | 67.7 | 67.7 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   2430           200            200            0              0              0              0              0              0              0              0              0              6            
    100000   2430           200            200            0.0041972398  -2.5970723e-37  0              0.012591719    293788.92      0              5.6744062e+10  0              0              3.3252424    
    200000   2430           200            200            0.0015028048  -4.1553123e-36  0              0.0045084145   72798.784      0              1.4060771e+10  0              0              3.0719976    
    300000   2430           200            200            0.00013761142 -2.5970723e-37  0              0.00041283426  1229.2873      0              2.3743154e+08  0              0              3.0453888    
    400000   2430           200            200            0.012156954    0.00027494203  0              0.036195921    4599.0136      0              8.8827963e+08  0              0              2.9937276    
    500000   2430           200            200            0.00071683785 -2.1741444e-16  0              0.0021505136   162.98639      0              31480118       0              0              2.9984421    
    600000   2430           200            200            0.0031643422   5.8886441e-05  0              0.0094341403   37.054417      0              7156900.8      0              0              2.9966131    
    700000   2430           200            200            0.0061295396   0.00011394472  0              0.018274674    0.31842056     0              61501.557      0              0              2.9954655    
    800000   2430           200            200            0.0049270231   0.00010805253  0              0.014673017    0.90405717     0              174614.74      0              0              2.9959015    
    900000   2430           200            200            0.0051765344   0.00010960692  0              0.015419996    0.28599509     0              55238.718      0              0              2.995806     
   1000000   2430           200            200            0.0052216133   0.00010984867  0              0.015554991    0.013071882    0              2524.7776      0              0              2.9957902    
   1100000   2430           200            200            0.0051673701   0.00010954235  0              0.015392568    0.00041887206  0              80.903331      0              0              2.9958101    
   1200000   2430           200            200            0.0051859148   0.00010964963  0              0.015448095    0.00061000002  0              117.81887      0              0              2.9958032    
   1300000   2430           200            200            0.0051848342   0.00010964275  0              0.01544486     7.093284e-05   0              13.700372      0              0              2.9958036    
   1400000   2430           200            200            0.0051828194   0.00010963143  0              0.015438827    2.3063428e-07  0              0.044546015    0              0              2.9958044    
   1500000   2430           200            200            0.005183878    0.00010963749  0              0.015441996    8.4552703e-07  0              0.1633099      0              0              2.995804     
   1600000   2430           200            200            0.0051836705   0.00010963627  0              0.015441375    2.3167057e-07  0              0.044746171    0              0              2.9958041    
   1700000   2430           200            200            0.0051836216   0.00010963601  0              0.015441229    8.8101207e-09  0              0.0017016368   0              0              2.9958041    
   1800000   2430           200            200            0.0051836717   0.00010963629  0              0.015441379    5.0490866e-10  0              9.7520929e-05  0              0              2.9958041    
   1900000   2430           200            200            0.0051836556   0.0001096362   0              0.015441331    5.2211324e-10  0              0.00010084392  0              0              2.9958041    
   2000000   2430           200            200            0.0051836562   0.0001096362   0              0.015441332    5.3525002e-11  0              1.0338123e-05  0              0              2.9958041    
   2100000   2430           200            200            0.0051836581   0.00010963621  0              0.015441338    5.2287561e-14  0              1.0099117e-08  0              0              2.9958041    
   2200000   2430           200            200            0.0051836571   0.00010963621  0              0.015441335    7.8195262e-13  0              1.5103077e-07  0              0              2.9958041    
   2300000   2430           200            200            0.0051836573   0.00010963621  0              0.015441336    1.860744e-13   0              3.5939468e-08  0              0              2.9958041    
   2400000   2430           200            200            0.0051836574   0.00010963621  0              0.015441336    5.8480012e-15  0              1.1295162e-09  0              0              2.9958041    
   2500000   2430           200            200            0.0051836573   0.00010963621  0              0.015441336    5.2031067e-16  0              1.0049576e-10  0              0              2.9958041    
   2600000   2430           200            200            0.0051836573   0.00010963621  0              0.015441336    4.5064252e-16  0              8.7039658e-11  0              0              2.9958041    
   2700000   2430           200            200            0.0051836573   0.00010963621  0              0.015441336    5.1021871e-17  0              9.8546541e-12  0              0              2.9958041    
   2800000   2430           200            200            0.0051836573   0.00010963621  0              0.015441336    9.7894332e-19  0              1.8907868e-13  0              0              2.9958041    
   2900000   2430           200            200            0.0051836573   0.00010963621  0              0.015441336    2.5392484e-18  0              4.9044486e-13  0              0              2.9958041    
   3000000   2430           200            200            0.0051836573   0.00010963621  0              0.015441336    2.8886783e-18  0              5.5793575e-13  0              0              2.9958041    
Loop time of 180.504 on 2 procs for 3000000 steps with 1251 atoms

Performance: 14359803.047 ns/day, 0.000 hours/ns, 16620.142 timesteps/s
99.9% CPU use with 2 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 41.278     | 41.386     | 41.495     |   1.7 | 22.93
Neigh   | 3.0537     | 3.0539     | 3.0541     |   0.0 |  1.69
Comm    | 13.919     | 13.959     | 14         |   1.1 |  7.73
Output  | 0.21524    | 0.21528    | 0.21531    |   0.0 |  0.12
Modify  | 108.73     | 109        | 109.28     |   2.6 | 60.39
Other   |            | 12.89      |            |       |  7.14

Nlocal:          625.5 ave         626 max         625 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Nghost:            2.5 ave           3 max           2 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Neighs:          370.5 ave         371 max         370 min
Histogram: 1 0 0 0 0 0 0 0 0 1

Total # of neighbors = 741
Ave neighs/atom = 0.59232614
Neighbor list builds = 164
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 25

#variable lat0 equal 1                    #
variable lat1 equal 3+(v_ind*0.01)        # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 250*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 3.25                                                               
Lattice spacing in x,y,z = 3.25 3.25 3.25

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -1218.75 ${n1e1} -100 100 -100 100 units box
region box block -1218.75 1218.75 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -1218.75 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -1218.75 1218.75 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-1218.75 -100 -100) to (1218.75 100 100)
  2 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 750 atoms
  using lattice units in orthogonal box = (-1218.75 -100 -100) to (1218.75 100 100)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -750 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -750 750 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 501 atoms
  using lattice units in orthogonal box = (-1218.75 -100 -100) to (1218.75 100 100)
  create_atoms CPU = 0.000 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  750 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  750 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  501 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  501 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
750 atoms in group substrate
group slider1 region slider1
501 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 501 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_25_*.dump id type diameter mass xu yu zu fx fy fz

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 1573 130 130
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 67.91 | 67.91 | 67.91 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   2437.5         200            200            0              0              0              0              0              0              0              0              0              6            
    100000   2437.5         200            200            0.0041840844   2.5890822e-37  0              0.012552253    293743.41      0              5.6735273e+10  0              0              3.3256076    
    200000   2437.5         200            200            0.0015039657   1.0356338e-36  0              0.004511897    73245.023      0              1.414696e+10   0              0              3.070993     
    300000   2437.5         200            200            0.00013127867  1.0356341e-36  0              0.00039383602  1131.2713      0              2.1850017e+08  0              0              3.045535     
    400000   2437.5         200            200            0.00019727009  1.33376e-42    0              0.00059181026  2477.1915      0              4.7845885e+08  0              0              3.0033169    
    500000   2437.5         200            200            0.0022654358   6.4727049e-37  0              0.0067963073   598.24801      0              1.1554902e+08  0              0              2.9980566    
    600000   2437.5         200            200            0.0047933937  -6.4727046e-38  0              0.014380181    109.75711      0              21199112       0              0              2.9966886    
    700000   2437.5         200            200            0.0059198889   9.7090577e-38  0              0.017759667    1.9363232      0              373992.46      0              0              2.9962053    
    800000   2437.5         200            200            0.005351109    8.0908812e-38  0              0.016053327    1.0293694      0              198818.26      0              0              2.9964562    
    900000   2437.5         200            200            0.0050964456  -4.8545286e-38  0              0.015289337    0.24660972     0              47631.604      0              0              2.9965689    
   1000000   2437.5         200            200            0.0050916136  -5.6636167e-38  0              0.015274841    0.00052649418  0              101.69008      0              0              2.9965703    
   1100000   2437.5         200            200            0.005124226   -6.4727049e-38  0              0.015372678    0.0035664012   0              688.83499      0              0              2.9965555    
   1200000   2437.5         200            200            0.0051354109   3.2363524e-38  0              0.015406233    0.00049806633  0              96.199363      0              0              2.9965506    
   1300000   2437.5         200            200            0.005134599   -6.4727049e-38  0              0.015403797    7.8858569e-07  0              0.15231192     0              0              2.996551     
   1400000   2437.5         200            200            0.0051328272  -2.4272643e-38  0              0.015398482    1.0888663e-05  0              2.1030982      0              0              2.9965518    
   1500000   2437.5         200            200            0.0051323669  -3.2363524e-38  0              0.015397101    8.8673387e-07  0              0.17126882     0              0              2.996552     
   1600000   2437.5         200            200            0.0051324581   1.6181762e-38  0              0.015397374    2.0371502e-08  0              0.0039346677   0              0              2.9965519    
   1700000   2437.5         200            200            0.0051325497  -8.0908811e-38  0              0.015397649    2.9965236e-08  0              0.0057876561   0              0              2.9965519    
   1800000   2437.5         200            200            0.0051325668   1.6181762e-38  0              0.0153977      1.3259472e-09  0              0.00025610098  0              0              2.9965519    
   1900000   2437.5         200            200            0.0051325599   2.4163686e-48  0              0.01539768     1.3607585e-10  0              2.6282463e-05  0              0              2.9965519    
   2000000   2437.5         200            200            0.0051325554   1.6181762e-38  0              0.015397666    7.5196301e-11  0              1.4523841e-05  0              0              2.9965519    
   2100000   2437.5         200            200            0.0051325549   1.6181762e-38  0              0.015397665    1.4737324e-12  0              2.8464505e-07  0              0              2.9965519    
   2200000   2437.5         200            200            0.0051325553   6.4727049e-38  0              0.015397666    6.0906994e-13  0              1.1763923e-07  0              0              2.9965519    
   2300000   2437.5         200            200            0.0051325555   1.6181762e-38  0              0.015397667    1.7234234e-13  0              3.328718e-08   0              0              2.9965519    
   2400000   2437.5         200            200            0.0051325555   6.0493915e-47  0              0.015397667    8.023869e-16   0              1.5497757e-10  0              0              2.9965519    
   2500000   2437.5         200            200            0.0051325555  -3.2363524e-38  0              0.015397667    2.2034988e-15  0              4.2559629e-10  0              0              2.9965519    
   2600000   2437.5         200            200            0.0051325555   3.2363524e-38  0              0.015397667    3.6383039e-16  0              7.027227e-11   0              0              2.9965519    
   2700000   2437.5         200            200            0.0051325555  -8.0908811e-38  0              0.015397667    2.0471205e-18  0              3.9539248e-13  0              0              2.9965519    
   2800000   2437.5         200            200            0.0051325555  -3.2363524e-38  0              0.015397667    7.9260423e-18  0              1.5308809e-12  0              0              2.9965519    
   2900000   2437.5         200            200            0.0051325555   6.4727052e-38  0              0.015397667    1.0956999e-18  0              2.116297e-13   0              0              2.9965519    
   3000000   2437.5         200            200            0.0051325555  -1.5534492e-36  0              0.015397667    1.2194959e-18  0              2.3554037e-13  0              0              2.9965519    
Loop time of 179.401 on 2 procs for 3000000 steps with 1251 atoms

Performance: 14448088.570 ns/day, 0.000 hours/ns, 16722.325 timesteps/s
99.9% CPU use with 2 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 40.674     | 40.823     | 40.972     |   2.3 | 22.75
Neigh   | 3.09       | 3.0903     | 3.0906     |   0.0 |  1.72
Comm    | 14.028     | 14.053     | 14.079     |   0.7 |  7.83
Output  | 0.21128    | 0.21131    | 0.21134    |   0.0 |  0.12
Modify  | 108.39     | 108.51     | 108.64     |   1.2 | 60.49
Other   |            | 12.71      |            |       |  7.08

Nlocal:          625.5 ave         626 max         625 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Nghost:            2.5 ave           3 max           2 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Neighs:          386.5 ave         387 max         386 min
Histogram: 1 0 0 0 0 0 0 0 0 1

Total # of neighbors = 773
Ave neighs/atom = 0.61790568
Neighbor list builds = 164
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 26

#variable lat0 equal 1                    #
variable lat1 equal 3+(v_ind*0.01)        # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 250*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 3.26                                                               
Lattice spacing in x,y,z = 3.26 3.26 3.26

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -1222.5 ${n1e1} -100 100 -100 100 units box
region box block -1222.5 1222.5 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -1222.5 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -1222.5 1222.5 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-1222.5 -100 -100) to (1222.5 100 100)
  2 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 750 atoms
  using lattice units in orthogonal box = (-1222.5 -100 -100) to (1222.5 100 100)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -750 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -750 750 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 501 atoms
  using lattice units in orthogonal box = (-1222.5 -100 -100) to (1222.5 100 100)
  create_atoms CPU = 0.000 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  750 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  750 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  501 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  501 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
750 atoms in group substrate
group slider1 region slider1
501 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 501 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_26_*.dump id type diameter mass xu yu zu fx fy fz

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 1578 130 130
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 68.05 | 68.05 | 68.05 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   2445           200            200            0              0              0              0              0              0              0              0              0              6            
    100000   2445           200            200            0.0041711486   1.2182223e-43  0              0.012513446    293756.34      0              5.6737769e+10  0              0              3.3252442    
    200000   2445           200            200            0.001492849    2.5811401e-37  0              0.004478547    72744.036      0              1.4050197e+10  0              0              3.0720351    
    300000   2445           200            200            0.00013437116  5.1622806e-37  0              0.00040311347  1189.0263      0              2.296553e+08   0              0              3.0453908    
    400000   2445           200            200            0.013899891   -0.00042218863  0              0.042121862    4109.5981      0              7.9375114e+08  0              0              2.992984     
    500000   2445           200            200            0.0017055316  -0.00096061851  0              0.0060772134   580.91935      0              1.1220207e+08  0              0              2.997258     
    600000   2445           200            200            0.0031880804   0.0005655386   0              0.0089987025   5.4428659      0              1051266.1      0              0              2.9967225    
    700000   2445           200            200            0.0063306935   0.0012323909   0              0.017759689    2.6533486      0              512482.83      0              0              2.9954053    
    800000   2445           200            200            0.0052828058   0.0012618606   0              0.014586557    0.69447319     0              134134.5       0              0              2.9958331    
    900000   2445           200            200            0.0056067558   0.0012962052   0              0.015524062    0.20378412     0              39360.023      0              0              2.9957016    
   1000000   2445           200            200            0.0055449356   0.0012920444   0              0.015342762    0.036966198    0              7139.8617      0              0              2.995726     
   1100000   2445           200            200            0.0055378623   0.001291348    0              0.015322239    0.0036336179   0              701.81761      0              0              2.9957293    
   1200000   2445           200            200            0.0055512937   0.0012926011   0              0.01536128     0.00014722193  0              28.435281      0              0              2.9957237    
   1300000   2445           200            200            0.0055439408   0.0012919049   0              0.015339918    1.4794428e-07  0              0.028574799    0              0              2.9957267    
   1400000   2445           200            200            0.0055467884   0.0012922001   0              0.015348165    3.5255981e-06  0              0.68095406     0              0              2.9957255    
   1500000   2445           200            200            0.0055459719   0.0012921123   0              0.015345803    1.3045789e-06  0              0.25197379     0              0              2.9957259    
   1600000   2445           200            200            0.005546106    0.0012921262   0              0.015346192    2.2377097e-07  0              0.043220397    0              0              2.9957258    
   1700000   2445           200            200            0.005546131    0.0012921292   0              0.015346264    2.1513729e-08  0              0.004155284    0              0              2.9957258    
   1800000   2445           200            200            0.005546097    0.0012921254   0              0.015346165    8.6575354e-10  0              0.00016721656  0              0              2.9957258    
   1900000   2445           200            200            0.0055461152   0.0012921274   0              0.015346218    1.1883407e-12  0              2.2952287e-07  0              0              2.9957258    
   2000000   2445           200            200            0.0055461082   0.0012921267   0              0.015346198    2.1781087e-11  0              4.206923e-06   0              0              2.9957258    
   2100000   2445           200            200            0.0055461102   0.0012921269   0              0.015346204    7.9620201e-12  0              1.5378298e-06  0              0              2.9957258    
   2200000   2445           200            200            0.0055461099   0.0012921269   0              0.015346203    1.3562777e-12  0              2.6195918e-07  0              0              2.9957258    
   2300000   2445           200            200            0.0055461098   0.0012921269   0              0.015346203    1.2955633e-13  0              2.5023247e-08  0              0              2.9957258    
   2400000   2445           200            200            0.0055461099   0.0012921269   0              0.015346203    5.2219541e-15  0              1.0085979e-09  0              0              2.9957258    
   2500000   2445           200            200            0.0055461099   0.0012921269   0              0.015346203    8.2685148e-18  0              1.597028e-12   0              0              2.9957258    
   2600000   2445           200            200            0.0055461099   0.0012921269   0              0.015346203    1.4810892e-16  0              2.8606598e-11  0              0              2.9957258    
   2700000   2445           200            200            0.0055461099   0.0012921269   0              0.015346203    5.7317683e-17  0              1.1070663e-11  0              0              2.9957258    
   2800000   2445           200            200            0.0055461099   0.0012921269   0              0.015346203    6.3805957e-18  0              1.2323845e-12  0              0              2.9957258    
   2900000   2445           200            200            0.0055461099   0.0012921269   0              0.015346203    1.6824539e-18  0              3.2495871e-13  0              0              2.9957258    
   3000000   2445           200            200            0.0055461099   0.0012921269   0              0.015346203    2.295845e-18   0              4.4343255e-13  0              0              2.9957258    
Loop time of 179.297 on 2 procs for 3000000 steps with 1251 atoms

Performance: 14456451.221 ns/day, 0.000 hours/ns, 16732.004 timesteps/s
99.9% CPU use with 2 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 41.352     | 41.485     | 41.618     |   2.1 | 23.14
Neigh   | 3.0645     | 3.0647     | 3.0648     |   0.0 |  1.71
Comm    | 13.297     | 13.314     | 13.331     |   0.5 |  7.43
Output  | 0.21095    | 0.21099    | 0.21103    |   0.0 |  0.12
Modify  | 108.52     | 108.52     | 108.52     |   0.0 | 60.52
Other   |            | 12.71      |            |       |  7.09

Nlocal:          625.5 ave         626 max         625 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Nghost:            2.5 ave           3 max           2 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Neighs:          371.5 ave         372 max         371 min
Histogram: 1 0 0 0 0 0 0 0 0 1

Total # of neighbors = 743
Ave neighs/atom = 0.59392486
Neighbor list builds = 164
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 27

#variable lat0 equal 1                    #
variable lat1 equal 3+(v_ind*0.01)        # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 250*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 3.27                                                               
Lattice spacing in x,y,z = 3.27 3.27 3.27

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -1226.25 ${n1e1} -100 100 -100 100 units box
region box block -1226.25 1226.25 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -1226.25 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -1226.25 1226.25 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-1226.25 -100 -100) to (1226.25 100 100)
  2 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 750 atoms
  using lattice units in orthogonal box = (-1226.25 -100 -100) to (1226.25 100 100)
  create_atoms CPU = 0.000 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -750 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -750 750 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 501 atoms
  using lattice units in orthogonal box = (-1226.25 -100 -100) to (1226.25 100 100)
  create_atoms CPU = 0.000 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  750 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  750 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  501 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  501 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
750 atoms in group substrate
group slider1 region slider1
501 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 501 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_27_*.dump id type diameter mass xu yu zu fx fy fz

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 1583 130 130
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 68.26 | 68.26 | 68.26 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   2452.5         200            200            0              0              0              0              0              0              0              0              0              6            
    100000   2452.5         200            200            0.0041580203   1.5439481e-36  0              0.012474061    293714.56      0              5.67297e+10    0              0              3.3253444    
    200000   2452.5         200            200            0.0014874516   9.7783375e-36  0              0.0044623547   72679.913      0              1.4037812e+10  0              0              3.0721644    
    300000   2452.5         200            200            0.00012962726  2.0586057e-36  0              0.00038888179  1117.4208      0              2.15825e+08    0              0              3.0455415    
    400000   2452.5         200            200            0.010122205    0.00013078682  0              0.030235828    4820.5104      0              9.3106077e+08  0              0              2.9941576    
    500000   2452.5         200            200            0.0033602917  -0.00064882479  0              0.0107297      778.68981      0              1.5040058e+08  0              0              2.9964798    
    600000   2452.5         200            200            0.0034793558  -0.0002574432   0              0.01069551     59.160867      0              11426666       0              0              2.9965198    
    700000   2452.5         200            200            0.0054369936  -0.00021727004  0              0.016528251    12.016425      0              2320920.7      0              0              2.9956648    
    800000   2452.5         200            200            0.0047689132  -0.00021597742  0              0.014522717    0.67301417     0              129989.78      0              0              2.9959352    
    900000   2452.5         200            200            0.005145714   -0.00021184608  0              0.015648988    0.0017157178   0              331.38348      0              0              2.995779     
   1000000   2452.5         200            200            0.0049902017  -0.00021549907  0              0.015186104    0.007656204    0              1478.7628      0              0              2.9958431    
   1100000   2452.5         200            200            0.0050365576  -0.00021441533  0              0.015324088    0.0036682963   0              708.51561      0              0              2.9958237    
   1200000   2452.5         200            200            0.0050284384  -0.0002146116   0              0.015299927    0.00068156055  0              131.64048      0              0              2.9958272    
   1300000   2452.5         200            200            0.0050272612  -0.00021463594  0              0.015296419    6.6866274e-05  0              12.914932      0              0              2.9958276    
   1400000   2452.5         200            200            0.0050290961  -0.00021459419  0              0.015301883    2.5510942e-06  0              0.49273283     0              0              2.9958269    
   1500000   2452.5         200            200            0.0050281058  -0.00021461705  0              0.015298934    1.0768412e-08  0              0.0020798723   0              0              2.9958273    
   1600000   2452.5         200            200            0.0050284784  -0.00021460837  0              0.015300043    7.8789021e-08  0              0.015217759    0              0              2.9958271    
   1700000   2452.5         200            200            0.0050283787  -0.00021461072  0              0.015299747    2.618688e-08   0              0.0050578829   0              0              2.9958272    
   1800000   2452.5         200            200            0.0050283908  -0.00021461042  0              0.015299783    4.0281176e-09  0              0.00077801354  0              0              2.9958272    
   1900000   2452.5         200            200            0.0050283967  -0.00021461029  0              0.0152998      3.206065e-10   0              6.1923761e-05  0              0              2.9958272    
   2000000   2452.5         200            200            0.0050283914  -0.00021461042  0              0.015299785    7.0012416e-12  0              1.3522596e-06  0              0              2.9958272    
   2100000   2452.5         200            200            0.0050283939  -0.00021461036  0              0.015299792    5.7828959e-13  0              1.1169414e-07  0              0              2.9958272    
   2200000   2452.5         200            200            0.005028393   -0.00021461038  0              0.015299789    6.9553802e-13  0              1.3434017e-07  0              0              2.9958272    
   2300000   2452.5         200            200            0.0050283932  -0.00021461037  0              0.01529979     1.7587769e-13  0              3.3970016e-08  0              0              2.9958272    
   2400000   2452.5         200            200            0.0050283932  -0.00021461037  0              0.01529979     2.2561985e-14  0              4.3577501e-09  0              0              2.9958272    
   2500000   2452.5         200            200            0.0050283932  -0.00021461037  0              0.01529979     1.4088978e-15  0              2.7212252e-10  0              0              2.9958272    
   2600000   2452.5         200            200            0.0050283932  -0.00021461037  0              0.01529979     9.2810488e-18  0              1.7925945e-12  0              0              2.9958272    
   2700000   2452.5         200            200            0.0050283932  -0.00021461037  0              0.01529979     3.3381652e-18  0              6.4475219e-13  0              0              2.9958272    
   2800000   2452.5         200            200            0.0050283932  -0.00021461037  0              0.01529979     2.6086817e-18  0              5.0385561e-13  0              0              2.9958272    
   2900000   2452.5         200            200            0.0050283932  -0.00021461037  0              0.01529979     1.9949621e-18  0              3.8531832e-13  0              0              2.9958272    
   3000000   2452.5         200            200            0.0050283932  -0.00021461037  0              0.01529979     1.9021119e-18  0              3.673847e-13   0              0              2.9958272    
Loop time of 180.492 on 2 procs for 3000000 steps with 1251 atoms

Performance: 14360713.501 ns/day, 0.000 hours/ns, 16621.196 timesteps/s
99.9% CPU use with 2 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 41.278     | 41.48      | 41.682     |   3.1 | 22.98
Neigh   | 3.1051     | 3.1054     | 3.1058     |   0.0 |  1.72
Comm    | 14.027     | 14.045     | 14.063     |   0.5 |  7.78
Output  | 0.20978    | 0.2098     | 0.20982    |   0.0 |  0.12
Modify  | 108.78     | 108.95     | 109.12     |   1.7 | 60.36
Other   |            | 12.7       |            |       |  7.04

Nlocal:          625.5 ave         626 max         625 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Nghost:            2.5 ave           3 max           2 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Neighs:          370.5 ave         371 max         370 min
Histogram: 1 0 0 0 0 0 0 0 0 1

Total # of neighbors = 741
Ave neighs/atom = 0.59232614
Neighbor list builds = 166
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 28

#variable lat0 equal 1                    #
variable lat1 equal 3+(v_ind*0.01)        # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 250*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 3.28                                                               
Lattice spacing in x,y,z = 3.28 3.28 3.28

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -1230 ${n1e1} -100 100 -100 100 units box
region box block -1230 1230 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -1230 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -1230 1230 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-1230 -100 -100) to (1230 100 100)
  2 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 750 atoms
  using lattice units in orthogonal box = (-1230 -100 -100) to (1230 100 100)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -750 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -750 750 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 501 atoms
  using lattice units in orthogonal box = (-1230 -100 -100) to (1230 100 100)
  create_atoms CPU = 0.000 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  750 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  750 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  501 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  501 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
750 atoms in group substrate
group slider1 region slider1
501 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 501 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_28_*.dump id type diameter mass xu yu zu fx fy fz

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 1588 130 130
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 68.4 | 68.4 | 68.4 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   2460           200            200            0              0              0              0              0              0              0              0              0              6            
    100000   2460           200            200            0.0041459995   4.3170287e-43  0              0.012437999    293785.06      0              5.6743316e+10  0              0              3.3252208    
    200000   2460           200            200            0.0014841768  -4.1045971e-36  0              0.0044525305   72776.018      0              1.4056374e+10  0              0              3.0720228    
    300000   2460           200            200            0.00013262651 -3.2067513e-38  0              0.00039787954  1173.4759      0              2.2665181e+08  0              0              3.04549      
    400000   2460           200            200            0.012314474   -0.0030519245   0              0.039995346    4253.9715      0              8.2163624e+08  0              0              2.9932315    
    500000   2460           200            200            0.001201174   -0.00087470917  0              0.0044782312   470.66562      0              90907033       0              0              2.9976786    
    600000   2460           200            200            0.002546077   -0.0017281285   0              0.0093663595   19.450127      0              3756708        0              0              2.9967324    
    700000   2460           200            200            0.0054938033  -0.0014071799   0              0.01788859     0.028588394    0              5521.725       0              0              2.9954411    
    800000   2460           200            200            0.0044968514  -0.0013072102   0              0.014797764    1.5380488      0              297067.48      0              0              2.9958602    
    900000   2460           200            200            0.0045443164  -0.0013077522   0              0.014940701    0.037987115    0              7337.0473      0              0              2.9958415    
   1000000   2460           200            200            0.0046562725  -0.0013092724   0              0.01527809     0.035431974    0              6843.5329      0              0              2.9957926    
   1100000   2460           200            200            0.0046631162  -0.0013093789   0              0.015298728    3.6066002e-07  0              0.069659926    0              0              2.9957893    
   1200000   2460           200            200            0.0046488842  -0.0013091797   0              0.015255832    0.00065023452  0              125.58999      0              0              2.9957954    
   1300000   2460           200            200            0.0046460204  -0.0013091384   0              0.0152472      1.1602197e-05  0              2.2409143      0              0              2.9957967    
   1400000   2460           200            200            0.0046475499  -0.0013091595   0              0.015251809    8.8674667e-06  0              1.7127129      0              0              2.9957961    
   1500000   2460           200            200            0.0046481459  -0.001309168    0              0.015253606    7.5223345e-07  0              0.14529064     0              0              2.9957958    
   1600000   2460           200            200            0.0046480209  -0.0013091663   0              0.015253229    8.0401427e-08  0              0.015529189    0              0              2.9957959    
   1700000   2460           200            200            0.0046479233  -0.0013091649   0              0.015252935    2.4308745e-08  0              0.0046951292   0              0              2.9957959    
   1800000   2460           200            200            0.0046479268  -0.001309165    0              0.015252945    2.8801045e-10  0              5.5627976e-05  0              0              2.9957959    
   1900000   2460           200            200            0.0046479405  -0.0013091652   0              0.015252987    5.4652171e-10  0              0.00010555831  0              0              2.9957959    
   2000000   2460           200            200            0.0046479419  -0.0013091652   0              0.015252991    8.1915785e-13  0              1.582168e-07   0              0              2.9957959    
   2100000   2460           200            200            0.0046479402  -0.0013091652   0              0.015252986    9.2016513e-12  0              1.7772592e-06  0              0              2.9957959    
   2200000   2460           200            200            0.0046479398  -0.0013091651   0              0.015252985    2.8839135e-13  0              5.5701545e-08  0              0              2.9957959    
   2300000   2460           200            200            0.00464794    -0.0013091651   0              0.015252985    1.1283017e-13  0              2.1792661e-08  0              0              2.9957959    
   2400000   2460           200            200            0.00464794    -0.0013091651   0              0.015252985    1.4212046e-14  0              2.7449953e-09  0              0              2.9957959    
   2500000   2460           200            200            0.00464794    -0.0013091651   0              0.015252985    8.1133464e-16  0              1.5670579e-10  0              0              2.9957959    
   2600000   2460           200            200            0.00464794    -0.0013091651   0              0.015252985    4.0706979e-16  0              7.8623773e-11  0              0              2.9957959    
   2700000   2460           200            200            0.00464794    -0.0013091651   0              0.015252985    2.8546714e-20  0              5.5136747e-15  0              0              2.9957959    
   2800000   2460           200            200            0.00464794    -0.0013091651   0              0.015252985    7.1769338e-18  0              1.3861938e-12  0              0              2.9957959    
   2900000   2460           200            200            0.00464794    -0.0013091651   0              0.015252985    3.1783772e-19  0              6.1388983e-14  0              0              2.9957959    
   3000000   2460           200            200            0.00464794    -0.0013091651   0              0.015252985    2.1235784e-18  0              4.1016e-13     0              0              2.9957959    
Loop time of 179.485 on 2 procs for 3000000 steps with 1251 atoms

Performance: 14441292.076 ns/day, 0.000 hours/ns, 16714.458 timesteps/s
99.9% CPU use with 2 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 41.243     | 41.324     | 41.406     |   1.3 | 23.02
Neigh   | 3.102      | 3.1023     | 3.1026     |   0.0 |  1.73
Comm    | 13.399     | 13.446     | 13.493     |   1.3 |  7.49
Output  | 0.21289    | 0.21292    | 0.21296    |   0.0 |  0.12
Modify  | 108.6      | 108.66     | 108.72     |   0.6 | 60.54
Other   |            | 12.74      |            |       |  7.10

Nlocal:          625.5 ave         626 max         625 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Nghost:            2.5 ave           3 max           2 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Neighs:          369.5 ave         370 max         369 min
Histogram: 1 0 0 0 0 0 0 0 0 1

Total # of neighbors = 739
Ave neighs/atom = 0.59072742
Neighbor list builds = 164
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 29

#variable lat0 equal 1                    #
variable lat1 equal 3+(v_ind*0.01)        # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 250*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 3.29                                                               
Lattice spacing in x,y,z = 3.29 3.29 3.29

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -1233.75 ${n1e1} -100 100 -100 100 units box
region box block -1233.75 1233.75 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -1233.75 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -1233.75 1233.75 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-1233.75 -100 -100) to (1233.75 100 100)
  2 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 750 atoms
  using lattice units in orthogonal box = (-1233.75 -100 -100) to (1233.75 100 100)
  create_atoms CPU = 0.000 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -750 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -750 750 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 501 atoms
  using lattice units in orthogonal box = (-1233.75 -100 -100) to (1233.75 100 100)
  create_atoms CPU = 0.000 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  750 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  750 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  501 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  501 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
750 atoms in group substrate
group slider1 region slider1
501 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 501 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_29_*.dump id type diameter mass xu yu zu fx fy fz

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 1592 130 130
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 68.54 | 68.54 | 68.54 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   2467.5         200            200            0              0              0              0              0              0              0              0              0              6            
    100000   2467.5         200            200            0.0041336919  -1.0230403e-36  0              0.012401076    293813.49      0              5.6748807e+10  0              0              3.325218     
    200000   2467.5         200            200            0.0014805835  -3.0691242e-36  0              0.0044417504   72845.707      0              1.4069834e+10  0              0              3.0719422    
    300000   2467.5         200            200            0.00013623437  2.0460869e-36  0              0.00040870311  1241.5053      0              2.3979138e+08  0              0              3.0454037    
    400000   2467.5         200            200            0.016885657    0.0002631225   0              0.050393847    3470.1378      0              6.7024213e+08  0              0              2.9923988    
    500000   2467.5         200            200            0.00060126319 -9.3600938e-05  0              0.0018973905   150.15537      0              29001862       0              0              2.9984596    
    600000   2467.5         200            200            0.0051275778   0.00025208586  0              0.015130647    114.37993      0              22091991       0              0              2.9957788    
    700000   2467.5         200            200            0.0044352636   0.00059630121  0              0.012709489    0.35405312     0              68383.832      0              0              2.9961101    
    800000   2467.5         200            200            0.0053798416   0.00079357822  0              0.015345947    2.0050322      0              387263.31      0              0              2.9957306    
    900000   2467.5         200            200            0.00544851     0.00080520238  0              0.015540328    0.027141964    0              5242.3532      0              0              2.9957064    
   1000000   2467.5         200            200            0.0053099665   0.0007935435   0              0.015136356    0.025923694    0              5007.0497      0              0              2.9957619    
   1100000   2467.5         200            200            0.0053236217   0.00079501489  0              0.01517585     0.0029633308   0              572.35455      0              0              2.9957561    
   1200000   2467.5         200            200            0.0053396102   0.0007966117   0              0.015222219    0.00010841585  0              20.940054      0              0              2.9957498    
   1300000   2467.5         200            200            0.0053344381   0.00079608412  0              0.01520723     9.0672924e-05  0              17.513084      0              0              2.9957519    
   1400000   2467.5         200            200            0.0053333569   0.00079597893  0              0.015204092    3.3383807e-07  0              0.064479383    0              0              2.9957523    
   1500000   2467.5         200            200            0.0053342805   0.00079607222  0              0.015206769    1.3583895e-06  0              0.26236707     0              0              2.9957519    
   1600000   2467.5         200            200            0.0053342341   0.00079606699  0              0.015206635    1.0292694e-07  0              0.019879894    0              0              2.9957519    
   1700000   2467.5         200            200            0.0053341191   0.00079605549  0              0.015206302    8.1999292e-09  0              0.0015837809   0              0              2.995752     
   1800000   2467.5         200            200            0.0053341493   0.00079605859  0              0.015206389    3.8673299e-09  0              0.00074695808  0              0              2.995752     
   1900000   2467.5         200            200            0.0053341585   0.0007960595   0              0.015206416    5.2852765e-13  0              1.0208283e-07  0              0              2.9957519    
   2000000   2467.5         200            200            0.0053341525   0.00079605889  0              0.015206399    6.7997406e-11  0              1.3133406e-05  0              0              2.995752     
   2100000   2467.5         200            200            0.0053341525   0.00079605889  0              0.015206399    3.2996537e-12  0              6.3731388e-07  0              0              2.995752     
   2200000   2467.5         200            200            0.0053341534   0.00079605898  0              0.015206401    5.4057986e-13  0              1.0441067e-07  0              0              2.995752     
   2300000   2467.5         200            200            0.0053341532   0.00079605896  0              0.015206401    1.5892661e-13  0              3.0695989e-08  0              0              2.995752     
   2400000   2467.5         200            200            0.0053341531   0.00079605895  0              0.0152064      2.4807282e-16  0              4.7914194e-11  0              0              2.995752     
   2500000   2467.5         200            200            0.0053341531   0.00079605895  0              0.0152064      3.2836507e-15  0              6.3422296e-10  0              0              2.995752     
   2600000   2467.5         200            200            0.0053341532   0.00079605895  0              0.0152064      9.4815404e-17  0              1.8313186e-11  0              0              2.995752     
   2700000   2467.5         200            200            0.0053341531   0.00079605895  0              0.0152064      2.0976436e-17  0              4.0515081e-12  0              0              2.995752     
   2800000   2467.5         200            200            0.0053341531   0.00079605895  0              0.0152064      7.3417714e-18  0              1.4180315e-12  0              0              2.995752     
   2900000   2467.5         200            200            0.0053341531   0.00079605895  0              0.0152064      1.0956153e-20  0              2.1161336e-15  0              0              2.995752     
   3000000   2467.5         200            200            0.0053341531   0.00079605895  0              0.0152064      1.4204241e-19  0              2.7434879e-14  0              0              2.995752     
Loop time of 180.877 on 2 procs for 3000000 steps with 1251 atoms

Performance: 14330208.133 ns/day, 0.000 hours/ns, 16585.889 timesteps/s
99.9% CPU use with 2 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 41.429     | 41.584     | 41.738     |   2.4 | 22.99
Neigh   | 3.0926     | 3.093      | 3.0933     |   0.0 |  1.71
Comm    | 13.938     | 13.982     | 14.026     |   1.2 |  7.73
Output  | 0.214      | 0.21403    | 0.21406    |   0.0 |  0.12
Modify  | 109.1      | 109.21     | 109.32     |   1.1 | 60.38
Other   |            | 12.79      |            |       |  7.07

Nlocal:          625.5 ave         626 max         625 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Nghost:            2.5 ave           3 max           2 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Neighs:          369.5 ave         370 max         369 min
Histogram: 1 0 0 0 0 0 0 0 0 1

Total # of neighbors = 739
Ave neighs/atom = 0.59072742
Neighbor list builds = 164
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 30

#variable lat0 equal 1                    #
variable lat1 equal 3+(v_ind*0.01)        # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 250*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 3.3                                                               
Lattice spacing in x,y,z = 3.3 3.3 3.3

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -1237.5 ${n1e1} -100 100 -100 100 units box
region box block -1237.5 1237.5 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -1237.5 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -1237.5 1237.5 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-1237.5 -100 -100) to (1237.5 100 100)
  2 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 750 atoms
  using lattice units in orthogonal box = (-1237.5 -100 -100) to (1237.5 100 100)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -750 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -750 750 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 501 atoms
  using lattice units in orthogonal box = (-1237.5 -100 -100) to (1237.5 100 100)
  create_atoms CPU = 0.000 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  750 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  750 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  501 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  501 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
750 atoms in group substrate
group slider1 region slider1
501 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 501 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_30_*.dump id type diameter mass xu yu zu fx fy fz

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 1597 130 130
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 68.74 | 68.74 | 68.74 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   2475           200            200            0              0              0              0              0              0              0              0              0              6            
    100000   2475           200            200            0.0041212984  -7.6495593e-37  0              0.012363895    293849.6       0              5.6755782e+10  0              0              3.3248424    
    200000   2475           200            200            0.0014739496  -1.2749264e-37  0              0.0044218488   72687.917      0              1.4039357e+10  0              0              3.0718904    
    300000   2475           200            200            7.067498e-05   8.8392438e-43  0              0.00021202494  356.29759      0              68817342       0              0              3.0472228    
    400000   2475           200            200            0.00018048668  1.3662339e-43  0              0.00054146005  2161.0533      0              4.1739811e+08  0              0              3.0044101    
    500000   2475           200            200            0.011875858    1.1474342e-36  0              0.035627574    78.651001      0              15191101       0              0              2.9944484    
    600000   2475           200            200            0.0028098416  -2.0717558e-37  0              0.0084295249   1.3254431      0              256003.62      0              0              2.9978795    
    700000   2475           200            200            0.0053741524  -9.5619503e-38  0              0.016122457    13.799975      0              2665405.6      0              0              2.9967298    
    800000   2475           200            200            0.0053459308   1.5936584e-37  0              0.016037792    0.45649811     0              88170.64       0              0              2.9967475    
    900000   2475           200            200            0.004995702    1.1155609e-37  0              0.014987106    0.21564525     0              41650.949      0              0              2.996891     
   1000000   2475           200            200            0.0050186243   2.2741061e-47  0              0.015055873    0.011898178    0              2298.0817      0              0              2.9968807    
   1100000   2475           200            200            0.0050647552  -1.5936584e-38  0              0.015194266    0.0034362278   0              663.69258      0              0              2.9968616    
   1200000   2475           200            200            0.0050599163  -8.7651212e-38  0              0.015179749    0.00028827593  0              55.679253      0              0              2.9968637    
   1300000   2475           200            200            0.0050538691   4.7809752e-38  0              0.015161607    5.2809772e-05  0              10.19998       0              0              2.9968662    
   1400000   2475           200            200            0.0050547532   8.5745994e-48  0              0.01516426     6.6017966e-06  0              1.2751085      0              0              2.9968659    
   1500000   2475           200            200            0.0050555361  -4.7809752e-38  0              0.015166608    7.8049562e-07  0              0.15074936     0              0              2.9968655    
   1600000   2475           200            200            0.0050553869  -3.984146e-38   0              0.015166161    1.4488026e-07  0              0.027982997    0              0              2.9968656    
   1700000   2475           200            200            0.0050552868  -1.1952438e-38  0              0.015165861    1.0982311e-08  0              0.0021211859   0              0              2.9968656    
   1800000   2475           200            200            0.0050553108  -3.984146e-38   0              0.015165932    3.0683255e-09  0              0.00059263383  0              0              2.9968656    
   1900000   2475           200            200            0.0050553234   3.1873168e-38  0              0.01516597     1.4499085e-10  0              2.8004357e-05  0              0              2.9968656    
   2000000   2475           200            200            0.0050553197   6.3746336e-38  0              0.015165959    6.3020327e-11  0              1.2172104e-05  0              0              2.9968656    
   2100000   2475           200            200            0.0050553181  -4.7809752e-38  0              0.015165954    1.7521607e-12  0              3.3842228e-07  0              0              2.9968656    
   2200000   2475           200            200            0.0050553187   6.3746336e-38  0              0.015165956    1.2596082e-12  0              2.4328789e-07  0              0              2.9968656    
   2300000   2475           200            200            0.0050553189   6.3746336e-38  0              0.015165957    1.8450233e-14  0              3.5635829e-09  0              0              2.9968656    
   2400000   2475           200            200            0.0050553188   4.7809752e-38  0              0.015165956    2.4550585e-14  0              4.7418395e-09  0              0              2.9968656    
   2500000   2475           200            200            0.0050553188   6.3746336e-38  0              0.015165956    1.3040942e-16  0              2.5188017e-11  0              0              2.9968656    
   2600000   2475           200            200            0.0050553188   3.984146e-39   0              0.015165956    4.5996641e-16  0              8.8840528e-11  0              0              2.9968656    
   2700000   2475           200            200            0.0050553188  -2.7889022e-38  0              0.015165956    5.4372311e-19  0              1.0501777e-13  0              0              2.9968656    
   2800000   2475           200            200            0.0050553188   2.3904876e-38  0              0.015165956    6.5532152e-18  0              1.2657252e-12  0              0              2.9968656    
   2900000   2475           200            200            0.0050553188   4.4622435e-37  0              0.015165956    1.834456e-18   0              3.5431726e-13  0              0              2.9968656    
   3000000   2475           200            200            0.0050553188  -8.2870236e-37  0              0.015165956    3.4055897e-18  0              6.5777495e-13  0              0              2.9968656    
Loop time of 178.668 on 2 procs for 3000000 steps with 1251 atoms

Performance: 14507384.148 ns/day, 0.000 hours/ns, 16790.954 timesteps/s
99.9% CPU use with 2 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 40.138     | 40.203     | 40.268     |   1.0 | 22.50
Neigh   | 3.1303     | 3.1309     | 3.1315     |   0.0 |  1.75
Comm    | 13.445     | 13.539     | 13.633     |   2.6 |  7.58
Output  | 0.21361    | 0.21364    | 0.21368    |   0.0 |  0.12
Modify  | 108.83     | 108.87     | 108.91     |   0.4 | 60.93
Other   |            | 12.71      |            |       |  7.11

Nlocal:          625.5 ave         626 max         625 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Nghost:            2.5 ave           3 max           2 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Neighs:          362.5 ave         363 max         362 min
Histogram: 1 0 0 0 0 0 0 0 0 1

Total # of neighbors = 725
Ave neighs/atom = 0.57953637
Neighbor list builds = 164
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 31

#variable lat0 equal 1                    #
variable lat1 equal 3+(v_ind*0.01)        # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 250*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 3.31                                                               
Lattice spacing in x,y,z = 3.31 3.31 3.31

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -1241.25 ${n1e1} -100 100 -100 100 units box
region box block -1241.25 1241.25 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -1241.25 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -1241.25 1241.25 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-1241.25 -100 -100) to (1241.25 100 100)
  2 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 750 atoms
  using lattice units in orthogonal box = (-1241.25 -100 -100) to (1241.25 100 100)
  create_atoms CPU = 0.000 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -750 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -750 750 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 501 atoms
  using lattice units in orthogonal box = (-1241.25 -100 -100) to (1241.25 100 100)
  create_atoms CPU = 0.000 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  750 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  750 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  501 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  501 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
750 atoms in group substrate
group slider1 region slider1
501 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 501 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_31_*.dump id type diameter mass xu yu zu fx fy fz

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 1602 130 130
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 68.88 | 68.88 | 68.88 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   2482.5         200            200            0              0              0              0              0              0              0              0              0              6            
    100000   2482.5         200            200            0.0041076494   1.0937348e-40  0              0.012322948    293701.68      0              5.6727212e+10  0              0              3.3253606    
    200000   2482.5         200            200            0.0014689234  -1.2202264e-35  0              0.0044067702   72636.458      0              1.4029418e+10  0              0              3.0722655    
    300000   2482.5         200            200            0.00013026443  2.9733075e-41  0              0.00039079329  1154.0403      0              2.2289791e+08  0              0              3.0454575    
    400000   2482.5         200            200            0.014579111    0.0038726318   0              0.039864702    4257.3675      0              8.2229216e+08  0              0              2.9931577    
    500000   2482.5         200            200            0.0015831226   0.00023843464  0              0.0045109333   459.04588      0              88662730       0              0              2.997628     
    600000   2482.5         200            200            0.003028688    0.00029870592  0              0.008787358    0.4430621      0              85575.533      0              0              2.9967337    
    700000   2482.5         200            200            0.006566394    0.0019975032   0              0.017701679    0.42555382     0              82193.885      0              0              2.9953604    
    800000   2482.5         200            200            0.0052818622   0.0016508034   0              0.014194783    0.00099257     0              191.71061      0              0              2.9958414    
    900000   2482.5         200            200            0.0057253165   0.0017188431   0              0.015457106    0.0016160522   0              312.13352      0              0              2.9956605    
   1000000   2482.5         200            200            0.0055643003   0.0017015522   0              0.014991349    0.0013475643   0              260.27622      0              0              2.9957262    
   1100000   2482.5         200            200            0.0056220594   0.0017084594   0              0.015157719    0.00056602527  0              109.32534      0              0              2.9957025    
   1200000   2482.5         200            200            0.0056018185   0.0017060004   0              0.015099455    0.00015410512  0              29.764738      0              0              2.9957108    
   1300000   2482.5         200            200            0.0056086995   0.0017068774   0              0.015119221    3.3782572e-05  0              6.5249579      0              0              2.9957079    
   1400000   2482.5         200            200            0.0056064406   0.0017065885   0              0.015112733    6.4661505e-06  0              1.2489091      0              0              2.9957089    
   1500000   2482.5         200            200            0.0056071512   0.0017066799   0              0.015114774    1.1266351e-06  0              0.2176047      0              0              2.9957086    
   1600000   2482.5         200            200            0.0056069403   0.0017066526   0              0.015114168    1.82518e-07    0              0.035252564    0              0              2.9957087    
   1700000   2482.5         200            200            0.0056069975   0.0017066601   0              0.015114332    2.7835446e-08  0              0.0053762964   0              0              2.9957086    
   1800000   2482.5         200            200            0.0056069845   0.0017066583   0              0.015114295    4.0242945e-09  0              0.00077727512  0              0              2.9957087    
   1900000   2482.5         200            200            0.0056069862   0.0017066586   0              0.0151143      5.5352836e-10  0              0.00010691161  0              0              2.9957087    
   2000000   2482.5         200            200            0.0056069867   0.0017066586   0              0.015114301    7.2501158e-11  0              1.4003286e-05  0              0              2.9957087    
   2100000   2482.5         200            200            0.0056069861   0.0017066585   0              0.0151143      9.0279956e-12  0              1.7437184e-06  0              0              2.9957087    
   2200000   2482.5         200            200            0.0056069865   0.0017066586   0              0.015114301    1.0647251e-12  0              2.0564706e-07  0              0              2.9957087    
   2300000   2482.5         200            200            0.0056069863   0.0017066586   0              0.0151143      1.1769294e-13  0              2.2731884e-08  0              0              2.9957087    
   2400000   2482.5         200            200            0.0056069864   0.0017066586   0              0.015114301    1.205988e-14   0              2.3293139e-09  0              0              2.9957087    
   2500000   2482.5         200            200            0.0056069863   0.0017066586   0              0.0151143      1.1131458e-15  0              2.149993e-10   0              0              2.9957087    
   2600000   2482.5         200            200            0.0056069863   0.0017066586   0              0.0151143      9.6658031e-17  0              1.8669082e-11  0              0              2.9957087    
   2700000   2482.5         200            200            0.0056069863   0.0017066586   0              0.0151143      1.4124508e-17  0              2.7280878e-12  0              0              2.9957087    
   2800000   2482.5         200            200            0.0056069863   0.0017066586   0              0.0151143      9.72272e-19    0              1.8779014e-13  0              0              2.9957087    
   2900000   2482.5         200            200            0.0056069863   0.0017066586   0              0.0151143      4.6069306e-20  0              8.8980876e-15  0              0              2.9957087    
   3000000   2482.5         200            200            0.0056069863   0.0017066586   0              0.0151143      7.4429153e-20  0              1.437567e-14   0              0              2.9957087    
Loop time of 179.964 on 2 procs for 3000000 steps with 1251 atoms

Performance: 14402854.573 ns/day, 0.000 hours/ns, 16669.971 timesteps/s
99.9% CPU use with 2 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 41.628     | 41.684     | 41.741     |   0.9 | 23.16
Neigh   | 3.1402     | 3.1402     | 3.1402     |   0.0 |  1.74
Comm    | 13.46      | 13.509     | 13.558     |   1.3 |  7.51
Output  | 0.2157     | 0.21573    | 0.21575    |   0.0 |  0.12
Modify  | 108.66     | 108.67     | 108.68     |   0.1 | 60.38
Other   |            | 12.75      |            |       |  7.08

Nlocal:          625.5 ave         626 max         625 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Nghost:            2.5 ave           3 max           2 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Neighs:          369.5 ave         370 max         369 min
Histogram: 1 0 0 0 0 0 0 0 0 1

Total # of neighbors = 739
Ave neighs/atom = 0.59072742
Neighbor list builds = 164
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 32

#variable lat0 equal 1                    #
variable lat1 equal 3+(v_ind*0.01)        # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 250*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 3.32                                                               
Lattice spacing in x,y,z = 3.32 3.32 3.32

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -1245 ${n1e1} -100 100 -100 100 units box
region box block -1245 1245 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -1245 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -1245 1245 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-1245 -100 -100) to (1245 100 100)
  2 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 750 atoms
  using lattice units in orthogonal box = (-1245 -100 -100) to (1245 100 100)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -750 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -750 750 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 501 atoms
  using lattice units in orthogonal box = (-1245 -100 -100) to (1245 100 100)
  create_atoms CPU = 0.000 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  750 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  750 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  501 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  501 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
750 atoms in group substrate
group slider1 region slider1
501 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 501 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_32_*.dump id type diameter mass xu yu zu fx fy fz

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 1607 130 130
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 69.09 | 69.09 | 69.09 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   2490           200            200            0              0              0              0              0              0              0              0              0              6            
    100000   2490           200            200            0.0040959021   1.1564189e-42  0              0.012287706    293769.88      0              5.6740385e+10  0              0              3.325238     
    200000   2490           200            200            0.0014657041  -2.0275909e-36  0              0.0043971123   72729.855      0              1.4047458e+10  0              0              3.0721124    
    300000   2490           200            200            0.00012989224 -1.0137962e-36  0              0.00038967673  1154.3343      0              2.229547e+08   0              0              3.0455232    
    400000   2490           200            200            0.014072382    0.0032962498   0              0.038920896    4296.2041      0              8.2979328e+08  0              0              2.9932847    
    500000   2490           200            200            0.0013611074  -0.00039445515  0              0.0044777773   475.76715      0              91892372       0              0              2.997664     
    600000   2490           200            200            0.0029126208  -0.00049902111  0              0.0092368834   18.895759      0              3649634.2      0              0              2.9967352    
    700000   2490           200            200            0.0060956687   0.00061293641  0              0.01767407     0.019814193    0              3827.0258      0              0              2.995441     
    800000   2490           200            200            0.0050614625   0.00055944034  0              0.014624947    1.5500691      0              299389.15      0              0              2.9958593    
    900000   2490           200            200            0.0051073935   0.00056237329  0              0.014759807    0.036680774    0              7084.7332      0              0              2.9958417    
   1000000   2490           200            200            0.0052211032   0.00057013619  0              0.015093173    0.035530016    0              6862.4693      0              0              2.9957927    
   1100000   2490           200            200            0.0052283553   0.000570655    0              0.015114411    1.1436743e-08  0              0.0022089575   0              0              2.9957893    
   1200000   2490           200            200            0.0052139532   0.00056971789  0              0.015072142    0.00064859537  0              125.2734       0              0              2.9957954    
   1300000   2490           200            200            0.0052110107   0.0005695187   0              0.015063513    1.2030037e-05  0              2.3235498      0              0              2.9957967    
   1400000   2490           200            200            0.0052125526   0.00056961881  0              0.015068039    8.791052e-06   0              1.6979538      0              0              2.9957961    
   1500000   2490           200            200            0.005213161    0.0005696594   0              0.015069823    7.6380797e-07  0              0.14752621     0              0              2.9957958    
   1600000   2490           200            200            0.0052130359   0.00056965144  0              0.015069456    7.8907911e-08  0              0.015240722    0              0              2.9957959    
   1700000   2490           200            200            0.0052129367   0.00056964487  0              0.015069165    2.4476286e-08  0              0.004727489    0              0              2.9957959    
   1800000   2490           200            200            0.00521294     0.00056964505  0              0.015069175    2.7358394e-10  0              5.2841557e-05  0              0              2.9957959    
   1900000   2490           200            200            0.0052129538   0.00056964596  0              0.015069216    5.4714833e-10  0              0.00010567934  0              0              2.9957959    
   2000000   2490           200            200            0.0052129553   0.00056964606  0              0.01506922     9.3107188e-13  0              1.7983252e-07  0              0              2.9957959    
   2100000   2490           200            200            0.0052129536   0.00056964595  0              0.015069215    9.1596109e-12  0              1.7691393e-06  0              0              2.9957959    
   2200000   2490           200            200            0.0052129532   0.00056964592  0              0.015069214    2.9639969e-13  0              5.724832e-08   0              0              2.9957959    
   2300000   2490           200            200            0.0052129533   0.00056964593  0              0.015069214    1.1147368e-13  0              2.153066e-08   0              0              2.9957959    
   2400000   2490           200            200            0.0052129534   0.00056964594  0              0.015069214    1.4369517e-14  0              2.7754101e-09  0              0              2.9957959    
   2500000   2490           200            200            0.0052129534   0.00056964594  0              0.015069214    7.9185491e-16  0              1.5294336e-10  0              0              2.9957959    
   2600000   2490           200            200            0.0052129534   0.00056964594  0              0.015069214    4.0793843e-16  0              7.8791548e-11  0              0              2.9957959    
   2700000   2490           200            200            0.0052129534   0.00056964594  0              0.015069214    2.1680091e-20  0              4.187416e-15   0              0              2.9957959    
   2800000   2490           200            200            0.0052129534   0.00056964594  0              0.015069214    7.3152309e-18  0              1.4129053e-12  0              0              2.9957959    
   2900000   2490           200            200            0.0052129534   0.00056964594  0              0.015069214    2.7052026e-19  0              5.2249821e-14  0              0              2.9957959    
   3000000   2490           200            200            0.0052129534   0.00056964593  0              0.015069214    1.3728225e-18  0              2.6515474e-13  0              0              2.9957959    
Loop time of 179.268 on 2 procs for 3000000 steps with 1251 atoms

Performance: 14458794.917 ns/day, 0.000 hours/ns, 16734.716 timesteps/s
99.9% CPU use with 2 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 40.883     | 41         | 41.117     |   1.8 | 22.87
Neigh   | 3.1907     | 3.1916     | 3.1925     |   0.1 |  1.78
Comm    | 13.524     | 13.531     | 13.539     |   0.2 |  7.55
Output  | 0.2134     | 0.21343    | 0.21346    |   0.0 |  0.12
Modify  | 108.59     | 108.6      | 108.62     |   0.1 | 60.58
Other   |            | 12.73      |            |       |  7.10

Nlocal:          625.5 ave         626 max         625 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Nghost:            2.5 ave           3 max           2 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Neighs:          368.5 ave         369 max         368 min
Histogram: 1 0 0 0 0 0 0 0 0 1

Total # of neighbors = 737
Ave neighs/atom = 0.5891287
Neighbor list builds = 166
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 33

#variable lat0 equal 1                    #
variable lat1 equal 3+(v_ind*0.01)        # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 250*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 3.33                                                               
Lattice spacing in x,y,z = 3.33 3.33 3.33

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -1248.75 ${n1e1} -100 100 -100 100 units box
region box block -1248.75 1248.75 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -1248.75 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -1248.75 1248.75 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-1248.75 -100 -100) to (1248.75 100 100)
  2 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 750 atoms
  using lattice units in orthogonal box = (-1248.75 -100 -100) to (1248.75 100 100)
  create_atoms CPU = 0.000 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -750 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -750 750 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 501 atoms
  using lattice units in orthogonal box = (-1248.75 -100 -100) to (1248.75 100 100)
  create_atoms CPU = 0.000 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  750 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  750 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  501 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  501 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
750 atoms in group substrate
group slider1 region slider1
501 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 501 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_33_*.dump id type diameter mass xu yu zu fx fy fz

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 1612 130 130
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 69.23 | 69.23 | 69.23 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   2497.5         200            200            0              0              0              0              0              0              0              0              0              6            
    100000   2497.5         200            200            0.0040819885  -2.5268811e-37  0              0.012245966    293597.67      0              5.6707123e+10  0              0              3.3254856    
    200000   2497.5         200            200            0.0014566887   1.5161297e-36  0              0.0043700662   72370.497      0              1.3978049e+10  0              0              3.0727392    
    300000   2497.5         200            200            0.00011936942  6.3172055e-38  0              0.00035810825  989.47259      0              1.9111236e+08  0              0              3.045727     
    400000   2497.5         200            200            0.007897646    0.001663896    0              0.022029042    5119.1912      0              9.8874968e+08  0              0              2.9950247    
    500000   2497.5         200            200            0.0044612341   0.00090297468  0              0.012480727    815.29896      0              1.5747148e+08  0              0              2.9961598    
    600000   2497.5         200            200            0.0039304071   0.0007734824   0              0.011017739    71.665488      0              13841880       0              0              2.9964308    
    700000   2497.5         200            200            0.0056390899   0.00096813765  0              0.015949132    13.37476       0              2583277.1      0              0              2.9957036    
    800000   2497.5         200            200            0.0050824984   0.00092087498  0              0.01432662     0.90648089     0              175082.87      0              0              2.9959255    
    900000   2497.5         200            200            0.0054386937   0.00095426243  0              0.015361819    0.010617206    0              2050.6674      0              0              2.9957798    
   1000000   2497.5         200            200            0.0052827113   0.00094168886  0              0.014906445    0.0044443251   0              858.40222      0              0              2.9958439    
   1100000   2497.5         200            200            0.0053327908   0.00094588942  0              0.015052483    0.0031127122   0              601.20693      0              0              2.9958231    
   1200000   2497.5         200            200            0.0053224218   0.00094501279  0              0.015022253    0.00067240231  0              129.8716       0              0              2.9958275    
   1300000   2497.5         200            200            0.0053221514   0.00094500094  0              0.015021453    7.5904562e-05  0              14.660639      0              0              2.9958275    
   1400000   2497.5         200            200            0.005323722    0.00094512714  0              0.015026039    3.8263952e-06  0              0.73905172     0              0              2.9958269    
   1500000   2497.5         200            200            0.0053227748   0.00094504971  0              0.015023275    2.3808659e-09  0              0.00045985397  0              0              2.9958273    
   1600000   2497.5         200            200            0.0053231561   0.00094508118  0              0.015024387    5.4562916e-08  0              0.010538592    0              0              2.9958271    
   1700000   2497.5         200            200            0.0053230452   0.00094507193  0              0.015024064    2.338352e-08   0              0.004516426    0              0              2.9958272    
   1800000   2497.5         200            200            0.0053230632   0.00094507347  0              0.015024116    4.127956e-09   0              0.0007972969   0              0              2.9958272    
   1900000   2497.5         200            200            0.0053230669   0.00094507375  0              0.015024127    3.8406825e-10  0              7.4181125e-05  0              0              2.9958272    
   2000000   2497.5         200            200            0.0053230621   0.00094507337  0              0.015024113    1.2961951e-11  0              2.503545e-06   0              0              2.9958272    
   2100000   2497.5         200            200            0.0053230646   0.00094507357  0              0.01502412     1.5305526e-13  0              2.9561962e-08  0              0              2.9958272    
   2200000   2497.5         200            200            0.0053230637   0.0009450735   0              0.015024118    5.3479946e-13  0              1.0329421e-07  0              0              2.9958272    
   2300000   2497.5         200            200            0.0053230639   0.00094507352  0              0.015024118    1.6408098e-13  0              3.1691533e-08  0              0              2.9958272    
   2400000   2497.5         200            200            0.0053230639   0.00094507352  0              0.015024118    2.4064934e-14  0              4.6480382e-09  0              0              2.9958272    
   2500000   2497.5         200            200            0.0053230639   0.00094507351  0              0.015024118    1.8060891e-15  0              3.4883831e-10  0              0              2.9958272    
   2600000   2497.5         200            200            0.0053230639   0.00094507352  0              0.015024118    3.4163151e-17  0              6.5984651e-12  0              0              2.9958272    
   2700000   2497.5         200            200            0.0053230639   0.00094507351  0              0.015024118    7.7063253e-19  0              1.4884435e-13  0              0              2.9958272    
   2800000   2497.5         200            200            0.0053230639   0.00094507351  0              0.015024118    2.1439369e-18  0              4.1409215e-13  0              0              2.9958272    
   2900000   2497.5         200            200            0.0053230639   0.00094507351  0              0.015024118    3.7490048e-18  0              7.241041e-13   0              0              2.9958272    
   3000000   2497.5         200            200            0.0053230639   0.00094507351  0              0.015024118    3.6346035e-18  0              7.0200797e-13  0              0              2.9958272    
Loop time of 179.884 on 2 procs for 3000000 steps with 1251 atoms

Performance: 14409305.435 ns/day, 0.000 hours/ns, 16677.437 timesteps/s
99.9% CPU use with 2 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 40.927     | 41.124     | 41.322     |   3.1 | 22.86
Neigh   | 3.1418     | 3.1424     | 3.143      |   0.0 |  1.75
Comm    | 14.059     | 14.077     | 14.095     |   0.5 |  7.83
Output  | 0.21663    | 0.21666    | 0.21669    |   0.0 |  0.12
Modify  | 108.44     | 108.59     | 108.74     |   1.4 | 60.37
Other   |            | 12.73      |            |       |  7.08

Nlocal:          625.5 ave         626 max         625 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Nghost:            2.5 ave           3 max           2 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Neighs:          369.5 ave         370 max         369 min
Histogram: 1 0 0 0 0 0 0 0 0 1

Total # of neighbors = 739
Ave neighs/atom = 0.59072742
Neighbor list builds = 164
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 34

#variable lat0 equal 1                    #
variable lat1 equal 3+(v_ind*0.01)        # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 250*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 3.34                                                               
Lattice spacing in x,y,z = 3.34 3.34 3.34

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -1252.5 ${n1e1} -100 100 -100 100 units box
region box block -1252.5 1252.5 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -1252.5 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -1252.5 1252.5 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-1252.5 -100 -100) to (1252.5 100 100)
  2 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 750 atoms
  using lattice units in orthogonal box = (-1252.5 -100 -100) to (1252.5 100 100)
  create_atoms CPU = 0.000 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -750 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -750 750 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 501 atoms
  using lattice units in orthogonal box = (-1252.5 -100 -100) to (1252.5 100 100)
  create_atoms CPU = 0.000 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  750 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  750 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  501 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  501 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
750 atoms in group substrate
group slider1 region slider1
501 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 501 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_34_*.dump id type diameter mass xu yu zu fx fy fz

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 1617 130 130
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 69.44 | 69.44 | 69.44 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   2505           200            200            0              0              0              0              0              0              0              0              0              6            
    100000   2505           200            200            0.0040701909  -5.0386276e-37  0              0.012210573    293641.22      0              5.6715535e+10  0              0              3.3254496    
    200000   2505           200            200            0.0014543199   7.068366e-43   0              0.0043629596   72526.616      0              1.4008203e+10  0              0              3.0724454    
    300000   2505           200            200            0.00012612052  4.0309098e-36  0              0.00037836156  1104.3466      0              2.1329977e+08  0              0              3.0455053    
    400000   2505           200            200            0.013729367    0.0072951965   0              0.033892905    4598.0088      0              8.8808555e+08  0              0              2.9936481    
    500000   2505           200            200            0.0028038907   0.0010147241   0              0.0073969479   666.18         0              1.2866979e+08  0              0              2.9969471    
    600000   2505           200            200            0.0034334681   0.0013361218   0              0.0089642824   12.614732      0              2436481.1      0              0              2.9966864    
    700000   2505           200            200            0.0066749223   0.0028551283   0              0.017169639    4.3310188      0              836517.58      0              0              2.9954277    
    800000   2505           200            200            0.0056380501   0.0026048577   0              0.014309293    0.94781325     0              183066.04      0              0              2.9958223    
    900000   2505           200            200            0.005922028    0.0026527555   0              0.015113328    0.23218619     0              44845.761      0              0              2.9957072    
   1000000   2505           200            200            0.0058795659   0.0026475174   0              0.01499118     0.03654884     0              7059.2507      0              0              2.9957237    
   1100000   2505           200            200            0.0058652663   0.0026453537   0              0.014950445    0.0030322403   0              585.66414      0              0              2.99573      
   1200000   2505           200            200            0.00588064     0.0026476754   0              0.014994245    8.2595768e-05  0              15.953016      0              0              2.9957235    
   1300000   2505           200            200            0.0058730349   0.0026465355   0              0.014972569    2.5738117e-06  0              0.49712062     0              0              2.9957267    
   1400000   2505           200            200            0.0058757797   0.0026469634   0              0.014980376    5.0282686e-06  0              0.97118839     0              0              2.9957256    
   1500000   2505           200            200            0.0058750622   0.0026468504   0              0.014978336    1.4627626e-06  0              0.28252628     0              0              2.9957258    
   1600000   2505           200            200            0.0058751475   0.0026468631   0              0.014978579    2.1769571e-07  0              0.042046987    0              0              2.9957258    
   1700000   2505           200            200            0.0058751901   0.0026468703   0              0.0149787      1.7816676e-08  0              0.0034412141   0              0              2.9957258    
   1800000   2505           200            200            0.0058751515   0.002646864    0              0.01497859     4.7968326e-10  0              9.2648752e-05  0              0              2.9957258    
   1900000   2505           200            200            0.0058751703   0.002646867    0              0.014978644    1.6754262e-11  0              3.2360134e-06  0              0              2.9957258    
   2000000   2505           200            200            0.0058751636   0.0026468659   0              0.014978625    3.0931724e-11  0              5.9743289e-06  0              0              2.9957258    
   2100000   2505           200            200            0.0058751653   0.0026468662   0              0.01497863     8.9113681e-12  0              1.7211923e-06  0              0              2.9957258    
   2200000   2505           200            200            0.0058751651   0.0026468662   0              0.014978629    1.3175007e-12  0              2.5446958e-07  0              0              2.9957258    
   2300000   2505           200            200            0.005875165    0.0026468661   0              0.014978629    1.0686867e-13  0              2.0641222e-08  0              0              2.9957258    
   2400000   2505           200            200            0.0058751651   0.0026468662   0              0.014978629    2.8857084e-15  0              5.5736213e-10  0              0              2.9957258    
   2500000   2505           200            200            0.005875165    0.0026468662   0              0.014978629    9.614993e-17   0              1.8570944e-11  0              0              2.9957258    
   2600000   2505           200            200            0.0058751651   0.0026468662   0              0.014978629    1.9343732e-16  0              3.7361583e-11  0              0              2.9957258    
   2700000   2505           200            200            0.0058751651   0.0026468662   0              0.014978629    5.7554202e-17  0              1.1116346e-11  0              0              2.9957258    
   2800000   2505           200            200            0.0058751651   0.0026468662   0              0.014978629    6.6736775e-18  0              1.288992e-12   0              0              2.9957258    
   2900000   2505           200            200            0.0058751651   0.0026468662   0              0.014978629    1.3852634e-21  0              2.6755765e-16  0              0              2.9957258    
   3000000   2505           200            200            0.0058751651   0.0026468662   0              0.014978629    1.4720238e-19  0              2.8431504e-14  0              0              2.9957258    
Loop time of 180.621 on 2 procs for 3000000 steps with 1251 atoms

Performance: 14350492.860 ns/day, 0.000 hours/ns, 16609.367 timesteps/s
99.9% CPU use with 2 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 41.315     | 41.443     | 41.57      |   2.0 | 22.94
Neigh   | 3.1386     | 3.1394     | 3.1403     |   0.1 |  1.74
Comm    | 14.223     | 14.269     | 14.315     |   1.2 |  7.90
Output  | 0.21526    | 0.21529    | 0.21532    |   0.0 |  0.12
Modify  | 108.62     | 108.74     | 108.87     |   1.2 | 60.21
Other   |            | 12.81      |            |       |  7.09

Nlocal:          625.5 ave         626 max         625 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Nghost:            2.5 ave           3 max           2 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Neighs:          368.5 ave         369 max         368 min
Histogram: 1 0 0 0 0 0 0 0 0 1

Total # of neighbors = 737
Ave neighs/atom = 0.5891287
Neighbor list builds = 164
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 35

#variable lat0 equal 1                    #
variable lat1 equal 3+(v_ind*0.01)        # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 250*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 3.35                                                               
Lattice spacing in x,y,z = 3.35 3.35 3.35

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -1256.25 ${n1e1} -100 100 -100 100 units box
region box block -1256.25 1256.25 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -1256.25 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -1256.25 1256.25 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-1256.25 -100 -100) to (1256.25 100 100)
  2 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 750 atoms
  using lattice units in orthogonal box = (-1256.25 -100 -100) to (1256.25 100 100)
  create_atoms CPU = 0.000 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -750 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -750 750 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 501 atoms
  using lattice units in orthogonal box = (-1256.25 -100 -100) to (1256.25 100 100)
  create_atoms CPU = 0.000 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  750 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  750 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  501 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  501 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
750 atoms in group substrate
group slider1 region slider1
501 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 501 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_35_*.dump id type diameter mass xu yu zu fx fy fz

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 1621 130 130
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 69.58 | 69.58 | 69.58 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   2512.5         200            200            0              0              0              0              0              0              0              0              0              6            
    100000   2512.5         200            200            0.0040585762   4.4304023e-44  0              0.012175729    293699.67      0              5.6726823e+10  0              0              3.3253511    
    200000   2512.5         200            200            0.0014510013   2.5117966e-37  0              0.004353004    72606.217      0              1.4023577e+10  0              0              3.0723283    
    300000   2512.5         200            200            0.00012642241 -2.0094268e-36  0              0.00037926724  1115.5973      0              2.154728e+08   0              0              3.045545     
    400000   2512.5         200            200            0.012103343    0.001746824    0              0.034563205    4562.3463      0              8.8119749e+08  0              0              2.9936426    
    500000   2512.5         200            200            0.0019793074   0.00096794961  0              0.0049699725   521.30309      0              1.0068744e+08  0              0              2.9975136    
    600000   2512.5         200            200            0.0034879148   0.00074963117  0              0.0097141132   36.81235       0              7110146.6      0              0              2.9966156    
    700000   2512.5         200            200            0.0048032827   0.00071988018  0              0.013689968    11.859566      0              2290624        0              0              2.9959445    
    800000   2512.5         200            200            0.0053524739   0.00078792383  0              0.015269498    1.8027213      0              348187.84      0              0              2.9957259    
    900000   2512.5         200            200            0.0053388114   0.00077013335  0              0.015246301    0.053096601    0              10255.379      0              0              2.9957307    
   1000000   2512.5         200            200            0.0052752687   0.00076856792  0              0.015057238    0.0028283489   0              546.28338      0              0              2.995757     
   1100000   2512.5         200            200            0.0052424598   0.00076769262  0              0.014959687    0.0036138376   0              697.99714      0              0              2.9957704    
   1200000   2512.5         200            200            0.0052330138   0.00076743396  0              0.014931608    0.0006700341   0              129.41419      0              0              2.9957743    
   1300000   2512.5         200            200            0.0052322405   0.0007674143   0              0.014929307    3.7525447e-05  0              7.2478782      0              0              2.9957745    
   1400000   2512.5         200            200            0.0052330903   0.00076743873  0              0.014931832    1.5640005e-08  0              0.0030207995   0              0              2.9957742    
   1500000   2512.5         200            200            0.0052336624   0.0007674548   0              0.014933532    8.0287853e-07  0              0.15507252     0              0              2.9957739    
   1600000   2512.5         200            200            0.0052338624   0.00076746035  0              0.014934127    2.2665441e-07  0              0.043777321    0              0              2.9957739    
   1700000   2512.5         200            200            0.0052338952   0.00076746123  0              0.014934224    1.9860753e-08  0              0.0038360188   0              0              2.9957739    
   1800000   2512.5         200            200            0.0052338862   0.00076746097  0              0.014934198    1.7546833e-10  0              3.389095e-05   0              0              2.9957739    
   1900000   2512.5         200            200            0.0052338769   0.00076746071  0              0.01493417     1.3787663e-10  0              2.6630276e-05  0              0              2.9957739    
   2000000   2512.5         200            200            0.0052338729   0.0007674606   0              0.014934158    6.8042969e-11  0              1.3142206e-05  0              0              2.9957739    
   2100000   2512.5         200            200            0.005233872    0.00076746057  0              0.014934155    8.7177653e-12  0              1.6837987e-06  0              0              2.9957739    
   2200000   2512.5         200            200            0.0052338721   0.00076746057  0              0.014934156    2.6091532e-13  0              5.0394668e-08  0              0              2.9957739    
   2300000   2512.5         200            200            0.0052338722   0.00076746058  0              0.014934156    1.3894998e-14  0              2.683759e-09   0              0              2.9957739    
   2400000   2512.5         200            200            0.0052338723   0.00076746058  0              0.014934156    1.7888347e-14  0              3.4550571e-09  0              0              2.9957739    
   2500000   2512.5         200            200            0.0052338723   0.00076746058  0              0.014934156    3.3368185e-15  0              6.444921e-10   0              0              2.9957739    
   2600000   2512.5         200            200            0.0052338723   0.00076746058  0              0.014934156    1.9857176e-16  0              3.8353279e-11  0              0              2.9957739    
   2700000   2512.5         200            200            0.0052338723   0.00076746058  0              0.014934156    2.4237333e-18  0              4.6813362e-13  0              0              2.9957739    
   2800000   2512.5         200            200            0.0052338723   0.00076746058  0              0.014934156    5.7606888e-18  0              1.1126522e-12  0              0              2.9957739    
   2900000   2512.5         200            200            0.0052338723   0.00076746058  0              0.014934156    3.8955134e-18  0              7.524016e-13   0              0              2.9957739    
   3000000   2512.5         200            200            0.0052338723   0.00076746058  0              0.014934156    1.4300057e-18  0              2.7619943e-13  0              0              2.9957739    
Loop time of 180.003 on 2 procs for 3000000 steps with 1251 atoms

Performance: 14399769.699 ns/day, 0.000 hours/ns, 16666.400 timesteps/s
99.9% CPU use with 2 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 41.64      | 41.793     | 41.946     |   2.4 | 23.22
Neigh   | 3.1858     | 3.1862     | 3.1867     |   0.0 |  1.77
Comm    | 13.552     | 13.568     | 13.584     |   0.4 |  7.54
Output  | 0.2101     | 0.21013    | 0.21016    |   0.0 |  0.12
Modify  | 108.48     | 108.5      | 108.52     |   0.2 | 60.28
Other   |            | 12.74      |            |       |  7.08

Nlocal:          625.5 ave         626 max         625 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Nghost:            2.5 ave           3 max           2 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Neighs:          366.5 ave         367 max         366 min
Histogram: 1 0 0 0 0 0 0 0 0 1

Total # of neighbors = 733
Ave neighs/atom = 0.58593125
Neighbor list builds = 164
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 36

#variable lat0 equal 1                    #
variable lat1 equal 3+(v_ind*0.01)        # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 250*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 3.36                                                               
Lattice spacing in x,y,z = 3.36 3.36 3.36

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -1260 ${n1e1} -100 100 -100 100 units box
region box block -1260 1260 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -1260 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -1260 1260 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-1260 -100 -100) to (1260 100 100)
  2 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 750 atoms
  using lattice units in orthogonal box = (-1260 -100 -100) to (1260 100 100)
  create_atoms CPU = 0.000 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -750 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -750 750 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 501 atoms
  using lattice units in orthogonal box = (-1260 -100 -100) to (1260 100 100)
  create_atoms CPU = 0.000 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  750 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  750 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  501 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  501 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
750 atoms in group substrate
group slider1 region slider1
501 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 501 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_36_*.dump id type diameter mass xu yu zu fx fy fz

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 1626 130 130
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 69.72 | 69.72 | 69.72 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   2520           200            200            0              0              0              0              0              0              0              0              0              6            
    100000   2520           200            200            0.0040448256  -1.2521597e-37  0              0.012134477    293516.27      0              5.6691401e+10  0              0              3.3256648    
    200000   2520           200            200            0.0014435485   2.5043221e-37  0              0.0043306454   72361.614      0              1.3976333e+10  0              0              3.0726878    
    300000   2520           200            200            0.00012462829 -5.0086337e-37  0              0.00037388488  1092.1063      0              2.1093561e+08  0              0              3.0454051    
    400000   2520           200            200            0.0084049344   0.0015865943   0              0.023628209    5105.836       0              9.861702e+08   0              0              2.9947182    
    500000   2520           200            200            0.0017530905   0.00014450656  0              0.0051147651   586.40924      0              1.1326241e+08  0              0              2.9971856    
    600000   2520           200            200            0.0067348558   0.0015202987   0              0.018684269    86.515419      0              16710080       0              0              2.9951805    
    700000   2520           200            200            0.0044672762   0.0010436835   0              0.012358145    0.65499011     0              126508.51      0              0              2.9960128    
    800000   2520           200            200            0.0056556528   0.0011196085   0              0.01584735     0.11256112     0              21740.694      0              0              2.9955443    
    900000   2520           200            200            0.0052321488   0.0010973247   0              0.014599122    0.098887976    0              19099.786      0              0              2.9957056    
   1000000   2520           200            200            0.0053539389   0.0011041254   0              0.014957691    0.028176279    0              5442.1267      0              0              2.9956591    
   1100000   2520           200            200            0.0053281999   0.0011027469   0              0.014881853    0.0050581644   0              976.96262      0              0              2.9956687    
   1200000   2520           200            200            0.005329221    0.0011027843   0              0.014884879    0.00065388827  0              126.2957       0              0              2.9956685    
   1300000   2520           200            200            0.0053320108   0.0011029464   0              0.014893086    5.9837682e-05  0              11.55739       0              0              2.9956674    
   1400000   2520           200            200            0.0053299828   0.0011028316   0              0.014887117    3.2108647e-06  0              0.62016467     0              0              2.9956681    
   1500000   2520           200            200            0.0053309813   0.0011028876   0              0.014890056    2.9092466e-08  0              0.0056190842   0              0              2.9956678    
   1600000   2520           200            200            0.0053305781   0.0011028651   0              0.014888869    1.5950109e-08  0              0.0030806947   0              0              2.9956679    
   1700000   2520           200            200            0.0053307166   0.0011028728   0              0.014889277    1.1806763e-08  0              0.0022804253   0              0              2.9956679    
   1800000   2520           200            200            0.0053306771   0.0011028706   0              0.014889161    3.2058745e-09  0              0.00061920082  0              0              2.9956679    
   1900000   2520           200            200            0.0053306852   0.001102871    0              0.014889185    5.625738e-10   0              0.0001086587   0              0              2.9956679    
   2000000   2520           200            200            0.0053306851   0.001102871    0              0.014889184    7.1182034e-11  0              1.3748503e-05  0              0              2.9956679    
   2100000   2520           200            200            0.0053306841   0.001102871    0              0.014889181    6.3414371e-12  0              1.2248212e-06  0              0              2.9956679    
   2200000   2520           200            200            0.0053306848   0.001102871    0              0.014889183    3.2291316e-13  0              6.2369282e-08  0              0              2.9956679    
   2300000   2520           200            200            0.0053306844   0.001102871    0              0.014889182    2.0511304e-15  0              3.9616698e-10  0              0              2.9956679    
   2400000   2520           200            200            0.0053306846   0.001102871    0              0.014889183    2.1288347e-15  0              4.1117524e-10  0              0              2.9956679    
   2500000   2520           200            200            0.0053306845   0.001102871    0              0.014889183    1.4396924e-15  0              2.7807037e-10  0              0              2.9956679    
   2600000   2520           200            200            0.0053306845   0.001102871    0              0.014889183    3.6289064e-16  0              7.0090761e-11  0              0              2.9956679    
   2700000   2520           200            200            0.0053306845   0.001102871    0              0.014889183    6.1370413e-17  0              1.185343e-11   0              0              2.9956679    
   2800000   2520           200            200            0.0053306845   0.001102871    0              0.014889183    3.8219728e-18  0              7.3819756e-13  0              0              2.9956679    
   2900000   2520           200            200            0.0053306845   0.001102871    0              0.014889183    2.7026556e-18  0              5.2200627e-13  0              0              2.9956679    
   3000000   2520           200            200            0.0053306845   0.001102871    0              0.014889183    8.8371745e-23  0              1.7068621e-17  0              0              2.9956679    
Loop time of 179.895 on 2 procs for 3000000 steps with 1251 atoms

Performance: 14408421.331 ns/day, 0.000 hours/ns, 16676.414 timesteps/s
99.9% CPU use with 2 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 41.256     | 41.259     | 41.262     |   0.0 | 22.94
Neigh   | 3.1852     | 3.1853     | 3.1854     |   0.0 |  1.77
Comm    | 13.63      | 13.745     | 13.86      |   3.1 |  7.64
Output  | 0.21163    | 0.21165    | 0.21167    |   0.0 |  0.12
Modify  | 108.72     | 108.75     | 108.78     |   0.3 | 60.45
Other   |            | 12.74      |            |       |  7.08

Nlocal:          625.5 ave         626 max         625 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Nghost:            2.5 ave           3 max           2 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Neighs:          365.5 ave         366 max         365 min
Histogram: 1 0 0 0 0 0 0 0 0 1

Total # of neighbors = 731
Ave neighs/atom = 0.58433253
Neighbor list builds = 164
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 37

#variable lat0 equal 1                    #
variable lat1 equal 3+(v_ind*0.01)        # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 250*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 3.37                                                               
Lattice spacing in x,y,z = 3.37 3.37 3.37

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -1263.75 ${n1e1} -100 100 -100 100 units box
region box block -1263.75 1263.75 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -1263.75 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -1263.75 1263.75 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-1263.75 -100 -100) to (1263.75 100 100)
  2 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 750 atoms
  using lattice units in orthogonal box = (-1263.75 -100 -100) to (1263.75 100 100)
  create_atoms CPU = 0.000 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -750 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -750 750 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 501 atoms
  using lattice units in orthogonal box = (-1263.75 -100 -100) to (1263.75 100 100)
  create_atoms CPU = 0.000 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  750 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  750 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  501 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  501 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
750 atoms in group substrate
group slider1 region slider1
501 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 501 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_37_*.dump id type diameter mass xu yu zu fx fy fz

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 1631 130 130
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 69.93 | 69.93 | 69.93 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   2527.5         200            200            0              0              0              0              0              0              0              0              0              6            
    100000   2527.5         200            200            0.0040334576  -9.9875456e-37  0              0.012100373    293586.59      0              5.6704982e+10  0              0              3.3255374    
    200000   2527.5         200            200            0.0014404453  -6.2422227e-38  0              0.0043213359   72454.112      0              1.3994199e+10  0              0              3.0725462    
    300000   2527.5         200            200            0.00012379572 -4.9937758e-37  0              0.00037138715  1084.3842      0              2.0944413e+08  0              0              3.0454859    
    400000   2527.5         200            200            0.012750776    0.0068848237   0              0.031367505    4716.8806      0              9.1104514e+08  0              0              2.99382      
    500000   2527.5         200            200            0.0044387807   0.0041214509   0              0.0091948913   742.1696       0              1.4334686e+08  0              0              2.9965531    
    600000   2527.5         200            200            0.0045975995   0.0038420061   0              0.0099507925   47.556809      0              9185392.5      0              0              2.9964536    
    700000   2527.5         200            200            0.0069235092   0.0044595793   0              0.016310948    10.210769      0              1972165.9      0              0              2.9954881    
    800000   2527.5         200            200            0.0061867133   0.0043701919   0              0.014189948    0.99283506     0              191761.81      0              0              2.9957832    
    900000   2527.5         200            200            0.0065130133   0.0044111522   0              0.015127888    0.084109226    0              16245.334      0              0              2.9956492    
   1000000   2527.5         200            200            0.0063753088   0.0043971711   0              0.014728755    0.0043397338   0              838.20086      0              0              2.9957059    
   1100000   2527.5         200            200            0.0064312905   0.0044035374   0              0.014890334    5.7708527e-05  0              11.146153      0              0              2.9956827    
   1200000   2527.5         200            200            0.006409831    0.0044009033   0              0.01482859     1.2398121e-05  0              2.3946437      0              0              2.9956916    
   1300000   2527.5         200            200            0.0064175493   0.0044018608   0              0.014850787    1.2521675e-05  0              2.4185075      0              0              2.9956884    
   1400000   2527.5         200            200            0.0064149407   0.0044015359   0              0.014843286    4.1957344e-06  0              0.81038799     0              0              2.9956895    
   1500000   2527.5         200            200            0.0064157589   0.0044016384   0              0.014845638    9.6688831e-07  0              0.18675031     0              0              2.9956892    
   1600000   2527.5         200            200            0.0064155276   0.0044016091   0              0.014844974    1.8042707e-07  0              0.03484871     0              0              2.9956893    
   1700000   2527.5         200            200            0.0064155821   0.0044016161   0              0.01484513     2.8968219e-08  0              0.0055950865   0              0              2.9956892    
   1800000   2527.5         200            200            0.0064155745   0.0044016151   0              0.014845108    4.1014374e-09  0              0.00079217494  0              0              2.9956892    
   1900000   2527.5         200            200            0.0064155725   0.0044016149   0              0.014845103    5.1517338e-10  0              9.9503515e-05  0              0              2.9956892    
   2000000   2527.5         200            200            0.0064155749   0.0044016152   0              0.01484511     5.6878628e-11  0              1.0985862e-05  0              0              2.9956892    
   2100000   2527.5         200            200            0.0064155735   0.004401615    0              0.014845105    5.3563487e-12  0              1.0345556e-06  0              0              2.9956892    
   2200000   2527.5         200            200            0.0064155742   0.0044016151   0              0.014845108    4.0027737e-13  0              7.7311846e-08  0              0              2.9956892    
   2300000   2527.5         200            200            0.0064155739   0.004401615    0              0.014845107    1.9446391e-14  0              3.7559866e-09  0              0              2.9956892    
   2400000   2527.5         200            200            0.006415574    0.0044016151   0              0.014845107    1.9017881e-16  0              3.6732216e-11  0              0              2.9956892    
   2500000   2527.5         200            200            0.006415574    0.0044016151   0              0.014845107    7.5942094e-17  0              1.4667888e-11  0              0              2.9956892    
   2600000   2527.5         200            200            0.006415574    0.0044016151   0              0.014845107    7.3312418e-17  0              1.4159977e-11  0              0              2.9956892    
   2700000   2527.5         200            200            0.006415574    0.0044016151   0              0.014845107    1.3236768e-17  0              2.5566247e-12  0              0              2.9956892    
   2800000   2527.5         200            200            0.006415574    0.0044016151   0              0.014845107    2.6415991e-18  0              5.1021346e-13  0              0              2.9956892    
   2900000   2527.5         200            200            0.006415574    0.0044016151   0              0.014845107    1.4829273e-18  0              2.8642101e-13  0              0              2.9956892    
   3000000   2527.5         200            200            0.006415574    0.0044016151   0              0.014845107    1.946444e-18   0              3.7594726e-13  0              0              2.9956892    
Loop time of 179.645 on 2 procs for 3000000 steps with 1251 atoms

Performance: 14428421.274 ns/day, 0.000 hours/ns, 16699.562 timesteps/s
99.9% CPU use with 2 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 41.22      | 41.287     | 41.355     |   1.0 | 22.98
Neigh   | 3.1633     | 3.1639     | 3.1644     |   0.0 |  1.76
Comm    | 13.563     | 13.596     | 13.628     |   0.9 |  7.57
Output  | 0.21108    | 0.21111    | 0.21114    |   0.0 |  0.12
Modify  | 108.64     | 108.64     | 108.64     |   0.0 | 60.47
Other   |            | 12.75      |            |       |  7.10

Nlocal:          625.5 ave         626 max         625 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Nghost:            2.5 ave           3 max           2 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Neighs:          366.5 ave         367 max         366 min
Histogram: 1 0 0 0 0 0 0 0 0 1

Total # of neighbors = 733
Ave neighs/atom = 0.58593125
Neighbor list builds = 164
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 38

#variable lat0 equal 1                    #
variable lat1 equal 3+(v_ind*0.01)        # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 250*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 3.38                                                               
Lattice spacing in x,y,z = 3.38 3.38 3.38

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -1267.5 ${n1e1} -100 100 -100 100 units box
region box block -1267.5 1267.5 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -1267.5 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -1267.5 1267.5 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-1267.5 -100 -100) to (1267.5 100 100)
  2 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 750 atoms
  using lattice units in orthogonal box = (-1267.5 -100 -100) to (1267.5 100 100)
  create_atoms CPU = 0.000 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -750 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -750 750 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 501 atoms
  using lattice units in orthogonal box = (-1267.5 -100 -100) to (1267.5 100 100)
  create_atoms CPU = 0.000 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  750 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  750 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  501 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  501 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
750 atoms in group substrate
group slider1 region slider1
501 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 501 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_38_*.dump id type diameter mass xu yu zu fx fy fz

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 1636 130 130
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 70.07 | 70.07 | 70.07 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   2535           200            200            0              0              0              0              0              0              0              0              0              6            
    100000   2535           200            200            0.0040220229  -6.2237541e-38  0              0.012066069    293641.22      0              5.6715535e+10  0              0              3.3254496    
    200000   2535           200            200            0.001437109    1.9916022e-36  0              0.004311327    72526.616      0              1.4008203e+10  0              0              3.0724454    
    300000   2535           200            200            0.00012462797  1.0267755e-42  0              0.00037388391  1104.3466      0              2.1329977e+08  0              0              3.0455053    
    400000   2535           200            200            0.0088055486  -0.0070751595   0              0.033491805    4598.0088      0              8.8808555e+08  0              0              2.9936481    
    500000   2535           200            200            0.0013846509  -0.0031554573   0              0.0073094101   666.18         0              1.2866979e+08  0              0              2.9969471    
    600000   2535           200            200            0.0019672025  -0.0029565885   0              0.0088581962   12.614732      0              2436481.1      0              0              2.9966864    
    700000   2535           200            200            0.0042480383  -0.0042223329   0              0.016966448    4.3310188      0              836517.58      0              0              2.9954277    
    800000   2535           200            200            0.0033515032  -0.0040854422   0              0.014139952    0.94781325     0              183066.04      0              0              2.9958223    
    900000   2535           200            200            0.0036042958  -0.004121585    0              0.014934473    0.23218619     0              44845.761      0              0              2.9957072    
   1000000   2535           200            200            0.0035652185  -0.0041181145   0              0.01481377     0.03654884     0              7059.2507      0              0              2.9957237    
   1100000   2535           200            200            0.0035523022  -0.0041166102   0              0.014773517    0.0030322403   0              585.66414      0              0              2.99573      
   1200000   2535           200            200            0.0035661724  -0.0041182806   0              0.014816798    8.2595767e-05  0              15.953016      0              0              2.9957235    
   1300000   2535           200            200            0.0035593079  -0.0041174554   0              0.014795379    2.5738115e-06  0              0.49712059     0              0              2.9957267    
   1400000   2535           200            200            0.0035617726  -0.0041177754   0              0.014803093    5.0282688e-06  0              0.97118842     0              0              2.9957256    
   1500000   2535           200            200            0.0035611295  -0.0041176895   0              0.014801078    1.4627626e-06  0              0.28252628     0              0              2.9957258    
   1600000   2535           200            200            0.0035612063  -0.0041176991   0              0.014801318    2.1769573e-07  0              0.042046991    0              0              2.9957258    
   1700000   2535           200            200            0.0035612443  -0.0041177046   0              0.014801437    1.7816689e-08  0              0.0034412167   0              0              2.9957258    
   1800000   2535           200            200            0.0035612097  -0.0041176998   0              0.014801329    4.7968832e-10  0              9.2649729e-05  0              0              2.9957258    
   1900000   2535           200            200            0.0035612266  -0.0041177021   0              0.014801382    1.6754316e-11  0              3.2360239e-06  0              0              2.9957258    
   2000000   2535           200            200            0.0035612205  -0.0041177013   0              0.014801363    3.0933509e-11  0              5.9746737e-06  0              0              2.9957258    
   2100000   2535           200            200            0.0035612221  -0.0041177015   0              0.014801368    8.9115791e-12  0              1.721233e-06   0              0              2.9957258    
   2200000   2535           200            200            0.0035612219  -0.0041177015   0              0.014801367    1.3177827e-12  0              2.5452403e-07  0              0              2.9957258    
   2300000   2535           200            200            0.0035612218  -0.0041177015   0              0.014801367    1.0696836e-13  0              2.0660476e-08  0              0              2.9957258    
   2400000   2535           200            200            0.0035612219  -0.0041177015   0              0.014801367    2.8861451e-15  0              5.5744647e-10  0              0              2.9957258    
   2500000   2535           200            200            0.0035612219  -0.0041177015   0              0.014801367    9.6527357e-17  0              1.8643842e-11  0              0              2.9957258    
   2600000   2535           200            200            0.0035612219  -0.0041177015   0              0.014801367    1.9482354e-16  0              3.7629327e-11  0              0              2.9957258    
   2700000   2535           200            200            0.0035612219  -0.0041177015   0              0.014801367    5.804091e-17   0              1.1210351e-11  0              0              2.9957258    
   2800000   2535           200            200            0.0035612219  -0.0041177015   0              0.014801367    6.9451716e-18  0              1.3414299e-12  0              0              2.9957258    
   2900000   2535           200            200            0.0035612219  -0.0041177015   0              0.014801367    4.4297846e-20  0              8.5559377e-15  0              0              2.9957258    
   3000000   2535           200            200            0.0035612219  -0.0041177015   0              0.014801367    9.3140796e-19  0              1.7989743e-13  0              0              2.9957258    
Loop time of 181.105 on 2 procs for 3000000 steps with 1251 atoms

Performance: 14312155.367 ns/day, 0.000 hours/ns, 16564.995 timesteps/s
99.9% CPU use with 2 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 41.738     | 41.774     | 41.81      |   0.6 | 23.07
Neigh   | 3.1826     | 3.1836     | 3.1846     |   0.1 |  1.76
Comm    | 14.397     | 14.523     | 14.65      |   3.3 |  8.02
Output  | 0.2164     | 0.21645    | 0.2165     |   0.0 |  0.12
Modify  | 108.45     | 108.58     | 108.7      |   1.2 | 59.95
Other   |            | 12.83      |            |       |  7.08

Nlocal:          625.5 ave         626 max         625 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Nghost:            2.5 ave           3 max           2 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Neighs:          367.5 ave         368 max         367 min
Histogram: 1 0 0 0 0 0 0 0 0 1

Total # of neighbors = 735
Ave neighs/atom = 0.58752998
Neighbor list builds = 164
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 39

#variable lat0 equal 1                    #
variable lat1 equal 3+(v_ind*0.01)        # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 250*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 3.39                                                               
Lattice spacing in x,y,z = 3.39 3.39 3.39

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -1271.25 ${n1e1} -100 100 -100 100 units box
region box block -1271.25 1271.25 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -1271.25 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -1271.25 1271.25 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-1271.25 -100 -100) to (1271.25 100 100)
  2 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 750 atoms
  using lattice units in orthogonal box = (-1271.25 -100 -100) to (1271.25 100 100)
  create_atoms CPU = 0.000 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -750 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -750 750 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 501 atoms
  using lattice units in orthogonal box = (-1271.25 -100 -100) to (1271.25 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  750 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  750 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  501 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  501 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
750 atoms in group substrate
group slider1 region slider1
501 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 501 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_39_*.dump id type diameter mass xu yu zu fx fy fz

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 1641 130 130
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 70.27 | 70.27 | 70.27 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   2542.5         200            200            0              0              0              0              0              0              0              0              0              6            
    100000   2542.5         200            200            0.0040087671   9.9286373e-37  0              0.012026301    293488.98      0              5.6686129e+10  0              0              3.3256845    
    200000   2542.5         200            200            0.0014301324   2.6865712e-43  0              0.0042903972   72311.515      0              1.3966657e+10  0              0              3.0727465    
    300000   2542.5         200            200            0.00012067364  1.247314e-43   0              0.00036202091  1044.9144      0              2.0182072e+08  0              0              3.0454519    
    400000   2542.5         200            200            0.0081425564  -0.0016814344   0              0.026109103    4952.9879      0              9.5664823e+08  0              0              2.9942839    
    500000   2542.5         200            200            0.0042553457  -0.001095908    0              0.013861945    824.30219      0              1.5921041e+08  0              0              2.9957034    
    600000   2542.5         200            200            0.0041036694  -0.00058533213  0              0.01289634     104.46612      0              20177181       0              0              2.9958752    
    700000   2542.5         200            200            0.0047708107  -0.00066568913  0              0.014978121    15.062726      0              2909300.5      0              0              2.9955888    
    800000   2542.5         200            200            0.0045145265  -0.00069157225  0              0.014235152    1.3756145      0              265694.01      0              0              2.9956886    
    900000   2542.5         200            200            0.0047881429  -0.00070130536  0              0.015065734    0.044768958    0              8646.931       0              0              2.9955708    
   1000000   2542.5         200            200            0.0046483722  -0.000690683    0              0.0146358      0.00086969277  0              167.9774       0              0              2.9956322    
   1100000   2542.5         200            200            0.0046987141  -0.00069468845  0              0.014790831    0.0021940606   0              423.77334      0              0              2.9956098    
   1200000   2542.5         200            200            0.0046863404  -0.00069370445  0              0.014752726    0.00062485357  0              120.68777      0              0              2.9956153    
   1300000   2542.5         200            200            0.0046871906  -0.0006937806   0              0.014755352    8.3699877e-05  0              16.16627       0              0              2.9956149    
   1400000   2542.5         200            200            0.0046883355  -0.00069386693  0              0.014758873    5.2291168e-06  0              1.0099813      0              0              2.9956144    
   1500000   2542.5         200            200            0.0046875122  -0.00069380324  0              0.01475634     3.2324291e-08  0              0.0062432973   0              0              2.9956148    
   1600000   2542.5         200            200            0.0046878671  -0.00069383101  0              0.014757432    3.9015055e-08  0              0.0075355894   0              0              2.9956146    
   1700000   2542.5         200            200            0.0046877586  -0.00069382243  0              0.014757098    2.1471225e-08  0              0.0041470744   0              0              2.9956147    
   1800000   2542.5         200            200            0.0046877779  -0.00069382399  0              0.014757158    4.0982621e-09  0              0.00079156165  0              0              2.9956147    
   1900000   2542.5         200            200            0.0046877806  -0.00069382418  0              0.014757166    3.93393e-10    0              7.598216e-05   0              0              2.9956147    
   2000000   2542.5         200            200            0.0046877763  -0.00069382385  0              0.014757153    1.3184209e-11  0              2.5464731e-06  0              0              2.9956147    
   2100000   2542.5         200            200            0.0046877786  -0.00069382403  0              0.01475716     1.8609869e-13  0              3.5944159e-08  0              0              2.9956147    
   2200000   2542.5         200            200            0.0046877778  -0.00069382396  0              0.014757157    5.7360502e-13  0              1.1078934e-07  0              0              2.9956147    
   2300000   2542.5         200            200            0.004687778   -0.00069382398  0              0.014757158    1.6859813e-13  0              3.2564001e-08  0              0              2.9956147    
   2400000   2542.5         200            200            0.004687778   -0.00069382398  0              0.014757158    2.3113219e-14  0              4.4642185e-09  0              0              2.9956147    
   2500000   2542.5         200            200            0.0046877779  -0.00069382398  0              0.014757158    1.5172153e-15  0              2.930436e-10   0              0              2.9956147    
   2600000   2542.5         200            200            0.004687778   -0.00069382398  0              0.014757158    1.5574331e-17  0              3.0081148e-12  0              0              2.9956147    
   2700000   2542.5         200            200            0.0046877779  -0.00069382398  0              0.014757158    2.0149844e-18  0              3.8918554e-13  0              0              2.9956147    
   2800000   2542.5         200            200            0.0046877779  -0.00069382398  0              0.014757158    2.7556933e-18  0              5.3225027e-13  0              0              2.9956147    
   2900000   2542.5         200            200            0.0046877779  -0.00069382398  0              0.014757158    2.422354e-18   0              4.6786721e-13  0              0              2.9956147    
   3000000   2542.5         200            200            0.0046877779  -0.00069382398  0              0.014757158    1.8485527e-18  0              3.5703998e-13  0              0              2.9956147    
Loop time of 180.558 on 2 procs for 3000000 steps with 1251 atoms

Performance: 14355477.453 ns/day, 0.000 hours/ns, 16615.136 timesteps/s
99.9% CPU use with 2 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 41.129     | 41.299     | 41.469     |   2.7 | 22.87
Neigh   | 3.2298     | 3.2299     | 3.2299     |   0.0 |  1.79
Comm    | 14.258     | 14.265     | 14.272     |   0.2 |  7.90
Output  | 0.2126     | 0.21265    | 0.21271    |   0.0 |  0.12
Modify  | 108.74     | 108.85     | 108.96     |   1.1 | 60.28
Other   |            | 12.7       |            |       |  7.04

Nlocal:          625.5 ave         626 max         625 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Nghost:            2.5 ave           3 max           2 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Neighs:          366.5 ave         367 max         366 min
Histogram: 1 0 0 0 0 0 0 0 0 1

Total # of neighbors = 733
Ave neighs/atom = 0.58593125
Neighbor list builds = 164
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 40

#variable lat0 equal 1                    #
variable lat1 equal 3+(v_ind*0.01)        # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 250*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 3.4                                                               
Lattice spacing in x,y,z = 3.4 3.4 3.4

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -1275 ${n1e1} -100 100 -100 100 units box
region box block -1275 1275 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -1275 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -1275 1275 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-1275 -100 -100) to (1275 100 100)
  2 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 750 atoms
  using lattice units in orthogonal box = (-1275 -100 -100) to (1275 100 100)
  create_atoms CPU = 0.000 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -750 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -750 750 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 501 atoms
  using lattice units in orthogonal box = (-1275 -100 -100) to (1275 100 100)
  create_atoms CPU = 0.000 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  750 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  750 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  501 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  501 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
750 atoms in group substrate
group slider1 region slider1
501 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 501 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_40_*.dump id type diameter mass xu yu zu fx fy fz

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 1646 130 130
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 70.41 | 70.41 | 70.41 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   2550           200            200            0              0              0              0              0              0              0              0              0              6            
    100000   2550           200            200            0.0039978722   9.6674131e-40  0              0.011993617    293593.87      0              5.6706388e+10  0              0              3.3254263    
    200000   2550           200            200            0.0014251066   1.0443038e-43  0              0.0042753198   72242.27       0              1.3953283e+10  0              0              3.0730357    
    300000   2550           200            200            0.00013102145  1.9798875e-36  0              0.00039306434  1227.4671      0              2.3707997e+08  0              0              3.0451164    
    400000   2550           200            200            0.008206466    6.9296027e-36  0              0.024619398    4705.8169      0              9.0890823e+08  0              0              2.9942068    
    500000   2550           200            200            0.00095413334  4.9497159e-37  0              0.0028624      138.21254      0              26695155       0              0              2.9985514    
    600000   2550           200            200            0.0041170539  -8.0432877e-37  0              0.012351162    82.883808      0              16008650       0              0              2.9962434    
    700000   2550           200            200            0.0045103434   2.4748577e-37  0              0.01353103     9.1510278      0              1767481.5      0              0              2.9960214    
    800000   2550           200            200            0.0047054772  -7.7339304e-38  0              0.014116432    0.69054137     0              133375.09      0              0              2.995912     
    900000   2550           200            200            0.0048175549  -1.5467861e-38  0              0.014452665    0.02717242     0              5248.2356      0              0              2.9958487    
   1000000   2550           200            200            0.0048709486   1.5467861e-38  0              0.014612846    3.727094e-06   0              0.71987212     0              0              2.9958183    
   1100000   2550           200            200            0.0048930611  -3.0935722e-38  0              0.014679183    0.0004403015   0              85.042335      0              0              2.9958057    
   1200000   2550           200            200            0.0049012404  -1.5467861e-38  0              0.014703721    0.00022123861  0              42.731283      0              0              2.995801     
   1300000   2550           200            200            0.004903946    1.5467861e-38  0              0.014711838    5.6560529e-05  0              10.924422      0              0              2.9957995    
   1400000   2550           200            200            0.0049047243  -1.5467861e-38  0              0.014714173    1.0409496e-05  0              2.0105493      0              0              2.995799     
   1500000   2550           200            200            0.0049049007   1.1600896e-38  0              0.014714702    1.5132599e-06  0              0.29227963     0              0              2.9957989    
   1600000   2550           200            200            0.0049049182   3.8669653e-39  0              0.014714755    1.7685258e-07  0              0.034158313    0              0              2.9957989    
   1700000   2550           200            200            0.0049049067   7.7339305e-39  0              0.01471472     1.6023298e-08  0              0.0030948309   0              0              2.9957989    
   1800000   2550           200            200            0.0049048962   1.9334827e-39  0              0.014714689    9.8037712e-10  0              0.00018935561  0              0              2.9957989    
   1900000   2550           200            200            0.0049048905  -1.5467861e-38  0              0.014714672    2.2055793e-11  0              4.2599812e-06  0              0              2.9957989    
   2000000   2550           200            200            0.004904888    4.4552248e-47  0              0.014714664    9.2270585e-13  0              1.7821665e-07  0              0              2.9957989    
   2100000   2550           200            200            0.004904887   -2.3201791e-38  0              0.014714661    1.6996914e-12  0              3.2828806e-07  0              0              2.9957989    
   2200000   2550           200            200            0.0049048866   1.6434602e-38  0              0.01471466     6.049456e-13   0              1.1684263e-07  0              0              2.9957989    
   2300000   2550           200            200            0.0049048865  -1.5467861e-38  0              0.014714659    1.3366201e-13  0              2.5816241e-08  0              0              2.9957989    
   2400000   2550           200            200            0.0049048865  -2.3201791e-38  0              0.014714659    2.2299007e-14  0              4.306957e-09   0              0              2.9957989    
   2500000   2550           200            200            0.0049048865   3.0935722e-38  0              0.014714659    3.0037047e-15  0              5.801526e-10   0              0              2.9957989    
   2600000   2550           200            200            0.0049048865   4.6403583e-38  0              0.014714659    3.28369e-16    0              6.3423055e-11  0              0              2.9957989    
   2700000   2550           200            200            0.0049048865  -3.4802687e-38  0              0.014714659    2.655529e-17   0              5.1290396e-12  0              0              2.9957989    
   2800000   2550           200            200            0.0049048865   3.0935722e-38  0              0.014714659    1.8975424e-18  0              3.6650213e-13  0              0              2.9957989    
   2900000   2550           200            200            0.0049048865  -1.546786e-37   0              0.014714659    1.7636904e-21  0              3.406492e-16   0              0              2.9957989    
   3000000   2550           200            200            0.0049048865  -7.424572e-37   0              0.014714659    6.8010171e-19  0              1.3135871e-13  0              0              2.9957989    
Loop time of 177.109 on 2 procs for 3000000 steps with 1251 atoms

Performance: 14635092.641 ns/day, 0.000 hours/ns, 16938.765 timesteps/s
99.9% CPU use with 2 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 38.7       | 38.725     | 38.75      |   0.4 | 21.87
Neigh   | 3.223      | 3.2231     | 3.2232     |   0.0 |  1.82
Comm    | 13.655     | 13.731     | 13.807     |   2.1 |  7.75
Output  | 0.21255    | 0.21258    | 0.21261    |   0.0 |  0.12
Modify  | 108.43     | 108.44     | 108.46     |   0.2 | 61.23
Other   |            | 12.77      |            |       |  7.21

Nlocal:          625.5 ave         626 max         625 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Nghost:            2.5 ave           3 max           2 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Neighs:          353.5 ave         354 max         353 min
Histogram: 1 0 0 0 0 0 0 0 0 1

Total # of neighbors = 707
Ave neighs/atom = 0.56514788
Neighbor list builds = 164
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 41

#variable lat0 equal 1                    #
variable lat1 equal 3+(v_ind*0.01)        # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 250*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 3.41                                                               
Lattice spacing in x,y,z = 3.41 3.41 3.41

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -1278.75 ${n1e1} -100 100 -100 100 units box
region box block -1278.75 1278.75 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -1278.75 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -1278.75 1278.75 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-1278.75 -100 -100) to (1278.75 100 100)
  2 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 750 atoms
  using lattice units in orthogonal box = (-1278.75 -100 -100) to (1278.75 100 100)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -750 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -750 750 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 501 atoms
  using lattice units in orthogonal box = (-1278.75 -100 -100) to (1278.75 100 100)
  create_atoms CPU = 0.000 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  750 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  750 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  501 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  501 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
750 atoms in group substrate
group slider1 region slider1
501 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 501 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_41_*.dump id type diameter mass xu yu zu fx fy fz

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 1650 130 130
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 70.62 | 70.62 | 70.62 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   2557.5         200            200            0              0              0              0              0              0              0              0              0              6            
    100000   2557.5         200            200            0.0039862651   1.2933778e-42  0              0.011958795    293601.03      0              5.6707772e+10  0              0              3.3254983    
    200000   2557.5         200            200            0.0014240207  -3.0845e-38     0              0.0042720621   72492.564      0              1.4001626e+10  0              0              3.0724463    
    300000   2557.5         200            200            0.00012339     1.9740813e-36  0              0.00037016999  1102.0058      0              2.1284766e+08  0              0              3.0454314    
    400000   2557.5         200            200            0.0084266709  -0.0059877079   0              0.031267721    4692.5142      0              9.0633887e+08  0              0              2.9937638    
    500000   2557.5         200            200            0.0021914525  -0.004947224    0              0.011521581    800.6399       0              1.5464014e+08  0              0              2.996115     
    600000   2557.5         200            200            0.0026597958  -0.0043523709   0              0.012331758    98.35711       0              18997251       0              0              2.9960125    
    700000   2557.5         200            200            0.0031080678  -0.0041262205   0              0.013450424    11.060149      0              2136220        0              0              2.9958578    
    800000   2557.5         200            200            0.0037511293  -0.0042256628   0              0.015479051    0.40470355     0              78166.744      0              0              2.9955497    
    900000   2557.5         200            200            0.003389725   -0.0041738889   0              0.014343064    0.00096600903  0              186.58048      0              0              2.9957163    
   1000000   2557.5         200            200            0.00352579    -0.0041995191   0              0.014776889    0.0090014597   0              1738.5931      0              0              2.9956523    
   1100000   2557.5         200            200            0.0034846325  -0.0041912308   0              0.014645128    0.0033558541   0              648.16873      0              0              2.9956715    
   1200000   2557.5         200            200            0.0034935044  -0.0041931149   0              0.014673628    0.0006557004   0              126.6457       0              0              2.9956674    
   1300000   2557.5         200            200            0.0034931471  -0.0041930635   0              0.014672505    8.3745185e-05  0              16.175021      0              0              2.9956675    
   1400000   2557.5         200            200            0.0034921872  -0.0041928431   0              0.014669405    6.8100086e-06  0              1.3153238      0              0              2.995668     
   1500000   2557.5         200            200            0.0034928722  -0.0041929962   0              0.014671613    2.4456202e-07  0              0.047236098    0              0              2.9956676    
   1600000   2557.5         200            200            0.0034925477  -0.0041929245   0              0.014670567    6.0159757e-10  0              0.00011619598  0              0              2.9956678    
   1700000   2557.5         200            200            0.0034926703  -0.0041929514   0              0.014670962    6.8970016e-09  0              0.0013321261   0              0              2.9956677    
   1800000   2557.5         200            200            0.0034926328  -0.0041929432   0              0.014670842    2.6783735e-09  0              0.00051731628  0              0              2.9956678    
   1900000   2557.5         200            200            0.0034926411  -0.004192945    0              0.014670868    5.3358544e-10  0              0.00010305972  0              0              2.9956678    
   2000000   2557.5         200            200            0.0034926407  -0.0041929449   0              0.014670867    6.9345172e-11  0              1.3393721e-05  0              0              2.9956678    
   2100000   2557.5         200            200            0.0034926398  -0.0041929447   0              0.014670864    5.7684223e-12  0              1.1141459e-06  0              0              2.9956678    
   2200000   2557.5         200            200            0.0034926405  -0.0041929449   0              0.014670866    2.1896359e-13  0              4.2291872e-08  0              0              2.9956678    
   2300000   2557.5         200            200            0.0034926402  -0.0041929448   0              0.014670865    2.0025974e-16  0              3.8679304e-11  0              0              2.9956678    
   2400000   2557.5         200            200            0.0034926403  -0.0041929448   0              0.014670866    5.292721e-15   0              1.0222662e-09  0              0              2.9956678    
   2500000   2557.5         200            200            0.0034926402  -0.0041929448   0              0.014670866    2.1359481e-15  0              4.1254915e-10  0              0              2.9956678    
   2600000   2557.5         200            200            0.0034926403  -0.0041929448   0              0.014670866    4.3493714e-16  0              8.4006231e-11  0              0              2.9956678    
   2700000   2557.5         200            200            0.0034926403  -0.0041929448   0              0.014670866    5.1913019e-17  0              1.0026776e-11  0              0              2.9956678    
   2800000   2557.5         200            200            0.0034926403  -0.0041929448   0              0.014670866    3.187977e-18   0              6.15744e-13    0              0              2.9956678    
   2900000   2557.5         200            200            0.0034926403  -0.0041929448   0              0.014670866    4.9096228e-19  0              9.4827245e-14  0              0              2.9956678    
   3000000   2557.5         200            200            0.0034926403  -0.0041929448   0              0.014670866    1.8322993e-19  0              3.539007e-14   0              0              2.9956678    
Loop time of 180.288 on 2 procs for 3000000 steps with 1251 atoms

Performance: 14377032.849 ns/day, 0.000 hours/ns, 16640.084 timesteps/s
99.9% CPU use with 2 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 41.133     | 41.289     | 41.445     |   2.4 | 22.90
Neigh   | 3.215      | 3.2155     | 3.216      |   0.0 |  1.78
Comm    | 14.295     | 14.311     | 14.327     |   0.4 |  7.94
Output  | 0.20991    | 0.20994    | 0.20997    |   0.0 |  0.12
Modify  | 108.44     | 108.54     | 108.65     |   1.0 | 60.21
Other   |            | 12.72      |            |       |  7.05

Nlocal:          625.5 ave         626 max         625 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Nghost:            2.5 ave           3 max           2 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Neighs:          365.5 ave         366 max         365 min
Histogram: 1 0 0 0 0 0 0 0 0 1

Total # of neighbors = 731
Ave neighs/atom = 0.58433253
Neighbor list builds = 164
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 42

#variable lat0 equal 1                    #
variable lat1 equal 3+(v_ind*0.01)        # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 250*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 3.42                                                               
Lattice spacing in x,y,z = 3.42 3.42 3.42

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -1282.5 ${n1e1} -100 100 -100 100 units box
region box block -1282.5 1282.5 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -1282.5 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -1282.5 1282.5 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-1282.5 -100 -100) to (1282.5 100 100)
  2 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 750 atoms
  using lattice units in orthogonal box = (-1282.5 -100 -100) to (1282.5 100 100)
  create_atoms CPU = 0.000 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -750 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -750 750 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 501 atoms
  using lattice units in orthogonal box = (-1282.5 -100 -100) to (1282.5 100 100)
  create_atoms CPU = 0.000 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  750 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  750 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  501 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  501 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
750 atoms in group substrate
group slider1 region slider1
501 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 501 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_42_*.dump id type diameter mass xu yu zu fx fy fz

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 1655 130 130
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 70.76 | 70.76 | 70.76 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   2565           200            200            0              0              0              0              0              0              0              0              0              6            
    100000   2565           200            200            0.0039730974   2.4603855e-37  0              0.011919292    293431.15      0              5.667496e+10   0              0              3.3258041    
    200000   2565           200            200            0.0014151107  -2.4603828e-37  0              0.004245332    72110.417      0              1.3927816e+10  0              0              3.0732298    
    300000   2565           200            200            0.00011395774  9.8415409e-37  0              0.00034187321  953.18896      0              1.8410433e+08  0              0              3.0457034    
    400000   2565           200            200            0.0061916289  -0.0030391713   0              0.021614058    5111.2044      0              9.8720707e+08  0              0              2.9949027    
    500000   2565           200            200            0.0029606573  -0.0025394235   0              0.011421396    802.56717      0              1.5501238e+08  0              0              2.9961971    
    600000   2565           200            200            0.0028704561  -0.0020549442   0              0.010666313    70.951404      0              13703957       0              0              2.9963515    
    700000   2565           200            200            0.0040835294  -0.0025309741   0              0.014781562    15.039265      0              2904769.1      0              0              2.9957315    
    800000   2565           200            200            0.004087382   -0.0025337049   0              0.014795851    1.9606114      0              378683.62      0              0              2.9957214    
    900000   2565           200            200            0.0039887076  -0.0025207044   0              0.014486827    0.22277058     0              43027.177      0              0              2.9957697    
   1000000   2565           200            200            0.004058426   -0.0025296669   0              0.014704945    0.022095828    0              4267.7138      0              0              2.9957366    
   1100000   2565           200            200            0.0040225331  -0.0025251552   0              0.014592755    0.0017810674   0              344.00549      0              0              2.9957534    
   1200000   2565           200            200            0.0040387468  -0.00252719     0              0.01464343     0.00010139113  0              19.583259      0              0              2.9957459    
   1300000   2565           200            200            0.0040320211  -0.0025263527   0              0.014622416    2.203362e-06   0              0.42556987     0              0              2.995749     
   1400000   2565           200            200            0.0040346306  -0.0025266765   0              0.014630568    9.0149099e-08  0              0.01741191     0              0              2.9957478    
   1500000   2565           200            200            0.0040336764  -0.0025265586   0              0.014627588    1.7200946e-07  0              0.033222885    0              0              2.9957482    
   1600000   2565           200            200            0.004034005   -0.002526599    0              0.014628614    6.5253037e-08  0              0.012603342    0              0              2.995748     
   1700000   2565           200            200            0.0040338993  -0.0025265861   0              0.014628284    1.5951003e-08  0              0.0030808673   0              0              2.9957481    
   1800000   2565           200            200            0.0040339303  -0.0025265899   0              0.014628381    3.0956376e-09  0              0.00059790904  0              0              2.9957481    
   1900000   2565           200            200            0.0040339225  -0.0025265889   0              0.014628356    5.1311215e-10  0              9.9105398e-05  0              0              2.9957481    
   2000000   2565           200            200            0.0040339239  -0.0025265891   0              0.014628361    7.4865532e-11  0              1.4459954e-05  0              0              2.9957481    
   2100000   2565           200            200            0.0040339239  -0.0025265891   0              0.014628361    9.7078428e-12  0              1.8750279e-06  0              0              2.9957481    
   2200000   2565           200            200            0.0040339237  -0.0025265891   0              0.01462836     1.1134377e-12  0              2.1505569e-07  0              0              2.9957481    
   2300000   2565           200            200            0.0040339239  -0.0025265891   0              0.014628361    1.1052371e-13  0              2.1347178e-08  0              0              2.9957481    
   2400000   2565           200            200            0.0040339238  -0.0025265891   0              0.01462836     8.9238721e-15  0              1.7236074e-09  0              0              2.9957481    
   2500000   2565           200            200            0.0040339238  -0.0025265891   0              0.014628361    4.8827664e-16  0              9.4308526e-11  0              0              2.9957481    
   2600000   2565           200            200            0.0040339238  -0.0025265891   0              0.014628361    1.3810423e-17  0              2.6674236e-12  0              0              2.9957481    
   2700000   2565           200            200            0.0040339238  -0.0025265891   0              0.014628361    3.3548063e-18  0              6.4796635e-13  0              0              2.9957481    
   2800000   2565           200            200            0.0040339238  -0.0025265891   0              0.014628361    1.8609402e-18  0              3.5943256e-13  0              0              2.9957481    
   2900000   2565           200            200            0.0040339238  -0.0025265891   0              0.014628361    4.9792256e-19  0              9.6171594e-14  0              0              2.9957481    
   3000000   2565           200            200            0.0040339238  -0.0025265891   0              0.014628361    1.9346956e-19  0              3.7367811e-14  0              0              2.9957481    
Loop time of 180.695 on 2 procs for 3000000 steps with 1251 atoms

Performance: 14344640.694 ns/day, 0.000 hours/ns, 16602.593 timesteps/s
99.9% CPU use with 2 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 41.179     | 41.279     | 41.378     |   1.6 | 22.84
Neigh   | 3.284      | 3.2841     | 3.2841     |   0.0 |  1.82
Comm    | 13.814     | 13.822     | 13.831     |   0.2 |  7.65
Output  | 0.21339    | 0.21343    | 0.21346    |   0.0 |  0.12
Modify  | 109.2      | 109.21     | 109.22     |   0.1 | 60.44
Other   |            | 12.89      |            |       |  7.13

Nlocal:          625.5 ave         626 max         625 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Nghost:            2.5 ave           3 max           2 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Neighs:          367.5 ave         368 max         367 min
Histogram: 1 0 0 0 0 0 0 0 0 1

Total # of neighbors = 735
Ave neighs/atom = 0.58752998
Neighbor list builds = 164
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 43

#variable lat0 equal 1                    #
variable lat1 equal 3+(v_ind*0.01)        # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 250*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 3.43                                                               
Lattice spacing in x,y,z = 3.43 3.43 3.43

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -1286.25 ${n1e1} -100 100 -100 100 units box
region box block -1286.25 1286.25 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -1286.25 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -1286.25 1286.25 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-1286.25 -100 -100) to (1286.25 100 100)
  2 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 750 atoms
  using lattice units in orthogonal box = (-1286.25 -100 -100) to (1286.25 100 100)
  create_atoms CPU = 0.000 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -750 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -750 750 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 501 atoms
  using lattice units in orthogonal box = (-1286.25 -100 -100) to (1286.25 100 100)
  create_atoms CPU = 0.000 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  750 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  750 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  501 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  501 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
750 atoms in group substrate
group slider1 region slider1
501 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 501 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_43_*.dump id type diameter mass xu yu zu fx fy fz

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 1660 130 130
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 70.9 | 70.9 | 70.9 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   2572.5         200            200            0              0              0              0              0              0              0              0              0              6            
    100000   2572.5         200            200            0.0039633031   1.9625786e-36  0              0.011889909    293650.75      0              5.6717376e+10  0              0              3.3251511    
    200000   2572.5         200            200            0.0014219307   8.3071661e-42  0              0.0042657922   73010.505      0              1.4101664e+10  0              0              3.0707756    
    300000   2572.5         200            200            0.00013645737  3.9251632e-36  0              0.0004093721   1347.6682      0              2.6029629e+08  0              0              3.0443555    
    400000   2572.5         200            200            0.0091985954  -0.012571499    0              0.040167286    4001.5849      0              7.7288885e+08  0              0              2.9921993    
    500000   2572.5         200            200            0.0071481938  -0.0096048415   0              0.031049423    266.14336      0              51404441       0              0              2.9929783    
    600000   2572.5         200            200            0.0055097216   0.0037500052   0              0.012779159    99.103522      0              19141418       0              0              2.995323     
    700000   2572.5         200            200            0.0052485752   0.0021680164   0              0.013577709    11.639291      0              2248078.9      0              0              2.9951795    
    800000   2572.5         200            200            0.0053706159   0.0017479948   0              0.014363853    1.8118471      0              349950.44      0              0              2.9950516    
    900000   2572.5         200            200            0.0054373964   0.0017048958   0              0.014607293    0.26112513     0              50435.192      0              0              2.9950126    
   1000000   2572.5         200            200            0.0054432101   0.0016987691   0              0.014630861    0.029359925    0              5670.7427      0              0              2.9950084    
   1100000   2572.5         200            200            0.0054374775   0.0017000683   0              0.014612364    0.0024079235   0              465.08003      0              0              2.9950111    
   1200000   2572.5         200            200            0.0054325453   0.0017012538   0              0.014596382    0.00011393278  0              22.005625      0              0              2.9950135    
   1300000   2572.5         200            200            0.0054299239   0.0017018971   0              0.014587874    5.3178216e-07  0              0.10271143     0              0              2.9950148    
   1400000   2572.5         200            200            0.0054287837   0.00170218     0              0.014584171    8.8149792e-07  0              0.17025752     0              0              2.9950154    
   1500000   2572.5         200            200            0.005428352    0.001702288    0              0.014582768    5.5572512e-07  0              0.10733591     0              0              2.9950156    
   1600000   2572.5         200            200            0.0054282085   0.0017023242   0              0.014582301    1.4970115e-07  0              0.028914131    0              0              2.9950156    
   1700000   2572.5         200            200            0.0054281679   0.0017023346   0              0.014582169    2.7538071e-08  0              0.0053188596   0              0              2.9950157    
   1800000   2572.5         200            200            0.0054281593   0.0017023368   0              0.014582141    3.8565098e-09  0              0.00074486823  0              0              2.9950157    
   1900000   2572.5         200            200            0.0054281588   0.001702337    0              0.01458214     4.1544255e-10  0              8.0240937e-05  0              0              2.9950157    
   2000000   2572.5         200            200            0.0054281597   0.0017023368   0              0.014582142    3.2025567e-11  0              6.1856e-06     0              0              2.9950157    
   2100000   2572.5         200            200            0.0054281604   0.0017023366   0              0.014582144    1.3156475e-12  0              2.5411164e-07  0              0              2.9950157    
   2200000   2572.5         200            200            0.0054281607   0.0017023365   0              0.014582146    6.726907e-16   0              1.2992731e-10  0              0              2.9950157    
   2300000   2572.5         200            200            0.0054281608   0.0017023365   0              0.014582146    1.8898613e-14  0              3.6501856e-09  0              0              2.9950157    
   2400000   2572.5         200            200            0.0054281609   0.0017023365   0              0.014582146    9.5072062e-15  0              1.8362759e-09  0              0              2.9950157    
   2500000   2572.5         200            200            0.0054281609   0.0017023365   0              0.014582146    2.4062195e-15  0              4.6475091e-10  0              0              2.9950157    
   2600000   2572.5         200            200            0.0054281609   0.0017023365   0              0.014582146    4.19379e-16    0              8.1001244e-11  0              0              2.9950157    
   2700000   2572.5         200            200            0.0054281609   0.0017023365   0              0.014582146    5.7522031e-17  0              1.1110132e-11  0              0              2.9950157    
   2800000   2572.5         200            200            0.0054281609   0.0017023365   0              0.014582146    6.0893942e-18  0              1.1761402e-12  0              0              2.9950157    
   2900000   2572.5         200            200            0.0054281609   0.0017023365   0              0.014582146    3.7637879e-18  0              7.2695939e-13  0              0              2.9950157    
   3000000   2572.5         200            200            0.0054281609   0.0017023365   0              0.014582146    4.3309585e-19  0              8.3650595e-14  0              0              2.9950157    
Loop time of 180.904 on 2 procs for 3000000 steps with 1251 atoms

Performance: 14328030.628 ns/day, 0.000 hours/ns, 16583.369 timesteps/s
99.9% CPU use with 2 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 40.805     | 41.014     | 41.223     |   3.3 | 22.67
Neigh   | 3.2413     | 3.2417     | 3.242      |   0.0 |  1.79
Comm    | 14.295     | 14.309     | 14.322     |   0.4 |  7.91
Output  | 0.20936    | 0.20939    | 0.20942    |   0.0 |  0.12
Modify  | 109.2      | 109.4      | 109.59     |   1.8 | 60.47
Other   |            | 12.73      |            |       |  7.04

Nlocal:          625.5 ave         626 max         625 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Nghost:            2.5 ave           3 max           2 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Neighs:          368.5 ave         369 max         368 min
Histogram: 1 0 0 0 0 0 0 0 0 1

Total # of neighbors = 737
Ave neighs/atom = 0.5891287
Neighbor list builds = 164
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 44

#variable lat0 equal 1                    #
variable lat1 equal 3+(v_ind*0.01)        # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 250*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 3.44                                                               
Lattice spacing in x,y,z = 3.44 3.44 3.44

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -1290 ${n1e1} -100 100 -100 100 units box
region box block -1290 1290 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -1290 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -1290 1290 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-1290 -100 -100) to (1290 100 100)
  2 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 750 atoms
  using lattice units in orthogonal box = (-1290 -100 -100) to (1290 100 100)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -750 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -750 750 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 501 atoms
  using lattice units in orthogonal box = (-1290 -100 -100) to (1290 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  750 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  750 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  501 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  501 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
750 atoms in group substrate
group slider1 region slider1
501 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 501 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_44_*.dump id type diameter mass xu yu zu fx fy fz

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 1665 130 130
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 71.11 | 71.11 | 71.11 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   2580           200            200            0              0              0              0              0              0              0              0              0              6            
    100000   2580           200            200            0.0039507044  -1.7611775e-35  0              0.011852113    293509.31      0              5.6690056e+10  0              0              3.3256873    
    200000   2580           200            200            0.0014099535  -1.1466001e-38  0              0.0042298604   72359.525      0              1.397593e+10   0              0              3.0726975    
    300000   2580           200            200            0.00011999143 -1.9568598e-36  0              0.00035997428  1062.7807      0              2.0527151e+08  0              0              3.0454687    
    400000   2580           200            200            0.0080346996  -0.0044447764   0              0.028548875    4828.8         0              9.3266187e+08  0              0              2.9940127    
    500000   2580           200            200            0.0026971305  -0.0033487938   0              0.011440185    800.82122      0              1.5467516e+08  0              0              2.9960961    
    600000   2580           200            200            0.0029947699  -0.0023781705   0              0.01136248     83.985639      0              16221464       0              0              2.9961405    
    700000   2580           200            200            0.0035419879  -0.0023464936   0              0.012972457    8.0632172      0              1557375.6      0              0              2.9958923    
    800000   2580           200            200            0.004311495   -0.0024774948   0              0.01541198     0.15314        0              29578.331      0              0              2.995514     
    900000   2580           200            200            0.0039961819  -0.002397885    0              0.014386431    0.21216662     0              40979.068      0              0              2.9956627    
   1000000   2580           200            200            0.0040384915  -0.0024036587   0              0.014519133    0.035240518    0              6806.554       0              0              2.9956438    
   1100000   2580           200            200            0.0040564187  -0.0024072442   0              0.0145765      0.002011729    0              388.55677      0              0              2.9956349    
   1200000   2580           200            200            0.0040402968  -0.0024057455   0              0.014526636    1.381397e-07   0              0.026681087    0              0              2.9956424    
   1300000   2580           200            200            0.0040470435  -0.0024063767   0              0.014547507    3.4092436e-05  0              6.5848069      0              0              2.9956393    
   1400000   2580           200            200            0.0040453459  -0.0024062221   0              0.01454226     1.1566451e-05  0              2.2340101      0              0              2.99564      
   1500000   2580           200            200            0.0040454086  -0.0024062264   0              0.014542452    1.3538385e-06  0              0.26148807     0              0              2.99564      
   1600000   2580           200            200            0.0040456018  -0.0024062449   0              0.01454305     4.3485068e-08  0              0.0083989532   0              0              2.9956399    
   1700000   2580           200            200            0.0040454824  -0.0024062337   0              0.014542681    1.4024892e-09  0              0.00027088474  0              0              2.99564      
   1800000   2580           200            200            0.0040455249  -0.0024062376   0              0.014542812    2.4657487e-09  0              0.00047624872  0              0              2.9956399    
   1900000   2580           200            200            0.0040455166  -0.0024062369   0              0.014542787    5.4955791e-10  0              0.00010614474  0              0              2.9956399    
   2000000   2580           200            200            0.0040455156  -0.0024062368   0              0.014542784    4.5550767e-11  0              8.7979341e-06  0              0              2.99564      
   2100000   2580           200            200            0.0040455173  -0.0024062369   0              0.014542789    5.0086492e-13  0              9.6739897e-08  0              0              2.9956399    
   2200000   2580           200            200            0.0040455165  -0.0024062368   0              0.014542786    2.5512132e-13  0              4.9275581e-08  0              0              2.99564      
   2300000   2580           200            200            0.0040455167  -0.0024062369   0              0.014542787    1.4894315e-13  0              2.8767726e-08  0              0              2.9956399    
   2400000   2580           200            200            0.0040455167  -0.0024062369   0              0.014542787    2.3380085e-14  0              4.5157625e-09  0              0              2.9956399    
   2500000   2580           200            200            0.0040455167  -0.0024062369   0              0.014542787    1.2392335e-15  0              2.393526e-10   0              0              2.9956399    
   2600000   2580           200            200            0.0040455167  -0.0024062369   0              0.014542787    6.964591e-19   0              1.3451807e-13  0              0              2.9956399    
   2700000   2580           200            200            0.0040455167  -0.0024062369   0              0.014542787    3.4845899e-17  0              6.730335e-12   0              0              2.9956399    
   2800000   2580           200            200            0.0040455167  -0.0024062369   0              0.014542787    7.7557943e-18  0              1.4979982e-12  0              0              2.9956399    
   2900000   2580           200            200            0.0040455167  -0.0024062369   0              0.014542787    7.5878252e-19  0              1.4655557e-13  0              0              2.9956399    
   3000000   2580           200            200            0.0040455167  -0.0024062369   0              0.014542787    7.7600458e-19  0              1.4988194e-13  0              0              2.9956399    
Loop time of 180.052 on 2 procs for 3000000 steps with 1251 atoms

Performance: 14395818.121 ns/day, 0.000 hours/ns, 16661.827 timesteps/s
99.9% CPU use with 2 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 41.452     | 41.497     | 41.542     |   0.7 | 23.05
Neigh   | 3.1395     | 3.1397     | 3.1398     |   0.0 |  1.74
Comm    | 13.569     | 13.646     | 13.722     |   2.1 |  7.58
Output  | 0.20921    | 0.20925    | 0.20929    |   0.0 |  0.12
Modify  | 108.75     | 108.78     | 108.81     |   0.3 | 60.42
Other   |            | 12.78      |            |       |  7.10

Nlocal:          625.5 ave         626 max         625 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Nghost:            2.5 ave           3 max           2 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Neighs:          364.5 ave         365 max         364 min
Histogram: 1 0 0 0 0 0 0 0 0 1

Total # of neighbors = 729
Ave neighs/atom = 0.58273381
Neighbor list builds = 164
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 45

#variable lat0 equal 1                    #
variable lat1 equal 3+(v_ind*0.01)        # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 250*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 3.45                                                               
Lattice spacing in x,y,z = 3.45 3.45 3.45

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -1293.75 ${n1e1} -100 100 -100 100 units box
region box block -1293.75 1293.75 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -1293.75 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -1293.75 1293.75 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-1293.75 -100 -100) to (1293.75 100 100)
  2 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 750 atoms
  using lattice units in orthogonal box = (-1293.75 -100 -100) to (1293.75 100 100)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -750 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -750 750 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 501 atoms
  using lattice units in orthogonal box = (-1293.75 -100 -100) to (1293.75 100 100)
  create_atoms CPU = 0.000 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  750 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  750 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  501 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  501 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
750 atoms in group substrate
group slider1 region slider1
501 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 501 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_45_*.dump id type diameter mass xu yu zu fx fy fz

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 1670 130 130
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 71.25 | 71.25 | 71.25 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   2587.5         200            200            0              0              0              0              0              0              0              0              0              6            
    100000   2587.5         200            200            0.0039384957   4.8507773e-41  0              0.011815487    293429.74      0              5.6674688e+10  0              0              3.3257407    
    200000   2587.5         200            200            0.0014045072  -1.9511909e-36  0              0.0042135215   72252.626      0              1.3955283e+10  0              0              3.0727748    
    300000   2587.5         200            200            0.00011134393  2.4389906e-36  0              0.00033403179  927.43575      0              1.7913021e+08  0              0              3.0456269    
    400000   2587.5         200            200            0.009758434   -0.0014560589   0              0.030731361    4779.1945      0              9.2308079e+08  0              0              2.9936715    
    500000   2587.5         200            200            0.002666472   -5.8535765e-36  0              0.007999416    695.62977      0              1.3435789e+08  0              0              2.9964219    
    600000   2587.5         200            200            0.0028579847  -3.9023814e-36  0              0.008573954    4.3175888      0              833923.64      0              0              2.9963365    
    700000   2587.5         200            200            0.0055725304  -0.00049396741  0              0.017211559    0.027617352    0              5334.1724      0              0              2.9949962    
    800000   2587.5         200            200            0.0045272292  -0.00036274306  0              0.013944431    1.3403624      0              258885.21      0              0              2.9954114    
    900000   2587.5         200            200            0.0046616441  -0.00036933261  0              0.014354265    0.23279381     0              44963.119      0              0              2.9953544    
   1000000   2587.5         200            200            0.0047515035  -0.00037303341  0              0.014627544    0.00038706796  0              74.760505      0              0              2.9953191    
   1100000   2587.5         200            200            0.0047004068  -0.00037091996  0              0.01447214     0.0033888642   0              654.5445       0              0              2.9953396    
   1200000   2587.5         200            200            0.0047068053  -0.00037120193  0              0.014491618    0.00056154622  0              108.46023      0              0              2.9953369    
   1300000   2587.5         200            200            0.0047113816  -0.00037139019  0              0.014505535    4.9052373e-07  0              0.094742542    0              0              2.9953351    
   1400000   2587.5         200            200            0.0047088647  -0.00037128443  0              0.014497879    8.6824601e-06  0              1.6769797      0              0              2.9953361    
   1500000   2587.5         200            200            0.0047091563  -0.00037129727  0              0.014498766    1.3436047e-06  0              0.25951144     0              0              2.995336     
   1600000   2587.5         200            200            0.0047093907  -0.00037130692  0              0.014499479    4.3941864e-10  0              8.4871814e-05  0              0              2.9953359    
   1700000   2587.5         200            200            0.0047092666  -0.0003713017   0              0.014499102    2.2177738e-08  0              0.0042835345   0              0              2.995336     
   1800000   2587.5         200            200            0.0047092798  -0.00037130228  0              0.014499142    3.2074223e-09  0              0.00061949977  0              0              2.995336     
   1900000   2587.5         200            200            0.0047092918  -0.00037130278  0              0.014499178    1.2605816e-13  0              2.434759e-08   0              0              2.995336     
   2000000   2587.5         200            200            0.0047092857  -0.00037130252  0              0.01449916     5.6514598e-11  0              1.0915551e-05  0              0              2.995336     
   2100000   2587.5         200            200            0.0047092863  -0.00037130255  0              0.014499161    7.6397634e-12  0              1.4755873e-06  0              0              2.995336     
   2200000   2587.5         200            200            0.0047092869  -0.00037130257  0              0.014499163    2.739069e-16   0              5.2903935e-11  0              0              2.995336     
   2300000   2587.5         200            200            0.0047092866  -0.00037130256  0              0.014499162    1.4374564e-13  0              2.776385e-08   0              0              2.995336     
   2400000   2587.5         200            200            0.0047092866  -0.00037130256  0              0.014499162    1.8047578e-14  0              3.4858118e-09  0              0              2.995336     
   2500000   2587.5         200            200            0.0047092866  -0.00037130256  0              0.014499162    1.0808734e-17  0              2.0876604e-12  0              0              2.995336     
   2600000   2587.5         200            200            0.0047092866  -0.00037130256  0              0.014499162    3.7643808e-16  0              7.270739e-11   0              0              2.995336     
   2700000   2587.5         200            200            0.0047092866  -0.00037130256  0              0.014499162    5.1790145e-17  0              1.0003043e-11  0              0              2.995336     
   2800000   2587.5         200            200            0.0047092866  -0.00037130256  0              0.014499162    4.9849643e-20  0              9.6282434e-15  0              0              2.995336     
   2900000   2587.5         200            200            0.0047092866  -0.00037130256  0              0.014499162    3.784424e-20   0              7.3094516e-15  0              0              2.995336     
   3000000   2587.5         200            200            0.0047092866  -0.00037130256  0              0.014499162    3.6540121e-18  0              7.0575668e-13  0              0              2.995336     
Loop time of 181.496 on 2 procs for 3000000 steps with 1251 atoms

Performance: 14281294.371 ns/day, 0.000 hours/ns, 16529.276 timesteps/s
99.9% CPU use with 2 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 42.061     | 42.209     | 42.358     |   2.3 | 23.26
Neigh   | 3.2708     | 3.2713     | 3.2719     |   0.0 |  1.80
Comm    | 14.341     | 14.383     | 14.424     |   1.1 |  7.92
Output  | 0.21298    | 0.21301    | 0.21303    |   0.0 |  0.12
Modify  | 108.59     | 108.74     | 108.89     |   1.4 | 59.91
Other   |            | 12.68      |            |       |  6.99

Nlocal:          625.5 ave         626 max         625 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Nghost:            2.5 ave           3 max           2 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Neighs:          369.5 ave         370 max         369 min
Histogram: 1 0 0 0 0 0 0 0 0 1

Total # of neighbors = 739
Ave neighs/atom = 0.59072742
Neighbor list builds = 164
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 46

#variable lat0 equal 1                    #
variable lat1 equal 3+(v_ind*0.01)        # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 250*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 3.46                                                               
Lattice spacing in x,y,z = 3.46 3.46 3.46

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -1297.5 ${n1e1} -100 100 -100 100 units box
region box block -1297.5 1297.5 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -1297.5 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -1297.5 1297.5 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-1297.5 -100 -100) to (1297.5 100 100)
  2 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 750 atoms
  using lattice units in orthogonal box = (-1297.5 -100 -100) to (1297.5 100 100)
  create_atoms CPU = 0.000 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -750 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -750 750 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 501 atoms
  using lattice units in orthogonal box = (-1297.5 -100 -100) to (1297.5 100 100)
  create_atoms CPU = 0.000 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  750 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  750 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  501 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  501 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
750 atoms in group substrate
group slider1 region slider1
501 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 501 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_46_*.dump id type diameter mass xu yu zu fx fy fz

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 1675 130 130
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 71.46 | 71.46 | 71.46 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   2595           200            200            0              0              0              0              0              0              0              0              0              6            
    100000   2595           200            200            0.0039274037   6.6106335e-41  0              0.011782211    293458.77      0              5.6680294e+10  0              0              3.3257463    
    200000   2595           200            200            0.0014000877  -4.8638773e-37  0              0.0042002631   72220.345      0              1.3949048e+10  0              0              3.0729597    
    300000   2595           200            200            0.00011578219  4.8973937e-43  0              0.00034734658  1004.2652      0              1.9396949e+08  0              0              3.0455535    
    400000   2595           200            200            0.0052835151  -0.0058773488   0              0.021727894    5080.9953      0              9.8137232e+08  0              0              2.9947962    
    500000   2595           200            200            0.0029550732  -0.010085624    0              0.018950844    770.77746      0              1.4887234e+08  0              0              2.995013     
    600000   2595           200            200            0.0043154652  -0.006353317    0              0.019299713    55.44806       0              10709554       0              0              2.994993     
    700000   2595           200            200            0.0018614103  -0.0074637478   0              0.013047979    9.6222967      0              1858505.1      0              0              2.9958973    
    800000   2595           200            200            0.0020925223  -0.0074493081   0              0.013726875    0.54786003     0              105816.8       0              0              2.9957953    
    900000   2595           200            200            0.0023812089  -0.0074787008   0              0.014622328    0.20442593     0              39483.986      0              0              2.9956564    
   1000000   2595           200            200            0.0023593847  -0.007477752    0              0.014555906    0.011781814    0              2275.6065      0              0              2.9956655    
   1100000   2595           200            200            0.0023186328  -0.0074751227   0              0.014431021    0.0029471291   0              569.22528      0              0              2.9956846    
   1200000   2595           200            200            0.0023239743  -0.0074757692   0              0.014447692    0.00033199783  0              64.123949      0              0              2.9956821    
   1300000   2595           200            200            0.0023290053  -0.0074764265   0              0.014463442    3.7320557e-05  0              7.2083045      0              0              2.9956797    
   1400000   2595           200            200            0.0023279463  -0.0074762924   0              0.014460131    8.2544848e-06  0              1.5943181      0              0              2.9956802    
   1500000   2595           200            200            0.0023273384  -0.0074762122   0              0.014458227    3.9848619e-07  0              0.076965889    0              0              2.9956805    
   1600000   2595           200            200            0.0023275224  -0.0074762357   0              0.014458803    1.853877e-07   0              0.035806835    0              0              2.9956804    
   1700000   2595           200            200            0.0023275921  -0.0074762449   0              0.014459021    3.1610206e-09  0              0.0006105375   0              0              2.9956804    
   1800000   2595           200            200            0.0023275626  -0.0074762411   0              0.014458929    3.8365166e-09  0              0.00074100663  0              0              2.9956804    
   1900000   2595           200            200            0.0023275551  -0.0074762402   0              0.014458906    1.1674209e-11  0              2.2548232e-06  0              0              2.9956804    
   2000000   2595           200            200            0.0023275596  -0.0074762407   0              0.01445892     7.387494e-11   0              1.4268626e-05  0              0              2.9956804    
   2100000   2595           200            200            0.0023275603  -0.0074762408   0              0.014458922    1.3911142e-14  0              2.686877e-09   0              0              2.9956804    
   2200000   2595           200            200            0.0023275597  -0.0074762407   0              0.01445892     1.328306e-12   0              2.5655657e-07  0              0              2.9956804    
   2300000   2595           200            200            0.0023275596  -0.0074762407   0              0.01445892     8.8428526e-15  0              1.7079588e-09  0              0              2.9956804    
   2400000   2595           200            200            0.0023275597  -0.0074762407   0              0.01445892     2.2291338e-14  0              4.3054758e-09  0              0              2.9956804    
   2500000   2595           200            200            0.0023275597  -0.0074762407   0              0.01445892     4.89693e-16    0              9.458209e-11   0              0              2.9956804    
   2600000   2595           200            200            0.0023275597  -0.0074762407   0              0.01445892     3.5765696e-16  0              6.9079898e-11  0              0              2.9956804    
   2700000   2595           200            200            0.0023275597  -0.0074762407   0              0.01445892     1.1398081e-17  0              2.2014901e-12  0              0              2.9956804    
   2800000   2595           200            200            0.0023275597  -0.0074762407   0              0.01445892     6.2822485e-18  0              1.2133892e-12  0              0              2.9956804    
   2900000   2595           200            200            0.0023275597  -0.0074762407   0              0.01445892     5.4927485e-20  0              1.0609007e-14  0              0              2.9956804    
   3000000   2595           200            200            0.0023275597  -0.0074762407   0              0.01445892     6.3411879e-19  0              1.2247731e-13  0              0              2.9956804    
Loop time of 180.64 on 2 procs for 3000000 steps with 1251 atoms

Performance: 14349004.477 ns/day, 0.000 hours/ns, 16607.644 timesteps/s
99.9% CPU use with 2 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 41.382     | 41.648     | 41.914     |   4.1 | 23.06
Neigh   | 3.2861     | 3.2861     | 3.2862     |   0.0 |  1.82
Comm    | 13.762     | 13.956     | 14.15      |   5.2 |  7.73
Output  | 0.22303    | 0.22307    | 0.2231     |   0.0 |  0.12
Modify  | 108.44     | 108.52     | 108.6      |   0.8 | 60.07
Other   |            | 13.01      |            |       |  7.20

Nlocal:          625.5 ave         626 max         625 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Nghost:            2.5 ave           3 max           2 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Neighs:          365.5 ave         366 max         365 min
Histogram: 1 0 0 0 0 0 0 0 0 1

Total # of neighbors = 731
Ave neighs/atom = 0.58433253
Neighbor list builds = 164
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 47

#variable lat0 equal 1                    #
variable lat1 equal 3+(v_ind*0.01)        # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 250*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 3.47                                                               
Lattice spacing in x,y,z = 3.47 3.47 3.47

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -1301.25 ${n1e1} -100 100 -100 100 units box
region box block -1301.25 1301.25 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -1301.25 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -1301.25 1301.25 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-1301.25 -100 -100) to (1301.25 100 100)
  2 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 750 atoms
  using lattice units in orthogonal box = (-1301.25 -100 -100) to (1301.25 100 100)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -750 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -750 750 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 501 atoms
  using lattice units in orthogonal box = (-1301.25 -100 -100) to (1301.25 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  750 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  750 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  501 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  501 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
750 atoms in group substrate
group slider1 region slider1
501 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 501 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_47_*.dump id type diameter mass xu yu zu fx fy fz

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 1680 130 130
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 71.59 | 71.59 | 71.59 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   2602.5         200            200            0              0              0              0              0              0              0              0              0              6            
    100000   2602.5         200            200            0.003915128    8.5873862e-43  0              0.011745384    293355.27      0              5.6660304e+10  0              0              3.3258518    
    200000   2602.5         200            200            0.0013939947   1.4549601e-36  0              0.0041819841   72056.068      0              1.3917319e+10  0              0              3.0731455    
    300000   2602.5         200            200            0.00011194429 -2.424932e-37   0              0.00033583286  947.33196      0              1.8297308e+08  0              0              3.0455083    
    400000   2602.5         200            200            0.0057359424  -0.00094638349  0              0.018154211    5154.905       0              9.9564766e+08  0              0              2.9951409    
    500000   2602.5         200            200            0.0070238122  -0.0016681032   0              0.02273954     660.36756      0              1.2754715e+08  0              0              2.9944147    
    600000   2602.5         200            200            0.0064965877  -0.0010448618   0              0.020534625    23.471985      0              4533512.6      0              0              2.994711     
    700000   2602.5         200            200            0.0044395939  -0.00072111001  0              0.014039892    14.570344      0              2814199.1      0              0              2.9956157    
    800000   2602.5         200            200            0.0042813459  -0.00071479307  0              0.013558831    0.013946464    0              2693.6993      0              0              2.9956969    
    900000   2602.5         200            200            0.0045795639  -0.00073978048  0              0.014478472    0.26181206     0              50567.87       0              0              2.9955553    
   1000000   2602.5         200            200            0.0045950166  -0.00074326309  0              0.014528313    0.0035033001   0              676.64729      0              0              2.9955469    
   1100000   2602.5         200            200            0.0045524825  -0.00074044676  0              0.014397894    0.0040357234   0              779.48256      0              0              2.9955667    
   1200000   2602.5         200            200            0.00455428    -0.00074055056  0              0.01440339     0.00019365289  0              37.403219      0              0              2.9955659    
   1300000   2602.5         200            200            0.0045598475  -0.00074092901  0              0.014420471    5.2998301e-05  0              10.236393      0              0              2.9955633    
   1400000   2602.5         200            200            0.0045590846  -0.00074087986  0              0.014418134    6.5570891e-06  0              1.2664735      0              0              2.9955637    
   1500000   2602.5         200            200            0.0045584039  -0.00074083346  0              0.014416045    5.5291601e-07  0              0.10679334     0              0              2.995564     
   1600000   2602.5         200            200            0.0045585706  -0.00074084445  0              0.014416556    1.7253968e-07  0              0.033325294    0              0              2.9955639    
   1700000   2602.5         200            200            0.004558647   -0.00074084969  0              0.014416791    3.7903304e-09  0              0.00073208596  0              0              2.9955639    
   1800000   2602.5         200            200            0.0045586173  -0.00074084772  0              0.0144167      3.8262804e-09  0              0.00073902955  0              0              2.9955639    
   1900000   2602.5         200            200            0.0045586098  -0.00074084719  0              0.014416677    6.391443e-12   0              1.2344796e-06  0              0              2.9955639    
   2000000   2602.5         200            200            0.0045586145  -0.00074084751  0              0.014416691    7.3796076e-11  0              1.4253394e-05  0              0              2.9955639    
   2100000   2602.5         200            200            0.0045586151  -0.00074084755  0              0.014416693    2.1376455e-13  0              4.12877e-08    0              0              2.9955639    
   2200000   2602.5         200            200            0.0045586144  -0.0007408475   0              0.014416691    1.2472563e-12  0              2.4090217e-07  0              0              2.9955639    
   2300000   2602.5         200            200            0.0045586144  -0.0007408475   0              0.014416691    2.7893773e-14  0              5.3875619e-09  0              0              2.9955639    
   2400000   2602.5         200            200            0.0045586145  -0.00074084751  0              0.014416691    1.8326909e-14  0              3.5397634e-09  0              0              2.9955639    
   2500000   2602.5         200            200            0.0045586144  -0.00074084751  0              0.014416691    1.1998985e-15  0              2.3175522e-10  0              0              2.9955639    
   2600000   2602.5         200            200            0.0045586144  -0.00074084751  0              0.014416691    2.3549877e-16  0              4.5485572e-11  0              0              2.9955639    
   2700000   2602.5         200            200            0.0045586144  -0.00074084751  0              0.014416691    2.9498729e-17  0              5.6975521e-12  0              0              2.9955639    
   2800000   2602.5         200            200            0.0045586144  -0.00074084751  0              0.014416691    3.128244e-18   0              6.0420683e-13  0              0              2.9955639    
   2900000   2602.5         200            200            0.0045586144  -0.00074084751  0              0.014416691    3.3587082e-19  0              6.4872e-14     0              0              2.9955639    
   3000000   2602.5         200            200            0.0045586144  -0.00074084751  0              0.014416691    5.8919409e-20  0              1.138003e-14   0              0              2.9955639    
Loop time of 181.177 on 2 procs for 3000000 steps with 1251 atoms

Performance: 14306461.464 ns/day, 0.000 hours/ns, 16558.404 timesteps/s
99.9% CPU use with 2 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 41.435     | 41.455     | 41.475     |   0.3 | 22.88
Neigh   | 3.2783     | 3.2783     | 3.2784     |   0.0 |  1.81
Comm    | 13.857     | 13.961     | 14.065     |   2.8 |  7.71
Output  | 0.21313    | 0.21316    | 0.21319    |   0.0 |  0.12
Modify  | 109.25     | 109.27     | 109.29     |   0.2 | 60.31
Other   |            | 13         |            |       |  7.18

Nlocal:          625.5 ave         626 max         625 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Nghost:            2.5 ave           3 max           2 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Neighs:          363.5 ave         364 max         363 min
Histogram: 1 0 0 0 0 0 0 0 0 1

Total # of neighbors = 727
Ave neighs/atom = 0.58113509
Neighbor list builds = 164
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 48

#variable lat0 equal 1                    #
variable lat1 equal 3+(v_ind*0.01)        # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 250*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 3.48                                                               
Lattice spacing in x,y,z = 3.48 3.48 3.48

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -1305 ${n1e1} -100 100 -100 100 units box
region box block -1305 1305 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -1305 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -1305 1305 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-1305 -100 -100) to (1305 100 100)
  2 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 750 atoms
  using lattice units in orthogonal box = (-1305 -100 -100) to (1305 100 100)
  create_atoms CPU = 0.000 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -750 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -750 750 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 501 atoms
  using lattice units in orthogonal box = (-1305 -100 -100) to (1305 100 100)
  create_atoms CPU = 0.000 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  750 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  750 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  501 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  501 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
750 atoms in group substrate
group slider1 region slider1
501 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 501 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_48_*.dump id type diameter mass xu yu zu fx fy fz

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 1684 130 130
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 71.73 | 71.73 | 71.73 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   2610           200            200            0              0              0              0              0              0              0              0              0              6            
    100000   2610           200            200            0.0039041905   6.2823569e-46  0              0.011712572    293388.92      0              5.6666804e+10  0              0              3.3258213    
    200000   2610           200            200            0.001391053   -2.4179641e-37  0              0.0041731591   72142.512      0              1.3934015e+10  0              0              3.0729949    
    300000   2610           200            200            0.00011502745  8.7991462e-45  0              0.00034508236  1002.8639      0              1.9369884e+08  0              0              3.0454289    
    400000   2610           200            200            0.0041697798  -0.00092000157  0              0.013429341    5210.4588      0              1.0063776e+09  0              0              2.9958789    
    500000   2610           200            200            0.0048494738  -0.0024878678   0              0.017036289    829.44186      0              1.6020312e+08  0              0              2.9952301    
    600000   2610           200            200            0.0053362799  -0.0015035071   0              0.017512347    93.94905       0              18145853       0              0              2.9952179    
    700000   2610           200            200            0.0051282526  -0.001486035    0              0.016870793    0.94335699     0              182205.33      0              0              2.9952897    
    800000   2610           200            200            0.0045021022  -0.001448607    0              0.014954914    1.2554931      0              242493.08      0              0              2.9955433    
    900000   2610           200            200            0.0042617145  -0.0014302287   0              0.014215372    0.21989995     0              42472.726      0              0              2.9956465    
   1000000   2610           200            200            0.0042734046  -0.0014310328   0              0.014251247    0.00025403437  0              49.065642      0              0              2.9956421    
   1100000   2610           200            200            0.004309253   -0.0014338678   0              0.014361627    0.004619332    0              892.20405      0              0              2.9956268    
   1200000   2610           200            200            0.0043179448  -0.0014345646   0              0.014388399    0.00029584754  0              57.141675      0              0              2.995623     
   1300000   2610           200            200            0.0043155688  -0.0014343842   0              0.01438109     1.8342811e-05  0              3.5428348      0              0              2.995624     
   1400000   2610           200            200            0.0043137194  -0.0014342387   0              0.014375397    1.2540347e-05  0              2.4221138      0              0              2.9956248    
   1500000   2610           200            200            0.0043135138  -0.0014342217   0              0.014374763    1.8468694e-07  0              0.035671486    0              0              2.9956249    
   1600000   2610           200            200            0.004313705   -0.0014342365   0              0.014375352    1.2661017e-07  0              0.024454208    0              0              2.9956248    
   1700000   2610           200            200            0.0043137872  -0.0014342431   0              0.014375605    2.5380639e-08  0              0.0049021609   0              0              2.9956248    
   1800000   2610           200            200            0.0043137848  -0.0014342429   0              0.014375597    7.2693829e-12  0              1.4040499e-06  0              0              2.9956248    
   1900000   2610           200            200            0.004313773   -0.001434242    0              0.014375561    4.9633638e-10  0              9.586523e-05   0              0              2.9956248    
   2000000   2610           200            200            0.00431377    -0.0014342417   0              0.014375552    3.5730307e-11  0              6.9011547e-06  0              0              2.9956248    
   2100000   2610           200            200            0.0043137707  -0.0014342418   0              0.014375554    1.7077065e-12  0              3.2983613e-07  0              0              2.9956248    
   2200000   2610           200            200            0.0043137713  -0.0014342418   0              0.014375556    1.3904726e-12  0              2.6856378e-07  0              0              2.9956248    
   2300000   2610           200            200            0.0043137714  -0.0014342419   0              0.014375556    2.5459947e-14  0              4.9174789e-09  0              0              2.9956248    
   2400000   2610           200            200            0.0043137713  -0.0014342419   0              0.014375556    1.2904616e-14  0              2.4924709e-09  0              0              2.9956248    
   2500000   2610           200            200            0.0043137713  -0.0014342418   0              0.014375556    2.9049497e-15  0              5.6107849e-10  0              0              2.9956248    
   2600000   2610           200            200            0.0043137713  -0.0014342418   0              0.014375556    2.6829557e-19  0              5.1820131e-14  0              0              2.9956248    
   2700000   2610           200            200            0.0043137713  -0.0014342418   0              0.014375556    4.135647e-17   0              7.9878238e-12  0              0              2.9956248    
   2800000   2610           200            200            0.0043137713  -0.0014342418   0              0.014375556    5.9033692e-18  0              1.1402103e-12  0              0              2.9956248    
   2900000   2610           200            200            0.0043137713  -0.0014342418   0              0.014375556    3.6295895e-20  0              7.0103955e-15  0              0              2.9956248    
   3000000   2610           200            200            0.0043137713  -0.0014342418   0              0.014375556    2.757804e-18   0              5.3265794e-13  0              0              2.9956248    
Loop time of 183.554 on 2 procs for 3000000 steps with 1251 atoms

Performance: 14121215.960 ns/day, 0.000 hours/ns, 16344.000 timesteps/s
99.9% CPU use with 2 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 41.874     | 41.936     | 41.998     |   1.0 | 22.85
Neigh   | 3.2801     | 3.2804     | 3.2807     |   0.0 |  1.79
Comm    | 14.572     | 14.686     | 14.799     |   3.0 |  8.00
Output  | 0.21335    | 0.21338    | 0.21342    |   0.0 |  0.12
Modify  | 110.2      | 110.44     | 110.68     |   2.3 | 60.17
Other   |            | 13         |            |       |  7.08

Nlocal:          625.5 ave         626 max         625 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Nghost:            2.5 ave           3 max           2 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Neighs:          362.5 ave         363 max         362 min
Histogram: 1 0 0 0 0 0 0 0 0 1

Total # of neighbors = 725
Ave neighs/atom = 0.57953637
Neighbor list builds = 164
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 49

#variable lat0 equal 1                    #
variable lat1 equal 3+(v_ind*0.01)        # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 250*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 3.49                                                               
Lattice spacing in x,y,z = 3.49 3.49 3.49

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -1308.75 ${n1e1} -100 100 -100 100 units box
region box block -1308.75 1308.75 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -1308.75 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -1308.75 1308.75 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-1308.75 -100 -100) to (1308.75 100 100)
  2 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 750 atoms
  using lattice units in orthogonal box = (-1308.75 -100 -100) to (1308.75 100 100)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -750 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -750 750 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 501 atoms
  using lattice units in orthogonal box = (-1308.75 -100 -100) to (1308.75 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  750 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  750 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  501 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  501 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
750 atoms in group substrate
group slider1 region slider1
501 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 501 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_49_*.dump id type diameter mass xu yu zu fx fy fz

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 1689 130 130
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 71.94 | 71.94 | 71.94 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   2617.5         200            200            0              0              0              0              0              0              0              0              0              6            
    100000   2617.5         200            200            0.0038931676   5.7864942e-36  0              0.011679503    293399.9       0              5.6668925e+10  0              0              3.3259134    
    200000   2617.5         200            200            0.0013860606  -3.8576518e-36  0              0.0041581819   72054.302      0              1.3916977e+10  0              0              3.0734008    
    300000   2617.5         200            200            0.00011225905 -2.8932411e-36  0              0.00033677715  962.69943      0              1.8594124e+08  0              0              3.0457159    
    400000   2617.5         200            200            0.0069479478  -0.0030793596   0              0.023923203    5030.9806      0              9.717122e+08   0              0              2.9945774    
    500000   2617.5         200            200            0.0026702716  -0.0011932036   0              0.0092040185   755.84767      0              1.4598871e+08  0              0              2.9965264    
    600000   2617.5         200            200            0.0025922934  -0.0010316814   0              0.0088085616   20.667971      0              3991929.4      0              0              2.9966418    
    700000   2617.5         200            200            0.0048749418  -0.0019557817   0              0.016580607    2.879592       0              556180.78      0              0              2.9954043    
    800000   2617.5         200            200            0.0039055609  -0.0017546277   0              0.013471311    0.056228378    0              10860.269      0              0              2.9958528    
    900000   2617.5         200            200            0.0042840976  -0.0018092      0              0.014661493    6.999088e-05   0              13.518436      0              0              2.9956737    
   1000000   2617.5         200            200            0.0041398908  -0.0017975667   0              0.014217239    0.00076724671  0              148.19039      0              0              2.9957397    
   1100000   2617.5         200            200            0.0041912129  -0.001803274    0              0.014376913    0.00038554173  0              74.465721      0              0              2.9957157    
   1200000   2617.5         200            200            0.0041729333  -0.0018014845   0              0.014320284    0.00012087399  0              23.34629       0              0              2.9957242    
   1300000   2617.5         200            200            0.0041791835  -0.0018021581   0              0.014339709    2.8705432e-05  0              5.5443304      0              0              2.9957213    
   1400000   2617.5         200            200            0.0041771148  -0.0018019106   0              0.014333255    5.7787755e-06  0              1.1161456      0              0              2.9957222    
   1500000   2617.5         200            200            0.0041777749  -0.0018019898   0              0.014335314    1.0429418e-06  0              0.2014397      0              0              2.9957219    
   1600000   2617.5         200            200            0.0041775753  -0.0018019656   0              0.014334691    1.7346275e-07  0              0.033503581    0              0              2.995722     
   1700000   2617.5         200            200            0.004177631   -0.0018019724   0              0.014334865    2.7009386e-08  0              0.0052167463   0              0              2.995722     
   1800000   2617.5         200            200            0.0041776175  -0.0018019708   0              0.014334823    3.9721398e-09  0              0.00076720166  0              0              2.995722     
   1900000   2617.5         200            200            0.0041776198  -0.0018019711   0              0.01433483     5.5433979e-10  0              0.00010706834  0              0              2.995722     
   2000000   2617.5         200            200            0.00417762    -0.0018019711   0              0.014334831    7.3543077e-11  0              1.4204528e-05  0              0              2.995722     
   2100000   2617.5         200            200            0.0041776195  -0.001801971    0              0.01433483     9.2669623e-12  0              1.7898738e-06  0              0              2.995722     
   2200000   2617.5         200            200            0.0041776198  -0.0018019711   0              0.014334831    1.1043418e-12  0              2.1329885e-07  0              0              2.995722     
   2300000   2617.5         200            200            0.0041776197  -0.001801971    0              0.01433483     1.2324409e-13  0              2.3804065e-08  0              0              2.995722     
   2400000   2617.5         200            200            0.0041776197  -0.0018019711   0              0.01433483     1.2736829e-14  0              2.4600636e-09  0              0              2.995722     
   2500000   2617.5         200            200            0.0041776197  -0.001801971    0              0.01433483     1.1874763e-15  0              2.2935591e-10  0              0              2.995722     
   2600000   2617.5         200            200            0.0041776197  -0.001801971    0              0.01433483     1.0504726e-16  0              2.0289425e-11  0              0              2.995722     
   2700000   2617.5         200            200            0.0041776197  -0.001801971    0              0.01433483     1.4942433e-17  0              2.8860665e-12  0              0              2.995722     
   2800000   2617.5         200            200            0.0041776197  -0.001801971    0              0.01433483     1.0964678e-18  0              2.1177802e-13  0              0              2.995722     
   2900000   2617.5         200            200            0.0041776197  -0.001801971    0              0.01433483     1.6807654e-21  0              3.2463259e-16  0              0              2.995722     
   3000000   2617.5         200            200            0.0041776197  -0.0018019711   0              0.01433483     1.375805e-20   0              2.657308e-15   0              0              2.995722     
Loop time of 180.813 on 2 procs for 3000000 steps with 1251 atoms

Performance: 14335277.659 ns/day, 0.000 hours/ns, 16591.757 timesteps/s
99.9% CPU use with 2 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 41.536     | 41.55      | 41.564     |   0.2 | 22.98
Neigh   | 3.3045     | 3.3047     | 3.3048     |   0.0 |  1.83
Comm    | 14.005     | 14.126     | 14.247     |   3.2 |  7.81
Output  | 0.21376    | 0.21378    | 0.21381    |   0.0 |  0.12
Modify  | 108.7      | 108.74     | 108.77     |   0.4 | 60.14
Other   |            | 12.88      |            |       |  7.12

Nlocal:          625.5 ave         626 max         625 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Nghost:            2.5 ave           3 max           2 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Neighs:          363.5 ave         364 max         363 min
Histogram: 1 0 0 0 0 0 0 0 0 1

Total # of neighbors = 727
Ave neighs/atom = 0.58113509
Neighbor list builds = 164
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 50

#variable lat0 equal 1                    #
variable lat1 equal 3+(v_ind*0.01)        # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 250*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 3.5                                                               
Lattice spacing in x,y,z = 3.5 3.5 3.5

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -1312.5 ${n1e1} -100 100 -100 100 units box
region box block -1312.5 1312.5 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -1312.5 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -1312.5 1312.5 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-1312.5 -100 -100) to (1312.5 100 100)
  2 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 750 atoms
  using lattice units in orthogonal box = (-1312.5 -100 -100) to (1312.5 100 100)
  create_atoms CPU = 0.000 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -750 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -750 750 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 501 atoms
  using lattice units in orthogonal box = (-1312.5 -100 -100) to (1312.5 100 100)
  create_atoms CPU = 0.000 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  750 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  750 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  501 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  501 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
750 atoms in group substrate
group slider1 region slider1
501 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 501 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_50_*.dump id type diameter mass xu yu zu fx fy fz

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 1694 130 130
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 72.08 | 72.08 | 72.08 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   2625           200            200            0              0              0              0              0              0              0              0              0              6            
    100000   2625           200            200            0.0038704841  -1.4424879e-36  0              0.011611452    291841.07      0              5.6367844e+10  0              0              3.3320384    
    200000   2625           200            200            0.0013495843  -1.9233178e-36  0              0.0040487528   69308.477      0              1.3386633e+10  0              0              3.0825793    
    300000   2625           200            200            9.075201e-05  -4.8082878e-37  0              0.00027225603  644.43881      0              1.2447057e+08  0              0              3.0490222    
    400000   2625           200            200            0.024414249    2.4041479e-37  0              0.073242746    1310.4883      0              2.5311516e+08  0              0              2.9931468    
    500000   2625           200            200            0.00028274528  1.8031107e-36  0              0.00084823584  480.34786      0              92777116       0              0              2.999592     
    600000   2625           200            200            0.0033939212   4.2072582e-37  0              0.010181764    102.00358      0              19701551       0              0              2.998169     
    700000   2625           200            200            0.0039026481   9.0155533e-38  0              0.011707944    5.1845076      0              1001365.3      0              0              2.9979791    
    800000   2625           200            200            0.004418206    6.0103689e-38  0              0.013254618    0.38496441     0              74354.214      0              0              2.9978025    
    900000   2625           200            200            0.0046331994  -1.2020738e-37  0              0.013899598    0.027663504    0              5343.0863      0              0              2.9977312    
   1000000   2625           200            200            0.0047168845   2.704666e-37   0              0.014150654    0.0014962379   0              288.9919       0              0              2.9977038    
   1100000   2625           200            200            0.0047487761   3.0051844e-38  0              0.014246328    3.4084328e-05  0              6.5832409      0              0              2.9976934    
   1200000   2625           200            200            0.0047607578  -3.0051844e-38  0              0.014282273    9.1322936e-07  0              0.17638631     0              0              2.9976896    
   1300000   2625           200            200            0.0047652035   6.0103688e-38  0              0.01429561     2.2080356e-06  0              0.42647255     0              0              2.9976881    
   1400000   2625           200            200            0.0047668336   3.0051844e-38  0              0.014300501    9.1475615e-07  0              0.1766812      0              0              2.9976876    
   1500000   2625           200            200            0.0047674244  -2.704666e-37   0              0.014302273    2.4809388e-07  0              0.047918263    0              0              2.9976874    
   1600000   2625           200            200            0.0047676359   8.0959677e-47  0              0.014302908    5.5112629e-08  0              0.010644766    0              0              2.9976873    
   1700000   2625           200            200            0.0047677107   6.0103688e-38  0              0.014303132    1.0871254e-08  0              0.0020997357   0              0              2.9976873    
   1800000   2625           200            200            0.0047677368  -3.0051844e-38  0              0.01430321     1.9785068e-09  0              0.00038214005  0              0              2.9976873    
   1900000   2625           200            200            0.0047677458  -6.0103688e-38  0              0.014303237    3.3932372e-10  0              6.5538913e-05  0              0              2.9976873    
   2000000   2625           200            200            0.0047677488   9.0155532e-38  0              0.014303246    5.5545632e-11  0              1.0728399e-05  0              0              2.9976873    
   2100000   2625           200            200            0.0047677498  -3.0051844e-38  0              0.014303249    8.7509128e-12  0              1.690201e-06   0              0              2.9976873    
   2200000   2625           200            200            0.0047677501   2.1036291e-37  0              0.01430325     1.3345731e-12  0              2.5776703e-07  0              0              2.9976873    
   2300000   2625           200            200            0.0047677502   1.045107e-47   0              0.014303251    1.9776054e-13  0              3.8196596e-08  0              0              2.9976873    
   2400000   2625           200            200            0.0047677503   9.0155532e-38  0              0.014303251    2.8633701e-14  0              5.5304757e-09  0              0              2.9976873    
   2500000   2625           200            200            0.0047677503  -1.5025922e-37  0              0.014303251    4.0255424e-15  0              7.7751615e-10  0              0              2.9976873    
   2600000   2625           200            200            0.0047677503   6.0103688e-38  0              0.014303251    5.5199246e-16  0              1.0661496e-10  0              0              2.9976873    
   2700000   2625           200            200            0.0047677503   1.0052033e-47  0              0.014303251    6.461799e-17   0              1.2480686e-11  0              0              2.9976873    
   2800000   2625           200            200            0.0047677503  -8.1139979e-37  0              0.014303251    6.4391025e-20  0              1.2436849e-14  0              0              2.9976873    
   2900000   2625           200            200            0.0047677503   2.704666e-37   0              0.014303251    1.1275718e-18  0              2.1778562e-13  0              0              2.9976873    
   3000000   2625           200            200            0.0047677503   1.9599572e-46  0              0.014303251    1.3446473e-18  0              2.5971282e-13  0              0              2.9976873    
Loop time of 182.475 on 2 procs for 3000000 steps with 1251 atoms

Performance: 14204649.972 ns/day, 0.000 hours/ns, 16440.567 timesteps/s
99.9% CPU use with 2 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 42.375     | 42.436     | 42.496     |   0.9 | 23.26
Neigh   | 3.329      | 3.3291     | 3.3291     |   0.0 |  1.82
Comm    | 14.202     | 14.21      | 14.219     |   0.2 |  7.79
Output  | 0.20915    | 0.20919    | 0.20923    |   0.0 |  0.11
Modify  | 109.15     | 109.21     | 109.27     |   0.6 | 59.85
Other   |            | 13.08      |            |       |  7.17

Nlocal:          625.5 ave         626 max         625 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Nghost:            2.5 ave           3 max           2 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Neighs:          356.5 ave         357 max         356 min
Histogram: 1 0 0 0 0 0 0 0 0 1

Total # of neighbors = 713
Ave neighs/atom = 0.56994404
Neighbor list builds = 166
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 51

#variable lat0 equal 1                    #
variable lat1 equal 3+(v_ind*0.01)        # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 250*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 3.51                                                               
Lattice spacing in x,y,z = 3.51 3.51 3.51

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -1316.25 ${n1e1} -100 100 -100 100 units box
region box block -1316.25 1316.25 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -1316.25 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -1316.25 1316.25 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-1316.25 -100 -100) to (1316.25 100 100)
  2 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 750 atoms
  using lattice units in orthogonal box = (-1316.25 -100 -100) to (1316.25 100 100)
  create_atoms CPU = 0.000 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -750 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -750 750 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 501 atoms
  using lattice units in orthogonal box = (-1316.25 -100 -100) to (1316.25 100 100)
  create_atoms CPU = 0.000 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  750 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  750 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  501 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  501 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
750 atoms in group substrate
group slider1 region slider1
501 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 501 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_51_*.dump id type diameter mass xu yu zu fx fy fz

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 1699 130 130
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 72.29 | 72.29 | 72.29 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   2632.5         200            200            0              0              0              0              0              0              0              0              0              6            
    100000   2632.5         200            200            0.003870269    1.9178407e-36  0              0.011610807    293316.35      0              5.6652788e+10  0              0              3.3260793    
    200000   2632.5         200            200            0.001376445   -9.5891716e-37  0              0.0041293351   71912.855      0              1.3889658e+10  0              0              3.0736784    
    300000   2632.5         200            200            0.00010927818 -4.794588e-37   0              0.00032783453  924.75606      0              1.7861264e+08  0              0              3.0457565    
    400000   2632.5         200            200            0.0076604269   0.0025164708   0              0.02046481     5132.6741      0              9.9135385e+08  0              0              2.9949853    
    500000   2632.5         200            200            0.0045506189   0.0021072148   0              0.011544642    811.60795      0              1.5675857e+08  0              0              2.9961076    
    600000   2632.5         200            200            0.003729578    0.00153598     0              0.0096527539   50.800946      0              9811983.5      0              0              2.9964738    
    700000   2632.5         200            200            0.0061394963   0.0021579061   0              0.016260583    5.2591602      0              1015784.1      0              0              2.9954437    
    800000   2632.5         200            200            0.0051203051   0.0019739837   0              0.013386932    0.048364285    0              9341.3529      0              0              2.9958601    
    900000   2632.5         200            200            0.0054873466   0.0020343447   0              0.014427695    0.19524055     0              37709.869      0              0              2.9957029    
   1000000   2632.5         200            200            0.0054384565   0.0020290668   0              0.014286303    0.034626349    0              6687.9298      0              0              2.9957247    
   1100000   2632.5         200            200            0.0054132889   0.0020264639   0              0.014213403    0.0009408512   0              181.72135      0              0              2.9957352    
   1200000   2632.5         200            200            0.0054321549   0.002028472    0              0.014267993    0.00010495827  0              20.272237      0              0              2.9957271    
   1300000   2632.5         200            200            0.0054264119   0.0020278546   0              0.014251381    8.299204e-05   0              16.029554      0              0              2.9957296    
   1400000   2632.5         200            200            0.0054266482   0.0020278842   0              0.01425206     9.2008834e-06  0              1.7771109      0              0              2.9957295    
   1500000   2632.5         200            200            0.0054273092   0.0020279534   0              0.014253974    5.7748086e-08  0              0.011153794    0              0              2.9957292    
   1600000   2632.5         200            200            0.0054269569   0.0020279159   0              0.014252955    8.5921716e-08  0              0.016595409    0              0              2.9957294    
   1700000   2632.5         200            200            0.0054270384   0.0020279247   0              0.014253191    3.0470215e-08  0              0.0058851906   0              0              2.9957294    
   1800000   2632.5         200            200            0.0054270465   0.0020279255   0              0.014253214    2.0287181e-09  0              0.00039183816  0              0              2.9957294    
   1900000   2632.5         200            200            0.0054270315   0.0020279239   0              0.014253171    3.0155047e-12  0              5.8243171e-07  0              0              2.9957294    
   2000000   2632.5         200            200            0.0054270377   0.0020279246   0              0.014253188    4.7947041e-11  0              9.260764e-06   0              0              2.9957294    
   2100000   2632.5         200            200            0.0054270367   0.0020279245   0              0.014253186    9.7487828e-12  0              1.8829353e-06  0              0              2.9957294    
   2200000   2632.5         200            200            0.0054270364   0.0020279244   0              0.014253185    3.3509883e-13  0              6.4722892e-08  0              0              2.9957294    
   2300000   2632.5         200            200            0.0054270367   0.0020279245   0              0.014253186    1.9691584e-14  0              3.8033444e-09  0              0              2.9957294    
   2400000   2632.5         200            200            0.0054270366   0.0020279245   0              0.014253185    2.1378911e-14  0              4.1292445e-09  0              0              2.9957294    
   2500000   2632.5         200            200            0.0054270366   0.0020279245   0              0.014253185    2.7132015e-15  0              5.2404317e-10  0              0              2.9957294    
   2600000   2632.5         200            200            0.0054270366   0.0020279245   0              0.014253185    3.1695743e-17  0              6.121896e-12   0              0              2.9957294    
   2700000   2632.5         200            200            0.0054270366   0.0020279245   0              0.014253185    8.8239815e-18  0              1.704314e-12   0              0              2.9957294    
   2800000   2632.5         200            200            0.0054270366   0.0020279245   0              0.014253185    6.7103034e-18  0              1.2960661e-12  0              0              2.9957294    
   2900000   2632.5         200            200            0.0054270366   0.0020279245   0              0.014253185    1.4267242e-18  0              2.7556563e-13  0              0              2.9957294    
   3000000   2632.5         200            200            0.0054270366   0.0020279245   0              0.014253185    1.0748954e-19  0              2.0761141e-14  0              0              2.9957294    
Loop time of 182.891 on 2 procs for 3000000 steps with 1251 atoms

Performance: 14172377.610 ns/day, 0.000 hours/ns, 16403.215 timesteps/s
99.9% CPU use with 2 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 41.51      | 42.06      | 42.61      |   8.5 | 23.00
Neigh   | 3.3278     | 3.3279     | 3.328      |   0.0 |  1.82
Comm    | 13.745     | 14.243     | 14.742     |  13.2 |  7.79
Output  | 0.21539    | 0.21542    | 0.21545    |   0.0 |  0.12
Modify  | 109.84     | 109.86     | 109.88     |   0.2 | 60.07
Other   |            | 13.18      |            |       |  7.21

Nlocal:          625.5 ave         626 max         625 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Nghost:            2.5 ave           3 max           2 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Neighs:          363.5 ave         364 max         363 min
Histogram: 1 0 0 0 0 0 0 0 0 1

Total # of neighbors = 727
Ave neighs/atom = 0.58113509
Neighbor list builds = 164
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 52

#variable lat0 equal 1                    #
variable lat1 equal 3+(v_ind*0.01)        # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 250*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 3.52                                                               
Lattice spacing in x,y,z = 3.52 3.52 3.52

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -1320 ${n1e1} -100 100 -100 100 units box
region box block -1320 1320 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -1320 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -1320 1320 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-1320 -100 -100) to (1320 100 100)
  2 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 750 atoms
  using lattice units in orthogonal box = (-1320 -100 -100) to (1320 100 100)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -750 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -750 750 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 501 atoms
  using lattice units in orthogonal box = (-1320 -100 -100) to (1320 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  750 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  750 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  501 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  501 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
750 atoms in group substrate
group slider1 region slider1
501 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 501 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_52_*.dump id type diameter mass xu yu zu fx fy fz

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 1704 130 130
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 72.43 | 72.43 | 72.43 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   2640           200            200            0              0              0              0              0              0              0              0              0              6            
    100000   2640           200            200            0.0038593481   2.868586e-36   0              0.011578044    293333.32      0              5.6656064e+10  0              0              3.3259286    
    200000   2640           200            200            0.0013737715  -4.7809735e-37  0              0.0041213145   72020.177      0              1.3910386e+10  0              0              3.0732573    
    300000   2640           200            200            0.00011013817  7.171464e-37   0              0.00033041452  943.80067      0              1.8229103e+08  0              0              3.0455431    
    400000   2640           200            200            0.0058421561   0.00022778988  0              0.017298679    5158.8628      0              9.9641208e+08  0              0              2.9952561    
    500000   2640           200            200            0.0091361875   0.0023313973   0              0.025077165    551.08579      0              1.0643984e+08  0              0              2.9941325    
    600000   2640           200            200            0.0073717816   0.0010517682   0              0.021063577    0.64538398     0              124653.13      0              0              2.9946473    
    700000   2640           200            200            0.0055479999   0.00035947068  0              0.016284529    3.7195143      0              718408.13      0              0              2.9952811    
    800000   2640           200            200            0.0048393451   0.00018651973  0              0.014331516    1.9701614      0              380528.18      0              0              2.9955705    
    900000   2640           200            200            0.0046930971   0.00015099182  0              0.0139283      0.049868007    0              9631.7903      0              0              2.9956352    
   1000000   2640           200            200            0.0047682174   0.00016344391  0              0.014141208    0.022417141    0              4329.7739      0              0              2.9956024    
   1100000   2640           200            200            0.0048013057   0.00016465374  0              0.014239263    0.0029400644   0              567.86074      0              0              2.995587     
   1200000   2640           200            200            0.0047967827   0.00016451395  0              0.014225834    0.00013992644  0              27.026189      0              0              2.995589     
   1300000   2640           200            200            0.0047916125   0.00016433945  0              0.014210498    8.3778116e-05  0              16.181382      0              0              2.9955914    
   1400000   2640           200            200            0.0047914226   0.00016433182  0              0.014209936    3.175696e-08   0              0.0061337199   0              0              2.9955915    
   1500000   2640           200            200            0.0047920914   0.00016435464  0              0.01421192     1.597205e-06   0              0.30849326     0              0              2.9955912    
   1600000   2640           200            200            0.0047922207   0.00016435919  0              0.014212303    2.9529475e-08  0              0.0057034907   0              0              2.9955911    
   1700000   2640           200            200            0.0047921505   0.00016435682  0              0.014212095    2.0748704e-08  0              0.0040075227   0              0              2.9955911    
   1800000   2640           200            200            0.0047921221   0.00016435584  0              0.01421201     2.0735812e-09  0              0.00040050326  0              0              2.9955911    
   1900000   2640           200            200            0.0047921272   0.00016435601  0              0.014212026    1.5363183e-10  0              2.9673325e-05  0              0              2.9955911    
   2000000   2640           200            200            0.0047921318   0.00016435617  0              0.014212039    6.5144649e-11  0              1.2582408e-05  0              0              2.9955911    
   2100000   2640           200            200            0.0047921319   0.00016435617  0              0.014212039    1.7887075e-13  0              3.4548113e-08  0              0              2.9955911    
   2200000   2640           200            200            0.0047921312   0.00016435615  0              0.014212038    1.3354763e-12  0              2.5794149e-07  0              0              2.9955911    
   2300000   2640           200            200            0.0047921311   0.00016435614  0              0.014212037    1.4786599e-14  0              2.8559678e-09  0              0              2.9955911    
   2400000   2640           200            200            0.0047921312   0.00016435615  0              0.014212037    1.8801429e-14  0              3.6314149e-09  0              0              2.9955911    
   2500000   2640           200            200            0.0047921312   0.00016435615  0              0.014212038    1.3542326e-15  0              2.6156418e-10  0              0              2.9955911    
   2600000   2640           200            200            0.0047921312   0.00016435615  0              0.014212038    1.6339466e-16  0              3.1558974e-11  0              0              2.9955911    
   2700000   2640           200            200            0.0047921312   0.00016435615  0              0.014212037    5.4097565e-17  0              1.0448711e-11  0              0              2.9955911    
   2800000   2640           200            200            0.0047921312   0.00016435615  0              0.014212038    1.0423695e-19  0              2.0132918e-14  0              0              2.9955911    
   2900000   2640           200            200            0.0047921312   0.00016435615  0              0.014212038    2.0044353e-19  0              3.8714803e-14  0              0              2.9955911    
   3000000   2640           200            200            0.0047921312   0.00016435615  0              0.014212038    7.779618e-19   0              1.5025997e-13  0              0              2.9955911    
Loop time of 181.563 on 2 procs for 3000000 steps with 1251 atoms

Performance: 14276070.635 ns/day, 0.000 hours/ns, 16523.230 timesteps/s
99.9% CPU use with 2 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 41.86      | 41.866     | 41.872     |   0.1 | 23.06
Neigh   | 3.3334     | 3.3344     | 3.3355     |   0.1 |  1.84
Comm    | 13.945     | 14.008     | 14.071     |   1.7 |  7.72
Output  | 0.21116    | 0.21118    | 0.21121    |   0.0 |  0.12
Modify  | 109.08     | 109.17     | 109.26     |   0.9 | 60.13
Other   |            | 12.97      |            |       |  7.14

Nlocal:          625.5 ave         626 max         625 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Nghost:            2.5 ave           3 max           2 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Neighs:          361.5 ave         362 max         361 min
Histogram: 1 0 0 0 0 0 0 0 0 1

Total # of neighbors = 723
Ave neighs/atom = 0.57793765
Neighbor list builds = 164
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 53

#variable lat0 equal 1                    #
variable lat1 equal 3+(v_ind*0.01)        # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 250*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 3.53                                                               
Lattice spacing in x,y,z = 3.53 3.53 3.53

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -1323.75 ${n1e1} -100 100 -100 100 units box
region box block -1323.75 1323.75 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -1323.75 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -1323.75 1323.75 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-1323.75 -100 -100) to (1323.75 100 100)
  2 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 750 atoms
  using lattice units in orthogonal box = (-1323.75 -100 -100) to (1323.75 100 100)
  create_atoms CPU = 0.000 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -750 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -750 750 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 501 atoms
  using lattice units in orthogonal box = (-1323.75 -100 -100) to (1323.75 100 100)
  create_atoms CPU = 0.000 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  750 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  750 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  501 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  501 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
750 atoms in group substrate
group slider1 region slider1
501 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 501 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_53_*.dump id type diameter mass xu yu zu fx fy fz

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 1709 130 130
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 72.64 | 72.64 | 72.64 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   2647.5         200            200            0              0              0              0              0              0              0              0              0              6            
    100000   2647.5         200            200            0.0038481419   7.4568766e-46  0              0.011544426    293306.18      0              5.6650824e+10  0              0              3.3259122    
    200000   2647.5         200            200            0.0013695679   1.4302295e-36  0              0.0041087037   71996.749      0              1.3905861e+10  0              0              3.0732059    
    300000   2647.5         200            200            0.00010795162  1.5256058e-35  0              0.00032385485  913.50287      0              1.7643914e+08  0              0              3.045507     
    400000   2647.5         200            200            0.0040373614   0.00036450969  0              0.011747574    5170.4381      0              9.9864781e+08  0              0              2.9961203    
    500000   2647.5         200            200            0.0069925677   0.00055835922  0              0.020419344    730.90271      0              1.411707e+08   0              0              2.9946975    
    600000   2647.5         200            200            0.0044661248   0.0011618286   0              0.012236546    102.37089      0              19772496       0              0              2.9958872    
    700000   2647.5         200            200            0.0048376383   0.00082490552  0              0.013688009    14.388524      0              2779081.2      0              0              2.9956797    
    800000   2647.5         200            200            0.005013998    0.00059244151  0              0.014449553    1.8161709      0              350785.58      0              0              2.9955561    
    900000   2647.5         200            200            0.0048888365   0.00061667992  0              0.01404983     0.23263957     0              44933.329      0              0              2.9956192    
   1000000   2647.5         200            200            0.0049439362   0.00061105102  0              0.014220758    0.030371062    0              5866.0396      0              0              2.9955923    
   1100000   2647.5         200            200            0.0049214711   0.00061216502  0              0.014152248    0.0039385789   0              760.71951      0              0              2.995603     
   1200000   2647.5         200            200            0.0049304239   0.00061171558  0              0.014179556    0.0005099276   0              98.490315      0              0              2.9955987    
   1300000   2647.5         200            200            0.0049268892   0.00061189139  0              0.014168776    6.5698604e-05  0              12.689402      0              0              2.9956004    
   1400000   2647.5         200            200            0.0049282766   0.00061182239  0              0.014173007    8.4310907e-06  0              1.6284288      0              0              2.9955998    
   1500000   2647.5         200            200            0.0049277351   0.00061184923  0              0.014171356    1.0769515e-06  0              0.20800854     0              0              2.9956       
   1600000   2647.5         200            200            0.0049279454   0.00061183882  0              0.014171997    1.3691686e-07  0              0.026444901    0              0              2.9955999    
   1700000   2647.5         200            200            0.0049278641   0.00061184284  0              0.014171749    1.7318314e-08  0              0.0033449576   0              0              2.9956       
   1800000   2647.5         200            200            0.0049278954   0.00061184129  0              0.014171845    2.1787372e-09  0              0.00042081368  0              0              2.9956       
   1900000   2647.5         200            200            0.0049278834   0.00061184189  0              0.014171808    2.7251436e-10  0              5.2634972e-05  0              0              2.9956       
   2000000   2647.5         200            200            0.004927888    0.00061184166  0              0.014171822    3.3874508e-11  0              6.5427151e-06  0              0              2.9956       
   2100000   2647.5         200            200            0.0049278863   0.00061184175  0              0.014171817    4.181549e-12   0              8.0764815e-07  0              0              2.9956       
   2200000   2647.5         200            200            0.0049278869   0.00061184171  0              0.014171819    5.1254195e-13  0              9.8995266e-08  0              0              2.9956       
   2300000   2647.5         200            200            0.0049278867   0.00061184173  0              0.014171818    6.2240094e-14  0              1.2021406e-08  0              0              2.9956       
   2400000   2647.5         200            200            0.0049278868   0.00061184172  0              0.014171819    7.5793028e-15  0              1.4639096e-09  0              0              2.9956       
   2500000   2647.5         200            200            0.0049278867   0.00061184172  0              0.014171818    8.7915263e-16  0              1.6980454e-10  0              0              2.9956       
   2600000   2647.5         200            200            0.0049278867   0.00061184172  0              0.014171818    1.1425277e-16  0              2.206743e-11   0              0              2.9956       
   2700000   2647.5         200            200            0.0049278867   0.00061184172  0              0.014171818    6.3505253e-18  0              1.2265766e-12  0              0              2.9956       
   2800000   2647.5         200            200            0.0049278867   0.00061184172  0              0.014171818    2.949551e-19   0              5.6969305e-14  0              0              2.9956       
   2900000   2647.5         200            200            0.0049278867   0.00061184172  0              0.014171818    3.599804e-19   0              6.9528661e-14  0              0              2.9956       
   3000000   2647.5         200            200            0.0049278867   0.00061184172  0              0.014171818    1.987328e-19   0              3.8384383e-14  0              0              2.9956       
Loop time of 180.347 on 2 procs for 3000000 steps with 1251 atoms

Performance: 14372259.932 ns/day, 0.000 hours/ns, 16634.560 timesteps/s
99.9% CPU use with 2 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 41.083     | 41.133     | 41.182     |   0.8 | 22.81
Neigh   | 3.3164     | 3.3169     | 3.3175     |   0.0 |  1.84
Comm    | 13.987     | 14.008     | 14.029     |   0.6 |  7.77
Output  | 0.21148    | 0.21151    | 0.21154    |   0.0 |  0.12
Modify  | 108.66     | 108.71     | 108.76     |   0.5 | 60.28
Other   |            | 12.97      |            |       |  7.19

Nlocal:          625.5 ave         626 max         625 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Nghost:            2.5 ave           3 max           2 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Neighs:          360.5 ave         361 max         360 min
Histogram: 1 0 0 0 0 0 0 0 0 1

Total # of neighbors = 721
Ave neighs/atom = 0.57633893
Neighbor list builds = 164
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 54

#variable lat0 equal 1                    #
variable lat1 equal 3+(v_ind*0.01)        # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 250*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 3.54                                                               
Lattice spacing in x,y,z = 3.54 3.54 3.54

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -1327.5 ${n1e1} -100 100 -100 100 units box
region box block -1327.5 1327.5 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -1327.5 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -1327.5 1327.5 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-1327.5 -100 -100) to (1327.5 100 100)
  2 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 750 atoms
  using lattice units in orthogonal box = (-1327.5 -100 -100) to (1327.5 100 100)
  create_atoms CPU = 0.000 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -750 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -750 750 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 501 atoms
  using lattice units in orthogonal box = (-1327.5 -100 -100) to (1327.5 100 100)
  create_atoms CPU = 0.000 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  750 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  750 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  501 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  501 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
750 atoms in group substrate
group slider1 region slider1
501 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 501 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_54_*.dump id type diameter mass xu yu zu fx fy fz

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 1713 130 130
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 72.78 | 72.78 | 72.78 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   2655           200            200            0              0              0              0              0              0              0              0              0              6            
    100000   2655           200            200            0.0038375055  -1.5212579e-35  0              0.011512517    293326.29      0              5.6654706e+10  0              0              3.325978     
    200000   2655           200            200            0.0013658224   9.5079374e-37  0              0.0040974671   72003.424      0              1.3907151e+10  0              0              3.0733372    
    300000   2655           200            200            0.00010786032 -2.3769814e-37  0              0.00032358095  916.87039      0              1.7708956e+08  0              0              3.0456461    
    400000   2655           200            200            0.0045552696  -0.0006734952   0              0.014339304    5182.9184      0              1.0010583e+09  0              0              2.9957997    
    500000   2655           200            200            0.0074388495  -0.0012607481   0              0.023577297    601.23857      0              1.1612664e+08  0              0              2.9943472    
    600000   2655           200            200            0.0065628198  -0.0010464798   0              0.020734939    1.1856897      0              229010.85      0              0              2.9947409    
    700000   2655           200            200            0.0047168822  -0.0011511563   0              0.015301803    11.077494      0              2139570.2      0              0              2.9955179    
    800000   2655           200            200            0.0041655419  -0.0011419187   0              0.013638544    1.3466445      0              260098.58      0              0              2.9957794    
    900000   2655           200            200            0.0042284698  -0.0011429564   0              0.013828366    0.01305221     0              2520.978       0              0              2.9957513    
   1000000   2655           200            200            0.0043233853  -0.0011445984   0              0.014114754    0.035786783    0              6912.0628      0              0              2.9957064    
   1100000   2655           200            200            0.0043412542  -0.0011449125   0              0.014168675    0.0013185938   0              254.68071      0              0              2.9956977    
   1200000   2655           200            200            0.0043332652  -0.0011447793   0              0.014144575    0.00024432664  0              47.190636      0              0              2.9957014    
   1300000   2655           200            200            0.0043286732  -0.0011447004   0              0.01413072     8.4177472e-05  0              16.258515      0              0              2.9957036    
   1400000   2655           200            200            0.0043284968  -0.0011446969   0              0.014130187    1.5777167e-07  0              0.030472916    0              0              2.9957037    
   1500000   2655           200            200            0.0043290686  -0.0011447066   0              0.014131913    1.2781004e-06  0              0.24685957     0              0              2.9957034    
   1600000   2655           200            200            0.0043292488  -0.0011447097   0              0.014132456    1.3153874e-07  0              0.025406139    0              0              2.9957033    
   1700000   2655           200            200            0.0043292208  -0.0011447093   0              0.014132372    2.8667699e-09  0              0.00055370423  0              0              2.9957034    
   1800000   2655           200            200            0.0043291888  -0.0011447087   0              0.014132275    4.0472366e-09  0              0.00078170629  0              0              2.9957034    
   1900000   2655           200            200            0.0043291839  -0.0011447086   0              0.01413226     1.032007e-10   0              1.9932771e-05  0              0              2.9957034    
   2000000   2655           200            200            0.0043291868  -0.0011447087   0              0.014132269    3.3811273e-11  0              6.5305016e-06  0              0              2.9957034    
   2100000   2655           200            200            0.0043291883  -0.0011447087   0              0.014132274    8.7720975e-12  0              1.6942928e-06  0              0              2.9957034    
   2200000   2655           200            200            0.0043291883  -0.0011447087   0              0.014132274    5.9052197e-16  0              1.1405677e-10  0              0              2.9957034    
   2300000   2655           200            200            0.0043291881  -0.0011447087   0              0.014132273    1.5468987e-13  0              2.9877681e-08  0              0              2.9957034    
   2400000   2655           200            200            0.0043291881  -0.0011447087   0              0.014132273    1.2387826e-14  0              2.392655e-09   0              0              2.9957034    
   2500000   2655           200            200            0.0043291881  -0.0011447087   0              0.014132273    4.8980416e-16  0              9.460356e-11   0              0              2.9957034    
   2600000   2655           200            200            0.0043291881  -0.0011447087   0              0.014132273    4.5151867e-16  0              8.7208882e-11  0              0              2.9957034    
   2700000   2655           200            200            0.0043291881  -0.0011447087   0              0.014132273    1.481477e-17   0              2.861409e-12   0              0              2.9957034    
   2800000   2655           200            200            0.0043291881  -0.0011447087   0              0.014132273    2.0878064e-18  0              4.0325079e-13  0              0              2.9957034    
   2900000   2655           200            200            0.0043291881  -0.0011447087   0              0.014132273    3.9335009e-18  0              7.5973871e-13  0              0              2.9957034    
   3000000   2655           200            200            0.0043291881  -0.0011447087   0              0.014132273    9.4664622e-19  0              1.8284063e-13  0              0              2.9957034    
Loop time of 180.631 on 2 procs for 3000000 steps with 1251 atoms

Performance: 14349657.401 ns/day, 0.000 hours/ns, 16608.400 timesteps/s
99.9% CPU use with 2 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 40.768     | 40.912     | 41.055     |   2.2 | 22.65
Neigh   | 3.3612     | 3.3619     | 3.3626     |   0.0 |  1.86
Comm    | 14.538     | 14.574     | 14.61      |   0.9 |  8.07
Output  | 0.21313    | 0.21317    | 0.21321    |   0.0 |  0.12
Modify  | 108.69     | 108.84     | 108.98     |   1.4 | 60.25
Other   |            | 12.73      |            |       |  7.05

Nlocal:          625.5 ave         626 max         625 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Nghost:            2.5 ave           3 max           2 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Neighs:          365.5 ave         366 max         365 min
Histogram: 1 0 0 0 0 0 0 0 0 1

Total # of neighbors = 731
Ave neighs/atom = 0.58433253
Neighbor list builds = 164
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 55

#variable lat0 equal 1                    #
variable lat1 equal 3+(v_ind*0.01)        # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 250*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 3.55                                                               
Lattice spacing in x,y,z = 3.55 3.55 3.55

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -1331.25 ${n1e1} -100 100 -100 100 units box
region box block -1331.25 1331.25 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -1331.25 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -1331.25 1331.25 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-1331.25 -100 -100) to (1331.25 100 100)
  2 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 750 atoms
  using lattice units in orthogonal box = (-1331.25 -100 -100) to (1331.25 100 100)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -750 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -750 750 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 501 atoms
  using lattice units in orthogonal box = (-1331.25 -100 -100) to (1331.25 100 100)
  create_atoms CPU = 0.000 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  750 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  750 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  501 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  501 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
750 atoms in group substrate
group slider1 region slider1
501 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 501 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_55_*.dump id type diameter mass xu yu zu fx fy fz

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 1718 130 130
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 72.92 | 72.92 | 72.92 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   2662.5         200            200            0              0              0              0              0              0              0              0              0              6            
    100000   2662.5         200            200            0.0038257681  -7.5848403e-36  0              0.011477304    293222.3       0              5.6634621e+10  0              0              3.3261056    
    200000   2662.5         200            200            0.0013597233   9.4811616e-37  0              0.0040791699   71818.247      0              1.3871385e+10  0              0              3.0736078    
    300000   2662.5         200            200            0.00010497315 -1.8962234e-36  0              0.00031491946  875.54777      0              1.6910827e+08  0              0              3.0455963    
    400000   2662.5         200            200            0.0048803256   0.0020819572   0              0.01255902     5163.2335      0              9.9725628e+08  0              0              2.9959458    
    500000   2662.5         200            200            0.010130419    0.0013903265   0              0.02900093     329.92682      0              63723942       0              0              2.9936316    
    600000   2662.5         200            200            0.0076814476   0.0023149591   0              0.020729384    6.5603002      0              1267093.7      0              0              2.9946503    
    700000   2662.5         200            200            0.0054127071   0.0032241559   0              0.013013965    11.984476      0              2314749.8      0              0              2.995733     
    800000   2662.5         200            200            0.0058196712   0.0031925569   0              0.014266457    1.9461818      0              375896.63      0              0              2.9955463    
    900000   2662.5         200            200            0.0057426662   0.0031534148   0              0.014074584    0.27228659     0              52590.98       0              0              2.9955726    
   1000000   2662.5         200            200            0.0057443998   0.0031534046   0              0.014079795    0.03639324     0              7029.1973      0              0              2.9955728    
   1100000   2662.5         200            200            0.0057520391   0.0031535386   0              0.014102579    0.0046438131   0              896.93247      0              0              2.995569     
   1200000   2662.5         200            200            0.005746358    0.0031534435   0              0.01408563     0.00056345981  0              108.82983      0              0              2.9955717    
   1300000   2662.5         200            200            0.0057494636   0.003153494    0              0.014094897    6.4746272e-05  0              12.505463      0              0              2.9955702    
   1400000   2662.5         200            200            0.0057479756   0.0031534699   0              0.014090457    6.9703422e-06  0              1.3462915      0              0              2.9955709    
   1500000   2662.5         200            200            0.0057486374   0.0031534806   0              0.014092432    6.9162643e-07  0              0.13358466     0              0              2.9955706    
   1600000   2662.5         200            200            0.0057483575   0.0031534761   0              0.014091596    6.1347274e-08  0              0.011848961    0              0              2.9955707    
   1700000   2662.5         200            200            0.0057484715   0.0031534779   0              0.014091937    4.5762913e-09  0              0.00088389091  0              0              2.9955707    
   1800000   2662.5         200            200            0.0057484265   0.0031534772   0              0.014091802    2.4652884e-10  0              4.7615981e-05  0              0              2.9955707    
   1900000   2662.5         200            200            0.0057484438   0.0031534775   0              0.014091854    5.1627964e-12  0              9.9717185e-07  0              0              2.9955707    
   2000000   2662.5         200            200            0.0057484373   0.0031534774   0              0.014091834    2.2042765e-13  0              4.257465e-08   0              0              2.9955707    
   2100000   2662.5         200            200            0.0057484397   0.0031534774   0              0.014091842    4.19591e-13    0              8.1042191e-08  0              0              2.9955707    
   2200000   2662.5         200            200            0.0057484388   0.0031534774   0              0.014091839    1.6577875e-13  0              3.201945e-08   0              0              2.9955707    
   2300000   2662.5         200            200            0.0057484391   0.0031534774   0              0.01409184     4.3404357e-14  0              8.3833642e-09  0              0              2.9955707    
   2400000   2662.5         200            200            0.005748439    0.0031534774   0              0.01409184     9.3229584e-15  0              1.8006892e-09  0              0              2.9955707    
   2500000   2662.5         200            200            0.005748439    0.0031534774   0              0.01409184     1.7633943e-15  0              3.40592e-10    0              0              2.9955707    
   2600000   2662.5         200            200            0.005748439    0.0031534774   0              0.01409184     3.1138005e-16  0              6.0141712e-11  0              0              2.9955707    
   2700000   2662.5         200            200            0.005748439    0.0031534774   0              0.01409184     5.4919151e-17  0              1.0607397e-11  0              0              2.9955707    
   2800000   2662.5         200            200            0.005748439    0.0031534774   0              0.01409184     7.7198608e-18  0              1.4910578e-12  0              0              2.9955707    
   2900000   2662.5         200            200            0.005748439    0.0031534774   0              0.01409184     2.8708531e-18  0              5.544929e-13   0              0              2.9955707    
   3000000   2662.5         200            200            0.005748439    0.0031534774   0              0.01409184     1.5546956e-18  0              3.0028275e-13  0              0              2.9955707    
Loop time of 179.708 on 2 procs for 3000000 steps with 1251 atoms

Performance: 14423416.367 ns/day, 0.000 hours/ns, 16693.769 timesteps/s
99.9% CPU use with 2 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 40.874     | 40.901     | 40.927     |   0.4 | 22.76
Neigh   | 3.3476     | 3.3481     | 3.3486     |   0.0 |  1.86
Comm    | 13.847     | 13.919     | 13.99      |   1.9 |  7.75
Output  | 0.21116    | 0.21119    | 0.21121    |   0.0 |  0.12
Modify  | 108.58     | 108.59     | 108.61     |   0.1 | 60.43
Other   |            | 12.73      |            |       |  7.09

Nlocal:          625.5 ave         626 max         625 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Nghost:            2.5 ave           3 max           2 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Neighs:          358.5 ave         359 max         358 min
Histogram: 1 0 0 0 0 0 0 0 0 1

Total # of neighbors = 717
Ave neighs/atom = 0.57314149
Neighbor list builds = 164
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 56

#variable lat0 equal 1                    #
variable lat1 equal 3+(v_ind*0.01)        # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 250*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 3.56                                                               
Lattice spacing in x,y,z = 3.56 3.56 3.56

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -1335 ${n1e1} -100 100 -100 100 units box
region box block -1335 1335 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -1335 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -1335 1335 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-1335 -100 -100) to (1335 100 100)
  2 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 750 atoms
  using lattice units in orthogonal box = (-1335 -100 -100) to (1335 100 100)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -750 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -750 750 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 501 atoms
  using lattice units in orthogonal box = (-1335 -100 -100) to (1335 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  750 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  750 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  501 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  501 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
750 atoms in group substrate
group slider1 region slider1
501 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 501 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_56_*.dump id type diameter mass xu yu zu fx fy fz

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 1723 130 130
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 73.12 | 73.12 | 73.12 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   2670           200            200            0              0              0              0              0              0              0              0              0              6            
    100000   2670           200            200            0.0038153568  -4.7272546e-37  0              0.01144607     293257.89      0              5.6641497e+10  0              0              3.3260931    
    200000   2670           200            200            0.0013567384   2.3636293e-37  0              0.0040702151   71886.247      0              1.3884518e+10  0              0              3.0735416    
    300000   2670           200            200            0.00010540697 -2.3636277e-37  0              0.0003162209   887.12667      0              1.7134469e+08  0              0              3.0456542    
    400000   2670           200            200            0.0045270152   0.00026282884  0              0.013318217    5185.29        0              1.0015164e+09  0              0              2.9958925    
    500000   2670           200            200            0.0076932485   0.00051124521  0              0.0225685      651.01676      0              1.2574108e+08  0              0              2.9944552    
    600000   2670           200            200            0.006036041    0.00060075653  0              0.017507367    80.795037      0              15605213       0              0              2.9951267    
    700000   2670           200            200            0.0043097816   0.00072739979  0              0.012201945    4.8918885      0              944847.16      0              0              2.9959402    
    800000   2670           200            200            0.0047655916   0.00071256022  0              0.013584215    1.3859991      0              267699.74      0              0              2.9957153    
    900000   2670           200            200            0.0050262067   0.00072084036  0              0.01435778     0.018674251    0              3606.851       0              0              2.9955926    
   1000000   2670           200            200            0.004917415    0.00071835191  0              0.014033893    0.035876517    0              6929.3945      0              0              2.9956421    
   1100000   2670           200            200            0.0049117798   0.00071791872  0              0.014017421    0.0014922621   0              288.22398      0              0              2.995645     
   1200000   2670           200            200            0.00492784     0.00071770042  0              0.01406582     0.00018919566  0              36.542326      0              0              2.9956374    
   1300000   2670           200            200            0.004923677    0.00071775875  0              0.014053272    8.8964314e-05  0              17.183073      0              0              2.9956394    
   1400000   2670           200            200            0.0049227832   0.00071777175  0              0.014050578    1.0662748e-06  0              0.20594638     0              0              2.9956398    
   1500000   2670           200            200            0.0049236192   0.00071776006  0              0.014053098    9.166316e-07   0              0.17704344     0              0              2.9956394    
   1600000   2670           200            200            0.0049234838   0.00071776189  0              0.01405269     1.8731211e-07  0              0.036178525    0              0              2.9956395    
   1700000   2670           200            200            0.0049234124   0.00071776291  0              0.014052474    1.0931027e-11  0              2.1112808e-06  0              0              2.9956395    
   1800000   2670           200            200            0.0049234526   0.00071776235  0              0.014052595    3.2989211e-09  0              0.00063717237  0              0              2.9956395    
   1900000   2670           200            200            0.0049234499   0.00071776239  0              0.014052587    3.2560167e-10  0              6.2888557e-05  0              0              2.9956395    
   2000000   2670           200            200            0.0049234453   0.00071776245  0              0.014052573    4.9647411e-12  0              9.5891833e-07  0              0              2.9956395    
   2100000   2670           200            200            0.0049234471   0.00071776243  0              0.014052579    9.7353449e-12  0              1.8803399e-06  0              0              2.9956395    
   2200000   2670           200            200            0.0049234471   0.00071776243  0              0.014052579    4.2896121e-13  0              8.2852007e-08  0              0              2.9956395    
   2300000   2670           200            200            0.0049234469   0.00071776243  0              0.014052578    4.8731059e-14  0              9.4121938e-09  0              0              2.9956395    
   2400000   2670           200            200            0.004923447    0.00071776243  0              0.014052578    2.4347651e-14  0              4.7026436e-09  0              0              2.9956395    
   2500000   2670           200            200            0.004923447    0.00071776243  0              0.014052578    3.0809668e-16  0              5.9507544e-11  0              0              2.9956395    
   2600000   2670           200            200            0.004923447    0.00071776243  0              0.014052578    2.5392789e-16  0              4.9045075e-11  0              0              2.9956395    
   2700000   2670           200            200            0.004923447    0.00071776243  0              0.014052578    4.4165064e-17  0              8.5302916e-12  0              0              2.9956395    
   2800000   2670           200            200            0.004923447    0.00071776243  0              0.014052578    7.0802784e-20  0              1.3675252e-14  0              0              2.9956395    
   2900000   2670           200            200            0.004923447    0.00071776243  0              0.014052578    1.8205975e-18  0              3.5164055e-13  0              0              2.9956395    
   3000000   2670           200            200            0.004923447    0.00071776243  0              0.014052578    3.3996962e-18  0              6.5663665e-13  0              0              2.9956395    
Loop time of 180.382 on 2 procs for 3000000 steps with 1251 atoms

Performance: 14369473.914 ns/day, 0.000 hours/ns, 16631.336 timesteps/s
99.9% CPU use with 2 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 40.855     | 41.033     | 41.211     |   2.8 | 22.75
Neigh   | 3.383      | 3.3836     | 3.3842     |   0.0 |  1.88
Comm    | 14.501     | 14.501     | 14.502     |   0.0 |  8.04
Output  | 0.21283    | 0.21286    | 0.21289    |   0.0 |  0.12
Modify  | 108.39     | 108.54     | 108.68     |   1.4 | 60.17
Other   |            | 12.71      |            |       |  7.05

Nlocal:          625.5 ave         626 max         625 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Nghost:            2.5 ave           3 max           2 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Neighs:          359.5 ave         360 max         359 min
Histogram: 1 0 0 0 0 0 0 0 0 1

Total # of neighbors = 719
Ave neighs/atom = 0.57474021
Neighbor list builds = 164
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 57

#variable lat0 equal 1                    #
variable lat1 equal 3+(v_ind*0.01)        # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 250*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 3.57                                                               
Lattice spacing in x,y,z = 3.57 3.57 3.57

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -1338.75 ${n1e1} -100 100 -100 100 units box
region box block -1338.75 1338.75 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -1338.75 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -1338.75 1338.75 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-1338.75 -100 -100) to (1338.75 100 100)
  2 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 750 atoms
  using lattice units in orthogonal box = (-1338.75 -100 -100) to (1338.75 100 100)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -750 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -750 750 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 501 atoms
  using lattice units in orthogonal box = (-1338.75 -100 -100) to (1338.75 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  750 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  750 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  501 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  501 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
750 atoms in group substrate
group slider1 region slider1
501 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 501 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_57_*.dump id type diameter mass xu yu zu fx fy fz

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 1728 130 130
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 73.26 | 73.26 | 73.26 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   2677.5         200            200            0              0              0              0              0              0              0              0              0              6            
    100000   2677.5         200            200            0.0038044376   1.272784e-35   0              0.011413313    293235.07      0              5.6637089e+10  0              0              3.3260716    
    200000   2677.5         200            200            0.0013522401   9.1737758e-42  0              0.0040567203   71829.581      0              1.3873574e+10  0              0              3.0735818    
    300000   2677.5         200            200            0.00010427654  6.0259355e-43  0              0.00031282963  873.81748      0              1.6877408e+08  0              0              3.0456008    
    400000   2677.5         200            200            0.0037536682  -0.0016105865   0              0.012871591    5167.3176      0              9.980451e+08   0              0              2.9958801    
    500000   2677.5         200            200            0.0073056816  -0.0060656656   0              0.02798271     385.84698      0              74524679       0              0              2.9937269    
    600000   2677.5         200            200            0.0056022816  -0.0034066366   0              0.020213481    16.202133      0              3129372.1      0              0              2.9946832    
    700000   2677.5         200            200            0.0041371251  -0.0024815187   0              0.014892894    12.799272      0              2472124.2      0              0              2.9954254    
    800000   2677.5         200            200            0.003613175   -0.0023333292   0              0.013172854    0.0077962394   0              1505.81        0              0              2.9956984    
    900000   2677.5         200            200            0.0039302416  -0.002401918    0              0.014192643    0.18407661     0              35553.603      0              0              2.9955385    
   1000000   2677.5         200            200            0.0038878606  -0.002394378    0              0.01405796     0.030801658    0              5949.2073      0              0              2.9955584    
   1100000   2677.5         200            200            0.0038606952  -0.0023890743   0              0.01397116     9.6207366e-05  0              18.582037      0              0              2.9955722    
   1200000   2677.5         200            200            0.0038768998  -0.0023921703   0              0.01402287     0.00039616598  0              76.51775       0              0              2.9955642    
   1300000   2677.5         200            200            0.0038743167  -0.0023916965   0              0.014014647    8.110496e-05   0              15.665073      0              0              2.9955654    
   1400000   2677.5         200            200            0.003873124   -0.0023914625   0              0.014010834    6.2067757e-07  0              0.11988119     0              0              2.995566     
   1500000   2677.5         200            200            0.0038739331  -0.0023916169   0              0.014013416    8.3203746e-07  0              0.16070444     0              0              2.9955656    
   1600000   2677.5         200            200            0.0038737819  -0.0023915889   0              0.014012935    2.1015762e-07  0              0.040591038    0              0              2.9955657    
   1700000   2677.5         200            200            0.003873731   -0.0023915789   0              0.014012772    2.8875401e-09  0              0.0005577159   0              0              2.9955657    
   1800000   2677.5         200            200            0.0038737711  -0.0023915865   0              0.0140129      1.6951741e-09  0              0.00032741557  0              0              2.9955657    
   1900000   2677.5         200            200            0.0038737625  -0.0023915849   0              0.014012872    5.3578721e-10  0              0.00010348499  0              0              2.9955657    
   2000000   2677.5         200            200            0.0038737604  -0.0023915845   0              0.014012866    1.1376423e-11  0              2.1973071e-06  0              0              2.9955657    
   2100000   2677.5         200            200            0.0038737624  -0.0023915849   0              0.014012872    3.3264503e-12  0              6.4248951e-07  0              0              2.9955657    
   2200000   2677.5         200            200            0.0038737619  -0.0023915848   0              0.014012871    1.3441804e-12  0              2.5962264e-07  0              0              2.9955657    
   2300000   2677.5         200            200            0.0038737618  -0.0023915848   0              0.01401287     4.074072e-14   0              7.8688942e-09  0              0              2.9955657    
   2400000   2677.5         200            200            0.0038737619  -0.0023915848   0              0.014012871    6.2463661e-15  0              1.2064587e-09  0              0              2.9955657    
   2500000   2677.5         200            200            0.0038737619  -0.0023915848   0              0.01401287     3.321117e-15   0              6.4145942e-10  0              0              2.9955657    
   2600000   2677.5         200            200            0.0038737619  -0.0023915848   0              0.01401287     1.3931832e-16  0              2.6908732e-11  0              0              2.9955657    
   2700000   2677.5         200            200            0.0038737619  -0.0023915848   0              0.01401287     1.9746034e-17  0              3.8138612e-12  0              0              2.9955657    
   2800000   2677.5         200            200            0.0038737619  -0.0023915848   0              0.01401287     7.6824593e-18  0              1.4838339e-12  0              0              2.9955657    
   2900000   2677.5         200            200            0.0038737619  -0.0023915848   0              0.01401287     1.3700305e-22  0              2.6461548e-17  0              0              2.9955657    
   3000000   2677.5         200            200            0.0038737619  -0.0023915848   0              0.01401287     7.3639499e-19  0              1.4223151e-13  0              0              2.9955657    
Loop time of 181.153 on 2 procs for 3000000 steps with 1251 atoms

Performance: 14308336.011 ns/day, 0.000 hours/ns, 16560.574 timesteps/s
99.9% CPU use with 2 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 41.175     | 41.31      | 41.445     |   2.1 | 22.80
Neigh   | 3.3541     | 3.3547     | 3.3552     |   0.0 |  1.85
Comm    | 14.698     | 14.737     | 14.776     |   1.0 |  8.14
Output  | 0.21059    | 0.21062    | 0.21065    |   0.0 |  0.12
Modify  | 108.63     | 108.74     | 108.84     |   1.0 | 60.02
Other   |            | 12.81      |            |       |  7.07

Nlocal:          625.5 ave         626 max         625 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Nghost:            2.5 ave           3 max           2 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Neighs:          361.5 ave         362 max         361 min
Histogram: 1 0 0 0 0 0 0 0 0 1

Total # of neighbors = 723
Ave neighs/atom = 0.57793765
Neighbor list builds = 164
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 58

#variable lat0 equal 1                    #
variable lat1 equal 3+(v_ind*0.01)        # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 250*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 3.58                                                               
Lattice spacing in x,y,z = 3.58 3.58 3.58

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -1342.5 ${n1e1} -100 100 -100 100 units box
region box block -1342.5 1342.5 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -1342.5 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -1342.5 1342.5 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-1342.5 -100 -100) to (1342.5 100 100)
  2 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 750 atoms
  using lattice units in orthogonal box = (-1342.5 -100 -100) to (1342.5 100 100)
  create_atoms CPU = 0.000 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -750 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -750 750 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 501 atoms
  using lattice units in orthogonal box = (-1342.5 -100 -100) to (1342.5 100 100)
  create_atoms CPU = 0.000 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  750 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  750 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  501 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  501 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
750 atoms in group substrate
group slider1 region slider1
501 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 501 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_58_*.dump id type diameter mass xu yu zu fx fy fz

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 1733 130 130
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 73.47 | 73.47 | 73.47 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   2685           200            200            0              0              0              0              0              0              0              0              0              6            
    100000   2685           200            200            0.0037935824   7.5214196e-36  0              0.011380747    293208.33      0              5.6631923e+10  0              0              3.3261184    
    200000   2685           200            200            0.0013480589  -1.1752117e-35  0              0.0040441767   71796.11       0              1.3867109e+10  0              0              3.0736299    
    300000   2685           200            200            0.00010368135  4.7008478e-37  0              0.00031104406  868.98211      0              1.6784014e+08  0              0              3.0455835    
    400000   2685           200            200            0.0046330857   0.0015616996   0              0.012337558    5156.1341      0              9.9588506e+08  0              0              2.9959729    
    500000   2685           200            200            0.012096625    0.0068599486   0              0.029429926    289.00516      0              55820100       0              0              2.9935361    
    600000   2685           200            200            0.0073791874   0.0033798045   0              0.018757758    52.412265      0              10123203       0              0              2.9948669    
    700000   2685           200            200            0.0064810306   0.0031875198   0              0.016255572    0.84623251     0              163446.16      0              0              2.9952149    
    800000   2685           200            200            0.0058704462   0.0029564757   0              0.014654863    0.69153299     0              133566.61      0              0              2.9954537    
    900000   2685           200            200            0.0056078305   0.0028829859   0              0.013940506    0.2675479      0              51675.722      0              0              2.9955661    
   1000000   2685           200            200            0.0055793901   0.0028686994   0              0.013869471    0.0056451909   0              1090.3443      0              0              2.9955781    
   1100000   2685           200            200            0.0056042238   0.0028713694   0              0.013941302    0.0018900111   0              365.04749      0              0              2.9955668    
   1200000   2685           200            200            0.0056163615   0.0028726377   0              0.013976447    0.00064536826  0              124.65009      0              0              2.9955612    
   1300000   2685           200            200            0.0056172614   0.0028727373   0              0.013979047    9.1329474e-06  0              1.7639894      0              0              2.9955608    
   1400000   2685           200            200            0.0056159373   0.0028726039   0              0.013975208    5.6298383e-06  0              1.087379       0              0              2.9955614    
   1500000   2685           200            200            0.0056153522   0.0028725436   0              0.013973513    1.5349642e-06  0              0.2964717      0              0              2.9955616    
   1600000   2685           200            200            0.0056153262   0.0028725405   0              0.013973438    1.285709e-08   0              0.0024832915   0              0              2.9955617    
   1700000   2685           200            200            0.0056153961   0.0028725476   0              0.013973641    1.6286775e-08  0              0.0031457202   0              0              2.9955616    
   1800000   2685           200            200            0.0056154241   0.0028725505   0              0.013973722    3.6002177e-09  0              0.00069536652  0              0              2.9955616    
   1900000   2685           200            200            0.0056154245   0.0028725505   0              0.013973723    1.4249841e-11  0              2.7522952e-06  0              0              2.9955616    
   2000000   2685           200            200            0.0056154208   0.0028725502   0              0.013973712    4.599041e-11   0              8.8828493e-06  0              0              2.9955616    
   2100000   2685           200            200            0.0056154195   0.00287255     0              0.013973708    8.3211991e-12  0              1.6072037e-06  0              0              2.9955616    
   2200000   2685           200            200            0.0056154195   0.00287255     0              0.013973708    8.8938251e-15  0              1.7178039e-09  0              0              2.9955616    
   2300000   2685           200            200            0.0056154197   0.0028725501   0              0.013973709    1.2725657e-13  0              2.4579057e-08  0              0              2.9955616    
   2400000   2685           200            200            0.0056154198   0.0028725501   0              0.013973709    1.8947263e-14  0              3.6595821e-09  0              0              2.9955616    
   2500000   2685           200            200            0.0056154198   0.0028725501   0              0.013973709    8.4565363e-21  0              1.6333435e-15  0              0              2.9955616    
   2600000   2685           200            200            0.0056154197   0.0028725501   0              0.013973709    3.4923623e-16  0              6.745347e-11   0              0              2.9955616    
   2700000   2685           200            200            0.0056154197   0.0028725501   0              0.013973709    4.9343698e-17  0              9.5305223e-12  0              0              2.9955616    
   2800000   2685           200            200            0.0056154197   0.0028725501   0              0.013973709    4.2846739e-21  0              8.2756628e-16  0              0              2.9955616    
   2900000   2685           200            200            0.0056154197   0.0028725501   0              0.013973709    9.4593648e-20  0              1.8270355e-14  0              0              2.9955616    
   3000000   2685           200            200            0.0056154197   0.0028725501   0              0.013973709    4.1093741e-19  0              7.9370788e-14  0              0              2.9955616    
Loop time of 180.837 on 2 procs for 3000000 steps with 1251 atoms

Performance: 14333317.897 ns/day, 0.000 hours/ns, 16589.488 timesteps/s
99.9% CPU use with 2 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 40.884     | 40.979     | 41.075     |   1.5 | 22.66
Neigh   | 3.4235     | 3.4239     | 3.4244     |   0.0 |  1.89
Comm    | 14.634     | 14.714     | 14.793     |   2.1 |  8.14
Output  | 0.21308    | 0.2131     | 0.21312    |   0.0 |  0.12
Modify  | 108.65     | 108.76     | 108.87     |   1.1 | 60.14
Other   |            | 12.75      |            |       |  7.05

Nlocal:          625.5 ave         626 max         625 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Nghost:            2.5 ave           3 max           2 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Neighs:          360.5 ave         361 max         360 min
Histogram: 1 0 0 0 0 0 0 0 0 1

Total # of neighbors = 721
Ave neighs/atom = 0.57633893
Neighbor list builds = 164
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 59

#variable lat0 equal 1                    #
variable lat1 equal 3+(v_ind*0.01)        # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 250*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 3.59                                                               
Lattice spacing in x,y,z = 3.59 3.59 3.59

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -1346.25 ${n1e1} -100 100 -100 100 units box
region box block -1346.25 1346.25 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -1346.25 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -1346.25 1346.25 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-1346.25 -100 -100) to (1346.25 100 100)
  2 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 750 atoms
  using lattice units in orthogonal box = (-1346.25 -100 -100) to (1346.25 100 100)
  create_atoms CPU = 0.000 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -750 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -750 750 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 501 atoms
  using lattice units in orthogonal box = (-1346.25 -100 -100) to (1346.25 100 100)
  create_atoms CPU = 0.000 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  750 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  750 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  501 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  501 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
750 atoms in group substrate
group slider1 region slider1
501 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 501 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_59_*.dump id type diameter mass xu yu zu fx fy fz

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 1738 130 130
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 73.61 | 73.61 | 73.61 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   2692.5         200            200            0              0              0              0              0              0              0              0              0              6            
    100000   2692.5         200            200            0.0037834231   1.8751015e-36  0              0.011350269    293256.48      0              5.6641224e+10  0              0              3.3260306    
    200000   2692.5         200            200            0.0013452961   2.8126544e-36  0              0.0040358884   71879.437      0              1.3883203e+10  0              0              3.0734741    
    300000   2692.5         200            200            0.00010445152  2.343877e-36   0              0.00031335455  885.96448      0              1.7112022e+08  0              0              3.0455783    
    400000   2692.5         200            200            0.003880296   -0.0012165859   0              0.012857474    5165.821       0              9.9775603e+08  0              0              2.9958905    
    500000   2692.5         200            200            0.0072728555  -0.0062547431   0              0.028073309    368.48882      0              71172025       0              0              2.9937       
    600000   2692.5         200            200            0.0057001536  -0.0028412422   0              0.019941703    19.914975      0              3846491.5      0              0              2.9947113    
    700000   2692.5         200            200            0.004645625   -0.0022497058   0              0.016186581    0.89884358     0              173607.76      0              0              2.9952313    
    800000   2692.5         200            200            0.0040635549  -0.0020937329   0              0.014284398    1.6420687      0              317158.49      0              0              2.9955223    
    900000   2692.5         200            200            0.0039109869  -0.0020442567   0              0.013777217    0.20069736     0              38763.829      0              0              2.9956041    
   1000000   2692.5         200            200            0.0039253217  -0.0020463607   0              0.013822326    0.00010453901  0              20.191258      0              0              2.9955976    
   1100000   2692.5         200            200            0.0039535754  -0.0020498475   0              0.013910574    0.0031941244   0              616.93134      0              0              2.9955836    
   1200000   2692.5         200            200            0.0039630975  -0.0020510016   0              0.013940294    0.00058460428  0              112.91379      0              0              2.9955788    
   1300000   2692.5         200            200            0.0039631086  -0.0020510118   0              0.013940337    4.4559975e-06  0              0.86065668     0              0              2.9955787    
   1400000   2692.5         200            200            0.0039618263  -0.0020508612   0              0.01393634     5.8296064e-06  0              1.1259633      0              0              2.9955794    
   1500000   2692.5         200            200            0.0039613081  -0.0020507991   0              0.013934723    1.5832919e-06  0              0.305806       0              0              2.9955796    
   1600000   2692.5         200            200            0.0039612724  -0.0020507944   0              0.013934612    3.2804527e-08  0              0.0063360528   0              0              2.9955797    
   1700000   2692.5         200            200            0.003961328   -0.0020508009   0              0.013934785    9.3955901e-09  0              0.0018147177   0              0              2.9955796    
   1800000   2692.5         200            200            0.0039613552  -0.0020508041   0              0.01393487     4.0364289e-09  0              0.00077961882  0              0              2.9955796    
   1900000   2692.5         200            200            0.0039613587  -0.0020508046   0              0.013934881    1.5671107e-10  0              3.0268067e-05  0              0              2.9955796    
   2000000   2692.5         200            200            0.0039613564  -0.0020508043   0              0.013934874    1.2491671e-11  0              2.4127124e-06  0              0              2.9955796    
   2100000   2692.5         200            200            0.003961355   -0.0020508041   0              0.013934869    9.7045432e-12  0              1.8743906e-06  0              0              2.9955796    
   2200000   2692.5         200            200            0.0039613548  -0.0020508041   0              0.013934868    6.0590718e-13  0              1.1702836e-07  0              0              2.9955796    
   2300000   2692.5         200            200            0.0039613549  -0.0020508041   0              0.013934869    1.1380234e-14  0              2.1980432e-09  0              0              2.9955796    
   2400000   2692.5         200            200            0.0039613549  -0.0020508041   0              0.013934869    2.1977627e-14  0              4.2448837e-09  0              0              2.9955796    
   2500000   2692.5         200            200            0.0039613549  -0.0020508041   0              0.013934869    1.9998769e-15  0              3.8626759e-10  0              0              2.9955796    
   2600000   2692.5         200            200            0.0039613549  -0.0020508041   0              0.013934869    2.9178333e-18  0              5.6356691e-13  0              0              2.9955796    
   2700000   2692.5         200            200            0.0039613549  -0.0020508041   0              0.013934869    3.9505395e-17  0              7.6302965e-12  0              0              2.9955796    
   2800000   2692.5         200            200            0.0039613549  -0.0020508041   0              0.013934869    6.6773046e-18  0              1.2896926e-12  0              0              2.9955796    
   2900000   2692.5         200            200            0.0039613549  -0.0020508041   0              0.013934869    6.6506252e-19  0              1.2845396e-13  0              0              2.9955796    
   3000000   2692.5         200            200            0.0039613549  -0.0020508041   0              0.013934869    3.6658605e-18  0              7.0804515e-13  0              0              2.9955796    
Loop time of 180.451 on 2 procs for 3000000 steps with 1251 atoms

Performance: 14364006.103 ns/day, 0.000 hours/ns, 16625.007 timesteps/s
99.9% CPU use with 2 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 41.017     | 41.043     | 41.069     |   0.4 | 22.74
Neigh   | 3.4005     | 3.4009     | 3.4012     |   0.0 |  1.88
Comm    | 14.212     | 14.282     | 14.351     |   1.8 |  7.91
Output  | 0.21227    | 0.2123     | 0.21234    |   0.0 |  0.12
Modify  | 108.63     | 108.64     | 108.65     |   0.1 | 60.20
Other   |            | 12.88      |            |       |  7.14

Nlocal:          625.5 ave         626 max         625 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Nghost:            2.5 ave           3 max           2 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Neighs:          360.5 ave         361 max         360 min
Histogram: 1 0 0 0 0 0 0 0 0 1

Total # of neighbors = 721
Ave neighs/atom = 0.57633893
Neighbor list builds = 164
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 60

#variable lat0 equal 1                    #
variable lat1 equal 3+(v_ind*0.01)        # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 250*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 3.6                                                               
Lattice spacing in x,y,z = 3.6 3.6 3.6

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -1350 ${n1e1} -100 100 -100 100 units box
region box block -1350 1350 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -1350 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -1350 1350 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-1350 -100 -100) to (1350 100 100)
  2 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 750 atoms
  using lattice units in orthogonal box = (-1350 -100 -100) to (1350 100 100)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -750 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -750 750 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 501 atoms
  using lattice units in orthogonal box = (-1350 -100 -100) to (1350 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  750 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  750 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  501 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  501 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
750 atoms in group substrate
group slider1 region slider1
501 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 501 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_60_*.dump id type diameter mass xu yu zu fx fy fz

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 1742 130 130
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 73.75 | 73.75 | 73.75 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   2700           200            200            0              0              0              0              0              0              0              0              0              6            
    100000   2700           200            200            0.0037717805  -2.8048377e-36  0              0.011315341    292858.55      0              5.6564366e+10  0              0              3.3305335    
    200000   2700           200            200            0.0013347986  -9.3494401e-37  0              0.0040043959   71198.973      0              1.3751774e+10  0              0              3.0793222    
    300000   2700           200            200            0.00012351658  9.3494653e-37  0              0.00037054973  1220.7297      0              2.3577867e+08  0              0              3.0486701    
    400000   2700           200            200            0.017927281    4.6747368e-37  0              0.053781842    3636.2912      0              7.0233396e+08  0              0              2.9948285    
    500000   2700           200            200            0.0031352575  -5.8434139e-37  0              0.0094057726   986.9392       0              1.9062305e+08  0              0              2.9984318    
    600000   2700           200            200            0.0066004025   1.4024197e-36  0              0.019801208    85.913646      0              16593850       0              0              2.9973541    
    700000   2700           200            200            0.0045322736   1.4608536e-36  0              0.013596821    19.396736      0              3746395.9      0              0              2.9979428    
    800000   2700           200            200            0.0042478227   1.4608535e-37  0              0.012743468    0.16116249     0              31127.839      0              0              2.9980335    
    900000   2700           200            200            0.004564328   -2.0451949e-37  0              0.013692984    0.27111746     0              52365.168      0              0              2.9979379    
   1000000   2700           200            200            0.0046756102  -7.3042676e-38  0              0.014026831    0.022507681    0              4347.2615      0              0              2.9979041    
   1100000   2700           200            200            0.0046524033   7.3042677e-38  0              0.01395721     0.0018994269   0              366.86611      0              0              2.9979109    
   1200000   2700           200            200            0.0046332631  -1.4608535e-38  0              0.013899789    0.00078339187  0              151.30876      0              0              2.9979166    
   1300000   2700           200            200            0.0046329809   5.8434141e-38  0              0.013898943    7.8179878e-07  0              0.15100106     0              0              2.9979168    
   1400000   2700           200            200            0.0046355114  -1.4608535e-38  0              0.013906534    1.5471143e-05  0              2.9881846      0              0              2.997916     
   1500000   2700           200            200            0.004636001   -7.3042676e-39  0              0.013908003    3.3898765e-07  0              0.065474003    0              0              2.9979159    
   1600000   2700           200            200            0.0046357469  -3.6521338e-38  0              0.013907241    1.8209941e-07  0              0.035171715    0              0              2.9979159    
   1700000   2700           200            200            0.0046356356  -1.2417255e-37  0              0.013906907    2.3913708e-08  0              0.0046188295   0              0              2.997916     
   1800000   2700           200            200            0.00463565    -4.3825606e-38  0              0.01390695     8.9893246e-10  0              0.00017362492  0              0              2.997916     
   1900000   2700           200            200            0.0046356676   7.3042676e-39  0              0.013907003    6.8677867e-10  0              0.00013264834  0              0              2.997916     
   2000000   2700           200            200            0.0046356688   7.3042676e-39  0              0.013907006    3.9638797e-13  0              7.6560625e-08  0              0              2.997916     
   2100000   2700           200            200            0.0046356666  -2.1912803e-38  0              0.013907       1.1718509e-11  0              2.2633795e-06  0              0              2.997916     
   2200000   2700           200            200            0.0046356661  -7.3042676e-39  0              0.013906998    4.8324246e-13  0              9.3336196e-08  0              0              2.997916     
   2300000   2700           200            200            0.0046356662  -2.1912803e-38  0              0.013906999    1.1405712e-13  0              2.2029641e-08  0              0              2.997916     
   2400000   2700           200            200            0.0046356664   7.3042677e-39  0              0.013906999    2.378639e-14   0              4.5942385e-09  0              0              2.997916     
   2500000   2700           200            200            0.0046356663  -1.4608535e-38  0              0.013906999    3.3228009e-16  0              6.4178466e-11  0              0              2.997916     
   2600000   2700           200            200            0.0046356663   1.4608535e-38  0              0.013906999    5.7558204e-16  0              1.1117119e-10  0              0              2.997916     
   2700000   2700           200            200            0.0046356663  -1.4608535e-37  0              0.013906999    1.5751862e-17  0              3.0424042e-12  0              0              2.997916     
   2800000   2700           200            200            0.0046356663   2.8791954e-47  0              0.013906999    1.3902505e-18  0              2.6852088e-13  0              0              2.997916     
   2900000   2700           200            200            0.0046356663   5.8434143e-38  0              0.013906999    3.5855026e-18  0              6.9252435e-13  0              0              2.997916     
   3000000   2700           200            200            0.0046356663  -2.0451949e-37  0              0.013906999    3.844965e-20   0              7.4263839e-15  0              0              2.997916     
Loop time of 183.557 on 2 procs for 3000000 steps with 1251 atoms

Performance: 14120940.080 ns/day, 0.000 hours/ns, 16343.681 timesteps/s
99.9% CPU use with 2 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 43.295     | 43.341     | 43.387     |   0.7 | 23.61
Neigh   | 3.4679     | 3.4683     | 3.4686     |   0.0 |  1.89
Comm    | 14.8       | 14.929     | 15.058     |   3.3 |  8.13
Output  | 0.21125    | 0.21128    | 0.21131    |   0.0 |  0.12
Modify  | 108.8      | 108.88     | 108.96     |   0.8 | 59.32
Other   |            | 12.73      |            |       |  6.93

Nlocal:          625.5 ave         626 max         625 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Nghost:            2.5 ave           3 max           2 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Neighs:          374.5 ave         375 max         374 min
Histogram: 1 0 0 0 0 0 0 0 0 1

Total # of neighbors = 749
Ave neighs/atom = 0.59872102
Neighbor list builds = 168
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 61

#variable lat0 equal 1                    #
variable lat1 equal 3+(v_ind*0.01)        # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 250*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 3.61                                                               
Lattice spacing in x,y,z = 3.61 3.61 3.61

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -1353.75 ${n1e1} -100 100 -100 100 units box
region box block -1353.75 1353.75 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -1353.75 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -1353.75 1353.75 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-1353.75 -100 -100) to (1353.75 100 100)
  2 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 750 atoms
  using lattice units in orthogonal box = (-1353.75 -100 -100) to (1353.75 100 100)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -750 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -750 750 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 501 atoms
  using lattice units in orthogonal box = (-1353.75 -100 -100) to (1353.75 100 100)
  create_atoms CPU = 0.000 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  750 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  750 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  501 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  501 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
750 atoms in group substrate
group slider1 region slider1
501 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 501 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_61_*.dump id type diameter mass xu yu zu fx fy fz

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 1747 130 130
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 73.96 | 73.96 | 73.96 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   2707.5         200            200            0              0              0              0              0              0              0              0              0              6            
    100000   2707.5         200            200            0.0037619143   3.7294336e-36  0              0.011285743    293189.29      0              5.6628246e+10  0              0              3.3261833    
    200000   2707.5         200            200            0.0013364117  -9.3235496e-37  0              0.0040092352   71757.521      0              1.3859655e+10  0              0              3.0737455    
    300000   2707.5         200            200            0.0001027137   9.3942048e-42  0              0.00030814111  867.26603      0              1.6750869e+08  0              0              3.0456121    
    400000   2707.5         200            200            0.0045112849   0.0011638097   0              0.012370045    5161.9493      0              9.9700823e+08  0              0              2.9959625    
    500000   2707.5         200            200            0.011354442    0.005989312    0              0.028074015    359.66766      0              69468256       0              0              2.9936829    
    600000   2707.5         200            200            0.0075404529   0.0028192409   0              0.019802118    20.781244      0              4013807.7      0              0              2.9947153    
    700000   2707.5         200            200            0.0061116351   0.0022321822   0              0.016102723    0.83159311     0              160618.62      0              0              2.9952305    
    800000   2707.5         200            200            0.0054492702   0.0021353141   0              0.014212497    1.6275273      0              314349.87      0              0              2.9955211    
    900000   2707.5         200            200            0.0052782466   0.002131388    0              0.013703352    0.20293917     0              39196.825      0              0              2.9956037    
   1000000   2707.5         200            200            0.005292789    0.0021325725   0              0.013745794    0.00014463575  0              27.935771      0              0              2.9955976    
   1100000   2707.5         200            200            0.0053229587   0.0021356853   0              0.013833191    0.0031498576   0              608.38139      0              0              2.9955836    
   1200000   2707.5         200            200            0.0053332311   0.0021367647   0              0.013862929    0.00058873458  0              113.71154      0              0              2.9955788    
   1300000   2707.5         200            200            0.005333291    0.0021367787   0              0.013863094    4.8328571e-06  0              0.93344549     0              0              2.9955787    
   1400000   2707.5         200            200            0.0053319275   0.0021366385   0              0.013859144    5.7155835e-06  0              1.1039403      0              0              2.9955794    
   1500000   2707.5         200            200            0.00533137     0.0021365801   0              0.01385753     1.5889469e-06  0              0.30689823     0              0              2.9955796    
   1600000   2707.5         200            200            0.0053313293   0.0021365755   0              0.013857413    3.4310195e-08  0              0.0066268662   0              0              2.9955797    
   1700000   2707.5         200            200            0.0053313883   0.0021365815   0              0.013857583    9.135041e-09   0              0.0017643937   0              0              2.9955796    
   1800000   2707.5         200            200            0.0053314175   0.0021365846   0              0.013857668    4.03767e-09    0              0.00077985853  0              0              2.9955796    
   1900000   2707.5         200            200            0.0053314213   0.002136585    0              0.013857679    1.6140627e-10  0              3.1174925e-05  0              0              2.9955796    
   2000000   2707.5         200            200            0.0053314189   0.0021365848   0              0.013857672    1.1974629e-11  0              2.312848e-06   0              0              2.9955796    
   2100000   2707.5         200            200            0.0053314175   0.0021365846   0              0.013857668    9.6742393e-12  0              1.8685376e-06  0              0              2.9955796    
   2200000   2707.5         200            200            0.0053314172   0.0021365846   0              0.013857667    6.1851547e-13  0              1.1946359e-07  0              0              2.9955796    
   2300000   2707.5         200            200            0.0053314173   0.0021365846   0              0.013857667    1.0552797e-14  0              2.0382271e-09  0              0              2.9955796    
   2400000   2707.5         200            200            0.0053314173   0.0021365846   0              0.013857667    2.1813981e-14  0              4.2132764e-09  0              0              2.9955796    
   2500000   2707.5         200            200            0.0053314174   0.0021365846   0              0.013857667    2.0266202e-15  0              3.9143294e-10  0              0              2.9955796    
   2600000   2707.5         200            200            0.0053314174   0.0021365846   0              0.013857667    2.3929256e-18  0              4.6218325e-13  0              0              2.9955796    
   2700000   2707.5         200            200            0.0053314174   0.0021365846   0              0.013857667    4.0086697e-17  0              7.7425726e-12  0              0              2.9955796    
   2800000   2707.5         200            200            0.0053314174   0.0021365846   0              0.013857667    6.7245355e-18  0              1.298815e-12   0              0              2.9955796    
   2900000   2707.5         200            200            0.0053314174   0.0021365846   0              0.013857667    3.1161006e-19  0              6.0186139e-14  0              0              2.9955796    
   3000000   2707.5         200            200            0.0053314174   0.0021365846   0              0.013857667    2.6222681e-18  0              5.0647977e-13  0              0              2.9955796    
Loop time of 180.175 on 2 procs for 3000000 steps with 1251 atoms

Performance: 14385989.853 ns/day, 0.000 hours/ns, 16650.451 timesteps/s
99.9% CPU use with 2 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 40.549     | 40.685     | 40.821     |   2.1 | 22.58
Neigh   | 3.4051     | 3.4053     | 3.4054     |   0.0 |  1.89
Comm    | 14.573     | 14.607     | 14.64      |   0.9 |  8.11
Output  | 0.21951    | 0.21954    | 0.21956    |   0.0 |  0.12
Modify  | 108.43     | 108.55     | 108.68     |   1.2 | 60.25
Other   |            | 12.7       |            |       |  7.05

Nlocal:          625.5 ave         626 max         625 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Nghost:            2.5 ave           3 max           2 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Neighs:          359.5 ave         360 max         359 min
Histogram: 1 0 0 0 0 0 0 0 0 1

Total # of neighbors = 719
Ave neighs/atom = 0.57474021
Neighbor list builds = 164
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 62

#variable lat0 equal 1                    #
variable lat1 equal 3+(v_ind*0.01)        # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 250*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 3.62                                                               
Lattice spacing in x,y,z = 3.62 3.62 3.62

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -1357.5 ${n1e1} -100 100 -100 100 units box
region box block -1357.5 1357.5 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -1357.5 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -1357.5 1357.5 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-1357.5 -100 -100) to (1357.5 100 100)
  2 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 750 atoms
  using lattice units in orthogonal box = (-1357.5 -100 -100) to (1357.5 100 100)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -750 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -750 750 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 501 atoms
  using lattice units in orthogonal box = (-1357.5 -100 -100) to (1357.5 100 100)
  create_atoms CPU = 0.000 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  750 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  750 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  501 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  501 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
750 atoms in group substrate
group slider1 region slider1
501 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 501 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_62_*.dump id type diameter mass xu yu zu fx fy fz

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 1752 130 130
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 74.1 | 74.1 | 74.1 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   2715           200            200            0              0              0              0              0              0              0              0              0              6            
    100000   2715           200            200            0.0037507017   1.1622264e-37  0              0.011252105    293101.22      0              5.6611236e+10  0              0              3.3262058    
    200000   2715           200            200            0.0013311727   4.6489089e-37  0              0.003993518    71631.488      0              1.3835313e+10  0              0              3.073781     
    300000   2715           200            200            9.9055235e-05  2.7893439e-36  0              0.0002971657   813.81251      0              1.5718437e+08  0              0              3.045498     
    400000   2715           200            200            0.0029001391   0.00064960074  0              0.0080508164   5010.6122      0              9.6777812e+08  0              0              2.9966763    
    500000   2715           200            200            0.0099583428  -0.003299853    0              0.033174881    1.0798877      0              208575.64      0              0              2.9929639    
    600000   2715           200            200            0.0040952453   0.0010396367   0              0.011246099    88.26414       0              17047838       0              0              2.9959041    
    700000   2715           200            200            0.0043358027   0.00014102318  0              0.012866385    11.932469      0              2304704.9      0              0              2.9956095    
    800000   2715           200            200            0.0045616166  -0.0001325169   0              0.013817367    1.9882691      0              384025.6       0              0              2.9954493    
    900000   2715           200            200            0.0046096434  -0.00014013181  0              0.013969062    0.20377219     0              39357.72       0              0              2.9954233    
   1000000   2715           200            200            0.0045920415  -0.00013898386  0              0.013915108    0.0092494082   0              1786.4833      0              0              2.9954314    
   1100000   2715           200            200            0.0045741674  -0.00013707982  0              0.013859582    6.2895664e-09  0              0.0012148026   0              0              2.9954402    
   1200000   2715           200            200            0.004565191   -0.0001360931   0              0.013831666    0.00016718718  0              32.291483      0              0              2.9954447    
   1300000   2715           200            200            0.0045619073  -0.00013572558  0              0.013821447    6.7522891e-05  0              13.041755      0              0              2.9954464    
   1400000   2715           200            200            0.0045610346  -0.00013562632  0              0.01381873     1.2038414e-05  0              2.3251677      0              0              2.9954468    
   1500000   2715           200            200            0.004560924   -0.00013561307  0              0.013818385    1.193711e-06   0              0.23056013     0              0              2.9954469    
   1600000   2715           200            200            0.0045609717  -0.00013561808  0              0.013818533    5.0582803e-08  0              0.0097698501   0              0              2.9954469    
   1700000   2715           200            200            0.0045610169  -0.00013562304  0              0.013818674    2.3055661e-11  0              4.4531015e-06  0              0              2.9954469    
   1800000   2715           200            200            0.0045610391  -0.00013562552  0              0.013818743    1.1171178e-09  0              0.00021576649  0              0              2.9954468    
   1900000   2715           200            200            0.0045610471  -0.00013562642  0              0.013818768    4.2299749e-10  0              8.170014e-05   0              0              2.9954468    
   2000000   2715           200            200            0.0045610492  -0.00013562666  0              0.013818774    7.2943732e-11  0              1.4088767e-05  0              0              2.9954468    
   2100000   2715           200            200            0.0045610495  -0.00013562669  0              0.013818775    6.9879128e-12  0              1.3496852e-06  0              0              2.9954468    
   2200000   2715           200            200            0.0045610493  -0.00013562667  0              0.013818775    2.7516049e-13  0              5.3146061e-08  0              0              2.9954468    
   2300000   2715           200            200            0.0045610492  -0.00013562666  0              0.013818774    5.8035702e-16  0              1.1209345e-10  0              0              2.9954468    
   2400000   2715           200            200            0.0045610492  -0.00013562666  0              0.013818774    7.4056561e-15  0              1.4303705e-09  0              0              2.9954468    
   2500000   2715           200            200            0.0045610492  -0.00013562665  0              0.013818774    2.6070049e-15  0              5.0353175e-10  0              0              2.9954468    
   2600000   2715           200            200            0.0045610492  -0.00013562665  0              0.013818774    4.4287448e-16  0              8.5539295e-11  0              0              2.9954468    
   2700000   2715           200            200            0.0045610492  -0.00013562665  0              0.013818774    4.8809124e-17  0              9.4272717e-12  0              0              2.9954468    
   2800000   2715           200            200            0.0045610492  -0.00013562665  0              0.013818774    2.3301753e-18  0              4.5006331e-13  0              0              2.9954468    
   2900000   2715           200            200            0.0045610492  -0.00013562665  0              0.013818774    3.4993014e-19  0              6.7587497e-14  0              0              2.9954468    
   3000000   2715           200            200            0.0045610492  -0.00013562665  0              0.013818774    2.7899849e-18  0              5.3887354e-13  0              0              2.9954468    
Loop time of 179.811 on 2 procs for 3000000 steps with 1251 atoms

Performance: 14415120.484 ns/day, 0.000 hours/ns, 16684.167 timesteps/s
99.9% CPU use with 2 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 40.775     | 40.797     | 40.82      |   0.4 | 22.69
Neigh   | 3.43       | 3.4304     | 3.4308     |   0.0 |  1.91
Comm    | 13.95      | 14.048     | 14.146     |   2.6 |  7.81
Output  | 0.21212    | 0.21216    | 0.21221    |   0.0 |  0.12
Modify  | 108.53     | 108.57     | 108.6      |   0.3 | 60.38
Other   |            | 12.76      |            |       |  7.10

Nlocal:          625.5 ave         626 max         625 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Nghost:            2.5 ave           3 max           2 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Neighs:          358.5 ave         359 max         358 min
Histogram: 1 0 0 0 0 0 0 0 0 1

Total # of neighbors = 717
Ave neighs/atom = 0.57314149
Neighbor list builds = 164
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 63

#variable lat0 equal 1                    #
variable lat1 equal 3+(v_ind*0.01)        # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 250*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 3.63                                                               
Lattice spacing in x,y,z = 3.63 3.63 3.63

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -1361.25 ${n1e1} -100 100 -100 100 units box
region box block -1361.25 1361.25 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -1361.25 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -1361.25 1361.25 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-1361.25 -100 -100) to (1361.25 100 100)
  2 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 750 atoms
  using lattice units in orthogonal box = (-1361.25 -100 -100) to (1361.25 100 100)
  create_atoms CPU = 0.000 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -750 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -750 750 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 501 atoms
  using lattice units in orthogonal box = (-1361.25 -100 -100) to (1361.25 100 100)
  create_atoms CPU = 0.000 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  750 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  750 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  501 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  501 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
750 atoms in group substrate
group slider1 region slider1
501 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 501 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_63_*.dump id type diameter mass xu yu zu fx fy fz

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 1757 130 130
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 74.31 | 74.31 | 74.31 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   2722.5         200            200            0              0              0              0              0              0              0              0              0              6            
    100000   2722.5         200            200            0.0037406845   2.3180488e-37  0              0.011222053    293126.88      0              5.6616192e+10  0              0              3.3263306    
    200000   2722.5         200            200            0.001327889    1.4487804e-38  0              0.003983667    71658.267      0              1.3840485e+10  0              0              3.0739655    
    300000   2722.5         200            200            0.00010090652  4.6360994e-37  0              0.00030271957  847.33323      0              1.6365876e+08  0              0              3.0456489    
    400000   2722.5         200            200            0.0037677447  -0.00075381617  0              0.01205705     5161.1738      0              9.9685845e+08  0              0              2.9959841    
    500000   2722.5         200            200            0.0086224344  -0.0018835013   0              0.027750804    372.97783      0              72039058       0              0              2.9937015    
    600000   2722.5         200            200            0.0061264132  -0.0014623209   0              0.01984156     17.372976      0              3355515.3      0              0              2.9946886    
    700000   2722.5         200            200            0.0045596962  -0.00099776175  0              0.01467685     12.651144      0              2443513.8      0              0              2.9954208    
    800000   2722.5         200            200            0.0039906829  -0.00098228729  0              0.012954336    0.0047492029   0              917.28804      0              0              2.9956985    
    900000   2722.5         200            200            0.0043139638  -0.0010126628   0              0.013954554    0.18760352     0              36234.81       0              0              2.9955391    
   1000000   2722.5         200            200            0.0042728028  -0.0010086258   0              0.013827034    0.030429996    0              5877.4224      0              0              2.9955582    
   1100000   2722.5         200            200            0.0042448328  -0.0010056492   0              0.013740148    7.8242248e-05  0              15.112153      0              0              2.9955722    
   1200000   2722.5         200            200            0.0042611913  -0.0010073515   0              0.013790925    0.0004052961   0              78.281192      0              0              2.9955642    
   1300000   2722.5         200            200            0.0042586584  -0.0010070979   0              0.013783073    8.0348441e-05  0              15.518955      0              0              2.9955654    
   1400000   2722.5         200            200            0.0042574259  -0.0010069662   0              0.013779244    5.4875846e-07  0              0.10599033     0              0              2.995566     
   1500000   2722.5         200            200            0.0042582437  -0.0010070513   0              0.013781782    8.5494399e-07  0              0.16512874     0              0              2.9955656    
   1600000   2722.5         200            200            0.0042580945  -0.0010070362   0              0.01378132     2.0874692e-07  0              0.040318566    0              0              2.9955657    
   1700000   2722.5         200            200            0.0042580416  -0.0010070305   0              0.013781155    2.647819e-09   0              0.00051141482  0              0              2.9955657    
   1800000   2722.5         200            200            0.0042580822  -0.0010070348   0              0.013781281    1.750882e-09   0              0.00033817529  0              0              2.9955657    
   1900000   2722.5         200            200            0.0042580737  -0.0010070339   0              0.013781255    5.3352093e-10  0              0.00010304727  0              0              2.9955657    
   2000000   2722.5         200            200            0.0042580715  -0.0010070337   0              0.013781248    1.0646576e-11  0              2.0563402e-06  0              0              2.9955657    
   2100000   2722.5         200            200            0.0042580735  -0.0010070339   0              0.013781254    3.4612071e-12  0              6.6851721e-07  0              0              2.9955657    
   2200000   2722.5         200            200            0.004258073   -0.0010070338   0              0.013781253    1.3428091e-12  0              2.5935777e-07  0              0              2.9955657    
   2300000   2722.5         200            200            0.0042580729  -0.0010070338   0              0.013781253    3.8607176e-14  0              7.4568094e-09  0              0              2.9955657    
   2400000   2722.5         200            200            0.004258073   -0.0010070338   0              0.013781253    6.5661969e-15  0              1.2682326e-09  0              0              2.9955657    
   2500000   2722.5         200            200            0.004258073   -0.0010070338   0              0.013781253    3.3244371e-15  0              6.4210067e-10  0              0              2.9955657    
   2600000   2722.5         200            200            0.004258073   -0.0010070338   0              0.013781253    1.3486631e-16  0              2.6048847e-11  0              0              2.9955657    
   2700000   2722.5         200            200            0.004258073   -0.0010070338   0              0.013781253    2.1067986e-17  0              4.0691906e-12  0              0              2.9955657    
   2800000   2722.5         200            200            0.004258073   -0.0010070338   0              0.013781253    7.7090864e-18  0              1.4889768e-12  0              0              2.9955657    
   2900000   2722.5         200            200            0.004258073   -0.0010070338   0              0.013781253    8.033979e-20   0              1.5517284e-14  0              0              2.9955657    
   3000000   2722.5         200            200            0.004258073   -0.0010070338   0              0.013781253    1.3373517e-18  0              2.583037e-13   0              0              2.9955657    
Loop time of 180.629 on 2 procs for 3000000 steps with 1251 atoms

Performance: 14349826.269 ns/day, 0.000 hours/ns, 16608.595 timesteps/s
99.9% CPU use with 2 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 40.69      | 40.791     | 40.892     |   1.6 | 22.58
Neigh   | 3.4344     | 3.4345     | 3.4347     |   0.0 |  1.90
Comm    | 14.671     | 14.748     | 14.826     |   2.0 |  8.17
Output  | 0.21324    | 0.21328    | 0.21331    |   0.0 |  0.12
Modify  | 108.59     | 108.72     | 108.85     |   1.2 | 60.19
Other   |            | 12.72      |            |       |  7.04

Nlocal:          625.5 ave         626 max         625 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Nghost:            2.5 ave           3 max           2 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Neighs:          360.5 ave         361 max         360 min
Histogram: 1 0 0 0 0 0 0 0 0 1

Total # of neighbors = 721
Ave neighs/atom = 0.57633893
Neighbor list builds = 164
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 64

#variable lat0 equal 1                    #
variable lat1 equal 3+(v_ind*0.01)        # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 250*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 3.64                                                               
Lattice spacing in x,y,z = 3.64 3.64 3.64

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -1365 ${n1e1} -100 100 -100 100 units box
region box block -1365 1365 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -1365 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -1365 1365 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-1365 -100 -100) to (1365 100 100)
  2 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 750 atoms
  using lattice units in orthogonal box = (-1365 -100 -100) to (1365 100 100)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -750 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -750 750 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 501 atoms
  using lattice units in orthogonal box = (-1365 -100 -100) to (1365 100 100)
  create_atoms CPU = 0.000 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  750 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  750 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  501 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  501 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
750 atoms in group substrate
group slider1 region slider1
501 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 501 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_64_*.dump id type diameter mass xu yu zu fx fy fz

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 1762 130 130
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 74.45 | 74.45 | 74.45 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   2730           200            200            0              0              0              0              0              0              0              0              0              6            
    100000   2730           200            200            0.0037307496   7.3973892e-36  0              0.011192249    293173.71      0              5.6625237e+10  0              0              3.3261606    
    200000   2730           200            200            0.0013254328   2.3184801e-43  0              0.0039762984   71762.915      0              1.3860697e+10  0              0              3.0736387    
    300000   2730           200            200            0.00010091045  5.5480348e-36  0              0.00030273134  851.88075      0              1.6453709e+08  0              0              3.0455636    
    400000   2730           200            200            0.0040781205   0.00019603107  0              0.01203833     5162.7922      0              9.9717103e+08  0              0              2.9959212    
    500000   2730           200            200            0.0079414791  -0.0022698242   0              0.026094262    461.54599      0              89145615       0              0              2.9938249    
    600000   2730           200            200            0.0065295583  -0.00076502248  0              0.020353697    1.7204902      0              332305.25      0              0              2.9945544    
    700000   2730           200            200            0.0046911624   1.6820038e-05  0              0.014056667    14.650048      0              2829593.6      0              0              2.9954374    
    800000   2730           200            200            0.0043614906   0.00012970242  0              0.012954769    0.16755556     0              32362.633      0              0              2.9956202    
    900000   2730           200            200            0.0046927146   7.0693396e-05  0              0.01400745     0.073179187    0              14134.244      0              0              2.9954513    
   1000000   2730           200            200            0.0045977632   7.5795402e-05  0              0.013717494    0.034820056    0              6725.3435      0              0              2.9954961    
   1100000   2730           200            200            0.0045987498   7.5789002e-05  0              0.01372046     0.0034293284   0              662.35999      0              0              2.995496     
   1200000   2730           200            200            0.0046111115   7.5335877e-05  0              0.013757999    2.1777495e-05  0              4.2062293      0              0              2.99549      
   1300000   2730           200            200            0.0046046833   7.55637e-05    0              0.013738486    3.0589882e-05  0              5.9083036      0              0              2.9954931    
   1400000   2730           200            200            0.004606292    7.5506993e-05  0              0.013743369    1.1912241e-05  0              2.300798       0              0              2.9954923    
   1500000   2730           200            200            0.0046063393   7.5504773e-05  0              0.013743513    1.027159e-06   0              0.19839133     0              0              2.9954923    
   1600000   2730           200            200            0.0046060979   7.5513535e-05  0              0.01374278     2.5850494e-09  0              0.00049929114  0              0              2.9954924    
   1700000   2730           200            200            0.0046062146   7.5509364e-05  0              0.013743134    1.2306774e-08  0              0.0023770003   0              0              2.9954924    
   1800000   2730           200            200            0.0046061877   7.5510308e-05  0              0.013743053    4.0261394e-09  0              0.00077763146  0              0              2.9954924    
   1900000   2730           200            200            0.0046061857   7.5510389e-05  0              0.013743047    3.0217148e-10  0              5.8363117e-05  0              0              2.9954924    
   2000000   2730           200            200            0.0046061903   7.551022e-05   0              0.013743061    8.8628849e-14  0              1.711828e-08   0              0              2.9954924    
   2100000   2730           200            200            0.0046061882   7.5510295e-05  0              0.013743054    4.8211301e-12  0              9.3118048e-07  0              0              2.9954924    
   2200000   2730           200            200            0.0046061887   7.551028e-05   0              0.013743056    1.345793e-12   0              2.599341e-07   0              0              2.9954924    
   2300000   2730           200            200            0.0046061887   7.5510278e-05  0              0.013743056    8.7298435e-14  0              1.6861316e-08  0              0              2.9954924    
   2400000   2730           200            200            0.0046061886   7.5510281e-05  0              0.013743056    4.0814342e-17  0              7.883114e-12   0              0              2.9954924    
   2500000   2730           200            200            0.0046061887   7.551028e-05   0              0.013743056    1.8367742e-15  0              3.5476501e-10  0              0              2.9954924    
   2600000   2730           200            200            0.0046061887   7.551028e-05   0              0.013743056    4.4644237e-16  0              8.6228417e-11  0              0              2.9954924    
   2700000   2730           200            200            0.0046061887   7.551028e-05   0              0.013743056    1.6891657e-17  0              3.2625507e-12  0              0              2.9954924    
   2800000   2730           200            200            0.0046061887   7.551028e-05   0              0.013743056    2.4740702e-19  0              4.7785598e-14  0              0              2.9954924    
   2900000   2730           200            200            0.0046061887   7.551028e-05   0              0.013743056    7.3979338e-19  0              1.428879e-13   0              0              2.9954924    
   3000000   2730           200            200            0.0046061887   7.5510282e-05  0              0.013743056    1.0795823e-19  0              2.0851666e-14  0              0              2.9954924    
Loop time of 181.069 on 2 procs for 3000000 steps with 1251 atoms

Performance: 14314997.243 ns/day, 0.000 hours/ns, 16568.284 timesteps/s
100.0% CPU use with 2 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 41.345     | 41.536     | 41.727     |   3.0 | 22.94
Neigh   | 3.3981     | 3.3986     | 3.3991     |   0.0 |  1.88
Comm    | 14.572     | 14.592     | 14.612     |   0.5 |  8.06
Output  | 0.212      | 0.21202    | 0.21204    |   0.0 |  0.12
Modify  | 108.48     | 108.63     | 108.77     |   1.4 | 59.99
Other   |            | 12.7       |            |       |  7.02

Nlocal:          625.5 ave         626 max         625 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Nghost:            2.5 ave           3 max           2 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Neighs:          357.5 ave         358 max         357 min
Histogram: 1 0 0 0 0 0 0 0 0 1

Total # of neighbors = 715
Ave neighs/atom = 0.57154277
Neighbor list builds = 164
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 65

#variable lat0 equal 1                    #
variable lat1 equal 3+(v_ind*0.01)        # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 250*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 3.65                                                               
Lattice spacing in x,y,z = 3.65 3.65 3.65

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -1368.75 ${n1e1} -100 100 -100 100 units box
region box block -1368.75 1368.75 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -1368.75 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -1368.75 1368.75 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-1368.75 -100 -100) to (1368.75 100 100)
  2 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 750 atoms
  using lattice units in orthogonal box = (-1368.75 -100 -100) to (1368.75 100 100)
  create_atoms CPU = 0.000 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -750 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -750 750 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 501 atoms
  using lattice units in orthogonal box = (-1368.75 -100 -100) to (1368.75 100 100)
  create_atoms CPU = 0.000 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  750 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  750 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  501 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  501 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
750 atoms in group substrate
group slider1 region slider1
501 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 501 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_65_*.dump id type diameter mass xu yu zu fx fy fz

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 1767 130 130
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 74.65 | 74.65 | 74.65 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   2737.5         200            200            0              0              0              0              0              0              0              0              0              6            
    100000   2737.5         200            200            0.0037198307  -1.1065645e-35  0              0.011159492    293087.64      0              5.6608613e+10  0              0              3.3263506    
    200000   2737.5         200            200            0.0013195974  -5.7633667e-38  0              0.0039587922   71573.036      0              1.3824023e+10  0              0              3.0740682    
    300000   2737.5         200            200            9.6942235e-05 -4.6106889e-37  0              0.00029082671  793.36847      0              1.532357e+08   0              0              3.045696     
    400000   2737.5         200            200            0.002676147   -8.3360759e-05  0              0.0081118017   5039.2842      0              9.73316e+08    0              0              2.9967756    
    500000   2737.5         200            200            0.0099202943  -0.00059947574  0              0.030360359    190.06864      0              36710937       0              0              2.9933894    
    600000   2737.5         200            200            0.0064243021  -0.00052151208  0              0.019794418    18.024134      0              3481283.6      0              0              2.9947013    
    700000   2737.5         200            200            0.004214858   -0.00033270358  0              0.012977278    13.649131      0              2636270.8      0              0              2.9956808    
    800000   2737.5         200            200            0.0044744412  -0.00032152762  0              0.013744851    2.0199745      0              390149.35      0              0              2.9955668    
    900000   2737.5         200            200            0.0044677421  -0.00033401426  0              0.01373724     0.2696727      0              52086.119      0              0              2.995565     
   1000000   2737.5         200            200            0.0044475243  -0.0003340445   0              0.013676617    0.034276889    0              6620.4332      0              0              2.9955756    
   1100000   2737.5         200            200            0.0044627827  -0.00033402533  0              0.013722374    0.0041577346   0              803.04849      0              0              2.995568     
   1200000   2737.5         200            200            0.0044545217  -0.00033403687  0              0.013697602    0.00047641173  0              92.016869      0              0              2.995572     
   1300000   2737.5         200            200            0.0044584708  -0.0003340318   0              0.013709444    5.118435e-05   0              9.8860363      0              0              2.9955701    
   1400000   2737.5         200            200            0.004456718   -0.00033403412  0              0.013704188    5.0618022e-06  0              0.97766525     0              0              2.995571     
   1500000   2737.5         200            200            0.0044574583  -0.00033403316  0              0.013706408    4.4696884e-07  0              0.086330103    0              0              2.9955706    
   1600000   2737.5         200            200            0.0044571571  -0.00033403355  0              0.013705505    3.3088545e-08  0              0.0063909097   0              0              2.9955708    
   1700000   2737.5         200            200            0.004457276   -0.0003340334   0              0.013705861    1.7537069e-09  0              0.00033872091  0              0              2.9955707    
   1800000   2737.5         200            200            0.0044572303  -0.00033403346  0              0.013705724    3.4349109e-11  0              6.6343821e-06  0              0              2.9955707    
   1900000   2737.5         200            200            0.0044572474  -0.00033403344  0              0.013705776    1.9516364e-12  0              3.7695014e-07  0              0              2.9955707    
   2000000   2737.5         200            200            0.0044572411  -0.00033403344  0              0.013705757    3.2631423e-12  0              6.3026185e-07  0              0              2.9955707    
   2100000   2737.5         200            200            0.0044572434  -0.00033403344  0              0.013705764    1.2629739e-12  0              2.4393796e-07  0              0              2.9955707    
   2200000   2737.5         200            200            0.0044572426  -0.00033403344  0              0.013705761    3.2766233e-13  0              6.3286565e-08  0              0              2.9955707    
   2300000   2737.5         200            200            0.0044572429  -0.00033403344  0              0.013705762    6.9369211e-14  0              1.3398364e-08  0              0              2.9955707    
   2400000   2737.5         200            200            0.0044572428  -0.00033403344  0              0.013705762    1.3128082e-14  0              2.5356323e-09  0              0              2.9955707    
   2500000   2737.5         200            200            0.0044572428  -0.00033403344  0              0.013705762    2.2552256e-15  0              4.3558709e-10  0              0              2.9955707    
   2600000   2737.5         200            200            0.0044572428  -0.00033403344  0              0.013705762    3.675327e-16   0              7.0987355e-11  0              0              2.9955707    
   2700000   2737.5         200            200            0.0044572428  -0.00033403344  0              0.013705762    5.925034e-17   0              1.1443947e-11  0              0              2.9955707    
   2800000   2737.5         200            200            0.0044572428  -0.00033403344  0              0.013705762    7.7816307e-18  0              1.5029884e-12  0              0              2.9955707    
   2900000   2737.5         200            200            0.0044572428  -0.00033403344  0              0.013705762    1.6678114e-18  0              3.2213057e-13  0              0              2.9955707    
   3000000   2737.5         200            200            0.0044572428  -0.00033403344  0              0.013705762    5.7032358e-19  0              1.1015554e-13  0              0              2.9955707    
Loop time of 181.302 on 2 procs for 3000000 steps with 1251 atoms

Performance: 14296601.386 ns/day, 0.000 hours/ns, 16546.992 timesteps/s
99.9% CPU use with 2 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 40.955     | 41.144     | 41.332     |   2.9 | 22.69
Neigh   | 3.4464     | 3.4466     | 3.4468     |   0.0 |  1.90
Comm    | 14.698     | 14.708     | 14.717     |   0.3 |  8.11
Output  | 0.26397    | 0.264      | 0.26403    |   0.0 |  0.15
Modify  | 108.81     | 108.99     | 109.18     |   1.8 | 60.12
Other   |            | 12.75      |            |       |  7.03

Nlocal:          625.5 ave         626 max         625 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Nghost:            2.5 ave           3 max           2 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Neighs:          356.5 ave         357 max         356 min
Histogram: 1 0 0 0 0 0 0 0 0 1

Total # of neighbors = 713
Ave neighs/atom = 0.56994404
Neighbor list builds = 164
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 66

#variable lat0 equal 1                    #
variable lat1 equal 3+(v_ind*0.01)        # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 250*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 3.66                                                               
Lattice spacing in x,y,z = 3.66 3.66 3.66

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -1372.5 ${n1e1} -100 100 -100 100 units box
region box block -1372.5 1372.5 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -1372.5 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -1372.5 1372.5 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-1372.5 -100 -100) to (1372.5 100 100)
  2 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 750 atoms
  using lattice units in orthogonal box = (-1372.5 -100 -100) to (1372.5 100 100)
  create_atoms CPU = 0.000 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -750 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -750 750 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 501 atoms
  using lattice units in orthogonal box = (-1372.5 -100 -100) to (1372.5 100 100)
  create_atoms CPU = 0.000 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  750 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  750 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  501 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  501 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
750 atoms in group substrate
group slider1 region slider1
501 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 501 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_66_*.dump id type diameter mass xu yu zu fx fy fz

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 1771 130 130
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 74.79 | 74.79 | 74.79 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   2745           200            200            0              0              0              0              0              0              0              0              0              6            
    100000   2745           200            200            0.003710049   -2.2990475e-37  0              0.011130147    293140.04      0              5.6618734e+10  0              0              3.3261628    
    200000   2745           200            200            0.0013168989   1.8392403e-36  0              0.0039506968   71653.213      0              1.3839509e+10  0              0              3.0738124    
    300000   2745           200            200            9.6501291e-05  1.8392436e-36  0              0.00028950387  790.64654      0              1.5270997e+08  0              0              3.0456404    
    400000   2745           200            200            0.0024456922   0.00068733726  0              0.0066497393   4946.3535      0              9.5536684e+08  0              0              2.99708      
    500000   2745           200            200            0.012515671    0.004707934    0              0.03283908     10.195498      0              1969216.5      0              0              2.9930808    
    600000   2745           200            200            0.0043182736   0.0023376696   0              0.010617151    78.312097      0              15125644       0              0              2.9961217    
    700000   2745           200            200            0.0047622029   0.0027314251   0              0.011555184    0.38437528     0              74240.427      0              0              2.995937     
    800000   2745           200            200            0.0052531307   0.0027935684   0              0.012965824    0.4657848      0              89964.325      0              0              2.9956895    
    900000   2745           200            200            0.0054538987   0.0028149235   0              0.013546772    0.22409023     0              43282.06       0              0              2.9955917    
   1000000   2745           200            200            0.005504028    0.002819874    0              0.01369221     0.03428297     0              6621.6078      0              0              2.9955679    
   1100000   2745           200            200            0.0055062671   0.0028200506   0              0.013698751    0.0020096797   0              388.16096      0              0              2.995567     
   1200000   2745           200            200            0.0055008224   0.0028194943   0              0.013682973    1.8217392e-06  0              0.35186107     0              0              2.9955697    
   1300000   2745           200            200            0.0054973228   0.002819143    0              0.013672825    2.7665083e-05  0              5.3433913      0              0              2.9955714    
   1400000   2745           200            200            0.0054960008   0.0028190116   0              0.013668991    1.0724241e-05  0              2.0713408      0              0              2.995572     
   1500000   2745           200            200            0.0054956961   0.0028189818   0              0.013668106    1.4765209e-06  0              0.28518364     0              0              2.9955722    
   1600000   2745           200            200            0.0054956955   0.0028189821   0              0.013668104    7.4074636e-08  0              0.014307196    0              0              2.9955722    
   1700000   2745           200            200            0.0054957363   0.0028189863   0              0.013668223    1.6726363e-11  0              3.2306248e-06  0              0              2.9955722    
   1800000   2745           200            200            0.0054957604   0.0028189887   0              0.013668292    1.5338767e-09  0              0.00029626167  0              0              2.9955721    
   1900000   2745           200            200            0.005495769    0.0028189895   0              0.013668317    5.0513113e-10  0              9.7563897e-05  0              0              2.9955721    
   2000000   2745           200            200            0.0054957708   0.0028189897   0              0.013668323    6.2810455e-11  0              1.2131568e-05  0              0              2.9955721    
   2100000   2745           200            200            0.0054957707   0.0028189897   0              0.013668323    2.6384339e-12  0              5.0960212e-07  0              0              2.9955721    
   2200000   2745           200            200            0.0054957704   0.0028189897   0              0.013668322    1.3347695e-14  0              2.5780497e-09  0              0              2.9955721    
   2300000   2745           200            200            0.0054957703   0.0028189896   0              0.013668321    8.2473241e-14  0              1.5929351e-08  0              0              2.9955721    
   2400000   2745           200            200            0.0054957702   0.0028189896   0              0.013668321    2.3544587e-14  0              4.5475354e-09  0              0              2.9955721    
   2500000   2745           200            200            0.0054957702   0.0028189896   0              0.013668321    2.6555782e-15  0              5.1291346e-10  0              0              2.9955721    
   2600000   2745           200            200            0.0054957702   0.0028189896   0              0.013668321    8.8208223e-17  0              1.7037038e-11  0              0              2.9955721    
   2700000   2745           200            200            0.0054957702   0.0028189896   0              0.013668321    4.841005e-18   0              9.3501923e-13  0              0              2.9955721    
   2800000   2745           200            200            0.0054957702   0.0028189896   0              0.013668321    4.8144504e-18  0              9.2989031e-13  0              0              2.9955721    
   2900000   2745           200            200            0.0054957702   0.0028189896   0              0.013668321    2.1281347e-18  0              4.1104004e-13  0              0              2.9955721    
   3000000   2745           200            200            0.0054957702   0.0028189896   0              0.013668321    2.5116772e-18  0              4.8511962e-13  0              0              2.9955721    
Loop time of 179.859 on 2 procs for 3000000 steps with 1251 atoms

Performance: 14411262.162 ns/day, 0.000 hours/ns, 16679.702 timesteps/s
99.9% CPU use with 2 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 40.217     | 40.336     | 40.455     |   1.9 | 22.43
Neigh   | 3.4134     | 3.4138     | 3.4143     |   0.0 |  1.90
Comm    | 14.606     | 14.677     | 14.749     |   1.9 |  8.16
Output  | 0.21332    | 0.21336    | 0.2134     |   0.0 |  0.12
Modify  | 108.43     | 108.54     | 108.66     |   1.1 | 60.35
Other   |            | 12.68      |            |       |  7.05

Nlocal:          625.5 ave         626 max         625 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Nghost:            2.5 ave           3 max           2 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Neighs:          361.5 ave         362 max         361 min
Histogram: 1 0 0 0 0 0 0 0 0 1

Total # of neighbors = 723
Ave neighs/atom = 0.57793765
Neighbor list builds = 164
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 67

#variable lat0 equal 1                    #
variable lat1 equal 3+(v_ind*0.01)        # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 250*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 3.67                                                               
Lattice spacing in x,y,z = 3.67 3.67 3.67

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -1376.25 ${n1e1} -100 100 -100 100 units box
region box block -1376.25 1376.25 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -1376.25 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -1376.25 1376.25 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-1376.25 -100 -100) to (1376.25 100 100)
  2 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 750 atoms
  using lattice units in orthogonal box = (-1376.25 -100 -100) to (1376.25 100 100)
  create_atoms CPU = 0.000 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -750 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -750 750 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 501 atoms
  using lattice units in orthogonal box = (-1376.25 -100 -100) to (1376.25 100 100)
  create_atoms CPU = 0.000 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  750 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  750 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  501 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  501 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
750 atoms in group substrate
group slider1 region slider1
501 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 501 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_67_*.dump id type diameter mass xu yu zu fx fy fz

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 1776 130 130
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 74.93 | 74.93 | 74.93 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   2752.5         200            200            0              0              0              0              0              0              0              0              0              6            
    100000   2752.5         200            200            0.0036991104   1.2723405e-43  0              0.011097331    293041.36      0              5.6599674e+10  0              0              3.3263221    
    200000   2752.5         200            200            0.0013114308   9.1711436e-37  0              0.0039342923   71492.982      0              1.3808561e+10  0              0              3.0740724    
    300000   2752.5         200            200            9.3868209e-05 -9.1711189e-37  0              0.00028160463  753.98444      0              1.4562884e+08  0              0              3.0456223    
    400000   2752.5         200            200            0.0015126349  -0.00086700885  0              0.0054049135   4833.9695      0              9.3366036e+08  0              0              2.9973776    
    500000   2752.5         200            200            0.0079587896  -0.0084728829   0              0.032349252    29.275144      0              5654367.8      0              0              2.9930569    
    600000   2752.5         200            200            0.00178061    -0.0043368057   0              0.0096786357   55.606564      0              10740168       0              0              2.9962235    
    700000   2752.5         200            200            0.0022590273  -0.0049846095   0              0.011761692    3.412558       0              659120.84      0              0              2.9958213    
    800000   2752.5         200            200            0.0026253604  -0.0050756376   0              0.012951719    0.54772295     0              105790.32      0              0              2.995611     
    900000   2752.5         200            200            0.0027710342  -0.0050943491   0              0.013407452    0.11350474     0              21922.952      0              0              2.9955338    
   1000000   2752.5         200            200            0.0028200222  -0.0051016567   0              0.013561723    0.021397572    0              4132.8488      0              0              2.9955079    
   1100000   2752.5         200            200            0.002835697   -0.0051038723   0              0.013610963    0.0036642185   0              707.72799      0              0              2.9954996    
   1200000   2752.5         200            200            0.002840399   -0.0051045369   0              0.013625734    0.00058060319  0              112.141        0              0              2.9954971    
   1300000   2752.5         200            200            0.0028416867  -0.0051047207   0              0.013629781    8.6133956e-05  0              16.636402      0              0              2.9954964    
   1400000   2752.5         200            200            0.0028419846  -0.0051047642   0              0.013630718    1.2037104e-05  0              2.3249147      0              0              2.9954962    
   1500000   2752.5         200            200            0.0028420264  -0.005104771    0              0.01363085     1.5879155e-06  0              0.30669902     0              0              2.9954962    
   1600000   2752.5         200            200            0.0028420165  -0.00510477     0              0.01363082     1.9746595e-07  0              0.038139695    0              0              2.9954962    
   1700000   2752.5         200            200            0.0028420037  -0.0051047684   0              0.01363078     2.3028983e-08  0              0.0044479487   0              0              2.9954962    
   1800000   2752.5         200            200            0.0028419958  -0.0051047673   0              0.013630755    2.4928117e-09  0              0.00048147581  0              0              2.9954962    
   1900000   2752.5         200            200            0.0028419917  -0.0051047668   0              0.013630742    2.4576575e-10  0              4.7468594e-05  0              0              2.9954962    
   2000000   2752.5         200            200            0.0028419899  -0.0051047665   0              0.013630736    2.1295659e-11  0              4.1131647e-06  0              0              2.9954962    
   2100000   2752.5         200            200            0.0028419891  -0.0051047664   0              0.013630734    1.5028922e-12  0              2.9027714e-07  0              0              2.9954962    
   2200000   2752.5         200            200            0.0028419888  -0.0051047664   0              0.013630733    7.0162275e-14  0              1.3551541e-08  0              0              2.9954962    
   2300000   2752.5         200            200            0.0028419887  -0.0051047664   0              0.013630732    6.9856577e-16  0              1.3492496e-10  0              0              2.9954962    
   2400000   2752.5         200            200            0.0028419886  -0.0051047664   0              0.013630732    2.6291801e-16  0              5.0781478e-11  0              0              2.9954962    
   2500000   2752.5         200            200            0.0028419886  -0.0051047663   0              0.013630732    2.2353347e-16  0              4.3174525e-11  0              0              2.9954962    
   2600000   2752.5         200            200            0.0028419886  -0.0051047663   0              0.013630732    6.9857781e-17  0              1.3492729e-11  0              0              2.9954962    
   2700000   2752.5         200            200            0.0028419886  -0.0051047663   0              0.013630732    1.2619554e-17  0              2.4374123e-12  0              0              2.9954962    
   2800000   2752.5         200            200            0.0028419886  -0.0051047663   0              0.013630732    2.6465069e-18  0              5.111614e-13   0              0              2.9954962    
   2900000   2752.5         200            200            0.0028419886  -0.0051047663   0              0.013630732    1.3337371e-22  0              2.5760556e-17  0              0              2.9954962    
   3000000   2752.5         200            200            0.0028419886  -0.0051047663   0              0.013630732    1.7979228e-18  0              3.4726103e-13  0              0              2.9954962    
Loop time of 180.311 on 2 procs for 3000000 steps with 1251 atoms

Performance: 14375143.853 ns/day, 0.000 hours/ns, 16637.898 timesteps/s
99.9% CPU use with 2 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 40.361     | 40.522     | 40.682     |   2.5 | 22.47
Neigh   | 3.4397     | 3.4404     | 3.4411     |   0.0 |  1.91
Comm    | 14.624     | 14.647     | 14.671     |   0.6 |  8.12
Output  | 0.22074    | 0.22077    | 0.2208     |   0.0 |  0.12
Modify  | 108.69     | 108.8      | 108.91     |   1.0 | 60.34
Other   |            | 12.68      |            |       |  7.03

Nlocal:          625.5 ave         626 max         625 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Nghost:            2.5 ave           3 max           2 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Neighs:          356.5 ave         357 max         356 min
Histogram: 1 0 0 0 0 0 0 0 0 1

Total # of neighbors = 713
Ave neighs/atom = 0.56994404
Neighbor list builds = 164
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 68

#variable lat0 equal 1                    #
variable lat1 equal 3+(v_ind*0.01)        # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 250*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 3.68                                                               
Lattice spacing in x,y,z = 3.68 3.68 3.68

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -1380 ${n1e1} -100 100 -100 100 units box
region box block -1380 1380 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -1380 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -1380 1380 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-1380 -100 -100) to (1380 100 100)
  2 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 750 atoms
  using lattice units in orthogonal box = (-1380 -100 -100) to (1380 100 100)
  create_atoms CPU = 0.000 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -750 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -750 750 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 501 atoms
  using lattice units in orthogonal box = (-1380 -100 -100) to (1380 100 100)
  create_atoms CPU = 0.000 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  750 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  750 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  501 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  501 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
750 atoms in group substrate
group slider1 region slider1
501 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 501 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_68_*.dump id type diameter mass xu yu zu fx fy fz

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 1781 130 130
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 75.14 | 75.14 | 75.14 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   2760           200            200            0              0              0              0              0              0              0              0              0              6            
    100000   2760           200            200            0.0036894645   3.658516e-36   0              0.011068393    293082.19      0              5.660756e+10   0              0              3.3263666    
    200000   2760           200            200            0.0013086587  -5.7163833e-37  0              0.003925976    71557.14       0              1.3820953e+10  0              0              3.0741111    
    300000   2760           200            200            9.5974733e-05 -3.6584647e-36  0              0.0002879242   790.58092      0              1.5269729e+08  0              0              3.0457102    
    400000   2760           200            200            0.002748161    7.1105437e-05  0              0.0081733776   5040.3093      0              9.73514e+08    0              0              2.9967703    
    500000   2760           200            200            0.010332433   -0.00036713589  0              0.031364435    93.249426      0              18010724       0              0              2.9932483    
    600000   2760           200            200            0.0055182761   0.00047686438  0              0.016077964    93.795253      0              18116148       0              0              2.9952178    
    700000   2760           200            200            0.0051043152   0.00054588811  0              0.014767058    10.944245      0              2113833.8      0              0              2.9954081    
    800000   2760           200            200            0.0049464214   0.00056624435  0              0.01427302     0.65986552     0              127450.18      0              0              2.995482     
    900000   2760           200            200            0.0048241248   0.00058009297  0              0.013892281    0.0038209027   0              737.99087      0              0              2.9955416    
   1000000   2760           200            200            0.0047494167   0.00058573068  0              0.013662519    0.02201293     0              4251.7024      0              0              2.9955788    
   1100000   2760           200            200            0.0047252229   0.00058579204  0              0.013589877    0.0048722392   0              941.05198      0              0              2.9955908    
   1200000   2760           200            200            0.0047228217   0.00058580279  0              0.013582662    0.00027280149  0              52.69043       0              0              2.9955921    
   1300000   2760           200            200            0.0047248296   0.00058579461  0              0.013588694    6.1714744e-07  0              0.11919937     0              0              2.9955911    
   1400000   2760           200            200            0.0047262057   0.00058578915  0              0.013592828    6.98075e-06    0              1.3483017      0              0              2.9955904    
   1500000   2760           200            200            0.0047266545   0.00058578739  0              0.013594176    1.6283859e-06  0              0.31451571     0              0              2.9955902    
   1600000   2760           200            200            0.0047267034   0.00058578719  0              0.013594323    9.6540646e-08  0              0.018646409    0              0              2.9955902    
   1700000   2760           200            200            0.0047266684   0.00058578732  0              0.013594218    9.6092286e-11  0              1.855981e-05   0              0              2.9955902    
   1800000   2760           200            200            0.0047266434   0.00058578742  0              0.013594143    2.2175659e-09  0              0.00042831328  0              0              2.9955902    
   1900000   2760           200            200            0.0047266351   0.00058578745  0              0.013594118    5.4338407e-10  0              0.00010495229  0              0              2.9955902    
   2000000   2760           200            200            0.0047266342   0.00058578746  0              0.013594115    3.4044124e-11  0              6.5754756e-06  0              0              2.9955902    
   2100000   2760           200            200            0.0047266348   0.00058578745  0              0.013594117    9.2344031e-15  0              1.7835851e-09  0              0              2.9955902    
   2200000   2760           200            200            0.0047266352   0.00058578745  0              0.013594118    7.026075e-13   0              1.3570561e-07  0              0              2.9955902    
   2300000   2760           200            200            0.0047266354   0.00058578745  0              0.013594119    1.8114849e-13  0              3.498805e-08   0              0              2.9955902    
   2400000   2760           200            200            0.0047266354   0.00058578745  0              0.013594119    1.2112291e-14  0              2.3394367e-09  0              0              2.9955902    
   2500000   2760           200            200            0.0047266354   0.00058578745  0              0.013594119    9.0194365e-20  0              1.7420652e-14  0              0              2.9955902    
   2600000   2760           200            200            0.0047266354   0.00058578745  0              0.013594119    2.1160179e-16  0              4.0869972e-11  0              0              2.9955902    
   2700000   2760           200            200            0.0047266354   0.00058578745  0              0.013594119    5.7841597e-17  0              1.1171855e-11  0              0              2.9955902    
   2800000   2760           200            200            0.0047266354   0.00058578745  0              0.013594119    4.8710316e-18  0              9.4081874e-13  0              0              2.9955902    
   2900000   2760           200            200            0.0047266354   0.00058578745  0              0.013594119    1.4453758e-18  0              2.791681e-13   0              0              2.9955902    
   3000000   2760           200            200            0.0047266354   0.00058578745  0              0.013594119    2.7057762e-18  0              5.2260899e-13  0              0              2.9955902    
Loop time of 181.23 on 2 procs for 3000000 steps with 1251 atoms

Performance: 14302257.820 ns/day, 0.000 hours/ns, 16553.539 timesteps/s
99.9% CPU use with 2 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 40.864     | 40.998     | 41.133     |   2.1 | 22.62
Neigh   | 3.4557     | 3.4559     | 3.4561     |   0.0 |  1.91
Comm    | 13.849     | 13.941     | 14.033     |   2.5 |  7.69
Output  | 0.21018    | 0.2102     | 0.21022    |   0.0 |  0.12
Modify  | 109.27     | 109.64     | 110.02     |   3.6 | 60.50
Other   |            | 12.98      |            |       |  7.16

Nlocal:          625.5 ave         626 max         625 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Nghost:            2.5 ave           3 max           2 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Neighs:          357.5 ave         358 max         357 min
Histogram: 1 0 0 0 0 0 0 0 0 1

Total # of neighbors = 715
Ave neighs/atom = 0.57154277
Neighbor list builds = 164
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 69

#variable lat0 equal 1                    #
variable lat1 equal 3+(v_ind*0.01)        # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 250*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 3.69                                                               
Lattice spacing in x,y,z = 3.69 3.69 3.69

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -1383.75 ${n1e1} -100 100 -100 100 units box
region box block -1383.75 1383.75 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -1383.75 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -1383.75 1383.75 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-1383.75 -100 -100) to (1383.75 100 100)
  2 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 750 atoms
  using lattice units in orthogonal box = (-1383.75 -100 -100) to (1383.75 100 100)
  create_atoms CPU = 0.000 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -750 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -750 750 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 501 atoms
  using lattice units in orthogonal box = (-1383.75 -100 -100) to (1383.75 100 100)
  create_atoms CPU = 0.000 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  750 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  750 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  501 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  501 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
750 atoms in group substrate
group slider1 region slider1
501 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 501 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_69_*.dump id type diameter mass xu yu zu fx fy fz

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 1786 130 130
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 75.28 | 75.28 | 75.28 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   2767.5         200            200            0              0              0              0              0              0              0              0              0              6            
    100000   2767.5         200            200            0.0036787042  -1.140178e-37   0              0.011036113    292990.28      0              5.6589808e+10  0              0              3.3265266    
    200000   2767.5         200            200            0.001303404   -4.5607133e-37  0              0.0039102119   71410.455      0              1.3792621e+10  0              0              3.0743636    
    300000   2767.5         200            200            9.363495e-05  -1.8242821e-36  0              0.00028090485  758.19442      0              1.4644198e+08  0              0              3.0457003    
    400000   2767.5         200            200            0.0022773021   0.00061861681  0              0.0062132894   4914.6772      0              9.4924868e+08  0              0              2.9971944    
    500000   2767.5         200            200            0.010910066    0.00011655059  0              0.032613648    2.2593476      0              436383.24      0              0              2.9930751    
    600000   2767.5         200            200            0.0047861494   0.0023593641   0              0.011999084    102.61606      0              19819848       0              0              2.9958357    
    700000   2767.5         200            200            0.0054291611   0.0023154434   0              0.01397204     14.4118        0              2783577        0              0              2.9954941    
    800000   2767.5         200            200            0.0055233236   0.0022955993   0              0.014274372    0.4762215      0              91980.127      0              0              2.9954405    
    900000   2767.5         200            200            0.0053757211   0.0022971065   0              0.013830057    0.043657361    0              8432.2309      0              0              2.9955108    
   1000000   2767.5         200            200            0.0052930465   0.0022977069   0              0.013581433    0.034519148    0              6667.2245      0              0              2.9955514    
   1100000   2767.5         200            200            0.0052763259   0.0022978553   0              0.013531123    0.0029116504   0              562.37271      0              0              2.9955599    
   1200000   2767.5         200            200            0.0052800551   0.0022978241   0              0.013542341    1.5473149e-06  0              0.2988572      0              0              2.9955581    
   1300000   2767.5         200            200            0.0052839645   0.0022977902   0              0.013554103    6.14493e-05    0              11.868667      0              0              2.9955562    
   1400000   2767.5         200            200            0.0052851882   0.0022977795   0              0.013557785    1.0853744e-05  0              2.0963538      0              0              2.9955556    
   1500000   2767.5         200            200            0.0052852007   0.0022977793   0              0.013557823    1.5713619e-07  0              0.030350178    0              0              2.9955556    
   1600000   2767.5         200            200            0.0052850409   0.0022977806   0              0.013557342    7.2820347e-08  0              0.014064936    0              0              2.9955557    
   1700000   2767.5         200            200            0.0052849686   0.0022977813   0              0.013557125    2.9834443e-08  0              0.0057623939   0              0              2.9955557    
   1800000   2767.5         200            200            0.0052849583   0.0022977814   0              0.013557093    1.587729e-09   0              0.000306663    0              0              2.9955557    
   1900000   2767.5         200            200            0.0052849635   0.0022977813   0              0.013557109    3.2808764e-11  0              6.3368713e-06  0              0              2.9955557    
   2000000   2767.5         200            200            0.0052849672   0.0022977813   0              0.01355712     6.2592374e-11  0              1.2089447e-05  0              0              2.9955557    
   2100000   2767.5         200            200            0.0052849681   0.0022977813   0              0.013557123    7.399545e-12   0              1.4291902e-06  0              0              2.9955557    
   2200000   2767.5         200            200            0.005284968    0.0022977813   0              0.013557123    1.7784265e-14  0              3.434954e-09   0              0              2.9955557    
   2300000   2767.5         200            200            0.0052849678   0.0022977813   0              0.013557122    9.5446517e-14  0              1.8435083e-08  0              0              2.9955557    
   2400000   2767.5         200            200            0.0052849678   0.0022977813   0              0.013557122    2.3775414e-14  0              4.5921185e-09  0              0              2.9955557    
   2500000   2767.5         200            200            0.0052849678   0.0022977813   0              0.013557122    6.7043012e-16  0              1.2949068e-10  0              0              2.9955557    
   2600000   2767.5         200            200            0.0052849678   0.0022977813   0              0.013557122    8.4937356e-17  0              1.6405284e-11  0              0              2.9955557    
   2700000   2767.5         200            200            0.0052849678   0.0022977813   0              0.013557122    5.3284168e-17  0              1.0291607e-11  0              0              2.9955557    
   2800000   2767.5         200            200            0.0052849678   0.0022977813   0              0.013557122    5.7858514e-18  0              1.1175122e-12  0              0              2.9955557    
   2900000   2767.5         200            200            0.0052849678   0.0022977813   0              0.013557122    1.3213587e-19  0              2.5521473e-14  0              0              2.9955557    
   3000000   2767.5         200            200            0.0052849678   0.0022977813   0              0.013557122    1.7662465e-18  0              3.4114288e-13  0              0              2.9955557    
Loop time of 180.392 on 2 procs for 3000000 steps with 1251 atoms

Performance: 14368669.484 ns/day, 0.000 hours/ns, 16630.404 timesteps/s
99.9% CPU use with 2 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 40.8       | 40.801     | 40.803     |   0.0 | 22.62
Neigh   | 3.4657     | 3.4659     | 3.4661     |   0.0 |  1.92
Comm    | 14.015     | 14.124     | 14.234     |   2.9 |  7.83
Output  | 0.21416    | 0.2142     | 0.21424    |   0.0 |  0.12
Modify  | 109.05     | 109.06     | 109.08     |   0.1 | 60.46
Other   |            | 12.73      |            |       |  7.05

Nlocal:          625.5 ave         626 max         625 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Nghost:            2.5 ave           3 max           2 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Neighs:          357.5 ave         358 max         357 min
Histogram: 1 0 0 0 0 0 0 0 0 1

Total # of neighbors = 715
Ave neighs/atom = 0.57154277
Neighbor list builds = 164
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 70

#variable lat0 equal 1                    #
variable lat1 equal 3+(v_ind*0.01)        # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 250*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 3.7                                                               
Lattice spacing in x,y,z = 3.7 3.7 3.7

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -1387.5 ${n1e1} -100 100 -100 100 units box
region box block -1387.5 1387.5 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -1387.5 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -1387.5 1387.5 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-1387.5 -100 -100) to (1387.5 100 100)
  2 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 750 atoms
  using lattice units in orthogonal box = (-1387.5 -100 -100) to (1387.5 100 100)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -750 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -750 750 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 501 atoms
  using lattice units in orthogonal box = (-1387.5 -100 -100) to (1387.5 100 100)
  create_atoms CPU = 0.000 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  750 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  750 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  501 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  501 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
750 atoms in group substrate
group slider1 region slider1
501 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 501 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_70_*.dump id type diameter mass xu yu zu fx fy fz

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 1791 130 130
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 75.49 | 75.49 | 75.49 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   2775           200            200            0              0              0              0              0              0              0              0              0              6            
    100000   2775           200            200            0.0036690101   9.0967844e-37  0              0.01100703     293026.09      0              5.6596725e+10  0              0              3.3263811    
    200000   2775           200            200            0.0013005626  -3.6387054e-36  0              0.0039016879   71471.782      0              1.3804466e+10  0              0              3.0741487    
    300000   2775           200            200            9.3004089e-05 -3.4112901e-37  0              0.00027901227  752.38533      0              1.4531998e+08  0              0              3.0456449    
    400000   2775           200            200            0.0025121551  -0.00016630656  0              0.007702772    5007.9899      0              9.6727163e+08  0              0              2.9967933    
    500000   2775           200            200            0.010039189   -0.0010994177   0              0.031216985    40.921693      0              7903848.5      0              0              2.993084     
    600000   2775           200            200            0.0035612578  -0.00040181028  0              0.011085584    89.604916      0              17306803       0              0              2.9960061    
    700000   2775           200            200            0.0039646402  -0.00052062871  0              0.012414549    10.78092       0              2082288.1      0              0              2.9957619    
    800000   2775           200            200            0.0042084146  -0.00052732934  0              0.013152573    1.5575655      0              300837.05      0              0              2.9956329    
    900000   2775           200            200            0.0042920481  -0.00052946415  0              0.013405609    0.2265883      0              43764.553      0              0              2.9955892    
   1000000   2775           200            200            0.0043186915  -0.00053013079  0              0.013486205    0.032518568    0              6280.8212      0              0              2.9955753    
   1100000   2775           200            200            0.0043268538  -0.00053033507  0              0.013510896    0.0046022386   0              888.90252      0              0              2.995571     
   1200000   2775           200            200            0.0043292377  -0.00053039533  0              0.013518108    0.00064290443  0              124.17422      0              0              2.9955697    
   1300000   2775           200            200            0.004329883   -0.00053041198  0              0.013520061    8.8699703e-05  0              17.131965      0              0              2.9955694    
   1400000   2775           200            200            0.0043300341  -0.00053041605  0              0.013520518    1.2090277e-05  0              2.3351848      0              0              2.9955693    
   1500000   2775           200            200            0.0043300577  -0.00053041678  0              0.01352059     1.6283395e-06  0              0.31450674     0              0              2.9955693    
   1600000   2775           200            200            0.0043300545  -0.00053041677  0              0.01352058     2.1668878e-07  0              0.041852503    0              0              2.9955693    
   1700000   2775           200            200            0.0043300491  -0.00053041666  0              0.013520564    2.8486152e-08  0              0.0055019773   0              0              2.9955693    
   1800000   2775           200            200            0.0043300455  -0.00053041659  0              0.013520553    3.6982181e-09  0              0.00071429487  0              0              2.9955693    
   1900000   2775           200            200            0.0043300436  -0.00053041654  0              0.013520547    4.7390681e-10  0              9.1533055e-05  0              0              2.9955693    
   2000000   2775           200            200            0.0043300427  -0.00053041652  0              0.013520545    5.9896455e-11  0              1.1568742e-05  0              0              2.9955693    
   2100000   2775           200            200            0.0043300423  -0.00053041651  0              0.013520543    7.4619199e-12  0              1.4412376e-06  0              0              2.9955693    
   2200000   2775           200            200            0.0043300421  -0.00053041651  0              0.013520543    9.1475112e-13  0              1.7668023e-07  0              0              2.9955693    
   2300000   2775           200            200            0.004330042   -0.00053041651  0              0.013520543    1.1002451e-13  0              2.1250759e-08  0              0              2.9955693    
   2400000   2775           200            200            0.004330042   -0.00053041651  0              0.013520542    1.3047358e-14  0              2.5200408e-09  0              0              2.9955693    
   2500000   2775           200            200            0.004330042   -0.00053041651  0              0.013520542    1.4899117e-15  0              2.8777002e-10  0              0              2.9955693    
   2600000   2775           200            200            0.004330042   -0.00053041651  0              0.013520542    1.756415e-16   0              3.3924397e-11  0              0              2.9955693    
   2700000   2775           200            200            0.004330042   -0.00053041651  0              0.013520542    2.8407282e-17  0              5.4867439e-12  0              0              2.9955693    
   2800000   2775           200            200            0.004330042   -0.00053041651  0              0.013520542    2.6099801e-18  0              5.041064e-13   0              0              2.9955693    
   2900000   2775           200            200            0.004330042   -0.00053041651  0              0.013520542    3.2465754e-18  0              6.2706203e-13  0              0              2.9955693    
   3000000   2775           200            200            0.004330042   -0.00053041651  0              0.013520542    1.4703358e-18  0              2.8398901e-13  0              0              2.9955693    
Loop time of 179.833 on 2 procs for 3000000 steps with 1251 atoms

Performance: 14413348.901 ns/day, 0.000 hours/ns, 16682.117 timesteps/s
99.9% CPU use with 2 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 39.873     | 40.017     | 40.161     |   2.3 | 22.25
Neigh   | 3.4966     | 3.4969     | 3.4971     |   0.0 |  1.94
Comm    | 14.672     | 14.721     | 14.77      |   1.3 |  8.19
Output  | 0.20933    | 0.20936    | 0.20939    |   0.0 |  0.12
Modify  | 108.52     | 108.68     | 108.85     |   1.6 | 60.44
Other   |            | 12.7       |            |       |  7.06

Nlocal:          625.5 ave         626 max         625 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Nghost:            2.5 ave           3 max           2 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Neighs:          351.5 ave         352 max         351 min
Histogram: 1 0 0 0 0 0 0 0 0 1

Total # of neighbors = 703
Ave neighs/atom = 0.56195044
Neighbor list builds = 164
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 71

#variable lat0 equal 1                    #
variable lat1 equal 3+(v_ind*0.01)        # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 250*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 3.71                                                               
Lattice spacing in x,y,z = 3.71 3.71 3.71

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -1391.25 ${n1e1} -100 100 -100 100 units box
region box block -1391.25 1391.25 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -1391.25 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -1391.25 1391.25 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-1391.25 -100 -100) to (1391.25 100 100)
  2 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 750 atoms
  using lattice units in orthogonal box = (-1391.25 -100 -100) to (1391.25 100 100)
  create_atoms CPU = 0.000 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -750 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -750 750 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 501 atoms
  using lattice units in orthogonal box = (-1391.25 -100 -100) to (1391.25 100 100)
  create_atoms CPU = 0.000 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  750 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  750 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  501 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  501 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
750 atoms in group substrate
group slider1 region slider1
501 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 501 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_71_*.dump id type diameter mass xu yu zu fx fy fz

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 1796 130 130
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 75.63 | 75.63 | 75.63 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   2782.5         200            200            0              0              0              0              0              0              0              0              0              6            
    100000   2782.5         200            200            0.0036583484  -1.1340317e-37  0              0.010975045    292937.42      0              5.6579599e+10  0              0              3.3264634    
    200000   2782.5         200            200            0.0012953817   7.257811e-36   0              0.003886145    71329.335      0              1.3776953e+10  0              0              3.0743055    
    300000   2782.5         200            200            9.0252079e-05 -2.268062e-37   0              0.00027075624  714.20367      0              1.3794536e+08  0              0              3.0455751    
    400000   2782.5         200            200            0.0011379396   0.00016697392  0              0.003246845    4572.2462      0              8.8310962e+08  0              0              2.9980189    
    500000   2782.5         200            200            0.0084528759  -0.0030406751   0              0.028399303    275.2538       0              53164083       0              0              2.9933951    
    600000   2782.5         200            200            0.0025791925  -0.00034936262  0              0.0080869402   1.0883565      0              210211.36      0              0              2.9964669    
    700000   2782.5         200            200            0.0038685079  -0.00097996865  0              0.012585492    12.14376       0              2345514.8      0              0              2.9955832    
    800000   2782.5         200            200            0.0042811612  -0.00099921258  0              0.013842696    1.5530932      0              299973.24      0              0              2.9953715    
    900000   2782.5         200            200            0.0042559778  -0.00099662383  0              0.013764557    0.016960912    0              3275.9269      0              0              2.9953864    
   1000000   2782.5         200            200            0.0041938966  -0.00099229661  0              0.013573986    0.010385877    0              2005.9872      0              0              2.9954189    
   1100000   2782.5         200            200            0.0041668255  -0.00099045308  0              0.013490929    0.0046902141   0              905.89461      0              0              2.995433     
   1200000   2782.5         200            200            0.0041616347  -0.00099010719  0              0.013475011    0.00042278338  0              81.658786      0              0              2.9954356    
   1300000   2782.5         200            200            0.0041626838  -0.0009901837   0              0.013478235    1.1150674e-06  0              0.21537046     0              0              2.995435     
   1400000   2782.5         200            200            0.004163911   -0.00099026878  0              0.013482002    5.0541384e-06  0              0.97618502     0              0              2.9954344    
   1500000   2782.5         200            200            0.0041643844  -0.00099030109  0              0.013483454    1.6110451e-06  0              0.3111664      0              0              2.9954341    
   1600000   2782.5         200            200            0.0041644559  -0.00099030579  0              0.013483673    1.1050941e-07  0              0.021344416    0              0              2.9954341    
   1700000   2782.5         200            200            0.0041644277  -0.00099030378  0              0.013483587    2.3429613e-11  0              4.5253286e-06  0              0              2.9954341    
   1800000   2782.5         200            200            0.004164404   -0.00099030214  0              0.013483514    2.2396479e-09  0              0.00043257833  0              0              2.9954341    
   1900000   2782.5         200            200            0.0041643959  -0.00099030159  0              0.013483489    5.3186318e-10  0              0.00010272708  0              0              2.9954341    
   2000000   2782.5         200            200            0.004164395   -0.00099030154  0              0.013483487    2.6681469e-11  0              5.1534106e-06  0              0              2.9954341    
   2100000   2782.5         200            200            0.0041643957  -0.00099030158  0              0.013483489    2.7684303e-13  0              5.3471036e-08  0              0              2.9954341    
   2200000   2782.5         200            200            0.0041643962  -0.00099030161  0              0.01348349     9.2411676e-13  0              1.7848916e-07  0              0              2.9954341    
   2300000   2782.5         200            200            0.0041643963  -0.00099030162  0              0.013483491    1.6880054e-13  0              3.2603097e-08  0              0              2.9954341    
   2400000   2782.5         200            200            0.0041643963  -0.00099030162  0              0.013483491    5.7082074e-15  0              1.1025156e-09  0              0              2.9954341    
   2500000   2782.5         200            200            0.0041643963  -0.00099030162  0              0.01348349     3.0486064e-16  0              5.8882517e-11  0              0              2.9954341    
   2600000   2782.5         200            200            0.0041643963  -0.00099030162  0              0.01348349     3.6403926e-16  0              7.0312612e-11  0              0              2.9954341    
   2700000   2782.5         200            200            0.0041643963  -0.00099030162  0              0.01348349     4.6639645e-17  0              9.0082462e-12  0              0              2.9954341    
   2800000   2782.5         200            200            0.0041643963  -0.00099030162  0              0.01348349     5.0611156e-19  0              9.7753263e-14  0              0              2.9954341    
   2900000   2782.5         200            200            0.0041643963  -0.00099030162  0              0.01348349     2.1793536e-18  0              4.2093275e-13  0              0              2.9954341    
   3000000   2782.5         200            200            0.0041643963  -0.00099030162  0              0.01348349     5.4042162e-19  0              1.043801e-13   0              0              2.9954341    
Loop time of 180.22 on 2 procs for 3000000 steps with 1251 atoms

Performance: 14382429.704 ns/day, 0.000 hours/ns, 16646.331 timesteps/s
99.9% CPU use with 2 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 40.561     | 40.636     | 40.712     |   1.2 | 22.55
Neigh   | 3.4878     | 3.4878     | 3.4878     |   0.0 |  1.94
Comm    | 14.043     | 14.052     | 14.061     |   0.2 |  7.80
Output  | 0.21303    | 0.21306    | 0.2131     |   0.0 |  0.12
Modify  | 108.93     | 109.04     | 109.16     |   1.1 | 60.51
Other   |            | 12.79      |            |       |  7.10

Nlocal:          625.5 ave         626 max         625 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Nghost:            2.5 ave           3 max           2 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Neighs:          355.5 ave         356 max         355 min
Histogram: 1 0 0 0 0 0 0 0 0 1

Total # of neighbors = 711
Ave neighs/atom = 0.56834532
Neighbor list builds = 164
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 72

#variable lat0 equal 1                    #
variable lat1 equal 3+(v_ind*0.01)        # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 250*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 3.72                                                               
Lattice spacing in x,y,z = 3.72 3.72 3.72

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -1395 ${n1e1} -100 100 -100 100 units box
region box block -1395 1395 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -1395 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -1395 1395 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-1395 -100 -100) to (1395 100 100)
  2 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 750 atoms
  using lattice units in orthogonal box = (-1395 -100 -100) to (1395 100 100)
  create_atoms CPU = 0.000 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -750 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -750 750 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 501 atoms
  using lattice units in orthogonal box = (-1395 -100 -100) to (1395 100 100)
  create_atoms CPU = 0.000 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  750 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  750 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  501 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  501 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
750 atoms in group substrate
group slider1 region slider1
501 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 501 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_72_*.dump id type diameter mass xu yu zu fx fy fz

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 1800 130 130
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 75.84 | 75.84 | 75.84 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   2790           200            200            0              0              0              0              0              0              0              0              0              6            
    100000   2790           200            200            0.0036489909  -7.2382511e-36  0              0.010946973    292984.39      0              5.658867e+10   0              0              3.3265404    
    200000   2790           200            200            0.0012929316   1.3452385e-41  0              0.0038787948   71414.032      0              1.3793312e+10  0              0              3.074349     
    300000   2790           200            200            9.4369289e-05  6.5031544e-37  0              0.00028310787  781.54309      0              1.5095168e+08  0              0              3.0456501    
    400000   2790           200            200            0.0012209404  -4.5239335e-37  0              0.0036628212   4706.5026      0              9.0904066e+08  0              0              2.9978305    
    500000   2790           200            200            0.011929708    0.0051349148   0              0.030654208    159.35107      0              30777972       0              0              2.9933471    
    600000   2790           200            200            0.0028447041   0.00094553967  0              0.0075885728   1.9172247      0              370303.68      0              0              2.9965721    
    700000   2790           200            200            0.0046412357   0.0019149784   0              0.012008729    9.2841752      0              1793198.4      0              0              2.9957989    
    800000   2790           200            200            0.0050857162   0.0019695833   0              0.013287565    1.989155       0              384196.71      0              0              2.9956016    
    900000   2790           200            200            0.0051690505   0.0019783682   0              0.013528783    0.25801502     0              49834.488      0              0              2.995566     
   1000000   2790           200            200            0.0051667915   0.0019779996   0              0.013522375    0.021452279    0              4143.4152      0              0              2.9955675    
   1100000   2790           200            200            0.0051543278   0.0019766167   0              0.013486367    0.0008277981   0              159.88563      0              0              2.9955732    
   1200000   2790           200            200            0.0051463829   0.0019757467   0              0.013463402    4.1525237e-07  0              0.080204204    0              0              2.9955767    
   1300000   2790           200            200            0.0051427878   0.0019753554   0              0.013453008    1.859375e-05   0              3.5913026      0              0              2.9955783    
   1400000   2790           200            200            0.005141471    0.0019752128   0              0.0134492      7.7237846e-06  0              1.4918157      0              0              2.9955789    
   1500000   2790           200            200            0.0051410811   0.001975171    0              0.013448072    1.6004671e-06  0              0.30912331     0              0              2.9955791    
   1600000   2790           200            200            0.0051409998   0.0019751624   0              0.013447837    2.1683198e-07  0              0.041880162    0              0              2.9955791    
   1700000   2790           200            200            0.0051409983   0.0019751624   0              0.013447833    1.9236918e-08  0              0.0037155277   0              0              2.9955791    
   1800000   2790           200            200            0.0051410084   0.0019751635   0              0.013447862    8.5940024e-10  0              0.00016598945  0              0              2.9955791    
   1900000   2790           200            200            0.0051410152   0.0019751643   0              0.013447881    5.7447896e-13  0              1.1095813e-07  0              0              2.9955791    
   2000000   2790           200            200            0.0051410184   0.0019751646   0              0.013447891    1.1931923e-11  0              2.3045995e-06  0              0              2.9955791    
   2100000   2790           200            200            0.0051410196   0.0019751648   0              0.013447894    5.7529919e-12  0              1.1111656e-06  0              0              2.9955791    
   2200000   2790           200            200            0.00514102     0.0019751648   0              0.013447895    1.2721805e-12  0              2.4571617e-07  0              0              2.9955791    
   2300000   2790           200            200            0.0051410201   0.0019751648   0              0.013447895    1.8139231e-13  0              3.5035143e-08  0              0              2.9955791    
   2400000   2790           200            200            0.0051410201   0.0019751648   0              0.013447895    1.700017e-14   0              3.2835094e-09  0              0              2.9955791    
   2500000   2790           200            200            0.0051410201   0.0019751648   0              0.013447895    7.9900027e-16  0              1.5432345e-10  0              0              2.9955791    
   2600000   2790           200            200            0.0051410201   0.0019751648   0              0.013447895    2.6883584e-18  0              5.1924483e-13  0              0              2.9955791    
   2700000   2790           200            200            0.0051410201   0.0019751648   0              0.013447895    1.537344e-17   0              2.9693136e-12  0              0              2.9955791    
   2800000   2790           200            200            0.0051410201   0.0019751648   0              0.013447895    5.2721472e-18  0              1.0182925e-12  0              0              2.9955791    
   2900000   2790           200            200            0.0051410201   0.0019751648   0              0.013447895    2.2099101e-18  0              4.268346e-13   0              0              2.9955791    
   3000000   2790           200            200            0.0051410201   0.0019751648   0              0.013447895    3.1374876e-18  0              6.0599219e-13  0              0              2.9955791    
Loop time of 179.712 on 2 procs for 3000000 steps with 1251 atoms

Performance: 14423102.971 ns/day, 0.000 hours/ns, 16693.406 timesteps/s
99.9% CPU use with 2 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 40.437     | 40.492     | 40.546     |   0.9 | 22.53
Neigh   | 3.4697     | 3.4706     | 3.4715     |   0.0 |  1.93
Comm    | 14.07      | 14.169     | 14.268     |   2.6 |  7.88
Output  | 0.21472    | 0.21475    | 0.21478    |   0.0 |  0.12
Modify  | 108.58     | 108.64     | 108.7      |   0.6 | 60.45
Other   |            | 12.73      |            |       |  7.08

Nlocal:          625.5 ave         626 max         625 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Nghost:            2.5 ave           3 max           2 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Neighs:          355.5 ave         356 max         355 min
Histogram: 1 0 0 0 0 0 0 0 0 1

Total # of neighbors = 711
Ave neighs/atom = 0.56834532
Neighbor list builds = 164
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 73

#variable lat0 equal 1                    #
variable lat1 equal 3+(v_ind*0.01)        # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 250*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 3.73                                                               
Lattice spacing in x,y,z = 3.73 3.73 3.73

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -1398.75 ${n1e1} -100 100 -100 100 units box
region box block -1398.75 1398.75 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -1398.75 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -1398.75 1398.75 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-1398.75 -100 -100) to (1398.75 100 100)
  2 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 750 atoms
  using lattice units in orthogonal box = (-1398.75 -100 -100) to (1398.75 100 100)
  create_atoms CPU = 0.000 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -750 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -750 750 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 501 atoms
  using lattice units in orthogonal box = (-1398.75 -100 -100) to (1398.75 100 100)
  create_atoms CPU = 0.000 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  750 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  750 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  501 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  501 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
750 atoms in group substrate
group slider1 region slider1
501 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 501 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_73_*.dump id type diameter mass xu yu zu fx fy fz

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 1805 130 130
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 75.97 | 75.97 | 75.97 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   2797.5         200            200            0              0              0              0              0              0              0              0              0              6            
    100000   2797.5         200            200            0.0036395171   7.2188932e-36  0              0.010918551    293018.69      0              5.6595295e+10  0              0              3.3265295    
    200000   2797.5         200            200            0.0012906818  -2.2559024e-37  0              0.0038720453   71519.371      0              1.3813658e+10  0              0              3.0741778    
    300000   2797.5         200            200            9.5740488e-05  4.5118119e-37  0              0.00028722147  807.42061      0              1.5594981e+08  0              0              3.045635     
    400000   2797.5         200            200            0.0027785322  -0.00032353027  0              0.0086591268   5066.1971      0              9.7851412e+08  0              0              2.9965739    
    500000   2797.5         200            200            0.0092899358  -0.0035477362   0              0.031417544    63.094971      0              12186521       0              0              2.9931487    
    600000   2797.5         200            200            0.0047757579  -0.001679951    0              0.016007225    91.837369      0              17737991       0              0              2.9951478    
    700000   2797.5         200            200            0.0046482254  -0.0014997339   0              0.01544441     2.6874388      0              519067.2       0              0              2.995223     
    800000   2797.5         200            200            0.0042591948  -0.0013338297   0              0.014111414    0.4966504      0              95925.882      0              0              2.9954309    
    900000   2797.5         200            200            0.0040366725  -0.001304602    0              0.01341462     0.27001068     0              52151.399      0              0              2.9955451    
   1000000   2797.5         200            200            0.0040060207  -0.0013005947   0              0.013318657    0.009913853    0              1914.8179      0              0              2.9955616    
   1100000   2797.5         200            200            0.0040247285  -0.00130257     0              0.013376755    0.0011126776   0              214.90888      0              0              2.9955522    
   1200000   2797.5         200            200            0.0040358711  -0.0013037565   0              0.01341137     0.00066450139  0              128.34558      0              0              2.9955465    
   1300000   2797.5         200            200            0.0040374553  -0.0013039307   0              0.013416297    2.5044084e-05  0              4.8371567      0              0              2.9955456    
   1400000   2797.5         200            200            0.0040365336  -0.0013038358   0              0.013413437    2.674014e-06   0              0.51647427     0              0              2.9955461    
   1500000   2797.5         200            200            0.0040359797  -0.0013037773   0              0.013411717    1.6361759e-06  0              0.31602031     0              0              2.9955464    
   1600000   2797.5         200            200            0.0040358999  -0.0013037685   0              0.013411468    6.304195e-08   0              0.012176281    0              0              2.9955464    
   1700000   2797.5         200            200            0.0040359452  -0.0013037732   0              0.013411609    6.4188157e-09  0              0.0012397666   0              0              2.9955464    
   1800000   2797.5         200            200            0.0040359727  -0.0013037761   0              0.013411694    4.0282687e-09  0              0.00077804272  0              0              2.9955464    
   1900000   2797.5         200            200            0.0040359768  -0.0013037765   0              0.013411707    1.5867007e-10  0              3.064644e-05   0              0              2.9955464    
   2000000   2797.5         200            200            0.0040359745  -0.0013037763   0              0.0134117      1.540182e-11   0              2.9747951e-06  0              0              2.9955464    
   2100000   2797.5         200            200            0.0040359732  -0.0013037761   0              0.013411696    9.9156543e-12  0              1.9151658e-06  0              0              2.9955464    
   2200000   2797.5         200            200            0.004035973   -0.0013037761   0              0.013411695    3.9880992e-13  0              7.7028415e-08  0              0              2.9955464    
   2300000   2797.5         200            200            0.0040359731  -0.0013037761   0              0.013411695    3.6723728e-14  0              7.0930297e-09  0              0              2.9955464    
   2400000   2797.5         200            200            0.0040359731  -0.0013037761   0              0.013411696    2.4387524e-14  0              4.7103451e-09  0              0              2.9955464    
   2500000   2797.5         200            200            0.0040359731  -0.0013037761   0              0.013411696    9.5514104e-16  0              1.8448137e-10  0              0              2.9955464    
   2600000   2797.5         200            200            0.0040359731  -0.0013037761   0              0.013411696    8.8300245e-17  0              1.7054811e-11  0              0              2.9955464    
   2700000   2797.5         200            200            0.0040359731  -0.0013037761   0              0.013411696    5.7040036e-17  0              1.1017037e-11  0              0              2.9955464    
   2800000   2797.5         200            200            0.0040359731  -0.0013037761   0              0.013411696    2.9862402e-18  0              5.7677941e-13  0              0              2.9955464    
   2900000   2797.5         200            200            0.0040359731  -0.0013037761   0              0.013411696    1.4663467e-19  0              2.8321854e-14  0              0              2.9955464    
   3000000   2797.5         200            200            0.0040359731  -0.0013037761   0              0.013411696    1.1639692e-18  0              2.2481562e-13  0              0              2.9955464    
Loop time of 179.648 on 2 procs for 3000000 steps with 1251 atoms

Performance: 14428192.399 ns/day, 0.000 hours/ns, 16699.297 timesteps/s
99.9% CPU use with 2 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 40.542     | 40.562     | 40.582     |   0.3 | 22.58
Neigh   | 3.5062     | 3.5065     | 3.5068     |   0.0 |  1.95
Comm    | 14.053     | 14.147     | 14.24      |   2.5 |  7.87
Output  | 0.21131    | 0.21133    | 0.21135    |   0.0 |  0.12
Modify  | 108.43     | 108.47     | 108.52     |   0.4 | 60.38
Other   |            | 12.75      |            |       |  7.10

Nlocal:          625.5 ave         626 max         625 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Nghost:            2.5 ave           3 max           2 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Neighs:          356.5 ave         357 max         356 min
Histogram: 1 0 0 0 0 0 0 0 0 1

Total # of neighbors = 713
Ave neighs/atom = 0.56994404
Neighbor list builds = 164
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 74

#variable lat0 equal 1                    #
variable lat1 equal 3+(v_ind*0.01)        # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 250*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 3.74                                                               
Lattice spacing in x,y,z = 3.74 3.74 3.74

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -1402.5 ${n1e1} -100 100 -100 100 units box
region box block -1402.5 1402.5 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -1402.5 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -1402.5 1402.5 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-1402.5 -100 -100) to (1402.5 100 100)
  2 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 750 atoms
  using lattice units in orthogonal box = (-1402.5 -100 -100) to (1402.5 100 100)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -750 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -750 750 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 501 atoms
  using lattice units in orthogonal box = (-1402.5 -100 -100) to (1402.5 100 100)
  create_atoms CPU = 0.000 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  750 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  750 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  501 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  501 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
750 atoms in group substrate
group slider1 region slider1
501 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 501 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_74_*.dump id type diameter mass xu yu zu fx fy fz

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 1810 130 130
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 76.11 | 76.11 | 76.11 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   2805           200            200            0              0              0              0              0              0              0              0              0              6            
    100000   2805           200            200            0.003628596   -5.3996859e-36  0              0.010885788    292903.45      0              5.6573037e+10  0              0              3.3262943    
    200000   2805           200            200            0.001283791    8.4583088e-42  0              0.0038513731   71231.047      0              1.3757969e+10  0              0              3.0742259    
    300000   2805           200            200            8.4641757e-05  8.9994894e-37  0              0.00025392527  641.65075      0              1.2393207e+08  0              0              3.0454725    
    400000   2805           200            200            0.00035663759 -3.1246623e-06  0              0.0010730374   3985.9149      0              7.6986227e+08  0              0              2.999188     
    500000   2805           200            200            0.003906805   -0.0016211095   0              0.013341525    797.45365      0              1.5402473e+08  0              0              2.9953732    
    600000   2805           200            200            0.0047163242  -0.0030637557   0              0.017212728    62.932257      0              12155094       0              0              2.9946786    
    700000   2805           200            200            0.0037947754  -0.0021941235   0              0.01357845     14.421554      0              2785460.9      0              0              2.9952892    
    800000   2805           200            200            0.003476376   -0.0021786299   0              0.012607758    0.0045401559   0              876.91152      0              0              2.9954531    
    900000   2805           200            200            0.0037244453  -0.0022370685   0              0.013410404    0.25867786     0              49962.512      0              0              2.9953111    
   1000000   2805           200            200            0.003745867   -0.0022396845   0              0.013477286    0.0016252757   0              313.91499      0              0              2.9953005    
   1100000   2805           200            200            0.0037097472  -0.0022348192   0              0.013364061    0.0044060994   0              851.01908      0              0              2.9953201    
   1200000   2805           200            200            0.0037089514  -0.0022347436   0              0.013361598    8.4065868e-05  0              16.23696       0              0              2.9953204    
   1300000   2805           200            200            0.0037138646  -0.0022354155   0              0.013377009    7.1436461e-05  0              13.797644      0              0              2.9953177    
   1400000   2805           200            200            0.0037136969  -0.0022353881   0              0.013376479    2.9349759e-06  0              0.56687792     0              0              2.9953179    
   1500000   2805           200            200            0.0037130426  -0.0022352991   0              0.013374427    1.092795e-06   0              0.21106864     0              0              2.9953182    
   1600000   2805           200            200            0.003713102   -0.0022353078   0              0.013374614    8.4146753e-08  0              0.016252582    0              0              2.9953182    
   1700000   2805           200            200            0.003713187   -0.0022353193   0              0.01337488     1.5602232e-08  0              0.0030135038   0              0              2.9953181    
   1800000   2805           200            200            0.0037131742  -0.0022353175   0              0.01337484     2.1338481e-09  0              0.00041214354  0              0              2.9953181    
   1900000   2805           200            200            0.0037131634  -0.002235316    0              0.013374806    2.0384877e-10  0              3.9372509e-05  0              0              2.9953181    
   2000000   2805           200            200            0.0037131658  -0.0022353163   0              0.013374814    4.9572499e-11  0              9.5747142e-06  0              0              2.9953181    
   2100000   2805           200            200            0.0037131671  -0.0022353165   0              0.013374818    2.3502076e-12  0              4.5393245e-07  0              0              2.9953181    
   2200000   2805           200            200            0.0037131667  -0.0022353165   0              0.013374817    1.0753744e-12  0              2.0770392e-07  0              0              2.9953181    
   2300000   2805           200            200            0.0037131665  -0.0022353164   0              0.013374816    2.2043992e-14  0              4.257702e-09   0              0              2.9953181    
   2400000   2805           200            200            0.0037131666  -0.0022353165   0              0.013374816    2.2067664e-14  0              4.262274e-09   0              0              2.9953181    
   2500000   2805           200            200            0.0037131666  -0.0022353165   0              0.013374816    1.4668827e-16  0              2.8332206e-11  0              0              2.9953181    
   2600000   2805           200            200            0.0037131666  -0.0022353165   0              0.013374816    4.2937075e-16  0              8.2931107e-11  0              0              2.9953181    
   2700000   2805           200            200            0.0037131666  -0.0022353165   0              0.013374816    4.6072439e-19  0              8.8986927e-14  0              0              2.9953181    
   2800000   2805           200            200            0.0037131666  -0.0022353165   0              0.013374816    7.1935616e-18  0              1.3894054e-12  0              0              2.9953181    
   2900000   2805           200            200            0.0037131666  -0.0022353165   0              0.013374816    1.1526721e-18  0              2.2263363e-13  0              0              2.9953181    
   3000000   2805           200            200            0.0037131666  -0.0022353165   0              0.013374816    1.2244458e-18  0              2.3649641e-13  0              0              2.9953181    
Loop time of 180.407 on 2 procs for 3000000 steps with 1251 atoms

Performance: 14367531.183 ns/day, 0.000 hours/ns, 16629.087 timesteps/s
99.9% CPU use with 2 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 40.255     | 40.435     | 40.615     |   2.8 | 22.41
Neigh   | 3.4804     | 3.4804     | 3.4804     |   0.0 |  1.93
Comm    | 14.722     | 14.743     | 14.764     |   0.5 |  8.17
Output  | 0.21412    | 0.21414    | 0.21416    |   0.0 |  0.12
Modify  | 108.79     | 108.8      | 108.81     |   0.1 | 60.31
Other   |            | 12.74      |            |       |  7.06

Nlocal:          625.5 ave         626 max         625 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Nghost:            2.5 ave           3 max           2 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Neighs:          355.5 ave         356 max         355 min
Histogram: 1 0 0 0 0 0 0 0 0 1

Total # of neighbors = 711
Ave neighs/atom = 0.56834532
Neighbor list builds = 164
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 75

#variable lat0 equal 1                    #
variable lat1 equal 3+(v_ind*0.01)        # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 250*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 3.75                                                               
Lattice spacing in x,y,z = 3.75 3.75 3.75

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -1406.25 ${n1e1} -100 100 -100 100 units box
region box block -1406.25 1406.25 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -1406.25 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -1406.25 1406.25 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-1406.25 -100 -100) to (1406.25 100 100)
  2 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 750 atoms
  using lattice units in orthogonal box = (-1406.25 -100 -100) to (1406.25 100 100)
  create_atoms CPU = 0.000 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -750 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -750 750 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 501 atoms
  using lattice units in orthogonal box = (-1406.25 -100 -100) to (1406.25 100 100)
  create_atoms CPU = 0.000 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  750 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  750 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  501 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  501 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
750 atoms in group substrate
group slider1 region slider1
501 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 501 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_75_*.dump id type diameter mass xu yu zu fx fy fz

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 1815 130 130
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 76.32 | 76.32 | 76.32 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   2812.5         200            200            0              0              0              0              0              0              0              0              0              6            
    100000   2812.5         200            200            0.0036324182  -4.4877416e-37  0              0.010897255    294271.87      0              5.6837341e+10  0              0              3.3280478    
    200000   2812.5         200            200            0.0013085749   3.6542747e-45  0              0.0039257247   73580.728      0              1.42118e+10    0              0              3.0750753    
    300000   2812.5         200            200            0.00016028636  1.0625316e-42  0              0.00048085907  2144.9755      0              4.1429277e+08  0              0              3.0477357    
    400000   2812.5         200            200           -0.0001715716  -1.7950953e-36  0             -0.00051471481  3818.3243      0              7.3749286e+08  0              0              3.0027538    
    500000   2812.5         200            200            0.00071469985 -5.3291937e-37  0              0.0021440995   790.92073      0              1.5276293e+08  0              0              2.9994186    
    600000   2812.5         200            200            0.0075212878   1.009742e-36   0              0.022563863    25.609453      0              4946355.2      0              0              2.9974091    
    700000   2812.5         200            200            0.0039290149   3.3658067e-37  0              0.011787045    16.382928      0              3164291.9      0              0              2.9983211    
    800000   2812.5         200            200            0.0040300482  -2.2438709e-37  0              0.012090145    0.015096752    0              2915.8724      0              0              2.9982888    
    900000   2812.5         200            200            0.0043514822   2.243871e-37   0              0.013054446    0.2283609      0              44106.922      0              0              2.9981984    
   1000000   2812.5         200            200            0.0044660035   2.1036291e-38  0              0.013398011    0.047212329    0              9118.8576      0              0              2.9981672    
   1100000   2812.5         200            200            0.0044705094  -8.4145163e-38  0              0.013411528    0.00075543388  0              145.90879      0              0              2.9981661    
   1200000   2812.5         200            200            0.0044569706   2.8048388e-38  0              0.013370912    0.00031077858  0              60.025542      0              0              2.9981698    
   1300000   2812.5         200            200            0.0044506332  -2.8048388e-38  0              0.0133519      0.00012505927  0              24.154658      0              0              2.9981716    
   1400000   2812.5         200            200            0.0044497689   8.4145163e-38  0              0.013349307    5.6110288e-06  0              1.083746       0              0              2.9981718    
   1500000   2812.5         200            200            0.0044502564   2.264465e-47   0              0.013350769    2.5261256e-07  0              0.048791027    0              0              2.9981717    
   1600000   2812.5         200            200            0.0044505799  -4.2072582e-38  0              0.01335174     2.8372001e-07  0              0.054799295    0              0              2.9981716    
   1700000   2812.5         200            200            0.0044506514   2.8048388e-38  0              0.013351954    2.5045299e-08  0              0.0048373915   0              0              2.9981716    
   1800000   2812.5         200            200            0.0044506381   4.186144e-50   0              0.013351914    2.174494e-11   0              4.1999412e-06  0              0              2.9981716    
   1900000   2812.5         200            200            0.0044506228  -1.4024194e-37  0              0.013351868    5.4367129e-10  0              0.00010500776  0              0              2.9981716    
   2000000   2812.5         200            200            0.0044506181  -1.4024194e-37  0              0.013351854    8.5847255e-11  0              1.6581027e-05  0              0              2.9981716    
   2100000   2812.5         200            200            0.0044506182   1.1219355e-37  0              0.013351855    6.2126261e-13  0              1.1999419e-07  0              0              2.9981716    
   2200000   2812.5         200            200            0.0044506189   5.6096775e-38  0              0.013351857    8.3738353e-13  0              1.6173701e-07  0              0              2.9981716    
   2300000   2812.5         200            200            0.0044506191  -1.4024194e-38  0              0.013351857    2.4450688e-13  0              4.7225448e-08  0              0              2.9981716    
   2400000   2812.5         200            200            0.0044506192  -7.0120969e-38  0              0.013351858    7.4487677e-15  0              1.4386973e-09  0              0              2.9981716    
   2500000   2812.5         200            200            0.0044506191  -1.4024194e-37  0              0.013351857    9.3007995e-16  0              1.7964093e-10  0              0              2.9981716    
   2600000   2812.5         200            200            0.0044506191  -1.1219355e-37  0              0.013351857    5.977447e-16   0              1.1545181e-10  0              0              2.9981716    
   2700000   2812.5         200            200            0.0044506191  -1.4024194e-38  0              0.013351857    2.1653892e-17  0              4.1823557e-12  0              0              2.9981716    
   2800000   2812.5         200            200            0.0044506191  -5.6096775e-38  0              0.013351857    7.5864099e-18  0              1.4652823e-12  0              0              2.9981716    
   2900000   2812.5         200            200            0.0044506191  -5.0487098e-37  0              0.013351857    3.8447693e-18  0              7.4260061e-13  0              0              2.9981716    
   3000000   2812.5         200            200            0.0044506191   1.1219358e-37  0              0.013351857    1.4590451e-20  0              2.8180827e-15  0              0              2.9981716    
Loop time of 185.215 on 2 procs for 3000000 steps with 1251 atoms

Performance: 13994535.469 ns/day, 0.000 hours/ns, 16197.379 timesteps/s
99.9% CPU use with 2 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 45.375     | 45.471     | 45.566     |   1.4 | 24.55
Neigh   | 3.6381     | 3.6381     | 3.6381     |   0.0 |  1.96
Comm    | 14.37      | 14.409     | 14.447     |   1.0 |  7.78
Output  | 0.21183    | 0.21185    | 0.21188    |   0.0 |  0.11
Modify  | 108.68     | 108.74     | 108.79     |   0.5 | 58.71
Other   |            | 12.75      |            |       |  6.88

Nlocal:          625.5 ave         626 max         625 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Nghost:            2.5 ave           3 max           2 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Neighs:          400.5 ave         401 max         400 min
Histogram: 1 0 0 0 0 0 0 0 0 1

Total # of neighbors = 801
Ave neighs/atom = 0.64028777
Neighbor list builds = 168
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 76

#variable lat0 equal 1                    #
variable lat1 equal 3+(v_ind*0.01)        # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 250*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 3.76                                                               
Lattice spacing in x,y,z = 3.76 3.76 3.76

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -1410 ${n1e1} -100 100 -100 100 units box
region box block -1410 1410 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -1410 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -1410 1410 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-1410 -100 -100) to (1410 100 100)
  2 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 750 atoms
  using lattice units in orthogonal box = (-1410 -100 -100) to (1410 100 100)
  create_atoms CPU = 0.000 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -750 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -750 750 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 501 atoms
  using lattice units in orthogonal box = (-1410 -100 -100) to (1410 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  750 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  750 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  501 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  501 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
750 atoms in group substrate
group slider1 region slider1
501 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 501 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_76_*.dump id type diameter mass xu yu zu fx fy fz

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 1820 130 130
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 76.46 | 76.46 | 76.46 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   2820           200            200            0              0              0              0              0              0              0              0              0              6            
    100000   2820           200            200            0.0036088525   4.4758077e-37  0              0.010826557    292848.42      0              5.6562408e+10  0              0              3.3263991    
    200000   2820           200            200            0.0012757166  -7.1612556e-36  0              0.0038271498   71121.362      0              1.3736784e+10  0              0              3.0744483    
    300000   2820           200            200            8.230199e-05  -4.4758057e-37  0              0.00024690597  614.37428      0              1.1866374e+08  0              0              3.0455128    
    400000   2820           200            200            0.0003146332   2.2731818e-06  0              0.00094162643  3919.3479      0              7.5700513e+08  0              0              2.999328     
    500000   2820           200            200            0.0048066517   0.0015346627   0              0.012885292    796.84855      0              1.5390786e+08  0              0              2.9954353    
    600000   2820           200            200            0.0067459252   0.0031376563   0              0.017100119    64.385215      0              12435726       0              0              2.9946854    
    700000   2820           200            200            0.0054740918   0.0022818008   0              0.014140475    12.463617      0              2407293.8      0              0              2.9951758    
    800000   2820           200            200            0.0049692926   0.0021560998   0              0.012751778    0.9380841      0              181186.9       0              0              2.9954107    
    900000   2820           200            200            0.0050803197   0.0022048938   0              0.013036065    0.030455157    0              5882.2822      0              0              2.9953588    
   1000000   2820           200            200            0.0051691122   0.0022171262   0              0.01329021     0.035145642    0              6788.229       0              0              2.9953146    
   1100000   2820           200            200            0.0051848632   0.0022191084   0              0.013335481    0.0014806424   0              285.97968      0              0              2.995307     
   1200000   2820           200            200            0.0051780732   0.00221821     0              0.01331601     0.0001576734   0              30.453937      0              0              2.9953105    
   1300000   2820           200            200            0.005173699    0.0022176427   0              0.013303454    8.7677354e-05  0              16.934503      0              0              2.9953126    
   1400000   2820           200            200            0.0051731638   0.0022175762   0              0.013301915    1.9982921e-06  0              0.38596149     0              0              2.9953129    
   1500000   2820           200            200            0.0051735768   0.002217631    0              0.013303099    6.3245431e-07  0              0.12215582     0              0              2.9953127    
   1600000   2820           200            200            0.0051737863   0.0022176582   0              0.013303701    2.0704044e-07  0              0.039988967    0              0              2.9953126    
   1700000   2820           200            200            0.0051738      0.0022176598   0              0.01330374     1.9079965e-09  0              0.0003685213   0              0              2.9953126    
   1800000   2820           200            200            0.0051737763   0.0022176566   0              0.013303672    2.2045133e-09  0              0.00042579223  0              0              2.9953126    
   1900000   2820           200            200            0.0051737666   0.0022176554   0              0.013303644    4.6184428e-10  0              8.920323e-05   0              0              2.9953126    
   2000000   2820           200            200            0.0051737666   0.0022176554   0              0.013303644    6.3085153e-13  0              1.2184625e-07  0              0              2.9953126    
   2100000   2820           200            200            0.0051737679   0.0022176556   0              0.013303648    6.9629562e-12  0              1.3448649e-06  0              0              2.9953126    
   2200000   2820           200            200            0.0051737683   0.0022176556   0              0.013303649    9.6704164e-13  0              1.8677992e-07  0              0              2.9953126    
   2300000   2820           200            200            0.0051737683   0.0022176556   0              0.013303649    8.7145585e-16  0              1.6831794e-10  0              0              2.9953126    
   2400000   2820           200            200            0.0051737682   0.0022176556   0              0.013303649    2.0323264e-14  0              3.9253507e-09  0              0              2.9953126    
   2500000   2820           200            200            0.0051737682   0.0022176556   0              0.013303649    1.8981504e-15  0              3.6661957e-10  0              0              2.9953126    
   2600000   2820           200            200            0.0051737682   0.0022176556   0              0.013303649    2.8692769e-17  0              5.5418845e-12  0              0              2.9953126    
   2700000   2820           200            200            0.0051737682   0.0022176556   0              0.013303649    5.7137972e-17  0              1.1035953e-11  0              0              2.9953126    
   2800000   2820           200            200            0.0051737682   0.0022176556   0              0.013303649    2.0709235e-18  0              3.9998993e-13  0              0              2.9953126    
   2900000   2820           200            200            0.0051737682   0.0022176556   0              0.013303649    3.8971422e-18  0              7.5271619e-13  0              0              2.9953126    
   3000000   2820           200            200            0.0051737682   0.0022176556   0              0.013303649    2.0722073e-21  0              4.0023789e-16  0              0              2.9953126    
Loop time of 180.67 on 2 procs for 3000000 steps with 1251 atoms

Performance: 14346619.114 ns/day, 0.000 hours/ns, 16604.883 timesteps/s
100.0% CPU use with 2 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 40.296     | 40.444     | 40.593     |   2.3 | 22.39
Neigh   | 3.5428     | 3.5432     | 3.5436     |   0.0 |  1.96
Comm    | 14.783     | 14.824     | 14.865     |   1.1 |  8.20
Output  | 0.21043    | 0.21046    | 0.21049    |   0.0 |  0.12
Modify  | 108.75     | 108.92     | 109.1      |   1.7 | 60.29
Other   |            | 12.72      |            |       |  7.04

Nlocal:          625.5 ave         626 max         625 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Nghost:            2.5 ave           3 max           2 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Neighs:          353.5 ave         354 max         353 min
Histogram: 1 0 0 0 0 0 0 0 0 1

Total # of neighbors = 707
Ave neighs/atom = 0.56514788
Neighbor list builds = 164
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 77

#variable lat0 equal 1                    #
variable lat1 equal 3+(v_ind*0.01)        # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 250*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 3.77                                                               
Lattice spacing in x,y,z = 3.77 3.77 3.77

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -1413.75 ${n1e1} -100 100 -100 100 units box
region box block -1413.75 1413.75 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -1413.75 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -1413.75 1413.75 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-1413.75 -100 -100) to (1413.75 100 100)
  2 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 750 atoms
  using lattice units in orthogonal box = (-1413.75 -100 -100) to (1413.75 100 100)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -750 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -750 750 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 501 atoms
  using lattice units in orthogonal box = (-1413.75 -100 -100) to (1413.75 100 100)
  create_atoms CPU = 0.000 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  750 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  750 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  501 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  501 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
750 atoms in group substrate
group slider1 region slider1
501 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 501 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_77_*.dump id type diameter mass xu yu zu fx fy fz

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 1825 130 130
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 76.67 | 76.67 | 76.67 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   2827.5         200            200            0              0              0              0              0              0              0              0              0              6            
    100000   2827.5         200            200            0.0036005321   8.9278743e-37  0              0.010801596    292971.6       0              5.65862e+10    0              0              3.3266338    
    200000   2827.5         200            200            0.0012760273   1.8766556e-45  0              0.0038280819   71434.153      0              1.3797198e+10  0              0              3.0743645    
    300000   2827.5         200            200            9.3886044e-05 -2.7899589e-38  0              0.00028165813  793.8607       0              1.5333077e+08  0              0              3.0456589    
    400000   2827.5         200            200            0.0028564085   0.0003483222   0              0.0082209034   5049.1332      0              9.7521828e+08  0              0              2.9966553    
    500000   2827.5         200            200            0.011647688    0.0040637692   0              0.030879294    84.325449      0              16287097       0              0              2.9931792    
    600000   2827.5         200            200            0.0056574465   0.0020323296   0              0.01494001     102.5629       0              19809581       0              0              2.9952777    
    700000   2827.5         200            200            0.0054300905   0.0017192239   0              0.014571048    9.712595       0              1875945.8      0              0              2.9953262    
    800000   2827.5         200            200            0.0052145725   0.0016205112   0              0.014023206    0.23049857     0              44519.804      0              0              2.9954113    
    900000   2827.5         200            200            0.0050459187   0.0015925459   0              0.01354521     0.027620652    0              5334.8097      0              0              2.9954893    
   1000000   2827.5         200            200            0.0049692911   0.0015819693   0              0.013325904    0.025930958    0              5008.4527      0              0              2.9955259    
   1100000   2827.5         200            200            0.0049478235   0.00157898     0              0.01326449     0.0048445625   0              935.70635      0              0              2.9955364    
   1200000   2827.5         200            200            0.0049458746   0.001578686    0              0.013258938    0.00032410016  0              62.598547      0              0              2.9955374    
   1300000   2827.5         200            200            0.0049476622   0.0015789269   0              0.01326406     7.6977291e-07  0              0.14867831     0              0              2.9955366    
   1400000   2827.5         200            200            0.0049489465   0.001579104    0              0.013267736    3.7279156e-06  0              0.72003082     0              0              2.995536     
   1500000   2827.5         200            200            0.0049494383   0.0015791725   0              0.013269142    1.4901505e-06  0              0.28781613     0              0              2.9955357    
   1600000   2827.5         200            200            0.0049495456   0.0015791877   0              0.013269449    1.9017033e-07  0              0.036730579    0              0              2.9955357    
   1700000   2827.5         200            200            0.0049495404   0.0015791872   0              0.013269434    7.0686287e-09  0              0.0013652751   0              0              2.9955357    
   1800000   2827.5         200            200            0.004949523    0.0015791848   0              0.013269384    1.1884598e-10  0              2.2954589e-05  0              0              2.9955357    
   1900000   2827.5         200            200            0.0049495137   0.0015791835   0              0.013269358    3.0898585e-10  0              5.9679284e-05  0              0              2.9955357    
   2000000   2827.5         200            200            0.0049495108   0.0015791831   0              0.013269349    7.3309249e-11  0              1.4159365e-05  0              0              2.9955357    
   2100000   2827.5         200            200            0.0049495104   0.0015791831   0              0.013269348    6.318434e-12   0              1.2203783e-06  0              0              2.9955357    
   2200000   2827.5         200            200            0.0049495105   0.0015791831   0              0.013269349    7.7747452e-14  0              1.5016585e-08  0              0              2.9955357    
   2300000   2827.5         200            200            0.0049495107   0.0015791831   0              0.013269349    3.2422121e-14  0              6.2621928e-09  0              0              2.9955357    
   2400000   2827.5         200            200            0.0049495107   0.0015791831   0              0.013269349    1.975499e-14   0              3.8155911e-09  0              0              2.9955357    
   2500000   2827.5         200            200            0.0049495108   0.0015791831   0              0.013269349    3.1036622e-15  0              5.9945895e-10  0              0              2.9955357    
   2600000   2827.5         200            200            0.0049495108   0.0015791831   0              0.013269349    1.6578282e-16  0              3.2020236e-11  0              0              2.9955357    
   2700000   2827.5         200            200            0.0049495108   0.0015791831   0              0.013269349    8.6497887e-19  0              1.6706694e-13  0              0              2.9955357    
   2800000   2827.5         200            200            0.0049495107   0.0015791831   0              0.013269349    1.8338275e-18  0              3.5419586e-13  0              0              2.9955357    
   2900000   2827.5         200            200            0.0049495107   0.0015791831   0              0.013269349    2.094756e-18   0              4.0459308e-13  0              0              2.9955357    
   3000000   2827.5         200            200            0.0049495107   0.0015791831   0              0.013269349    2.1722089e-19  0              4.1955277e-14  0              0              2.9955357    
Loop time of 180.303 on 2 procs for 3000000 steps with 1251 atoms

Performance: 14375764.802 ns/day, 0.000 hours/ns, 16638.617 timesteps/s
99.9% CPU use with 2 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 40.648     | 40.715     | 40.783     |   1.1 | 22.58
Neigh   | 3.5363     | 3.5365     | 3.5366     |   0.0 |  1.96
Comm    | 14.23      | 14.278     | 14.326     |   1.3 |  7.92
Output  | 0.2142     | 0.21422    | 0.21425    |   0.0 |  0.12
Modify  | 108.73     | 108.77     | 108.8      |   0.3 | 60.32
Other   |            | 12.79      |            |       |  7.10

Nlocal:          625.5 ave         626 max         625 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Nghost:            2.5 ave           3 max           2 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Neighs:          355.5 ave         356 max         355 min
Histogram: 1 0 0 0 0 0 0 0 0 1

Total # of neighbors = 711
Ave neighs/atom = 0.56834532
Neighbor list builds = 164
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 78

#variable lat0 equal 1                    #
variable lat1 equal 3+(v_ind*0.01)        # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 250*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 3.78                                                               
Lattice spacing in x,y,z = 3.78 3.78 3.78

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -1417.5 ${n1e1} -100 100 -100 100 units box
region box block -1417.5 1417.5 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -1417.5 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -1417.5 1417.5 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-1417.5 -100 -100) to (1417.5 100 100)
  2 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 750 atoms
  using lattice units in orthogonal box = (-1417.5 -100 -100) to (1417.5 100 100)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -750 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -750 750 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 501 atoms
  using lattice units in orthogonal box = (-1417.5 -100 -100) to (1417.5 100 100)
  create_atoms CPU = 0.000 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  750 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  750 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  501 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  501 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
750 atoms in group substrate
group slider1 region slider1
501 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 501 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_78_*.dump id type diameter mass xu yu zu fx fy fz

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 1830 130 130
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 76.81 | 76.81 | 76.81 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   2835           200            200            0              0              0              0              0              0              0              0              0              6            
    100000   2835           200            200            0.0035899127   2.6712756e-36  0              0.010769738    292851.5       0              5.6563003e+10  0              0              3.3266248    
    200000   2835           200            200            0.0012699976   9.8307093e-43  0              0.0038099927   71206.637      0              1.3753255e+10  0              0              3.0745186    
    300000   2835           200            200            8.7371263e-05  8.9042685e-37  0              0.00026211379  695.72038      0              1.3437539e+08  0              0              3.0455529    
    400000   2835           200            200            0.0011018642   3.701788e-05   0              0.0032685749   4571.2975      0              8.8292638e+08  0              0              2.9979561    
    500000   2835           200            200            0.0074196802  -0.0050787308   0              0.027337771    308.63541      0              59611598       0              0              2.9933941    
    600000   2835           200            200            0.0024971639  -0.0017140001   0              0.0092054918   49.081115      0              9479805.5      0              0              2.996145     
    700000   2835           200            200            0.0042089892  -0.0026100864   0              0.015237054    1.431197       0              276429.52      0              0              2.9950488    
    800000   2835           200            200            0.0033480964  -0.0024783889   0              0.012522678    0.21232859     0              41010.351      0              0              2.9955226    
    900000   2835           200            200            0.0036168103  -0.0025280227   0              0.013378454    0.19076433     0              36845.308      0              0              2.9953676    
   1000000   2835           200            200            0.0035755597  -0.0025206773   0              0.013247356    0.035000619    0              6760.2185      0              0              2.9953919    
   1100000   2835           200            200            0.0035625171  -0.002518553    0              0.013206104    0.0022919306   0              442.6765       0              0              2.9953989    
   1200000   2835           200            200            0.0035755603  -0.0025207794   0              0.01324746     4.2795288e-06  0              0.82657251     0              0              2.9953916    
   1300000   2835           200            200            0.0035698793  -0.0025197981   0              0.013229436    2.7954889e-05  0              5.3993662      0              0              2.9953948    
   1400000   2835           200            200            0.0035713598  -0.0025200584   0              0.013234138    1.0874207e-05  0              2.1003061      0              0              2.995394     
   1500000   2835           200            200            0.0035712819  -0.0025200425   0              0.013233888    1.3646412e-06  0              0.26357455     0              0              2.995394     
   1600000   2835           200            200            0.0035711264  -0.0025200165   0              0.013233396    4.902616e-08   0              0.0094691912   0              0              2.9953941    
   1700000   2835           200            200            0.0035712257  -0.0025200335   0              0.013233711    9.8561023e-10  0              0.00019036636  0              0              2.995394     
   1800000   2835           200            200            0.00357119    -0.0025200273   0              0.013233597    2.2875096e-09  0              0.0004418226   0              0              2.9953941    
   1900000   2835           200            200            0.003571197   -0.0025200285   0              0.013233619    5.3181657e-10  0              0.00010271808  0              0              2.9953941    
   2000000   2835           200            200            0.0035711978  -0.0025200287   0              0.013233622    4.4938987e-11  0              8.6797715e-06  0              0              2.9953941    
   2100000   2835           200            200            0.0035711964  -0.0025200284   0              0.013233618    5.0668077e-13  0              9.7863205e-08  0              0              2.9953941    
   2200000   2835           200            200            0.0035711971  -0.0025200285   0              0.01323362     2.4902208e-13  0              4.8097541e-08  0              0              2.9953941    
   2300000   2835           200            200            0.0035711969  -0.0025200285   0              0.013233619    1.453967e-13   0              2.8082745e-08  0              0              2.9953941    
   2400000   2835           200            200            0.0035711969  -0.0025200285   0              0.013233619    2.2539256e-14  0              4.3533599e-09  0              0              2.9953941    
   2500000   2835           200            200            0.0035711969  -0.0025200285   0              0.013233619    1.1677742e-15  0              2.2555054e-10  0              0              2.9953941    
   2600000   2835           200            200            0.0035711969  -0.0025200285   0              0.013233619    1.2204016e-19  0              2.357153e-14   0              0              2.9953941    
   2700000   2835           200            200            0.0035711969  -0.0025200285   0              0.013233619    1.8396996e-17  0              3.5533004e-12  0              0              2.9953941    
   2800000   2835           200            200            0.0035711969  -0.0025200285   0              0.013233619    6.5563402e-18  0              1.2663288e-12  0              0              2.9953941    
   2900000   2835           200            200            0.0035711969  -0.0025200285   0              0.013233619    2.1214623e-18  0              4.0975129e-13  0              0              2.9953941    
   3000000   2835           200            200            0.0035711969  -0.0025200285   0              0.013233619    6.2373224e-19  0              1.2047119e-13  0              0              2.9953941    
Loop time of 179.442 on 2 procs for 3000000 steps with 1251 atoms

Performance: 14444813.049 ns/day, 0.000 hours/ns, 16718.534 timesteps/s
99.9% CPU use with 2 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 40.012     | 40.072     | 40.131     |   0.9 | 22.33
Neigh   | 3.5499     | 3.5505     | 3.5511     |   0.0 |  1.98
Comm    | 14.248     | 14.285     | 14.322     |   1.0 |  7.96
Output  | 0.20972    | 0.20975    | 0.20978    |   0.0 |  0.12
Modify  | 108.57     | 108.58     | 108.59     |   0.1 | 60.51
Other   |            | 12.74      |            |       |  7.10

Nlocal:          625.5 ave         626 max         625 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Nghost:            2.5 ave           3 max           2 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Neighs:          356.5 ave         357 max         356 min
Histogram: 1 0 0 0 0 0 0 0 0 1

Total # of neighbors = 713
Ave neighs/atom = 0.56994404
Neighbor list builds = 164
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 79

#variable lat0 equal 1                    #
variable lat1 equal 3+(v_ind*0.01)        # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 250*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 3.79                                                               
Lattice spacing in x,y,z = 3.79 3.79 3.79

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -1421.25 ${n1e1} -100 100 -100 100 units box
region box block -1421.25 1421.25 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -1421.25 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -1421.25 1421.25 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-1421.25 -100 -100) to (1421.25 100 100)
  2 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 750 atoms
  using lattice units in orthogonal box = (-1421.25 -100 -100) to (1421.25 100 100)
  create_atoms CPU = 0.000 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -750 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -750 750 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 501 atoms
  using lattice units in orthogonal box = (-1421.25 -100 -100) to (1421.25 100 100)
  create_atoms CPU = 0.000 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  750 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  750 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  501 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  501 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
750 atoms in group substrate
group slider1 region slider1
501 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 501 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_79_*.dump id type diameter mass xu yu zu fx fy fz

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 1834 130 130
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 76.95 | 76.95 | 76.95 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   2842.5         200            200            0              0              0              0              0              0              0              0              0              6            
    100000   2842.5         200            200            0.0035807225  -4.4403702e-37  0              0.010742168    292886.85      0              5.656983e+10   0              0              3.3265573    
    200000   2842.5         200            200            0.0012665741  -8.8807506e-36  0              0.0037997223   71198.961      0              1.3751772e+10  0              0              3.0745847    
    300000   2842.5         200            200            8.7349782e-05 -1.7761404e-36  0              0.00026204935  698.89217      0              1.3498801e+08  0              0              3.0455941    
    400000   2842.5         200            200            0.00072566051  2.1017061e-05  0              0.0021559645   4420.7482      0              8.5384845e+08  0              0              2.9984051    
    500000   2842.5         200            200            0.0079342019  -0.0041640187   0              0.027966624    258.50923      0              49929943       0              0              2.9933981    
    600000   2842.5         200            200            0.0028149913   0.00023223211  0              0.0082127417   15.661699      0              3024989.5      0              0              2.9964383    
    700000   2842.5         200            200            0.0033893156  -0.00097984741  0              0.011147794    0.2956091      0              57095.623      0              0              2.9958461    
    800000   2842.5         200            200            0.0037714183  -0.0011829208   0              0.012497176    0.36521821     0              70540.322      0              0              2.9956017    
    900000   2842.5         200            200            0.0039204069  -0.0012138973   0              0.012975118    0.10561728     0              20399.521      0              0              2.9955188    
   1000000   2842.5         200            200            0.0039697926  -0.0012240242   0              0.013133402    0.022371648    0              4320.9872      0              0              2.9954918    
   1100000   2842.5         200            200            0.003985065   -0.0012270745   0              0.01318227     0.0039938921   0              771.40303      0              0              2.9954835    
   1200000   2842.5         200            200            0.0039893307  -0.0012279122   0              0.013195904    0.00062906902  0              121.50197      0              0              2.9954812    
   1300000   2842.5         200            200            0.0039903244  -0.0012281027   0              0.013199076    8.9089614e-05  0              17.207275      0              0              2.9954807    
   1400000   2842.5         200            200            0.0039904604  -0.0012281262   0              0.013199507    1.1403857e-05  0              2.2026057      0              0              2.9954806    
   1500000   2842.5         200            200            0.0039904237  -0.0012281174   0              0.013199389    1.3119254e-06  0              0.25339274     0              0              2.9954807    
   1600000   2842.5         200            200            0.0039903791  -0.0012281079   0              0.013199245    1.3306918e-07  0              0.025701738    0              0              2.9954807    
   1700000   2842.5         200            200            0.003990352   -0.0012281022   0              0.013199158    1.1392993e-08  0              0.0022005075   0              0              2.9954807    
   1800000   2842.5         200            200            0.0039903387  -0.0012280995   0              0.013199115    7.4138921e-10  0              0.00014319613  0              0              2.9954807    
   1900000   2842.5         200            200            0.0039903327  -0.0012280983   0              0.013199096    2.5988668e-11  0              5.0195991e-06  0              0              2.9954807    
   2000000   2842.5         200            200            0.0039903303  -0.0012280978   0              0.013199089    5.8268876e-16  0              1.1254382e-10  0              0              2.9954807    
   2100000   2842.5         200            200            0.0039903294  -0.0012280976   0              0.013199086    4.978048e-13   0              9.6148848e-08  0              0              2.9954807    
   2200000   2842.5         200            200            0.003990329   -0.0012280975   0              0.013199085    2.5263692e-13  0              4.8795731e-08  0              0              2.9954807    
   2300000   2842.5         200            200            0.0039903289  -0.0012280975   0              0.013199084    6.9974537e-14  0              1.351528e-08   0              0              2.9954807    
   2400000   2842.5         200            200            0.0039903288  -0.0012280975   0              0.013199084    1.4934245e-14  0              2.8844849e-09  0              0              2.9954807    
   2500000   2842.5         200            200            0.0039903288  -0.0012280975   0              0.013199084    2.637114e-15   0              5.0934718e-10  0              0              2.9954807    
   2600000   2842.5         200            200            0.0039903288  -0.0012280975   0              0.013199084    4.2134135e-16  0              8.1380264e-11  0              0              2.9954807    
   2700000   2842.5         200            200            0.0039903288  -0.0012280975   0              0.013199084    5.805034e-17   0              1.1212173e-11  0              0              2.9954807    
   2800000   2842.5         200            200            0.0039903288  -0.0012280975   0              0.013199084    6.3115001e-18  0              1.219039e-12   0              0              2.9954807    
   2900000   2842.5         200            200            0.0039903288  -0.0012280975   0              0.013199084    6.6026009e-23  0              1.2752639e-17  0              0              2.9954807    
   3000000   2842.5         200            200            0.0039903288  -0.0012280975   0              0.013199084    2.8269471e-18  0              5.4601263e-13  0              0              2.9954807    
Loop time of 180.48 on 2 procs for 3000000 steps with 1251 atoms

Performance: 14361684.818 ns/day, 0.000 hours/ns, 16622.320 timesteps/s
99.9% CPU use with 2 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 40.124     | 40.278     | 40.431     |   2.4 | 22.32
Neigh   | 3.6058     | 3.606      | 3.6063     |   0.0 |  2.00
Comm    | 14.815     | 14.842     | 14.869     |   0.7 |  8.22
Output  | 0.23118    | 0.23122    | 0.23126    |   0.0 |  0.13
Modify  | 108.65     | 108.8      | 108.94     |   1.4 | 60.28
Other   |            | 12.73      |            |       |  7.05

Nlocal:          625.5 ave         626 max         625 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Nghost:            2.5 ave           3 max           2 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Neighs:          354.5 ave         355 max         354 min
Histogram: 1 0 0 0 0 0 0 0 0 1

Total # of neighbors = 709
Ave neighs/atom = 0.5667466
Neighbor list builds = 164
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 80

#variable lat0 equal 1                    #
variable lat1 equal 3+(v_ind*0.01)        # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 250*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 3.8                                                               
Lattice spacing in x,y,z = 3.8 3.8 3.8

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -1425 ${n1e1} -100 100 -100 100 units box
region box block -1425 1425 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -1425 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -1425 1425 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-1425 -100 -100) to (1425 100 100)
  2 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 750 atoms
  using lattice units in orthogonal box = (-1425 -100 -100) to (1425 100 100)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -750 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -750 750 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 501 atoms
  using lattice units in orthogonal box = (-1425 -100 -100) to (1425 100 100)
  create_atoms CPU = 0.000 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  750 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  750 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  501 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  501 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
750 atoms in group substrate
group slider1 region slider1
501 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 501 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_80_*.dump id type diameter mass xu yu zu fx fy fz

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 1839 130 130
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 77.16 | 77.16 | 77.16 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   2850           200            200            0              0              0              0              0              0              0              0              0              6            
    100000   2850           200            200            0.0035713432   2.2143466e-37  0              0.010714029    292889.85      0              5.6570411e+10  0              0              3.3265867    
    200000   2850           200            200            0.0012606972   8.9151431e-42  0              0.0037820916   70967.343      0              1.3707036e+10  0              0              3.0752735    
    300000   2850           200            200            9.3876943e-05  2.1554515e-43  0              0.00028163083  805.87267      0              1.5565083e+08  0              0              3.0454584    
    400000   2850           200            200            0.0017980695  -2.214346e-37   0              0.0053942085   4576.929       0              8.8401408e+08  0              0              2.9977882    
    500000   2850           200            200            0.0053232502  -9.9645583e-37  0              0.015969751    689.59361      0              1.3319203e+08  0              0              2.9949394    
    600000   2850           200            200            0.0039627456   2.2143465e-37  0              0.011888237    91.115626      0              17598590       0              0              2.9959047    
    700000   2850           200            200            0.0040511541   4.4286928e-37  0              0.012153462    9.0461756      0              1747229.8      0              0              2.9958164    
    800000   2850           200            200            0.0046063926   1.2163198e-45  0              0.013819178    0.0043078708   0              832.04665      0              0              2.9954491    
    900000   2850           200            200            0.004338978    1.3286078e-36  0              0.013016934    0.14825627     0              28635.06       0              0              2.9956278    
   1000000   2850           200            200            0.0043801383   4.4286928e-37  0              0.013140415    0.030574024    0              5905.2407      0              0              2.995599     
   1100000   2850           200            200            0.0043984371   2.3974825e-46  0              0.013195311    0.00053369665  0              103.08121      0              0              2.9955872    
   1200000   2850           200            200            0.0043850164   1.1071732e-36  0              0.013155049    0.00018778215  0              36.269311      0              0              2.9955962    
   1300000   2850           200            200            0.0043883144  -4.4286928e-37  0              0.013164943    8.1206011e-05  0              15.684591      0              0              2.9955939    
   1400000   2850           200            200            0.0043887099   1.5500425e-36  0              0.01316613     4.0871391e-06  0              0.78941327     0              0              2.9955937    
   1500000   2850           200            200            0.0043880942  -2.2143464e-37  0              0.013164283    1.2157298e-07  0              0.023481296    0              0              2.9955941    
   1600000   2850           200            200            0.0043883054  -2.2143464e-37  0              0.013164916    1.7896507e-07  0              0.03456633     0              0              2.9955939    
   1700000   2850           200            200            0.0043882978   1.1071732e-36  0              0.013164894    1.8150733e-08  0              0.0035057358   0              0              2.9955939    
   1800000   2850           200            200            0.0043882726   1.5500425e-36  0              0.013164818    5.5754212e-13  0              1.0768685e-07  0              0              2.9955939    
   1900000   2850           200            200            0.0043882845   7.0842222e-48  0              0.013164853    3.1981189e-10  0              6.1770286e-05  0              0              2.9955939    
   2000000   2850           200            200            0.0043882828   2.2143464e-37  0              0.013164848    6.0651111e-11  0              1.17145e-05    0              0              2.9955939    
   2100000   2850           200            200            0.0043882819  -6.6430392e-37  0              0.013164846    8.6676188e-13  0              1.6741132e-07  0              0              2.9955939    
   2200000   2850           200            200            0.0043882825   8.8573856e-37  0              0.013164847    4.2546039e-13  0              8.2175839e-08  0              0              2.9955939    
   2300000   2850           200            200            0.0043882823   8.8573856e-37  0              0.013164847    1.6491567e-13  0              3.1852751e-08  0              0              2.9955939    
   2400000   2850           200            200            0.0043882823  -2.2143464e-36  0              0.013164847    7.4927082e-15  0              1.4471843e-09  0              0              2.9955939    
   2500000   2850           200            200            0.0043882824   3.3402974e-48  0              0.013164847    3.1705161e-16  0              6.123715e-11   0              0              2.9955939    
   2600000   2850           200            200            0.0043882823   2.2143464e-37  0              0.013164847    3.716662e-16   0              7.1785723e-11  0              0              2.9955939    
   2700000   2850           200            200            0.0043882823   2.2143464e-37  0              0.013164847    3.1562194e-17  0              6.0961016e-12  0              0              2.9955939    
   2800000   2850           200            200            0.0043882823   4.4286929e-37  0              0.013164847    1.7453499e-22  0              3.371068e-17   0              0              2.9955939    
   2900000   2850           200            200            0.0043882823  -8.8573856e-37  0              0.013164847    6.0667719e-19  0              1.1717708e-13  0              0              2.9955939    
   3000000   2850           200            200            0.0043882823   7.9147905e-43  0              0.013164847    4.6923801e-19  0              9.0631296e-14  0              0              2.9955939    
Loop time of 178.483 on 2 procs for 3000000 steps with 1251 atoms

Performance: 14522397.960 ns/day, 0.000 hours/ns, 16808.331 timesteps/s
99.9% CPU use with 2 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 38.133     | 38.238     | 38.343     |   1.7 | 21.42
Neigh   | 3.5824     | 3.5832     | 3.5841     |   0.0 |  2.01
Comm    | 14.86      | 14.926     | 14.992     |   1.7 |  8.36
Output  | 0.2121     | 0.21212    | 0.21215    |   0.0 |  0.12
Modify  | 108.67     | 108.79     | 108.92     |   1.2 | 60.96
Other   |            | 12.73      |            |       |  7.13

Nlocal:          625.5 ave         626 max         625 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Nghost:            2.5 ave           3 max           2 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Neighs:          341.5 ave         342 max         341 min
Histogram: 1 0 0 0 0 0 0 0 0 1

Total # of neighbors = 683
Ave neighs/atom = 0.54596323
Neighbor list builds = 164
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 81

#variable lat0 equal 1                    #
variable lat1 equal 3+(v_ind*0.01)        # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 250*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 3.81                                                               
Lattice spacing in x,y,z = 3.81 3.81 3.81

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -1428.75 ${n1e1} -100 100 -100 100 units box
region box block -1428.75 1428.75 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -1428.75 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -1428.75 1428.75 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-1428.75 -100 -100) to (1428.75 100 100)
  2 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 750 atoms
  using lattice units in orthogonal box = (-1428.75 -100 -100) to (1428.75 100 100)
  create_atoms CPU = 0.000 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -750 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -750 750 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 501 atoms
  using lattice units in orthogonal box = (-1428.75 -100 -100) to (1428.75 100 100)
  create_atoms CPU = 0.000 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  750 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  750 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  501 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  501 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
750 atoms in group substrate
group slider1 region slider1
501 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 501 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_81_*.dump id type diameter mass xu yu zu fx fy fz

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 1844 130 130
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 77.3 | 77.3 | 77.3 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   2857.5         200            200            0              0              0              0              0              0              0              0              0              6            
    100000   2857.5         200            200            0.0035616319  -5.5213354e-38  0              0.010684896    292849.43      0              5.6562603e+10  0              0              3.3266336    
    200000   2857.5         200            200            0.0012599238  -3.53363e-36    0              0.0037797714   71199.94       0              1.3751961e+10  0              0              3.0745368    
    300000   2857.5         200            200            8.6666169e-05  4.6666731e-43  0              0.00025999851  695.45723      0              1.3432456e+08  0              0              3.0455547    
    400000   2857.5         200            200            0.0010936282   1.9778234e-05  0              0.0032611063   4576.2433      0              8.8388165e+08  0              0              2.9979469    
    500000   2857.5         200            200            0.0091351135   0.00080886045  0              0.02659648     342.57249      0              66166399       0              0              2.9934659    
    600000   2857.5         200            200            0.0032167075   0.0015840575   0              0.008066065    10.279206      0              1985384.2      0              0              2.9963616    
    700000   2857.5         200            200            0.0045392252   0.001228682    0              0.012388994    12.896245      0              2490854.1      0              0              2.9955061    
    800000   2857.5         200            200            0.0048388297   0.0012350072   0              0.013281482    1.886308       0              364332.26      0              0              2.9953535    
    900000   2857.5         200            200            0.0048493784   0.0012348212   0              0.013313314    0.15220391     0              29397.527      0              0              2.9953496    
   1000000   2857.5         200            200            0.0048207339   0.0012355968   0              0.013226605    0.0044856068   0              866.3756       0              0              2.9953651    
   1100000   2857.5         200            200            0.0048011759   0.0012361619   0              0.013167366    8.5766774e-05  0              16.565482      0              0              2.9953755    
   1200000   2857.5         200            200            0.004792417    0.0012364249   0              0.013140826    0.00022579823  0              43.611954      0              0              2.9953801    
   1300000   2857.5         200            200            0.0047893892   0.0012365167   0              0.013131651    7.1794603e-05  0              13.866818      0              0              2.9953817    
   1400000   2857.5         200            200            0.0047886122   0.0012365401   0              0.013129297    1.1930571e-05  0              2.3043383      0              0              2.9953821    
   1500000   2857.5         200            200            0.0047885182   0.0012365428   0              0.013129012    1.1901644e-06  0              0.22987511     0              0              2.9953821    
   1600000   2857.5         200            200            0.0047885623   0.0012365413   0              0.013129146    5.7361276e-08  0              0.011079083    0              0              2.9953821    
   1700000   2857.5         200            200            0.0047886036   0.00123654     0              0.013129271    5.8519573e-11  0              1.1302803e-05  0              0              2.995382     
   1800000   2857.5         200            200            0.0047886243   0.0012365394   0              0.013129333    7.5059878e-10  0              0.00014497492  0              0              2.995382     
   1900000   2857.5         200            200            0.0047886321   0.0012365392   0              0.013129357    3.5206316e-10  0              6.799948e-05   0              0              2.995382     
   2000000   2857.5         200            200            0.0047886344   0.0012365391   0              0.013129364    7.1273635e-11  0              1.3766195e-05  0              0              2.995382     
   2100000   2857.5         200            200            0.0047886348   0.0012365391   0              0.013129365    8.5787772e-12  0              1.6569538e-06  0              0              2.995382     
   2200000   2857.5         200            200            0.0047886348   0.0012365391   0              0.013129365    5.7035712e-13  0              1.1016202e-07  0              0              2.995382     
   2300000   2857.5         200            200            0.0047886347   0.0012365391   0              0.013129365    8.6153443e-15  0              1.6640166e-09  0              0              2.995382     
   2400000   2857.5         200            200            0.0047886347   0.0012365391   0              0.013129365    1.7217799e-15  0              3.3255436e-10  0              0              2.995382     
   2500000   2857.5         200            200            0.0047886346   0.0012365391   0              0.013129365    1.5256263e-15  0              2.9466815e-10  0              0              2.995382     
   2600000   2857.5         200            200            0.0047886346   0.0012365391   0              0.013129365    3.9876259e-16  0              7.7019274e-11  0              0              2.995382     
   2700000   2857.5         200            200            0.0047886346   0.0012365391   0              0.013129365    5.454069e-17   0              1.0534299e-11  0              0              2.995382     
   2800000   2857.5         200            200            0.0047886346   0.0012365391   0              0.013129365    3.3766852e-18  0              6.5219217e-13  0              0              2.995382     
   2900000   2857.5         200            200            0.0047886346   0.0012365391   0              0.013129365    3.3723448e-19  0              6.5135385e-14  0              0              2.995382     
   3000000   2857.5         200            200            0.0047886346   0.0012365391   0              0.013129365    2.7867093e-18  0              5.3824087e-13  0              0              2.995382     
Loop time of 180.466 on 2 procs for 3000000 steps with 1251 atoms

Performance: 14362830.708 ns/day, 0.000 hours/ns, 16623.647 timesteps/s
99.9% CPU use with 2 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 40.685     | 40.725     | 40.764     |   0.6 | 22.57
Neigh   | 3.5605     | 3.5605     | 3.5606     |   0.0 |  1.97
Comm    | 14.212     | 14.32      | 14.429     |   2.9 |  7.94
Output  | 0.21279    | 0.21283    | 0.21286    |   0.0 |  0.12
Modify  | 108.8      | 108.92     | 109.03     |   1.1 | 60.35
Other   |            | 12.73      |            |       |  7.05

Nlocal:          625.5 ave         626 max         625 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Nghost:            2.5 ave           3 max           2 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Neighs:          355.5 ave         356 max         355 min
Histogram: 1 0 0 0 0 0 0 0 0 1

Total # of neighbors = 711
Ave neighs/atom = 0.56834532
Neighbor list builds = 164
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 82

#variable lat0 equal 1                    #
variable lat1 equal 3+(v_ind*0.01)        # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 250*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 3.82                                                               
Lattice spacing in x,y,z = 3.82 3.82 3.82

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -1432.5 ${n1e1} -100 100 -100 100 units box
region box block -1432.5 1432.5 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -1432.5 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -1432.5 1432.5 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-1432.5 -100 -100) to (1432.5 100 100)
  2 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 750 atoms
  using lattice units in orthogonal box = (-1432.5 -100 -100) to (1432.5 100 100)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -750 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -750 750 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 501 atoms
  using lattice units in orthogonal box = (-1432.5 -100 -100) to (1432.5 100 100)
  create_atoms CPU = 0.000 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  750 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  750 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  501 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  501 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
750 atoms in group substrate
group slider1 region slider1
501 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 501 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_82_*.dump id type diameter mass xu yu zu fx fy fz

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 1849 130 130
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 77.5 | 77.5 | 77.5 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   2865           200            200            0              0              0              0              0              0              0              0              0              6            
    100000   2865           200            200            0.003552007    3.5244098e-36  0              0.010656021    292803.05      0              5.6553645e+10  0              0              3.3268404    
    200000   2865           200            200            0.0012563658  -3.524399e-36   0              0.0037690974   71174.586      0              1.3747064e+10  0              0              3.0746746    
    300000   2865           200            200            8.3529186e-05  1.7622059e-36  0              0.00025058756  651.35541      0              1.2580649e+08  0              0              3.0457285    
    400000   2865           200            200            0.000321677    5.2490296e-06  0              0.00095978197  4030.174       0              7.7841071e+08  0              0              2.9993481    
    500000   2865           200            200            0.0067859308   0.0029320223   0              0.01742577     748.58907      0              1.4458675e+08  0              0              2.9949052    
    600000   2865           200            200            0.0053256827   0.0033758557   0              0.012601192    108.28818      0              20915394       0              0              2.9956504    
    700000   2865           200            200            0.0062335664   0.0036345198   0              0.01506618     2.1779312      0              420658.01      0              0              2.9952446    
    800000   2865           200            200            0.0054203342   0.0035307975   0              0.012730205    1.505366       0              290754.94      0              0              2.9956462    
    900000   2865           200            200            0.0054613186   0.0035384054   0              0.01284555     0.05496648     0              10616.538      0              0              2.9956231    
   1000000   2865           200            200            0.0055621667   0.003549101    0              0.013137399    0.029922838    0              5779.467       0              0              2.9955714    
   1100000   2865           200            200            0.0055600503   0.003548872    0              0.013131279    0.00064407231  0              124.39979      0              0              2.9955728    
   1200000   2865           200            200            0.0055464357   0.0035477239   0              0.013091583    0.00059138785  0              114.22401      0              0              2.9955798    
   1300000   2865           200            200            0.0055462072   0.0035477117   0              0.01309091     6.2166152e-06  0              1.2007124      0              0              2.9955799    
   1400000   2865           200            200            0.0055480368   0.0035478674   0              0.013096243    1.1427626e-05  0              2.2071966      0              0              2.9955789    
   1500000   2865           200            200            0.0055481379   0.003547875    0              0.013096539    4.2887144e-08  0              0.0082834668   0              0              2.9955789    
   1600000   2865           200            200            0.0055478947   0.0035478543   0              0.01309583     2.1579007e-07  0              0.04167892     0              0              2.995579     
   1700000   2865           200            200            0.0055478717   0.0035478525   0              0.013095763    1.0300255e-10  0              1.9894498e-05  0              0              2.995579     
   1800000   2865           200            200            0.0055479037   0.0035478552   0              0.013095856    3.9857168e-09  0              0.00076982399  0              0              2.995579     
   1900000   2865           200            200            0.005547908    0.0035478555   0              0.013095868    1.105453e-12   0              2.1351347e-07  0              0              2.995579     
   2000000   2865           200            200            0.0055479039   0.0035478552   0              0.013095856    7.2028419e-11  0              1.3911978e-05  0              0              2.995579     
   2100000   2865           200            200            0.0055479031   0.0035478551   0              0.013095854    2.1892652e-13  0              4.2284713e-08  0              0              2.995579     
   2200000   2865           200            200            0.0055479036   0.0035478552   0              0.013095856    1.2734346e-12  0              2.459584e-07   0              0              2.995579     
   2300000   2865           200            200            0.0055479038   0.0035478552   0              0.013095856    1.1358272e-14  0              2.1938012e-09  0              0              2.995579     
   2400000   2865           200            200            0.0055479037   0.0035478552   0              0.013095856    2.1985169e-14  0              4.2463405e-09  0              0              2.995579     
   2500000   2865           200            200            0.0055479037   0.0035478552   0              0.013095856    4.1045219e-16  0              7.9277069e-11  0              0              2.995579     
   2600000   2865           200            200            0.0055479037   0.0035478552   0              0.013095856    3.8277496e-16  0              7.3931331e-11  0              0              2.995579     
   2700000   2865           200            200            0.0055479037   0.0035478552   0              0.013095856    6.3499375e-18  0              1.226463e-12   0              0              2.995579     
   2800000   2865           200            200            0.0055479037   0.0035478552   0              0.013095856    6.2938422e-18  0              1.2156285e-12  0              0              2.995579     
   2900000   2865           200            200            0.0055479037   0.0035478552   0              0.013095856    1.9633153e-19  0              3.7920589e-14  0              0              2.995579     
   3000000   2865           200            200            0.0055479037   0.0035478552   0              0.013095856    2.1333616e-18  0              4.1204959e-13  0              0              2.995579     
Loop time of 180.396 on 2 procs for 3000000 steps with 1251 atoms

Performance: 14368414.384 ns/day, 0.000 hours/ns, 16630.109 timesteps/s
99.9% CPU use with 2 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 40.271     | 40.383     | 40.496     |   1.8 | 22.39
Neigh   | 3.5801     | 3.5804     | 3.5807     |   0.0 |  1.98
Comm    | 14.879     | 14.939     | 15         |   1.6 |  8.28
Output  | 0.20929    | 0.20932    | 0.20934    |   0.0 |  0.12
Modify  | 108.45     | 108.57     | 108.68     |   1.1 | 60.18
Other   |            | 12.72      |            |       |  7.05

Nlocal:          625.5 ave         626 max         625 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Nghost:            2.5 ave           3 max           2 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Neighs:          352.5 ave         353 max         352 min
Histogram: 1 0 0 0 0 0 0 0 0 1

Total # of neighbors = 705
Ave neighs/atom = 0.56354916
Neighbor list builds = 164
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 83

#variable lat0 equal 1                    #
variable lat1 equal 3+(v_ind*0.01)        # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 250*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 3.83                                                               
Lattice spacing in x,y,z = 3.83 3.83 3.83

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -1436.25 ${n1e1} -100 100 -100 100 units box
region box block -1436.25 1436.25 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -1436.25 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -1436.25 1436.25 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-1436.25 -100 -100) to (1436.25 100 100)
  2 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 750 atoms
  using lattice units in orthogonal box = (-1436.25 -100 -100) to (1436.25 100 100)
  create_atoms CPU = 0.000 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -750 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -750 750 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 501 atoms
  using lattice units in orthogonal box = (-1436.25 -100 -100) to (1436.25 100 100)
  create_atoms CPU = 0.000 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  750 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  750 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  501 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  501 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
750 atoms in group substrate
group slider1 region slider1
501 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 501 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_83_*.dump id type diameter mass xu yu zu fx fy fz

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 1854 130 130
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 77.64 | 77.64 | 77.64 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   2872.5         200            200            0              0              0              0              0              0              0              0              0              6            
    100000   2872.5         200            200            0.0035428835   4.3940065e-37  0              0.010628651    292826.7       0              5.6558213e+10  0              0              3.3267303    
    200000   2872.5         200            200            0.0012527043   6.5910055e-37  0              0.0037581128   71140.625      0              1.3740505e+10  0              0              3.0747344    
    300000   2872.5         200            200            8.5430666e-05 -7.030393e-36   0              0.000256292    683.41429      0              1.3199852e+08  0              0              3.0456421    
    400000   2872.5         200            200            0.001034116    1.7135631e-05  0              0.0030852124   4567.5368      0              8.8220003e+08  0              0              2.9980416    
    500000   2872.5         200            200            0.0077428639  -0.0051638367   0              0.028392428    218.32905      0              42169313       0              0              2.9932985    
    600000   2872.5         200            200            0.0025587939  -0.00025378645  0              0.0079301682   5.2751602      0              1018874.4      0              0              2.9964487    
    700000   2872.5         200            200            0.0034382574  -0.00075771288  0              0.011072485    0.84145294     0              162523         0              0              2.9957918    
    800000   2872.5         200            200            0.0038140488  -0.00089088999  0              0.012333036    0.20042745     0              38711.697      0              0              2.9955606    
    900000   2872.5         200            200            0.003961981   -0.00090546057  0              0.012791404    0.025713957    0              4966.5399      0              0              2.9954802    
   1000000   2872.5         200            200            0.0040163046  -0.00091215259  0              0.012961066    0.003025316    0              584.32674      0              0              2.9954509    
   1100000   2872.5         200            200            0.0040364774  -0.00091458681  0              0.013024019    0.00034713013  0              67.046686      0              0              2.99544      
   1200000   2872.5         200            200            0.0040439533  -0.00091548058  0              0.01304734     3.9095304e-05  0              7.5510892      0              0              2.995436     
   1300000   2872.5         200            200            0.0040467199  -0.00091581031  0              0.01305597     4.3150203e-06  0              0.83342755     0              0              2.9954345    
   1400000   2872.5         200            200            0.0040477429  -0.00091593212  0              0.013059161    4.6485929e-07  0              0.089785567    0              0              2.995434     
   1500000   2872.5         200            200            0.0040481208  -0.00091597712  0              0.01306034     4.8587039e-08  0              0.0093843768   0              0              2.9954338    
   1600000   2872.5         200            200            0.0040482604  -0.00091599374  0              0.013060775    4.883472e-09   0              0.00094322154  0              0              2.9954337    
   1700000   2872.5         200            200            0.0040483119  -0.00091599988  0              0.013060936    4.6566103e-10  0              8.9940419e-05  0              0              2.9954337    
   1800000   2872.5         200            200            0.0040483309  -0.00091600214  0              0.013060995    4.1193572e-11  0              7.9563606e-06  0              0              2.9954337    
   1900000   2872.5         200            200            0.0040483379  -0.00091600298  0              0.013061017    3.2451338e-12  0              6.267836e-07   0              0              2.9954337    
   2000000   2872.5         200            200            0.0040483404  -0.00091600328  0              0.013061025    2.0912631e-13  0              4.0391844e-08  0              0              2.9954337    
   2100000   2872.5         200            200            0.0040483414  -0.0009160034   0              0.013061028    8.5825522e-15  0              1.6576829e-09  0              0              2.9954337    
   2200000   2872.5         200            200            0.0040483417  -0.00091600344  0              0.013061029    3.6718025e-17  0              7.091928e-12   0              0              2.9954337    
   2300000   2872.5         200            200            0.0040483419  -0.00091600345  0              0.013061029    5.9990601e-17  0              1.1586926e-11  0              0              2.9954337    
   2400000   2872.5         200            200            0.0040483419  -0.00091600346  0              0.013061029    4.1406651e-17  0              7.997516e-12   0              0              2.9954337    
   2500000   2872.5         200            200            0.0040483419  -0.00091600346  0              0.013061029    1.1445232e-17  0              2.2105971e-12  0              0              2.9954337    
   2600000   2872.5         200            200            0.0040483419  -0.00091600346  0              0.013061029    1.6886568e-18  0              3.2615677e-13  0              0              2.9954337    
   2700000   2872.5         200            200            0.0040483419  -0.00091600346  0              0.013061029    5.0456966e-20  0              9.7455453e-15  0              0              2.9954337    
   2800000   2872.5         200            200            0.0040483419  -0.00091600346  0              0.013061029    1.1759319e-21  0              2.2712618e-16  0              0              2.9954337    
   2900000   2872.5         200            200            0.0040483419  -0.00091600346  0              0.013061029    2.6889571e-19  0              5.1936046e-14  0              0              2.9954337    
   3000000   2872.5         200            200            0.0040483419  -0.00091600346  0              0.013061029    2.7804517e-18  0              5.3703226e-13  0              0              2.9954337    
Loop time of 181.392 on 2 procs for 3000000 steps with 1251 atoms

Performance: 14289474.886 ns/day, 0.000 hours/ns, 16538.744 timesteps/s
99.9% CPU use with 2 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 40.679     | 40.754     | 40.828     |   1.2 | 22.47
Neigh   | 3.586      | 3.5865     | 3.587      |   0.0 |  1.98
Comm    | 14.893     | 15.002     | 15.111     |   2.8 |  8.27
Output  | 0.21599    | 0.21602    | 0.21605    |   0.0 |  0.12
Modify  | 108.98     | 109.07     | 109.17     |   0.9 | 60.13
Other   |            | 12.76      |            |       |  7.03

Nlocal:          625.5 ave         626 max         625 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Nghost:            2.5 ave           3 max           2 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Neighs:          352.5 ave         353 max         352 min
Histogram: 1 0 0 0 0 0 0 0 0 1

Total # of neighbors = 705
Ave neighs/atom = 0.56354916
Neighbor list builds = 164
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 84

#variable lat0 equal 1                    #
variable lat1 equal 3+(v_ind*0.01)        # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 250*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 3.84                                                               
Lattice spacing in x,y,z = 3.84 3.84 3.84

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -1440 ${n1e1} -100 100 -100 100 units box
region box block -1440 1440 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -1440 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -1440 1440 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-1440 -100 -100) to (1440 100 100)
  2 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 750 atoms
  using lattice units in orthogonal box = (-1440 -100 -100) to (1440 100 100)
  create_atoms CPU = 0.000 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -750 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -750 750 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 501 atoms
  using lattice units in orthogonal box = (-1440 -100 -100) to (1440 100 100)
  create_atoms CPU = 0.000 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  750 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  750 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  501 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  501 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
750 atoms in group substrate
group slider1 region slider1
501 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 501 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_84_*.dump id type diameter mass xu yu zu fx fy fz

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 1859 130 130
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 77.85 | 77.85 | 77.85 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   2880           200            200            0              0              0              0              0              0              0              0              0              6            
    100000   2880           200            200            0.0035332317  -4.3825598e-37  0              0.010599695    292772.61      0              5.6547767e+10  0              0              3.326834     
    200000   2880           200            200            0.0012491757  -2.7391002e-38  0              0.0037475271   71118.115      0              1.3736157e+10  0              0              3.0747215    
    300000   2880           200            200            8.6861259e-05 -4.3825604e-37  0              0.00026058378  708.99332      0              1.36939e+08    0              0              3.0455239    
    400000   2880           200            200            0.0006683095  -1.3147681e-36  0              0.0020049285   4309.6483      0              8.3238997e+08  0              0              2.998579     
    500000   2880           200            200            0.011207691    0.0033836285   0              0.030239445    98.416589      0              19008739       0              0              2.9930903    
    600000   2880           200            200            0.0055474315   0.0018562945   0              0.014786       103.159        0              19924716       0              0              2.9951291    
    700000   2880           200            200            0.0052251249   0.0014562582   0              0.014219116    10.811024      0              2088102.7      0              0              2.9952361    
    800000   2880           200            200            0.0045492363   0.0014058968   0              0.012241812    0.078707633    0              15202.04       0              0              2.9955489    
    900000   2880           200            200            0.0048319072   0.0014295262   0              0.013066196    0.26854594     0              51868.49       0              0              2.9954133    
   1000000   2880           200            200            0.0048516925   0.0014308978   0              0.01312418     0.0079599054   0              1537.4214      0              0              2.9954049    
   1100000   2880           200            200            0.0048084739   0.0014275689   0              0.012997853    0.0023245543   0              448.97764      0              0              2.9954252    
   1200000   2880           200            200            0.004816377    0.0014282025   0              0.013020928    0.00056574135  0              109.2705       0              0              2.9954213    
   1300000   2880           200            200            0.0048202862   0.0014285006   0              0.013032358    5.1545936e-07  0              0.09955875     0              0              2.9954195    
   1400000   2880           200            200            0.0048182667   0.0014283428   0              0.013026457    1.1471857e-05  0              2.2157397      0              0              2.9954205    
   1500000   2880           200            200            0.0048182308   0.001428341    0              0.013026351    5.3018455e-07  0              0.10240286     0              0              2.9954205    
   1600000   2880           200            200            0.0048185123   0.0014283628   0              0.013027174    7.8402977e-08  0              0.015143197    0              0              2.9954204    
   1700000   2880           200            200            0.0048184485   0.0014283577   0              0.013026988    2.7734949e-08  0              0.0053568857   0              0              2.9954204    
   1800000   2880           200            200            0.0048184261   0.001428356    0              0.013026922    7.6045061e-12  0              1.4687775e-06  0              0              2.9954204    
   1900000   2880           200            200            0.0048184401   0.0014283571   0              0.013026963    4.760076e-10   0              9.1938813e-05  0              0              2.9954204    
   2000000   2880           200            200            0.0048184397   0.0014283571   0              0.013026962    3.2340517e-11  0              6.2464313e-06  0              0              2.9954204    
   2100000   2880           200            200            0.0048184379   0.0014283569   0              0.013026957    2.4346422e-12  0              4.7024064e-07  0              0              2.9954204    
   2200000   2880           200            200            0.0048184384   0.001428357    0              0.013026958    1.3186111e-12  0              2.5468405e-07  0              0              2.9954204    
   2300000   2880           200            200            0.0048184386   0.001428357    0              0.013026959    4.8105359e-15  0              9.2913425e-10  0              0              2.9954204    
   2400000   2880           200            200            0.0048184385   0.001428357    0              0.013026958    1.9048749e-14  0              3.6791837e-09  0              0              2.9954204    
   2500000   2880           200            200            0.0048184385   0.001428357    0              0.013026958    1.822948e-15   0              3.5209455e-10  0              0              2.9954204    
   2600000   2880           200            200            0.0048184385   0.001428357    0              0.013026958    6.5053988e-17  0              1.2564897e-11  0              0              2.9954204    
   2700000   2880           200            200            0.0048184385   0.001428357    0              0.013026958    5.9321345e-17  0              1.1457662e-11  0              0              2.9954204    
   2800000   2880           200            200            0.0048184385   0.001428357    0              0.013026958    8.3867824e-19  0              1.6198708e-13  0              0              2.9954204    
   2900000   2880           200            200            0.0048184385   0.001428357    0              0.013026958    1.3299725e-19  0              2.5687844e-14  0              0              2.9954204    
   3000000   2880           200            200            0.0048184385   0.001428357    0              0.013026958    1.2887108e-18  0              2.4890892e-13  0              0              2.9954204    
Loop time of 182.242 on 2 procs for 3000000 steps with 1251 atoms

Performance: 14222852.467 ns/day, 0.000 hours/ns, 16461.635 timesteps/s
99.9% CPU use with 2 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 40.638     | 40.644     | 40.651     |   0.1 | 22.30
Neigh   | 3.6156     | 3.6157     | 3.6157     |   0.0 |  1.98
Comm    | 15.172     | 15.284     | 15.397     |   2.9 |  8.39
Output  | 0.21268    | 0.21271    | 0.21274    |   0.0 |  0.12
Modify  | 109.07     | 109.2      | 109.32     |   1.2 | 59.92
Other   |            | 13.29      |            |       |  7.29

Nlocal:          625.5 ave         626 max         625 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Nghost:            2.5 ave           3 max           2 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Neighs:          351.5 ave         352 max         351 min
Histogram: 1 0 0 0 0 0 0 0 0 1

Total # of neighbors = 703
Ave neighs/atom = 0.56195044
Neighbor list builds = 164
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 85

#variable lat0 equal 1                    #
variable lat1 equal 3+(v_ind*0.01)        # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 250*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 3.85                                                               
Lattice spacing in x,y,z = 3.85 3.85 3.85

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -1443.75 ${n1e1} -100 100 -100 100 units box
region box block -1443.75 1443.75 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -1443.75 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -1443.75 1443.75 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-1443.75 -100 -100) to (1443.75 100 100)
  2 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 750 atoms
  using lattice units in orthogonal box = (-1443.75 -100 -100) to (1443.75 100 100)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -750 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -750 750 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 501 atoms
  using lattice units in orthogonal box = (-1443.75 -100 -100) to (1443.75 100 100)
  create_atoms CPU = 0.000 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  750 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  750 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  501 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  501 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
750 atoms in group substrate
group slider1 region slider1
501 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 501 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_85_*.dump id type diameter mass xu yu zu fx fy fz

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 1863 130 130
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 77.99 | 77.99 | 77.99 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   2887.5         200            200            0              0              0              0              0              0              0              0              0              6            
    100000   2887.5         200            200            0.0035241053   7.2228788e-43  0              0.010572316    292775.06      0              5.654824e+10   0              0              3.3268865    
    200000   2887.5         200            200            0.0012441642  -2.4041474e-36  0              0.0037324927   70954.24       0              1.3704505e+10  0              0              3.0752457    
    300000   2887.5         200            200            8.1446959e-05 -1.3113529e-36  0              0.00024434088  629.96695      0              1.216754e+08   0              0              3.045862     
    400000   2887.5         200            200            0.00078960863 -5.8255591e-05  0              0.0024270815   4493.4557      0              8.6789158e+08  0              0              2.998369     
    500000   2887.5         200            200            0.0092379561  -0.0027499451   0              0.030463813    48.967437      0              9457849.1      0              0              2.9931523    
    600000   2887.5         200            200            0.0030628347  -0.0019432342   0              0.011131738    98.971171      0              19115855       0              0              2.9959043    
    700000   2887.5         200            200            0.0041521046  -0.0022319151   0              0.014688229    6.1414547      0              1186195.5      0              0              2.995287     
    800000   2887.5         200            200            0.0037036186  -0.0022591129   0              0.013369969    1.5404973      0              297540.4       0              0              2.9954961    
    900000   2887.5         200            200            0.0034874397  -0.0022538811   0              0.0127162      0.020334616    0              3927.5433      0              0              2.9956078    
   1000000   2887.5         200            200            0.0035772276  -0.0022590466   0              0.012990729    0.036602643    0              7069.6426      0              0              2.9955618    
   1100000   2887.5         200            200            0.0035906569  -0.0022598744   0              0.013031845    0.00021308395  0              41.156246      0              0              2.9955545    
   1200000   2887.5         200            200            0.0035761085  -0.0022590205   0              0.012987346    0.0005402193   0              104.34103      0              0              2.995562     
   1300000   2887.5         200            200            0.0035768872  -0.0022590608   0              0.012989722    3.7249489e-05  0              7.194578       0              0              2.9955616    
   1400000   2887.5         200            200            0.0035787128  -0.0022591688   0              0.012995307    4.2186608e-06  0              0.81481613     0              0              2.9955607    
   1500000   2887.5         200            200            0.0035782831  -0.0022591442   0              0.012993993    1.4149244e-06  0              0.27328654     0              0              2.9955609    
   1600000   2887.5         200            200            0.0035781129  -0.002259134    0              0.012993473    4.3388809e-09  0              0.00083803611  0              0              2.995561     
   1700000   2887.5         200            200            0.0035782012  -0.0022591391   0              0.012993743    2.9706914e-08  0              0.0057377622   0              0              2.995561     
   1800000   2887.5         200            200            0.0035782085  -0.0022591396   0              0.012993765    4.7311055e-10  0              9.1379262e-05  0              0              2.995561     
   1900000   2887.5         200            200            0.0035781953  -0.0022591388   0              0.012993725    3.7671709e-10  0              7.2761279e-05  0              0              2.995561     
   2000000   2887.5         200            200            0.0035781966  -0.0022591389   0              0.012993729    4.0810499e-11  0              7.8823717e-06  0              0              2.995561     
   2100000   2887.5         200            200            0.0035781982  -0.0022591389   0              0.012993734    2.205641e-12   0              4.2601004e-07  0              0              2.995561     
   2200000   2887.5         200            200            0.0035781977  -0.0022591389   0              0.012993732    1.268909e-12   0              2.4508429e-07  0              0              2.995561     
   2300000   2887.5         200            200            0.0035781976  -0.0022591389   0              0.012993732    3.873302e-19   0              7.4811156e-14  0              0              2.995561     
   2400000   2887.5         200            200            0.0035781977  -0.0022591389   0              0.012993732    2.3128536e-14  0              4.467177e-09   0              0              2.995561     
   2500000   2887.5         200            200            0.0035781977  -0.0022591389   0              0.012993732    7.0633922e-16  0              1.3642637e-10  0              0              2.995561     
   2600000   2887.5         200            200            0.0035781977  -0.0022591389   0              0.012993732    2.5703264e-16  0              4.9644744e-11  0              0              2.995561     
   2700000   2887.5         200            200            0.0035781977  -0.0022591389   0              0.012993732    3.3499086e-17  0              6.4702038e-12  0              0              2.995561     
   2800000   2887.5         200            200            0.0035781977  -0.0022591389   0              0.012993732    1.3155309e-18  0              2.5408911e-13  0              0              2.995561     
   2900000   2887.5         200            200            0.0035781977  -0.0022591389   0              0.012993732    1.2810114e-18  0              2.4742183e-13  0              0              2.995561     
   3000000   2887.5         200            200            0.0035781977  -0.0022591389   0              0.012993732    4.4647389e-19  0              8.6234505e-14  0              0              2.995561     
Loop time of 180.875 on 2 procs for 3000000 steps with 1251 atoms

Performance: 14330368.959 ns/day, 0.000 hours/ns, 16586.075 timesteps/s
99.9% CPU use with 2 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 40.281     | 40.474     | 40.668     |   3.0 | 22.38
Neigh   | 3.6268     | 3.6271     | 3.6274     |   0.0 |  2.01
Comm    | 14.939     | 14.957     | 14.975     |   0.5 |  8.27
Output  | 0.21451    | 0.21453    | 0.21456    |   0.0 |  0.12
Modify  | 108.78     | 108.88     | 108.99     |   1.0 | 60.20
Other   |            | 12.72      |            |       |  7.03

Nlocal:          625.5 ave         626 max         625 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Nghost:            2.5 ave           3 max           2 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Neighs:          350.5 ave         351 max         350 min
Histogram: 1 0 0 0 0 0 0 0 0 1

Total # of neighbors = 701
Ave neighs/atom = 0.56035172
Neighbor list builds = 164
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 86

#variable lat0 equal 1                    #
variable lat1 equal 3+(v_ind*0.01)        # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 250*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 3.86                                                               
Lattice spacing in x,y,z = 3.86 3.86 3.86

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -1447.5 ${n1e1} -100 100 -100 100 units box
region box block -1447.5 1447.5 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -1447.5 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -1447.5 1447.5 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-1447.5 -100 -100) to (1447.5 100 100)
  2 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 750 atoms
  using lattice units in orthogonal box = (-1447.5 -100 -100) to (1447.5 100 100)
  create_atoms CPU = 0.000 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -750 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -750 750 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 501 atoms
  using lattice units in orthogonal box = (-1447.5 -100 -100) to (1447.5 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  750 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  750 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  501 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  501 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
750 atoms in group substrate
group slider1 region slider1
501 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 501 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_86_*.dump id type diameter mass xu yu zu fx fy fz

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 1868 130 130
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 78.13 | 78.13 | 78.13 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   2895           200            200            0              0              0              0              0              0              0              0              0              6            
    100000   2895           200            200            0.0035140396   8.7197382e-37  0              0.010542119    292652.64      0              5.6524595e+10  0              0              3.327162     
    200000   2895           200            200            0.0012369512  -1.743938e-36   0              0.0037108535   70590.985      0              1.3634344e+10  0              0              3.0761171    
    300000   2895           200            200            7.4123643e-05 -2.6159095e-36  0              0.00022237093  528.45345      0              1.020685e+08   0              0              3.0461627    
    400000   2895           200            200            0.00043940972  2.2779602e-05  0              0.0012954495   4256.2037      0              8.2206739e+08  0              0              2.9990638    
    500000   2895           200            200            0.013538755    0.0097129093   0              0.030903356    28.696351      0              5542576.4      0              0              2.9932619    
    600000   2895           200            200            0.008338374    0.0063865573   0              0.018628565    18.642644      0              3600746.2      0              0              2.994834     
    700000   2895           200            200            0.0066974474   0.005872575    0              0.014219767    9.851714       0              1902816        0              0              2.9954947    
    800000   2895           200            200            0.0060935759   0.0058445781   0              0.012436149    1.1146199      0              215284.02      0              0              2.9957969    
    900000   2895           200            200            0.0061904174   0.005866166    0              0.012705086    0.053230939    0              10281.326      0              0              2.9957522    
   1000000   2895           200            200            0.0062903869   0.0058876618   0              0.012983499    0.035265161    0              6811.3137      0              0              2.9957044    
   1100000   2895           200            200            0.0062961621   0.0058888909   0              0.012999596    6.6437913e-08  0              0.012832196    0              0              2.9957013    
   1200000   2895           200            200            0.0062833021   0.005886296    0              0.01296361     0.000641454    0              123.89407      0              0              2.9957074    
   1300000   2895           200            200            0.0062805302   0.0058856885   0              0.012955902    1.5245538e-05  0              2.94461        0              0              2.9957088    
   1400000   2895           200            200            0.0062818486   0.005885966    0              0.01295958     7.9785321e-06  0              1.541019       0              0              2.9957082    
   1500000   2895           200            200            0.0062824243   0.0058860905   0              0.012961183    9.1808884e-07  0              0.1773249      0              0              2.9957079    
   1600000   2895           200            200            0.006282334    0.005886072    0              0.01296093     5.5395556e-08  0              0.010699413    0              0              2.9957079    
   1700000   2895           200            200            0.0062822425   0.0058860523   0              0.012960675    2.7322787e-08  0              0.0052772784   0              0              2.995708     
   1800000   2895           200            200            0.0062822408   0.0058860518   0              0.01296067     4.3270559e-11  0              8.3575218e-06  0              0              2.995708     
   1900000   2895           200            200            0.0062822529   0.0058860544   0              0.012960704    5.4415142e-10  0              0.0001051005   0              0              2.995708     
   2000000   2895           200            200            0.0062822549   0.0058860549   0              0.01296071     7.122228e-12   0              1.3756276e-06  0              0              2.995708     
   2100000   2895           200            200            0.0062822536   0.0058860546   0              0.012960706    7.5268206e-12  0              1.4537729e-06  0              0              2.995708     
   2200000   2895           200            200            0.0062822531   0.0058860545   0              0.012960705    6.0596655e-13  0              1.1703982e-07  0              0              2.995708     
   2300000   2895           200            200            0.0062822532   0.0058860545   0              0.012960705    6.3461543e-14  0              1.2257323e-08  0              0              2.995708     
   2400000   2895           200            200            0.0062822533   0.0058860545   0              0.012960705    2.0680311e-14  0              3.9943128e-09  0              0              2.995708     
   2500000   2895           200            200            0.0062822533   0.0058860545   0              0.012960705    1.2619079e-16  0              2.4373207e-11  0              0              2.995708     
   2600000   2895           200            200            0.0062822533   0.0058860545   0              0.012960705    4.5320863e-16  0              8.7535292e-11  0              0              2.995708     
   2700000   2895           200            200            0.0062822533   0.0058860545   0              0.012960705    7.2704476e-18  0              1.4042556e-12  0              0              2.995708     
   2800000   2895           200            200            0.0062822533   0.0058860545   0              0.012960705    4.4318323e-18  0              8.5598928e-13  0              0              2.995708     
   2900000   2895           200            200            0.0062822533   0.0058860545   0              0.012960705    9.9862335e-19  0              1.9287979e-13  0              0              2.995708     
   3000000   2895           200            200            0.0062822533   0.0058860545   0              0.012960705    3.2500753e-18  0              6.2773802e-13  0              0              2.995708     
Loop time of 181.778 on 2 procs for 3000000 steps with 1251 atoms

Performance: 14259164.944 ns/day, 0.000 hours/ns, 16503.663 timesteps/s
99.9% CPU use with 2 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 40.563     | 40.59      | 40.617     |   0.4 | 22.33
Neigh   | 3.6248     | 3.6251     | 3.6254     |   0.0 |  1.99
Comm    | 15.159     | 15.298     | 15.436     |   3.5 |  8.42
Output  | 0.21215    | 0.21217    | 0.2122     |   0.0 |  0.12
Modify  | 108.99     | 109.06     | 109.14     |   0.7 | 60.00
Other   |            | 12.99      |            |       |  7.15

Nlocal:          625.5 ave         626 max         625 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Nghost:            2.5 ave           3 max           2 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Neighs:          350.5 ave         351 max         350 min
Histogram: 1 0 0 0 0 0 0 0 0 1

Total # of neighbors = 701
Ave neighs/atom = 0.56035172
Neighbor list builds = 164
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 87

#variable lat0 equal 1                    #
variable lat1 equal 3+(v_ind*0.01)        # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 250*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 3.87                                                               
Lattice spacing in x,y,z = 3.87 3.87 3.87

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -1451.25 ${n1e1} -100 100 -100 100 units box
region box block -1451.25 1451.25 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -1451.25 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -1451.25 1451.25 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-1451.25 -100 -100) to (1451.25 100 100)
  2 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 750 atoms
  using lattice units in orthogonal box = (-1451.25 -100 -100) to (1451.25 100 100)
  create_atoms CPU = 0.000 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -750 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -750 750 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 501 atoms
  using lattice units in orthogonal box = (-1451.25 -100 -100) to (1451.25 100 100)
  create_atoms CPU = 0.000 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  750 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  750 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  501 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  501 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
750 atoms in group substrate
group slider1 region slider1
501 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 501 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_87_*.dump id type diameter mass xu yu zu fx fy fz

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 1873 130 130
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 78.34 | 78.34 | 78.34 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   2902.5         200            200            0              0              0              0              0              0              0              0              0              6            
    100000   2902.5         200            200            0.0035059945   4.3485878e-37  0              0.010517984    292792.3       0              5.655157e+10   0              0              3.3267935    
    200000   2902.5         200            200            0.0012398104   1.2058366e-41  0              0.0037194311   71146.947      0              1.3741726e+10  0              0              3.0746629    
    300000   2902.5         200            200            8.4974852e-05  6.957754e-36   0              0.00025492455  690.05374      0              1.332809e+08   0              0              3.0455652    
    400000   2902.5         200            200            0.00092760931 -0.00036285738  0              0.0031456853   4566.2516      0              8.819518e+08   0              0              2.9979731    
    500000   2902.5         200            200            0.0072325669  -0.0044313118   0              0.026129012    346.15375      0              66858103       0              0              2.9934729    
    600000   2902.5         200            200            0.0017143211  -0.0028029497   0              0.0079459129   10.512885      0              2030518.4      0              0              2.9963603    
    700000   2902.5         200            200            0.0031756793  -0.0026773017   0              0.01220434     12.934095      0              2498164.5      0              0              2.9955048    
    800000   2902.5         200            200            0.0034588607  -0.0027019337   0              0.013078516    1.8832794      0              363747.3       0              0              2.995353     
    900000   2902.5         200            200            0.0034684022  -0.002702545    0              0.013107752    0.15117496     0              29198.792      0              0              2.9953495    
   1000000   2902.5         200            200            0.0034406253  -0.0026998138   0              0.01302169     0.0043927503   0              848.44076      0              0              2.9953651    
   1100000   2902.5         200            200            0.0034217398  -0.0026979836   0              0.012963203    9.0877973e-05  0              17.552688      0              0              2.9953755    
   1200000   2902.5         200            200            0.0034132971  -0.0026971698   0              0.012937061    0.00022826622  0              44.088635      0              0              2.9953801    
   1300000   2902.5         200            200            0.0034103836  -0.0026968909   0              0.012928042    7.2070752e-05  0              13.920155      0              0              2.9953817    
   1400000   2902.5         200            200            0.0034096379  -0.0026968205   0              0.012925734    1.192695e-05   0              2.3036389      0              0              2.9953821    
   1500000   2902.5         200            200            0.0034095488  -0.0026968127   0              0.012925459    1.1846325e-06  0              0.22880666     0              0              2.9953821    
   1600000   2902.5         200            200            0.0034095918  -0.0026968171   0              0.012925592    5.6610944e-08  0              0.010934159    0              0              2.9953821    
   1700000   2902.5         200            200            0.0034096317  -0.002696821    0              0.012925716    4.8660151e-11  0              9.3984981e-06  0              0              2.995382     
   1800000   2902.5         200            200            0.0034096517  -0.0026968229   0              0.012925778    7.6293702e-10  0              0.00014735799  0              0              2.995382     
   1900000   2902.5         200            200            0.0034096592  -0.0026968237   0              0.012925801    3.5409254e-10  0              6.8391446e-05  0              0              2.995382     
   2000000   2902.5         200            200            0.0034096614  -0.0026968239   0              0.012925808    7.1354898e-11  0              1.3781891e-05  0              0              2.995382     
   2100000   2902.5         200            200            0.0034096618  -0.0026968239   0              0.012925809    8.557533e-12   0              1.6528506e-06  0              0              2.995382     
   2200000   2902.5         200            200            0.0034096618  -0.0026968239   0              0.012925809    5.6600462e-13  0              1.0932135e-07  0              0              2.995382     
   2300000   2902.5         200            200            0.0034096617  -0.0026968239   0              0.012925809    8.3288712e-15  0              1.6086855e-09  0              0              2.995382     
   2400000   2902.5         200            200            0.0034096617  -0.0026968239   0              0.012925809    1.7764119e-15  0              3.4310629e-10  0              0              2.995382     
   2500000   2902.5         200            200            0.0034096616  -0.0026968239   0              0.012925809    1.5323712e-15  0              2.9597088e-10  0              0              2.995382     
   2600000   2902.5         200            200            0.0034096616  -0.0026968239   0              0.012925809    3.9806346e-16  0              7.688424e-11   0              0              2.995382     
   2700000   2902.5         200            200            0.0034096616  -0.0026968239   0              0.012925809    5.4708072e-17  0              1.0566628e-11  0              0              2.995382     
   2800000   2902.5         200            200            0.0034096616  -0.0026968239   0              0.012925809    4.3804969e-18  0              8.4607408e-13  0              0              2.995382     
   2900000   2902.5         200            200            0.0034096616  -0.0026968239   0              0.012925809    1.6916862e-18  0              3.267419e-13   0              0              2.995382     
   3000000   2902.5         200            200            0.0034096616  -0.0026968239   0              0.012925809    5.0478212e-19  0              9.7496488e-14  0              0              2.995382     
Loop time of 180.622 on 2 procs for 3000000 steps with 1251 atoms

Performance: 14350409.646 ns/day, 0.000 hours/ns, 16609.270 timesteps/s
99.9% CPU use with 2 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 40.258     | 40.399     | 40.54      |   2.2 | 22.37
Neigh   | 3.6514     | 3.6514     | 3.6515     |   0.0 |  2.02
Comm    | 14.981     | 15.007     | 15.032     |   0.7 |  8.31
Output  | 0.21473    | 0.21476    | 0.21479    |   0.0 |  0.12
Modify  | 108.52     | 108.65     | 108.77     |   1.2 | 60.15
Other   |            | 12.7       |            |       |  7.03

Nlocal:          625.5 ave         626 max         625 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Nghost:            2.5 ave           3 max           2 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Neighs:          353.5 ave         354 max         353 min
Histogram: 1 0 0 0 0 0 0 0 0 1

Total # of neighbors = 707
Ave neighs/atom = 0.56514788
Neighbor list builds = 164
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 88

#variable lat0 equal 1                    #
variable lat1 equal 3+(v_ind*0.01)        # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 250*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 3.88                                                               
Lattice spacing in x,y,z = 3.88 3.88 3.88

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -1455 ${n1e1} -100 100 -100 100 units box
region box block -1455 1455 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -1455 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -1455 1455 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-1455 -100 -100) to (1455 100 100)
  2 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 750 atoms
  using lattice units in orthogonal box = (-1455 -100 -100) to (1455 100 100)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -750 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -750 750 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 501 atoms
  using lattice units in orthogonal box = (-1455 -100 -100) to (1455 100 100)
  create_atoms CPU = 0.000 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  750 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  750 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  501 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  501 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
750 atoms in group substrate
group slider1 region slider1
501 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 501 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_88_*.dump id type diameter mass xu yu zu fx fy fz

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 1878 130 130
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 78.48 | 78.48 | 78.48 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   2910           200            200            0              0              0              0              0              0              0              0              0              6            
    100000   2910           200            200            0.0034961368   4.3373821e-37  0              0.01048841     292686.5       0              5.6531134e+10  0              0              3.3270004    
    200000   2910           200            200            0.0012337059   2.1686903e-37  0              0.0037011177   70881.635      0              1.3690482e+10  0              0              3.0752501    
    300000   2910           200            200            8.0231149e-05  8.6747771e-37  0              0.00024069345  621.31118      0              1.2000357e+08  0              0              3.045718     
    400000   2910           200            200            0.000618561   -3.7243389e-05  0              0.0018929264   4342.3343      0              8.3870313e+08  0              0              2.9985738    
    500000   2910           200            200            0.010207396    0.0046016246   0              0.026020565    346.60474      0              66945210       0              0              2.9935365    
    600000   2910           200            200            0.0028017007   0.00067632582  0              0.0077287764   0.39108376     0              75536.141      0              0              2.9964776    
    700000   2910           200            200            0.0043704193   0.0016097728   0              0.011501485    7.9829041      0              1541863.5      0              0              2.9956823    
    800000   2910           200            200            0.0046941336   0.0016808743   0              0.012401527    1.1743281      0              226816.4       0              0              2.9955199    
    900000   2910           200            200            0.004796844    0.0017033455   0              0.012687187    0.12520406     0              24182.624      0              0              2.9954703    
   1000000   2910           200            200            0.0048387673   0.0017087373   0              0.012807565    0.011693364    0              2258.5227      0              0              2.9954496    
   1100000   2910           200            200            0.004856595    0.001711247    0              0.012858538    0.00093533176  0              180.65529      0              0              2.9954407    
   1200000   2910           200            200            0.0048638853   0.0017122666   0              0.012879389    5.7691979e-05  0              11.142957      0              0              2.9954371    
   1300000   2910           200            200            0.0048667748   0.0017126703   0              0.012887654    1.9193066e-06  0              0.37070579     0              0              2.9954357    
   1400000   2910           200            200            0.0048678892   0.0017128261   0              0.012890842    3.8566576e-10  0              7.4489677e-05  0              0              2.9954352    
   1500000   2910           200            200            0.0048683085   0.0017128849   0              0.012892041    4.0557508e-08  0              0.0078335076   0              0              2.9954349    
   1600000   2910           200            200            0.0048684625   0.0017129065   0              0.012892481    2.0632328e-08  0              0.0039850451   0              0              2.9954349    
   1700000   2910           200            200            0.0048685178   0.0017129143   0              0.012892639    5.9508044e-09  0              0.0011493722   0              0              2.9954348    
   1800000   2910           200            200            0.0048685371   0.001712917    0              0.012892694    1.3422135e-09  0              0.00025924275  0              0              2.9954348    
   1900000   2910           200            200            0.0048685437   0.001712918    0              0.012892713    2.6224896e-10  0              5.0652256e-05  0              0              2.9954348    
   2000000   2910           200            200            0.0048685459   0.0017129183   0              0.012892719    4.6450864e-11  0              8.9717839e-06  0              0              2.9954348    
   2100000   2910           200            200            0.0048685465   0.0017129184   0              0.012892721    7.6351344e-12  0              1.4746933e-06  0              0              2.9954348    
   2200000   2910           200            200            0.0048685468   0.0017129184   0              0.012892722    1.1814724e-12  0              2.2819629e-07  0              0              2.9954348    
   2300000   2910           200            200            0.0048685468   0.0017129184   0              0.012892722    1.7345367e-13  0              3.3501828e-08  0              0              2.9954348    
   2400000   2910           200            200            0.0048685468   0.0017129184   0              0.012892722    2.4245985e-14  0              4.6830073e-09  0              0              2.9954348    
   2500000   2910           200            200            0.0048685468   0.0017129184   0              0.012892722    3.2201877e-15  0              6.2196536e-10  0              0              2.9954348    
   2600000   2910           200            200            0.0048685468   0.0017129184   0              0.012892722    4.1145576e-16  0              7.9470904e-11  0              0              2.9954348    
   2700000   2910           200            200            0.0048685468   0.0017129184   0              0.012892722    5.4054127e-17  0              1.0440321e-11  0              0              2.9954348    
   2800000   2910           200            200            0.0048685468   0.0017129184   0              0.012892722    6.3923597e-18  0              1.2346567e-12  0              0              2.9954348    
   2900000   2910           200            200            0.0048685468   0.0017129184   0              0.012892722    7.5960103e-19  0              1.4671366e-13  0              0              2.9954348    
   3000000   2910           200            200            0.0048685468   0.0017129184   0              0.012892722    2.8318188e-18  0              5.4695358e-13  0              0              2.9954348    
Loop time of 181.173 on 2 procs for 3000000 steps with 1251 atoms

Performance: 14306728.524 ns/day, 0.000 hours/ns, 16558.714 timesteps/s
99.9% CPU use with 2 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 40.752     | 40.86      | 40.968     |   1.7 | 22.55
Neigh   | 3.6374     | 3.6377     | 3.6379     |   0.0 |  2.01
Comm    | 14.339     | 14.37      | 14.4       |   0.8 |  7.93
Output  | 0.2145     | 0.21453    | 0.21455    |   0.0 |  0.12
Modify  | 109.08     | 109.21     | 109.35     |   1.3 | 60.28
Other   |            | 12.88      |            |       |  7.11

Nlocal:          625.5 ave         626 max         625 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Nghost:            2.5 ave           3 max           2 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Neighs:          349.5 ave         350 max         349 min
Histogram: 1 0 0 0 0 0 0 0 0 1

Total # of neighbors = 699
Ave neighs/atom = 0.558753
Neighbor list builds = 164
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 89

#variable lat0 equal 1                    #
variable lat1 equal 3+(v_ind*0.01)        # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 250*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 3.89                                                               
Lattice spacing in x,y,z = 3.89 3.89 3.89

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -1458.75 ${n1e1} -100 100 -100 100 units box
region box block -1458.75 1458.75 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -1458.75 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -1458.75 1458.75 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-1458.75 -100 -100) to (1458.75 100 100)
  2 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 750 atoms
  using lattice units in orthogonal box = (-1458.75 -100 -100) to (1458.75 100 100)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -750 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -750 750 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 501 atoms
  using lattice units in orthogonal box = (-1458.75 -100 -100) to (1458.75 100 100)
  create_atoms CPU = 0.000 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  750 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  750 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  501 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  501 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
750 atoms in group substrate
group slider1 region slider1
501 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 501 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_89_*.dump id type diameter mass xu yu zu fx fy fz

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 1883 130 130
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 78.69 | 78.69 | 78.69 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   2917.5         200            200            0              0              0              0              0              0              0              0              0              6            
    100000   2917.5         200            200            0.0034876809   7.1933478e-47  0              0.010463043    292754.86      0              5.6544338e+10  0              0              3.3268705    
    200000   2917.5         200            200            0.0012323918  -2.1631141e-37  0              0.0036971755   71051.398      0              1.3723271e+10  0              0              3.0748759    
    300000   2917.5         200            200            8.2657337e-05 -8.6524498e-37  0              0.00024797201  661.00598      0              1.2767045e+08  0              0              3.0456326    
    400000   2917.5         200            200            0.0008680893   0.0001133411   0              0.0024909268   4452.0463      0              8.5989354e+08  0              0              2.9982839    
    500000   2917.5         200            200            0.0067868621  -0.0042707562   0              0.024631343    427.83499      0              82634482       0              0              2.9936723    
    600000   2917.5         200            200            0.0026772617  -0.00024761571  0              0.008279401    26.160206      0              5052730.9      0              0              2.9963052    
    700000   2917.5         200            200            0.0038153296  -0.0016988692   0              0.013144858    14.319763      0              2765800.4      0              0              2.9953526    
    800000   2917.5         200            200            0.0039739892  -0.0016043646   0              0.013526332    0.43435774     0              83894.323      0              0              2.9952907    
    900000   2917.5         200            200            0.0038364976  -0.0016089142   0              0.013118407    0.035757369    0              6906.3816      0              0              2.9953636    
   1000000   2917.5         200            200            0.003764871   -0.0015999507   0              0.012894564    0.031800969    0              6142.22        0              0              2.9954033    
   1100000   2917.5         200            200            0.0037478991  -0.0015979516   0              0.012841649    0.0037084172   0              716.26478      0              0              2.9954125    
   1200000   2917.5         200            200            0.0037493129  -0.0015981434   0              0.012846082    2.9815872e-05  0              5.7588069      0              0              2.9954116    
   1300000   2917.5         200            200            0.0037522915  -0.0015985073   0              0.012855382    3.1112209e-05  0              6.0091889      0              0              2.9954099    
   1400000   2917.5         200            200            0.0037535457  -0.0015986578   0              0.012859295    1.1852598e-05  0              2.2892782      0              0              2.9954092    
   1500000   2917.5         200            200            0.0037537517  -0.0015986816   0              0.012859937    8.394586e-07   0              0.16213781     0              0              2.9954091    
   1600000   2917.5         200            200            0.0037536821  -0.0015986729   0              0.012859719    4.2693324e-10  0              8.2460314e-05  0              0              2.9954092    
   1700000   2917.5         200            200            0.0037536205  -0.0015986654   0              0.012859527    1.7893865e-08  0              0.0034561228   0              0              2.9954092    
   1800000   2917.5         200            200            0.0037536001  -0.001598663    0              0.012859463    3.8541257e-09  0              0.00074440775  0              0              2.9954092    
   1900000   2917.5         200            200            0.0037535985  -0.0015986628   0              0.012859458    1.4494522e-10  0              2.7995544e-05  0              0              2.9954092    
   2000000   2917.5         200            200            0.0037536005  -0.0015986631   0              0.012859464    6.4835101e-12  0              1.252262e-06   0              0              2.9954092    
   2100000   2917.5         200            200            0.0037536017  -0.0015986632   0              0.012859468    8.1845514e-12  0              1.5808108e-06  0              0              2.9954092    
   2200000   2917.5         200            200            0.003753602   -0.0015986632   0              0.012859469    1.0889206e-12  0              2.1032032e-07  0              0              2.9954092    
   2300000   2917.5         200            200            0.0037536019  -0.0015986632   0              0.012859469    1.4224917e-14  0              2.7474814e-09  0              0              2.9954092    
   2400000   2917.5         200            200            0.0037536019  -0.0015986632   0              0.012859469    6.9144196e-15  0              1.3354903e-09  0              0              2.9954092    
   2500000   2917.5         200            200            0.0037536019  -0.0015986632   0              0.012859469    3.1742264e-15  0              6.1308813e-10  0              0              2.9954092    
   2600000   2917.5         200            200            0.0037536019  -0.0015986632   0              0.012859469    2.5889353e-16  0              5.0004168e-11  0              0              2.9954092    
   2700000   2917.5         200            200            0.0037536019  -0.0015986632   0              0.012859469    3.9555763e-19  0              7.640025e-14   0              0              2.9954092    
   2800000   2917.5         200            200            0.0037536019  -0.0015986632   0              0.012859469    4.7004841e-18  0              9.0787821e-13  0              0              2.9954092    
   2900000   2917.5         200            200            0.0037536019  -0.0015986632   0              0.012859469    3.8854593e-18  0              7.5045969e-13  0              0              2.9954092    
   3000000   2917.5         200            200            0.0037536019  -0.0015986632   0              0.012859469    2.7510564e-19  0              5.3135468e-14  0              0              2.9954092    
Loop time of 180.371 on 2 procs for 3000000 steps with 1251 atoms

Performance: 14370419.457 ns/day, 0.000 hours/ns, 16632.430 timesteps/s
99.9% CPU use with 2 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 40.337     | 40.428     | 40.52      |   1.4 | 22.41
Neigh   | 3.6813     | 3.6813     | 3.6813     |   0.0 |  2.04
Comm    | 14.449     | 14.462     | 14.474     |   0.3 |  8.02
Output  | 0.21303    | 0.21306    | 0.21308    |   0.0 |  0.12
Modify  | 108.84     | 108.86     | 108.87     |   0.1 | 60.35
Other   |            | 12.73      |            |       |  7.06

Nlocal:          625.5 ave         626 max         625 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Nghost:            2.5 ave           3 max           2 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Neighs:          351.5 ave         352 max         351 min
Histogram: 1 0 0 0 0 0 0 0 0 1

Total # of neighbors = 703
Ave neighs/atom = 0.56195044
Neighbor list builds = 164
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 90

#variable lat0 equal 1                    #
variable lat1 equal 3+(v_ind*0.01)        # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 250*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 3.9                                                               
Lattice spacing in x,y,z = 3.9 3.9 3.9

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -1462.5 ${n1e1} -100 100 -100 100 units box
region box block -1462.5 1462.5 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -1462.5 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -1462.5 1462.5 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-1462.5 -100 -100) to (1462.5 100 100)
  2 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 750 atoms
  using lattice units in orthogonal box = (-1462.5 -100 -100) to (1462.5 100 100)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -750 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -750 750 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 501 atoms
  using lattice units in orthogonal box = (-1462.5 -100 -100) to (1462.5 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  750 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  750 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  501 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  501 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
750 atoms in group substrate
group slider1 region slider1
501 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 501 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_90_*.dump id type diameter mass xu yu zu fx fy fz

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 1888 130 130
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 78.83 | 78.83 | 78.83 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   2925           200            200            0              0              0              0              0              0              0              0              0              6            
    100000   2925           200            200            0.0034794614  -3.4520823e-36  0              0.010438384    292858.88      0              5.6564429e+10  0              0              3.3265196    
    200000   2925           200            200            0.0012302913  -4.3151347e-37  0              0.003690874    71154.499      0              1.3743184e+10  0              0              3.0744063    
    300000   2925           200            200            3.646684e-05   1.550447e-43   0              0.00010940052  136.27419      0              26320773       0              0              3.0467936    
    400000   2925           200            200            7.471189e-05   5.3939216e-38  0              0.00022413567  560.35899      0              1.0823092e+08  0              0              3.0071206    
    500000   2925           200            200            0.00030810385 -2.1575683e-37  0              0.00092431156  65.060057      0              12566069       0              0              2.9994357    
    600000   2925           200            200            0.005536395    4.3151368e-37  0              0.016609185    64.534642      0              12464588       0              0              2.9958922    
    700000   2925           200            200            0.004902361   -1.5102978e-36  0              0.014707083    3.3742306      0              651718.08      0              0              2.9962261    
    800000   2925           200            200            0.0042639548   3.2363525e-37  0              0.012791864    2.0491992      0              395793.98      0              0              2.9965613    
    900000   2925           200            200            0.0041910026  -3.2363524e-37  0              0.012573008    0.041179281    0              7953.6004      0              0              2.9965987    
   1000000   2925           200            200            0.0042510525   2.1575683e-37  0              0.012753158    0.016367126    0              3161.2398      0              0              2.9965657    
   1100000   2925           200            200            0.0042803931   1.9860688e-46  0              0.012841179    0.0047099312   0              909.70289      0              0              2.99655      
   1200000   2925           200            200            0.0042817036  -2.1575683e-37  0              0.012845111    2.2897519e-05  0              4.422557       0              0              2.9965494    
   1300000   2925           200            200            0.0042781597  -1.0787841e-37  0              0.012834479    5.9743838e-05  0              11.539265      0              0              2.9965513    
   1400000   2925           200            200            0.0042768433   4.3151366e-37  0              0.01283053     9.8147085e-06  0              1.8956686      0              0              2.996552     
   1500000   2925           200            200            0.0042768984   1.0787841e-37  0              0.012830695    1.2985763e-09  0              0.0002508144   0              0              2.996552     
   1600000   2925           200            200            0.0042770939  -1.0787841e-37  0              0.012831282    1.8899198e-07  0              0.036502986    0              0              2.9965519    
   1700000   2925           200            200            0.0042771493   4.3151366e-37  0              0.012831448    1.822364e-08   0              0.0035198174   0              0              2.9965519    
   1800000   2925           200            200            0.0042771408  -1.0787841e-37  0              0.012831422    2.3368148e-10  0              4.5134569e-05  0              0              2.9965519    
   1900000   2925           200            200            0.0042771305   4.5149644e-47  0              0.012831392    5.35973e-10    0              0.00010352087  0              0              2.9965519    
   2000000   2925           200            200            0.0042771284   1.0787841e-37  0              0.012831385    2.8977503e-11  0              5.5968796e-06  0              0              2.9965519    
   2100000   2925           200            200            0.0042771291  -1.0787841e-37  0              0.012831387    1.946335e-12   0              3.7592621e-07  0              0              2.9965519    
   2200000   2925           200            200            0.0042771296  -3.2363524e-37  0              0.012831389    1.3833454e-12  0              2.6718719e-07  0              0              2.9965519    
   2300000   2925           200            200            0.0042771297   1.9044938e-47  0              0.012831389    3.5982663e-14  0              6.949896e-09   0              0              2.9965519    
   2400000   2925           200            200            0.0042771296   2.1575683e-37  0              0.012831389    9.5894029e-15  0              1.8521518e-09  0              0              2.9965519    
   2500000   2925           200            200            0.0042771296   2.1575683e-37  0              0.012831389    3.2583822e-15  0              6.2934246e-10  0              0              2.9965519    
   2600000   2925           200            200            0.0042771296  -3.2363524e-37  0              0.012831389    3.1082428e-17  0              6.0034368e-12  0              0              2.9965519    
   2700000   2925           200            200            0.0042771296   1.0787841e-37  0              0.012831389    4.5015217e-17  0              8.694495e-12   0              0              2.9965519    
   2800000   2925           200            200            0.0042771296  -1.0787841e-37  0              0.012831389    3.1953823e-18  0              6.171743e-13   0              0              2.9965519    
   2900000   2925           200            200            0.0042771296   8.0212419e-46  0              0.012831389    2.4898505e-18  0              4.8090388e-13  0              0              2.9965519    
   3000000   2925           200            200            0.0042771296   4.315137e-37   0              0.012831389    7.4280952e-19  0              1.4347045e-13  0              0              2.9965519    
Loop time of 180.363 on 2 procs for 3000000 steps with 1251 atoms

Performance: 14371018.956 ns/day, 0.000 hours/ns, 16633.124 timesteps/s
99.9% CPU use with 2 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 39.251     | 39.351     | 39.45      |   1.6 | 21.82
Neigh   | 3.6651     | 3.6654     | 3.6657     |   0.0 |  2.03
Comm    | 15.087     | 15.162     | 15.236     |   1.9 |  8.41
Output  | 0.21387    | 0.2139     | 0.21393    |   0.0 |  0.12
Modify  | 109.12     | 109.26     | 109.4      |   1.3 | 60.58
Other   |            | 12.72      |            |       |  7.05

Nlocal:          625.5 ave         626 max         625 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Nghost:            2.5 ave           3 max           2 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Neighs:          345.5 ave         346 max         345 min
Histogram: 1 0 0 0 0 0 0 0 0 1

Total # of neighbors = 691
Ave neighs/atom = 0.55235811
Neighbor list builds = 164
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 91

#variable lat0 equal 1                    #
variable lat1 equal 3+(v_ind*0.01)        # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 250*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 3.91                                                               
Lattice spacing in x,y,z = 3.91 3.91 3.91

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -1466.25 ${n1e1} -100 100 -100 100 units box
region box block -1466.25 1466.25 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -1466.25 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -1466.25 1466.25 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-1466.25 -100 -100) to (1466.25 100 100)
  2 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 750 atoms
  using lattice units in orthogonal box = (-1466.25 -100 -100) to (1466.25 100 100)
  create_atoms CPU = 0.000 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -750 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -750 750 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 501 atoms
  using lattice units in orthogonal box = (-1466.25 -100 -100) to (1466.25 100 100)
  create_atoms CPU = 0.000 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  750 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  750 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  501 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  501 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
750 atoms in group substrate
group slider1 region slider1
501 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 501 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_91_*.dump id type diameter mass xu yu zu fx fy fz

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 1892 130 130
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 78.96 | 78.96 | 78.96 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   2932.5         200            200            0              0              0              0              0              0              0              0              0              6            
    100000   2932.5         200            200            0.0034696164   7.8402569e-43  0              0.010408849    292726.89      0              5.6538935e+10  0              0              3.3269084    
    200000   2932.5         200            200            0.0012255163   3.0683346e-43  0              0.0036765489   70999.656      0              1.3713277e+10  0              0              3.0749575    
    300000   2932.5         200            200            8.1087165e-05 -1.7216397e-36  0              0.0002432615   643.48874      0              1.2428707e+08  0              0              3.0456401    
    400000   2932.5         200            200            0.00069396075  0.0001120965   0              0.0019697857   4338.1268      0              8.3789048e+08  0              0              2.9985396    
    500000   2932.5         200            200            0.0086185654   0.0035390859   0              0.02231661     545.48472      0              1.0535802e+08  0              0              2.9939592    
    600000   2932.5         200            200            0.0038672207   0.002770251    0              0.0088314112   48.271353      0              9323403.6      0              0              2.9961704    
    700000   2932.5         200            200            0.0054834887   0.0029113704   0              0.013539096    12.639939      0              2441349.8      0              0              2.9952719    
    800000   2932.5         200            200            0.0054521551   0.0028338766   0              0.013522589    0.12790909     0              24705.089      0              0              2.9952798    
    900000   2932.5         200            200            0.0052673995   0.0027803281   0              0.01302187     0.086114337    0              16632.613      0              0              2.995369     
   1000000   2932.5         200            200            0.0051924903   0.0027713764   0              0.012806095    0.035417162    0              6840.6721      0              0              2.9954073    
   1100000   2932.5         200            200            0.0051795512   0.0027696505   0              0.012769003    0.0026668435   0              515.08931      0              0              2.9954137    
   1200000   2932.5         200            200            0.0051834135   0.0027702079   0              0.012780033    1.3253255e-07  0              0.02559809     0              0              2.9954117    
   1300000   2932.5         200            200            0.0051870372   0.0027707108   0              0.012790401    5.1166909e-05  0              9.8826676      0              0              2.9954098    
   1400000   2932.5         200            200            0.0051882733   0.0027708793   0              0.012793941    1.1695995e-05  0              2.259031       0              0              2.9954092    
   1500000   2932.5         200            200            0.0051883834   0.0027708932   0              0.012794257    4.793973e-07   0              0.092593519    0              0              2.9954091    
   1600000   2932.5         200            200            0.0051882698   0.0027708773   0              0.012793932    1.5908525e-08  0              0.0030726629   0              0              2.9954092    
   1700000   2932.5         200            200            0.0051881998   0.0027708676   0              0.012793732    2.3926925e-08  0              0.0046213824   0              0              2.9954092    
   1800000   2932.5         200            200            0.0051881812   0.0027708651   0              0.012793679    3.3616736e-09  0              0.00064929274  0              0              2.9954092    
   1900000   2932.5         200            200            0.0051881817   0.0027708652   0              0.01279368     5.2215369e-11  0              1.0085173e-05  0              0              2.9954092    
   2000000   2932.5         200            200            0.0051881844   0.0027708656   0              0.012793688    1.8721389e-11  0              3.6159555e-06  0              0              2.9954092    
   2100000   2932.5         200            200            0.0051881857   0.0027708658   0              0.012793691    9.448797e-12   0              1.8249944e-06  0              0              2.9954092    
   2200000   2932.5         200            200            0.0051881859   0.0027708658   0              0.012793692    8.2195194e-13  0              1.5875647e-07  0              0              2.9954092    
   2300000   2932.5         200            200            0.0051881858   0.0027708658   0              0.012793692    5.8418432e-16  0              1.1283268e-10  0              0              2.9954092    
   2400000   2932.5         200            200            0.0051881858   0.0027708658   0              0.012793692    1.227783e-14   0              2.3714098e-09  0              0              2.9954092    
   2500000   2932.5         200            200            0.0051881858   0.0027708658   0              0.012793692    3.2428457e-15  0              6.2634165e-10  0              0              2.9954092    
   2600000   2932.5         200            200            0.0051881858   0.0027708658   0              0.012793692    1.5636146e-16  0              3.0200542e-11  0              0              2.9954092    
   2700000   2932.5         200            200            0.0051881858   0.0027708658   0              0.012793692    6.2468568e-18  0              1.2065534e-12  0              0              2.9954092    
   2800000   2932.5         200            200            0.0051881858   0.0027708658   0              0.012793692    6.6868783e-18  0              1.2915417e-12  0              0              2.9954092    
   2900000   2932.5         200            200            0.0051881858   0.0027708658   0              0.012793692    4.8411213e-20  0              9.3504169e-15  0              0              2.9954092    
   3000000   2932.5         200            200            0.0051881858   0.0027708658   0              0.012793692    1.6977639e-18  0              3.2791577e-13  0              0              2.9954092    
Loop time of 181.316 on 2 procs for 3000000 steps with 1251 atoms

Performance: 14295455.102 ns/day, 0.000 hours/ns, 16545.666 timesteps/s
99.9% CPU use with 2 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 40.441     | 40.516     | 40.591     |   1.2 | 22.35
Neigh   | 3.6797     | 3.6804     | 3.6811     |   0.0 |  2.03
Comm    | 14.481     | 14.536     | 14.591     |   1.4 |  8.02
Output  | 0.21303    | 0.21306    | 0.21309    |   0.0 |  0.12
Modify  | 109.56     | 109.62     | 109.69     |   0.7 | 60.46
Other   |            | 12.75      |            |       |  7.03

Nlocal:          625.5 ave         626 max         625 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Nghost:            2.5 ave           3 max           2 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Neighs:          350.5 ave         351 max         350 min
Histogram: 1 0 0 0 0 0 0 0 0 1

Total # of neighbors = 701
Ave neighs/atom = 0.56035172
Neighbor list builds = 164
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 92

#variable lat0 equal 1                    #
variable lat1 equal 3+(v_ind*0.01)        # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 250*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 3.92                                                               
Lattice spacing in x,y,z = 3.92 3.92 3.92

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -1470 ${n1e1} -100 100 -100 100 units box
region box block -1470 1470 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -1470 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -1470 1470 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-1470 -100 -100) to (1470 100 100)
  2 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 750 atoms
  using lattice units in orthogonal box = (-1470 -100 -100) to (1470 100 100)
  create_atoms CPU = 0.000 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -750 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -750 750 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 501 atoms
  using lattice units in orthogonal box = (-1470 -100 -100) to (1470 100 100)
  create_atoms CPU = 0.000 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  750 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  750 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  501 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  501 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
750 atoms in group substrate
group slider1 region slider1
501 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 501 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_92_*.dump id type diameter mass xu yu zu fx fy fz

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 1897 130 130
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 79.17 | 79.17 | 79.17 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   2940           200            200            0              0              0              0              0              0              0              0              0              6            
    100000   2940           200            200            0.0034602409  -3.4344628e-36  0              0.010380723    292658.13      0              5.6525654e+10  0              0              3.3270505    
    200000   2940           200            200            0.0012210665  -1.2879354e-36  0              0.0036631996   70878.102      0              1.3689799e+10  0              0              3.0752123    
    300000   2940           200            200            7.9831813e-05  2.146562e-37   0              0.00023949544  627.62615      0              1.2122328e+08  0              0              3.0456547    
    400000   2940           200            200            0.00066325461 -0.00014947214  0              0.002139236    4383.069       0              8.4657086e+08  0              0              2.9984184    
    500000   2940           200            200            0.0076849262  -0.0022268461   0              0.025281625    377.94318      0              72998095       0              0              2.9935413    
    600000   2940           200            200            0.0015269134  -0.0030641242   0              0.0076448644   0.12354034     0              23861.284      0              0              2.9964162    
    700000   2940           200            200            0.0025558961  -0.003329643    0              0.010997331    3.4454815      0              665479.88      0              0              2.9956954    
    800000   2940           200            200            0.0029169478  -0.0032763841   0              0.012027228    0.094078853    0              18170.924      0              0              2.9955046    
    900000   2940           200            200            0.0030845805  -0.0032359974   0              0.012489739    0.0104443      0              2017.2715      0              0              2.9954221    
   1000000   2940           200            200            0.0031471254  -0.0032380205   0              0.012679397    0.012806229    0              2473.4679      0              0              2.9953886    
   1100000   2940           200            200            0.0031682093  -0.0032388477   0              0.012743476    0.0037894569   0              731.91725      0              0              2.9953772    
   1200000   2940           200            200            0.0031737551  -0.0032390791   0              0.012760344    0.00065638125  0              126.77721      0              0              2.9953742    
   1300000   2940           200            200            0.0031745903  -0.0032391158   0              0.012762887    7.5843467e-05  0              14.648838      0              0              2.9953737    
   1400000   2940           200            200            0.0031743962  -0.0032391085   0              0.012762297    5.4132342e-06  0              1.0455428      0              0              2.9953738    
   1500000   2940           200            200            0.0031741545  -0.0032390988   0              0.012761562    1.3678801e-07  0              0.026420014    0              0              2.9953739    
   1600000   2940           200            200            0.0031740201  -0.0032390933   0              0.012761154    4.6872656e-09  0              0.00090532513  0              0              2.995374     
   1700000   2940           200            200            0.0031739635  -0.003239091    0              0.012760981    9.1096234e-09  0              0.0017594845   0              0              2.995374     
   1800000   2940           200            200            0.003173944   -0.0032390901   0              0.012760922    2.9349752e-09  0              0.00056687779  0              0              2.995374     
   1900000   2940           200            200            0.0031739387  -0.0032390899   0              0.012760906    5.3402827e-10  0              0.00010314526  0              0              2.995374     
   2000000   2940           200            200            0.0031739378  -0.0032390899   0              0.012760903    6.4627209e-11  0              1.2482467e-05  0              0              2.995374     
   2100000   2940           200            200            0.0031739379  -0.0032390899   0              0.012760904    4.9324441e-12  0              9.5268029e-07  0              0              2.995374     
   2200000   2940           200            200            0.0031739381  -0.0032390899   0              0.012760904    1.521748e-13   0              2.9391905e-08  0              0              2.995374     
   2300000   2940           200            200            0.0031739382  -0.0032390899   0              0.012760905    1.6250809e-15  0              3.1387736e-10  0              0              2.995374     
   2400000   2940           200            200            0.0031739383  -0.0032390899   0              0.012760905    6.335309e-15   0              1.2236376e-09  0              0              2.995374     
   2500000   2940           200            200            0.0031739383  -0.0032390899   0              0.012760905    2.2343365e-15  0              4.3155245e-10  0              0              2.995374     
   2600000   2940           200            200            0.0031739383  -0.0032390899   0              0.012760905    4.3219855e-16  0              8.3477286e-11  0              0              2.995374     
   2700000   2940           200            200            0.0031739383  -0.0032390899   0              0.012760905    5.673043e-17   0              1.0957238e-11  0              0              2.995374     
   2800000   2940           200            200            0.0031739383  -0.0032390899   0              0.012760905    4.933677e-18   0              9.5291843e-13  0              0              2.995374     
   2900000   2940           200            200            0.0031739383  -0.0032390899   0              0.012760905    2.5460679e-18  0              4.9176203e-13  0              0              2.995374     
   3000000   2940           200            200            0.0031739383  -0.0032390899   0              0.012760905    1.7759525e-18  0              3.4301756e-13  0              0              2.995374     
Loop time of 182.47 on 2 procs for 3000000 steps with 1251 atoms

Performance: 14205060.750 ns/day, 0.000 hours/ns, 16441.043 timesteps/s
99.9% CPU use with 2 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 40.898     | 41.037     | 41.175     |   2.2 | 22.49
Neigh   | 3.6959     | 3.6966     | 3.6972     |   0.0 |  2.03
Comm    | 14.92      | 14.931     | 14.942     |   0.3 |  8.18
Output  | 0.21552    | 0.21554    | 0.21557    |   0.0 |  0.12
Modify  | 109.51     | 109.51     | 109.52     |   0.1 | 60.02
Other   |            | 13.08      |            |       |  7.17

Nlocal:          625.5 ave         626 max         625 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Nghost:            2.5 ave           3 max           2 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Neighs:          348.5 ave         349 max         348 min
Histogram: 1 0 0 0 0 0 0 0 0 1

Total # of neighbors = 697
Ave neighs/atom = 0.55715428
Neighbor list builds = 164
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 93

#variable lat0 equal 1                    #
variable lat1 equal 3+(v_ind*0.01)        # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 250*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 3.93                                                               
Lattice spacing in x,y,z = 3.93 3.93 3.93

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -1473.75 ${n1e1} -100 100 -100 100 units box
region box block -1473.75 1473.75 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -1473.75 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -1473.75 1473.75 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-1473.75 -100 -100) to (1473.75 100 100)
  2 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 750 atoms
  using lattice units in orthogonal box = (-1473.75 -100 -100) to (1473.75 100 100)
  create_atoms CPU = 0.000 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -750 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -750 750 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 501 atoms
  using lattice units in orthogonal box = (-1473.75 -100 -100) to (1473.75 100 100)
  create_atoms CPU = 0.000 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  750 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  750 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  501 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  501 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
750 atoms in group substrate
group slider1 region slider1
501 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 501 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_93_*.dump id type diameter mass xu yu zu fx fy fz

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 1902 130 130
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 79.31 | 79.31 | 79.31 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   2947.5         200            200            0              0              0              0              0              0              0              0              0              6            
    100000   2947.5         200            200            0.0034516501   1.0225041e-42  0              0.01035495     292689.03      0              5.6531622e+10  0              0              3.3269475    
    200000   2947.5         200            200            0.0012184526   2.1410991e-37  0              0.0036553579   70924.632      0              1.3698787e+10  0              0              3.0750686    
    300000   2947.5         200            200            7.8975055e-05  6.2925125e-45  0              0.00023692517  617.81047      0              1.1932743e+08  0              0              3.0456475    
    400000   2947.5         200            200            0.00053235458 -2.4614916e-05  0              0.0016216786   4254.7847      0              8.217933e+08   0              0              2.9987039    
    500000   2947.5         200            200            0.0076808661  -0.00075758303  0              0.023800181    464.20595      0              89659376       0              0              2.9937251    
    600000   2947.5         200            200            0.0020680277  -0.0018114489   0              0.0080155321   19.237311      0              3715603.5      0              0              2.9963133    
    700000   2947.5         200            200            0.0037043736  -0.0011461616   0              0.012259282    13.936339      0              2691743.7      0              0              2.9954606    
    800000   2947.5         200            200            0.0039378005  -0.001157047    0              0.012970449    1.7547055      0              338913.79      0              0              2.9953368    
    900000   2947.5         200            200            0.0039252357  -0.0011569436   0              0.012932651    0.11769602     0              22732.478      0              0              2.9953451    
   1000000   2947.5         200            200            0.0038899884  -0.0011567413   0              0.012826707    0.0018838162   0              363.85097      0              0              2.9953644    
   1100000   2947.5         200            200            0.0038692522  -0.0011566482   0              0.012764405    0.00032911743  0              63.567612      0              0              2.9953756    
   1200000   2947.5         200            200            0.0038606155  -0.0011566149   0              0.012738461    0.00030944023  0              59.767045      0              0              2.9953803    
   1300000   2947.5         200            200            0.0038578261  -0.001156605    0              0.012730083    7.9809584e-05  0              15.414877      0              0              2.9953818    
   1400000   2947.5         200            200            0.003857187   -0.0011566028   0              0.012728164    1.1599055e-05  0              2.2403075      0              0              2.9953821    
   1500000   2947.5         200            200            0.0038571501  -0.0011566026   0              0.012728053    9.9496368e-07  0              0.19217294     0              0              2.9953821    
   1600000   2947.5         200            200            0.0038572126  -0.0011566029   0              0.012728241    3.4425008e-08  0              0.0066490418   0              0              2.9953821    
   1700000   2947.5         200            200            0.003857258   -0.001156603    0              0.012728377    2.145759e-10   0              4.144441e-05   0              0              2.995382     
   1800000   2947.5         200            200            0.0038572789  -0.0011566031   0              0.01272844     1.1929686e-09  0              0.00023041673  0              0              2.995382     
   1900000   2947.5         200            200            0.0038572864  -0.0011566031   0              0.012728462    4.1509538e-10  0              8.0173881e-05  0              0              2.995382     
   2000000   2947.5         200            200            0.0038572883  -0.0011566031   0              0.012728468    7.2588784e-11  0              1.402021e-05   0              0              2.995382     
   2100000   2947.5         200            200            0.0038572886  -0.0011566032   0              0.012728469    7.629209e-12   0              1.4735488e-06  0              0              2.995382     
   2200000   2947.5         200            200            0.0038572885  -0.0011566032   0              0.012728469    4.052547e-13   0              7.8273196e-08  0              0              2.995382     
   2300000   2947.5         200            200            0.0038572884  -0.0011566031   0              0.012728468    1.4837137e-15  0              2.865729e-10   0              0              2.995382     
   2400000   2947.5         200            200            0.0038572884  -0.0011566031   0              0.012728468    3.7210991e-15  0              7.1871424e-10  0              0              2.995382     
   2500000   2947.5         200            200            0.0038572884  -0.0011566031   0              0.012728468    1.9537451e-15  0              3.7735744e-10  0              0              2.995382     
   2600000   2947.5         200            200            0.0038572883  -0.0011566031   0              0.012728468    4.2535103e-16  0              8.2154715e-11  0              0              2.995382     
   2700000   2947.5         200            200            0.0038572883  -0.0011566031   0              0.012728468    4.9979523e-17  0              9.6533292e-12  0              0              2.995382     
   2800000   2947.5         200            200            0.0038572883  -0.0011566031   0              0.012728468    2.5411408e-18  0              4.9081038e-13  0              0              2.995382     
   2900000   2947.5         200            200            0.0038572883  -0.0011566031   0              0.012728468    7.4110423e-19  0              1.4314108e-13  0              0              2.995382     
   3000000   2947.5         200            200            0.0038572883  -0.0011566031   0              0.012728468    1.7947578e-18  0              3.4664972e-13  0              0              2.995382     
Loop time of 180.505 on 2 procs for 3000000 steps with 1251 atoms

Performance: 14359698.407 ns/day, 0.000 hours/ns, 16620.021 timesteps/s
99.9% CPU use with 2 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 40.488     | 40.646     | 40.805     |   2.5 | 22.52
Neigh   | 3.7032     | 3.7038     | 3.7043     |   0.0 |  2.05
Comm    | 14.44      | 14.478     | 14.517     |   1.0 |  8.02
Output  | 0.21385    | 0.21387    | 0.2139     |   0.0 |  0.12
Modify  | 108.7      | 108.71     | 108.72     |   0.1 | 60.23
Other   |            | 12.75      |            |       |  7.06

Nlocal:          625.5 ave         626 max         625 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Nghost:            2.5 ave           3 max           2 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Neighs:          351.5 ave         352 max         351 min
Histogram: 1 0 0 0 0 0 0 0 0 1

Total # of neighbors = 703
Ave neighs/atom = 0.56195044
Neighbor list builds = 164
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 94

#variable lat0 equal 1                    #
variable lat1 equal 3+(v_ind*0.01)        # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 250*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 3.94                                                               
Lattice spacing in x,y,z = 3.94 3.94 3.94

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -1477.5 ${n1e1} -100 100 -100 100 units box
region box block -1477.5 1477.5 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -1477.5 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -1477.5 1477.5 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-1477.5 -100 -100) to (1477.5 100 100)
  2 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 750 atoms
  using lattice units in orthogonal box = (-1477.5 -100 -100) to (1477.5 100 100)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -750 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -750 750 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 501 atoms
  using lattice units in orthogonal box = (-1477.5 -100 -100) to (1477.5 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  750 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  750 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  501 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  501 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
750 atoms in group substrate
group slider1 region slider1
501 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 501 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_94_*.dump id type diameter mass xu yu zu fx fy fz

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 1907 130 130
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 79.52 | 79.52 | 79.52 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   2955           200            200            0              0              0              0              0              0              0              0              0              6            
    100000   2955           200            200            0.0034424823   4.2713305e-36  0              0.010327447    292635.92      0              5.6521364e+10  0              0              3.3270494    
    200000   2955           200            200            0.0012145111  -2.1356639e-35  0              0.0036435333   70846.876      0              1.3683768e+10  0              0              3.0752069    
    300000   2955           200            200            7.7889274e-05  1.9370099e-43  0              0.00023366782  604.59494      0              1.167749e+08   0              0              3.0456369    
    400000   2955           200            200            0.00041984648  2.7040168e-05  0              0.0012324993   4113.2928      0              7.9446475e+08  0              0              2.998992     
    500000   2955           200            200            0.0056980684  -0.0020493849   0              0.01914359     676.81758      0              1.307244e+08   0              0              2.9943545    
    600000   2955           200            200            0.0033054134  -0.00046595161  0              0.010382192    88.935131      0              17177437       0              0              2.9958014    
    700000   2955           200            200            0.0046612063  -0.00065319908  0              0.014636818    1.6265171      0              314154.76      0              0              2.9950345    
    800000   2955           200            200            0.0042316636  -0.00050895225  0              0.013203943    1.0719349      0              207039.6       0              0              2.9952873    
    900000   2955           200            200            0.0040420915  -0.0004803009   0              0.012606575    0.23491201     0              45372.242      0              0              2.9953938    
   1000000   2955           200            200            0.0040391297  -0.00048007731  0              0.012597466    0.00081360154  0              157.14363      0              0              2.9953947    
   1100000   2955           200            200            0.0040634044  -0.00048356279  0              0.012673776    0.0030859426   0              596.03649      0              0              2.9953807    
   1200000   2955           200            200            0.0040723007  -0.00048479174  0              0.012701694    0.00053866683  0              104.04117      0              0              2.9953757    
   1300000   2955           200            200            0.0040721131  -0.00048475594  0              0.012701095    3.3498832e-07  0              0.064701548    0              0              2.9953758    
   1400000   2955           200            200            0.0040708459  -0.00048457802  0              0.012697116    8.6022143e-06  0              1.6614806      0              0              2.9953766    
   1500000   2955           200            200            0.0040704299  -0.00048452085  0              0.012695811    1.2095581e-06  0              0.23362094     0              0              2.9953768    
   1600000   2955           200            200            0.0040704562  -0.00048452498  0              0.012695893    1.699136e-10   0              3.2818079e-05  0              0              2.9953768    
   1700000   2955           200            200            0.0040705215  -0.00048453415  0              0.012696099    2.3435066e-08  0              0.0045263819   0              0              2.9953767    
   1800000   2955           200            200            0.0040705407  -0.00048453678  0              0.012696159    2.6588169e-09  0              0.00051353901  0              0              2.9953767    
   1900000   2955           200            200            0.0040705386  -0.00048453646  0              0.012696152    7.3698505e-12  0              1.4234548e-06  0              0              2.9953767    
   2000000   2955           200            200            0.0040705352  -0.00048453599  0              0.012696142    6.2576331e-11  0              1.2086348e-05  0              0              2.9953767    
   2100000   2955           200            200            0.0040705343  -0.00048453587  0              0.012696139    5.7052531e-12  0              1.101945e-06   0              0              2.9953767    
   2200000   2955           200            200            0.0040705345  -0.00048453589  0              0.012696139    5.565883e-14   0              1.0750263e-08  0              0              2.9953767    
   2300000   2955           200            200            0.0040705347  -0.00048453592  0              0.01269614     1.638078e-13   0              3.1638769e-08  0              0              2.9953767    
   2400000   2955           200            200            0.0040705347  -0.00048453592  0              0.01269614     1.1874199e-14  0              2.2934503e-09  0              0              2.9953767    
   2500000   2955           200            200            0.0040705347  -0.00048453592  0              0.01269614     2.7911634e-16  0              5.3910116e-11  0              0              2.9953767    
   2600000   2955           200            200            0.0040705347  -0.00048453592  0              0.01269614     4.2554081e-16  0              8.219137e-11   0              0              2.9953767    
   2700000   2955           200            200            0.0040705347  -0.00048453592  0              0.01269614     1.8117152e-17  0              3.4992497e-12  0              0              2.9953767    
   2800000   2955           200            200            0.0040705347  -0.00048453592  0              0.01269614     1.279071e-18   0              2.4704704e-13  0              0              2.9953767    
   2900000   2955           200            200            0.0040705347  -0.00048453592  0              0.01269614     2.6877651e-18  0              5.1913022e-13  0              0              2.9953767    
   3000000   2955           200            200            0.0040705347  -0.00048453592  0              0.01269614     2.6325646e-20  0              5.0846849e-15  0              0              2.9953767    
Loop time of 180.062 on 2 procs for 3000000 steps with 1251 atoms

Performance: 14395059.139 ns/day, 0.000 hours/ns, 16660.948 timesteps/s
99.9% CPU use with 2 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 40.201     | 40.29      | 40.378     |   1.4 | 22.38
Neigh   | 3.7128     | 3.7136     | 3.7145     |   0.0 |  2.06
Comm    | 14.508     | 14.558     | 14.608     |   1.3 |  8.09
Output  | 0.21532    | 0.21535    | 0.21538    |   0.0 |  0.12
Modify  | 108.55     | 108.57     | 108.58     |   0.2 | 60.29
Other   |            | 12.72      |            |       |  7.06

Nlocal:          625.5 ave         626 max         625 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Nghost:            2.5 ave           3 max           2 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Neighs:          349.5 ave         350 max         349 min
Histogram: 1 0 0 0 0 0 0 0 0 1

Total # of neighbors = 699
Ave neighs/atom = 0.558753
Neighbor list builds = 164
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 95

#variable lat0 equal 1                    #
variable lat1 equal 3+(v_ind*0.01)        # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 250*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 3.95                                                               
Lattice spacing in x,y,z = 3.95 3.95 3.95

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -1481.25 ${n1e1} -100 100 -100 100 units box
region box block -1481.25 1481.25 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -1481.25 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -1481.25 1481.25 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-1481.25 -100 -100) to (1481.25 100 100)
  2 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 750 atoms
  using lattice units in orthogonal box = (-1481.25 -100 -100) to (1481.25 100 100)
  create_atoms CPU = 0.000 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -750 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -750 750 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 501 atoms
  using lattice units in orthogonal box = (-1481.25 -100 -100) to (1481.25 100 100)
  create_atoms CPU = 0.000 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  750 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  750 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  501 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  501 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
750 atoms in group substrate
group slider1 region slider1
501 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 501 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_95_*.dump id type diameter mass xu yu zu fx fy fz

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 1912 130 130
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 79.66 | 79.66 | 79.66 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   2962.5         200            200            0              0              0              0              0              0              0              0              0              6            
    100000   2962.5         200            200            0.0034334879  -5.1126141e-36  0              0.010300464    292602.66      0              5.651494e+10   0              0              3.327067     
    200000   2962.5         200            200            0.0012105759  -6.8168225e-36  0              0.0036317276   70768.477      0              1.3668626e+10  0              0              3.0753223    
    300000   2962.5         200            200            7.6059136e-05  1.7042138e-36  0              0.00022817741  580.4963       0              1.1212035e+08  0              0              3.0456366    
    400000   2962.5         200            200            0.00034294433 -1.4364529e-05  0              0.0010431975   4006.5197      0              7.73842e+08    0              0              2.9991893    
    500000   2962.5         200            200            0.0053628695   0.00018131174  0              0.015907297    770.42754      0              1.4880475e+08  0              0              2.9948317    
    600000   2962.5         200            200            0.0039269098   0.00012833228  0              0.011652397    106.40208      0              20551103       0              0              2.9955039    
    700000   2962.5         200            200            0.0044055965   9.5700435e-06  0              0.013207219    13.645505      0              2635570.4      0              0              2.9952357    
    800000   2962.5         200            200            0.0042907516   3.9465046e-05  0              0.01283279     1.8641039      0              360043.62      0              0              2.9953051    
    900000   2962.5         200            200            0.0042451466   3.8942505e-05  0              0.012696497    0.2620001      0              50604.189      0              0              2.9953306    
   1000000   2962.5         200            200            0.0042342285   3.8817087e-05  0              0.012663868    0.035963964    0              6946.2845      0              0              2.9953369    
   1100000   2962.5         200            200            0.004232721    3.8797434e-05  0              0.012659366    0.0047968315   0              926.48731      0              0              2.9953379    
   1200000   2962.5         200            200            0.0042331199   3.8800168e-05  0              0.012660559    0.00062090256  0              119.92465      0              0              2.9953377    
   1300000   2962.5         200            200            0.004233617    3.8804843e-05  0              0.012662046    7.7881778e-05  0              15.042529      0              0              2.9953375    
   1400000   2962.5         200            200            0.0042339261   3.8807888e-05  0              0.01266297     9.4433257e-06  0              1.8239376      0              0              2.9953373    
   1500000   2962.5         200            200            0.0042340845   3.8809479e-05  0              0.012663444    1.1025548e-06  0              0.21295371     0              0              2.9953373    
   1600000   2962.5         200            200            0.0042341583   3.8810229e-05  0              0.012663665    1.2321464e-07  0              0.023798375    0              0              2.9953372    
   1700000   2962.5         200            200            0.0042341908   3.8810561e-05  0              0.012663762    1.3058695e-08  0              0.0025222306   0              0              2.9953372    
   1800000   2962.5         200            200            0.0042342045   3.8810701e-05  0              0.012663803    1.2932306e-09  0              0.0002497819   0              0              2.9953372    
   1900000   2962.5         200            200            0.0042342101   3.8810759e-05  0              0.01266382     1.1669726e-10  0              2.2539571e-05  0              0              2.9953372    
   2000000   2962.5         200            200            0.0042342124   3.8810783e-05  0              0.012663826    9.1449377e-12  0              1.7663053e-06  0              0              2.9953372    
   2100000   2962.5         200            200            0.0042342133   3.8810792e-05  0              0.012663829    5.5869838e-13  0              1.0791018e-07  0              0              2.9953372    
   2200000   2962.5         200            200            0.0042342136   3.8810795e-05  0              0.01266383     1.8659053e-14  0              3.6039155e-09  0              0              2.9953372    
   2300000   2962.5         200            200            0.0042342137   3.8810797e-05  0              0.01266383     8.3007691e-19  0              1.6032577e-13  0              0              2.9953372    
   2400000   2962.5         200            200            0.0042342138   3.8810797e-05  0              0.012663831    3.7520409e-16  0              7.2469051e-11  0              0              2.9953372    
   2500000   2962.5         200            200            0.0042342138   3.8810797e-05  0              0.012663831    1.98163e-16    0              3.8274328e-11  0              0              2.9953372    
   2600000   2962.5         200            200            0.0042342138   3.8810797e-05  0              0.012663831    5.3890381e-17  0              1.0408694e-11  0              0              2.9953372    
   2700000   2962.5         200            200            0.0042342138   3.8810797e-05  0              0.012663831    5.8594759e-18  0              1.1317325e-12  0              0              2.9953372    
   2800000   2962.5         200            200            0.0042342138   3.8810798e-05  0              0.012663831    1.2382992e-18  0              2.3917215e-13  0              0              2.9953372    
   2900000   2962.5         200            200            0.0042342138   3.8810797e-05  0              0.012663831    7.5577e-21     0              1.4597371e-15  0              0              2.9953372    
   3000000   2962.5         200            200            0.0042342138   3.8810797e-05  0              0.012663831    1.6035909e-18  0              3.0972666e-13  0              0              2.9953372    
Loop time of 181.271 on 2 procs for 3000000 steps with 1251 atoms

Performance: 14298993.568 ns/day, 0.000 hours/ns, 16549.761 timesteps/s
99.9% CPU use with 2 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 40.041     | 40.189     | 40.337     |   2.3 | 22.17
Neigh   | 3.7341     | 3.735      | 3.736      |   0.0 |  2.06
Comm    | 15.229     | 15.272     | 15.314     |   1.1 |  8.42
Output  | 0.21199    | 0.21202    | 0.21206    |   0.0 |  0.12
Modify  | 108.97     | 109.11     | 109.25     |   1.3 | 60.19
Other   |            | 12.75      |            |       |  7.03

Nlocal:          625.5 ave         626 max         625 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Nghost:            2.5 ave           3 max           2 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Neighs:          348.5 ave         349 max         348 min
Histogram: 1 0 0 0 0 0 0 0 0 1

Total # of neighbors = 697
Ave neighs/atom = 0.55715428
Neighbor list builds = 164
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 96

#variable lat0 equal 1                    #
variable lat1 equal 3+(v_ind*0.01)        # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 250*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 3.96                                                               
Lattice spacing in x,y,z = 3.96 3.96 3.96

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -1485 ${n1e1} -100 100 -100 100 units box
region box block -1485 1485 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -1485 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -1485 1485 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-1485 -100 -100) to (1485 100 100)
  2 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 750 atoms
  using lattice units in orthogonal box = (-1485 -100 -100) to (1485 100 100)
  create_atoms CPU = 0.000 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -750 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -750 750 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 501 atoms
  using lattice units in orthogonal box = (-1485 -100 -100) to (1485 100 100)
  create_atoms CPU = 0.000 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  750 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  750 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  501 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  501 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
750 atoms in group substrate
group slider1 region slider1
501 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 501 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_96_*.dump id type diameter mass xu yu zu fx fy fz

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 1917 130 130
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 79.87 | 79.87 | 79.87 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   2970           200            200            0              0              0              0              0              0              0              0              0              6            
    100000   2970           200            200            0.0034241791   1.6999049e-36  0              0.010272537    292521.61      0              5.6499287e+10  0              0              3.3271853    
    200000   2970           200            200            0.0012060773  -8.4995093e-37  0              0.0036182319   70636.673      0              1.3643169e+10  0              0              3.0755242    
    300000   2970           200            200            7.4899618e-05  4.2497563e-37  0              0.00022469885  566.41211      0              1.0940005e+08  0              0              3.045589     
    400000   2970           200            200            0.00019674641 -1.3280486e-38  0              0.00059023922  3544.2877      0              6.8456388e+08  0              0              3.000109     
    500000   2970           200            200            0.0051103825  -0.00083162828  0              0.016162776    787.03295      0              1.5201202e+08  0              0              2.9948299    
    600000   2970           200            200            0.004629671   -0.00073567364  0              0.014624687    99.169376      0              19154137       0              0              2.9950479    
    700000   2970           200            200            0.0041967072  -0.0007689909   0              0.013359113    12.997496      0              2510410.3      0              0              2.9952362    
    800000   2970           200            200            0.0037611948  -0.00074925416  0              0.012032839    0.75583527     0              145986.32      0              0              2.9954693    
    900000   2970           200            200            0.0040493502  -0.0007626055   0              0.012910656    0.0079138722   0              1528.5303      0              0              2.995317     
   1000000   2970           200            200            0.0039253425  -0.00075717872  0              0.012533206    0.0035835337   0              692.14407      0              0              2.9953814    
   1100000   2970           200            200            0.0039665129  -0.00075900613  0              0.012658545    0.0025837776   0              499.04549      0              0              2.9953601    
   1200000   2970           200            200            0.0039565     -0.00075857219  0              0.012628072    0.00061846904  0              119.45463      0              0              2.9953652    
   1300000   2970           200            200            0.0039574312  -0.00075860895  0              0.012630902    8.5935837e-05  0              16.598136      0              0              2.9953648    
   1400000   2970           200            200            0.0039581796  -0.00075864385  0              0.012633183    7.0489373e-06  0              1.3614718      0              0              2.9953644    
   1500000   2970           200            200            0.0039575685  -0.00075861626  0              0.012631322    2.2121051e-07  0              0.042725856    0              0              2.9953647    
   1600000   2970           200            200            0.0039578639  -0.00075862945  0              0.012632221    2.8560187e-09  0              0.00055162768  0              0              2.9953645    
   1700000   2970           200            200            0.0039577548  -0.00075862462  0              0.012631889    9.6401681e-09  0              0.0018619569   0              0              2.9953646    
   1800000   2970           200            200            0.0039577857  -0.00075862597  0              0.012631983    3.1893585e-09  0              0.00061601083  0              0              2.9953646    
   1900000   2970           200            200            0.0039577804  -0.00075862574  0              0.012631967    5.4640679e-10  0              0.00010553611  0              0              2.9953646    
   2000000   2970           200            200            0.0039577796  -0.00075862571  0              0.012631965    5.6803673e-11  0              1.0971384e-05  0              0              2.9953646    
   2100000   2970           200            200            0.0039577808  -0.00075862576  0              0.012631968    3.0002621e-12  0              5.7948767e-07  0              0              2.9953646    
   2200000   2970           200            200            0.0039577801  -0.00075862573  0              0.012631966    1.113268e-14   0              2.1502292e-09  0              0              2.9953646    
   2300000   2970           200            200            0.0039577804  -0.00075862574  0              0.012631967    2.714061e-14   0              5.2420917e-09  0              0              2.9953646    
   2400000   2970           200            200            0.0039577803  -0.00075862574  0              0.012631967    1.4724638e-14  0              2.8440003e-09  0              0              2.9953646    
   2500000   2970           200            200            0.0039577804  -0.00075862574  0              0.012631967    3.1831455e-15  0              6.1481083e-10  0              0              2.9953646    
   2600000   2970           200            200            0.0039577804  -0.00075862574  0              0.012631967    4.182716e-16   0              8.0787355e-11  0              0              2.9953646    
   2700000   2970           200            200            0.0039577804  -0.00075862574  0              0.012631967    2.2098147e-17  0              4.2681617e-12  0              0              2.9953646    
   2800000   2970           200            200            0.0039577804  -0.00075862574  0              0.012631967    1.5589692e-19  0              3.0110817e-14  0              0              2.9953646    
   2900000   2970           200            200            0.0039577804  -0.00075862574  0              0.012631967    2.5301411e-18  0              4.8868584e-13  0              0              2.9953646    
   3000000   2970           200            200            0.0039577804  -0.00075862574  0              0.012631967    3.1234551e-18  0              6.0328188e-13  0              0              2.9953646    
Loop time of 180.322 on 2 procs for 3000000 steps with 1251 atoms

Performance: 14374252.198 ns/day, 0.000 hours/ns, 16636.866 timesteps/s
99.9% CPU use with 2 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 40.041     | 40.051     | 40.061     |   0.2 | 22.21
Neigh   | 3.7256     | 3.7262     | 3.7268     |   0.0 |  2.07
Comm    | 14.658     | 14.778     | 14.897     |   3.1 |  8.20
Output  | 0.30948    | 0.3095     | 0.30952    |   0.0 |  0.17
Modify  | 108.64     | 108.67     | 108.7      |   0.3 | 60.27
Other   |            | 12.79      |            |       |  7.09

Nlocal:          625.5 ave         626 max         625 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Nghost:            2.5 ave           3 max           2 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Neighs:          348.5 ave         349 max         348 min
Histogram: 1 0 0 0 0 0 0 0 0 1

Total # of neighbors = 697
Ave neighs/atom = 0.55715428
Neighbor list builds = 164
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 97

#variable lat0 equal 1                    #
variable lat1 equal 3+(v_ind*0.01)        # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 250*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 3.97                                                               
Lattice spacing in x,y,z = 3.97 3.97 3.97

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -1488.75 ${n1e1} -100 100 -100 100 units box
region box block -1488.75 1488.75 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -1488.75 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -1488.75 1488.75 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-1488.75 -100 -100) to (1488.75 100 100)
  2 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 750 atoms
  using lattice units in orthogonal box = (-1488.75 -100 -100) to (1488.75 100 100)
  create_atoms CPU = 0.000 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -750 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -750 750 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 501 atoms
  using lattice units in orthogonal box = (-1488.75 -100 -100) to (1488.75 100 100)
  create_atoms CPU = 0.000 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  750 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  750 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  501 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  501 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
750 atoms in group substrate
group slider1 region slider1
501 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 501 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_97_*.dump id type diameter mass xu yu zu fx fy fz

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 1921 130 130
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 80.01 | 80.01 | 80.01 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   2977.5         200            200            0              0              0              0              0              0              0              0              0              6            
    100000   2977.5         200            200            0.0034152985  -4.2390504e-37  0              0.010245895    292496.19      0              5.6494376e+10  0              0              3.327118     
    200000   2977.5         200            200            0.0012020891   8.4781283e-37  0              0.0036062674   70551.722      0              1.3626761e+10  0              0              3.0755669    
    300000   2977.5         200            200            7.0522135e-05 -2.5434278e-36  0              0.00021156641  507.06018      0              97936486       0              0              3.0455851    
    400000   2977.5         200            200            0.0001936907  -2.1195237e-37  0              0.0005810721   3460.5679      0              6.6839376e+08  0              0              3.0002031    
    500000   2977.5         200            200            0.0022790977  -0.0001991717   0              0.0070364647   643.98508      0              1.2438294e+08  0              0              2.996533     
    600000   2977.5         200            200            0.0053891262  -0.0010997616   0              0.01726714     34.080676      0              6582535.4      0              0              2.994459     
    700000   2977.5         200            200            0.0036178863  -0.00083468327  0              0.011688342    11.182501      0              2159851.8      0              0              2.9954364    
    800000   2977.5         200            200            0.0038718708  -0.0009023201   0              0.012517933    1.8945455      0              365923.29      0              0              2.9952831    
    900000   2977.5         200            200            0.0039652517  -0.00089632129  0              0.012792076    0.11714246     0              22625.56       0              0              2.9952277    
   1000000   2977.5         200            200            0.0038712798  -0.00089003597  0              0.012503876    3.9716361e-06  0              0.76710436     0              0              2.9952834    
   1100000   2977.5         200            200            0.0039112971  -0.00089272869  0              0.01262662     0.0020264795   0              391.40578      0              0              2.99526      
   1200000   2977.5         200            200            0.003901918   -0.00089211692  0              0.012597871    0.00062832797  0              121.35884      0              0              2.9952653    
   1300000   2977.5         200            200            0.0039016755  -0.00089209398  0              0.01259712     5.9832721e-05  0              11.556432      0              0              2.9952655    
   1400000   2977.5         200            200            0.0039030761  -0.00089218952  0              0.012601418    7.691095e-07   0              0.14855018     0              0              2.9952647    
   1500000   2977.5         200            200            0.0039023371  -0.00089213999  0              0.012599151    3.1536162e-07  0              0.060910737    0              0              2.9952651    
   1600000   2977.5         200            200            0.0039025552  -0.00089215439  0              0.01259982     1.8313397e-07  0              0.035371536    0              0              2.995265     
   1700000   2977.5         200            200            0.0039025348  -0.00089215314  0              0.012599758    2.559391e-08   0              0.0049433532   0              0              2.995265     
   1800000   2977.5         200            200            0.0039025166  -0.00089215188  0              0.012599702    9.2171227e-10  0              0.00017802475  0              0              2.995265     
   1900000   2977.5         200            200            0.0039025294  -0.00089215274  0              0.012599741    2.3799055e-11  0              4.5966847e-06  0              0              2.995265     
   2000000   2977.5         200            200            0.0039025248  -0.00089215244  0              0.012599727    4.6102388e-11  0              8.9044773e-06  0              0              2.995265     
   2100000   2977.5         200            200            0.0039025256  -0.00089215249  0              0.012599729    9.507321e-12   0              1.836298e-06   0              0              2.995265     
   2200000   2977.5         200            200            0.0039025258  -0.0008921525   0              0.01259973     6.111504e-13   0              1.1804106e-07  0              0              2.995265     
   2300000   2977.5         200            200            0.0039025256  -0.00089215249  0              0.012599729    1.9842488e-16  0              3.8324909e-11  0              0              2.995265     
   2400000   2977.5         200            200            0.0039025257  -0.0008921525   0              0.012599729    9.5676215e-15  0              1.8479448e-09  0              0              2.995265     
   2500000   2977.5         200            200            0.0039025256  -0.00089215249  0              0.012599729    3.1313388e-15  0              6.0480458e-10  0              0              2.995265     
   2600000   2977.5         200            200            0.0039025256  -0.00089215249  0              0.012599729    3.0703697e-16  0              5.9302865e-11  0              0              2.995265     
   2700000   2977.5         200            200            0.0039025256  -0.00089215249  0              0.012599729    1.8107678e-18  0              3.4974199e-13  0              0              2.995265     
   2800000   2977.5         200            200            0.0039025256  -0.00089215249  0              0.012599729    1.3871271e-18  0              2.6791761e-13  0              0              2.995265     
   2900000   2977.5         200            200            0.0039025256  -0.00089215249  0              0.012599729    2.656544e-18   0              5.1310002e-13  0              0              2.995265     
   3000000   2977.5         200            200            0.0039025256  -0.0008921525   0              0.012599729    4.1171435e-19  0              7.952085e-14   0              0              2.995265     
Loop time of 180.012 on 2 procs for 3000000 steps with 1251 atoms

Performance: 14399007.046 ns/day, 0.000 hours/ns, 16665.517 timesteps/s
99.9% CPU use with 2 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 39.887     | 40.023     | 40.16      |   2.2 | 22.23
Neigh   | 3.75       | 3.7503     | 3.7506     |   0.0 |  2.08
Comm    | 14.547     | 14.563     | 14.578     |   0.4 |  8.09
Output  | 0.21132    | 0.21135    | 0.21138    |   0.0 |  0.12
Modify  | 108.71     | 108.72     | 108.72     |   0.0 | 60.39
Other   |            | 12.75      |            |       |  7.08

Nlocal:          625.5 ave         626 max         625 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Nghost:            2.5 ave           3 max           2 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Neighs:          350.5 ave         351 max         350 min
Histogram: 1 0 0 0 0 0 0 0 0 1

Total # of neighbors = 701
Ave neighs/atom = 0.56035172
Neighbor list builds = 164
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 98

#variable lat0 equal 1                    #
variable lat1 equal 3+(v_ind*0.01)        # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 250*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 3.98                                                               
Lattice spacing in x,y,z = 3.98 3.98 3.98

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -1492.5 ${n1e1} -100 100 -100 100 units box
region box block -1492.5 1492.5 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -1492.5 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -1492.5 1492.5 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-1492.5 -100 -100) to (1492.5 100 100)
  2 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 750 atoms
  using lattice units in orthogonal box = (-1492.5 -100 -100) to (1492.5 100 100)
  create_atoms CPU = 0.000 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -750 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -750 750 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 501 atoms
  using lattice units in orthogonal box = (-1492.5 -100 -100) to (1492.5 100 100)
  create_atoms CPU = 0.000 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  750 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  750 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  501 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  501 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
750 atoms in group substrate
group slider1 region slider1
501 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 501 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_98_*.dump id type diameter mass xu yu zu fx fy fz

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 1926 130 130
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 80.15 | 80.15 | 80.15 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   2985           200            200            0              0              0              0              0              0              0              0              0              6            
    100000   2985           200            200            0.0034057851   2.1142009e-37  0              0.010217355    292384.24      0              5.6472755e+10  0              0              3.3271786    
    200000   2985           200            200            0.0011971241   5.1528902e-42  0              0.0035913723   70376.655      0              1.3592947e+10  0              0              3.075691     
    300000   2985           200            200            6.6038894e-05  4.4115132e-43  0              0.00019811668  449.11053      0              86743761       0              0              3.0454637    
    400000   2985           200            200            0.00017537144  8.9760348e-42  0              0.00052611431  2898.6916      0              5.5986976e+08  0              0              3.0011987    
    500000   2985           200            200            0.00080145287  0.00011059272  0              0.0022937659   125.17908      0              24177800       0              0              2.9979799    
    600000   2985           200            200            0.0027405331  -0.00058929208  0              0.0088108912   43.691724      0              8438868        0              0              2.9959615    
    700000   2985           200            200            0.0043058204  -0.0010167884   0              0.01393425     7.333212       0              1416378.2      0              0              2.9949029    
    800000   2985           200            200            0.0039391106  -0.0010370855   0              0.012854417    1.5846854      0              306075.14      0              0              2.9950996    
    900000   2985           200            200            0.0037575004  -0.0010373322   0              0.012309833    0.00034837149  0              67.28645       0              0              2.9952069    
   1000000   2985           200            200            0.0038532827  -0.0010424917   0              0.01260234     0.030415976    0              5874.7146      0              0              2.9951505    
   1100000   2985           200            200            0.0038500468  -0.0010423544   0              0.012592495    0.002282066    0              440.77119      0              0              2.995152     
   1200000   2985           200            200            0.0038380109  -0.0010417021   0              0.012555735    9.5135662e-05  0              18.375043      0              0              2.9951592    
   1300000   2985           200            200            0.003841927   -0.0010419094   0              0.012567691    8.5909356e-05  0              16.593021      0              0              2.9951569    
   1400000   2985           200            200            0.0038424216  -0.0010419377   0              0.012569203    1.8484922e-06  0              0.35702829     0              0              2.9951566    
   1500000   2985           200            200            0.0038417497  -0.0010419016   0              0.012567151    7.3837922e-07  0              0.14261476     0              0              2.995157     
   1600000   2985           200            200            0.003841877   -0.0010419082   0              0.012567539    1.8650137e-07  0              0.036021936    0              0              2.9951569    
   1700000   2985           200            200            0.003841931   -0.0010419112   0              0.012567704    7.5172024e-11  0              1.4519152e-05  0              0              2.9951569    
   1800000   2985           200            200            0.0038418982  -0.0010419094   0              0.012567604    3.1170729e-09  0              0.00060204917  0              0              2.9951569    
   1900000   2985           200            200            0.0038419004  -0.0010419095   0              0.012567611    2.9920694e-10  0              5.779053e-05   0              0              2.9951569    
   2000000   2985           200            200            0.0038419042  -0.0010419097   0              0.012567622    6.4758358e-12  0              1.2507797e-06  0              0              2.9951569    
   2100000   2985           200            200            0.0038419028  -0.0010419097   0              0.012567618    9.4330103e-12  0              1.8219452e-06  0              0              2.9951569    
   2200000   2985           200            200            0.0038419027  -0.0010419096   0              0.012567618    2.9555536e-13  0              5.7085243e-08  0              0              2.9951569    
   2300000   2985           200            200            0.0038419029  -0.0010419097   0              0.012567618    6.639419e-14   0              1.2823751e-08  0              0              2.9951569    
   2400000   2985           200            200            0.0038419028  -0.0010419097   0              0.012567618    2.1844347e-14  0              4.2191414e-09  0              0              2.9951569    
   2500000   2985           200            200            0.0038419028  -0.0010419097   0              0.012567618    7.1197169e-17  0              1.3751426e-11  0              0              2.9951569    
   2600000   2985           200            200            0.0038419028  -0.0010419097   0              0.012567618    3.2218219e-16  0              6.2228099e-11  0              0              2.9951569    
   2700000   2985           200            200            0.0038419028  -0.0010419097   0              0.012567618    3.2703358e-17  0              6.3165125e-12  0              0              2.9951569    
   2800000   2985           200            200            0.0038419028  -0.0010419097   0              0.012567618    2.4157926e-19  0              4.6659991e-14  0              0              2.9951569    
   2900000   2985           200            200            0.0038419028  -0.0010419097   0              0.012567618    5.3488474e-19  0              1.0331068e-13  0              0              2.9951569    
   3000000   2985           200            200            0.0038419028  -0.0010419097   0              0.012567618    2.8476859e-18  0              5.5001825e-13  0              0              2.9951569    
Loop time of 180.408 on 2 procs for 3000000 steps with 1251 atoms

Performance: 14367409.035 ns/day, 0.000 hours/ns, 16628.946 timesteps/s
99.9% CPU use with 2 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 39.843     | 39.991     | 40.139     |   2.3 | 22.17
Neigh   | 3.7485     | 3.7488     | 3.7491     |   0.0 |  2.08
Comm    | 15.215     | 15.239     | 15.264     |   0.6 |  8.45
Output  | 0.21333    | 0.21335    | 0.21337    |   0.0 |  0.12
Modify  | 108.35     | 108.48     | 108.61     |   1.2 | 60.13
Other   |            | 12.73      |            |       |  7.06

Nlocal:          625.5 ave         626 max         625 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Nghost:            2.5 ave           3 max           2 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Neighs:          350.5 ave         351 max         350 min
Histogram: 1 0 0 0 0 0 0 0 0 1

Total # of neighbors = 701
Ave neighs/atom = 0.56035172
Neighbor list builds = 164
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 99

#variable lat0 equal 1                    #
variable lat1 equal 3+(v_ind*0.01)        # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 250*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 3.99                                                               
Lattice spacing in x,y,z = 3.99 3.99 3.99

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -1496.25 ${n1e1} -100 100 -100 100 units box
region box block -1496.25 1496.25 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -1496.25 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -1496.25 1496.25 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-1496.25 -100 -100) to (1496.25 100 100)
  2 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 750 atoms
  using lattice units in orthogonal box = (-1496.25 -100 -100) to (1496.25 100 100)
  create_atoms CPU = 0.000 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -750 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -750 750 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 501 atoms
  using lattice units in orthogonal box = (-1496.25 -100 -100) to (1496.25 100 100)
  create_atoms CPU = 0.000 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  750 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  750 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  501 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  501 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
750 atoms in group substrate
group slider1 region slider1
501 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 501 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_99_*.dump id type diameter mass xu yu zu fx fy fz

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 1931 130 130
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 80.35 | 80.35 | 80.35 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   2992.5         200            200            0              0              0              0              0              0              0              0              0              6            
    100000   2992.5         200            200            0.0033973931  -2.1089008e-37  0              0.010192179    292412.61      0              5.6478235e+10  0              0              3.3269904    
    200000   2992.5         200            200            0.001195635    1.6871294e-36  0              0.0035869049   70522.97       0              1.3621207e+10  0              0              3.0751654    
    300000   2992.5         200            200            6.9727923e-05  4.217806e-37   0              0.00020918377  501.09511      0              96784359       0              0              3.0451438    
    400000   2992.5         200            200            0.00018236756  1.0544507e-37  0              0.00054710267  3129.0499      0              6.0436249e+08  0              0              3.0004819    
    500000   2992.5         200            200            0.00058060348 -0.00021660457  0              0.001958415    25.908011      0              5004020.5      0              0              2.9979613    
    600000   2992.5         200            200            0.0030442638   0.0013676124   0              0.0077651789   1.6959361      0              327562.74      0              0              2.9959374    
    700000   2992.5         200            200            0.0047840336   0.0033327548   0              0.011019346    4.3572759      0              841589.03      0              0              2.9952086    
    800000   2992.5         200            200            0.0053271519   0.0037176441   0              0.012263812    1.5688325      0              303013.22      0              0              2.994952     
    900000   2992.5         200            200            0.0054444093   0.0037528503   0              0.012580378    0.24590331     0              47495.164      0              0              2.9948876    
   1000000   2992.5         200            200            0.0054516264   0.003755205    0              0.012599674    0.01793874     0              3464.7903      0              0              2.9948831    
   1100000   2992.5         200            200            0.0054401461   0.0037520531   0              0.012568385    0.00022211954  0              42.90143       0              0              2.9948891    
   1200000   2992.5         200            200            0.0054321625   0.0037497975   0              0.01254669     8.0478307e-05  0              15.544038      0              0              2.9948934    
   1300000   2992.5         200            200            0.0054288327   0.0037488436   0              0.012537654    5.6228734e-05  0              10.860337      0              0              2.9948952    
   1400000   2992.5         200            200            0.0054278748   0.0037485657   0              0.012535059    1.1384924e-05  0              2.198949       0              0              2.9948957    
   1500000   2992.5         200            200            0.0054277387   0.0037485247   0              0.012534692    1.1038495e-06  0              0.21320377     0              0              2.9948958    
   1600000   2992.5         200            200            0.0054277849   0.0037485372   0              0.012534818    3.4877809e-08  0              0.0067364983   0              0              2.9948958    
   1700000   2992.5         200            200            0.0054278316   0.0037485503   0              0.012534944    7.6782846e-10  0              0.00014830275  0              0              2.9948957    
   1800000   2992.5         200            200            0.0054278539   0.0037485567   0              0.012535005    1.7786637e-09  0              0.00034354122  0              0              2.9948957    
   1900000   2992.5         200            200            0.0054278612   0.0037485588   0              0.012535025    4.8619008e-10  0              9.3905515e-05  0              0              2.9948957    
   2000000   2992.5         200            200            0.0054278627   0.0037485593   0              0.012535029    6.0651144e-11  0              1.1714507e-05  0              0              2.9948957    
   2100000   2992.5         200            200            0.0054278626   0.0037485592   0              0.012535028    3.1850463e-12  0              6.1517795e-07  0              0              2.9948957    
   2200000   2992.5         200            200            0.0054278623   0.0037485592   0              0.012535028    1.534826e-15   0              2.9644503e-10  0              0              2.9948957    
   2300000   2992.5         200            200            0.0054278622   0.0037485591   0              0.012535027    4.7061495e-14  0              9.0897247e-09  0              0              2.9948957    
   2400000   2992.5         200            200            0.0054278621   0.0037485591   0              0.012535027    1.9070133e-14  0              3.6833138e-09  0              0              2.9948957    
   2500000   2992.5         200            200            0.0054278621   0.0037485591   0              0.012535027    3.0421905e-15  0              5.8758596e-10  0              0              2.9948957    
   2600000   2992.5         200            200            0.0054278621   0.0037485591   0              0.012535027    2.4107739e-16  0              4.6563058e-11  0              0              2.9948957    
   2700000   2992.5         200            200            0.0054278621   0.0037485591   0              0.012535027    4.4163172e-18  0              8.529926e-13   0              0              2.9948957    
   2800000   2992.5         200            200            0.0054278621   0.0037485591   0              0.012535027    7.8324605e-19  0              1.5128059e-13  0              0              2.9948957    
   2900000   2992.5         200            200            0.0054278621   0.0037485591   0              0.012535027    7.2507988e-19  0              1.4004605e-13  0              0              2.9948957    
   3000000   2992.5         200            200            0.0054278621   0.0037485591   0              0.012535027    8.9653057e-20  0              1.7316101e-14  0              0              2.9948957    
Loop time of 180.219 on 2 procs for 3000000 steps with 1251 atoms

Performance: 14382538.205 ns/day, 0.000 hours/ns, 16646.456 timesteps/s
99.9% CPU use with 2 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 39.776     | 39.782     | 39.787     |   0.1 | 22.07
Neigh   | 3.8031     | 3.8034     | 3.8037     |   0.0 |  2.11
Comm    | 14.681     | 14.786     | 14.892     |   2.7 |  8.20
Output  | 0.21341    | 0.21344    | 0.21347    |   0.0 |  0.12
Modify  | 108.79     | 108.82     | 108.84     |   0.2 | 60.38
Other   |            | 12.82      |            |       |  7.11

Nlocal:          625.5 ave         626 max         625 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Nghost:            2.5 ave           3 max           2 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Neighs:          352.5 ave         353 max         352 min
Histogram: 1 0 0 0 0 0 0 0 0 1

Total # of neighbors = 705
Ave neighs/atom = 0.56354916
Neighbor list builds = 164
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop
Total wall time: 5:05:30

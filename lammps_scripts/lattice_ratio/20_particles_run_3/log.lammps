LAMMPS (23 Jun 2022 - Update 1)
  using 1 OpenMP thread(s) per MPI task
variable num index 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99

label startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 0

#variable lat0 equal 1                    #
variable lat1 equal 3+(151*0.01)+(v_ind*0.01)  # .491+(v_ind*0.001)       # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 10*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.51                                                               
Lattice spacing in x,y,z = 4.51 4.51 4.51

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -67.65 ${n1e1} -100 100 -100 100 units box
region box block -67.65 67.65 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -67.65 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -67.65 67.65 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-67.65 -100 -100) to (67.65 100 100)
  1 by 2 by 2 MPI processor grid
create_atoms 1 region substrate
Created 30 atoms
  using lattice units in orthogonal box = (-67.65 -100 -100) to (67.65 100 100)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 30 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 21 atoms
  using lattice units in orthogonal box = (-67.65 -100 -100) to (67.65 100 100)
  create_atoms CPU = 0.005 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  30 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  30 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  21 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  21 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
30 atoms in group substrate
group slider1 region slider1
21 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 21 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_0_*.dump id type diameter mass xu yu zu fx fy fz

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 88 130 130
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 14.44 | 17.91 | 19.07 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   135.3          200            200            0              0              0              0              0              0              0              2.6109412e-16  0              6            
    100000   135.3          200            200            0.0031867357   5.6946132e-40  0              0.0095602071   12463.605      0              6.0182289e+10  2.6109412e-16  0              3.3226171    
    200000   135.3          200            200            0.001191148    9.1137223e-39  0              0.003573444    3302.7596      0              1.5947844e+10  2.6109412e-16  0              3.0655668    
    300000   135.3          200            200            0.00022021368 -1.8208772e-38  0              0.00066064103  206.68931      0              9.9802873e+08  2.6109412e-16  0              3.0438513    
    400000   135.3          200            200           -1.4100216e-05 -2.2764284e-39  0             -4.2300647e-05  1.1155741      0              5386707.9      2.6109412e-16  0              3.0111287    
    500000   135.3          200            200           -3.7889212e-05  4.5555863e-39  0             -0.00011366764  8.4563272      0              40832578       2.6109412e-16  0              3.0009574    
    600000   135.3          200            200            0.0066467701   0.00055799403  0              0.019382316    3.8812549      0              18741191       2.6109412e-16  0              2.9978978    
    700000   135.3          200            200            0.0034149387   0.00040754032  0              0.0098372759   0.80121262     0              3868769        2.6109412e-16  0              2.9985729    
    800000   135.3          200            200            0.0039592503   0.00041577188  0              0.011461979    0.13668229     0              659989.85      2.6109412e-16  0              2.9984502    
    900000   135.3          200            200            0.0041023707   0.00041738732  0              0.011889725    0.014299444    0              69046.899      2.6109412e-16  0              2.9984165    
   1000000   135.3          200            200            0.0039668434   0.00041591784  0              0.011484612    0.00098833381  0              4772.3103      2.6109412e-16  0              2.9984475    
   1100000   135.3          200            200            0.0040397754   0.00041673248  0              0.011702594    2.9343359e-05  0              141.68858      2.6109412e-16  0              2.9984309    
   1200000   135.3          200            200            0.0040083597   0.00041639209  0              0.011608687    3.0887276e-07  0              1.491436       2.6109412e-16  0              2.998438     
   1300000   135.3          200            200            0.0040199618   0.00041651877  0              0.011643366    1.2378643e-06  0              5.9772036      2.6109412e-16  0              2.9984354    
   1400000   135.3          200            200            0.0040162757   0.00041647892  0              0.011632348    4.6993635e-07  0              2.2691545      2.6109412e-16  0              2.9984362    
   1500000   135.3          200            200            0.0040172262   0.00041648912  0              0.011635189    1.0129492e-07  0              0.4891169      2.6109412e-16  0              2.998436     
   1600000   135.3          200            200            0.0040170749   0.00041648755  0              0.011634737    1.5596645e-08  0              0.075310616    2.6109412e-16  0              2.998436     
   1700000   135.3          200            200            0.0040170498   0.00041648724  0              0.011634662    1.7925849e-09  0              0.0086557511   2.6109412e-16  0              2.998436     
   1800000   135.3          200            200            0.0040170875   0.00041648766  0              0.011634775    1.4532641e-10  0              0.00070172922  2.6109412e-16  0              2.998436     
   1900000   135.3          200            200            0.0040170651   0.00041648742  0              0.011634708    6.3254959e-12  0              3.0543556e-05  2.6109412e-16  0              2.998436     
   2000000   135.3          200            200            0.0040170753   0.00041648753  0              0.011634738    7.8736119e-15  0              3.8018854e-08  2.6109412e-16  0              2.998436     
   2100000   135.3          200            200            0.0040170713   0.00041648749  0              0.011634727    7.8115776e-14  0              3.7719313e-07  2.6109412e-16  0              2.998436     
   2200000   135.3          200            200            0.0040170727   0.0004164875   0              0.01163473     4.1269543e-14  0              1.9927585e-07  2.6109412e-16  0              2.998436     
   2300000   135.3          200            200            0.0040170723   0.0004164875   0              0.011634729    1.0219792e-14  0              4.934772e-08   2.6109412e-16  0              2.998436     
   2400000   135.3          200            200            0.0040170724   0.0004164875   0              0.01163473     1.732846e-15   0              8.3672933e-09  2.6109412e-16  0              2.998436     
   2500000   135.3          200            200            0.0040170724   0.0004164875   0              0.01163473     2.1666676e-16  0              1.0462063e-09  2.6109412e-16  0              2.998436     
   2600000   135.3          200            200            0.0040170724   0.0004164875   0              0.01163473     1.9065559e-17  0              9.2060759e-11  2.6109412e-16  0              2.998436     
   2700000   135.3          200            200            0.0040170724   0.0004164875   0              0.01163473     2.2456193e-18  0              1.0843292e-11  2.6109412e-16  0              2.998436     
   2800000   135.3          200            200            0.0040170724   0.0004164875   0              0.01163473     5.7514239e-20  0              2.7771568e-13  2.6109412e-16  0              2.998436     
   2900000   135.3          200            200            0.0040170724   0.0004164875   0              0.01163473     2.317237e-20   0              1.1189108e-13  2.6109412e-16  0              2.998436     
   3000000   135.3          200            200            0.0040170724   0.0004164875   0              0.01163473     3.386659e-20   0              1.6352964e-13  2.6109412e-16  0              2.998436     
Loop time of 66.5431 on 4 procs for 3000000 steps with 51 atoms

Performance: 38952177.174 ns/day, 0.000 hours/ns, 45083.538 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 0.36836    | 2.0118     | 6.7534     | 193.1 |  3.02
Neigh   | 0.072215   | 0.072858   | 0.074474   |   0.3 |  0.11
Comm    | 26.259     | 32.729     | 38.878     |  82.5 | 49.19
Output  | 0.060127   | 0.060226   | 0.060298   |   0.0 |  0.09
Modify  | 16.013     | 21.931     | 29.32      | 119.1 | 32.96
Other   |            | 9.737      |            |       | 14.63

Nlocal:          12.75 ave          51 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1
Nghost:          39.25 ave          52 max           1 min
Histogram: 1 0 0 0 0 0 0 0 0 3
Neighs:           6.75 ave          27 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1

Total # of neighbors = 27
Ave neighs/atom = 0.52941176
Neighbor list builds = 168
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 1

#variable lat0 equal 1                    #
variable lat1 equal 3+(151*0.01)+(v_ind*0.01)  # .491+(v_ind*0.001)       # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 10*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.52                                                               
Lattice spacing in x,y,z = 4.52 4.52 4.52

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -67.8 ${n1e1} -100 100 -100 100 units box
region box block -67.8 67.8 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -67.8 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -67.8 67.8 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-67.8 -100 -100) to (67.8 100 100)
  1 by 2 by 2 MPI processor grid
create_atoms 1 region substrate
Created 30 atoms
  using lattice units in orthogonal box = (-67.8 -100 -100) to (67.8 100 100)
  create_atoms CPU = 0.000 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 30 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 21 atoms
  using lattice units in orthogonal box = (-67.8 -100 -100) to (67.8 100 100)
  create_atoms CPU = 0.003 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  30 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  30 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  21 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  21 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
30 atoms in group substrate
group slider1 region slider1
21 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 21 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_1_*.dump id type diameter mass xu yu zu fx fy fz

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 88 130 130
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 14.44 | 17.91 | 19.07 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   135.6          200            200            0              0              0              0              0              0              0              2.6109412e-16  0              6            
    100000   135.6          200            200            0.0031783099   2.3779815e-42  0              0.0095349298   12457.002      0              6.0150403e+10  2.6109412e-16  0              3.3223604    
    200000   135.6          200            200            0.001187908    2.272896e-39   0              0.0035637239   3301.0442      0              1.5939561e+10  2.6109412e-16  0              3.0648199    
    300000   135.6          200            200            0.0002200783  -4.5420222e-39  0              0.00066023491  207.37026      0              1.0013168e+09  2.6109412e-16  0              3.0430407    
    400000   135.6          200            200           -2.0705751e-05 -2.2724554e-39  0             -6.2117254e-05  2.4492435      0              11826520       2.6109412e-16  0              3.0103669    
    500000   135.6          200            200            0.0063589252   0.0013244815   0              0.017752294    44.07794       0              2.128366e+08   2.6109412e-16  0              2.9973228    
    600000   135.6          200            200            0.0072979024   0.00090669784  0              0.020987009    0.78213707     0              3776660        2.6109412e-16  0              2.9971137    
    700000   135.6          200            200            0.0047193626   0.00047694476  0              0.013681143    0.53351372     0              2576146.8      2.6109412e-16  0              2.9976656    
    800000   135.6          200            200            0.0042217765   0.0004690747   0              0.012196255    0.091086146    0              439822.4       2.6109412e-16  0              2.9978041    
    900000   135.6          200            200            0.0040580385   0.00046568042  0              0.011708435    0.015502361    0              74855.351      2.6109412e-16  0              2.9978511    
   1000000   135.6          200            200            0.0040203776   0.00046482547  0              0.011596307    0.0022169655   0              10704.933      2.6109412e-16  0              2.9978622    
   1100000   135.6          200            200            0.0040167377   0.00046473403  0              0.011585479    0.00026287878  0              1269.3476      2.6109412e-16  0              2.9978633    
   1200000   135.6          200            200            0.0040193373   0.00046478874  0              0.011593223    2.5043915e-05  0              120.9281       2.6109412e-16  0              2.9978626    
   1300000   135.6          200            200            0.0040216605   0.00046483956  0              0.011600142    1.7338388e-06  0              8.3720873      2.6109412e-16  0              2.997862     
   1400000   135.6          200            200            0.0040229394   0.00046486781  0              0.01160395     6.0787813e-08  0              0.29352259     2.6109412e-16  0              2.9978616    
   1500000   135.6          200            200            0.0040235223   0.00046488076  0              0.011605686    2.7189391e-11  0              0.00013128784  2.6109412e-16  0              2.9978614    
   1600000   135.6          200            200            0.0040237582   0.00046488601  0              0.011606389    1.3704527e-09  0              0.0066174258   2.6109412e-16  0              2.9978614    
   1700000   135.6          200            200            0.0040238448   0.00046488795  0              0.011606646    6.3830144e-10  0              0.0030821292   2.6109412e-16  0              2.9978613    
   1800000   135.6          200            200            0.0040238737   0.0004648886   0              0.011606732    1.6166077e-10  0              0.000780602    2.6109412e-16  0              2.9978613    
   1900000   135.6          200            200            0.0040238822   0.00046488879  0              0.011606758    3.0261093e-11  0              0.00014611999  2.6109412e-16  0              2.9978613    
   2000000   135.6          200            200            0.0040238842   0.00046488884  0              0.011606764    4.574066e-12   0              2.2086528e-05  2.6109412e-16  0              2.9978613    
   2100000   135.6          200            200            0.0040238845   0.00046488885  0              0.011606765    5.7157877e-13  0              2.7599493e-06  2.6109412e-16  0              2.9978613    
   2200000   135.6          200            200            0.0040238845   0.00046488884  0              0.011606765    5.804307e-14   0              2.8026921e-07  2.6109412e-16  0              2.9978613    
   2300000   135.6          200            200            0.0040238844   0.00046488884  0              0.011606764    4.4575852e-15  0              2.1524084e-08  2.6109412e-16  0              2.9978613    
   2400000   135.6          200            200            0.0040238843   0.00046488884  0              0.011606764    1.9773815e-16  0              9.5480678e-10  2.6109412e-16  0              2.9978613    
   2500000   135.6          200            200            0.0040238843   0.00046488884  0              0.011606764    7.780891e-19   0              3.7571138e-12  2.6109412e-16  0              2.9978613    
   2600000   135.6          200            200            0.0040238843   0.00046488884  0              0.011606764    1.772237e-18   0              8.5574982e-12  2.6109412e-16  0              2.9978613    
   2700000   135.6          200            200            0.0040238843   0.00046488884  0              0.011606764    1.2755693e-18  0              6.1592678e-12  2.6109412e-16  0              2.9978613    
   2800000   135.6          200            200            0.0040238843   0.00046488884  0              0.011606764    4.5671194e-19  0              2.2052985e-12  2.6109412e-16  0              2.9978613    
   2900000   135.6          200            200            0.0040238843   0.00046488884  0              0.011606764    1.6153971e-19  0              7.8001745e-13  2.6109412e-16  0              2.9978613    
   3000000   135.6          200            200            0.0040238843   0.00046488884  0              0.011606764    1.3117958e-21  0              6.3341923e-15  2.6109412e-16  0              2.9978613    
Loop time of 66.1283 on 4 procs for 3000000 steps with 51 atoms

Performance: 39196525.138 ns/day, 0.000 hours/ns, 45366.349 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 0.33636    | 1.8192     | 6.0314     | 180.4 |  2.75
Neigh   | 0.071058   | 0.071635   | 0.073202   |   0.3 |  0.11
Comm    | 26.198     | 32.882     | 38.913     |  84.4 | 49.72
Output  | 0.061013   | 0.061096   | 0.061162   |   0.0 |  0.09
Modify  | 15.828     | 21.795     | 29.341     | 122.3 | 32.96
Other   |            | 9.5        |            |       | 14.37

Nlocal:          12.75 ave          51 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1
Nghost:          39.25 ave          52 max           1 min
Histogram: 1 0 0 0 0 0 0 0 0 3
Neighs:           6.75 ave          27 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1

Total # of neighbors = 27
Ave neighs/atom = 0.52941176
Neighbor list builds = 168
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 2

#variable lat0 equal 1                    #
variable lat1 equal 3+(151*0.01)+(v_ind*0.01)  # .491+(v_ind*0.001)       # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 10*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.53                                                               
Lattice spacing in x,y,z = 4.53 4.53 4.53

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -67.95 ${n1e1} -100 100 -100 100 units box
region box block -67.95 67.95 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -67.95 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -67.95 67.95 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-67.95 -100 -100) to (67.95 100 100)
  1 by 2 by 2 MPI processor grid
create_atoms 1 region substrate
Created 30 atoms
  using lattice units in orthogonal box = (-67.95 -100 -100) to (67.95 100 100)
  create_atoms CPU = 0.000 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 30 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 21 atoms
  using lattice units in orthogonal box = (-67.95 -100 -100) to (67.95 100 100)
  create_atoms CPU = 0.003 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  30 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  30 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  21 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  21 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
30 atoms in group substrate
group slider1 region slider1
21 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 21 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_2_*.dump id type diameter mass xu yu zu fx fy fz

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 88 130 130
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 14.44 | 17.91 | 19.07 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   135.9          200            200            0              0              0              0              0              0              0              2.6109412e-16  0              6            
    100000   135.9          200            200            0.0031689348   7.8981563e-43  0              0.0095068045   12445.026      0              6.0092578e+10  2.6109412e-16  0              3.3221581    
    200000   135.9          200            200            0.0011822057   2.268332e-39   0              0.0035466172   3288.7968      0              1.5880423e+10  2.6109412e-16  0              3.0643139    
    300000   135.9          200            200            0.00021165584  1.1338095e-39  0              0.00063496751  194.15518      0              9.375059e+08   2.6109412e-16  0              3.0426368    
    400000   135.9          200            200           -6.1971277e-05  5.6696605e-40  0             -0.00018591383  23.603626      0              1.1397346e+08  2.6109412e-16  0              3.0085259    
    500000   135.9          200            200            1.076707e-05   1.4518024e-37  0              3.2301209e-05  0.65510394     0              3163262.5      2.6109412e-16  0              3.0002911    
    600000   135.9          200            200            0.0020868933   0.00027459574  0              0.0059860841   1.8716307      0              9037434.8      2.6109412e-16  0              2.9981225    
    700000   135.9          200            200            0.0043271427   0.00044870843  0              0.01253272     0.74446693     0              3594764.4      2.6109412e-16  0              2.9972401    
    800000   135.9          200            200            0.0036641375   0.00033771002  0              0.010654702    0.024670536    0              119125.19      2.6109412e-16  0              2.9974492    
    900000   135.9          200            200            0.0039808865   0.00036683941  0              0.01157582     0.015122782    0              73022.503      2.6109412e-16  0              2.9973464    
   1000000   135.9          200            200            0.0040230441   0.00036812668  0              0.011701006    0.00056633909  0              2734.6488      2.6109412e-16  0              2.9973321    
   1100000   135.9          200            200            0.0039659843   0.00036643632  0              0.011531517    5.2360787e-05  0              252.8315       2.6109412e-16  0              2.9973507    
   1200000   135.9          200            200            0.0039828383   0.00036694872  0              0.011581566    3.6952339e-05  0              178.42962      2.6109412e-16  0              2.9973452    
   1300000   135.9          200            200            0.0039838735   0.00036698317  0              0.011584637    2.0463088e-06  0              9.8808931      2.6109412e-16  0              2.9973449    
   1400000   135.9          200            200            0.003981182    0.00036690128  0              0.011576645    6.5129297e-08  0              0.31448607     2.6109412e-16  0              2.9973457    
   1500000   135.9          200            200            0.0039821097   0.00036692915  0              0.0115794      8.6886837e-08  0              0.41954544     2.6109412e-16  0              2.9973454    
   1600000   135.9          200            200            0.0039821059   0.0003669292   0              0.011579389    6.7853759e-09  0              0.032764152    2.6109412e-16  0              2.9973454    
   1700000   135.9          200            200            0.0039819819   0.00036692541  0              0.01157902     5.2057799e-11  0              0.00025136848  2.6109412e-16  0              2.9973455    
   1800000   135.9          200            200            0.0039820316   0.00036692691  0              0.011579168    1.9621334e-10  0              0.00094744402  2.6109412e-16  0              2.9973455    
   1900000   135.9          200            200            0.0039820287   0.00036692683  0              0.011579159    2.0969725e-11  0              0.0001012553   2.6109412e-16  0              2.9973455    
   2000000   135.9          200            200            0.0039820231   0.00036692666  0              0.011579143    6.254715e-15   0              3.020178e-08   2.6109412e-16  0              2.9973455    
   2100000   135.9          200            200            0.0039820257   0.00036692673  0              0.01157915     4.2380054e-13  0              2.0463811e-06  2.6109412e-16  0              2.9973455    
   2200000   135.9          200            200            0.0039820254   0.00036692673  0              0.01157915     6.1221542e-14  0              2.9561692e-07  2.6109412e-16  0              2.9973455    
   2300000   135.9          200            200            0.0039820252   0.00036692672  0              0.011579149    1.013166e-16   0              4.8922162e-10  2.6109412e-16  0              2.9973455    
   2400000   135.9          200            200            0.0039820253   0.00036692672  0              0.011579149    8.6335049e-16  0              4.1688105e-09  2.6109412e-16  0              2.9973455    
   2500000   135.9          200            200            0.0039820253   0.00036692672  0              0.011579149    1.6901906e-16  0              8.1613253e-10  2.6109412e-16  0              2.9973455    
   2600000   135.9          200            200            0.0039820253   0.00036692672  0              0.011579149    1.0915227e-18  0              5.2705724e-12  2.6109412e-16  0              2.9973455    
   2700000   135.9          200            200            0.0039820253   0.00036692672  0              0.011579149    2.5200304e-18  0              1.2168325e-11  2.6109412e-16  0              2.9973455    
   2800000   135.9          200            200            0.0039820253   0.00036692672  0              0.011579149    9.405463e-20   0              4.5415615e-13  2.6109412e-16  0              2.9973455    
   2900000   135.9          200            200            0.0039820253   0.00036692672  0              0.011579149    2.6937653e-21  0              1.3007229e-14  2.6109412e-16  0              2.9973455    
   3000000   135.9          200            200            0.0039820253   0.00036692672  0              0.011579149    1.0543838e-19  0              5.0912421e-13  2.6109412e-16  0              2.9973455    
Loop time of 65.6992 on 4 procs for 3000000 steps with 51 atoms

Performance: 39452565.079 ns/day, 0.000 hours/ns, 45662.691 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 0.32038    | 1.8046     | 6.0412     | 182.2 |  2.75
Neigh   | 0.071065   | 0.071602   | 0.07312    |   0.3 |  0.11
Comm    | 26.165     | 32.672     | 38.671     |  83.1 | 49.73
Output  | 0.060241   | 0.060322   | 0.060379   |   0.0 |  0.09
Modify  | 15.739     | 21.615     | 28.988     | 120.9 | 32.90
Other   |            | 9.476      |            |       | 14.42

Nlocal:          12.75 ave          51 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1
Nghost:          39.25 ave          52 max           1 min
Histogram: 1 0 0 0 0 0 0 0 0 3
Neighs:           6.75 ave          27 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1

Total # of neighbors = 27
Ave neighs/atom = 0.52941176
Neighbor list builds = 168
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 3

#variable lat0 equal 1                    #
variable lat1 equal 3+(151*0.01)+(v_ind*0.01)  # .491+(v_ind*0.001)       # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 10*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.54                                                               
Lattice spacing in x,y,z = 4.54 4.54 4.54

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -68.1 ${n1e1} -100 100 -100 100 units box
region box block -68.1 68.1 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -68.1 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -68.1 68.1 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-68.1 -100 -100) to (68.1 100 100)
  1 by 2 by 2 MPI processor grid
create_atoms 1 region substrate
Created 30 atoms
  using lattice units in orthogonal box = (-68.1 -100 -100) to (68.1 100 100)
  create_atoms CPU = 0.000 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 30 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 21 atoms
  using lattice units in orthogonal box = (-68.1 -100 -100) to (68.1 100 100)
  create_atoms CPU = 0.002 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  30 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  30 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  21 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  21 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
30 atoms in group substrate
group slider1 region slider1
21 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 21 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_3_*.dump id type diameter mass xu yu zu fx fy fz

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 88 130 130
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 14.44 | 17.91 | 19.07 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   136.2          200            200            0              0              0              0              0              0              0              2.6109412e-16  0              6            
    100000   136.2          200            200            0.0031586016   3.3939655e-39  0              0.0094758048   12427.226      0              6.0006627e+10  2.6109412e-16  0              3.3221533    
    200000   136.2          200            200            0.0011726704   6.2772546e-42  0              0.0035180113   3259.7143      0              1.5739994e+10  2.6109412e-16  0              3.0645975    
    300000   136.2          200            200            0.00018997791 -4.5216219e-39  0              0.00056993374  160.34506      0              7.7424892e+08  2.6109412e-16  0              3.0432146    
    400000   136.2          200            200           -0.00011894358  1.8146629e-38  0             -0.00035683074  96.758476      0              4.6721205e+08  2.6109412e-16  0              3.0043876    
    500000   136.2          200            200            0.01070187     0.0012201607   0              0.030885449    8.7342444      0              42174540       2.6109412e-16  0              2.9950104    
    600000   136.2          200            200            0.0046651763   0.00050147118  0              0.013494058    5.1255785      0              24749584       2.6109412e-16  0              2.9967497    
    700000   136.2          200            200            0.0048250588   0.00042966634  0              0.01404551     0.028342972    0              136858.07      2.6109412e-16  0              2.9966905    
    800000   136.2          200            200            0.0042701489   0.00042140045  0              0.012389046    0.018662366    0              90113.889      2.6109412e-16  0              2.9969045    
    900000   136.2          200            200            0.0040497278   0.00041734717  0              0.011731836    0.010006564    0              48318.119      2.6109412e-16  0              2.9969914    
   1000000   136.2          200            200            0.0039892506   0.00041615899  0              0.011551593    0.0018727632   0              9042.9034      2.6109412e-16  0              2.9970152    
   1100000   136.2          200            200            0.0039812207   0.00041600463  0              0.011527657    0.00017717459  0              855.51269      2.6109412e-16  0              2.9970183    
   1200000   136.2          200            200            0.0039844038   0.00041607234  0              0.011537139    5.7590246e-06  0              27.808269      2.6109412e-16  0              2.9970169    
   1300000   136.2          200            200            0.0039874675   0.00041613519  0              0.011546267    9.8088746e-08  0              0.47363545     2.6109412e-16  0              2.9970157    
   1400000   136.2          200            200            0.0039889372   0.000416165    0              0.011550647    2.6935589e-07  0              1.3006232      2.6109412e-16  0              2.9970151    
   1500000   136.2          200            200            0.0039894341   0.00041617498  0              0.011552127    7.8096671e-08  0              0.37710087     2.6109412e-16  0              2.9970149    
   1600000   136.2          200            200            0.0039895433   0.00041617714  0              0.011552453    1.062269e-08   0              0.05129317     2.6109412e-16  0              2.9970149    
   1700000   136.2          200            200            0.0039895438   0.00041617713  0              0.011552454    6.8108013e-10  0              0.0032886922   2.6109412e-16  0              2.9970149    
   1800000   136.2          200            200            0.0039895293   0.00041617683  0              0.011552411    5.0032618e-12  0              2.4158961e-05  2.6109412e-16  0              2.9970149    
   1900000   136.2          200            200            0.0039895203   0.00041617665  0              0.011552384    4.5979937e-12  0              2.2202066e-05  2.6109412e-16  0              2.9970149    
   2000000   136.2          200            200            0.0039895166   0.00041617657  0              0.011552373    2.6647833e-12  0              1.2867285e-05  2.6109412e-16  0              2.9970149    
   2100000   136.2          200            200            0.0039895156   0.00041617655  0              0.01155237     5.2155405e-13  0              2.5183978e-06  2.6109412e-16  0              2.9970149    
   2200000   136.2          200            200            0.0039895154   0.00041617655  0              0.01155237     5.1537532e-14  0              2.488563e-07   2.6109412e-16  0              2.9970149    
   2300000   136.2          200            200            0.0039895155   0.00041617655  0              0.01155237     1.8574787e-15  0              8.9691001e-09  2.6109412e-16  0              2.9970149    
   2400000   136.2          200            200            0.0039895155   0.00041617655  0              0.01155237     1.67998e-17    0              8.1120221e-11  2.6109412e-16  0              2.9970149    
   2500000   136.2          200            200            0.0039895155   0.00041617655  0              0.01155237     6.8648973e-17  0              3.3148132e-10  2.6109412e-16  0              2.9970149    
   2600000   136.2          200            200            0.0039895155   0.00041617655  0              0.01155237     2.1604324e-17  0              1.0431955e-10  2.6109412e-16  0              2.9970149    
   2700000   136.2          200            200            0.0039895156   0.00041617655  0              0.01155237     2.4272384e-18  0              1.1720265e-11  2.6109412e-16  0              2.9970149    
   2800000   136.2          200            200            0.0039895155   0.00041617655  0              0.01155237     1.6844857e-19  0              8.1337788e-13  2.6109412e-16  0              2.9970149    
   2900000   136.2          200            200            0.0039895156   0.00041617655  0              0.01155237     6.9028313e-21  0              3.3331302e-14  2.6109412e-16  0              2.9970149    
   3000000   136.2          200            200            0.0039895156   0.00041617655  0              0.01155237     2.6974202e-20  0              1.3024877e-13  2.6109412e-16  0              2.9970149    
Loop time of 66.0456 on 4 procs for 3000000 steps with 51 atoms

Performance: 39245592.348 ns/day, 0.000 hours/ns, 45423.139 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 0.31022    | 1.7273     | 5.7406     | 176.4 |  2.62
Neigh   | 0.070976   | 0.071581   | 0.073247   |   0.4 |  0.11
Comm    | 26.138     | 32.749     | 38.654     |  83.9 | 49.58
Output  | 0.061176   | 0.061256   | 0.061311   |   0.0 |  0.09
Modify  | 15.772     | 21.758     | 29.103     | 119.3 | 32.94
Other   |            | 9.679      |            |       | 14.65

Nlocal:          12.75 ave          51 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1
Nghost:          39.25 ave          52 max           1 min
Histogram: 1 0 0 0 0 0 0 0 0 3
Neighs:           6.75 ave          27 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1

Total # of neighbors = 27
Ave neighs/atom = 0.52941176
Neighbor list builds = 168
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 4

#variable lat0 equal 1                    #
variable lat1 equal 3+(151*0.01)+(v_ind*0.01)  # .491+(v_ind*0.001)       # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 10*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.55                                                               
Lattice spacing in x,y,z = 4.55 4.55 4.55

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -68.25 ${n1e1} -100 100 -100 100 units box
region box block -68.25 68.25 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -68.25 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -68.25 68.25 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-68.25 -100 -100) to (68.25 100 100)
  1 by 2 by 2 MPI processor grid
create_atoms 1 region substrate
Created 30 atoms
  using lattice units in orthogonal box = (-68.25 -100 -100) to (68.25 100 100)
  create_atoms CPU = 0.000 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 30 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 21 atoms
  using lattice units in orthogonal box = (-68.25 -100 -100) to (68.25 100 100)
  create_atoms CPU = 0.003 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  30 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  30 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  21 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  21 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
30 atoms in group substrate
group slider1 region slider1
21 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 21 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_4_*.dump id type diameter mass xu yu zu fx fy fz

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 89 130 130
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 14.46 | 17.93 | 19.09 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   136.5          200            200            0              0              0              0              0              0              0              2.6109412e-16  0              6            
    100000   136.5          200            200            0.003147337   -1.2415908e-38  0              0.0094420111   12403.37       0              5.9891436e+10  2.6109412e-16  0              3.3224782    
    200000   136.5          200            200            0.0011585345   6.7726192e-39  0              0.0034756034   3210.228       0              1.5501042e+10  2.6109412e-16  0              3.0660663    
    300000   136.5          200            200            0.00016278677 -3.6105758e-38  0              0.00048836031  121.43019      0              5.8634291e+08  2.6109412e-16  0              3.0441639    
    400000   136.5          200            200            0.00079598515  1.9741648e-05  0              0.0023682138   215.22687      0              1.0392535e+09  2.6109412e-16  0              2.99817      
    500000   136.5          200            200            0.00013474828  8.0260487e-36  0              0.00040424485  3.259015       0              15736617       2.6109412e-16  0              2.9994295    
    600000   136.5          200            200            0.0032403639   0.00046385768  0              0.0092572341   4.864033       0              23486674       2.6109412e-16  0              2.9969646    
    700000   136.5          200            200            0.0047281058   0.00046339631  0              0.013720921    0.1664627      0              803788.81      2.6109412e-16  0              2.9963647    
    800000   136.5          200            200            0.003778974    0.00044149218  0              0.01089543     0.048985969    0              236535.71      2.6109412e-16  0              2.9967423    
    900000   136.5          200            200            0.0039339952   0.00044610245  0              0.011355883    0.010006036    0              48315.569      2.6109412e-16  0              2.9966766    
   1000000   136.5          200            200            0.0040300339   0.00044864615  0              0.011641455    0.00015131056  0              730.62455      2.6109412e-16  0              2.9966379    
   1100000   136.5          200            200            0.0039919244   0.00044763046  0              0.011528143    0.00024717926  0              1193.5402      2.6109412e-16  0              2.9966535    
   1200000   136.5          200            200            0.0039856506   0.000447469    0              0.011509483    1.1895453e-06  0              5.7438884      2.6109412e-16  0              2.996656     
   1300000   136.5          200            200            0.0039919001   0.00044763636  0              0.011528064    3.7498394e-06  0              18.106632      2.6109412e-16  0              2.9966534    
   1400000   136.5          200            200            0.0039916559   0.00044762894  0              0.011527339    2.3681073e-07  0              1.1434743      2.6109412e-16  0              2.9966535    
   1500000   136.5          200            200            0.0039908529   0.00044760763  0              0.011524951    3.1269292e-08  0              0.15098822     2.6109412e-16  0              2.9966539    
   1600000   136.5          200            200            0.0039910265   0.00044761236  0              0.011525467    9.3714366e-09  0              0.045251313    2.6109412e-16  0              2.9966538    
   1700000   136.5          200            200            0.0039911048   0.00044761442  0              0.0115257      4.8723338e-11  0              0.00023526756  2.6109412e-16  0              2.9966538    
   1800000   136.5          200            200            0.0039910676   0.00044761342  0              0.011525589    2.0510415e-10  0              0.00099037454  2.6109412e-16  0              2.9966538    
   1900000   136.5          200            200            0.0039910635   0.00044761332  0              0.011525577    2.4424037e-12  0              1.1793493e-05  2.6109412e-16  0              2.9966538    
   2000000   136.5          200            200            0.0039910692   0.00044761347  0              0.011525594    2.7700322e-12  0              1.3375494e-05  2.6109412e-16  0              2.9966538    
   2100000   136.5          200            200            0.0039910688   0.00044761346  0              0.011525593    2.5291223e-13  0              1.2212227e-06  2.6109412e-16  0              2.9966538    
   2200000   136.5          200            200            0.0039910681   0.00044761344  0              0.011525591    1.8821012e-14  0              9.0879932e-08  2.6109412e-16  0              2.9966538    
   2300000   136.5          200            200            0.0039910683   0.00044761344  0              0.011525591    8.4781853e-15  0              4.0938123e-08  2.6109412e-16  0              2.9966538    
   2400000   136.5          200            200            0.0039910683   0.00044761344  0              0.011525592    7.0151531e-18  0              3.3873664e-11  2.6109412e-16  0              2.9966538    
   2500000   136.5          200            200            0.0039910683   0.00044761344  0              0.011525591    1.6670568e-16  0              8.0496209e-10  2.6109412e-16  0              2.9966538    
   2600000   136.5          200            200            0.0039910683   0.00044761344  0              0.011525591    3.6610776e-18  0              1.7678033e-11  2.6109412e-16  0              2.9966538    
   2700000   136.5          200            200            0.0039910683   0.00044761344  0              0.011525591    1.1465686e-18  0              5.5363694e-12  2.6109412e-16  0              2.9966538    
   2800000   136.5          200            200            0.0039910683   0.00044761344  0              0.011525591    2.4315441e-19  0              1.1741056e-12  2.6109412e-16  0              2.9966538    
   2900000   136.5          200            200            0.0039910683   0.00044761344  0              0.011525591    5.685305e-20   0              2.7452303e-13  2.6109412e-16  0              2.9966538    
   3000000   136.5          200            200            0.0039910683   0.00044761344  0              0.011525591    3.7882246e-20  0              1.8291981e-13  2.6109412e-16  0              2.9966538    
Loop time of 65.3181 on 4 procs for 3000000 steps with 51 atoms

Performance: 39682696.556 ns/day, 0.000 hours/ns, 45929.047 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 0.29969    | 1.7021     | 5.6794     | 176.1 |  2.61
Neigh   | 0.071705   | 0.072291   | 0.073834   |   0.3 |  0.11
Comm    | 25.994     | 32.568     | 38.409     |  83.3 | 49.86
Output  | 0.059821   | 0.059895   | 0.059944   |   0.0 |  0.09
Modify  | 15.66      | 21.504     | 28.841     | 120.0 | 32.92
Other   |            | 9.411      |            |       | 14.41

Nlocal:          12.75 ave          51 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1
Nghost:          39.25 ave          52 max           1 min
Histogram: 1 0 0 0 0 0 0 0 0 3
Neighs:           6.75 ave          27 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1

Total # of neighbors = 27
Ave neighs/atom = 0.52941176
Neighbor list builds = 168
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 5

#variable lat0 equal 1                    #
variable lat1 equal 3+(151*0.01)+(v_ind*0.01)  # .491+(v_ind*0.001)       # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 10*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.56                                                               
Lattice spacing in x,y,z = 4.56 4.56 4.56

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -68.4 ${n1e1} -100 100 -100 100 units box
region box block -68.4 68.4 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -68.4 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -68.4 68.4 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-68.4 -100 -100) to (68.4 100 100)
  1 by 2 by 2 MPI processor grid
create_atoms 1 region substrate
Created 30 atoms
  using lattice units in orthogonal box = (-68.4 -100 -100) to (68.4 100 100)
  create_atoms CPU = 0.000 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 30 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 21 atoms
  using lattice units in orthogonal box = (-68.4 -100 -100) to (68.4 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  30 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  30 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  21 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  21 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
30 atoms in group substrate
group slider1 region slider1
21 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 21 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_5_*.dump id type diameter mass xu yu zu fx fy fz

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 89 130 130
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 14.46 | 17.93 | 19.09 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   136.8          200            200            0              0              0              0              0              0              0              2.6109412e-16  0              6            
    100000   136.8          200            200            0.0031352351   1.0816875e-37  0              0.0094057052   12373.667      0              5.9748011e+10  2.6109412e-16  0              3.3232359    
    200000   136.8          200            200            0.0011411322  -2.2524394e-38  0              0.0034233966   3146.2067      0              1.5191906e+10  2.6109412e-16  0              3.0685139    
    300000   136.8          200            200            0.00013813054  2.7039468e-38  0              0.00041439162  90.057211      0              4.3485404e+08  2.6109412e-16  0              3.0448351    
    400000   136.8          200            200            0.019763059    0.003250845    0              0.056038333    62.891925      0              3.036826e+08   2.6109412e-16  0              2.9918009    
    500000   136.8          200            200            0.008591993    0.0013261036   0              0.024449875    20.714269      0              1.0002179e+08  2.6109412e-16  0              2.9946568    
    600000   136.8          200            200            0.002587546    0.00022029623  0              0.0075423418   3.1571642      0              15244816       2.6109412e-16  0              2.9968418    
    700000   136.8          200            200            0.0032584795   0.00034780414  0              0.0094276343   0.12203915     0              589283.37      2.6109412e-16  0              2.9965472    
    800000   136.8          200            200            0.0041849712   0.00040782278  0              0.012147091    0.043651314    0              210776.57      2.6109412e-16  0              2.996148     
    900000   136.8          200            200            0.0039924631   0.00040241731  0              0.011574972    0.012292368    0              59355.446      2.6109412e-16  0              2.9962265    
   1000000   136.8          200            200            0.0039285929   0.00040035491  0              0.011385424    9.3870605e-05  0              453.26755      2.6109412e-16  0              2.9962541    
   1100000   136.8          200            200            0.0039763773   0.00040186733  0              0.011527265    0.00013564639  0              654.98785      2.6109412e-16  0              2.9962339    
   1200000   136.8          200            200            0.0039686228   0.0004016326   0              0.011504236    2.8331062e-05  0              136.80056      2.6109412e-16  0              2.9962371    
   1300000   136.8          200            200            0.0039648226   0.00040151107  0              0.011492957    6.6565132e-08  0              0.3214192      2.6109412e-16  0              2.9962387    
   1400000   136.8          200            200            0.0039671812   0.00040158488  0              0.011499959    3.9857002e-07  0              1.924552       2.6109412e-16  0              2.9962377    
   1500000   136.8          200            200            0.003966883    0.00040157592  0              0.011499073    6.3704671e-08  0              0.30760706     2.6109412e-16  0              2.9962378    
   1600000   136.8          200            200            0.0039666666   0.00040156902  0              0.011498431    2.3141328e-12  0              1.1174119e-05  2.6109412e-16  0              2.9962379    
   1700000   136.8          200            200            0.0039667815   0.00040157261  0              0.011498772    1.1309458e-09  0              0.0054609326   2.6109412e-16  0              2.9962379    
   1800000   136.8          200            200            0.0039667712   0.00040157231  0              0.011498741    1.3902668e-10  0              0.00067131009  2.6109412e-16  0              2.9962379    
   1900000   136.8          200            200            0.0039667592   0.00040157192  0              0.011498706    2.388516e-13   0              1.1533289e-06  2.6109412e-16  0              2.9962379    
   2000000   136.8          200            200            0.0039667647   0.0004015721   0              0.011498722    3.1109083e-12  0              1.5021463e-05  2.6109412e-16  0              2.9962379    
   2100000   136.8          200            200            0.0039667644   0.00040157209  0              0.011498721    2.9318064e-13  0              1.4156644e-06  2.6109412e-16  0              2.9962379    
   2200000   136.8          200            200            0.0039667638   0.00040157207  0              0.011498719    2.7088105e-15  0              1.3079877e-08  2.6109412e-16  0              2.9962379    
   2300000   136.8          200            200            0.0039667641   0.00040157208  0              0.01149872     8.3158513e-15  0              4.015427e-08   2.6109412e-16  0              2.9962379    
   2400000   136.8          200            200            0.003966764    0.00040157208  0              0.01149872     5.928394e-16   0              2.8626093e-09  2.6109412e-16  0              2.9962379    
   2500000   136.8          200            200            0.003966764    0.00040157208  0              0.01149872     1.5388361e-17  0              7.4304888e-11  2.6109412e-16  0              2.9962379    
   2600000   136.8          200            200            0.003966764    0.00040157208  0              0.01149872     2.1735419e-17  0              1.0495256e-10  2.6109412e-16  0              2.9962379    
   2700000   136.8          200            200            0.003966764    0.00040157208  0              0.01149872     3.6192223e-19  0              1.7475929e-12  2.6109412e-16  0              2.9962379    
   2800000   136.8          200            200            0.003966764    0.00040157208  0              0.01149872     3.8522041e-19  0              1.8600915e-12  2.6109412e-16  0              2.9962379    
   2900000   136.8          200            200            0.003966764    0.00040157208  0              0.01149872     6.2249387e-20  0              3.0058001e-13  2.6109412e-16  0              2.9962379    
   3000000   136.8          200            200            0.003966764    0.00040157208  0              0.01149872     2.2999801e-21  0              1.1105781e-14  2.6109412e-16  0              2.9962379    
Loop time of 65.1165 on 4 procs for 3000000 steps with 51 atoms

Performance: 39805577.827 ns/day, 0.000 hours/ns, 46071.271 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 0.31151    | 1.6689     | 5.5548     | 173.7 |  2.56
Neigh   | 0.070859   | 0.07147    | 0.073013   |   0.3 |  0.11
Comm    | 25.986     | 32.55      | 38.36      |  83.2 | 49.99
Output  | 0.061701   | 0.061775   | 0.06183    |   0.0 |  0.09
Modify  | 15.607     | 21.408     | 28.758     | 120.5 | 32.88
Other   |            | 9.356      |            |       | 14.37

Nlocal:          12.75 ave          51 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1
Nghost:          39.25 ave          52 max           1 min
Histogram: 1 0 0 0 0 0 0 0 0 3
Neighs:           6.75 ave          27 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1

Total # of neighbors = 27
Ave neighs/atom = 0.52941176
Neighbor list builds = 166
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 6

#variable lat0 equal 1                    #
variable lat1 equal 3+(151*0.01)+(v_ind*0.01)  # .491+(v_ind*0.001)       # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 10*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.57                                                               
Lattice spacing in x,y,z = 4.57 4.57 4.57

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -68.55 ${n1e1} -100 100 -100 100 units box
region box block -68.55 68.55 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -68.55 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -68.55 68.55 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-68.55 -100 -100) to (68.55 100 100)
  1 by 2 by 2 MPI processor grid
create_atoms 1 region substrate
Created 29 atoms
  using lattice units in orthogonal box = (-68.55 -100 -100) to (68.55 100 100)
  create_atoms CPU = 0.000 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 30 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 21 atoms
  using lattice units in orthogonal box = (-68.55 -100 -100) to (68.55 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  29 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  29 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  21 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  21 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
29 atoms in group substrate
group slider1 region slider1
21 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 21 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_6_*.dump id type diameter mass xu yu zu fx fy fz

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 89 130 130
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 14.46 | 17.93 | 19.09 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   137.1          200            200            0              0              0              0              0              0              0              2.6109412e-16  0              6            
    100000   137.1          200            200            0.003122541   -4.4940091e-38  0              0.0093676229   12339.392      0              6.6202785e+10  2.6109412e-16  0              3.3244331    
    200000   137.1          200            200            0.0011251462   5.3961616e-38  0              0.0033754386   3088.3064      0              1.6569251e+10  2.6109412e-16  0              3.0707286    
    300000   137.1          200            200            0.000111575   -6.4643271e-37  0              0.000334725    60.720618      0              3.257757e+08   2.6109412e-16  0              3.0455015    
    400000   137.1          200            200            0.021535313    0.0034667394   0              0.061139201    22.859707      0              1.2264594e+08  2.6109412e-16  0              2.9908879    
    500000   137.1          200            200            0.0018016466  -1.1910231e-36  0              0.0054049398   27.672731      0              1.4846857e+08  2.6109412e-16  0              2.997182     
    600000   137.1          200            200            0.0052236957   0.00043425027  0              0.015236837    3.4685914      0              18609540       2.6109412e-16  0              2.9952666    
    700000   137.1          200            200            0.0038600569   0.00032581235  0              0.011254358    0.68826305     0              3692639.9      2.6109412e-16  0              2.9958171    
    800000   137.1          200            200            0.0040321847   0.00027748914  0              0.011819065    0.076011734    0              407814.96      2.6109412e-16  0              2.9957381    
    900000   137.1          200            200            0.0038323942   0.00027104064  0              0.011226142    0.0040601743   0              21783.476      2.6109412e-16  0              2.9958262    
   1000000   137.1          200            200            0.0039522754   0.00027513058  0              0.011581696    1.025355e-05   0              55.011917      2.6109412e-16  0              2.9957723    
   1100000   137.1          200            200            0.0039030625   0.0002734992   0              0.011435688    4.4314566e-05  0              237.75464      2.6109412e-16  0              2.9957945    
   1200000   137.1          200            200            0.0039179674   0.00027400706  0              0.011479895    2.1632604e-05  0              116.06233      2.6109412e-16  0              2.9957877    
   1300000   137.1          200            200            0.0039151811   0.00027391062  0              0.011471633    4.1726447e-06  0              22.386898      2.6109412e-16  0              2.995789     
   1400000   137.1          200            200            0.0039149277   0.00027390337  0              0.01147088     4.4065538e-07  0              2.3641857      2.6109412e-16  0              2.9957891    
   1500000   137.1          200            200            0.0039154653   0.00027392103  0              0.011472475    2.0683261e-08  0              0.11096896     2.6109412e-16  0              2.9957888    
   1600000   137.1          200            200            0.0039151593   0.00027391083  0              0.011471567    1.4712008e-12  0              7.8932243e-06  2.6109412e-16  0              2.995789     
   1700000   137.1          200            200            0.0039152803   0.0002739149   0              0.011471926    3.4942759e-10  0              0.0018747342   2.6109412e-16  0              2.9957889    
   1800000   137.1          200            200            0.0039152451   0.00027391371  0              0.011471822    1.4394046e-10  0              0.0007722633   2.6109412e-16  0              2.9957889    
   1900000   137.1          200            200            0.003915251    0.00027391391  0              0.011471839    2.5659141e-11  0              0.00013766534  2.6109412e-16  0              2.9957889    
   2000000   137.1          200            200            0.003915252    0.00027391394  0              0.011471842    2.5064993e-12  0              1.3447765e-05  2.6109412e-16  0              2.9957889    
   2100000   137.1          200            200            0.0039152506   0.0002739139   0              0.011471838    1.0032809e-13  0              5.3827603e-07  2.6109412e-16  0              2.9957889    
   2200000   137.1          200            200            0.0039152514   0.00027391392  0              0.01147184     1.8854384e-16  0              1.0115675e-09  2.6109412e-16  0              2.9957889    
   2300000   137.1          200            200            0.0039152511   0.00027391391  0              0.011471839    2.6616449e-15  0              1.4280145e-08  2.6109412e-16  0              2.9957889    
   2400000   137.1          200            200            0.0039152511   0.00027391392  0              0.01147184     9.4525155e-16  0              5.0714238e-09  2.6109412e-16  0              2.9957889    
   2500000   137.1          200            200            0.0039152511   0.00027391391  0              0.011471839    1.5635843e-16  0              8.3888765e-10  2.6109412e-16  0              2.9957889    
   2600000   137.1          200            200            0.0039152511   0.00027391391  0              0.011471839    1.3489505e-17  0              7.2373322e-11  2.6109412e-16  0              2.9957889    
   2700000   137.1          200            200            0.0039152511   0.00027391391  0              0.011471839    1.2636934e-18  0              6.7799145e-12  2.6109412e-16  0              2.9957889    
   2800000   137.1          200            200            0.0039152511   0.00027391391  0              0.011471839    1.41303e-19    0              7.581129e-13   2.6109412e-16  0              2.9957889    
   2900000   137.1          200            200            0.0039152511   0.00027391391  0              0.011471839    1.2016242e-20  0              6.4469035e-14  2.6109412e-16  0              2.9957889    
   3000000   137.1          200            200            0.0039152511   0.00027391391  0              0.011471839    3.6214012e-20  0              1.9429389e-13  2.6109412e-16  0              2.9957889    
Loop time of 63.1817 on 4 procs for 3000000 steps with 50 atoms

Performance: 41024511.766 ns/day, 0.000 hours/ns, 47482.074 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 0.30982    | 1.5968     | 5.2941     | 169.0 |  2.53
Neigh   | 0.070868   | 0.071424   | 0.072903   |   0.3 |  0.11
Comm    | 25.212     | 31.553     | 37.216     |  82.2 | 49.94
Output  | 0.059473   | 0.05955    | 0.059608   |   0.0 |  0.09
Modify  | 15.177     | 20.832     | 27.913     | 118.5 | 32.97
Other   |            | 9.069      |            |       | 14.35

Nlocal:           12.5 ave          50 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1
Nghost:           37.5 ave          50 max           0 min
Histogram: 1 0 0 0 0 0 0 0 0 3
Neighs:           6.75 ave          27 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1

Total # of neighbors = 27
Ave neighs/atom = 0.54
Neighbor list builds = 166
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 7

#variable lat0 equal 1                    #
variable lat1 equal 3+(151*0.01)+(v_ind*0.01)  # .491+(v_ind*0.001)       # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 10*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.58                                                               
Lattice spacing in x,y,z = 4.58 4.58 4.58

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -68.7 ${n1e1} -100 100 -100 100 units box
region box block -68.7 68.7 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -68.7 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -68.7 68.7 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-68.7 -100 -100) to (68.7 100 100)
  1 by 2 by 2 MPI processor grid
create_atoms 1 region substrate
Created 30 atoms
  using lattice units in orthogonal box = (-68.7 -100 -100) to (68.7 100 100)
  create_atoms CPU = 0.000 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 30 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 21 atoms
  using lattice units in orthogonal box = (-68.7 -100 -100) to (68.7 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  30 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  30 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  21 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  21 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
30 atoms in group substrate
group slider1 region slider1
21 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 21 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_7_*.dump id type diameter mass xu yu zu fx fy fz

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 89 130 130
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 14.46 | 17.93 | 19.09 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   137.4          200            200            0              0              0              0              0              0              0              2.6109412e-16  0              6            
    100000   137.4          200            200            0.0031098351  -1.7929113e-38  0              0.0093295054   12304.228      0              5.9412715e+10  2.6109412e-16  0              3.3258434    
    200000   137.4          200            200            0.0011097426   7.1795576e-38  0              0.0033292278   3032.8799      0              1.4644692e+10  2.6109412e-16  0              3.072884     
    300000   137.4          200            200            9.0063981e-05  7.2292868e-37  0              0.00027019194  40.712848      0              1.9658777e+08  2.6109412e-16  0              3.0458005    
    400000   137.4          200            200            0.01167313     0.0015169636   0              0.033502427    168.96451      0              8.1586913e+08  2.6109412e-16  0              2.9927109    
    500000   137.4          200            200            0.0031443459   3.4786394e-08  0              0.009433003    33.140442      0              1.6002333e+08  2.6109412e-16  0              2.9957304    
    600000   137.4          200            200            0.0031240678   1.2541737e-37  0              0.0093722034   3.7164311      0              17945316       2.6109412e-16  0              2.9958353    
    700000   137.4          200            200            0.0043345511   0.00013874359  0              0.01286491     0.34641119     0              1672695.6      2.6109412e-16  0              2.9951175    
    800000   137.4          200            200            0.0036786801   5.274479e-05   0              0.010983296    0.049068955    0              236936.42      2.6109412e-16  0              2.9954427    
    900000   137.4          200            200            0.0037541415   7.6346992e-05  0              0.011186077    0.00014037764  0              677.83337      2.6109412e-16  0              2.9954028    
   1000000   137.4          200            200            0.0038243253   7.8751872e-05  0              0.011394224    0.0011293406   0              5453.1817      2.6109412e-16  0              2.9953644    
   1100000   137.4          200            200            0.0038455946   7.9376916e-05  0              0.011457407    0.00018362295  0              886.64951      2.6109412e-16  0              2.9953531    
   1200000   137.4          200            200            0.0038456541   7.9373931e-05  0              0.011457588    2.5506302e-06  0              12.31608       2.6109412e-16  0              2.9953532    
   1300000   137.4          200            200            0.0038428059   7.9290331e-05  0              0.011449127    1.2264951e-06  0              5.9223059      2.6109412e-16  0              2.9953547    
   1400000   137.4          200            200            0.0038415058   7.9252575e-05  0              0.011445265    5.1734031e-07  0              2.4980512      2.6109412e-16  0              2.9953554    
   1500000   137.4          200            200            0.0038413003   7.9246785e-05  0              0.011444654    3.1341627e-08  0              0.1513375      2.6109412e-16  0              2.9953555    
   1600000   137.4          200            200            0.0038413828   7.9249273e-05  0              0.011444899    2.8465518e-10  0              0.001374498    2.6109412e-16  0              2.9953555    
   1700000   137.4          200            200            0.0038414481   7.9251188e-05  0              0.011445093    1.0001199e-09  0              0.0048292213   2.6109412e-16  0              2.9953555    
   1800000   137.4          200            200            0.0038414666   7.9251721e-05  0              0.011445148    1.4615347e-10  0              0.00070572281  2.6109412e-16  0              2.9953554    
   1900000   137.4          200            200            0.0038414662   7.9251704e-05  0              0.011445147    1.4756053e-12  0              7.1251698e-06  2.6109412e-16  0              2.9953554    
   2000000   137.4          200            200            0.0038414635   7.9251625e-05  0              0.011445139    1.1747456e-12  0              5.672426e-06   2.6109412e-16  0              2.9953554    
   2100000   137.4          200            200            0.0038414624   7.9251591e-05  0              0.011445135    4.3161083e-13  0              2.0840942e-06  2.6109412e-16  0              2.9953554    
   2200000   137.4          200            200            0.0038414622   7.9251586e-05  0              0.011445135    2.3047205e-14  0              1.112867e-07   2.6109412e-16  0              2.9953554    
   2300000   137.4          200            200            0.0038414623   7.9251588e-05  0              0.011445135    3.9386333e-16  0              1.9018251e-09  2.6109412e-16  0              2.9953554    
   2400000   137.4          200            200            0.0038414623   7.925159e-05   0              0.011445135    8.7129424e-16  0              4.2071681e-09  2.6109412e-16  0              2.9953554    
   2500000   137.4          200            200            0.0038414624   7.9251591e-05  0              0.011445135    1.1667649e-16  0              5.63389e-10    2.6109412e-16  0              2.9953554    
   2600000   137.4          200            200            0.0038414624   7.9251591e-05  0              0.011445135    1.1847753e-18  0              5.7208561e-12  2.6109412e-16  0              2.9953554    
   2700000   137.4          200            200            0.0038414623   7.9251591e-05  0              0.011445135    1.6611135e-18  0              8.0209226e-12  2.6109412e-16  0              2.9953554    
   2800000   137.4          200            200            0.0038414623   7.9251591e-05  0              0.011445135    2.3790241e-19  0              1.1487456e-12  2.6109412e-16  0              2.9953554    
   2900000   137.4          200            200            0.0038414623   7.9251591e-05  0              0.011445135    1.345849e-19   0              6.4986232e-13  2.6109412e-16  0              2.9953554    
   3000000   137.4          200            200            0.0038414623   7.925159e-05   0              0.011445135    1.847466e-20   0              8.920752e-14   2.6109412e-16  0              2.9953554    
Loop time of 64.5171 on 4 procs for 3000000 steps with 51 atoms

Performance: 40175423.231 ns/day, 0.000 hours/ns, 46499.332 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 0.28974    | 1.679      | 5.5929     | 174.5 |  2.60
Neigh   | 0.070039   | 0.07058    | 0.072073   |   0.3 |  0.11
Comm    | 25.733     | 32.524     | 38.381     |  85.1 | 50.41
Output  | 0.062082   | 0.062155   | 0.062207   |   0.0 |  0.10
Modify  | 15.309     | 21.164     | 28.685     | 123.2 | 32.80
Other   |            | 9.018      |            |       | 13.98

Nlocal:          12.75 ave          51 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1
Nghost:          39.25 ave          52 max           1 min
Histogram: 1 0 0 0 0 0 0 0 0 3
Neighs:           6.75 ave          27 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1

Total # of neighbors = 27
Ave neighs/atom = 0.52941176
Neighbor list builds = 164
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 8

#variable lat0 equal 1                    #
variable lat1 equal 3+(151*0.01)+(v_ind*0.01)  # .491+(v_ind*0.001)       # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 10*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.59                                                               
Lattice spacing in x,y,z = 4.59 4.59 4.59

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -68.85 ${n1e1} -100 100 -100 100 units box
region box block -68.85 68.85 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -68.85 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -68.85 68.85 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-68.85 -100 -100) to (68.85 100 100)
  1 by 2 by 2 MPI processor grid
create_atoms 1 region substrate
Created 30 atoms
  using lattice units in orthogonal box = (-68.85 -100 -100) to (68.85 100 100)
  create_atoms CPU = 0.000 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 30 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 21 atoms
  using lattice units in orthogonal box = (-68.85 -100 -100) to (68.85 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  30 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  30 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  21 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  21 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
30 atoms in group substrate
group slider1 region slider1
21 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 21 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_8_*.dump id type diameter mass xu yu zu fx fy fz

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 89 130 130
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 14.46 | 17.93 | 19.09 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   137.7          200            200            0              0              0              0              0              0              0              2.6109412e-16  0              6            
    100000   137.7          200            200            0.0030982781   2.1491369e-37  0              0.0092948343   12276.065      0              5.9276725e+10  2.6109412e-16  0              3.3268235    
    200000   137.7          200            200            0.0010942027   3.9398165e-37  0              0.0032826081   2976.7796      0              1.4373803e+10  2.6109412e-16  0              3.0751758    
    300000   137.7          200            200            7.5387339e-05  1.1513892e-36  0              0.00022616202  29.149913      0              1.407545e+08   2.6109412e-16  0              3.0457214    
    400000   137.7          200            200            0.0027795051  -1.6881071e-37  0              0.0083385153   207.14943      0              1.0002504e+09  2.6109412e-16  0              2.9963224    
    500000   137.7          200            200            0.0010360869   1.076321e-35   0              0.0031082606   7.6762878      0              37066046       2.6109412e-16  0              2.99804      
    600000   137.7          200            200            0.0030939926  -2.1254905e-36  0              0.0092819778   2.8022562      0              13531093       2.6109412e-16  0              2.9958137    
    700000   137.7          200            200            0.0034669779   4.727814e-36   0              0.010400934    0.27008059     0              1304122.5      2.6109412e-16  0              2.9954984    
    800000   137.7          200            200            0.0037020161   1.9462399e-37  0              0.011106048    0.047933386    0              231453.17      2.6109412e-16  0              2.9953007    
    900000   137.7          200            200            0.0037759848  -1.1677976e-37  0              0.011327954    0.0077520393   0              37431.823      2.6109412e-16  0              2.9952397    
   1000000   137.7          200            200            0.0037984015   1.4218072e-37  0              0.011395204    0.0011858988   0              5726.2811      2.6109412e-16  0              2.9952215    
   1100000   137.7          200            200            0.0038047482   6.3535973e-39  0              0.011414245    0.00017333624  0              836.97865      2.6109412e-16  0              2.9952164    
   1200000   137.7          200            200            0.0038063415  -1.2570898e-39  0              0.011419024    2.4308686e-05  0              117.37795      2.6109412e-16  0              2.9952151    
   1300000   137.7          200            200            0.0038066439  -2.5894166e-40  0              0.011419932    3.2763547e-06  0              15.820344      2.6109412e-16  0              2.9952149    
   1400000   137.7          200            200            0.0038066486   2.6465527e-39  0              0.011419946    4.2435869e-07  0              2.0490762      2.6109412e-16  0              2.9952149    
   1500000   137.7          200            200            0.0038066112  -1.3362171e-38  0              0.011419834    5.2724477e-08  0              0.25458763     2.6109412e-16  0              2.995215     
   1600000   137.7          200            200            0.0038065833   1.2686522e-38  0              0.01141975     6.2603743e-09  0              0.030229107    2.6109412e-16  0              2.995215     
   1700000   137.7          200            200            0.003806568    5.2606941e-39  0              0.011419704    7.0584694e-10  0              0.0034082823   2.6109412e-16  0              2.995215     
   1800000   137.7          200            200            0.0038065607  -5.4134732e-39  0              0.011419682    7.4777022e-11  0              0.00036107148  2.6109412e-16  0              2.995215     
   1900000   137.7          200            200            0.0038065574  -1.425293e-39   0              0.011419672    7.3135934e-12  0              3.5314725e-05  2.6109412e-16  0              2.995215     
   2000000   137.7          200            200            0.003806556   -6.6597524e-40  0              0.011419668    6.3985306e-13  0              3.0896214e-06  2.6109412e-16  0              2.995215     
   2100000   137.7          200            200            0.0038065554   4.7067212e-39  0              0.011419666    4.6993533e-14  0              2.2691495e-07  2.6109412e-16  0              2.995215     
   2200000   137.7          200            200            0.0038065552   5.7522529e-39  0              0.011419666    2.4691398e-15  0              1.1922592e-08  2.6109412e-16  0              2.995215     
   2300000   137.7          200            200            0.0038065551  -8.7074241e-39  0              0.011419665    4.6703163e-17  0              2.2551286e-10  2.6109412e-16  0              2.995215     
   2400000   137.7          200            200            0.003806555    6.0961176e-39  0              0.011419665    3.4702728e-18  0              1.6756705e-11  2.6109412e-16  0              2.995215     
   2500000   137.7          200            200            0.003806555   -3.5322863e-39  0              0.011419665    4.9532817e-18  0              2.3917625e-11  2.6109412e-16  0              2.995215     
   2600000   137.7          200            200            0.003806555   -6.5487985e-40  0              0.011419665    1.9617217e-18  0              9.4724519e-12  2.6109412e-16  0              2.995215     
   2700000   137.7          200            200            0.003806555    1.9706258e-40  0              0.011419665    3.7429322e-19  0              1.807328e-12   2.6109412e-16  0              2.995215     
   2800000   137.7          200            200            0.003806555   -7.6742641e-39  0              0.011419665    1.0022116e-19  0              4.8393212e-13  2.6109412e-16  0              2.995215     
   2900000   137.7          200            200            0.003806555    1.4829849e-39  0              0.011419665    2.0604001e-20  0              9.9489345e-14  2.6109412e-16  0              2.995215     
   3000000   137.7          200            200            0.003806555   -3.6427012e-39  0              0.011419665    1.5019037e-20  0              7.2521553e-14  2.6109412e-16  0              2.995215     
Loop time of 64.3585 on 4 procs for 3000000 steps with 51 atoms

Performance: 40274397.234 ns/day, 0.000 hours/ns, 46613.886 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 0.30601    | 1.5685     | 5.1964     | 167.3 |  2.44
Neigh   | 0.070057   | 0.070588   | 0.072071   |   0.3 |  0.11
Comm    | 25.805     | 32.491     | 38.258     |  84.7 | 50.48
Output  | 0.060696   | 0.060775   | 0.060829   |   0.0 |  0.09
Modify  | 15.252     | 21.085     | 28.45      | 121.6 | 32.76
Other   |            | 9.083      |            |       | 14.11

Nlocal:          12.75 ave          51 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1
Nghost:          39.25 ave          52 max           1 min
Histogram: 1 0 0 0 0 0 0 0 0 3
Neighs:           6.75 ave          27 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1

Total # of neighbors = 27
Ave neighs/atom = 0.52941176
Neighbor list builds = 164
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 9

#variable lat0 equal 1                    #
variable lat1 equal 3+(151*0.01)+(v_ind*0.01)  # .491+(v_ind*0.001)       # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 10*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.6                                                               
Lattice spacing in x,y,z = 4.6 4.6 4.6

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -69 ${n1e1} -100 100 -100 100 units box
region box block -69 69 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -69 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -69 69 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-69 -100 -100) to (69 100 100)
  1 by 2 by 2 MPI processor grid
create_atoms 1 region substrate
Created 30 atoms
  using lattice units in orthogonal box = (-69 -100 -100) to (69 100 100)
  create_atoms CPU = 0.000 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 30 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 21 atoms
  using lattice units in orthogonal box = (-69 -100 -100) to (69 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  30 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  30 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  21 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  21 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
30 atoms in group substrate
group slider1 region slider1
21 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 21 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_9_*.dump id type diameter mass xu yu zu fx fy fz

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 90 130 130
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 14.48 | 17.95 | 19.1 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   138            200            200            0              0              0              0              0              0              0              2.6109412e-16  0              6            
    100000   138            200            200            0.0030871045   3.1263739e-38  0              0.0092613136   12249.992      0              5.9150828e+10  2.6109412e-16  0              3.3276936    
    200000   138            200            200            0.0010795928   7.1653622e-38  0              0.0032387783   2924.6365      0              1.4122023e+10  2.6109412e-16  0              3.0773326    
    300000   138            200            200            6.2197175e-05 -1.4143336e-36  0              0.00018659153  20.253445      0              97796636       2.6109412e-16  0              3.0455229    
    400000   138            200            200            0.00016590733  2.0224382e-36  0              0.000497722    131.35182      0              6.3425093e+08  2.6109412e-16  0              3.0007073    
    500000   138            200            200            0.0073129512   0.00013442259  0              0.021804431    8.5958762      0              41506410       2.6109412e-16  0              2.9928231    
    600000   138            200            200            0.0044534244   1.9642598e-36  0              0.013360273    3.0605018      0              14778068       2.6109412e-16  0              2.9946974    
    700000   138            200            200            0.0039398521   5.3301771e-37  0              0.011819556    0.49725201     0              2401052        2.6109412e-16  0              2.9951044    
    800000   138            200            200            0.0038251544  -3.5809808e-38  0              0.011475463    0.071687165    0              346151.66      2.6109412e-16  0              2.9951954    
    900000   138            200            200            0.0037991411   2.8561445e-39  0              0.011397423    0.0098992143   0              47799.763      2.6109412e-16  0              2.9952154    
   1000000   138            200            200            0.0037952615   2.1257045e-38  0              0.011385785    0.0013149413   0              6349.3812      2.6109412e-16  0              2.9952179    
   1100000   138            200            200            0.0037959594   3.0261265e-38  0              0.011387878    0.00016781779  0              810.33206      2.6109412e-16  0              2.9952171    
   1200000   138            200            200            0.003796997   -8.6795649e-39  0              0.011390991    2.0522701e-05  0              99.096779      2.6109412e-16  0              2.9952161    
   1300000   138            200            200            0.0037976592   1.0806936e-39  0              0.011392978    2.3937371e-06  0              11.5585        2.6109412e-16  0              2.9952156    
   1400000   138            200            200            0.0037980013  -4.0745341e-39  0              0.011394004    2.6425732e-07  0              1.276004       2.6109412e-16  0              2.9952153    
   1500000   138            200            200            0.0037981609  -1.3222829e-39  0              0.011394483    2.7264906e-08  0              0.13165247     2.6109412e-16  0              2.9952151    
   1600000   138            200            200            0.0037982309   3.9384363e-39  0              0.011394693    2.5730665e-09  0              0.012424417    2.6109412e-16  0              2.9952151    
   1700000   138            200            200            0.0037982603   3.769054e-39   0              0.011394781    2.1340807e-10  0              0.0010304712   2.6109412e-16  0              2.995215     
   1800000   138            200            200            0.0037982723  -7.3842633e-39  0              0.011394817    1.4272277e-11  0              6.891572e-05   2.6109412e-16  0              2.995215     
   1900000   138            200            200            0.003798277    1.7293046e-39  0              0.011394831    6.0109461e-13  0              2.9024707e-06  2.6109412e-16  0              2.995215     
   2000000   138            200            200            0.0037982788  -3.4885823e-39  0              0.011394836    2.8706118e-15  0              1.3861157e-08  2.6109412e-16  0              2.995215     
   2100000   138            200            200            0.0037982795   4.8841714e-39  0              0.011394839    4.3510869e-15  0              2.1009841e-08  2.6109412e-16  0              2.995215     
   2200000   138            200            200            0.0037982798   1.0114088e-38  0              0.011394839    3.051796e-15   0              1.4736031e-08  2.6109412e-16  0              2.995215     
   2300000   138            200            200            0.0037982799  -1.1230113e-38  0              0.01139484     9.7618802e-16  0              4.7136626e-09  2.6109412e-16  0              2.995215     
   2400000   138            200            200            0.0037982799  -7.7741085e-39  0              0.01139484     2.3558087e-16  0              1.1375357e-09  2.6109412e-16  0              2.995215     
   2500000   138            200            200            0.0037982799  -6.2959523e-39  0              0.01139484     4.8406867e-17  0              2.3373944e-10  2.6109412e-16  0              2.995215     
   2600000   138            200            200            0.0037982799   2.1550012e-39  0              0.01139484     9.0159346e-18  0              4.3534721e-11  2.6109412e-16  0              2.995215     
   2700000   138            200            200            0.0037982799   1.3133039e-38  0              0.01139484     1.3698469e-18  0              6.6145004e-12  2.6109412e-16  0              2.995215     
   2800000   138            200            200            0.0037982799  -1.0184012e-38  0              0.01139484     2.6120932e-19  0              1.2612863e-12  2.6109412e-16  0              2.995215     
   2900000   138            200            200            0.0037982799  -7.4828682e-39  0              0.01139484     6.5194972e-22  0              3.1480319e-15  2.6109412e-16  0              2.995215     
   3000000   138            200            200            0.0037982799   2.3494473e-38  0              0.01139484     1.1966186e-19  0              5.7780432e-13  2.6109412e-16  0              2.995215     
Loop time of 64.2269 on 4 procs for 3000000 steps with 51 atoms

Performance: 40356892.620 ns/day, 0.000 hours/ns, 46709.366 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 0.31344    | 1.5526     | 5.1039     | 164.6 |  2.42
Neigh   | 0.070809   | 0.071335   | 0.072811   |   0.3 |  0.11
Comm    | 25.794     | 32.38      | 38.097     |  83.9 | 50.42
Output  | 0.059761   | 0.059837   | 0.059891   |   0.0 |  0.09
Modify  | 15.338     | 21.075     | 28.318     | 120.8 | 32.81
Other   |            | 9.088      |            |       | 14.15

Nlocal:          12.75 ave          51 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1
Nghost:          39.25 ave          52 max           1 min
Histogram: 1 0 0 0 0 0 0 0 0 3
Neighs:           6.75 ave          27 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1

Total # of neighbors = 27
Ave neighs/atom = 0.52941176
Neighbor list builds = 164
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 10

#variable lat0 equal 1                    #
variable lat1 equal 3+(151*0.01)+(v_ind*0.01)  # .491+(v_ind*0.001)       # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 10*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.61                                                               
Lattice spacing in x,y,z = 4.61 4.61 4.61

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -69.15 ${n1e1} -100 100 -100 100 units box
region box block -69.15 69.15 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -69.15 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -69.15 69.15 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-69.15 -100 -100) to (69.15 100 100)
  1 by 2 by 2 MPI processor grid
create_atoms 1 region substrate
Created 30 atoms
  using lattice units in orthogonal box = (-69.15 -100 -100) to (69.15 100 100)
  create_atoms CPU = 0.000 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 30 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 21 atoms
  using lattice units in orthogonal box = (-69.15 -100 -100) to (69.15 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  30 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  30 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  21 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  21 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
30 atoms in group substrate
group slider1 region slider1
21 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 21 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_10_*.dump id type diameter mass xu yu zu fx fy fz

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 90 130 130
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 14.48 | 17.95 | 19.1 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   138.3          200            200            0              0              0              0              0              0              0              2.6109412e-16  0              6            
    100000   138.3          200            200            0.0030757078  -1.1140237e-38  0              0.0092271233   12221.874      0              5.9015054e+10  2.6109412e-16  0              3.3287956    
    200000   138.3          200            200            0.0010677582   2.8578019e-37  0              0.0032032746   2884.423       0              1.3927846e+10  2.6109412e-16  0              3.0788471    
    300000   138.3          200            200            4.790351e-05  -1.4028126e-36  0              0.00014371053  12.289506      0              59341627       2.6109412e-16  0              3.0452928    
    400000   138.3          200            200            9.2246905e-05  1.1772365e-36  0              0.00027674071  44.190502      0              2.1338012e+08  2.6109412e-16  0              3.0046205    
    500000   138.3          200            200            0.001504574    7.13105e-38    0              0.0045137219   15.086604      0              72847813       2.6109412e-16  0              2.9973609    
    600000   138.3          200            200            0.0040185668   2.9520187e-36  0              0.0120557      3.8702819      0              18688206       2.6109412e-16  0              2.9950035    
    700000   138.3          200            200            0.003994864   -7.3794084e-36  0              0.011984592    0.44150415     0              2131865.5      2.6109412e-16  0              2.9950368    
    800000   138.3          200            200            0.0038900985  -1.7750363e-39  0              0.011670296    0.049485148    0              238946.07      2.6109412e-16  0              2.9951287    
    900000   138.3          200            200            0.0038341928   3.5372569e-37  0              0.011502578    0.005293974    0              25562.706      2.6109412e-16  0              2.9951771    
   1000000   138.3          200            200            0.0038086012   1.4809407e-38  0              0.011425804    0.00052735984  0              2546.4319      2.6109412e-16  0              2.9951991    
   1100000   138.3          200            200            0.0037975832  -1.156968e-37   0              0.01139275     4.747561e-05   0              229.24273      2.6109412e-16  0              2.9952086    
   1200000   138.3          200            200            0.0037930236   2.8011534e-38  0              0.011379071    3.6586259e-06  0              17.666195      2.6109412e-16  0              2.9952125    
   1300000   138.3          200            200            0.0037911931   1.6496838e-38  0              0.011373579    2.1263457e-07  0              1.0267362      2.6109412e-16  0              2.995214     
   1400000   138.3          200            200            0.0037904765   5.3881588e-39  0              0.01137143     5.9440719e-09  0              0.028701796    2.6109412e-16  0              2.9952146    
   1500000   138.3          200            200            0.0037902023   3.5439296e-39  0              0.011370607    3.8866302e-11  0              0.00018767146  2.6109412e-16  0              2.9952149    
   1600000   138.3          200            200            0.0037900994  -9.5839274e-39  0              0.011370298    2.2424541e-10  0              0.0010828008   2.6109412e-16  0              2.995215     
   1700000   138.3          200            200            0.0037900616  -1.3264979e-39  0              0.011370185    1.0131327e-10  0              0.00048920553  2.6109412e-16  0              2.995215     
   1800000   138.3          200            200            0.003790048    6.087413e-39   0              0.011370144    2.8156005e-11  0              0.00013595527  2.6109412e-16  0              2.995215     
   1900000   138.3          200            200            0.0037900432   3.1148881e-38  0              0.01137013     6.267537e-12   0              3.0263693e-05  2.6109412e-16  0              2.995215     
   2000000   138.3          200            200            0.0037900415  -2.9979115e-39  0              0.011370125    1.22265e-12    0              5.9037395e-06  2.6109412e-16  0              2.995215     
   2100000   138.3          200            200            0.0037900409   1.2316062e-38  0              0.011370123    2.1783512e-13  0              1.0518478e-06  2.6109412e-16  0              2.995215     
   2200000   138.3          200            200            0.0037900408  -3.094718e-39   0              0.011370122    3.6252969e-14  0              1.7505261e-07  2.6109412e-16  0              2.995215     
   2300000   138.3          200            200            0.0037900407  -2.2454148e-38  0              0.011370122    5.7035521e-15  0              2.7540412e-08  2.6109412e-16  0              2.995215     
   2400000   138.3          200            200            0.0037900407   9.9771842e-39  0              0.011370122    8.5757449e-16  0              4.1409203e-09  2.6109412e-16  0              2.995215     
   2500000   138.3          200            200            0.0037900407  -6.0253299e-39  0              0.011370122    1.2326243e-16  0              5.9519016e-10  2.6109412e-16  0              2.995215     
   2600000   138.3          200            200            0.0037900407   1.4249843e-38  0              0.011370122    1.6956725e-17  0              8.1877959e-11  2.6109412e-16  0              2.995215     
   2700000   138.3          200            200            0.0037900407   8.4617818e-39  0              0.011370122    2.2291407e-18  0              1.0763723e-11  2.6109412e-16  0              2.995215     
   2800000   138.3          200            200            0.0037900407   2.1222593e-38  0              0.011370122    2.4407107e-19  0              1.1785318e-12  2.6109412e-16  0              2.995215     
   2900000   138.3          200            200            0.0037900407  -2.7626527e-38  0              0.011370122    1.3361891e-19  0              6.451979e-13   2.6109412e-16  0              2.995215     
   3000000   138.3          200            200            0.0037900407   6.7994621e-39  0              0.011370122    3.8712847e-20  0              1.8693048e-13  2.6109412e-16  0              2.995215     
Loop time of 64.433 on 4 procs for 3000000 steps with 51 atoms

Performance: 40227813.972 ns/day, 0.000 hours/ns, 46559.970 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 0.30962    | 1.5767     | 5.208      | 167.0 |  2.45
Neigh   | 0.070804   | 0.071344   | 0.072843   |   0.3 |  0.11
Comm    | 25.833     | 32.494     | 38.255     |  84.6 | 50.43
Output  | 0.077062   | 0.077139   | 0.077192   |   0.0 |  0.12
Modify  | 15.335     | 21.148     | 28.505     | 122.1 | 32.82
Other   |            | 9.066      |            |       | 14.07

Nlocal:          12.75 ave          51 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1
Nghost:          39.25 ave          52 max           1 min
Histogram: 1 0 0 0 0 0 0 0 0 3
Neighs:           6.75 ave          27 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1

Total # of neighbors = 27
Ave neighs/atom = 0.52941176
Neighbor list builds = 164
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 11

#variable lat0 equal 1                    #
variable lat1 equal 3+(151*0.01)+(v_ind*0.01)  # .491+(v_ind*0.001)       # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 10*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.62                                                               
Lattice spacing in x,y,z = 4.62 4.62 4.62

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -69.3 ${n1e1} -100 100 -100 100 units box
region box block -69.3 69.3 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -69.3 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -69.3 69.3 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-69.3 -100 -100) to (69.3 100 100)
  1 by 2 by 2 MPI processor grid
create_atoms 1 region substrate
Created 30 atoms
  using lattice units in orthogonal box = (-69.3 -100 -100) to (69.3 100 100)
  create_atoms CPU = 0.000 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 30 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 21 atoms
  using lattice units in orthogonal box = (-69.3 -100 -100) to (69.3 100 100)
  create_atoms CPU = 0.002 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  30 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  30 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  21 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  21 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
30 atoms in group substrate
group slider1 region slider1
21 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 21 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_11_*.dump id type diameter mass xu yu zu fx fy fz

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 90 130 130
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 14.48 | 17.95 | 19.1 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   138.6          200            200            0              0              0              0              0              0              0              2.6109412e-16  0              6            
    100000   138.6          200            200            0.0030642992  -7.1142103e-38  0              0.0091928976   12193.066      0              5.8875951e+10  2.6109412e-16  0              3.330044     
    200000   138.6          200            200            0.0010574909   1.4651486e-37  0              0.0031724728   2850.8939      0              1.3765947e+10  2.6109412e-16  0              3.0799891    
    300000   138.6          200            200            3.1412545e-05  1.7366737e-36  0              9.4237636e-05  5.4290645      0              26215010       2.6109412e-16  0              3.0450362    
    400000   138.6          200            200            8.9581537e-06 -2.2203749e-36  0              2.6874461e-05  0.47202387     0              2279234.3      2.6109412e-16  0              3.0064435    
    500000   138.6          200            200            0.007438776   -1.1496196e-35  0              0.022316328    2.5672582      0              12396371       2.6109412e-16  0              2.9924698    
    600000   138.6          200            200            0.0048604443   2.4823528e-36  0              0.014581333    1.4736964      0              7115952.7      2.6109412e-16  0              2.9943551    
    700000   138.6          200            200            0.0040965435   2.6638519e-36  0              0.01228963     0.32101577     0              1550070.3      2.6109412e-16  0              2.9949589    
    800000   138.6          200            200            0.0038758752  -2.1813365e-36  0              0.011627626    0.05364896     0              259051.63      2.6109412e-16  0              2.9951385    
    900000   138.6          200            200            0.0038083466   3.1725015e-38  0              0.01142504     0.0083912106   0              40518.153      2.6109412e-16  0              2.9951937    
   1000000   138.6          200            200            0.0037884441   1.0488816e-37  0              0.011365332    0.0012530807   0              6050.6784      2.6109412e-16  0              2.9952098    
   1100000   138.6          200            200            0.0037830614   1.4541833e-39  0              0.011349184    0.0001794469   0              866.48486      2.6109412e-16  0              2.9952141    
   1200000   138.6          200            200            0.0037818343  -5.1500398e-39  0              0.011345503    2.4691136e-05  0              119.22466      2.6109412e-16  0              2.9952151    
   1300000   138.6          200            200            0.0037816693  -1.5715155e-38  0              0.011345008    3.2659895e-06  0              15.770295      2.6109412e-16  0              2.9952152    
   1400000   138.6          200            200            0.0037817152  -1.8407951e-39  0              0.011345146    4.1489349e-07  0              2.0033722      2.6109412e-16  0              2.9952151    
   1500000   138.6          200            200            0.003781771   -1.0244958e-38  0              0.011345313    5.0482782e-08  0              0.24376329     2.6109412e-16  0              2.9952151    
   1600000   138.6          200            200            0.0037818055   1.5056392e-39  0              0.011345416    5.8547682e-09  0              0.028270581    2.6109412e-16  0              2.995215     
   1700000   138.6          200            200            0.003781823    1.4129434e-38  0              0.011345469    6.4196399e-10  0              0.0030998143   2.6109412e-16  0              2.995215     
   1800000   138.6          200            200            0.0037818311  -1.0504032e-38  0              0.011345493    6.5665615e-11  0              0.00031707575  2.6109412e-16  0              2.995215     
   1900000   138.6          200            200            0.0037818347  -1.4663996e-38  0              0.011345504    6.123676e-12   0              2.956904e-05   2.6109412e-16  0              2.995215     
   2000000   138.6          200            200            0.0037818362   8.3883388e-39  0              0.011345508    4.9867245e-13  0              2.4079108e-06  2.6109412e-16  0              2.995215     
   2100000   138.6          200            200            0.0037818368   9.7591932e-39  0              0.01134551     3.2253491e-14  0              1.5574057e-07  2.6109412e-16  0              2.995215     
   2200000   138.6          200            200            0.003781837    9.5032735e-39  0              0.011345511    1.2444566e-15  0              6.0090355e-09  2.6109412e-16  0              2.995215     
   2300000   138.6          200            200            0.0037818371   2.3224698e-38  0              0.011345511    2.0454436e-18  0              9.8767153e-12  2.6109412e-16  0              2.995215     
   2400000   138.6          200            200            0.0037818371   1.3174819e-38  0              0.011345511    1.3088086e-17  0              6.3197683e-11  2.6109412e-16  0              2.995215     
   2500000   138.6          200            200            0.0037818371   1.6367953e-39  0              0.011345511    7.7002593e-18  0              3.7181797e-11  2.6109412e-16  0              2.995215     
   2600000   138.6          200            200            0.0037818371   1.9791009e-38  0              0.011345511    2.7884313e-18  0              1.3464337e-11  2.6109412e-16  0              2.995215     
   2700000   138.6          200            200            0.0037818371   9.8899964e-39  0              0.011345511    6.7501782e-19  0              3.2594195e-12  2.6109412e-16  0              2.995215     
   2800000   138.6          200            200            0.0037818371   1.6462222e-38  0              0.011345511    1.920875e-19   0              9.275218e-13   2.6109412e-16  0              2.995215     
   2900000   138.6          200            200            0.0037818371  -2.2677432e-38  0              0.011345511    3.1227739e-23  0              1.5078757e-16  2.6109412e-16  0              2.995215     
   3000000   138.6          200            200            0.0037818371   7.4853437e-38  0              0.011345511    1.4521892e-19  0              7.0121021e-13  2.6109412e-16  0              2.995215     
Loop time of 64.3644 on 4 procs for 3000000 steps with 51 atoms

Performance: 40270685.146 ns/day, 0.000 hours/ns, 46609.589 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 0.31003    | 1.6026     | 5.2915     | 168.3 |  2.49
Neigh   | 0.070772   | 0.071331   | 0.072839   |   0.3 |  0.11
Comm    | 25.828     | 32.43      | 38.186     |  83.9 | 50.38
Output  | 0.059807   | 0.059885   | 0.059938   |   0.0 |  0.09
Modify  | 15.345     | 21.108     | 28.4       | 121.0 | 32.79
Other   |            | 9.093      |            |       | 14.13

Nlocal:          12.75 ave          51 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1
Nghost:          39.25 ave          52 max           1 min
Histogram: 1 0 0 0 0 0 0 0 0 3
Neighs:           6.75 ave          27 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1

Total # of neighbors = 27
Ave neighs/atom = 0.52941176
Neighbor list builds = 164
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 12

#variable lat0 equal 1                    #
variable lat1 equal 3+(151*0.01)+(v_ind*0.01)  # .491+(v_ind*0.001)       # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 10*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.63                                                               
Lattice spacing in x,y,z = 4.63 4.63 4.63

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -69.45 ${n1e1} -100 100 -100 100 units box
region box block -69.45 69.45 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -69.45 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -69.45 69.45 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-69.45 -100 -100) to (69.45 100 100)
  1 by 2 by 2 MPI processor grid
create_atoms 1 region substrate
Created 30 atoms
  using lattice units in orthogonal box = (-69.45 -100 -100) to (69.45 100 100)
  create_atoms CPU = 0.000 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 30 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 21 atoms
  using lattice units in orthogonal box = (-69.45 -100 -100) to (69.45 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  30 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  30 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  21 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  21 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
30 atoms in group substrate
group slider1 region slider1
21 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 21 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_12_*.dump id type diameter mass xu yu zu fx fy fz

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 90 130 130
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 14.48 | 17.95 | 19.1 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   138.9          200            200            0              0              0              0              0              0              0              2.6109412e-16  0              6            
    100000   138.9          200            200            0.0030532479  -3.5460731e-38  0              0.0091597438   12166.063      0              5.8745562e+10  2.6109412e-16  0              3.3312442    
    200000   138.9          200            200            0.001047977   -2.7626047e-37  0              0.0031439309   2820.5278      0              1.3619319e+10  2.6109412e-16  0              3.0809539    
    300000   138.9          200            200            1.2241572e-05 -2.2372913e-36  0              3.6724715e-05  0.85583861     0              4132538.4      2.6109412e-16  0              3.0447141    
    400000   138.9          200            200           -7.1171244e-05  6.3869694e-37  0             -0.00021351373  33.195914      0              1.6029119e+08  2.6109412e-16  0              3.004709     
    500000   138.9          200            200            0.0060630173   2.0222998e-36  0              0.018189052    18.728664      0              90434017       2.6109412e-16  0              2.9934758    
    600000   138.9          200            200            0.0035196879  -4.0418966e-37  0              0.010559064    3.8557766      0              18618165       2.6109412e-16  0              2.9954549    
    700000   138.9          200            200            0.0035831012  -5.0066954e-37  0              0.010749304    0.45466595     0              2195419.1      2.6109412e-16  0              2.9953852    
    800000   138.9          200            200            0.003680703    2.78661e-37    0              0.011042109    0.052654629    0              254250.36      2.6109412e-16  0              2.9952966    
    900000   138.9          200            200            0.0037320792  -6.5832839e-37  0              0.011196238    0.0058025543   0              28018.458      2.6109412e-16  0              2.9952511    
   1000000   138.9          200            200            0.0037559478   2.6268676e-37  0              0.011267844    0.00059723594  0              2883.8386      2.6109412e-16  0              2.9952303    
   1100000   138.9          200            200            0.0037663856   1.9916138e-37  0              0.011299157    5.6128177e-05  0              271.02288      2.6109412e-16  0              2.9952213    
   1200000   138.9          200            200            0.003770761   -1.967236e-38   0              0.011312283    4.6228463e-06  0              22.32207       2.6109412e-16  0              2.9952175    
   1300000   138.9          200            200            0.0037725362   3.7838307e-38  0              0.011317609    3.051511e-07   0              1.4734655      2.6109412e-16  0              2.995216     
   1400000   138.9          200            200            0.0037732373  -4.2821423e-39  0              0.011319712    1.2422452e-08  0              0.059983574    2.6109412e-16  0              2.9952154    
   1500000   138.9          200            200            0.0037735078  -3.6263838e-38  0              0.011320523    4.1478383e-11  0              0.00020028427  2.6109412e-16  0              2.9952151    
   1600000   138.9          200            200            0.00377361     1.4369169e-38  0              0.01132083     1.0797403e-10  0              0.00052136795  2.6109412e-16  0              2.9952151    
   1700000   138.9          200            200            0.0037736478  -7.8535034e-40  0              0.011320944    7.125713e-11   0              0.00034407518  2.6109412e-16  0              2.995215     
   1800000   138.9          200            200            0.0037736616   6.8423755e-39  0              0.011320985    2.249959e-11   0              0.00010864247  2.6109412e-16  0              2.995215     
   1900000   138.9          200            200            0.0037736665  -9.3443036e-39  0              0.011320999    5.3510594e-12  0              2.5838351e-05  2.6109412e-16  0              2.995215     
   2000000   138.9          200            200            0.0037736682   1.2809746e-38  0              0.011321004    1.0884545e-12  0              5.2557574e-06  2.6109412e-16  0              2.995215     
   2100000   138.9          200            200            0.0037736687  -1.0970888e-38  0              0.011321006    1.998532e-13   0              9.6501956e-07  2.6109412e-16  0              2.995215     
   2200000   138.9          200            200            0.0037736689   5.8860121e-39  0              0.011321007    3.4022784e-14  0              1.6428385e-07  2.6109412e-16  0              2.995215     
   2300000   138.9          200            200            0.003773669    1.905866e-38   0              0.011321007    5.4641289e-15  0              2.6384323e-08  2.6109412e-16  0              2.995215     
   2400000   138.9          200            200            0.003773669   -4.6740393e-39  0              0.011321007    8.3373304e-16  0              4.0257984e-09  2.6109412e-16  0              2.995215     
   2500000   138.9          200            200            0.003773669   -1.6446141e-38  0              0.011321007    1.2165604e-16  0              5.8743347e-10  2.6109412e-16  0              2.995215     
   2600000   138.9          200            200            0.003773669    1.4865471e-38  0              0.011321007    1.705867e-17   0              8.2370213e-11  2.6109412e-16  0              2.995215     
   2700000   138.9          200            200            0.003773669    1.8337719e-38  0              0.011321007    2.2613496e-18  0              1.0919248e-11  2.6109412e-16  0              2.995215     
   2800000   138.9          200            200            0.003773669    1.8447952e-38  0              0.011321007    2.5096564e-19  0              1.2118232e-12  2.6109412e-16  0              2.995215     
   2900000   138.9          200            200            0.003773669    2.8586418e-38  0              0.011321007    4.6927521e-20  0              2.265962e-13   2.6109412e-16  0              2.995215     
   3000000   138.9          200            200            0.003773669    1.3342469e-38  0              0.011321007    2.1495094e-20  0              1.0379211e-13  2.6109412e-16  0              2.995215     
Loop time of 64.3599 on 4 procs for 3000000 steps with 51 atoms

Performance: 40273542.614 ns/day, 0.000 hours/ns, 46612.897 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 0.31916    | 1.6194     | 5.3308     | 168.5 |  2.52
Neigh   | 0.071618   | 0.072196   | 0.073716   |   0.3 |  0.11
Comm    | 25.762     | 32.42      | 38.247     |  84.2 | 50.37
Output  | 0.079807   | 0.079888   | 0.079943   |   0.0 |  0.12
Modify  | 15.197     | 21.038     | 28.392     | 121.6 | 32.69
Other   |            | 9.131      |            |       | 14.19

Nlocal:          12.75 ave          51 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1
Nghost:          39.25 ave          52 max           1 min
Histogram: 1 0 0 0 0 0 0 0 0 3
Neighs:           6.75 ave          27 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1

Total # of neighbors = 27
Ave neighs/atom = 0.52941176
Neighbor list builds = 166
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 13

#variable lat0 equal 1                    #
variable lat1 equal 3+(151*0.01)+(v_ind*0.01)  # .491+(v_ind*0.001)       # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 10*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.64                                                               
Lattice spacing in x,y,z = 4.64 4.64 4.64

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -69.6 ${n1e1} -100 100 -100 100 units box
region box block -69.6 69.6 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -69.6 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -69.6 69.6 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-69.6 -100 -100) to (69.6 100 100)
  1 by 2 by 2 MPI processor grid
create_atoms 1 region substrate
Created 30 atoms
  using lattice units in orthogonal box = (-69.6 -100 -100) to (69.6 100 100)
  create_atoms CPU = 0.000 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 30 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 21 atoms
  using lattice units in orthogonal box = (-69.6 -100 -100) to (69.6 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  30 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  30 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  21 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  21 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
30 atoms in group substrate
group slider1 region slider1
21 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 21 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_13_*.dump id type diameter mass xu yu zu fx fy fz

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 90 130 130
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 14.48 | 17.95 | 19.1 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   139.2          200            200            0              0              0              0              0              0              0              2.6109412e-16  0              6            
    100000   139.2          200            200            0.0030431682  -5.3059064e-38  0              0.0091295046   12145.121      0              5.8644442e+10  2.6109412e-16  0              3.3320349    
    200000   139.2          200            200            0.0010383378   5.7866069e-37  0              0.0031150133   2789.5357      0              1.346967e+10   2.6109412e-16  0              3.0819652    
    300000   139.2          200            200           -1.0000787e-05  2.8752152e-36  0             -3.0002361e-05  0.57540297     0              2778415        2.6109412e-16  0              3.0442505    
    400000   139.2          200            200           -0.00012586469 -3.8833014e-36  0             -0.00037759406  115.62098      0              5.5829231e+08  2.6109412e-16  0              3.000779     
    500000   139.2          200            200            0.0036163469   7.4209749e-36  0              0.010849041    29.517242      0              1.425282e+08   2.6109412e-16  0              2.9954062    
    600000   139.2          200            200            0.0028079206   1.1034196e-35  0              0.0084237617   1.6782666      0              8103748.6      2.6109412e-16  0              2.9960819    
    700000   139.2          200            200            0.0033475687   2.1826679e-36  0              0.010042706    0.11744448     0              567097.38      2.6109412e-16  0              2.9955803    
    800000   139.2          200            200            0.0035999297   4.2641746e-37  0              0.010799789    0.0079202484   0              38244.045      2.6109412e-16  0              2.9953575    
    900000   139.2          200            200            0.0037019634  -5.9612534e-39  0              0.01110589     0.00036661283  0              1770.2421      2.6109412e-16  0              2.9952693    
   1000000   139.2          200            200            0.0037416799  -1.5371534e-37  0              0.01122504     3.7058654e-06  0              17.894298      2.6109412e-16  0              2.9952353    
   1100000   139.2          200            200            0.003756766   -3.7151915e-37  0              0.011270298    1.4143327e-06  0              6.8293062      2.6109412e-16  0              2.9952224    
   1200000   139.2          200            200            0.0037623763  -7.4629734e-38  0              0.011287129    1.2701441e-06  0              6.1330715      2.6109412e-16  0              2.9952177    
   1300000   139.2          200            200            0.0037644212   4.5696491e-38  0              0.011293263    4.3571766e-07  0              2.1039246      2.6109412e-16  0              2.995216     
   1400000   139.2          200            200            0.0037651515   4.3277759e-39  0              0.011295454    1.0782021e-07  0              0.52062521     2.6109412e-16  0              2.9952153    
   1500000   139.2          200            200            0.0037654068   3.4043346e-38  0              0.01129622     2.2464889e-08  0              0.10847491     2.6109412e-16  0              2.9952151    
   1600000   139.2          200            200            0.003765494    6.4306372e-39  0              0.011296482    4.1931175e-09  0              0.020247064    2.6109412e-16  0              2.995215     
   1700000   139.2          200            200            0.0037655229   1.7601465e-38  0              0.011296569    7.2310414e-10  0              0.0034916111   2.6109412e-16  0              2.995215     
   1800000   139.2          200            200            0.0037655322   7.2826045e-39  0              0.011296597    1.1722302e-10  0              0.00056602802  2.6109412e-16  0              2.995215     
   1900000   139.2          200            200            0.003765535    6.5854344e-39  0              0.011296605    1.8049457e-11  0              8.7154369e-05  2.6109412e-16  0              2.995215     
   2000000   139.2          200            200            0.0037655359   3.1009803e-38  0              0.011296608    2.6564669e-12  0              1.2827128e-05  2.6109412e-16  0              2.995215     
   2100000   139.2          200            200            0.0037655361  -1.6792713e-38  0              0.011296608    3.7513316e-13  0              1.8113838e-06  2.6109412e-16  0              2.995215     
   2200000   139.2          200            200            0.0037655361   1.5983509e-38  0              0.011296608    5.0915289e-14  0              2.4585171e-07  2.6109412e-16  0              2.995215     
   2300000   139.2          200            200            0.0037655361  -3.4211039e-39  0              0.011296608    6.6399171e-15  0              3.2061783e-08  2.6109412e-16  0              2.995215     
   2400000   139.2          200            200            0.0037655361   2.2467487e-38  0              0.011296608    8.3156997e-16  0              4.0153538e-09  2.6109412e-16  0              2.995215     
   2500000   139.2          200            200            0.0037655361   2.2885166e-38  0              0.011296608    9.8687722e-17  0              4.7652769e-10  2.6109412e-16  0              2.995215     
   2600000   139.2          200            200            0.0037655361   2.340284e-39   0              0.011296608    1.0712366e-17  0              5.1726182e-11  2.6109412e-16  0              2.995215     
   2700000   139.2          200            200            0.0037655361   4.0613091e-38  0              0.011296608    1.204699e-18   0              5.8170605e-12  2.6109412e-16  0              2.995215     
   2800000   139.2          200            200            0.0037655361   9.4014016e-39  0              0.011296608    4.5707799e-20  0              2.2070661e-13  2.6109412e-16  0              2.995215     
   2900000   139.2          200            200            0.0037655361   1.5063303e-38  0              0.011296608    1.160288e-19   0              5.6026155e-13  2.6109412e-16  0              2.995215     
   3000000   139.2          200            200            0.0037655361   4.6637637e-38  0              0.011296608    6.7064014e-22  0              3.2382812e-15  2.6109412e-16  0              2.995215     
Loop time of 64.3313 on 4 procs for 3000000 steps with 51 atoms

Performance: 40291417.253 ns/day, 0.000 hours/ns, 46633.585 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 0.32193    | 1.5842     | 5.2125     | 166.5 |  2.46
Neigh   | 0.071581   | 0.072112   | 0.073587   |   0.3 |  0.11
Comm    | 25.764     | 32.397     | 38.181     |  84.3 | 50.36
Output  | 0.061695   | 0.061774   | 0.06183    |   0.0 |  0.10
Modify  | 15.325     | 21.101     | 28.392     | 121.1 | 32.80
Other   |            | 9.115      |            |       | 14.17

Nlocal:          12.75 ave          51 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1
Nghost:          39.25 ave          52 max           1 min
Histogram: 1 0 0 0 0 0 0 0 0 3
Neighs:           6.25 ave          25 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1

Total # of neighbors = 25
Ave neighs/atom = 0.49019608
Neighbor list builds = 166
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 14

#variable lat0 equal 1                    #
variable lat1 equal 3+(151*0.01)+(v_ind*0.01)  # .491+(v_ind*0.001)       # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 10*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.65                                                               
Lattice spacing in x,y,z = 4.65 4.65 4.65

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -69.75 ${n1e1} -100 100 -100 100 units box
region box block -69.75 69.75 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -69.75 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -69.75 69.75 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-69.75 -100 -100) to (69.75 100 100)
  1 by 2 by 2 MPI processor grid
create_atoms 1 region substrate
Created 30 atoms
  using lattice units in orthogonal box = (-69.75 -100 -100) to (69.75 100 100)
  create_atoms CPU = 0.000 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 30 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 21 atoms
  using lattice units in orthogonal box = (-69.75 -100 -100) to (69.75 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  30 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  30 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  21 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  21 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
30 atoms in group substrate
group slider1 region slider1
21 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 21 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_14_*.dump id type diameter mass xu yu zu fx fy fz

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 90 130 130
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 14.54 | 18.01 | 19.16 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   139.5          200            200            0              0              0              0              0              0              0              2.6109412e-16  0              6            
    100000   139.5          200            200            0.0030341973   3.5368717e-37  0              0.0091025918   12131.373      0              5.8578061e+10  2.6109412e-16  0              3.3322738    
    200000   139.5          200            200            0.0010287454   3.0106643e-37  0              0.0030862362   2758.6534      0              1.332055e+10   2.6109412e-16  0              3.082988     
    300000   139.5          200            200           -3.4524846e-05  4.7480624e-38  0             -0.00010357454  7.2187125      0              34856579       2.6109412e-16  0              3.0435401    
    400000   139.5          200            200            0.0015849141   2.167963e-35   0              0.0047547422   182.6596       0              8.8199785e+08  2.6109412e-16  0              2.9971393    
    500000   139.5          200            200            0.0022615844  -1.8998453e-35  0              0.0067847532   23.423887      0              1.1310557e+08  2.6109412e-16  0              2.996656     
    600000   139.5          200            200            0.0025604781  -1.5915608e-36  0              0.0076814344   0.3216308      0              1553040        2.6109412e-16  0              2.9963026    
    700000   139.5          200            200            0.0032856709  -1.0267798e-35  0              0.0098570126   0.0018375344   0              8872.7961      2.6109412e-16  0              2.9956253    
    800000   139.5          200            200            0.0035824622   1.673515e-36   0              0.010747387    0.00065810243  0              3177.7411      2.6109412e-16  0              2.9953646    
    900000   139.5          200            200            0.0036942798   2.6561572e-37  0              0.011082839    0.00055085486  0              2659.881       2.6109412e-16  0              2.9952686    
   1000000   139.5          200            200            0.0037351591   4.6177331e-37  0              0.011205477    0.00018420785  0              889.47378      2.6109412e-16  0              2.9952338    
   1100000   139.5          200            200            0.0037497616   1.8907028e-38  0              0.011249285    4.4987653e-05  0              217.22927      2.6109412e-16  0              2.9952215    
   1200000   139.5          200            200            0.0037548616   9.7519283e-38  0              0.011264585    9.2968917e-06  0              44.891363      2.6109412e-16  0              2.9952172    
   1300000   139.5          200            200            0.0037566001   4.1554608e-38  0              0.0112698      1.725319e-06   0              8.3309478      2.6109412e-16  0              2.9952157    
   1400000   139.5          200            200            0.0037571763  -1.4427843e-38  0              0.011271529    2.9622588e-07  0              1.4303687      2.6109412e-16  0              2.9952152    
   1500000   139.5          200            200            0.0037573608   5.5748058e-38  0              0.011272082    4.7849552e-08  0              0.23104836     2.6109412e-16  0              2.9952151    
   1600000   139.5          200            200            0.0037574173   2.4297419e-38  0              0.011272252    7.3450116e-09  0              0.035466432    2.6109412e-16  0              2.995215     
   1700000   139.5          200            200            0.0037574334   7.3232649e-39  0              0.0112723      1.0780054e-09  0              0.0052053021   2.6109412e-16  0              2.995215     
   1800000   139.5          200            200            0.0037574375   1.0837949e-38  0              0.011272313    1.5180953e-10  0              0.0007330339   2.6109412e-16  0              2.995215     
   1900000   139.5          200            200            0.0037574384   8.540421e-39   0              0.011272315    2.0546287e-11  0              9.9210666e-05  2.6109412e-16  0              2.995215     
   2000000   139.5          200            200            0.0037574384   4.8322198e-39  0              0.011272315    2.672588e-12   0              1.2904971e-05  2.6109412e-16  0              2.995215     
   2100000   139.5          200            200            0.0037574383  -2.6720591e-38  0              0.011272315    3.3356816e-13  0              1.6106813e-06  2.6109412e-16  0              2.995215     
   2200000   139.5          200            200            0.0037574383   3.101592e-38   0              0.011272315    3.9784058e-14  0              1.9210298e-07  2.6109412e-16  0              2.995215     
   2300000   139.5          200            200            0.0037574382   1.3946269e-39  0              0.011272315    4.5078575e-15  0              2.176683e-08   2.6109412e-16  0              2.995215     
   2400000   139.5          200            200            0.0037574382   1.0399992e-38  0              0.011272315    4.8141265e-16  0              2.3245694e-09  2.6109412e-16  0              2.995215     
   2500000   139.5          200            200            0.0037574382  -1.4784326e-38  0              0.011272315    4.6667575e-17  0              2.2534102e-10  2.6109412e-16  0              2.995215     
   2600000   139.5          200            200            0.0037574382  -1.8849179e-38  0              0.011272315    3.7155273e-18  0              1.7940952e-11  2.6109412e-16  0              2.995215     
   2700000   139.5          200            200            0.0037574382   5.0575034e-40  0              0.011272315    3.364998e-19   0              1.6248371e-12  2.6109412e-16  0              2.995215     
   2800000   139.5          200            200            0.0037574382   3.0125004e-38  0              0.011272315    1.4013927e-21  0              6.7668239e-15  2.6109412e-16  0              2.995215     
   2900000   139.5          200            200            0.0037574382   6.0543471e-39  0              0.011272315    1.2602699e-19  0              6.0853921e-13  2.6109412e-16  0              2.995215     
   3000000   139.5          200            200            0.0037574382  -9.7423e-39     0              0.011272315    8.9506932e-21  0              4.3219694e-14  2.6109412e-16  0              2.995215     
Loop time of 64.4616 on 4 procs for 3000000 steps with 51 atoms

Performance: 40209977.903 ns/day, 0.000 hours/ns, 46539.326 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 0.30603    | 1.6043     | 5.3124     | 169.1 |  2.49
Neigh   | 0.073807   | 0.074356   | 0.075886   |   0.3 |  0.12
Comm    | 25.792     | 32.411     | 38.205     |  84.2 | 50.28
Output  | 0.061778   | 0.061855   | 0.061909   |   0.0 |  0.10
Modify  | 15.372     | 21.148     | 28.46      | 121.0 | 32.81
Other   |            | 9.162      |            |       | 14.21

Nlocal:          12.75 ave          51 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1
Nghost:          39.25 ave          52 max           1 min
Histogram: 1 0 0 0 0 0 0 0 0 3
Neighs:           6.75 ave          27 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1

Total # of neighbors = 27
Ave neighs/atom = 0.52941176
Neighbor list builds = 166
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 15

#variable lat0 equal 1                    #
variable lat1 equal 3+(151*0.01)+(v_ind*0.01)  # .491+(v_ind*0.001)       # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 10*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.66                                                               
Lattice spacing in x,y,z = 4.66 4.66 4.66

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -69.9 ${n1e1} -100 100 -100 100 units box
region box block -69.9 69.9 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -69.9 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -69.9 69.9 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-69.9 -100 -100) to (69.9 100 100)
  1 by 2 by 2 MPI processor grid
create_atoms 1 region substrate
Created 30 atoms
  using lattice units in orthogonal box = (-69.9 -100 -100) to (69.9 100 100)
  create_atoms CPU = 0.000 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 30 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 21 atoms
  using lattice units in orthogonal box = (-69.9 -100 -100) to (69.9 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  30 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  30 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  21 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  21 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
30 atoms in group substrate
group slider1 region slider1
21 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 21 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_15_*.dump id type diameter mass xu yu zu fx fy fz

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 91 130 130
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 14.5 | 17.97 | 19.12 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   139.8          200            200            0              0              0              0              0              0              0              2.6109412e-16  0              6            
    100000   139.8          200            200            0.0030251388   3.5327623e-37  0              0.0090754164   12116.807      0              5.8507725e+10  2.6109412e-16  0              3.332567     
    200000   139.8          200            200            0.0010180017   4.8123028e-36  0              0.0030540051   2722.7381      0              1.3147128e+10  2.6109412e-16  0              3.0843337    
    300000   139.8          200            200           -6.0458305e-05  5.1321594e-36  0             -0.00018137492  23.202316      0              1.1203568e+08  2.6109412e-16  0              3.0424854    
    400000   139.8          200            200            0.0046032557   2.2903636e-35  0              0.013809767    193.47246      0              9.3420928e+08  2.6109412e-16  0              2.994389     
    500000   139.8          200            200            0.0015741397   8.4240707e-36  0              0.0047224191   15.827209      0              76423927       2.6109412e-16  0              2.9973792    
    600000   139.8          200            200            0.0025019379  -1.4376279e-35  0              0.0075058136   6.674002e-05   0              322.26367      2.6109412e-16  0              2.9963471    
    700000   139.8          200            200            0.0032885033   9.8845379e-37  0              0.0098655098   0.028855806    0              139334.36      2.6109412e-16  0              2.9956141    
    800000   139.8          200            200            0.0035862422  -4.2708892e-36  0              0.010758727    0.010545548    0              50920.676      2.6109412e-16  0              2.9953538    
    900000   139.8          200            200            0.0036931852   9.9482578e-37  0              0.011079556    0.0025637566   0              12379.463      2.6109412e-16  0              2.9952624    
   1000000   139.8          200            200            0.0037305532   1.9118352e-37  0              0.01119166     0.00052508755  0              2535.4598      2.6109412e-16  0              2.9952308    
   1100000   139.8          200            200            0.0037432716   1.2994549e-37  0              0.011229815    9.6722847e-05  0              467.04001      2.6109412e-16  0              2.9952201    
   1200000   139.8          200            200            0.0037474762  -6.0293449e-38  0              0.011242429    1.6507095e-05  0              79.706855      2.6109412e-16  0              2.9952166    
   1300000   139.8          200            200            0.0037488177  -2.2523304e-38  0              0.011246453    2.6530553e-06  0              12.810654      2.6109412e-16  0              2.9952155    
   1400000   139.8          200            200            0.003749226   -2.4120508e-38  0              0.011247678    4.0547784e-07  0              1.9579074      2.6109412e-16  0              2.9952151    
   1500000   139.8          200            200            0.0037493418   9.6292334e-39  0              0.011248026    5.9275974e-08  0              0.28622246     2.6109412e-16  0              2.995215     
   1600000   139.8          200            200            0.003749371    2.1192663e-38  0              0.011248113    8.316404e-09   0              0.040156938    2.6109412e-16  0              2.995215     
   1700000   139.8          200            200            0.0037493766   1.6426699e-38  0              0.01124813     1.1214477e-09  0              0.0054150695   2.6109412e-16  0              2.995215     
   1800000   139.8          200            200            0.0037493767  -1.6367414e-38  0              0.01124813     1.4532773e-10  0              0.00070173559  2.6109412e-16  0              2.995215     
   1900000   139.8          200            200            0.003749376   -3.2827601e-38  0              0.011248128    1.8066278e-11  0              8.7235592e-05  2.6109412e-16  0              2.995215     
   2000000   139.8          200            200            0.0037493755   2.6532169e-38  0              0.011248127    2.1464265e-12  0              1.0364326e-05  2.6109412e-16  0              2.995215     
   2100000   139.8          200            200            0.0037493753  -1.4531982e-38  0              0.011248126    2.4218496e-13  0              1.1694245e-06  2.6109412e-16  0              2.995215     
   2200000   139.8          200            200            0.0037493751  -2.3703574e-38  0              0.011248125    2.5667004e-14  0              1.2393678e-07  2.6109412e-16  0              2.995215     
   2300000   139.8          200            200            0.0037493751  -2.7354429e-38  0              0.011248125    2.5095379e-15  0              1.211766e-08   2.6109412e-16  0              2.995215     
   2400000   139.8          200            200            0.003749375   -7.7687257e-39  0              0.011248125    2.1815534e-16  0              1.0533941e-09  2.6109412e-16  0              2.995215     
   2500000   139.8          200            200            0.003749375   -1.555513e-38   0              0.011248125    1.5395048e-17  0              7.4337179e-11  2.6109412e-16  0              2.995215     
   2600000   139.8          200            200            0.003749375    3.975389e-38   0              0.011248125    5.9060916e-19  0              2.8518403e-12  2.6109412e-16  0              2.995215     
   2700000   139.8          200            200            0.003749375   -9.2601292e-39  0              0.011248125    1.722507e-20   0              8.31737e-14    2.6109412e-16  0              2.995215     
   2800000   139.8          200            200            0.003749375    4.470795e-38   0              0.011248125    1.9544642e-20  0              9.4374081e-14  2.6109412e-16  0              2.995215     
   2900000   139.8          200            200            0.003749375   -2.7462709e-38  0              0.011248125    1.6029253e-19  0              7.7399525e-13  2.6109412e-16  0              2.995215     
   3000000   139.8          200            200            0.003749375    3.5918299e-39  0              0.011248125    2.3290806e-22  0              1.1246297e-15  2.6109412e-16  0              2.995215     
Loop time of 64.0486 on 4 procs for 3000000 steps with 51 atoms

Performance: 40469258.927 ns/day, 0.000 hours/ns, 46839.420 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 0.32004    | 1.585      | 5.2332     | 167.4 |  2.47
Neigh   | 0.072312   | 0.072971   | 0.074417   |   0.3 |  0.11
Comm    | 25.645     | 32.192     | 38.009     |  83.6 | 50.26
Output  | 0.074233   | 0.074314   | 0.074365   |   0.0 |  0.12
Modify  | 15.175     | 20.97      | 28.227     | 120.7 | 32.74
Other   |            | 9.154      |            |       | 14.29

Nlocal:          12.75 ave          51 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1
Nghost:          39.25 ave          52 max           1 min
Histogram: 1 0 0 0 0 0 0 0 0 3
Neighs:           6.75 ave          27 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1

Total # of neighbors = 27
Ave neighs/atom = 0.52941176
Neighbor list builds = 166
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 16

#variable lat0 equal 1                    #
variable lat1 equal 3+(151*0.01)+(v_ind*0.01)  # .491+(v_ind*0.001)       # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 10*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.67                                                               
Lattice spacing in x,y,z = 4.67 4.67 4.67

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -70.05 ${n1e1} -100 100 -100 100 units box
region box block -70.05 70.05 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -70.05 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -70.05 70.05 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-70.05 -100 -100) to (70.05 100 100)
  1 by 2 by 2 MPI processor grid
create_atoms 1 region substrate
Created 30 atoms
  using lattice units in orthogonal box = (-70.05 -100 -100) to (70.05 100 100)
  create_atoms CPU = 0.000 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 30 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 21 atoms
  using lattice units in orthogonal box = (-70.05 -100 -100) to (70.05 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  30 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  30 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  21 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  21 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
30 atoms in group substrate
group slider1 region slider1
21 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 21 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_16_*.dump id type diameter mass xu yu zu fx fy fz

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 91 130 130
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 14.5 | 17.97 | 19.12 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   140.1          200            200            0              0              0              0              0              0              0              2.6109412e-16  0              6            
    100000   140.1          200            200            0.0030159383   1.4536798e-37  0              0.009047815    12101.024      0              5.8431513e+10  2.6109412e-16  0              3.332953     
    200000   140.1          200            200            0.0010059826  -1.9485379e-36  0              0.0030179478   2681.281       0              1.2946946e+10  2.6109412e-16  0              3.0860455    
    300000   140.1          200            200           -8.4391991e-05  6.3209754e-37  0             -0.00025317597  47.31562       0              2.284702e+08   2.6109412e-16  0              3.0411484    
    400000   140.1          200            200            0.0071918258   2.3376035e-35  0              0.021575477    170.5418       0              8.2348532e+08  2.6109412e-16  0              2.992497     
    500000   140.1          200            200            0.0012110342  -2.2820384e-35  0              0.0036331026   10.202303      0              49263272       2.6109412e-16  0              2.9977984    
    600000   140.1          200            200            0.0025162767   8.9499612e-36  0              0.0075488301   0.15715347     0              758837.84      2.6109412e-16  0              2.9963228    
    700000   140.1          200            200            0.0033119876   2.2456617e-36  0              0.0099359629   0.099341521    0              479684.65      2.6109412e-16  0              2.9955852    
    800000   140.1          200            200            0.0035953585   2.0203265e-36  0              0.010786076    0.023435463    0              113161.46      2.6109412e-16  0              2.9953387    
    900000   140.1          200            200            0.0036931706  -2.6441675e-39  0              0.011079512    0.0045732045   0              22082.368      2.6109412e-16  0              2.9952555    
   1000000   140.1          200            200            0.0037260211   6.3083979e-37  0              0.011178063    0.00081027394  0              3912.5229      2.6109412e-16  0              2.9952278    
   1100000   140.1          200            200            0.0037367029   8.7543608e-38  0              0.011210109    0.00013404839  0              647.27169      2.6109412e-16  0              2.9952188    
   1200000   140.1          200            200            0.0037400375   6.9954752e-38  0              0.011220112    2.0990865e-05  0              101.35738      2.6109412e-16  0              2.9952161    
   1300000   140.1          200            200            0.0037410212   3.4040697e-39  0              0.011223064    3.1357064e-06  0              15.141204      2.6109412e-16  0              2.9952153    
   1400000   140.1          200            200            0.0037412866   8.0284323e-39  0              0.01122386     4.4891178e-07  0              2.1676343      2.6109412e-16  0              2.9952151    
   1500000   140.1          200            200            0.0037413468   3.2358429e-38  0              0.011224041    6.1736399e-08  0              0.29810298     2.6109412e-16  0              2.995215     
   1600000   140.1          200            200            0.0037413548   2.3486707e-38  0              0.011224064    8.1613432e-09  0              0.039408205    2.6109412e-16  0              2.995215     
   1700000   140.1          200            200            0.0037413524   2.9231256e-38  0              0.011224057    1.0361277e-09  0              0.0050030897   2.6109412e-16  0              2.995215     
   1800000   140.1          200            200            0.0037413497  -1.7246976e-39  0              0.011224049    1.2598769e-10  0              0.00060834945  2.6109412e-16  0              2.995215     
   1900000   140.1          200            200            0.0037413479  -8.4990702e-40  0              0.011224044    1.4600615e-11  0              7.0501143e-05  2.6109412e-16  0              2.995215     
   2000000   140.1          200            200            0.0037413471   3.1820939e-38  0              0.011224041    1.5994359e-12  0              7.7231038e-06  2.6109412e-16  0              2.995215     
   2100000   140.1          200            200            0.0037413467  -2.5738691e-39  0              0.01122404     1.6340183e-13  0              7.8900896e-07  2.6109412e-16  0              2.995215     
   2200000   140.1          200            200            0.0037413465  -1.8182267e-38  0              0.011224039    1.521936e-14   0              7.3488844e-08  2.6109412e-16  0              2.995215     
   2300000   140.1          200            200            0.0037413464   3.1277417e-38  0              0.011224039    1.235919e-15   0              5.9678105e-09  2.6109412e-16  0              2.995215     
   2400000   140.1          200            200            0.0037413464  -1.4663945e-39  0              0.011224039    7.7238907e-17  0              3.7295904e-10  2.6109412e-16  0              2.995215     
   2500000   140.1          200            200            0.0037413464  -2.1733603e-38  0              0.011224039    2.5905762e-18  0              1.2508965e-11  2.6109412e-16  0              2.995215     
   2600000   140.1          200            200            0.0037413464   2.3372923e-38  0              0.011224039    1.2121409e-20  0              5.8529946e-14  2.6109412e-16  0              2.995215     
   2700000   140.1          200            200            0.0037413464   8.5993778e-39  0              0.011224039    3.6271134e-20  0              1.7514033e-13  2.6109412e-16  0              2.995215     
   2800000   140.1          200            200            0.0037413464   2.2051392e-38  0              0.011224039    4.4189116e-20  0              2.1337342e-13  2.6109412e-16  0              2.995215     
   2900000   140.1          200            200            0.0037413464   2.8672244e-38  0              0.011224039    1.9439917e-20  0              9.3868404e-14  2.6109412e-16  0              2.995215     
   3000000   140.1          200            200            0.0037413464   1.6402597e-38  0              0.011224039    1.0605319e-19  0              5.1209289e-13  2.6109412e-16  0              2.995215     
Loop time of 64.0283 on 4 procs for 3000000 steps with 51 atoms

Performance: 40482092.367 ns/day, 0.000 hours/ns, 46854.274 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 0.32928    | 1.5779     | 5.2107     | 167.0 |  2.46
Neigh   | 0.072373   | 0.072905   | 0.074413   |   0.3 |  0.11
Comm    | 25.724     | 32.229     | 38.063     |  83.4 | 50.34
Output  | 0.06298    | 0.063058   | 0.063111   |   0.0 |  0.10
Modify  | 15.121     | 20.913     | 28.141     | 120.7 | 32.66
Other   |            | 9.172      |            |       | 14.33

Nlocal:          12.75 ave          51 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1
Nghost:          39.25 ave          52 max           1 min
Histogram: 1 0 0 0 0 0 0 0 0 3
Neighs:           6.75 ave          27 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1

Total # of neighbors = 27
Ave neighs/atom = 0.52941176
Neighbor list builds = 166
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 17

#variable lat0 equal 1                    #
variable lat1 equal 3+(151*0.01)+(v_ind*0.01)  # .491+(v_ind*0.001)       # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 10*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.68                                                               
Lattice spacing in x,y,z = 4.68 4.68 4.68

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -70.2 ${n1e1} -100 100 -100 100 units box
region box block -70.2 70.2 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -70.2 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -70.2 70.2 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-70.2 -100 -100) to (70.2 100 100)
  1 by 2 by 2 MPI processor grid
create_atoms 1 region substrate
Created 30 atoms
  using lattice units in orthogonal box = (-70.2 -100 -100) to (70.2 100 100)
  create_atoms CPU = 0.000 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 30 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 21 atoms
  using lattice units in orthogonal box = (-70.2 -100 -100) to (70.2 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  30 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  30 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  21 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  21 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
30 atoms in group substrate
group slider1 region slider1
21 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 21 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_17_*.dump id type diameter mass xu yu zu fx fy fz

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 91 130 130
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 14.5 | 17.97 | 19.12 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   140.4          200            200            0              0              0              0              0              0              0              2.6109412e-16  0              6            
    100000   140.4          200            200            0.0030065952  -3.4986498e-37  0              0.0090197856   12083.988      0              5.8349253e+10  2.6109412e-16  0              3.3334432    
    200000   140.4          200            200            0.0009926604   2.0338596e-38  0              0.0029779812   2634.204       0              1.2719628e+10  2.6109412e-16  0              3.088141     
    300000   140.4          200            200           -0.0001019132  -2.17557e-36    0             -0.0003057396   71.561145      0              3.4554316e+08  2.6109412e-16  0              3.0398838    
    400000   140.4          200            200            0.0091337125   2.2676704e-35  0              0.027401138    138.5159       0              6.6884371e+08  2.6109412e-16  0              2.9912192    
    500000   140.4          200            200            0.0010062208  -9.46056e-36    0              0.0030186623   6.4399494      0              31096211       2.6109412e-16  0              2.9980491    
    600000   140.4          200            200            0.0025572623   1.3768739e-35  0              0.007671787    0.47861683     0              2311069.4      2.6109412e-16  0              2.9962741    
    700000   140.4          200            200            0.0033400213  -6.3400739e-36  0              0.010020064    0.17317612     0              836205.53      2.6109412e-16  0              2.9955529    
    800000   140.4          200            200            0.0036045508  -8.0173438e-37  0              0.010813652    0.034879541    0              168420.82      2.6109412e-16  0              2.9953237    
    900000   140.4          200            200            0.0036926294   9.4562566e-37  0              0.011077888    0.0061626439   0              29757.202      2.6109412e-16  0              2.995249     
   1000000   140.4          200            200            0.0037211109   4.8662508e-37  0              0.011163333    0.0010132201   0              4892.477       2.6109412e-16  0              2.9952251    
   1100000   140.4          200            200            0.0037299443   1.3258997e-38  0              0.011189833    0.00015770122  0              761.48273      2.6109412e-16  0              2.9952178    
   1200000   140.4          200            200            0.0037325257  -4.6910108e-38  0              0.011197577    2.3426156e-05  0              113.11653      2.6109412e-16  0              2.9952157    
   1300000   140.4          200            200            0.0037332112  -3.3776951e-38  0              0.011199633    3.3360655e-06  0              16.108667      2.6109412e-16  0              2.9952151    
   1400000   140.4          200            200            0.0037333612   4.7961846e-39  0              0.011200084    4.5644692e-07  0              2.2040188      2.6109412e-16  0              2.995215     
   1500000   140.4          200            200            0.0037333778  -3.4337014e-39  0              0.011200133    6.0030277e-08  0              0.28986472     2.6109412e-16  0              2.995215     
   1600000   140.4          200            200            0.0037333696   1.2723694e-39  0              0.011200109    7.5800996e-09  0              0.036601588    2.6109412e-16  0              2.995215     
   1700000   140.4          200            200            0.0037333613   1.1742341e-38  0              0.011200084    9.1626771e-10  0              0.0044243288   2.6109412e-16  0              2.995215     
   1800000   140.4          200            200            0.0037333564   2.9484209e-38  0              0.011200069    1.0546733e-10  0              0.00050926398  2.6109412e-16  0              2.995215     
   1900000   140.4          200            200            0.003733354    1.0970976e-38  0              0.011200062    1.1460165e-11  0              5.5337035e-05  2.6109412e-16  0              2.995215     
   2000000   140.4          200            200            0.0037333529   4.8349169e-38  0              0.011200059    1.1586857e-12  0              5.5948786e-06  2.6109412e-16  0              2.995215     
   2100000   140.4          200            200            0.0037333524  -1.4088232e-38  0              0.011200057    1.0631482e-13  0              5.1335621e-07  2.6109412e-16  0              2.995215     
   2200000   140.4          200            200            0.0037333522   3.7043665e-39  0              0.011200057    8.4406042e-15  0              4.0756657e-08  2.6109412e-16  0              2.995215     
   2300000   140.4          200            200            0.0037333521  -1.4501437e-38  0              0.011200056    5.2318857e-16  0              2.5262903e-09  2.6109412e-16  0              2.995215     
   2400000   140.4          200            200            0.0037333521   1.0403216e-38  0              0.011200056    1.6570507e-17  0              8.0013047e-11  2.6109412e-16  0              2.995215     
   2500000   140.4          200            200            0.0037333521  -4.4385503e-38  0              0.011200056    1.0812129e-20  0              5.2207902e-14  2.6109412e-16  0              2.995215     
   2600000   140.4          200            200            0.003733352   -2.0730717e-38  0              0.011200056    5.2423558e-19  0              2.531346e-12   2.6109412e-16  0              2.995215     
   2700000   140.4          200            200            0.003733352    2.2228196e-38  0              0.011200056    1.8499224e-19  0              8.9326133e-13  2.6109412e-16  0              2.995215     
   2800000   140.4          200            200            0.003733352    9.9972176e-39  0              0.011200056    8.7266401e-20  0              4.2137822e-13  2.6109412e-16  0              2.995215     
   2900000   140.4          200            200            0.003733352    9.5487529e-39  0              0.011200056    9.1299415e-21  0              4.408522e-14   2.6109412e-16  0              2.995215     
   3000000   140.4          200            200            0.003733352   -2.8971478e-39  0              0.011200056    1.3558376e-19  0              6.5468545e-13  2.6109412e-16  0              2.995215     
Loop time of 64.4398 on 4 procs for 3000000 steps with 51 atoms

Performance: 40223566.877 ns/day, 0.000 hours/ns, 46555.054 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 0.31316    | 1.6387     | 5.4267     | 170.9 |  2.54
Neigh   | 0.072361   | 0.07297    | 0.074473   |   0.3 |  0.11
Comm    | 25.735     | 32.426     | 38.287     |  84.6 | 50.32
Output  | 0.06086    | 0.060942   | 0.061      |   0.0 |  0.09
Modify  | 15.253     | 21.1       | 28.507     | 121.9 | 32.74
Other   |            | 9.141      |            |       | 14.19

Nlocal:          12.75 ave          51 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1
Nghost:          39.25 ave          52 max           1 min
Histogram: 1 0 0 0 0 0 0 0 0 3
Neighs:           6.75 ave          27 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1

Total # of neighbors = 27
Ave neighs/atom = 0.52941176
Neighbor list builds = 166
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 18

#variable lat0 equal 1                    #
variable lat1 equal 3+(151*0.01)+(v_ind*0.01)  # .491+(v_ind*0.001)       # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 10*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.69                                                               
Lattice spacing in x,y,z = 4.69 4.69 4.69

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -70.35 ${n1e1} -100 100 -100 100 units box
region box block -70.35 70.35 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -70.35 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -70.35 70.35 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-70.35 -100 -100) to (70.35 100 100)
  1 by 2 by 2 MPI processor grid
create_atoms 1 region substrate
Created 29 atoms
  using lattice units in orthogonal box = (-70.35 -100 -100) to (70.35 100 100)
  create_atoms CPU = 0.000 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 30 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 21 atoms
  using lattice units in orthogonal box = (-70.35 -100 -100) to (70.35 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  29 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  29 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  21 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  21 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
29 atoms in group substrate
group slider1 region slider1
21 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 21 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_18_*.dump id type diameter mass xu yu zu fx fy fz

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 91 130 130
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 14.5 | 17.97 | 19.12 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   140.7          200            200            0              0              0              0              0              0              0              2.6109412e-16  0              6            
    100000   140.7          200            200            0.0029990793  -6.92468e-38    0              0.0089972378   12078.93       0              6.4805366e+10  2.6109412e-16  0              3.3330654    
    200000   140.7          200            200            0.00097987428  2.5484984e-36  0              0.0029396228   2589.3547      0              1.3892297e+10  2.6109412e-16  0              3.0901821    
    300000   140.7          200            200           -0.00011344154  2.3200138e-36  0             -0.00034032463  91.058227      0              4.8854177e+08  2.6109412e-16  0              3.0388899    
    400000   140.7          200            200            0.010396174   -4.9758519e-35  0              0.031188521    111.48522      0              5.9813583e+08  2.6109412e-16  0              2.9904313    
    500000   140.7          200            200            0.00089628584 -5.5627723e-37  0              0.0026888575   4.2371716      0              22733095       2.6109412e-16  0              2.9981874    
    600000   140.7          200            200            0.0025994011  -3.9952095e-35  0              0.0077982032   0.78790456     0              4227232.4      2.6109412e-16  0              2.9962257    
    700000   140.7          200            200            0.0033628389   6.4551714e-36  0              0.010088517    0.23065418     0              1237496.1      2.6109412e-16  0              2.9955256    
    800000   140.7          200            200            0.0036104237  -2.4871492e-36  0              0.010831271    0.04301629     0              230789.19      2.6109412e-16  0              2.9953118    
    900000   140.7          200            200            0.0036904392   5.684363e-37   0              0.011071318    0.0072076493   0              38670.176      2.6109412e-16  0              2.9952441    
   1000000   140.7          200            200            0.0037154678   1.3489815e-37  0              0.011146403    0.0011356068   0              6092.7098      2.6109412e-16  0              2.9952232    
   1100000   140.7          200            200            0.0037228895  -1.4368799e-38  0              0.011168668    0.00017039008  0              914.1697       2.6109412e-16  0              2.995217     
   1200000   140.7          200            200            0.0037249113   2.1920733e-38  0              0.011174734    2.4485833e-05  0              131.37036      2.6109412e-16  0              2.9952154    
   1300000   140.7          200            200            0.0037253803  -8.2820386e-39  0              0.011176141    3.3794385e-06  0              18.131221      2.6109412e-16  0              2.995215     
   1400000   140.7          200            200            0.0037254484   1.0306403e-38  0              0.011176345    4.4834107e-07  0              2.4054206      2.6109412e-16  0              2.995215     
   1500000   140.7          200            200            0.0037254346  -5.1267477e-39  0              0.011176304    5.7130494e-08  0              0.30651412     2.6109412e-16  0              2.995215     
   1600000   140.7          200            200            0.0037254153  -2.1792784e-39  0              0.011176246    6.9747337e-09  0              0.037420548    2.6109412e-16  0              2.995215     
   1700000   140.7          200            200            0.0037254031   1.5259687e-38  0              0.011176209    8.1198762e-10  0              0.0043564418   2.6109412e-16  0              2.995215     
   1800000   140.7          200            200            0.0037253969  -1.6976573e-38  0              0.011176191    8.944003e-11   0              0.00047985989  2.6109412e-16  0              2.995215     
   1900000   140.7          200            200            0.003725394   -8.7083877e-39  0              0.011176182    9.2021116e-12  0              4.9370782e-05  2.6109412e-16  0              2.995215     
   2000000   140.7          200            200            0.0037253927   2.6889858e-38  0              0.011176178    8.6496993e-13  0              4.6407003e-06  2.6109412e-16  0              2.995215     
   2100000   140.7          200            200            0.0037253922   1.3294115e-38  0              0.011176176    7.1328643e-14  0              3.8268943e-07  2.6109412e-16  0              2.995215     
   2200000   140.7          200            200            0.0037253919   3.1413478e-39  0              0.011176176    4.7153238e-15  0              2.5298457e-08  2.6109412e-16  0              2.995215     
   2300000   140.7          200            200            0.0037253919  -1.2792393e-39  0              0.011176176    1.9630084e-16  0              1.053185e-09   2.6109412e-16  0              2.995215     
   2400000   140.7          200            200            0.0037253918   8.8918292e-39  0              0.011176175    5.8349632e-19  0              3.1305499e-12  2.6109412e-16  0              2.995215     
   2500000   140.7          200            200            0.0037253918   1.4051273e-38  0              0.011176175    1.7477021e-18  0              9.3766977e-12  2.6109412e-16  0              2.995215     
   2600000   140.7          200            200            0.0037253918  -3.1678134e-38  0              0.011176175    1.318363e-18   0              7.0732257e-12  2.6109412e-16  0              2.995215     
   2700000   140.7          200            200            0.0037253918  -9.9067615e-39  0              0.011176175    3.6547682e-19  0              1.9608409e-12  2.6109412e-16  0              2.995215     
   2800000   140.7          200            200            0.0037253918   9.4145116e-39  0              0.011176175    1.086187e-19   0              5.8275646e-13  2.6109412e-16  0              2.995215     
   2900000   140.7          200            200            0.0037253918   9.8954232e-39  0              0.011176175    4.086937e-21   0              2.1927062e-14  2.6109412e-16  0              2.995215     
   3000000   140.7          200            200            0.0037253918  -1.5270047e-39  0              0.011176175    1.4392028e-19  0              7.7215503e-13  2.6109412e-16  0              2.995215     
Loop time of 63.1317 on 4 procs for 3000000 steps with 50 atoms

Performance: 41057030.176 ns/day, 0.000 hours/ns, 47519.711 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 0.3047     | 1.5929     | 5.273      | 168.4 |  2.52
Neigh   | 0.07235    | 0.072923   | 0.074344   |   0.3 |  0.12
Comm    | 25.258     | 31.493     | 37.124     |  81.2 | 49.88
Output  | 0.060572   | 0.060651   | 0.060705   |   0.0 |  0.10
Modify  | 15.136     | 20.802     | 27.753     | 117.4 | 32.95
Other   |            | 9.111      |            |       | 14.43

Nlocal:           12.5 ave          50 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1
Nghost:           37.5 ave          50 max           0 min
Histogram: 1 0 0 0 0 0 0 0 0 3
Neighs:           6.75 ave          27 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1

Total # of neighbors = 27
Ave neighs/atom = 0.54
Neighbor list builds = 166
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 19

#variable lat0 equal 1                    #
variable lat1 equal 3+(151*0.01)+(v_ind*0.01)  # .491+(v_ind*0.001)       # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 10*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.7                                                               
Lattice spacing in x,y,z = 4.7 4.7 4.7

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -70.5 ${n1e1} -100 100 -100 100 units box
region box block -70.5 70.5 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -70.5 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -70.5 70.5 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-70.5 -100 -100) to (70.5 100 100)
  1 by 2 by 2 MPI processor grid
create_atoms 1 region substrate
Created 30 atoms
  using lattice units in orthogonal box = (-70.5 -100 -100) to (70.5 100 100)
  create_atoms CPU = 0.000 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 30 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 21 atoms
  using lattice units in orthogonal box = (-70.5 -100 -100) to (70.5 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  30 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  30 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  21 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  21 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
30 atoms in group substrate
group slider1 region slider1
21 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 21 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_19_*.dump id type diameter mass xu yu zu fx fy fz

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 91 130 130
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 14.5 | 17.97 | 19.12 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   141            200            200            0              0              0              0              0              0              0              2.6109412e-16  0              6            
    100000   141            200            200            0.0029949253   7.0066615e-38  0              0.0089847758   12095.455      0              5.8404625e+10  2.6109412e-16  0              3.33137      
    200000   141            200            200            0.00097014047 -2.208223e-36   0              0.0029104214   2557.3161      0              1.2348364e+10  2.6109412e-16  0              3.091604     
    300000   141            200            200           -0.00011985324  7.7640527e-38  0             -0.00035955972  103.41965      0              4.9937646e+08  2.6109412e-16  0              3.0382611    
    400000   141            200            200            0.011037799   -3.2262728e-35  0              0.033113396    95.693567      0              4.6206999e+08  2.6109412e-16  0              2.990036     
    500000   141            200            200            0.00084671147 -5.1678232e-36  0              0.0025401344   3.2151837      0              15524972       2.6109412e-16  0              2.9982495    
    600000   141            200            200            0.0026246647  -2.2015388e-35  0              0.0078739942   0.97856422     0              4725136.4      2.6109412e-16  0              2.9961947    
    700000   141            200            200            0.0033735893   3.0031061e-36  0              0.010120768    0.26264603     0              1268223.7      2.6109412e-16  0              2.9955093    
    800000   141            200            200            0.0036106133  -2.5034753e-36  0              0.01083184     0.047305439    0              228421.04      2.6109412e-16  0              2.9953048    
    900000   141            200            200            0.0036858201   2.6948885e-37  0              0.01105746     0.0077298313   0              37324.589      2.6109412e-16  0              2.9952413    
   1000000   141            200            200            0.0037088447   4.8003569e-37  0              0.011126534    0.0011927457   0              5759.3422      2.6109412e-16  0              2.995222     
   1100000   141            200            200            0.0037154641   8.1907339e-39  0              0.011146392    0.0001756893   0              848.34074      2.6109412e-16  0              2.9952166    
   1200000   141            200            200            0.0037171735  -3.5099903e-39  0              0.01115152     2.4818226e-05  0              119.83833      2.6109412e-16  0              2.9952152    
   1300000   141            200            200            0.0037175235  -1.6073108e-38  0              0.01115257     3.3689175e-06  0              16.267297      2.6109412e-16  0              2.9952149    
   1400000   141            200            200            0.0037175472   1.2608312e-38  0              0.011152642    4.3952677e-07  0              2.1223175      2.6109412e-16  0              2.9952149    
   1500000   141            200            200            0.0037175172   7.0174516e-39  0              0.011152551    5.5031911e-08  0              0.2657294      2.6109412e-16  0              2.995215     
   1600000   141            200            200            0.003717492   -7.5470173e-39  0              0.011152476    6.5905241e-09  0              0.031823282    2.6109412e-16  0              2.995215     
   1700000   141            200            200            0.0037174778   3.3830632e-38  0              0.011152433    7.5051529e-10  0              0.0036239698   2.6109412e-16  0              2.995215     
   1800000   141            200            200            0.0037174709  -5.9573948e-40  0              0.011152413    8.0491331e-11  0              0.00038866383  2.6109412e-16  0              2.995215     
   1900000   141            200            200            0.0037174677  -9.9110103e-39  0              0.011152403    8.0008801e-12  0              3.8633387e-05  2.6109412e-16  0              2.995215     
   2000000   141            200            200            0.0037174664   3.8634503e-38  0              0.011152399    7.1666808e-13  0              3.4605337e-06  2.6109412e-16  0              2.995215     
   2100000   141            200            200            0.0037174658   3.1167051e-39  0              0.011152397    5.4700902e-14  0              2.6413108e-07  2.6109412e-16  0              2.995215     
   2200000   141            200            200            0.0037174656   3.4405271e-38  0              0.011152397    3.1185224e-15  0              1.5058229e-08  2.6109412e-16  0              2.995215     
   2300000   141            200            200            0.0037174655  -4.2237334e-38  0              0.011152396    8.3658701e-17  0              4.0395793e-10  2.6109412e-16  0              2.995215     
   2400000   141            200            200            0.0037174655   1.5872278e-38  0              0.011152396    1.0237894e-18  0              4.9435128e-12  2.6109412e-16  0              2.995215     
   2500000   141            200            200            0.0037174654  -1.4075093e-38  0              0.011152396    3.8889806e-18  0              1.8778495e-11  2.6109412e-16  0              2.995215     
   2600000   141            200            200            0.0037174654  -7.3944393e-39  0              0.011152396    1.9000039e-18  0              9.1744387e-12  2.6109412e-16  0              2.995215     
   2700000   141            200            200            0.0037174654  -7.6721971e-39  0              0.011152396    4.604062e-19   0              2.2231368e-12  2.6109412e-16  0              2.995215     
   2800000   141            200            200            0.0037174654   8.1383213e-38  0              0.011152396    1.4378062e-19  0              6.9426513e-13  2.6109412e-16  0              2.995215     
   2900000   141            200            200            0.0037174654  -1.0096879e-38  0              0.011152396    3.4712473e-20  0              1.6761411e-13  2.6109412e-16  0              2.995215     
   3000000   141            200            200            0.0037174654   3.0772254e-38  0              0.011152396    4.4514162e-20  0              2.1494296e-13  2.6109412e-16  0              2.995215     
Loop time of 64.3215 on 4 procs for 3000000 steps with 51 atoms

Performance: 40297536.915 ns/day, 0.000 hours/ns, 46640.668 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 0.31689    | 1.5576     | 5.1404     | 165.8 |  2.42
Neigh   | 0.071537   | 0.072125   | 0.07365    |   0.3 |  0.11
Comm    | 25.787     | 32.271     | 38.047     |  83.4 | 50.17
Output  | 0.076319   | 0.076393   | 0.076444   |   0.0 |  0.12
Modify  | 15.371     | 21.171     | 28.389     | 120.4 | 32.91
Other   |            | 9.174      |            |       | 14.26

Nlocal:          12.75 ave          51 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1
Nghost:          39.25 ave          52 max           1 min
Histogram: 1 0 0 0 0 0 0 0 0 3
Neighs:           6.25 ave          25 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1

Total # of neighbors = 25
Ave neighs/atom = 0.49019608
Neighbor list builds = 164
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 20

#variable lat0 equal 1                    #
variable lat1 equal 3+(151*0.01)+(v_ind*0.01)  # .491+(v_ind*0.001)       # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 10*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.71                                                               
Lattice spacing in x,y,z = 4.71 4.71 4.71

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -70.65 ${n1e1} -100 100 -100 100 units box
region box block -70.65 70.65 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -70.65 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -70.65 70.65 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-70.65 -100 -100) to (70.65 100 100)
  1 by 2 by 2 MPI processor grid
create_atoms 1 region substrate
Created 30 atoms
  using lattice units in orthogonal box = (-70.65 -100 -100) to (70.65 100 100)
  create_atoms CPU = 0.000 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 30 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 21 atoms
  using lattice units in orthogonal box = (-70.65 -100 -100) to (70.65 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  30 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  30 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  21 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  21 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
30 atoms in group substrate
group slider1 region slider1
21 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 21 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_20_*.dump id type diameter mass xu yu zu fx fy fz

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 92 130 130
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 14.52 | 17.99 | 19.14 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   141.3          200            200            0              0              0              0              0              0              0              2.6109412e-16  0              6            
    100000   141.3          200            200            0.0029918718   3.5041828e-38  0              0.0089756154   12117.528      0              5.8511206e+10  2.6109412e-16  0              3.3298295    
    200000   141.3          200            200            0.00096882392  1.1458851e-36  0              0.0029064718   2560.629       0              1.2364361e+10  2.6109412e-16  0              3.0912371    
    300000   141.3          200            200           -0.00012065172 -1.5971487e-36  0             -0.00036195516  105.47116      0              5.0928248e+08  2.6109412e-16  0              3.038144     
    400000   141.3          200            200            0.011047532   -5.5506627e-36  0              0.033142595    94.815533      0              4.5783027e+08  2.6109412e-16  0              2.9900164    
    500000   141.3          200            200            0.00084562675  3.6495904e-36  0              0.0025368802   3.221997       0              15557870       2.6109412e-16  0              2.9982485    
    600000   141.3          200            200            0.002618855    2.0605106e-37  0              0.0078565651   0.97582336     0              4711901.8      2.6109412e-16  0              2.996195     
    700000   141.3          200            200            0.0033662419   1.3019315e-36  0              0.010098726    0.26215057     0              1265831.3      2.6109412e-16  0              2.9955095    
    800000   141.3          200            200            0.0036028598   1.9454063e-36  0              0.010808579    0.047235923    0              228085.37      2.6109412e-16  0              2.9953049    
    900000   141.3          200            200            0.0036779569   6.1275082e-37  0              0.011033871    0.0077208779   0              37281.356      2.6109412e-16  0              2.9952413    
   1000000   141.3          200            200            0.0037009548   4.7346046e-37  0              0.011102864    0.0011916772   0              5754.1828      2.6109412e-16  0              2.9952221    
   1100000   141.3          200            200            0.0037075695  -3.9643377e-38  0              0.011122708    0.00017557317  0              847.77999      2.6109412e-16  0              2.9952166    
   1200000   141.3          200            200            0.003709279    7.7775251e-40  0              0.011127837    2.4807283e-05  0              119.78549      2.6109412e-16  0              2.9952152    
   1300000   141.3          200            200            0.0037096297   1.19556e-38    0              0.011128889    3.3681561e-06  0              16.26362       2.6109412e-16  0              2.9952149    
   1400000   141.3          200            200            0.003709654    6.4457798e-39  0              0.011128962    4.3952345e-07  0              2.1223015      2.6109412e-16  0              2.9952149    
   1500000   141.3          200            200            0.0037096242   3.7411371e-39  0              0.011128873    5.5044245e-08  0              0.26578896     2.6109412e-16  0              2.995215     
   1600000   141.3          200            200            0.0037095992   1.4978678e-38  0              0.011128798    6.5936877e-09  0              0.031838558    2.6109412e-16  0              2.995215     
   1700000   141.3          200            200            0.0037095851   2.5298114e-38  0              0.011128755    7.5109389e-10  0              0.0036267636   2.6109412e-16  0              2.995215     
   1800000   141.3          200            200            0.0037095781   4.5001731e-38  0              0.011128734    8.0582112e-11  0              0.00038910218  2.6109412e-16  0              2.995215     
   1900000   141.3          200            200            0.003709575   -2.3675023e-38  0              0.011128725    8.013726e-12   0              3.8695415e-05  2.6109412e-16  0              2.995215     
   2000000   141.3          200            200            0.0037095737   3.2956024e-38  0              0.011128721    7.1827683e-13  0              3.4683018e-06  2.6109412e-16  0              2.995215     
   2100000   141.3          200            200            0.0037095731   1.3009779e-39  0              0.011128719    5.4897233e-14  0              2.6507909e-07  2.6109412e-16  0              2.995215     
   2200000   141.3          200            200            0.0037095729   1.8821814e-38  0              0.011128719    3.1362324e-15  0              1.5143744e-08  2.6109412e-16  0              2.995215     
   2300000   141.3          200            200            0.0037095728   5.6194151e-40  0              0.011128718    8.4802726e-17  0              4.0948202e-10  2.6109412e-16  0              2.995215     
   2400000   141.3          200            200            0.0037095728   3.1667684e-38  0              0.011128718    1.0175512e-18  0              4.9133908e-12  2.6109412e-16  0              2.995215     
   2500000   141.3          200            200            0.0037095727   5.3823226e-39  0              0.011128718    3.893602e-18   0              1.8800811e-11  2.6109412e-16  0              2.995215     
   2600000   141.3          200            200            0.0037095727   1.1229269e-38  0              0.011128718    1.9022005e-18  0              9.1850457e-12  2.6109412e-16  0              2.995215     
   2700000   141.3          200            200            0.0037095727   1.8795344e-38  0              0.011128718    4.8663427e-19  0              2.3497827e-12  2.6109412e-16  0              2.995215     
   2800000   141.3          200            200            0.0037095727  -6.6855211e-39  0              0.011128718    1.5104566e-19  0              7.2934543e-13  2.6109412e-16  0              2.995215     
   2900000   141.3          200            200            0.0037095727   3.5240284e-38  0              0.011128718    4.048725e-20   0              1.9549844e-13  2.6109412e-16  0              2.995215     
   3000000   141.3          200            200            0.0037095727  -2.0038688e-38  0              0.011128718    4.7871078e-20  0              2.311523e-13   2.6109412e-16  0              2.995215     
Loop time of 64.2189 on 4 procs for 3000000 steps with 51 atoms

Performance: 40361963.726 ns/day, 0.000 hours/ns, 46715.236 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 0.30655    | 1.5556     | 5.1163     | 164.9 |  2.42
Neigh   | 0.072219   | 0.072794   | 0.074294   |   0.3 |  0.11
Comm    | 25.709     | 32.28      | 38.05      |  83.8 | 50.27
Output  | 0.061402   | 0.061482   | 0.061536   |   0.0 |  0.10
Modify  | 15.262     | 21.045     | 28.307     | 120.8 | 32.77
Other   |            | 9.203      |            |       | 14.33

Nlocal:          12.75 ave          51 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1
Nghost:          39.25 ave          52 max           1 min
Histogram: 1 0 0 0 0 0 0 0 0 3
Neighs:           6.25 ave          25 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1

Total # of neighbors = 25
Ave neighs/atom = 0.49019608
Neighbor list builds = 164
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 21

#variable lat0 equal 1                    #
variable lat1 equal 3+(151*0.01)+(v_ind*0.01)  # .491+(v_ind*0.001)       # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 10*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.72                                                               
Lattice spacing in x,y,z = 4.72 4.72 4.72

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -70.8 ${n1e1} -100 100 -100 100 units box
region box block -70.8 70.8 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -70.8 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -70.8 70.8 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-70.8 -100 -100) to (70.8 100 100)
  1 by 2 by 2 MPI processor grid
create_atoms 1 region substrate
Created 30 atoms
  using lattice units in orthogonal box = (-70.8 -100 -100) to (70.8 100 100)
  create_atoms CPU = 0.000 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 30 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 21 atoms
  using lattice units in orthogonal box = (-70.8 -100 -100) to (70.8 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  30 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  30 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  21 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  21 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
30 atoms in group substrate
group slider1 region slider1
21 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 21 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_21_*.dump id type diameter mass xu yu zu fx fy fz

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 92 130 130
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 14.52 | 17.99 | 19.14 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   141.6          200            200            0              0              0              0              0              0              0              2.6109412e-16  0              6            
    100000   141.6          200            200            0.002988879    2.1768035e-38  0              0.008966637    12137.957      0              5.8609848e+10  2.6109412e-16  0              3.3290348    
    200000   141.6          200            200            0.00098206835 -5.3902414e-37  0              0.002946205    2625.5625      0              1.2677902e+10  2.6109412e-16  0              3.0878857    
    300000   141.6          200            200           -0.00011258619 -3.2704292e-36  0             -0.00033775857  90.820195      0              4.3853822e+08  2.6109412e-16  0              3.0388653    
    400000   141.6          200            200            0.010111526    3.8887004e-35  0              0.030334579    116.29185      0              5.6153173e+08  2.6109412e-16  0              2.9905641    
    500000   141.6          200            200            0.00091721116 -3.245842e-35   0              0.0027516335   4.7746968      0              23055302       2.6109412e-16  0              2.9981527    
    600000   141.6          200            200            0.0025693976  -2.2984062e-35  0              0.0077081929   0.69822279     0              3371468        2.6109412e-16  0              2.9962394    
    700000   141.6          200            200            0.0033331699   1.1227301e-36  0              0.0099995096   0.21468384     0              1036631.4      2.6109412e-16  0              2.9955332    
    800000   141.6          200            200            0.003583754    5.0162652e-36  0              0.010751262    0.040802814    0              197022.19      2.6109412e-16  0              2.9953151    
    900000   141.6          200            200            0.003665433    9.5588746e-37  0              0.010996299    0.0069287809   0              33456.603      2.6109412e-16  0              2.9952454    
   1000000   141.6          200            200            0.0036912309   3.8017648e-37  0              0.011073693    0.0011036619   0              5329.1882      2.6109412e-16  0              2.9952237    
   1100000   141.6          200            200            0.0036989844  -1.254675e-37   0              0.011096953    0.00016718335  0              807.26857      2.6109412e-16  0              2.9952172    
   1200000   141.6          200            200            0.0037011435  -6.3435792e-39  0              0.01110343     2.4235784e-05  0              117.02593      2.6109412e-16  0              2.9952154    
   1300000   141.6          200            200            0.0037016674   2.5141678e-38  0              0.011105002    3.3729837e-06  0              16.286931      2.6109412e-16  0              2.995215     
   1400000   141.6          200            200            0.0037017571   1.1185882e-38  0              0.011105271    4.5122164e-07  0              2.1787878      2.6109412e-16  0              2.995215     
   1500000   141.6          200            200            0.0037017515   1.0926569e-38  0              0.011105254    5.7995169e-08  0              0.28003792     2.6109412e-16  0              2.995215     
   1600000   141.6          200            200            0.0037017352  -1.5387119e-39  0              0.011105206    7.1465121e-09  0              0.034507949    2.6109412e-16  0              2.995215     
   1700000   141.6          200            200            0.0037017242   4.1507058e-38  0              0.011105173    8.4077453e-10  0              0.0040597993   2.6109412e-16  0              2.995215     
   1800000   141.6          200            200            0.0037017183   1.5467395e-38  0              0.011105155    9.3774188e-11  0              0.00045280199  2.6109412e-16  0              2.995215     
   1900000   141.6          200            200            0.0037017156   3.1640142e-38  0              0.011105147    9.8013436e-12  0              4.732718e-05   2.6109412e-16  0              2.995215     
   2000000   141.6          200            200            0.0037017143  -1.0108459e-38  0              0.011105143    9.414051e-13   0              4.5457083e-06  2.6109412e-16  0              2.995215     
   2100000   141.6          200            200            0.0037017138  -1.3922865e-38  0              0.011105141    8.0161015e-14  0              3.8706885e-07  2.6109412e-16  0              2.995215     
   2200000   141.6          200            200            0.0037017136   1.808005e-38   0              0.011105141    5.6150408e-15  0              2.7113023e-08  2.6109412e-16  0              2.995215     
   2300000   141.6          200            200            0.0037017135   5.7688517e-38  0              0.011105141    2.6954337e-16  0              1.3015285e-09  2.6109412e-16  0              2.995215     
   2400000   141.6          200            200            0.0037017135   2.663859e-38   0              0.01110514     2.7935068e-18  0              1.3488845e-11  2.6109412e-16  0              2.995215     
   2500000   141.6          200            200            0.0037017135   1.1827647e-39  0              0.01110514     1.000413e-18   0              4.8306362e-12  2.6109412e-16  0              2.995215     
   2600000   141.6          200            200            0.0037017135  -3.3820568e-38  0              0.01110514     1.0793023e-18  0              5.2115645e-12  2.6109412e-16  0              2.995215     
   2700000   141.6          200            200            0.0037017135  -1.9515791e-38  0              0.01110514     3.1732491e-19  0              1.5322484e-12  2.6109412e-16  0              2.995215     
   2800000   141.6          200            200            0.0037017135   3.3321862e-38  0              0.01110514     1.0354349e-19  0              4.9997447e-13  2.6109412e-16  0              2.995215     
   2900000   141.6          200            200            0.0037017135   9.4676864e-39  0              0.01110514     5.0054462e-20  0              2.4169508e-13  2.6109412e-16  0              2.995215     
   3000000   141.6          200            200            0.0037017135   4.7959886e-39  0              0.01110514     2.2724484e-20  0              1.097284e-13   2.6109412e-16  0              2.995215     
Loop time of 64.2398 on 4 procs for 3000000 steps with 51 atoms

Performance: 40348846.301 ns/day, 0.000 hours/ns, 46700.054 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 0.3209     | 1.5829     | 5.2122     | 166.6 |  2.46
Neigh   | 0.07226    | 0.072799   | 0.074297   |   0.3 |  0.11
Comm    | 25.704     | 32.31      | 38.061     |  84.1 | 50.30
Output  | 0.062581   | 0.062661   | 0.062717   |   0.0 |  0.10
Modify  | 15.278     | 21.06      | 28.368     | 121.3 | 32.78
Other   |            | 9.152      |            |       | 14.25

Nlocal:          12.75 ave          51 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1
Nghost:          39.25 ave          52 max           1 min
Histogram: 1 0 0 0 0 0 0 0 0 3
Neighs:           6.25 ave          25 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1

Total # of neighbors = 25
Ave neighs/atom = 0.49019608
Neighbor list builds = 164
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 22

#variable lat0 equal 1                    #
variable lat1 equal 3+(151*0.01)+(v_ind*0.01)  # .491+(v_ind*0.001)       # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 10*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.73                                                               
Lattice spacing in x,y,z = 4.73 4.73 4.73

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -70.95 ${n1e1} -100 100 -100 100 units box
region box block -70.95 70.95 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -70.95 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -70.95 70.95 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-70.95 -100 -100) to (70.95 100 100)
  1 by 2 by 2 MPI processor grid
create_atoms 1 region substrate
Created 30 atoms
  using lattice units in orthogonal box = (-70.95 -100 -100) to (70.95 100 100)
  create_atoms CPU = 0.000 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 30 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 21 atoms
  using lattice units in orthogonal box = (-70.95 -100 -100) to (70.95 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  30 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  30 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  21 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  21 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
30 atoms in group substrate
group slider1 region slider1
21 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 21 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_22_*.dump id type diameter mass xu yu zu fx fy fz

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 92 130 130
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 14.52 | 17.99 | 19.14 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   141.9          200            200            0              0              0              0              0              0              0              2.6109412e-16  0              6            
    100000   141.9          200            200            0.0029855881  -2.6057989e-38  0              0.0089567643   12154.567      0              5.8690053e+10  2.6109412e-16  0              3.3290608    
    200000   141.9          200            200            0.00099935398  5.638009e-37   0              0.002998062    2708.0704      0              1.3076303e+10  2.6109412e-16  0              3.0842585    
    300000   141.9          200            200           -8.7063931e-05  6.1902441e-37  0             -0.00026119179  52.011853      0              2.5114662e+08  2.6109412e-16  0              3.0408627    
    400000   141.9          200            200            0.0072862738   3.9071973e-35  0              0.021858821    167.82581      0              8.1037078e+08  2.6109412e-16  0              2.9923698    
    500000   141.9          200            200            0.001189121    1.1934539e-35  0              0.003567363    10.062361      0              48587540       2.6109412e-16  0              2.9978063    
    600000   141.9          200            200            0.0024857793  -1.3004172e-36  0              0.007457338    0.16391987     0              791510.4       2.6109412e-16  0              2.9963213    
    700000   141.9          200            200            0.0032709875   2.9020028e-36  0              0.0098129625   0.10112778     0              488309.86      2.6109412e-16  0              2.9955843    
    800000   141.9          200            200            0.0035502318   1.6156298e-36  0              0.010650695    0.02372275     0              114548.67      2.6109412e-16  0              2.9953383    
    900000   141.9          200            200            0.0036465308  -6.6004336e-37  0              0.010939592    0.0046139762   0              22279.24       2.6109412e-16  0              2.9952553    
   1000000   141.9          200            200            0.0036788426   1.890437e-37   0              0.011036528    0.00081554985  0              3937.9984      2.6109412e-16  0              2.9952277    
   1100000   141.9          200            200            0.0036893373  -7.1896409e-38  0              0.011068012    0.00013466727  0              650.26006      2.6109412e-16  0              2.9952188    
   1200000   141.9          200            200            0.0036926086   7.9357791e-39  0              0.011077826    2.1054398e-05  0              101.66415      2.6109412e-16  0              2.9952161    
   1300000   141.9          200            200            0.0036935715  -1.1897332e-38  0              0.011080715    3.14079e-06    0              15.165751      2.6109412e-16  0              2.9952153    
   1400000   141.9          200            200            0.0036938303  -1.1468149e-38  0              0.011081491    4.4905625e-07  0              2.1683319      2.6109412e-16  0              2.9952151    
   1500000   141.9          200            200            0.0036938886  -3.4659909e-39  0              0.011081666    6.1678961e-08  0              0.29782563     2.6109412e-16  0              2.995215     
   1600000   141.9          200            200            0.003693896    2.1597703e-39  0              0.011081688    8.1435051e-09  0              0.039322072    2.6109412e-16  0              2.995215     
   1700000   141.9          200            200            0.0036938935   8.8151953e-39  0              0.011081681    1.0325062e-09  0              0.0049856027   2.6109412e-16  0              2.995215     
   1800000   141.9          200            200            0.0036938907   5.1017366e-39  0              0.011081672    1.2536673e-10  0              0.00060535108  2.6109412e-16  0              2.995215     
   1900000   141.9          200            200            0.003693889    2.3846744e-38  0              0.011081667    1.4504485e-11  0              7.0036965e-05  2.6109412e-16  0              2.995215     
   2000000   141.9          200            200            0.0036938881   2.0485227e-39  0              0.011081664    1.5858796e-12  0              7.6576452e-06  2.6109412e-16  0              2.995215     
   2100000   141.9          200            200            0.0036938877  -1.6778687e-38  0              0.011081663    1.6164787e-13  0              7.8053971e-07  2.6109412e-16  0              2.995215     
   2200000   141.9          200            200            0.0036938876   1.953492e-38   0              0.011081663    1.4997694e-14  0              7.2418496e-08  2.6109412e-16  0              2.995215     
   2300000   141.9          200            200            0.0036938875   3.2877932e-38  0              0.011081662    1.2118941e-15  0              5.8518029e-09  2.6109412e-16  0              2.995215     
   2400000   141.9          200            200            0.0036938875  -9.255989e-39   0              0.011081662    7.5044326e-17  0              3.6236219e-10  2.6109412e-16  0              2.995215     
   2500000   141.9          200            200            0.0036938874   1.2643517e-38  0              0.011081662    2.4879862e-18  0              1.2013595e-11  2.6109412e-16  0              2.995215     
   2600000   141.9          200            200            0.0036938874  -3.5984043e-38  0              0.011081662    1.3341578e-20  0              6.4421703e-14  2.6109412e-16  0              2.995215     
   2700000   141.9          200            200            0.0036938874   9.9860508e-39  0              0.011081662    4.1212833e-20  0              1.9900202e-13  2.6109412e-16  0              2.995215     
   2800000   141.9          200            200            0.0036938874  -3.5391404e-39  0              0.011081662    4.2574033e-20  0              2.0557477e-13  2.6109412e-16  0              2.995215     
   2900000   141.9          200            200            0.0036938874   3.8858627e-39  0              0.011081662    4.041901e-20   0              1.9516893e-13  2.6109412e-16  0              2.995215     
   3000000   141.9          200            200            0.0036938874   6.3057439e-39  0              0.011081662    4.9705459e-20  0              2.4000987e-13  2.6109412e-16  0              2.995215     
Loop time of 64.17 on 4 procs for 3000000 steps with 51 atoms

Performance: 40392702.731 ns/day, 0.000 hours/ns, 46750.813 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 0.32589    | 1.5454     | 5.096      | 164.9 |  2.41
Neigh   | 0.073107   | 0.073691   | 0.075242   |   0.3 |  0.11
Comm    | 25.776     | 32.299     | 38.057     |  83.9 | 50.33
Output  | 0.061331   | 0.061412   | 0.061471   |   0.0 |  0.10
Modify  | 15.284     | 21.069     | 28.3       | 121.1 | 32.83
Other   |            | 9.122      |            |       | 14.21

Nlocal:          12.75 ave          51 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1
Nghost:          39.25 ave          52 max           1 min
Histogram: 1 0 0 0 0 0 0 0 0 3
Neighs:           6.25 ave          25 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1

Total # of neighbors = 25
Ave neighs/atom = 0.49019608
Neighbor list builds = 166
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 23

#variable lat0 equal 1                    #
variable lat1 equal 3+(151*0.01)+(v_ind*0.01)  # .491+(v_ind*0.001)       # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 10*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.74                                                               
Lattice spacing in x,y,z = 4.74 4.74 4.74

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -71.1 ${n1e1} -100 100 -100 100 units box
region box block -71.1 71.1 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -71.1 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -71.1 71.1 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-71.1 -100 -100) to (71.1 100 100)
  1 by 2 by 2 MPI processor grid
create_atoms 1 region substrate
Created 29 atoms
  using lattice units in orthogonal box = (-71.1 -100 -100) to (71.1 100 100)
  create_atoms CPU = 0.000 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 30 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 21 atoms
  using lattice units in orthogonal box = (-71.1 -100 -100) to (71.1 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  29 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  29 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  21 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  21 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
29 atoms in group substrate
group slider1 region slider1
21 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 21 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_23_*.dump id type diameter mass xu yu zu fx fy fz

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 92 130 130
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 14.52 | 17.99 | 19.14 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   142.2          200            200            0              0              0              0              0              0              0              2.6109412e-16  0              6            
    100000   142.2          200            200            0.0029819778   1.0837792e-39  0              0.0089459335   12167.72       0              6.5281742e+10  2.6109412e-16  0              3.329715     
    200000   142.2          200            200            0.0010144868  -4.1562758e-37  0              0.0030434603   2781.7337      0              1.4924441e+10  2.6109412e-16  0              3.0816711    
    300000   142.2          200            200           -3.0819784e-05 -4.4022549e-36  0             -9.2459352e-05  5.9469082      0              31906102       2.6109412e-16  0              3.0436029    
    400000   142.2          200            200            0.0012922459  -3.392423e-35   0              0.0038767378   178.71363      0              9.5882685e+08  2.6109412e-16  0              2.9974429    
    500000   142.2          200            200            0.0023258959   6.5798686e-36  0              0.0069776876   24.304496      0              1.3039746e+08  2.6109412e-16  0              2.9965472    
    600000   142.2          200            200            0.0025264733  -9.5361768e-36  0              0.0075794198   0.41121351     0              2206225.4      2.6109412e-16  0              2.9962892    
    700000   142.2          200            200            0.0032250647  -6.0273937e-36  0              0.009675194    0.00521438     0              27975.972      2.6109412e-16  0              2.995624     
    800000   142.2          200            200            0.003514065    2.933773e-37   0              0.010542195    0.00021718159  0              1165.2135      2.6109412e-16  0              2.9953651    
    900000   142.2          200            200            0.0036236345   7.137866e-37   0              0.010870904    0.00038097288  0              2043.9796      2.6109412e-16  0              2.9952691    
   1000000   142.2          200            200            0.0036639253  -1.302903e-37   0              0.010991776    0.00014820833  0              795.16111      2.6109412e-16  0              2.9952341    
   1100000   142.2          200            200            0.0036784035   1.7425875e-37  0              0.01103521     3.8736665e-05  0              207.82832      2.6109412e-16  0              2.9952216    
   1200000   142.2          200            200            0.0036834925  -4.1391983e-38  0              0.011050477    8.3300953e-06  0              44.692277      2.6109412e-16  0              2.9952172    
   1300000   142.2          200            200            0.0036852398  -1.1727146e-38  0              0.011055719    1.588284e-06   0              8.5213943      2.6109412e-16  0              2.9952157    
   1400000   142.2          200            200            0.0036858239  -1.19586e-38    0              0.011057472    2.7828037e-07  0              1.4930181      2.6109412e-16  0              2.9952152    
   1500000   142.2          200            200            0.003686013    1.2298997e-38  0              0.011058039    4.5690228e-08  0              0.24513529     2.6109412e-16  0              2.9952151    
   1600000   142.2          200            200            0.0036860717   4.0239353e-39  0              0.011058215    7.1118429e-09  0              0.03815616     2.6109412e-16  0              2.995215     
   1700000   142.2          200            200            0.0036860889   1.7577033e-38  0              0.011058267    1.0568775e-09  0              0.0056703145   2.6109412e-16  0              2.995215     
   1800000   142.2          200            200            0.0036860935  -9.145933e-39   0              0.01105828     1.5057949e-10  0              0.00080788272  2.6109412e-16  0              2.995215     
   1900000   142.2          200            200            0.0036860945   5.7671129e-39  0              0.011058283    2.0613407e-11  0              0.00011059418  2.6109412e-16  0              2.995215     
   2000000   142.2          200            200            0.0036860946   8.1349758e-39  0              0.011058284    2.7123747e-12  0              1.4552319e-05  2.6109412e-16  0              2.995215     
   2100000   142.2          200            200            0.0036860945  -4.1697297e-39  0              0.011058284    3.4272572e-13  0              1.8387776e-06  2.6109412e-16  0              2.995215     
   2200000   142.2          200            200            0.0036860945   1.006097e-38   0              0.011058283    4.1447253e-14  0              2.2237106e-07  2.6109412e-16  0              2.995215     
   2300000   142.2          200            200            0.0036860945  -5.4762723e-39  0              0.011058283    4.7706665e-15  0              2.5595379e-08  2.6109412e-16  0              2.995215     
   2400000   142.2          200            200            0.0036860944   1.2104286e-38  0              0.011058283    5.1924045e-16  0              2.785807e-09   2.6109412e-16  0              2.995215     
   2500000   142.2          200            200            0.0036860944  -1.7331705e-38  0              0.011058283    5.1220474e-17  0              2.7480593e-10  2.6109412e-16  0              2.995215     
   2600000   142.2          200            200            0.0036860944   1.6781937e-38  0              0.011058283    4.172956e-18   0              2.2388568e-11  2.6109412e-16  0              2.995215     
   2700000   142.2          200            200            0.0036860944  -1.5523293e-38  0              0.011058283    3.8683558e-19  0              2.075434e-12   2.6109412e-16  0              2.995215     
   2800000   142.2          200            200            0.0036860944   4.9941637e-39  0              0.011058283    2.3379255e-21  0              1.2543339e-14  2.6109412e-16  0              2.995215     
   2900000   142.2          200            200            0.0036860944   2.4219136e-38  0              0.011058283    7.6436332e-20  0              4.1009299e-13  2.6109412e-16  0              2.995215     
   3000000   142.2          200            200            0.0036860944  -5.4580127e-39  0              0.011058283    3.0394947e-20  0              1.6307369e-13  2.6109412e-16  0              2.995215     
Loop time of 62.9512 on 4 procs for 3000000 steps with 50 atoms

Performance: 41174743.424 ns/day, 0.000 hours/ns, 47655.953 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 0.32977    | 1.5188     | 4.9817     | 162.3 |  2.41
Neigh   | 0.073164   | 0.073711   | 0.075173   |   0.3 |  0.12
Comm    | 25.187     | 31.428     | 37.035     |  81.6 | 49.93
Output  | 0.061902   | 0.061981   | 0.062038   |   0.0 |  0.10
Modify  | 15.074     | 20.731     | 27.683     | 117.4 | 32.93
Other   |            | 9.137      |            |       | 14.51

Nlocal:           12.5 ave          50 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1
Nghost:           37.5 ave          50 max           0 min
Histogram: 1 0 0 0 0 0 0 0 0 3
Neighs:           6.75 ave          27 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1

Total # of neighbors = 27
Ave neighs/atom = 0.54
Neighbor list builds = 166
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 24

#variable lat0 equal 1                    #
variable lat1 equal 3+(151*0.01)+(v_ind*0.01)  # .491+(v_ind*0.001)       # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 10*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.75                                                               
Lattice spacing in x,y,z = 4.75 4.75 4.75

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -71.25 ${n1e1} -100 100 -100 100 units box
region box block -71.25 71.25 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -71.25 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -71.25 71.25 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-71.25 -100 -100) to (71.25 100 100)
  1 by 2 by 2 MPI processor grid
create_atoms 1 region substrate
Created 30 atoms
  using lattice units in orthogonal box = (-71.25 -100 -100) to (71.25 100 100)
  create_atoms CPU = 0.000 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 30 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 21 atoms
  using lattice units in orthogonal box = (-71.25 -100 -100) to (71.25 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  30 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  30 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  21 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  21 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
30 atoms in group substrate
group slider1 region slider1
21 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 21 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_24_*.dump id type diameter mass xu yu zu fx fy fz

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 92 130 130
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 14.52 | 17.99 | 19.14 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   142.5          200            200            0              0              0              0              0              0              0              2.6109412e-16  0              6            
    100000   142.5          200            200            0.0029782053   2.1625477e-38  0              0.0089346158   12179.121      0              5.8808618e+10  2.6109412e-16  0              3.3306681    
    200000   142.5          200            200            0.001025041    2.5965895e-38  0              0.0030751229   2835.7681      0              1.3692909e+10  2.6109412e-16  0              3.0804673    
    300000   142.5          200            200            2.164099e-05  -5.503698e-37   0              6.4922969e-05  2.7622911      0              13338115       2.6109412e-16  0              3.0448866    
    400000   142.5          200            200           -3.1897488e-05 -5.0631732e-37  0             -9.5692464e-05  6.5787155      0              31766263       2.6109412e-16  0              3.0060444    
    500000   142.5          200            200            0.0071300231   1.7103317e-36  0              0.021390069    4.3806353      0              21152520       2.6109412e-16  0              2.9925756    
    600000   142.5          200            200            0.0040423941   4.9910273e-36  0              0.012127182    3.7219102      0              17971772       2.6109412e-16  0              2.9949249    
    700000   142.5          200            200            0.003712153   -1.792606e-36   0              0.011136459    0.54267787     0              2620397.2      2.6109412e-16  0              2.9951938    
    800000   142.5          200            200            0.0036658857  -1.0576054e-36  0              0.010997657    0.073227675    0              353590.23      2.6109412e-16  0              2.9952288    
    900000   142.5          200            200            0.0036650525  -3.6084708e-37  0              0.010995158    0.0094971388   0              45858.284      2.6109412e-16  0              2.9952276    
   1000000   142.5          200            200            0.0036703272   4.232726e-39   0              0.011010981    0.0011821844   0              5708.3453      2.6109412e-16  0              2.9952223    
   1100000   142.5          200            200            0.0036742932   3.2547748e-38  0              0.01102288     0.0001406562   0              679.17845      2.6109412e-16  0              2.9952187    
   1200000   142.5          200            200            0.0036764731  -4.629156e-39   0              0.011029419    1.5894502e-05  0              76.748862      2.6109412e-16  0              2.9952167    
   1300000   142.5          200            200            0.0036775252  -1.3790287e-38  0              0.011032575    1.6884003e-06  0              8.1526806      2.6109412e-16  0              2.9952157    
   1400000   142.5          200            200            0.0036779967   3.0027051e-39  0              0.01103399     1.6571376e-07  0              0.80017242     2.6109412e-16  0              2.9952153    
   1500000   142.5          200            200            0.0036781978  -4.5570914e-39  0              0.011034593    1.4572587e-08  0              0.070365807    2.6109412e-16  0              2.9952151    
   1600000   142.5          200            200            0.0036782805   4.4602912e-39  0              0.011034842    1.0794009e-09  0              0.0052120406   2.6109412e-16  0              2.9952151    
   1700000   142.5          200            200            0.0036783136   7.1945449e-39  0              0.011034941    5.7733878e-11  0              0.00027877624  2.6109412e-16  0              2.995215     
   1800000   142.5          200            200            0.0036783264   9.1071338e-39  0              0.011034979    1.1866536e-12  0              5.7299256e-06  2.6109412e-16  0              2.995215     
   1900000   142.5          200            200            0.0036783313  -1.2548175e-38  0              0.011034994    5.5042921e-14  0              2.6578257e-07  2.6109412e-16  0              2.995215     
   2000000   142.5          200            200            0.0036783332   1.7254147e-39  0              0.011035       1.0130927e-13  0              4.8918618e-07  2.6109412e-16  0              2.995215     
   2100000   142.5          200            200            0.0036783339  -7.5329964e-39  0              0.011035002    4.0058971e-14  0              1.9343043e-07  2.6109412e-16  0              2.995215     
   2200000   142.5          200            200            0.0036783341   5.1091748e-39  0              0.011035002    1.0551194e-14  0              5.0947939e-08  2.6109412e-16  0              2.995215     
   2300000   142.5          200            200            0.0036783342  -6.8221914e-39  0              0.011035003    2.2807866e-15  0              1.1013102e-08  2.6109412e-16  0              2.995215     
   2400000   142.5          200            200            0.0036783342  -7.624671e-39   0              0.011035003    4.4023698e-16  0              2.1257468e-09  2.6109412e-16  0              2.995215     
   2500000   142.5          200            200            0.0036783342   1.6436434e-39  0              0.011035003    7.6734986e-17  0              3.7052578e-10  2.6109412e-16  0              2.995215     
   2600000   142.5          200            200            0.0036783342   3.7082678e-39  0              0.011035003    1.2750414e-17  0              6.1567184e-11  2.6109412e-16  0              2.995215     
   2700000   142.5          200            200            0.0036783342   2.1441677e-40  0              0.011035003    1.9114233e-18  0              9.2295791e-12  2.6109412e-16  0              2.995215     
   2800000   142.5          200            200            0.0036783342   2.3634778e-38  0              0.011035003    3.0236876e-19  0              1.4600305e-12  2.6109412e-16  0              2.995215     
   2900000   142.5          200            200            0.0036783342  -1.0879212e-38  0              0.011035003    2.4421732e-20  0              1.1792381e-13  2.6109412e-16  0              2.995215     
   3000000   142.5          200            200            0.0036783342  -8.1464944e-39  0              0.011035003    3.3604991e-20  0              1.6226648e-13  2.6109412e-16  0              2.995215     
Loop time of 63.998 on 4 procs for 3000000 steps with 51 atoms

Performance: 40501266.104 ns/day, 0.000 hours/ns, 46876.465 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 0.31957    | 1.544      | 5.0475     | 162.9 |  2.41
Neigh   | 0.073123   | 0.073671   | 0.075133   |   0.3 |  0.12
Comm    | 25.652     | 32.21      | 37.932     |  83.9 | 50.33
Output  | 0.06044    | 0.060515   | 0.060565   |   0.0 |  0.09
Modify  | 15.256     | 21.007     | 28.211     | 120.6 | 32.82
Other   |            | 9.103      |            |       | 14.22

Nlocal:          12.75 ave          51 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1
Nghost:          39.25 ave          52 max           1 min
Histogram: 1 0 0 0 0 0 0 0 0 3
Neighs:           6.75 ave          27 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1

Total # of neighbors = 27
Ave neighs/atom = 0.52941176
Neighbor list builds = 166
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 25

#variable lat0 equal 1                    #
variable lat1 equal 3+(151*0.01)+(v_ind*0.01)  # .491+(v_ind*0.001)       # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 10*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.76                                                               
Lattice spacing in x,y,z = 4.76 4.76 4.76

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -71.4 ${n1e1} -100 100 -100 100 units box
region box block -71.4 71.4 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -71.4 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -71.4 71.4 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-71.4 -100 -100) to (71.4 100 100)
  1 by 2 by 2 MPI processor grid
create_atoms 1 region substrate
Created 30 atoms
  using lattice units in orthogonal box = (-71.4 -100 -100) to (71.4 100 100)
  create_atoms CPU = 0.000 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 30 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 21 atoms
  using lattice units in orthogonal box = (-71.4 -100 -100) to (71.4 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  30 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  30 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  21 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  21 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
30 atoms in group substrate
group slider1 region slider1
21 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 21 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_25_*.dump id type diameter mass xu yu zu fx fy fz

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 93 130 130
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 14.54 | 18.01 | 19.16 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   142.8          200            200            0              0              0              0              0              0              0              2.6109412e-16  0              6            
    100000   142.8          200            200            0.0029745061   8.4293231e-42  0              0.0089235184   12191.04       0              5.8866171e+10  2.6109412e-16  0              3.3315439    
    200000   142.8          200            200            0.0010310674  -5.3945298e-39  0              0.0030932022   2870.145       0              1.3858903e+10  2.6109412e-16  0              3.080405     
    300000   142.8          200            200            5.2974493e-05  2.7635117e-37  0              0.00015892348  15.878073      0              76669534       2.6109412e-16  0              3.0457218    
    400000   142.8          200            200            0.00015326476  4.1901276e-37  0              0.00045979429  120.93125      0              5.8393374e+08  2.6109412e-16  0              3.0012217    
    500000   142.8          200            200            0.0066665363  -0.00020459976  0              0.020204209    11.18624       0              54014351       2.6109412e-16  0              2.9929644    
    600000   142.8          200            200            0.0042078424  -1.9928399e-38  0              0.012623527    3.3290882      0              16074976       2.6109412e-16  0              2.9947778    
    700000   142.8          200            200            0.0037704182  -5.801427e-37   0              0.011311255    0.51886718     0              2505423.9      2.6109412e-16  0              2.9951365    
    800000   142.8          200            200            0.0036826911   1.052316e-38   0              0.011048073    0.072992298    0              352453.69      2.6109412e-16  0              2.9952075    
    900000   142.8          200            200            0.0036663028   6.9720052e-38  0              0.010998908    0.0098531766   0              47577.464      2.6109412e-16  0              2.9952198    
   1000000   142.8          200            200            0.0036658237  -3.8007177e-38  0              0.010997471    0.0012790376   0              6176.015       2.6109412e-16  0              2.9952196    
   1100000   142.8          200            200            0.0036676995   5.886717e-39   0              0.011003099    0.00015931458  0              769.27311      2.6109412e-16  0              2.9952177    
   1200000   142.8          200            200            0.0036691352   1.504706e-38   0              0.011007406    1.8969035e-05  0              91.59468       2.6109412e-16  0              2.9952163    
   1300000   142.8          200            200            0.003669928    4.3147507e-39  0              0.011009784    2.1455375e-06  0              10.360033      2.6109412e-16  0              2.9952156    
   1400000   142.8          200            200            0.0036703113  -5.6555192e-39  0              0.011010934    2.2818539e-07  0              1.1018256      2.6109412e-16  0              2.9952153    
   1500000   142.8          200            200            0.0036704834  -1.0331082e-39  0              0.01101145     2.2432581e-08  0              0.10831891     2.6109412e-16  0              2.9952151    
   1600000   142.8          200            200            0.0036705568   1.4690982e-39  0              0.01101167     1.9774076e-09  0              0.0095481937   2.6109412e-16  0              2.9952151    
   1700000   142.8          200            200            0.003670587    1.8523795e-39  0              0.011011761    1.4705583e-10  0              0.00071007996  2.6109412e-16  0              2.995215     
   1800000   142.8          200            200            0.0036705991   3.8821744e-39  0              0.011011797    7.9332601e-12  0              3.8306874e-05  2.6109412e-16  0              2.995215     
   1900000   142.8          200            200            0.0036706038   2.169582e-39   0              0.011011811    1.6888834e-13  0              8.1550137e-07  2.6109412e-16  0              2.995215     
   2000000   142.8          200            200            0.0036706056  -4.9887588e-41  0              0.011011817    6.6937242e-15  0              3.2321599e-08  2.6109412e-16  0              2.995215     
   2100000   142.8          200            200            0.0036706063   1.0034467e-39  0              0.011011819    1.3284129e-14  0              6.4144304e-08  2.6109412e-16  0              2.995215     
   2200000   142.8          200            200            0.0036706065  -5.4580068e-39  0              0.011011819    5.3101786e-15  0              2.5640952e-08  2.6109412e-16  0              2.995215     
   2300000   142.8          200            200            0.0036706066  -3.2470164e-39  0              0.01101182     1.4021896e-15  0              6.7706716e-09  2.6109412e-16  0              2.995215     
   2400000   142.8          200            200            0.0036706066   1.1656093e-39  0              0.01101182     3.0579688e-16  0              1.4765837e-09  2.6109412e-16  0              2.995215     
   2500000   142.8          200            200            0.0036706066  -1.9274564e-39  0              0.01101182     5.9369118e-17  0              2.8667222e-10  2.6109412e-16  0              2.995215     
   2600000   142.8          200            200            0.0036706066   9.6414512e-40  0              0.01101182     1.0500509e-17  0              5.0703201e-11  2.6109412e-16  0              2.995215     
   2700000   142.8          200            200            0.0036706066   1.2125176e-39  0              0.01101182     1.5783397e-18  0              7.6212375e-12  2.6109412e-16  0              2.995215     
   2800000   142.8          200            200            0.0036706066   4.7558952e-39  0              0.01101182     2.7914837e-19  0              1.3479076e-12  2.6109412e-16  0              2.995215     
   2900000   142.8          200            200            0.0036706066  -1.3488607e-39  0              0.01101182     4.3944063e-21  0              2.1219015e-14  2.6109412e-16  0              2.995215     
   3000000   142.8          200            200            0.0036706066   1.660986e-40   0              0.01101182     1.302091e-19   0              6.2873313e-13  2.6109412e-16  0              2.995215     
Loop time of 63.8653 on 4 procs for 3000000 steps with 51 atoms

Performance: 40585448.380 ns/day, 0.000 hours/ns, 46973.899 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 0.31951    | 1.5092     | 4.9324     | 160.9 |  2.36
Neigh   | 0.073027   | 0.073577   | 0.075056   |   0.3 |  0.12
Comm    | 25.636     | 32.144     | 37.856     |  83.7 | 50.33
Output  | 0.059939   | 0.060023   | 0.060079   |   0.0 |  0.09
Modify  | 15.175     | 20.937     | 28.075     | 120.2 | 32.78
Other   |            | 9.142      |            |       | 14.31

Nlocal:          12.75 ave          51 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1
Nghost:          39.25 ave          52 max           1 min
Histogram: 1 0 0 0 0 0 0 0 0 3
Neighs:           6.75 ave          27 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1

Total # of neighbors = 27
Ave neighs/atom = 0.52941176
Neighbor list builds = 164
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 26

#variable lat0 equal 1                    #
variable lat1 equal 3+(151*0.01)+(v_ind*0.01)  # .491+(v_ind*0.001)       # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 10*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.77                                                               
Lattice spacing in x,y,z = 4.77 4.77 4.77

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -71.55 ${n1e1} -100 100 -100 100 units box
region box block -71.55 71.55 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -71.55 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -71.55 71.55 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-71.55 -100 -100) to (71.55 100 100)
  1 by 2 by 2 MPI processor grid
create_atoms 1 region substrate
Created 30 atoms
  using lattice units in orthogonal box = (-71.55 -100 -100) to (71.55 100 100)
  create_atoms CPU = 0.000 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 30 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 21 atoms
  using lattice units in orthogonal box = (-71.55 -100 -100) to (71.55 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  30 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  30 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  21 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  21 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
30 atoms in group substrate
group slider1 region slider1
21 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 21 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_26_*.dump id type diameter mass xu yu zu fx fy fz

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 93 130 130
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 14.54 | 18.01 | 19.16 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   143.1          200            200            0              0              0              0              0              0              0              2.6109412e-16  0              6            
    100000   143.1          200            200            0.0029710822   4.2058233e-42  0              0.0089132465   12205.459      0              5.8935795e+10  2.6109412e-16  0              3.3320108    
    200000   143.1          200            200            0.001033746    2.6918072e-40  0              0.003101238    2889.9864      0              1.395471e+10   2.6109412e-16  0              3.080989     
    300000   143.1          200            200            6.7013523e-05  3.4459776e-38  0              0.00020104057  25.034788      0              1.2088403e+08  2.6109412e-16  0              3.0467744    
    400000   143.1          200            200            0.0084337533  -0.0032227333   0              0.028523993    188.08221      0              9.0818168e+08  2.6109412e-16  0              2.9933901    
    500000   143.1          200            200            0.00053302894 -1.425994e-35   0              0.0015990868   2.8590624      0              13805389       2.6109412e-16  0              2.9986425    
    600000   143.1          200            200            0.0038203007  -0.00050404787  0              0.01196495     4.9259128      0              23785470       2.6109412e-16  0              2.9954182    
    700000   143.1          200            200            0.0030418436  -0.00024951447  0              0.0093750454   0.22884677     0              1105019.1      2.6109412e-16  0              2.9958518    
    800000   143.1          200            200            0.0034289885  -0.00046003695  0              0.010747002    0.080246566    0              387481.95      2.6109412e-16  0              2.9956041    
    900000   143.1          200            200            0.0035181701  -0.00045619933  0              0.01101071     0.01200985     0              57991.266      2.6109412e-16  0              2.9955604    
   1000000   143.1          200            200            0.0035258567  -0.00045678894  0              0.011034359    0.0013094621   0              6322.9238      2.6109412e-16  0              2.9955568    
   1100000   143.1          200            200            0.003520359   -0.00045627684  0              0.011017354    9.9126009e-05  0              478.64402      2.6109412e-16  0              2.9955599    
   1200000   143.1          200            200            0.003515626   -0.00045584884  0              0.011002727    3.7172183e-06  0              17.949117      2.6109412e-16  0              2.9955624    
   1300000   143.1          200            200            0.0035131337  -0.00045562469  0              0.010995026    6.5319759e-10  0              0.0031540574   2.6109412e-16  0              2.9955637    
   1400000   143.1          200            200            0.0035120668  -0.00045552913  0              0.010991729    7.7473925e-08  0              0.37409386     2.6109412e-16  0              2.9955643    
   1500000   143.1          200            200            0.0035116729  -0.00045549402  0              0.010990513    3.5071207e-08  0              0.16934631     2.6109412e-16  0              2.9955645    
   1600000   143.1          200            200            0.0035115473  -0.0004554829   0              0.010990125    8.2203595e-09  0              0.039693174    2.6109412e-16  0              2.9955645    
   1700000   143.1          200            200            0.0035115145  -0.00045548003  0              0.010990024    1.3533943e-09  0              0.0065350569   2.6109412e-16  0              2.9955646    
   1800000   143.1          200            200            0.0035115091  -0.00045547957  0              0.010990007    1.6746642e-10  0              0.00080863538  2.6109412e-16  0              2.9955646    
   1900000   143.1          200            200            0.0035115098  -0.00045547965  0              0.010990009    1.5129387e-11  0              7.3054395e-05  2.6109412e-16  0              2.9955646    
   2000000   143.1          200            200            0.003511511   -0.00045547976  0              0.010990013    8.3590177e-13  0              4.0362705e-06  2.6109412e-16  0              2.9955646    
   2100000   143.1          200            200            0.0035115117  -0.00045547983  0              0.010990015    1.0047833e-14  0              4.8517389e-08  2.6109412e-16  0              2.9955646    
   2200000   143.1          200            200            0.0035115121  -0.00045547986  0              0.010990016    3.0309771e-15  0              1.4635504e-08  2.6109412e-16  0              2.9955646    
   2300000   143.1          200            200            0.0035115122  -0.00045547987  0              0.010990017    2.6442829e-15  0              1.2768296e-08  2.6109412e-16  0              2.9955646    
   2400000   143.1          200            200            0.0035115123  -0.00045547987  0              0.010990017    7.7199554e-16  0              3.7276902e-09  2.6109412e-16  0              2.9955646    
   2500000   143.1          200            200            0.0035115123  -0.00045547987  0              0.010990017    1.4506343e-16  0              7.0045938e-10  2.6109412e-16  0              2.9955646    
   2600000   143.1          200            200            0.0035115123  -0.00045547987  0              0.010990017    2.0469922e-17  0              9.884193e-11   2.6109412e-16  0              2.9955646    
   2700000   143.1          200            200            0.0035115123  -0.00045547987  0              0.010990017    1.4576899e-18  0              7.0386628e-12  2.6109412e-16  0              2.9955646    
   2800000   143.1          200            200            0.0035115123  -0.00045547987  0              0.010990017    2.5431531e-21  0              1.2279976e-14  2.6109412e-16  0              2.9955646    
   2900000   143.1          200            200            0.0035115123  -0.00045547987  0              0.010990017    1.4225278e-19  0              6.8688778e-13  2.6109412e-16  0              2.9955646    
   3000000   143.1          200            200            0.0035115123  -0.00045547987  0              0.010990017    6.0468181e-20  0              2.9197921e-13  2.6109412e-16  0              2.9955646    
Loop time of 64.2302 on 4 procs for 3000000 steps with 51 atoms

Performance: 40354867.560 ns/day, 0.000 hours/ns, 46707.023 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 0.33725    | 1.6292     | 5.396      | 170.4 |  2.54
Neigh   | 0.073011   | 0.073594   | 0.075116   |   0.3 |  0.11
Comm    | 25.832     | 32.216     | 38.021     |  82.8 | 50.16
Output  | 0.060195   | 0.060274   | 0.060332   |   0.0 |  0.09
Modify  | 15.339     | 21.099     | 28.236     | 120.1 | 32.85
Other   |            | 9.152      |            |       | 14.25

Nlocal:          12.75 ave          51 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1
Nghost:          39.25 ave          52 max           1 min
Histogram: 1 0 0 0 0 0 0 0 0 3
Neighs:           6.75 ave          27 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1

Total # of neighbors = 27
Ave neighs/atom = 0.52941176
Neighbor list builds = 164
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 27

#variable lat0 equal 1                    #
variable lat1 equal 3+(151*0.01)+(v_ind*0.01)  # .491+(v_ind*0.001)       # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 10*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.78                                                               
Lattice spacing in x,y,z = 4.78 4.78 4.78

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -71.7 ${n1e1} -100 100 -100 100 units box
region box block -71.7 71.7 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -71.7 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -71.7 71.7 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-71.7 -100 -100) to (71.7 100 100)
  1 by 2 by 2 MPI processor grid
create_atoms 1 region substrate
Created 30 atoms
  using lattice units in orthogonal box = (-71.7 -100 -100) to (71.7 100 100)
  create_atoms CPU = 0.000 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 30 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 21 atoms
  using lattice units in orthogonal box = (-71.7 -100 -100) to (71.7 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  30 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  30 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  21 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  21 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
30 atoms in group substrate
group slider1 region slider1
21 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 21 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_27_*.dump id type diameter mass xu yu zu fx fy fz

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 93 130 130
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 14.54 | 18.01 | 19.16 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   143.4          200            200            0              0              0              0              0              0              0              2.6109412e-16  0              6            
    100000   143.4          200            200            0.0029672112  -5.2462788e-43  0              0.0089016335   12217.768      0              5.899523e+10   2.6109412e-16  0              3.3323004    
    200000   143.4          200            200            0.0010338742   5.0364285e-41  0              0.0031016226   2898.8402      0              1.3997462e+10  2.6109412e-16  0              3.0818594    
    300000   143.4          200            200            7.041654e-05  -5.3721207e-40  0              0.00021124962  27.614251      0              1.3333934e+08  2.6109412e-16  0              3.047917     
    400000   143.4          200            200            0.01649921    -0.0060138222   0              0.055511451    56.452815      0              2.7259044e+08  2.6109412e-16  0              2.9921465    
    500000   143.4          200            200            0.003468151   -0.0018955942   0              0.012300047    39.668586      0              1.9154541e+08  2.6109412e-16  0              2.9964353    
    600000   143.4          200            200            0.005254922   -0.0016009238   0              0.01736569     0.52884853     0              2553620.3      2.6109412e-16  0              2.995808     
    700000   143.4          200            200            0.0029349055  -0.0010926875   0              0.0098974039   0.57756447     0              2788852.1      2.6109412e-16  0              2.9968157    
    800000   143.4          200            200            0.0030836079  -0.0011068329   0              0.010357656    0.048976239    0              236488.73      2.6109412e-16  0              2.9967418    
    900000   143.4          200            200            0.0033704447  -0.0011283583   0              0.011239692    0.0036726847   0              17734.08       2.6109412e-16  0              2.9966149    
   1000000   143.4          200            200            0.0032943979  -0.0011229003   0              0.011006094    0.0016849883   0              8136.2055      2.6109412e-16  0              2.996649     
   1100000   143.4          200            200            0.0032691526  -0.0011210979   0              0.010928556    9.4692812e-07  0              4.572377       2.6109412e-16  0              2.9966599    
   1200000   143.4          200            200            0.0032838357  -0.0011221787   0              0.010973686    3.275522e-05   0              158.16324      2.6109412e-16  0              2.9966534    
   1300000   143.4          200            200            0.0032846861  -0.0011222342   0              0.010976293    7.5752594e-07  0              3.6578216      2.6109412e-16  0              2.996653     
   1400000   143.4          200            200            0.0032825492  -0.0011220788   0              0.010969726    3.8693371e-07  0              1.8683644      2.6109412e-16  0              2.996654     
   1500000   143.4          200            200            0.0032828084  -0.0011220985   0              0.010970524    5.138017e-08   0              0.24809645     2.6109412e-16  0              2.9966538    
   1600000   143.4          200            200            0.0032830521  -0.0011221161   0              0.010971272    1.9791931e-09  0              0.0095568153   2.6109412e-16  0              2.9966537    
   1700000   143.4          200            200            0.0032829744  -0.0011221104   0              0.010971034    1.4792894e-09  0              0.007142959    2.6109412e-16  0              2.9966538    
   1800000   143.4          200            200            0.003282955   -0.001122109    0              0.010970974    5.0950055e-13  0              2.4601958e-06  2.6109412e-16  0              2.9966538    
   1900000   143.4          200            200            0.0032829689  -0.00112211     0              0.010971017    2.5801579e-11  0              0.00012458659  2.6109412e-16  0              2.9966538    
   2000000   143.4          200            200            0.0032829691  -0.00112211     0              0.010971017    9.7189658e-13  0              4.6929408e-06  2.6109412e-16  0              2.9966538    
   2100000   143.4          200            200            0.0032829672  -0.0011221099   0              0.010971011    2.6496131e-13  0              1.2794033e-06  2.6109412e-16  0              2.9966538    
   2200000   143.4          200            200            0.0032829675  -0.0011221099   0              0.010971012    4.997673e-14   0              2.4131974e-07  2.6109412e-16  0              2.9966538    
   2300000   143.4          200            200            0.0032829677  -0.0011221099   0              0.010971013    9.3434206e-16  0              4.5116034e-09  2.6109412e-16  0              2.9966538    
   2400000   143.4          200            200            0.0032829676  -0.0011221099   0              0.010971013    1.2667493e-15  0              6.1166789e-09  2.6109412e-16  0              2.9966538    
   2500000   143.4          200            200            0.0032829676  -0.0011221099   0              0.010971013    4.4266497e-18  0              2.1374707e-11  2.6109412e-16  0              2.9966538    
   2600000   143.4          200            200            0.0032829676  -0.0011221099   0              0.010971013    1.9418742e-17  0              9.3766153e-11  2.6109412e-16  0              2.9966538    
   2700000   143.4          200            200            0.0032829676  -0.0011221099   0              0.010971013    2.0282626e-18  0              9.7937543e-12  2.6109412e-16  0              2.9966538    
   2800000   143.4          200            200            0.0032829676  -0.0011221099   0              0.010971013    1.1923458e-19  0              5.7574113e-13  2.6109412e-16  0              2.9966538    
   2900000   143.4          200            200            0.0032829676  -0.0011221099   0              0.010971013    6.9645434e-21  0              3.3629288e-14  2.6109412e-16  0              2.9966538    
   3000000   143.4          200            200            0.0032829676  -0.0011221099   0              0.010971013    1.405018e-19   0              6.7843291e-13  2.6109412e-16  0              2.9966538    
Loop time of 63.8991 on 4 procs for 3000000 steps with 51 atoms

Performance: 40563949.448 ns/day, 0.000 hours/ns, 46949.016 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 0.32746    | 1.5989     | 5.2667     | 167.5 |  2.50
Neigh   | 0.073886   | 0.074465   | 0.075976   |   0.3 |  0.12
Comm    | 25.631     | 32.006     | 37.824     |  82.6 | 50.09
Output  | 0.061056   | 0.061135   | 0.06119    |   0.0 |  0.10
Modify  | 15.221     | 20.964     | 28.029     | 119.1 | 32.81
Other   |            | 9.196      |            |       | 14.39

Nlocal:          12.75 ave          51 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1
Nghost:          39.25 ave          52 max           1 min
Histogram: 1 0 0 0 0 0 0 0 0 3
Neighs:           6.75 ave          27 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1

Total # of neighbors = 27
Ave neighs/atom = 0.52941176
Neighbor list builds = 166
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 28

#variable lat0 equal 1                    #
variable lat1 equal 3+(151*0.01)+(v_ind*0.01)  # .491+(v_ind*0.001)       # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 10*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.79                                                               
Lattice spacing in x,y,z = 4.79 4.79 4.79

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -71.85 ${n1e1} -100 100 -100 100 units box
region box block -71.85 71.85 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -71.85 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -71.85 71.85 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-71.85 -100 -100) to (71.85 100 100)
  1 by 2 by 2 MPI processor grid
create_atoms 1 region substrate
Created 30 atoms
  using lattice units in orthogonal box = (-71.85 -100 -100) to (71.85 100 100)
  create_atoms CPU = 0.000 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 30 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 21 atoms
  using lattice units in orthogonal box = (-71.85 -100 -100) to (71.85 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  30 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  30 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  21 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  21 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
30 atoms in group substrate
group slider1 region slider1
21 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 21 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_28_*.dump id type diameter mass xu yu zu fx fy fz

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 93 130 130
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 14.54 | 18.01 | 19.16 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   143.7          200            200            0              0              0              0              0              0              0              2.6109412e-16  0              6            
    100000   143.7          200            200            0.0029623724  -7.668935e-46   0              0.0088871173   12224.553      0              5.9027993e+10  2.6109412e-16  0              3.332603     
    200000   143.7          200            200            0.0010320147  -1.5705979e-42  0              0.0030960442   2899.2534      0              1.3999457e+10  2.6109412e-16  0              3.0827519    
    300000   143.7          200            200            6.8668168e-05  2.931783e-41   0              0.0002060045   26.409274      0              1.2752093e+08  2.6109412e-16  0              3.0488286    
    400000   143.7          200            200            0.018067084   -0.0019349248   0              0.056136177    55.665154      0              2.6878711e+08  2.6109412e-16  0              2.9929017    
    500000   143.7          200            200            0.00017185375 -4.2916798e-05  0              0.00055847803  19.304944      0              93216665       2.6109412e-16  0              2.9993745    
    600000   143.7          200            200            0.002626107   -0.00059087694  0              0.008469198    4.8622615      0              23478121       2.6109412e-16  0              2.9978019    
    700000   143.7          200            200            0.0029763061  -0.00060282471  0              0.0095317431   0.49811573     0              2405222.6      2.6109412e-16  0              2.9976335    
    800000   143.7          200            200            0.0032959683  -0.0006109825   0              0.010498887    0.077589469    0              374651.78      2.6109412e-16  0              2.9974911    
    900000   143.7          200            200            0.0034043616  -0.00061332802  0              0.010826413    0.012183206    0              58828.341      2.6109412e-16  0              2.9974438    
   1000000   143.7          200            200            0.0034360397  -0.00061398051  0              0.0109221      0.0018230656   0              8802.9313      2.6109412e-16  0              2.99743      
   1100000   143.7          200            200            0.0034442206  -0.00061414862  0              0.010946811    0.00026006746  0              1255.7727      2.6109412e-16  0              2.9974264    
   1200000   143.7          200            200            0.0034458819  -0.00061418386  0              0.01095183     3.5464006e-05  0              171.24299      2.6109412e-16  0              2.9974256    
   1300000   143.7          200            200            0.0034459846  -0.00061418686  0              0.010952141    4.6255157e-06  0              22.33496       2.6109412e-16  0              2.9974256    
   1400000   143.7          200            200            0.0034458348  -0.00061418428  0              0.010951689    5.7610939e-07  0              2.7818261      2.6109412e-16  0              2.9974256    
   1500000   143.7          200            200            0.0034457119  -0.000614182    0              0.010951318    6.8246126e-08  0              0.32953612     2.6109412e-16  0              2.9974257    
   1600000   143.7          200            200            0.0034456428  -0.00061418069  0              0.010951109    7.6337468e-09  0              0.036860631    2.6109412e-16  0              2.9974257    
   1700000   143.7          200            200            0.0034456091  -0.00061418005  0              0.010951007    7.9646049e-10  0              0.0038458227   2.6109412e-16  0              2.9974257    
   1800000   143.7          200            200            0.003445594   -0.00061417975  0              0.010950962    7.5889606e-11  0              0.00036644375  2.6109412e-16  0              2.9974257    
   1900000   143.7          200            200            0.0034455875  -0.00061417963  0              0.010950942    6.3483848e-12  0              3.0654078e-05  2.6109412e-16  0              2.9974257    
   2000000   143.7          200            200            0.0034455849  -0.00061417958  0              0.010950934    4.2838656e-13  0              2.0685254e-06  2.6109412e-16  0              2.9974257    
   2100000   143.7          200            200            0.0034455838  -0.00061417956  0              0.010950931    1.8298156e-14  0              8.8355246e-08  2.6109412e-16  0              2.9974257    
   2200000   143.7          200            200            0.0034455834  -0.00061417955  0              0.01095093     9.6041505e-17  0              4.6375005e-10  2.6109412e-16  0              2.9974257    
   2300000   143.7          200            200            0.0034455833  -0.00061417955  0              0.010950929    1.2389829e-16  0              5.9826048e-10  2.6109412e-16  0              2.9974257    
   2400000   143.7          200            200            0.0034455832  -0.00061417954  0              0.010950929    8.8029154e-17  0              4.2506128e-10  2.6109412e-16  0              2.9974257    
   2500000   143.7          200            200            0.0034455832  -0.00061417954  0              0.010950929    2.9534145e-17  0              1.4260981e-10  2.6109412e-16  0              2.9974257    
   2600000   143.7          200            200            0.0034455832  -0.00061417954  0              0.010950929    6.5159725e-18  0              3.1463299e-11  2.6109412e-16  0              2.9974257    
   2700000   143.7          200            200            0.0034455832  -0.00061417954  0              0.010950929    6.5385134e-19  0              3.1572141e-12  2.6109412e-16  0              2.9974257    
   2800000   143.7          200            200            0.0034455832  -0.00061417954  0              0.010950929    2.8342464e-19  0              1.3685562e-12  2.6109412e-16  0              2.9974257    
   2900000   143.7          200            200            0.0034455832  -0.00061417954  0              0.010950929    5.7545026e-20  0              2.7786434e-13  2.6109412e-16  0              2.9974257    
   3000000   143.7          200            200            0.0034455832  -0.00061417954  0              0.010950929    2.1278829e-21  0              1.0274785e-14  2.6109412e-16  0              2.9974257    
Loop time of 64.18 on 4 procs for 3000000 steps with 51 atoms

Performance: 40386435.563 ns/day, 0.000 hours/ns, 46743.560 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 0.32901    | 1.6313     | 5.4182     | 171.2 |  2.54
Neigh   | 0.073879   | 0.074455   | 0.075962   |   0.3 |  0.12
Comm    | 25.835     | 32.194     | 38.005     |  82.5 | 50.16
Output  | 0.06025    | 0.060327   | 0.060378   |   0.0 |  0.09
Modify  | 15.345     | 21.092     | 28.238     | 120.4 | 32.86
Other   |            | 9.129      |            |       | 14.22

Nlocal:          12.75 ave          51 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1
Nghost:          39.25 ave          52 max           1 min
Histogram: 1 0 0 0 0 0 0 0 0 3
Neighs:           6.75 ave          27 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1

Total # of neighbors = 27
Ave neighs/atom = 0.52941176
Neighbor list builds = 166
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 29

#variable lat0 equal 1                    #
variable lat1 equal 3+(151*0.01)+(v_ind*0.01)  # .491+(v_ind*0.001)       # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 10*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.8                                                               
Lattice spacing in x,y,z = 4.8 4.8 4.8

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -72 ${n1e1} -100 100 -100 100 units box
region box block -72 72 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -72 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -72 72 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-72 -100 -100) to (72 100 100)
  1 by 2 by 2 MPI processor grid
create_atoms 1 region substrate
Created 30 atoms
  using lattice units in orthogonal box = (-72 -100 -100) to (72 100 100)
  create_atoms CPU = 0.000 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 30 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 21 atoms
  using lattice units in orthogonal box = (-72 -100 -100) to (72 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  30 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  30 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  21 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  21 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
30 atoms in group substrate
group slider1 region slider1
21 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 21 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_29_*.dump id type diameter mass xu yu zu fx fy fz

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 93 130 130
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 14.54 | 18.01 | 19.16 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   144            200            200            0              0              0              0              0              0              0              2.6109412e-16  0              6            
    100000   144            200            200            0.0029566439   1.5116721e-46  0              0.0088699317   12226.737      0              5.9038536e+10  2.6109412e-16  0              3.332717     
    200000   144            200            200            0.0010298447  -8.0246146e-40  0              0.003089534    2898.8443      0              1.3997482e+10  2.6109412e-16  0              3.0830907    
    300000   144            200            200            6.7517149e-05  6.6872814e-41  0              0.00020255145  25.665943      0              1.2393165e+08  2.6109412e-16  0              3.049162     
    400000   144            200            200            0.018145964    1.9459471e-42  0              0.054437893    67.483706      0              3.2585466e+08  2.6109412e-16  0              2.9933115    
    500000   144            200            200            0.0002153352  -8.5600977e-39  0              0.00064600561  20.524298      0              99104490       2.6109412e-16  0              2.9995944    
    600000   144            200            200            0.0031181174   1.3705073e-37  0              0.0093543522   5.4552922      0              26341653       2.6109412e-16  0              2.9979397    
    700000   144            200            200            0.0033657636  -2.1390513e-38  0              0.010097291    0.69136297     0              3338344.4      2.6109412e-16  0              2.9978225    
    800000   144            200            200            0.0036080447   6.3374778e-42  0              0.010824134    0.10528024     0              508360.6       2.6109412e-16  0              2.9977161    
    900000   144            200            200            0.0036602714  -8.5507737e-39  0              0.010980814    0.014142706    0              68290.066      2.6109412e-16  0              2.997693     
   1000000   144            200            200            0.0036600935  -4.064778e-38   0              0.010980281    0.0016157542   0              7801.8986      2.6109412e-16  0              2.9976927    
   1100000   144            200            200            0.0036527575   1.4991315e-38  0              0.010958273    0.00015213459  0              734.60347      2.6109412e-16  0              2.9976956    
   1200000   144            200            200            0.0036476019  -5.0008098e-38  0              0.010942806    1.0791713e-05  0              52.10932       2.6109412e-16  0              2.9976977    
   1300000   144            200            200            0.0036449504   2.1813568e-38  0              0.010934851    4.2856693e-07  0              2.0693963      2.6109412e-16  0              2.9976988    
   1400000   144            200            200            0.0036437729   1.5126757e-38  0              0.010931319    3.4361164e-10  0              0.0016591776   2.6109412e-16  0              2.9976993    
   1500000   144            200            200            0.0036432989  -6.0940375e-38  0              0.010929897    5.6956297e-09  0              0.027502158    2.6109412e-16  0              2.9976995    
   1600000   144            200            200            0.003643123   -4.2742271e-38  0              0.010929369    3.1232824e-09  0              0.015081213    2.6109412e-16  0              2.9976996    
   1700000   144            200            200            0.0036430627   1.711678e-39   0              0.010929188    8.5939175e-10  0              0.0041496952   2.6109412e-16  0              2.9976996    
   1800000   144            200            200            0.0036430438  -2.0256588e-38  0              0.010929132    1.7350543e-10  0              0.00083779563  2.6109412e-16  0              2.9976996    
   1900000   144            200            200            0.0036430387  -2.5830494e-38  0              0.010929116    2.8618384e-11  0              0.00013818793  2.6109412e-16  0              2.9976996    
   2000000   144            200            200            0.0036430376  -2.0418302e-39  0              0.010929113    4.0051997e-12  0              1.9339676e-05  2.6109412e-16  0              2.9976996    
   2100000   144            200            200            0.0036430375   4.0635333e-38  0              0.010929112    4.7829997e-13  0              2.3095394e-06  2.6109412e-16  0              2.9976996    
   2200000   144            200            200            0.0036430376  -5.6525622e-39  0              0.010929113    4.7660518e-14  0              2.3013559e-07  2.6109412e-16  0              2.9976996    
   2300000   144            200            200            0.0036430377  -3.5346329e-39  0              0.010929113    3.6978713e-15  0              1.7855697e-08  2.6109412e-16  0              2.9976996    
   2400000   144            200            200            0.0036430377   5.6028384e-39  0              0.010929113    1.8527847e-16  0              8.9464342e-10  2.6109412e-16  0              2.9976996    
   2500000   144            200            200            0.0036430377  -2.2269464e-38  0              0.010929113    1.5944957e-18  0              7.6992489e-12  2.6109412e-16  0              2.9976996    
   2600000   144            200            200            0.0036430377  -1.0771575e-38  0              0.010929113    6.8337925e-19  0              3.2997938e-12  2.6109412e-16  0              2.9976996    
   2700000   144            200            200            0.0036430377   8.3842812e-39  0              0.010929113    1.5802168e-19  0              7.6303012e-13  2.6109412e-16  0              2.9976996    
   2800000   144            200            200            0.0036430377   1.1043002e-38  0              0.010929113    2.7790158e-19  0              1.3418873e-12  2.6109412e-16  0              2.9976996    
   2900000   144            200            200            0.0036430377  -8.6572109e-39  0              0.010929113    1.5185225e-19  0              7.3324017e-13  2.6109412e-16  0              2.9976996    
   3000000   144            200            200            0.0036430377   1.3217475e-38  0              0.010929113    6.3833866e-20  0              3.0823089e-13  2.6109412e-16  0              2.9976996    
Loop time of 64.0584 on 4 procs for 3000000 steps with 51 atoms

Performance: 40463060.569 ns/day, 0.000 hours/ns, 46832.246 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 0.32426    | 1.6156     | 5.3417     | 169.3 |  2.52
Neigh   | 0.073824   | 0.074451   | 0.076055   |   0.3 |  0.12
Comm    | 25.807     | 32.153     | 37.913     |  82.0 | 50.19
Output  | 0.060777   | 0.060853   | 0.060905   |   0.0 |  0.09
Modify  | 15.251     | 20.981     | 28.039     | 118.7 | 32.75
Other   |            | 9.174      |            |       | 14.32

Nlocal:          12.75 ave          51 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1
Nghost:          39.25 ave          52 max           1 min
Histogram: 1 0 0 0 0 0 0 0 0 3
Neighs:           6.75 ave          27 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1

Total # of neighbors = 27
Ave neighs/atom = 0.52941176
Neighbor list builds = 166
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 30

#variable lat0 equal 1                    #
variable lat1 equal 3+(151*0.01)+(v_ind*0.01)  # .491+(v_ind*0.001)       # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 10*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.81                                                               
Lattice spacing in x,y,z = 4.81 4.81 4.81

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -72.15 ${n1e1} -100 100 -100 100 units box
region box block -72.15 72.15 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -72.15 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -72.15 72.15 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-72.15 -100 -100) to (72.15 100 100)
  1 by 2 by 2 MPI processor grid
create_atoms 1 region substrate
Created 30 atoms
  using lattice units in orthogonal box = (-72.15 -100 -100) to (72.15 100 100)
  create_atoms CPU = 0.000 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 30 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 21 atoms
  using lattice units in orthogonal box = (-72.15 -100 -100) to (72.15 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  30 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  30 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  21 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  21 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
30 atoms in group substrate
group slider1 region slider1
21 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 21 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_30_*.dump id type diameter mass xu yu zu fx fy fz

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 94 130 130
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 14.56 | 18.02 | 19.18 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   144.3          200            200            0              0              0              0              0              0              0              2.6109412e-16  0              6            
    100000   144.3          200            200            0.0029500549  -2.8511644e-44  0              0.0088501646   12224.553      0              5.9027993e+10  2.6109412e-16  0              3.332603     
    200000   144.3          200            200            0.0010277236  -2.6067788e-43  0              0.0030831708   2899.2534      0              1.3999457e+10  2.6109412e-16  0              3.0827519    
    300000   144.3          200            200            6.8382646e-05  7.5083612e-48  0              0.00020514794  26.409274      0              1.2752093e+08  2.6109412e-16  0              3.0488286    
    400000   144.3          200            200            0.01927923     0.0019349285   0              0.055902762    55.665154      0              2.6878711e+08  2.6109412e-16  0              2.9929017    
    500000   144.3          200            200            0.00019969037  4.2915245e-05  0              0.00055615588  19.304944      0              93216665       2.6109412e-16  0              2.9993745    
    600000   144.3          200            200            0.0030082867   0.00059087713  0              0.008433983    4.8622615      0              23478121       2.6109412e-16  0              2.9978019    
    700000   144.3          200            200            0.0033649783   0.00060282476  0              0.00949211     0.49811573     0              2405222.6      2.6109412e-16  0              2.9976335    
    800000   144.3          200            200            0.0036887385   0.00061098251  0              0.010455233    0.077589469    0              374651.78      2.6109412e-16  0              2.9974911    
    900000   144.3          200            200            0.0037982416   0.00061332802  0              0.010781397    0.012183206    0              58828.341      2.6109412e-16  0              2.9974438    
   1000000   144.3          200            200            0.003830222    0.00061398051  0              0.010876685    0.0018230656   0              8802.9313      2.6109412e-16  0              2.99743      
   1100000   144.3          200            200            0.0038384808   0.00061414862  0              0.010901294    0.00026006746  0              1255.7727      2.6109412e-16  0              2.9974264    
   1200000   144.3          200            200            0.0038401585   0.00061418386  0              0.010906292    3.5464005e-05  0              171.24299      2.6109412e-16  0              2.9974256    
   1300000   144.3          200            200            0.0038402628   0.00061418686  0              0.010906602    4.6255156e-06  0              22.334959      2.6109412e-16  0              2.9974256    
   1400000   144.3          200            200            0.0038401119   0.00061418428  0              0.010906151    5.761094e-07   0              2.7818261      2.6109412e-16  0              2.9974256    
   1500000   144.3          200            200            0.003839988    0.000614182    0              0.010905782    6.8246151e-08  0              0.32953624     2.6109412e-16  0              2.9974257    
   1600000   144.3          200            200            0.0038399183   0.00061418069  0              0.010905574    7.6337305e-09  0              0.036860552    2.6109412e-16  0              2.9974257    
   1700000   144.3          200            200            0.0038398844   0.00061418005  0              0.010905473    7.9645993e-10  0              0.0038458199   2.6109412e-16  0              2.9974257    
   1800000   144.3          200            200            0.0038398691   0.00061417975  0              0.010905428    7.588886e-11   0              0.00036644015  2.6109412e-16  0              2.9974257    
   1900000   144.3          200            200            0.0038398626   0.00061417963  0              0.010905408    6.3481856e-12  0              3.0653116e-05  2.6109412e-16  0              2.9974257    
   2000000   144.3          200            200            0.0038398599   0.00061417958  0              0.0109054      4.2838897e-13  0              2.068537e-06   2.6109412e-16  0              2.9974257    
   2100000   144.3          200            200            0.0038398589   0.00061417956  0              0.010905397    1.8294354e-14  0              8.8336888e-08  2.6109412e-16  0              2.9974257    
   2200000   144.3          200            200            0.0038398585   0.00061417955  0              0.010905396    9.5004097e-17  0              4.5874078e-10  2.6109412e-16  0              2.9974257    
   2300000   144.3          200            200            0.0038398583   0.00061417955  0              0.010905395    1.2394255e-16  0              5.9847421e-10  2.6109412e-16  0              2.9974257    
   2400000   144.3          200            200            0.0038398582   0.00061417954  0              0.010905395    8.7472917e-17  0              4.2237541e-10  2.6109412e-16  0              2.9974257    
   2500000   144.3          200            200            0.0038398582   0.00061417954  0              0.010905395    2.9408753e-17  0              1.4200434e-10  2.6109412e-16  0              2.9974257    
   2600000   144.3          200            200            0.0038398582   0.00061417954  0              0.010905395    6.5198093e-18  0              3.1481826e-11  2.6109412e-16  0              2.9974257    
   2700000   144.3          200            200            0.0038398582   0.00061417954  0              0.010905395    6.7648362e-19  0              3.2664973e-12  2.6109412e-16  0              2.9974257    
   2800000   144.3          200            200            0.0038398582   0.00061417954  0              0.010905395    2.4183383e-19  0              1.167729e-12   2.6109412e-16  0              2.9974257    
   2900000   144.3          200            200            0.0038398582   0.00061417954  0              0.010905395    8.272849e-20   0              3.9946627e-13  2.6109412e-16  0              2.9974257    
   3000000   144.3          200            200            0.0038398582   0.00061417954  0              0.010905395    5.2055712e-20  0              2.513584e-13   2.6109412e-16  0              2.9974257    
Loop time of 63.8942 on 4 procs for 3000000 steps with 51 atoms

Performance: 40567037.869 ns/day, 0.000 hours/ns, 46952.590 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 0.32837    | 1.6119     | 5.3337     | 169.3 |  2.52
Neigh   | 0.074577   | 0.075276   | 0.076669   |   0.3 |  0.12
Comm    | 25.71      | 32.057     | 37.83      |  82.2 | 50.17
Output  | 0.062593   | 0.062673   | 0.062726   |   0.0 |  0.10
Modify  | 15.17      | 20.91      | 27.987     | 119.2 | 32.73
Other   |            | 9.178      |            |       | 14.36

Nlocal:          12.75 ave          51 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1
Nghost:          39.25 ave          52 max           1 min
Histogram: 1 0 0 0 0 0 0 0 0 3
Neighs:           6.75 ave          27 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1

Total # of neighbors = 27
Ave neighs/atom = 0.52941176
Neighbor list builds = 166
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 31

#variable lat0 equal 1                    #
variable lat1 equal 3+(151*0.01)+(v_ind*0.01)  # .491+(v_ind*0.001)       # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 10*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.82                                                               
Lattice spacing in x,y,z = 4.82 4.82 4.82

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -72.3 ${n1e1} -100 100 -100 100 units box
region box block -72.3 72.3 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -72.3 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -72.3 72.3 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-72.3 -100 -100) to (72.3 100 100)
  1 by 2 by 2 MPI processor grid
create_atoms 1 region substrate
Created 29 atoms
  using lattice units in orthogonal box = (-72.3 -100 -100) to (72.3 100 100)
  create_atoms CPU = 0.000 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 30 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 21 atoms
  using lattice units in orthogonal box = (-72.3 -100 -100) to (72.3 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  29 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  29 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  21 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  21 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
29 atoms in group substrate
group slider1 region slider1
21 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 21 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_31_*.dump id type diameter mass xu yu zu fx fy fz

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 94 130 130
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 14.56 | 18.02 | 19.18 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   144.6          200            200            0              0              0              0              0              0              0              2.6109412e-16  0              6            
    100000   144.6          200            200            0.002942587    2.0810965e-42  0              0.008827761    12217.768      0              6.5550256e+10  2.6109412e-16  0              3.3323004    
    200000   144.6          200            200            0.0010252943  -2.9135347e-41  0              0.0030758829   2898.8402      0              1.5552735e+10  2.6109412e-16  0              3.0818594    
    300000   144.6          200            200            6.9832171e-05  1.3319059e-39  0              0.00020949651  27.614251      0              1.4815482e+08  2.6109412e-16  0              3.047917     
    400000   144.6          200            200            0.020354874    0.0060138475   0              0.055050775    56.452816      0              3.0287827e+08  2.6109412e-16  0              2.9921465    
    500000   144.6          200            200            0.0046978482   0.0018955724   0              0.012197972    39.668586      0              2.1282823e+08  2.6109412e-16  0              2.9964353    
    600000   144.6          200            200            0.0062741667   0.0016009237   0              0.017221576    0.52884853     0              2837355.9      2.6109412e-16  0              2.995808     
    700000   144.6          200            200            0.0036359852   0.0010926878   0              0.0098152678   0.57756447     0              3098724.6      2.6109412e-16  0              2.9968157    
    800000   144.6          200            200            0.0037928445   0.0011068328   0              0.010271701    0.048976239    0              262765.25      2.6109412e-16  0              2.9967418    
    900000   144.6          200            200            0.0040915917   0.0011283582   0              0.011146417    0.0036726847   0              19704.534      2.6109412e-16  0              2.9966149    
   1000000   144.6          200            200            0.0040125525   0.0011229003   0              0.010914757    0.0016849883   0              9040.2283      2.6109412e-16  0              2.996649     
   1100000   144.6          200            200            0.00398632     0.0011210979   0              0.010837862    9.4692806e-07  0              5.0804185      2.6109412e-16  0              2.9966599    
   1200000   144.6          200            200            0.0040015988   0.0011221787   0              0.010882618    3.275522e-05   0              175.73693      2.6109412e-16  0              2.9966534    
   1300000   144.6          200            200            0.0040024791   0.0011222342   0              0.010885203    7.5752596e-07  0              4.0642464      2.6109412e-16  0              2.996653     
   1400000   144.6          200            200            0.0040002567   0.0011220788   0              0.010878691    3.8693368e-07  0              2.0759603      2.6109412e-16  0              2.996654     
   1500000   144.6          200            200            0.0040005268   0.0011220985   0              0.010879482    5.1380167e-08  0              0.27566271     2.6109412e-16  0              2.9966538    
   1600000   144.6          200            200            0.0040007802   0.0011221161   0              0.010880225    1.9791927e-09  0              0.010618681    2.6109412e-16  0              2.9966537    
   1700000   144.6          200            200            0.0040006993   0.0011221104   0              0.010879988    1.4792852e-09  0              0.0079365989   2.6109412e-16  0              2.9966538    
   1800000   144.6          200            200            0.0040006792   0.001122109    0              0.010879929    5.0944657e-13  0              2.7332613e-06  2.6109412e-16  0              2.9966538    
   1900000   144.6          200            200            0.0040006937   0.00112211     0              0.010879971    2.5801751e-11  0              0.00013843047  2.6109412e-16  0              2.9966538    
   2000000   144.6          200            200            0.0040006939   0.00112211     0              0.010879972    9.7195187e-13  0              5.2146753e-06  2.6109412e-16  0              2.9966538    
   2100000   144.6          200            200            0.0040006919   0.0011221099   0              0.010879966    2.6498457e-13  0              1.4216841e-06  2.6109412e-16  0              2.9966538    
   2200000   144.6          200            200            0.0040006922   0.0011221099   0              0.010879967    4.9979413e-14  0              2.6814744e-07  2.6109412e-16  0              2.9966538    
   2300000   144.6          200            200            0.0040006924   0.0011221099   0              0.010879967    9.3441558e-16  0              5.0132871e-09  2.6109412e-16  0              2.9966538    
   2400000   144.6          200            200            0.0040006923   0.0011221099   0              0.010879967    1.2663514e-15  0              6.7941754e-09  2.6109412e-16  0              2.9966538    
   2500000   144.6          200            200            0.0040006923   0.0011221099   0              0.010879967    4.737831e-18   0              2.5419211e-11  2.6109412e-16  0              2.9966538    
   2600000   144.6          200            200            0.0040006923   0.0011221099   0              0.010879967    1.9338248e-17  0              1.0375275e-10  2.6109412e-16  0              2.9966538    
   2700000   144.6          200            200            0.0040006923   0.0011221099   0              0.010879967    2.0223985e-18  0              1.0850487e-11  2.6109412e-16  0              2.9966538    
   2800000   144.6          200            200            0.0040006923   0.0011221099   0              0.010879967    9.172544e-20   0              4.9212147e-13  2.6109412e-16  0              2.9966538    
   2900000   144.6          200            200            0.0040006923   0.0011221099   0              0.010879967    8.4490026e-22  0              4.5330233e-15  2.6109412e-16  0              2.9966538    
   3000000   144.6          200            200            0.0040006923   0.0011221099   0              0.010879967    1.5157381e-19  0              8.1321741e-13  2.6109412e-16  0              2.9966538    
Loop time of 62.9148 on 4 procs for 3000000 steps with 50 atoms

Performance: 41198590.837 ns/day, 0.000 hours/ns, 47683.554 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 0.32807    | 1.6049     | 5.2565     | 166.5 |  2.55
Neigh   | 0.074525   | 0.075109   | 0.076642   |   0.3 |  0.12
Comm    | 25.081     | 31.342     | 37.059     |  82.0 | 49.82
Output  | 0.059566   | 0.059642   | 0.059697   |   0.0 |  0.09
Modify  | 15.013     | 20.751     | 27.76      | 118.3 | 32.98
Other   |            | 9.082      |            |       | 14.44

Nlocal:           12.5 ave          50 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1
Nghost:           37.5 ave          50 max           0 min
Histogram: 1 0 0 0 0 0 0 0 0 3
Neighs:           6.75 ave          27 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1

Total # of neighbors = 27
Ave neighs/atom = 0.54
Neighbor list builds = 166
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 32

#variable lat0 equal 1                    #
variable lat1 equal 3+(151*0.01)+(v_ind*0.01)  # .491+(v_ind*0.001)       # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 10*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.83                                                               
Lattice spacing in x,y,z = 4.83 4.83 4.83

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -72.45 ${n1e1} -100 100 -100 100 units box
region box block -72.45 72.45 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -72.45 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -72.45 72.45 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-72.45 -100 -100) to (72.45 100 100)
  1 by 2 by 2 MPI processor grid
create_atoms 1 region substrate
Created 30 atoms
  using lattice units in orthogonal box = (-72.45 -100 -100) to (72.45 100 100)
  create_atoms CPU = 0.000 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 30 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 21 atoms
  using lattice units in orthogonal box = (-72.45 -100 -100) to (72.45 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  30 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  30 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  21 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  21 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
30 atoms in group substrate
group slider1 region slider1
21 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 21 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_32_*.dump id type diameter mass xu yu zu fx fy fz

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 94 130 130
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 14.56 | 18.02 | 19.18 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   144.9          200            200            0              0              0              0              0              0              0              2.6109412e-16  0              6            
    100000   144.9          200            200            0.0029346893  -5.3161092e-40  0              0.0088040678   12209.068      0              5.8953221e+10  2.6109412e-16  0              3.3317356    
    200000   144.9          200            200            0.001021406    7.9749016e-40  0              0.003064218    2892.2549      0              1.3965664e+10  2.6109412e-16  0              3.0808567    
    300000   144.9          200            200            6.6529645e-05  3.4032142e-38  0              0.00019958893  25.288018      0              1.2210679e+08  2.6109412e-16  0              3.0467622    
    400000   144.9          200            200            0.010585338    0.0032795882   0              0.028476424    186.95688      0              9.0274785e+08  2.6109412e-16  0              2.9933568    
    500000   144.9          200            200            0.0005242007   2.2338671e-36  0              0.0015726021   2.7856287      0              13450804       2.6109412e-16  0              2.9986466    
    600000   144.9          200            200            0.0041194856   0.00050898959  0              0.011849467    4.9156946      0              23736130       2.6109412e-16  0              2.9954128    
    700000   144.9          200            200            0.0031670703   0.0002484167   0              0.0092527942   0.2252597      0              1087698.5      2.6109412e-16  0              2.9958529    
    800000   144.9          200            200            0.0036898198   0.00045989886  0              0.010609561    0.07992394     0              385924.1       2.6109412e-16  0              2.9956048    
    900000   144.9          200            200            0.0037761742   0.00045615412  0              0.010872368    0.012020003    0              58040.29       2.6109412e-16  0              2.9955606    
   1000000   144.9          200            200            0.0037845134   0.00045677415  0              0.010896766    0.0013168949   0              6358.814       2.6109412e-16  0              2.9955569    
   1100000   144.9          200            200            0.0037788735   0.00045627274  0              0.010880348    0.00010039311  0              484.76238      2.6109412e-16  0              2.9955599    
   1200000   144.9          200            200            0.0037739554   0.00045584804  0              0.010866018    3.8319838e-06  0              18.503278      2.6109412e-16  0              2.9955624    
   1300000   144.9          200            200            0.0037713554   0.00045562471  0              0.010858442    1.9332797e-10  0              0.00093351156  2.6109412e-16  0              2.9955637    
   1400000   144.9          200            200            0.0037702398   0.00045552925  0              0.01085519     7.5269228e-08  0              0.36344816     2.6109412e-16  0              2.9955643    
   1500000   144.9          200            200            0.0037698271   0.00045549411  0              0.010853987    3.4639304e-08  0              0.1672608      2.6109412e-16  0              2.9955645    
   1600000   144.9          200            200            0.0037696952   0.00045548295  0              0.010853603    8.1745807e-09  0              0.039472125    2.6109412e-16  0              2.9955645    
   1700000   144.9          200            200            0.0037696607   0.00045548006  0              0.010853502    1.3521618e-09  0              0.0065291056   2.6109412e-16  0              2.9955646    
   1800000   144.9          200            200            0.0037696549   0.00045547959  0              0.010853485    1.6805836e-10  0              0.00081149367  2.6109412e-16  0              2.9955646    
   1900000   144.9          200            200            0.0037696556   0.00045547966  0              0.010853487    1.5269522e-11  0              7.3731058e-05  2.6109412e-16  0              2.9955646    
   2000000   144.9          200            200            0.0037696569   0.00045547977  0              0.010853491    8.5279421e-13  0              4.1178381e-06  2.6109412e-16  0              2.9955646    
   2100000   144.9          200            200            0.0037696577   0.00045547984  0              0.010853493    1.0822791e-14  0              5.2259385e-08  2.6109412e-16  0              2.9955646    
   2200000   144.9          200            200            0.003769658    0.00045547987  0              0.010853494    2.8811763e-15  0              1.3912169e-08  2.6109412e-16  0              2.9955646    
   2300000   144.9          200            200            0.0037696582   0.00045547988  0              0.010853495    2.59294e-15    0              1.2520379e-08  2.6109412e-16  0              2.9955646    
   2400000   144.9          200            200            0.0037696582   0.00045547988  0              0.010853495    7.6064487e-16  0              3.6728819e-09  2.6109412e-16  0              2.9955646    
   2500000   144.9          200            200            0.0037696582   0.00045547988  0              0.010853495    1.440988e-16   0              6.9580155e-10  2.6109412e-16  0              2.9955646    
   2600000   144.9          200            200            0.0037696582   0.00045547988  0              0.010853495    2.0473657e-17  0              9.8859962e-11  2.6109412e-16  0              2.9955646    
   2700000   144.9          200            200            0.0037696582   0.00045547988  0              0.010853495    1.4739591e-18  0              7.1172209e-12  2.6109412e-16  0              2.9955646    
   2800000   144.9          200            200            0.0037696582   0.00045547988  0              0.010853495    8.1977939e-22  0              3.9584213e-15  2.6109412e-16  0              2.9955646    
   2900000   144.9          200            200            0.0037696582   0.00045547988  0              0.010853495    6.0470849e-20  0              2.9199209e-13  2.6109412e-16  0              2.9955646    
   3000000   144.9          200            200            0.0037696582   0.00045547988  0              0.010853495    3.5254828e-20  0              1.7023295e-13  2.6109412e-16  0              2.9955646    
Loop time of 64.0068 on 4 procs for 3000000 steps with 51 atoms

Performance: 40495717.079 ns/day, 0.000 hours/ns, 46870.043 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 0.32931    | 1.6251     | 5.3563     | 169.1 |  2.54
Neigh   | 0.07366    | 0.074252   | 0.075764   |   0.3 |  0.12
Comm    | 25.669     | 32.09      | 37.865     |  82.8 | 50.14
Output  | 0.061493   | 0.061569   | 0.061618   |   0.0 |  0.10
Modify  | 15.282     | 21.011     | 28.145     | 119.7 | 32.83
Other   |            | 9.145      |            |       | 14.29

Nlocal:          12.75 ave          51 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1
Nghost:          39.25 ave          52 max           1 min
Histogram: 1 0 0 0 0 0 0 0 0 3
Neighs:           6.75 ave          27 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1

Total # of neighbors = 27
Ave neighs/atom = 0.52941176
Neighbor list builds = 164
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 33

#variable lat0 equal 1                    #
variable lat1 equal 3+(151*0.01)+(v_ind*0.01)  # .491+(v_ind*0.001)       # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 10*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.84                                                               
Lattice spacing in x,y,z = 4.84 4.84 4.84

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -72.6 ${n1e1} -100 100 -100 100 units box
region box block -72.6 72.6 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -72.6 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -72.6 72.6 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-72.6 -100 -100) to (72.6 100 100)
  1 by 2 by 2 MPI processor grid
create_atoms 1 region substrate
Created 30 atoms
  using lattice units in orthogonal box = (-72.6 -100 -100) to (72.6 100 100)
  create_atoms CPU = 0.000 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 30 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 21 atoms
  using lattice units in orthogonal box = (-72.6 -100 -100) to (72.6 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  30 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  30 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  21 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  21 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
30 atoms in group substrate
group slider1 region slider1
21 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 21 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_33_*.dump id type diameter mass xu yu zu fx fy fz

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 94 130 130
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 14.56 | 18.02 | 19.18 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   145.2          200            200            0              0              0              0              0              0              0              2.6109412e-16  0              6            
    100000   145.2          200            200            0.0029275606  -5.3055162e-40  0              0.0087826818   12206.444      0              5.8940551e+10  2.6109412e-16  0              3.3304267    
    200000   145.2          200            200            0.00101593     1.6978431e-38  0              0.0030477901   2878.7595      0              1.3900499e+10  2.6109412e-16  0              3.0799087    
    300000   145.2          200            200            5.3336631e-05 -1.0173132e-37  0              0.00016000989  16.614156      0              80223812       2.6109412e-16  0              3.045687     
    400000   145.2          200            200            0.00015202669  1.4975288e-36  0              0.00045608006  122.84611      0              5.9317991e+08  2.6109412e-16  0              3.001127     
    500000   145.2          200            200            0.0067551925   0.00022908771  0              0.02003649     10.687194      0              51604633       2.6109412e-16  0              2.9929362    
    600000   145.2          200            200            0.0041564302   1.3276125e-36  0              0.012469291    3.2806583      0              15841125       2.6109412e-16  0              2.9947623    
    700000   145.2          200            200            0.0037150524   9.3673572e-37  0              0.011145157    0.51524721     0              2487944.4      2.6109412e-16  0              2.9951303    
    800000   145.2          200            200            0.0036244199  -9.6087417e-38  0              0.01087326     0.072816476    0              351604.7       2.6109412e-16  0              2.9952052    
    900000   145.2          200            200            0.0036066602   3.5885372e-38  0              0.010819981    0.0098717864   0              47667.324      2.6109412e-16  0              2.995219     
   1000000   145.2          200            200            0.0036055779   5.5997449e-38  0              0.010816734    0.0012871056   0              6214.9724      2.6109412e-16  0              2.9952193    
   1100000   145.2          200            200            0.0036071992  -3.5293107e-39  0              0.010821597    0.00016107365  0              777.767        2.6109412e-16  0              2.9952176    
   1200000   145.2          200            200            0.0036085309   2.3733755e-40  0              0.010825593    1.9278693e-05  0              93.089909      2.6109412e-16  0              2.9952163    
   1300000   145.2          200            200            0.0036092824  -4.530339e-39   0              0.010827847    2.1938261e-06  0              10.593201      2.6109412e-16  0              2.9952156    
   1400000   145.2          200            200            0.0036096498  -7.3801293e-39  0              0.010828949    2.3506788e-07  0              1.1350587      2.6109412e-16  0              2.9952153    
   1500000   145.2          200            200            0.0036098157  -7.1264222e-40  0              0.010829447    2.3337457e-08  0              0.11268823     2.6109412e-16  0              2.9952151    
   1600000   145.2          200            200            0.0036098869   3.3715061e-39  0              0.010829661    2.0865953e-09  0              0.010075422    2.6109412e-16  0              2.9952151    
   1700000   145.2          200            200            0.0036099163   5.4764147e-41  0              0.010829749    1.5886957e-10  0              0.00076712429  2.6109412e-16  0              2.995215     
   1800000   145.2          200            200            0.003609928    4.7315141e-39  0              0.010829784    9.0043209e-12  0              4.3478643e-05  2.6109412e-16  0              2.995215     
   1900000   145.2          200            200            0.0036099327  -1.7002124e-39  0              0.010829798    2.3073312e-13  0              1.1141277e-06  2.6109412e-16  0              2.995215     
   2000000   145.2          200            200            0.0036099344   1.4530781e-39  0              0.010829803    3.1541731e-15  0              1.5230373e-08  2.6109412e-16  0              2.995215     
   2100000   145.2          200            200            0.0036099351   3.5825912e-39  0              0.010829805    1.121307e-14   0              5.4143903e-08  2.6109412e-16  0              2.995215     
   2200000   145.2          200            200            0.0036099353   4.462547e-40   0              0.010829806    4.8397962e-15  0              2.3369644e-08  2.6109412e-16  0              2.995215     
   2300000   145.2          200            200            0.0036099354   5.3598321e-40  0              0.010829806    1.3152023e-15  0              6.3506414e-09  2.6109412e-16  0              2.995215     
   2400000   145.2          200            200            0.0036099354  -3.8962373e-40  0              0.010829806    2.913965e-16   0              1.4070494e-09  2.6109412e-16  0              2.995215     
   2500000   145.2          200            200            0.0036099354   8.5617914e-40  0              0.010829806    5.6886857e-17  0              2.7468627e-10  2.6109412e-16  0              2.995215     
   2600000   145.2          200            200            0.0036099354   1.0936524e-39  0              0.010829806    1.0180814e-17  0              4.9159509e-11  2.6109412e-16  0              2.995215     
   2700000   145.2          200            200            0.0036099354   3.510049e-39   0              0.010829806    1.5509388e-18  0              7.4889283e-12  2.6109412e-16  0              2.995215     
   2800000   145.2          200            200            0.0036099354   7.0484331e-39  0              0.010829806    2.8126191e-19  0              1.3581131e-12  2.6109412e-16  0              2.995215     
   2900000   145.2          200            200            0.0036099354   4.0992806e-41  0              0.010829806    2.8173388e-20  0              1.3603921e-13  2.6109412e-16  0              2.995215     
   3000000   145.2          200            200            0.0036099354  -6.8962612e-39  0              0.010829806    2.3462731e-20  0              1.1329313e-13  2.6109412e-16  0              2.995215     
Loop time of 63.8125 on 4 procs for 3000000 steps with 51 atoms

Performance: 40618987.403 ns/day, 0.000 hours/ns, 47012.717 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 0.32701    | 1.526      | 4.9727     | 161.1 |  2.39
Neigh   | 0.073711   | 0.074299   | 0.075828   |   0.3 |  0.12
Comm    | 25.684     | 32.149     | 37.839     |  83.2 | 50.38
Output  | 0.061269   | 0.061343   | 0.061392   |   0.0 |  0.10
Modify  | 15.162     | 20.895     | 27.983     | 119.5 | 32.74
Other   |            | 9.107      |            |       | 14.27

Nlocal:          12.75 ave          51 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1
Nghost:          39.25 ave          52 max           1 min
Histogram: 1 0 0 0 0 0 0 0 0 3
Neighs:           6.75 ave          27 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1

Total # of neighbors = 27
Ave neighs/atom = 0.52941176
Neighbor list builds = 164
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 34

#variable lat0 equal 1                    #
variable lat1 equal 3+(151*0.01)+(v_ind*0.01)  # .491+(v_ind*0.001)       # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 10*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.85                                                               
Lattice spacing in x,y,z = 4.85 4.85 4.85

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -72.75 ${n1e1} -100 100 -100 100 units box
region box block -72.75 72.75 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -72.75 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -72.75 72.75 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-72.75 -100 -100) to (72.75 100 100)
  1 by 2 by 2 MPI processor grid
create_atoms 1 region substrate
Created 30 atoms
  using lattice units in orthogonal box = (-72.75 -100 -100) to (72.75 100 100)
  create_atoms CPU = 0.000 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 30 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 21 atoms
  using lattice units in orthogonal box = (-72.75 -100 -100) to (72.75 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  30 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  30 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  21 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  21 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
30 atoms in group substrate
group slider1 region slider1
21 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 21 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_34_*.dump id type diameter mass xu yu zu fx fy fz

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 94 130 130
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 14.56 | 18.02 | 19.18 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   145.5          200            200            0              0              0              0              0              0              0              2.6109412e-16  0              6            
    100000   145.5          200            200            0.0029207797  -6.352892e-39   0              0.008762339    12206.281      0              5.8939764e+10  2.6109412e-16  0              3.3288615    
    200000   145.5          200            200            0.0010084913   3.3909462e-38  0              0.0030254739   2856.4646      0              1.3792845e+10  2.6109412e-16  0              3.0792951    
    300000   145.5          200            200            2.3875432e-05 -5.3797876e-37  0              7.1626297e-05  3.4896836      0              16850433       2.6109412e-16  0              3.0448556    
    400000   145.5          200            200           -2.8902179e-05  3.2988915e-36  0             -8.6706537e-05  5.6078827      0              27078458       2.6109412e-16  0              3.0060908    
    500000   145.5          200            200            0.0070320408  -5.5334271e-37  0              0.021096122    3.6553041      0              17650155       2.6109412e-16  0              2.992539     
    600000   145.5          200            200            0.0039994453   1.0268201e-35  0              0.011998336    3.6453823      0              17602246       2.6109412e-16  0              2.9948899    
    700000   145.5          200            200            0.0036507329   4.0517074e-37  0              0.010952199    0.53953252     0              2605209.5      2.6109412e-16  0              2.9951804    
    800000   145.5          200            200            0.0035958604   2.4732322e-37  0              0.010787581    0.073502368    0              354916.63      2.6109412e-16  0              2.9952239    
    900000   145.5          200            200            0.0035914968   5.9480283e-37  0              0.010774491    0.0096222457   0              46462.381      2.6109412e-16  0              2.9952258    
   1000000   145.5          200            200            0.0035953645   4.2933382e-39  0              0.010786093    0.0012097327   0              5841.3661      2.6109412e-16  0              2.9952217    
   1100000   145.5          200            200            0.0035987825  -3.5353209e-38  0              0.010796347    0.00014553331  0              702.72828      2.6109412e-16  0              2.9952184    
   1200000   145.5          200            200            0.0036007535   1.7360918e-38  0              0.01080226     1.6658203e-05  0              80.4365        2.6109412e-16  0              2.9952166    
   1300000   145.5          200            200            0.0036017275  -1.6432562e-41  0              0.010805182    1.7976331e-06  0              8.6801269      2.6109412e-16  0              2.9952157    
   1400000   145.5          200            200            0.0036021704   1.0153636e-38  0              0.010806511    1.8012526e-07  0              0.86976042     2.6109412e-16  0              2.9952153    
   1500000   145.5          200            200            0.0036023613   7.0444869e-39  0              0.010807084    1.631868e-08   0              0.078797064    2.6109412e-16  0              2.9952151    
   1600000   145.5          200            200            0.0036024404   7.4743229e-39  0              0.010807321    1.2693776e-09  0              0.0061293703   2.6109412e-16  0              2.9952151    
   1700000   145.5          200            200            0.0036024722   1.3400461e-38  0              0.010807417    7.5138548e-11  0              0.00036281716  2.6109412e-16  0              2.995215     
   1800000   145.5          200            200            0.0036024847  -1.4298159e-38  0              0.010807454    2.2304077e-12  0              1.0769841e-05  2.6109412e-16  0              2.995215     
   1900000   145.5          200            200            0.0036024895  -1.5375124e-39  0              0.010807468    7.2477436e-15  0              3.499676e-08   2.6109412e-16  0              2.995215     
   2000000   145.5          200            200            0.0036024913  -3.3520605e-39  0              0.010807474    6.9729254e-14  0              3.3669761e-07  2.6109412e-16  0              2.995215     
   2100000   145.5          200            200            0.0036024919   5.6789988e-39  0              0.010807476    3.271263e-14   0              1.5795758e-07  2.6109412e-16  0              2.995215     
   2200000   145.5          200            200            0.0036024922   8.6340684e-39  0              0.010807476    9.2177635e-15  0              4.4509281e-08  2.6109412e-16  0              2.995215     
   2300000   145.5          200            200            0.0036024922  -1.8807469e-39  0              0.010807477    2.0732528e-15  0              1.0010996e-08  2.6109412e-16  0              2.995215     
   2400000   145.5          200            200            0.0036024923  -4.664686e-39   0              0.010807477    4.1063963e-16  0              1.9828318e-09  2.6109412e-16  0              2.995215     
   2500000   145.5          200            200            0.0036024923   4.5412327e-39  0              0.010807477    7.2814983e-17  0              3.5159749e-10  2.6109412e-16  0              2.995215     
   2600000   145.5          200            200            0.0036024923  -2.2422554e-38  0              0.010807477    1.2267789e-17  0              5.9236764e-11  2.6109412e-16  0              2.995215     
   2700000   145.5          200            200            0.0036024923   1.5076317e-38  0              0.010807477    1.8433339e-18  0              8.9007997e-12  2.6109412e-16  0              2.995215     
   2800000   145.5          200            200            0.0036024923   4.2873636e-39  0              0.010807477    3.015286e-19   0              1.4559737e-12  2.6109412e-16  0              2.995215     
   2900000   145.5          200            200            0.0036024923   3.0617633e-40  0              0.010807477    3.0875171e-20  0              1.4908515e-13  2.6109412e-16  0              2.995215     
   3000000   145.5          200            200            0.0036024923  -9.5408704e-39  0              0.010807477    2.3139477e-20  0              1.1173225e-13  2.6109412e-16  0              2.995215     
Loop time of 64.0756 on 4 procs for 3000000 steps with 51 atoms

Performance: 40452215.841 ns/day, 0.000 hours/ns, 46819.694 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 0.32369    | 1.5365     | 5.007      | 161.7 |  2.40
Neigh   | 0.073632   | 0.074224   | 0.075691   |   0.3 |  0.12
Comm    | 25.763     | 32.238     | 37.982     |  83.5 | 50.31
Output  | 0.060555   | 0.060632   | 0.060685   |   0.0 |  0.09
Modify  | 15.23      | 21.011     | 28.149     | 120.1 | 32.79
Other   |            | 9.155      |            |       | 14.29

Nlocal:          12.75 ave          51 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1
Nghost:          39.25 ave          52 max           1 min
Histogram: 1 0 0 0 0 0 0 0 0 3
Neighs:           6.75 ave          27 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1

Total # of neighbors = 27
Ave neighs/atom = 0.52941176
Neighbor list builds = 164
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 35

#variable lat0 equal 1                    #
variable lat1 equal 3+(151*0.01)+(v_ind*0.01)  # .491+(v_ind*0.001)       # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 10*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.86                                                               
Lattice spacing in x,y,z = 4.86 4.86 4.86

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -72.9 ${n1e1} -100 100 -100 100 units box
region box block -72.9 72.9 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -72.9 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -72.9 72.9 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-72.9 -100 -100) to (72.9 100 100)
  1 by 2 by 2 MPI processor grid
create_atoms 1 region substrate
Created 30 atoms
  using lattice units in orthogonal box = (-72.9 -100 -100) to (72.9 100 100)
  create_atoms CPU = 0.000 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 30 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 21 atoms
  using lattice units in orthogonal box = (-72.9 -100 -100) to (72.9 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  30 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  30 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  21 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  21 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
30 atoms in group substrate
group slider1 region slider1
21 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 21 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_35_*.dump id type diameter mass xu yu zu fx fy fz

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 95 130 130
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 14.57 | 18.04 | 19.2 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   145.8          200            200            0              0              0              0              0              0              0              2.6109412e-16  0              6            
    100000   145.8          200            200            0.0029138933   1.0569352e-39  0              0.0087416798   12204.673      0              5.8932e+10     2.6109412e-16  0              3.3275629    
    200000   145.8          200            200            0.0010006315   1.3574546e-37  0              0.0030018946   2832.087       0              1.3675134e+10  2.6109412e-16  0              3.0788842    
    300000   145.8          200            200           -2.4517042e-05 -2.6702664e-36  0             -7.3551125e-05  3.9180743      0              18918978       2.6109412e-16  0              3.0437147    
    400000   145.8          200            200            0.00086418934  5.7527594e-36  0              0.002592568    171.1365       0              8.2635692e+08  2.6109412e-16  0              2.9979532    
    500000   145.8          200            200            0.0024489972  -6.5655039e-36  0              0.0073469916   25.646246      0              1.2383654e+08  2.6109412e-16  0              2.9963628    
    600000   145.8          200            200            0.0024911556   7.9621617e-36  0              0.0074734667   0.58004785     0              2800843.5      2.6109412e-16  0              2.9962634    
    700000   145.8          200            200            0.0031498031  -4.7803413e-36  0              0.0094494093   0.014490404    0              69968.976      2.6109412e-16  0              2.9956205    
    800000   145.8          200            200            0.0034272714  -5.2903748e-37  0              0.010281814    1.102901e-05   0              53.255142      2.6109412e-16  0              2.9953653    
    900000   145.8          200            200            0.0035335687  -2.2749658e-36  0              0.010600706    0.00016723556  0              807.52067      2.6109412e-16  0              2.9952697    
   1000000   145.8          200            200            0.0035730299   2.1177192e-37  0              0.01071909     9.6532692e-05  0              466.12182      2.6109412e-16  0              2.9952345    
   1100000   145.8          200            200            0.0035873472   1.0359304e-37  0              0.010762042    2.9210889e-05  0              141.04893      2.6109412e-16  0              2.9952218    
   1200000   145.8          200            200            0.0035924314   2.7922159e-38  0              0.010777294    6.7985114e-06  0              32.827579      2.6109412e-16  0              2.9952173    
   1300000   145.8          200            200            0.0035941969   1.8789222e-38  0              0.010782591    1.364304e-06   0              6.5877357      2.6109412e-16  0              2.9952158    
   1400000   145.8          200            200            0.003594795   -4.7374211e-39  0              0.010784385    2.4806083e-07  0              1.197797       2.6109412e-16  0              2.9952153    
   1500000   145.8          200            200            0.0035949918  -2.2054389e-39  0              0.010784975    4.1930358e-08  0              0.20246669     2.6109412e-16  0              2.9952151    
   1600000   145.8          200            200            0.0035950542   8.776209e-39   0              0.010785163    6.6870802e-09  0              0.032289517    2.6109412e-16  0              2.995215     
   1700000   145.8          200            200            0.003595073   -1.8124229e-38  0              0.010785219    1.0152132e-09  0              0.0049021013   2.6109412e-16  0              2.995215     
   1800000   145.8          200            200            0.0035950783   6.5839538e-39  0              0.010785235    1.4751749e-10  0              0.00071230915  2.6109412e-16  0              2.995215     
   1900000   145.8          200            200            0.0035950796   4.2715232e-39  0              0.010785239    2.0578635e-11  0              9.9366866e-05  2.6109412e-16  0              2.995215     
   2000000   145.8          200            200            0.0035950798  -1.2384709e-38  0              0.01078524     2.7593194e-12  0              1.3323766e-05  2.6109412e-16  0              2.995215     
   2100000   145.8          200            200            0.0035950798   1.0364294e-39  0              0.01078524     3.5552795e-13  0              1.7167172e-06  2.6109412e-16  0              2.995215     
   2200000   145.8          200            200            0.0035950798   8.6398811e-39  0              0.010785239    4.3915046e-14  0              2.1205004e-07  2.6109412e-16  0              2.995215     
   2300000   145.8          200            200            0.0035950798  -1.0381282e-40  0              0.010785239    5.1764965e-15  0              2.4995449e-08  2.6109412e-16  0              2.995215     
   2400000   145.8          200            200            0.0035950798   3.402524e-38   0              0.010785239    5.7951774e-16  0              2.7982838e-09  2.6109412e-16  0              2.995215     
   2500000   145.8          200            200            0.0035950798   1.1736634e-38  0              0.010785239    5.9528359e-17  0              2.8744114e-10  2.6109412e-16  0              2.995215     
   2600000   145.8          200            200            0.0035950797   2.8238671e-39  0              0.010785239    5.215191e-18   0              2.5182291e-11  2.6109412e-16  0              2.995215     
   2700000   145.8          200            200            0.0035950797   1.3678681e-38  0              0.010785239    5.0780757e-19  0              2.452021e-12   2.6109412e-16  0              2.995215     
   2800000   145.8          200            200            0.0035950797   2.0861145e-39  0              0.010785239    3.6452213e-21  0              1.7601469e-14  2.6109412e-16  0              2.995215     
   2900000   145.8          200            200            0.0035950797  -2.3056957e-39  0              0.010785239    1.623485e-19   0              7.8392281e-13  2.6109412e-16  0              2.995215     
   3000000   145.8          200            200            0.0035950797  -1.4227744e-38  0              0.010785239    7.2600709e-22  0              3.5056284e-15  2.6109412e-16  0              2.995215     
Loop time of 64.0977 on 4 procs for 3000000 steps with 51 atoms

Performance: 40438275.017 ns/day, 0.000 hours/ns, 46803.559 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 0.32842    | 1.5659     | 5.127      | 164.4 |  2.44
Neigh   | 0.075372   | 0.075953   | 0.077475   |   0.3 |  0.12
Comm    | 25.793     | 32.236     | 37.971     |  82.9 | 50.29
Output  | 0.059463   | 0.059539   | 0.059593   |   0.0 |  0.09
Modify  | 15.253     | 21.005     | 28.126     | 119.3 | 32.77
Other   |            | 9.155      |            |       | 14.28

Nlocal:          12.75 ave          51 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1
Nghost:          39.25 ave          52 max           1 min
Histogram: 1 0 0 0 0 0 0 0 0 3
Neighs:           6.75 ave          27 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1

Total # of neighbors = 27
Ave neighs/atom = 0.52941176
Neighbor list builds = 166
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 36

#variable lat0 equal 1                    #
variable lat1 equal 3+(151*0.01)+(v_ind*0.01)  # .491+(v_ind*0.001)       # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 10*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.87                                                               
Lattice spacing in x,y,z = 4.87 4.87 4.87

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -73.05 ${n1e1} -100 100 -100 100 units box
region box block -73.05 73.05 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -73.05 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -73.05 73.05 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-73.05 -100 -100) to (73.05 100 100)
  1 by 2 by 2 MPI processor grid
create_atoms 1 region substrate
Created 30 atoms
  using lattice units in orthogonal box = (-73.05 -100 -100) to (73.05 100 100)
  create_atoms CPU = 0.000 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 30 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 21 atoms
  using lattice units in orthogonal box = (-73.05 -100 -100) to (73.05 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  30 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  30 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  21 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  21 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
30 atoms in group substrate
group slider1 region slider1
21 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 21 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_36_*.dump id type diameter mass xu yu zu fx fy fz

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 95 130 130
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 14.57 | 18.04 | 19.2 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   146.1          200            200            0              0              0              0              0              0              0              2.6109412e-16  0              6            
    100000   146.1          200            200            0.0029066049   1.6873889e-38  0              0.0087198146   12198.848      0              5.890387e+10   2.6109412e-16  0              3.326951     
    200000   146.1          200            200            0.00099418293  2.7317156e-37  0              0.0029825488   2813.4903      0              1.3585338e+10  2.6109412e-16  0              3.0786521    
    300000   146.1          200            200           -7.2738155e-05  1.6784129e-36  0             -0.00021821447  37.661561      0              1.818542e+08   2.6109412e-16  0              3.0415911    
    400000   146.1          200            200            0.0055970718  -1.4203571e-35  0              0.016791215    185.20938      0              8.9430983e+08  2.6109412e-16  0              2.9934489    
    500000   146.1          200            200            0.0013622127   2.7601849e-36  0              0.0040866381   13.580019      0              65573050       2.6109412e-16  0              2.9975504    
    600000   146.1          200            200            0.0023967957   2.6274032e-36  0              0.0071903871   0.021488803    0              103761.74      2.6109412e-16  0              2.9963423    
    700000   146.1          200            200            0.0031560418   6.0683119e-36  0              0.0094681255   0.051108475    0              246784.54      2.6109412e-16  0              2.9956047    
    800000   146.1          200            200            0.0034370797   3.6765359e-36  0              0.010311239    0.014975548    0              72311.56       2.6109412e-16  0              2.9953487    
    900000   146.1          200            200            0.0035365886  -7.7481007e-37  0              0.010609766    0.0032879931   0              15876.542      2.6109412e-16  0              2.99526      
   1000000   146.1          200            200            0.003570875    3.749518e-37   0              0.010712625    0.00063170501  0              3050.2774      2.6109412e-16  0              2.9952297    
   1100000   146.1          200            200            0.0035823619  -3.0089374e-38  0              0.010747086    0.00011115762  0              536.74035      2.6109412e-16  0              2.9952196    
   1200000   146.1          200            200            0.0035860874   1.9294225e-38  0              0.010758262    1.8306473e-05  0              88.395406      2.6109412e-16  0              2.9952164    
   1300000   146.1          200            200            0.0035872466   1.1947998e-38  0              0.01076174     2.856466e-06   0              13.792852      2.6109412e-16  0              2.9952154    
   1400000   146.1          200            200            0.003587587    1.3501051e-38  0              0.010762761    4.2540225e-07  0              2.0541152      2.6109412e-16  0              2.9952151    
   1500000   146.1          200            200            0.0035876781  -1.1316476e-38  0              0.010763034    6.0729518e-08  0              0.29324111     2.6109412e-16  0              2.995215     
   1600000   146.1          200            200            0.0035876984  -4.4791971e-40  0              0.010763095    8.3291353e-09  0              0.040218413    2.6109412e-16  0              2.995215     
   1700000   146.1          200            200            0.0035877008   7.1248093e-39  0              0.010763102    1.0980817e-09  0              0.0053022437   2.6109412e-16  0              2.995215     
   1800000   146.1          200            200            0.0035876999   1.3020631e-38  0              0.0107631      1.3901107e-10  0              0.00067123469  2.6109412e-16  0              2.995215     
   1900000   146.1          200            200            0.0035876988   1.3229616e-38  0              0.010763097    1.6850516e-11  0              8.1365112e-05  2.6109412e-16  0              2.995215     
   2000000   146.1          200            200            0.0035876982   5.6216148e-39  0              0.010763095    1.9457855e-12  0              9.3955018e-06  2.6109412e-16  0              2.995215     
   2100000   146.1          200            200            0.0035876979   1.1355869e-38  0              0.010763094    2.1224922e-13  0              1.0248755e-06  2.6109412e-16  0              2.995215     
   2200000   146.1          200            200            0.0035876978  -3.2797419e-38  0              0.010763093    2.1568031e-14  0              1.041443e-07   2.6109412e-16  0              2.995215     
   2300000   146.1          200            200            0.0035876977   1.8767124e-39  0              0.010763093    1.9911253e-15  0              9.6144314e-09  2.6109412e-16  0              2.995215     
   2400000   146.1          200            200            0.0035876977  -1.7440817e-38  0              0.010763093    1.5663989e-16  0              7.5635799e-10  2.6109412e-16  0              2.995215     
   2500000   146.1          200            200            0.0035876977  -5.2722529e-38  0              0.010763093    9.377156e-18   0              4.527893e-11   2.6109412e-16  0              2.995215     
   2600000   146.1          200            200            0.0035876977   3.3194441e-38  0              0.010763093    2.0073182e-19  0              9.6926212e-13  2.6109412e-16  0              2.995215     
   2700000   146.1          200            200            0.0035876977   1.04833e-38    0              0.010763093    1.2062528e-22  0              5.8245632e-16  2.6109412e-16  0              2.995215     
   2800000   146.1          200            200            0.0035876977   1.6317106e-38  0              0.010763093    1.9570065e-20  0              9.4496839e-14  2.6109412e-16  0              2.995215     
   2900000   146.1          200            200            0.0035876977   2.2681576e-39  0              0.010763093    3.9273409e-20  0              1.8963724e-13  2.6109412e-16  0              2.995215     
   3000000   146.1          200            200            0.0035876977   1.0608971e-38  0              0.010763093    6.0082988e-20  0              2.9011924e-13  2.6109412e-16  0              2.995215     
Loop time of 64.4353 on 4 procs for 3000000 steps with 51 atoms

Performance: 40226386.221 ns/day, 0.000 hours/ns, 46558.317 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 0.32433    | 1.607      | 5.291      | 167.9 |  2.49
Neigh   | 0.075378   | 0.075941   | 0.077446   |   0.3 |  0.12
Comm    | 25.763     | 32.327     | 38.126     |  83.6 | 50.17
Output  | 0.090499   | 0.090574   | 0.090624   |   0.0 |  0.14
Modify  | 15.403     | 21.178     | 28.453     | 120.6 | 32.87
Other   |            | 9.157      |            |       | 14.21

Nlocal:          12.75 ave          51 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1
Nghost:          39.25 ave          52 max           1 min
Histogram: 1 0 0 0 0 0 0 0 0 3
Neighs:           7.25 ave          29 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1

Total # of neighbors = 29
Ave neighs/atom = 0.56862745
Neighbor list builds = 166
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 37

#variable lat0 equal 1                    #
variable lat1 equal 3+(151*0.01)+(v_ind*0.01)  # .491+(v_ind*0.001)       # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 10*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.88                                                               
Lattice spacing in x,y,z = 4.88 4.88 4.88

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -73.2 ${n1e1} -100 100 -100 100 units box
region box block -73.2 73.2 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -73.2 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -73.2 73.2 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-73.2 -100 -100) to (73.2 100 100)
  1 by 2 by 2 MPI processor grid
create_atoms 1 region substrate
Created 30 atoms
  using lattice units in orthogonal box = (-73.2 -100 -100) to (73.2 100 100)
  create_atoms CPU = 0.000 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 30 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 21 atoms
  using lattice units in orthogonal box = (-73.2 -100 -100) to (73.2 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  30 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  30 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  21 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  21 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
30 atoms in group substrate
group slider1 region slider1
21 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 21 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_37_*.dump id type diameter mass xu yu zu fx fy fz

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 95 130 130
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 14.57 | 18.04 | 19.2 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   146.4          200            200            0              0              0              0              0              0              0              2.6109412e-16  0              6            
    100000   146.4          200            200            0.0028988177   2.1049354e-38  0              0.0086964532   12187.569      0              5.8849411e+10  2.6109412e-16  0              3.3272858    
    200000   146.4          200            200            0.00098452929  2.800483e-37   0              0.0029535879   2779.4094      0              1.3420773e+10  2.6109412e-16  0              3.0802452    
    300000   146.4          200            200           -8.2201413e-05 -1.5539723e-36  0             -0.00024660424  49.152627      0              2.3734045e+08  2.6109412e-16  0              3.0409818    
    400000   146.4          200            200            0.0066389835  -2.2125843e-35  0              0.019916951    173.53411      0              8.3793411e+08  2.6109412e-16  0              2.9926708    
    500000   146.4          200            200            0.0012161086  -9.7578425e-36  0              0.0036483257   11.180905      0              53988588       2.6109412e-16  0              2.9977264    
    600000   146.4          200            200            0.002401767    1.6156331e-35  0              0.007205301    0.10257093     0              495278.33      2.6109412e-16  0              2.9963301    
    700000   146.4          200            200            0.0031628383   6.1150282e-36  0              0.009488515    0.083046379    0              401001.24      2.6109412e-16  0              2.9955917    
    800000   146.4          200            200            0.0034371996   5.9112437e-36  0              0.010311599    0.020688925    0              99899.416      2.6109412e-16  0              2.9953419    
    900000   146.4          200            200            0.0035326758   3.2052309e-37  0              0.010598027    0.0041666515   0              20119.269      2.6109412e-16  0              2.9952569    
   1000000   146.4          200            200            0.0035650082   9.4344268e-38  0              0.010695025    0.00075501319  0              3645.6885      2.6109412e-16  0              2.9952284    
   1100000   146.4          200            200            0.0035756253   1.5627447e-37  0              0.010726876    0.0001271183   0              613.80879      2.6109412e-16  0              2.9952191    
   1200000   146.4          200            200            0.0035789826   5.966481e-38   0              0.010736948    2.0199095e-05  0              97.534202      2.6109412e-16  0              2.9952162    
   1300000   146.4          200            200            0.0035799915   1.5433721e-38  0              0.010739975    3.0564669e-06  0              14.758585      2.6109412e-16  0              2.9952153    
   1400000   146.4          200            200            0.0035802722   9.6690181e-39  0              0.010740816    4.4277062e-07  0              2.1379809      2.6109412e-16  0              2.9952151    
   1500000   146.4          200            200            0.0035803401  -2.6339892e-38  0              0.01074102     6.1585859e-08  0              0.29737607     2.6109412e-16  0              2.995215     
   1600000   146.4          200            200            0.0035803516  -9.9247361e-39  0              0.010741055    8.2340552e-09  0              0.039759306    2.6109412e-16  0              2.995215     
   1700000   146.4          200            200            0.0035803508  -5.0677888e-39  0              0.010741052    1.0577116e-09  0              0.0051073107   2.6109412e-16  0              2.995215     
   1800000   146.4          200            200            0.0035803487  -6.017816e-39   0              0.010741046    1.3025751e-10  0              0.0006289669   2.6109412e-16  0              2.995215     
   1900000   146.4          200            200            0.0035803472  -6.2034812e-39  0              0.010741042    1.5314381e-11  0              7.3947665e-05  2.6109412e-16  0              2.995215     
   2000000   146.4          200            200            0.0035803465  -7.7558899e-39  0              0.010741039    1.7067355e-12  0              8.2412151e-06  2.6109412e-16  0              2.995215     
   2100000   146.4          200            200            0.0035803461  -6.7118188e-41  0              0.010741038    1.782111e-13   0              8.6051763e-07  2.6109412e-16  0              2.995215     
   2200000   146.4          200            200            0.0035803459   1.902087e-38   0              0.010741038    1.7105958e-14  0              8.2598547e-08  2.6109412e-16  0              2.995215     
   2300000   146.4          200            200            0.0035803459   2.0107821e-38  0              0.010741038    1.4567987e-15  0              7.0343595e-09  2.6109412e-16  0              2.995215     
   2400000   146.4          200            200            0.0035803458  -9.4649784e-40  0              0.010741037    9.9265739e-17  0              4.7931873e-10  2.6109412e-16  0              2.995215     
   2500000   146.4          200            200            0.0035803458   1.9078009e-38  0              0.010741037    4.3784572e-18  0              2.1142003e-11  2.6109412e-16  0              2.995215     
   2600000   146.4          200            200            0.0035803458   2.3825588e-39  0              0.010741037    7.0326221e-21  0              3.3958015e-14  2.6109412e-16  0              2.995215     
   2700000   146.4          200            200            0.0035803458  -3.2003149e-38  0              0.010741037    1.8600259e-20  0              8.9813993e-14  2.6109412e-16  0              2.995215     
   2800000   146.4          200            200            0.0035803458   6.5216254e-39  0              0.010741037    3.509205e-20   0              1.6944695e-13  2.6109412e-16  0              2.995215     
   2900000   146.4          200            200            0.0035803458   4.4386733e-38  0              0.010741037    2.5382937e-20  0              1.2256512e-13  2.6109412e-16  0              2.995215     
   3000000   146.4          200            200            0.0035803458  -4.5996452e-39  0              0.010741037    1.0729771e-19  0              5.1810223e-13  2.6109412e-16  0              2.995215     
Loop time of 64.2176 on 4 procs for 3000000 steps with 51 atoms

Performance: 40362766.209 ns/day, 0.000 hours/ns, 46716.165 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 0.31884    | 1.6076     | 5.3165     | 168.9 |  2.50
Neigh   | 0.075358   | 0.075925   | 0.077421   |   0.3 |  0.12
Comm    | 25.769     | 32.28      | 38.1       |  83.3 | 50.27
Output  | 0.061037   | 0.061113   | 0.061164   |   0.0 |  0.10
Modify  | 15.21      | 20.994     | 28.214     | 120.2 | 32.69
Other   |            | 9.199      |            |       | 14.33

Nlocal:          12.75 ave          51 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1
Nghost:          39.25 ave          52 max           1 min
Histogram: 1 0 0 0 0 0 0 0 0 3
Neighs:           7.25 ave          29 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1

Total # of neighbors = 29
Ave neighs/atom = 0.56862745
Neighbor list builds = 166
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 38

#variable lat0 equal 1                    #
variable lat1 equal 3+(151*0.01)+(v_ind*0.01)  # .491+(v_ind*0.001)       # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 10*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.89                                                               
Lattice spacing in x,y,z = 4.89 4.89 4.89

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -73.35 ${n1e1} -100 100 -100 100 units box
region box block -73.35 73.35 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -73.35 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -73.35 73.35 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-73.35 -100 -100) to (73.35 100 100)
  1 by 2 by 2 MPI processor grid
create_atoms 1 region substrate
Created 30 atoms
  using lattice units in orthogonal box = (-73.35 -100 -100) to (73.35 100 100)
  create_atoms CPU = 0.000 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 30 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 21 atoms
  using lattice units in orthogonal box = (-73.35 -100 -100) to (73.35 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  30 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  30 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  21 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  21 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
30 atoms in group substrate
group slider1 region slider1
21 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 21 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_38_*.dump id type diameter mass xu yu zu fx fy fz

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 95 130 130
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 14.57 | 18.04 | 19.2 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   146.7          200            200            0              0              0              0              0              0              0              2.6109412e-16  0              6            
    100000   146.7          200            200            0.0028907089   3.0428245e-40  0              0.0086721268   12171.779      0              5.8773165e+10  2.6109412e-16  0              3.3285896    
    200000   146.7          200            200            0.00097717679 -5.2465939e-37  0              0.0029315304   2754.7579      0              1.330174e+10   2.6109412e-16  0              3.0822185    
    300000   146.7          200            200           -6.3660223e-05  3.8197954e-36  0             -0.00019098067  28.630934      0              1.3824853e+08  2.6109412e-16  0              3.0421254    
    400000   146.7          200            200            0.0048824855   1.2592545e-35  0              0.014647456    190.70808      0              9.2086106e+08  2.6109412e-16  0              2.9939875    
    500000   146.7          200            200            0.0014421583  -1.3873975e-35  0              0.0043264748   14.937436      0              72127533       2.6109412e-16  0              2.9974477    
    600000   146.7          200            200            0.0023846849  -5.4542688e-36  0              0.0071540547   0.0027309571   0              13186.814      2.6109412e-16  0              2.9963459    
    700000   146.7          200            200            0.0031371978   6.2057688e-36  0              0.0094115934   0.036825457    0              177816.95      2.6109412e-16  0              2.9956107    
    800000   146.7          200            200            0.003419598   -1.6192428e-36  0              0.010258794    0.012195599    0              58888.181      2.6109412e-16  0              2.9953519    
    900000   146.7          200            200            0.0035204766  -1.9319857e-37  0              0.01056143     0.0028389477   0              13708.262      2.6109412e-16  0              2.9952615    
   1000000   146.7          200            200            0.0035555378  -5.7370232e-37  0              0.010666613    0.00056618965  0              2733.9272      2.6109412e-16  0              2.9952304    
   1100000   146.7          200            200            0.0035674001  -2.2551005e-37  0              0.0107022      0.00010235889  0              494.25443      2.6109412e-16  0              2.9952199    
   1200000   146.7          200            200            0.0035712937   6.544276e-38   0              0.010713881    1.7219023e-05  0              83.144498      2.6109412e-16  0              2.9952165    
   1300000   146.7          200            200            0.0035725246   1.2710168e-38  0              0.010717574    2.734874e-06   0              13.205728      2.6109412e-16  0              2.9952154    
   1400000   146.7          200            200            0.0035728943  -3.9684071e-39  0              0.010718683    4.1370419e-07  0              1.9976295      2.6109412e-16  0              2.9952151    
   1500000   146.7          200            200            0.0035729971  -1.4729724e-38  0              0.010718991    5.9915206e-08  0              0.28930909     2.6109412e-16  0              2.995215     
   1600000   146.7          200            200            0.003573022    1.6365182e-38  0              0.010719066    8.331724e-09   0              0.040230913    2.6109412e-16  0              2.995215     
   1700000   146.7          200            200            0.0035730262   6.5608297e-39  0              0.010719079    1.113694e-09   0              0.0053776298   2.6109412e-16  0              2.995215     
   1800000   146.7          200            200            0.0035730259  -6.1423626e-40  0              0.010719078    1.4302396e-10  0              0.00069061154  2.6109412e-16  0              2.995215     
   1900000   146.7          200            200            0.0035730251   1.6087733e-38  0              0.010719075    1.760864e-11   0              8.5025819e-05  2.6109412e-16  0              2.995215     
   2000000   146.7          200            200            0.0035730246   2.0284889e-39  0              0.010719074    2.0695033e-12  0              9.992891e-06   2.6109412e-16  0              2.995215     
   2100000   146.7          200            200            0.0035730243   3.49999e-39    0              0.010719073    2.3053592e-13  0              1.1131755e-06  2.6109412e-16  0              2.995215     
   2200000   146.7          200            200            0.0035730241   7.953355e-39   0              0.010719072    2.4051269e-14  0              1.1613497e-07  2.6109412e-16  0              2.995215     
   2300000   146.7          200            200            0.0035730241  -1.3951717e-38  0              0.010719072    2.3029469e-15  0              1.1120107e-08  2.6109412e-16  0              2.995215     
   2400000   146.7          200            200            0.0035730241   2.6077376e-38  0              0.010719072    1.9283542e-16  0              9.3113321e-10  2.6109412e-16  0              2.995215     
   2500000   146.7          200            200            0.003573024   -3.9927107e-38  0              0.010719072    1.2861218e-17  0              6.2102217e-11  2.6109412e-16  0              2.995215     
   2600000   146.7          200            200            0.003573024    3.3878561e-38  0              0.010719072    4.2545331e-19  0              2.0543618e-12  2.6109412e-16  0              2.995215     
   2700000   146.7          200            200            0.003573024    1.4421431e-38  0              0.010719072    6.1723016e-21  0              2.9803835e-14  2.6109412e-16  0              2.995215     
   2800000   146.7          200            200            0.003573024    2.7826883e-38  0              0.010719072    1.260895e-20   0              6.0884107e-14  2.6109412e-16  0              2.995215     
   2900000   146.7          200            200            0.003573024   -2.4530393e-38  0              0.010719072    4.8246844e-21  0              2.3296674e-14  2.6109412e-16  0              2.995215     
   3000000   146.7          200            200            0.003573024   -1.8611333e-38  0              0.010719072    1.2950024e-19  0              6.253103e-13   2.6109412e-16  0              2.995215     
Loop time of 64.0686 on 4 procs for 3000000 steps with 51 atoms

Performance: 40456654.964 ns/day, 0.000 hours/ns, 46824.832 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 0.32914    | 1.583      | 5.2104     | 166.5 |  2.47
Neigh   | 0.075293   | 0.075857   | 0.077382   |   0.3 |  0.12
Comm    | 25.76      | 32.137     | 37.877     |  82.5 | 50.16
Output  | 0.060035   | 0.060112   | 0.060166   |   0.0 |  0.09
Modify  | 15.35      | 21.058     | 28.177     | 119.5 | 32.87
Other   |            | 9.154      |            |       | 14.29

Nlocal:          12.75 ave          51 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1
Nghost:          39.25 ave          52 max           1 min
Histogram: 1 0 0 0 0 0 0 0 0 3
Neighs:           7.25 ave          29 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1

Total # of neighbors = 29
Ave neighs/atom = 0.56862745
Neighbor list builds = 166
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 39

#variable lat0 equal 1                    #
variable lat1 equal 3+(151*0.01)+(v_ind*0.01)  # .491+(v_ind*0.001)       # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 10*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.9                                                               
Lattice spacing in x,y,z = 4.9 4.9 4.9

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -73.5 ${n1e1} -100 100 -100 100 units box
region box block -73.5 73.5 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -73.5 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -73.5 73.5 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-73.5 -100 -100) to (73.5 100 100)
  1 by 2 by 2 MPI processor grid
create_atoms 1 region substrate
Created 30 atoms
  using lattice units in orthogonal box = (-73.5 -100 -100) to (73.5 100 100)
  create_atoms CPU = 0.000 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 30 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 21 atoms
  using lattice units in orthogonal box = (-73.5 -100 -100) to (73.5 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  30 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  30 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  21 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  21 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
30 atoms in group substrate
group slider1 region slider1
21 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 21 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_39_*.dump id type diameter mass xu yu zu fx fy fz

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 95 130 130
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 14.57 | 18.04 | 19.2 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   147            200            200            0              0              0              0              0              0              0              2.6109412e-16  0              6            
    100000   147            200            200            0.0028829264  -6.2885772e-39  0              0.0086487792   12156.146      0              5.8697676e+10  2.6109412e-16  0              3.3304846    
    200000   147            200            200            0.00097936174  3.8780467e-39  0              0.0029380852   2772.6878      0              1.3388317e+10  2.6109412e-16  0              3.0821834    
    300000   147            200            200           -3.0928559e-05  3.6372026e-38  0             -9.2785676e-05  6.4124903      0              30963621       2.6109412e-16  0              3.0435794    
    400000   147            200            200            0.0013423165   2.3668787e-35  0              0.0040269495   180.2245       0              8.7023959e+08  2.6109412e-16  0              2.9973306    
    500000   147            200            200            0.0022112834  -1.7133417e-36  0              0.0066338502   23.985402      0              1.1581692e+08  2.6109412e-16  0              2.9965876    
    600000   147            200            200            0.0024385773   2.9877344e-35  0              0.0073157319   0.37703302     0              1820557.5      2.6109412e-16  0              2.9962943    
    700000   147            200            200            0.0031190419  -5.6878779e-36  0              0.0093571256   0.0037704724   0              18206.262      2.6109412e-16  0              2.9956246    
    800000   147            200            200            0.0033994234  -1.6816227e-37  0              0.01019827     0.00035211587  0              1700.2415      2.6109412e-16  0              2.9953649    
    900000   147            200            200            0.0035054791  -7.7526143e-38  0              0.010516437    0.00044012682  0              2125.2149      2.6109412e-16  0              2.9952689    
   1000000   147            200            200            0.0035443946   2.9345489e-38  0              0.010633184    0.00016108419  0              777.81789      2.6109412e-16  0              2.995234     
   1100000   147            200            200            0.0035583481   1.8362497e-38  0              0.010675044    4.1001944e-05  0              197.98371      2.6109412e-16  0              2.9952216    
   1200000   147            200            200            0.0035632412   4.4469873e-39  0              0.010689724    8.6835623e-06  0              41.929815      2.6109412e-16  0              2.9952172    
   1300000   147            200            200            0.0035649168  -8.0135157e-39  0              0.01069475     1.6387528e-06  0              7.9129509      2.6109412e-16  0              2.9952157    
   1400000   147            200            200            0.0035654753   1.4871936e-38  0              0.010696426    2.8493693e-07  0              1.3758584      2.6109412e-16  0              2.9952152    
   1500000   147            200            200            0.0035656554  -1.4944087e-38  0              0.010696966    4.649781e-08   0              0.22452128     2.6109412e-16  0              2.9952151    
   1600000   147            200            200            0.003565711    2.439376e-38   0              0.010697133    7.2000632e-09  0              0.034766528    2.6109412e-16  0              2.995215     
   1700000   147            200            200            0.0035657271   5.8956883e-39  0              0.010697181    1.0650381e-09  0              0.005142688    2.6109412e-16  0              2.995215     
   1800000   147            200            200            0.0035657314  -1.2173855e-38  0              0.010697194    1.5109072e-10  0              0.000729563    2.6109412e-16  0              2.995215     
   1900000   147            200            200            0.0035657323   1.0153527e-38  0              0.010697197    2.0596419e-11  0              9.9452738e-05  2.6109412e-16  0              2.995215     
   2000000   147            200            200            0.0035657323   1.5960906e-39  0              0.010697197    2.6987734e-12  0              1.3031411e-05  2.6109412e-16  0              2.995215     
   2100000   147            200            200            0.0035657323  -1.0545111e-38  0              0.010697197    3.3945213e-13  0              1.6390929e-06  2.6109412e-16  0              2.995215     
   2200000   147            200            200            0.0035657322   1.1504562e-38  0              0.010697197    4.0855654e-14  0              1.9727733e-07  2.6109412e-16  0              2.995215     
   2300000   147            200            200            0.0035657322   1.7483025e-38  0              0.010697197    4.6754772e-15  0              2.2576206e-08  2.6109412e-16  0              2.995215     
   2400000   147            200            200            0.0035657322  -5.1352783e-39  0              0.010697197    5.0523335e-16  0              2.439591e-09   2.6109412e-16  0              2.995215     
   2500000   147            200            200            0.0035657322   1.4977359e-38  0              0.010697196    4.9442566e-17  0              2.3874046e-10  2.6109412e-16  0              2.995215     
   2600000   147            200            200            0.0035657322   1.4993074e-38  0              0.010697196    3.9484642e-18  0              1.9065721e-11  2.6109412e-16  0              2.995215     
   2700000   147            200            200            0.0035657322  -1.1313057e-38  0              0.010697196    3.6878707e-19  0              1.7807408e-12  2.6109412e-16  0              2.995215     
   2800000   147            200            200            0.0035657322   7.4001254e-39  0              0.010697196    1.7304084e-21  0              8.3555229e-15  2.6109412e-16  0              2.995215     
   2900000   147            200            200            0.0035657322  -3.3606277e-38  0              0.010697196    1.182649e-19   0              5.7105886e-13  2.6109412e-16  0              2.995215     
   3000000   147            200            200            0.0035657322   1.0388142e-38  0              0.010697196    4.8214158e-21  0              2.3280891e-14  2.6109412e-16  0              2.995215     
Loop time of 64.2499 on 4 procs for 3000000 steps with 51 atoms

Performance: 40342444.707 ns/day, 0.000 hours/ns, 46692.644 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 0.33378    | 1.5632     | 5.1364     | 165.0 |  2.43
Neigh   | 0.075352   | 0.075869   | 0.077341   |   0.3 |  0.12
Comm    | 25.886     | 32.252     | 37.978     |  82.4 | 50.20
Output  | 0.061191   | 0.06127    | 0.061326   |   0.0 |  0.10
Modify  | 15.413     | 21.134     | 28.24      | 119.4 | 32.89
Other   |            | 9.164      |            |       | 14.26

Nlocal:          12.75 ave          51 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1
Nghost:          39.25 ave          52 max           1 min
Histogram: 1 0 0 0 0 0 0 0 0 3
Neighs:           6.75 ave          27 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1

Total # of neighbors = 27
Ave neighs/atom = 0.52941176
Neighbor list builds = 166
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 40

#variable lat0 equal 1                    #
variable lat1 equal 3+(151*0.01)+(v_ind*0.01)  # .491+(v_ind*0.001)       # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 10*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.91                                                               
Lattice spacing in x,y,z = 4.91 4.91 4.91

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -73.65 ${n1e1} -100 100 -100 100 units box
region box block -73.65 73.65 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -73.65 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -73.65 73.65 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-73.65 -100 -100) to (73.65 100 100)
  1 by 2 by 2 MPI processor grid
create_atoms 1 region substrate
Created 30 atoms
  using lattice units in orthogonal box = (-73.65 -100 -100) to (73.65 100 100)
  create_atoms CPU = 0.000 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 30 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 21 atoms
  using lattice units in orthogonal box = (-73.65 -100 -100) to (73.65 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  30 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  30 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  21 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  21 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
30 atoms in group substrate
group slider1 region slider1
21 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 21 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_40_*.dump id type diameter mass xu yu zu fx fy fz

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 96 130 130
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 14.59 | 18.06 | 19.22 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   147.3          200            200            0              0              0              0              0              0              0              2.6109412e-16  0              6            
    100000   147.3          200            200            0.0028774934  -2.5093694e-38  0              0.0086324803   12155.707      0              5.8695559e+10  2.6109412e-16  0              3.3316274    
    200000   147.3          200            200            0.00098487607 -5.3508811e-37  0              0.0029546282   2805.6989      0              1.3547716e+10  2.6109412e-16  0              3.081419     
    300000   147.3          200            200            1.4795824e-06 -4.9943023e-37  0              4.4387471e-06  0.015501772    0              74852.51       2.6109412e-16  0              3.0445065    
    400000   147.3          200            200           -9.6640468e-05  5.4239451e-36  0             -0.00028992141  72.849181      0              3.5176262e+08  2.6109412e-16  0              3.0028005    
    500000   147.3          200            200            0.004448288    5.5294067e-36  0              0.013344864    27.723178      0              1.3386531e+08  2.6109412e-16  0              2.9945029    
    600000   147.3          200            200            0.0029101534   2.7628546e-36  0              0.0087304601   2.8267454      0              13649342       2.6109412e-16  0              2.9958361    
    700000   147.3          200            200            0.0032417367   3.8143486e-36  0              0.00972521     0.2688541      0              1298200.2      2.6109412e-16  0              2.9955095    
    800000   147.3          200            200            0.0034252615  -1.1585022e-36  0              0.010275785    0.025736206    0              124270.93      2.6109412e-16  0              2.9953371    
    900000   147.3          200            200            0.0035047031  -7.7482737e-37  0              0.010514109    0.0022257025   0              10747.121      2.6109412e-16  0              2.9952639    
   1000000   147.3          200            200            0.0035373507   3.7112436e-37  0              0.010612052    0.00016033889  0              774.21911      2.6109412e-16  0              2.9952341    
   1100000   147.3          200            200            0.0035503635   2.3785853e-37  0              0.01065109     8.0517844e-06  0              38.879185      2.6109412e-16  0              2.9952223    
   1200000   147.3          200            200            0.0035554229  -1.203522e-39   0              0.010666269    1.2470443e-07  0              0.60215308     2.6109412e-16  0              2.9952178    
   1300000   147.3          200            200            0.0035573473  -1.9038446e-38  0              0.010672042    1.6075828e-08  0              0.077624419    2.6109412e-16  0              2.995216     
   1400000   147.3          200            200            0.0035580645   3.5982785e-39  0              0.010674193    1.9644749e-08  0              0.094857463    2.6109412e-16  0              2.9952154    
   1500000   147.3          200            200            0.0035583265   1.2069038e-38  0              0.010674979    7.2162741e-09  0              0.034844805    2.6109412e-16  0              2.9952151    
   1600000   147.3          200            200            0.0035584203   1.9745987e-39  0              0.010675261    1.8419508e-09  0              0.0088941213   2.6109412e-16  0              2.9952151    
   1700000   147.3          200            200            0.0035584532   1.0804885e-38  0              0.01067536     3.9085491e-10  0              0.0018872985   2.6109412e-16  0              2.995215     
   1800000   147.3          200            200            0.0035584645  -6.6229387e-39  0              0.010675393    7.3866551e-11  0              0.00035667514  2.6109412e-16  0              2.995215     
   1900000   147.3          200            200            0.0035584682   1.6134615e-38  0              0.010675405    1.2858328e-11  0              6.2088262e-05  2.6109412e-16  0              2.995215     
   2000000   147.3          200            200            0.0035584695  -2.4930257e-39  0              0.010675408    2.1000743e-12  0              1.0140507e-05  2.6109412e-16  0              2.995215     
   2100000   147.3          200            200            0.0035584698  -2.064174e-38   0              0.010675409    3.255027e-13   0              1.5717361e-06  2.6109412e-16  0              2.995215     
   2200000   147.3          200            200            0.0035584699   1.1932504e-38  0              0.01067541     4.8177067e-14  0              2.3262981e-07  2.6109412e-16  0              2.995215     
   2300000   147.3          200            200            0.00355847     5.3102276e-39  0              0.01067541     6.8385677e-15  0              3.3020996e-08  2.6109412e-16  0              2.995215     
   2400000   147.3          200            200            0.00355847    -1.3271558e-38  0              0.01067541     9.32857e-16    0              4.5044326e-09  2.6109412e-16  0              2.995215     
   2500000   147.3          200            200            0.00355847    -8.2058752e-39  0              0.01067541     1.2238885e-16  0              5.9097195e-10  2.6109412e-16  0              2.995215     
   2600000   147.3          200            200            0.00355847     1.8462332e-38  0              0.01067541     1.496892e-17   0              7.2279559e-11  2.6109412e-16  0              2.995215     
   2700000   147.3          200            200            0.00355847    -1.0619903e-38  0              0.01067541     1.8458773e-18  0              8.9130809e-12  2.6109412e-16  0              2.995215     
   2800000   147.3          200            200            0.00355847    -7.5352462e-39  0              0.01067541     1.2393151e-19  0              5.9842093e-13  2.6109412e-16  0              2.995215     
   2900000   147.3          200            200            0.00355847     1.3130492e-38  0              0.01067541     1.1501343e-19  0              5.5535869e-13  2.6109412e-16  0              2.995215     
   3000000   147.3          200            200            0.00355847    -2.5963554e-38  0              0.01067541     5.2394125e-22  0              2.5299248e-15  2.6109412e-16  0              2.995215     
Loop time of 64.4246 on 4 procs for 3000000 steps with 51 atoms

Performance: 40233108.394 ns/day, 0.000 hours/ns, 46566.098 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 0.32599    | 1.5942     | 5.2238     | 166.1 |  2.47
Neigh   | 0.076044   | 0.076629   | 0.078226   |   0.3 |  0.12
Comm    | 25.765     | 32.341     | 38.143     |  84.1 | 50.20
Output  | 0.06167    | 0.061749   | 0.061805   |   0.0 |  0.10
Modify  | 15.38      | 21.182     | 28.439     | 120.5 | 32.88
Other   |            | 9.169      |            |       | 14.23

Nlocal:          12.75 ave          51 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1
Nghost:          39.25 ave          52 max           1 min
Histogram: 1 0 0 0 0 0 0 0 0 3
Neighs:           6.75 ave          27 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1

Total # of neighbors = 27
Ave neighs/atom = 0.52941176
Neighbor list builds = 166
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 41

#variable lat0 equal 1                    #
variable lat1 equal 3+(151*0.01)+(v_ind*0.01)  # .491+(v_ind*0.001)       # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 10*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.92                                                               
Lattice spacing in x,y,z = 4.92 4.92 4.92

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -73.8 ${n1e1} -100 100 -100 100 units box
region box block -73.8 73.8 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -73.8 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -73.8 73.8 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-73.8 -100 -100) to (73.8 100 100)
  1 by 2 by 2 MPI processor grid
create_atoms 1 region substrate
Created 30 atoms
  using lattice units in orthogonal box = (-73.8 -100 -100) to (73.8 100 100)
  create_atoms CPU = 0.000 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 30 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 21 atoms
  using lattice units in orthogonal box = (-73.8 -100 -100) to (73.8 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  30 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  30 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  21 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  21 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
30 atoms in group substrate
group slider1 region slider1
21 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 21 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_41_*.dump id type diameter mass xu yu zu fx fy fz

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 96 130 130
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 14.59 | 18.06 | 19.22 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   147.6          200            200            0              0              0              0              0              0              0              2.6109412e-16  0              6            
    100000   147.6          200            200            0.0028774517   4.1764046e-39  0              0.008632355    12193.066      0              5.8875951e+10  2.6109412e-16  0              3.330044     
    200000   147.6          200            200            0.00099300978 -3.3255919e-38  0              0.0029790293   2850.8939      0              1.3765947e+10  2.6109412e-16  0              3.0799891    
    300000   147.6          200            200            2.9497146e-05  5.4523979e-37  0              8.8491438e-05  5.4290645      0              26215010       2.6109412e-16  0              3.0450362    
    400000   147.6          200            200            8.4119249e-06  3.7853874e-36  0              2.5235775e-05  0.47202387     0              2279234.3      2.6109412e-16  0              3.0064435    
    500000   147.6          200            200            0.0069851921   1.5662957e-35  0              0.020955576    2.5672582      0              12396371       2.6109412e-16  0              2.9924698    
    600000   147.6          200            200            0.0045640757  -2.6898022e-35  0              0.013692227    1.4736964      0              7115952.7      2.6109412e-16  0              2.9943551    
    700000   147.6          200            200            0.0038467542   1.4975843e-36  0              0.011540263    0.32101577     0              1550070.3      2.6109412e-16  0              2.9949589    
    800000   147.6          200            200            0.0036395414  -9.1358992e-37  0              0.010918624    0.05364896     0              259051.63      2.6109412e-16  0              2.9951385    
    900000   147.6          200            200            0.0035761303   1.1784784e-37  0              0.010728391    0.0083912106   0              40518.153      2.6109412e-16  0              2.9951937    
   1000000   147.6          200            200            0.0035574414   8.7775635e-38  0              0.010672324    0.0012530807   0              6050.6784      2.6109412e-16  0              2.9952098    
   1100000   147.6          200            200            0.0035523869  -1.2852095e-39  0              0.010657161    0.0001794469   0              866.48486      2.6109412e-16  0              2.9952141    
   1200000   147.6          200            200            0.0035512347   1.0865461e-38  0              0.010653704    2.4691136e-05  0              119.22466      2.6109412e-16  0              2.9952151    
   1300000   147.6          200            200            0.0035510797   1.1509919e-38  0              0.010653239    3.2659895e-06  0              15.770295      2.6109412e-16  0              2.9952152    
   1400000   147.6          200            200            0.0035511228  -5.2429082e-39  0              0.010653369    4.1489349e-07  0              2.0033722      2.6109412e-16  0              2.9952151    
   1500000   147.6          200            200            0.0035511752  -1.3815597e-38  0              0.010653526    5.0482782e-08  0              0.24376329     2.6109412e-16  0              2.9952151    
   1600000   147.6          200            200            0.0035512076  -5.211359e-39   0              0.010653623    5.8547682e-09  0              0.028270581    2.6109412e-16  0              2.995215     
   1700000   147.6          200            200            0.0035512241   4.2967873e-40  0              0.010653672    6.4196399e-10  0              0.0030998143   2.6109412e-16  0              2.995215     
   1800000   147.6          200            200            0.0035512317   9.5305536e-39  0              0.010653695    6.5665615e-11  0              0.00031707575  2.6109412e-16  0              2.995215     
   1900000   147.6          200            200            0.003551235   -5.1021199e-39  0              0.010653705    6.123676e-12   0              2.956904e-05   2.6109412e-16  0              2.995215     
   2000000   147.6          200            200            0.0035512364   1.4613367e-39  0              0.010653709    4.9867245e-13  0              2.4079108e-06  2.6109412e-16  0              2.995215     
   2100000   147.6          200            200            0.003551237    1.0472366e-39  0              0.010653711    3.2253491e-14  0              1.5574057e-07  2.6109412e-16  0              2.995215     
   2200000   147.6          200            200            0.0035512372   2.0334742e-39  0              0.010653712    1.2444566e-15  0              6.0090355e-09  2.6109412e-16  0              2.995215     
   2300000   147.6          200            200            0.0035512373   9.1385992e-39  0              0.010653712    2.0454436e-18  0              9.8767153e-12  2.6109412e-16  0              2.995215     
   2400000   147.6          200            200            0.0035512373   1.3002923e-38  0              0.010653712    1.3088086e-17  0              6.3197683e-11  2.6109412e-16  0              2.995215     
   2500000   147.6          200            200            0.0035512373   2.6924838e-39  0              0.010653712    7.7002593e-18  0              3.7181797e-11  2.6109412e-16  0              2.995215     
   2600000   147.6          200            200            0.0035512373   9.5556212e-39  0              0.010653712    2.7884313e-18  0              1.3464337e-11  2.6109412e-16  0              2.995215     
   2700000   147.6          200            200            0.0035512373   2.1100763e-38  0              0.010653712    6.7501782e-19  0              3.2594195e-12  2.6109412e-16  0              2.995215     
   2800000   147.6          200            200            0.0035512373   1.8738941e-39  0              0.010653712    1.920875e-19   0              9.275218e-13   2.6109412e-16  0              2.995215     
   2900000   147.6          200            200            0.0035512373   1.663475e-38   0              0.010653712    3.1227738e-23  0              1.5078757e-16  2.6109412e-16  0              2.995215     
   3000000   147.6          200            200            0.0035512373   1.1145498e-38  0              0.010653712    1.4521892e-19  0              7.0121021e-13  2.6109412e-16  0              2.995215     
Loop time of 64.1519 on 4 procs for 3000000 steps with 51 atoms

Performance: 40404103.956 ns/day, 0.000 hours/ns, 46764.009 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 0.33492    | 1.5494     | 5.0594     | 162.9 |  2.42
Neigh   | 0.075175   | 0.075726   | 0.07723    |   0.3 |  0.12
Comm    | 25.748     | 32.223     | 37.929     |  83.2 | 50.23
Output  | 0.062494   | 0.062574   | 0.062627   |   0.0 |  0.10
Modify  | 15.38      | 21.117     | 28.302     | 120.0 | 32.92
Other   |            | 9.124      |            |       | 14.22

Nlocal:          12.75 ave          51 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1
Nghost:          39.25 ave          52 max           1 min
Histogram: 1 0 0 0 0 0 0 0 0 3
Neighs:           6.75 ave          27 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1

Total # of neighbors = 27
Ave neighs/atom = 0.52941176
Neighbor list builds = 164
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 42

#variable lat0 equal 1                    #
variable lat1 equal 3+(151*0.01)+(v_ind*0.01)  # .491+(v_ind*0.001)       # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 10*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.93                                                               
Lattice spacing in x,y,z = 4.93 4.93 4.93

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -73.95 ${n1e1} -100 100 -100 100 units box
region box block -73.95 73.95 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -73.95 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -73.95 73.95 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-73.95 -100 -100) to (73.95 100 100)
  1 by 2 by 2 MPI processor grid
create_atoms 1 region substrate
Created 30 atoms
  using lattice units in orthogonal box = (-73.95 -100 -100) to (73.95 100 100)
  create_atoms CPU = 0.000 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 30 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 21 atoms
  using lattice units in orthogonal box = (-73.95 -100 -100) to (73.95 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  30 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  30 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  21 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  21 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
30 atoms in group substrate
group slider1 region slider1
21 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 21 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_42_*.dump id type diameter mass xu yu zu fx fy fz

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 96 130 130
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 14.59 | 18.06 | 19.22 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   147.9          200            200            0              0              0              0              0              0              0              2.6109412e-16  0              6            
    100000   147.9          200            200            0.0028782872   3.336493e-38   0              0.0086348615   12236.124      0              5.9083864e+10  2.6109412e-16  0              3.328219     
    200000   147.9          200            200            0.0010026696  -8.3323943e-38  0              0.0030080088   2903.4943      0              1.4019935e+10  2.6109412e-16  0              3.0781466    
    300000   147.9          200            200            5.1657033e-05  5.3547147e-37  0              0.0001549711   16.187602      0              78164136       2.6109412e-16  0              3.0454095    
    400000   147.9          200            200            0.00012209025  2.1596816e-36  0              0.00036627074  84.775323      0              4.0934969e+08  2.6109412e-16  0              3.0028112    
    500000   147.9          200            200            0.0011437988   2.6851258e-36  0              0.0034313965   9.7565933      0              47111097       2.6109412e-16  0              2.9978016    
    600000   147.9          200            200            0.0023898136   4.8569976e-36  0              0.0071694407   0.1458888      0              704444.8       2.6109412e-16  0              2.9963166    
    700000   147.9          200            200            0.0031386708  -1.9748313e-36  0              0.0094160123   0.094890343    0              458191.51      2.6109412e-16  0              2.9955841    
    800000   147.9          200            200            0.0034059731   8.9762124e-37  0              0.010217919    0.022591577    0              109086.64      2.6109412e-16  0              2.9953386    
    900000   147.9          200            200            0.0034983907  -2.2902844e-37  0              0.010495172    0.0044342482   0              21411.398      2.6109412e-16  0              2.9952555    
   1000000   147.9          200            200            0.0035294809   1.9101032e-37  0              0.010588443    0.00078899813  0              3809.7896      2.6109412e-16  0              2.9952278    
   1100000   147.9          200            200            0.0035396103  -2.143005e-38   0              0.010618831    0.00013096754  0              632.3954       2.6109412e-16  0              2.9952189    
   1200000   147.9          200            200            0.0035427808   2.296754e-38   0              0.010628342    2.0566334e-05  0              99.307468      2.6109412e-16  0              2.9952161    
   1300000   147.9          200            200            0.0035437196   1.2452352e-39  0              0.010631159    3.0799515e-06  0              14.871984      2.6109412e-16  0              2.9952153    
   1400000   147.9          200            200            0.0035439746   3.3169175e-39  0              0.010631924    4.4194629e-07  0              2.1340005      2.6109412e-16  0              2.9952151    
   1500000   147.9          200            200            0.0035440332  -2.3570349e-39  0              0.0106321      6.0913435e-08  0              0.29412918     2.6109412e-16  0              2.995215     
   1600000   147.9          200            200            0.0035440415  -7.3961852e-40  0              0.010632124    8.0704812e-09  0              0.038969465    2.6109412e-16  0              2.995215     
   1700000   147.9          200            200            0.0035440395   3.1557431e-39  0              0.010632119    1.0269716e-09  0              0.0049588785   2.6109412e-16  0              2.995215     
   1800000   147.9          200            200            0.003544037    9.0913763e-40  0              0.010632111    1.2518979e-10  0              0.00060449671  2.6109412e-16  0              2.995215     
   1900000   147.9          200            200            0.0035440354  -1.4567831e-40  0              0.010632106    1.4549564e-11  0              7.0254637e-05  2.6109412e-16  0              2.995215     
   2000000   147.9          200            200            0.0035440346  -2.0934614e-39  0              0.010632104    1.5992969e-12  0              7.7224323e-06  2.6109412e-16  0              2.995215     
   2100000   147.9          200            200            0.0035440343   2.3734966e-39  0              0.010632103    1.6406679e-13  0              7.9221981e-07  2.6109412e-16  0              2.995215     
   2200000   147.9          200            200            0.0035440341   1.0141069e-38  0              0.010632102    1.5376628e-14  0              7.4248233e-08  2.6109412e-16  0              2.995215     
   2300000   147.9          200            200            0.003544034    5.596458e-39   0              0.010632102    1.2639769e-15  0              6.1032919e-09  2.6109412e-16  0              2.995215     
   2400000   147.9          200            200            0.003544034   -1.1246392e-38  0              0.010632102    8.5340139e-17  0              4.1207699e-10  2.6109412e-16  0              2.995215     
   2500000   147.9          200            200            0.003544034   -4.953088e-39   0              0.010632102    3.7928981e-18  0              1.8314548e-11  2.6109412e-16  0              2.995215     
   2600000   147.9          200            200            0.003544034   -4.6764539e-39  0              0.010632102    4.7048226e-21  0              2.2717904e-14  2.6109412e-16  0              2.995215     
   2700000   147.9          200            200            0.003544034    1.8236736e-41  0              0.010632102    6.0447825e-20  0              2.9188091e-13  2.6109412e-16  0              2.995215     
   2800000   147.9          200            200            0.003544034    1.019127e-38   0              0.010632102    5.8021297e-20  0              2.8016408e-13  2.6109412e-16  0              2.995215     
   2900000   147.9          200            200            0.003544034   -6.4316191e-39  0              0.010632102    7.7636854e-21  0              3.7488058e-14  2.6109412e-16  0              2.995215     
   3000000   147.9          200            200            0.003544034   -1.9086962e-39  0              0.010632102    1.2078421e-19  0              5.8322372e-13  2.6109412e-16  0              2.995215     
Loop time of 64.1489 on 4 procs for 3000000 steps with 51 atoms

Performance: 40405965.495 ns/day, 0.000 hours/ns, 46766.164 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 0.32333    | 1.5386     | 4.9981     | 161.1 |  2.40
Neigh   | 0.075177   | 0.075765   | 0.077258   |   0.3 |  0.12
Comm    | 25.791     | 32.254     | 37.955     |  83.0 | 50.28
Output  | 0.058702   | 0.058776   | 0.058827   |   0.0 |  0.09
Modify  | 15.286     | 21.03      | 28.154     | 119.4 | 32.78
Other   |            | 9.192      |            |       | 14.33

Nlocal:          12.75 ave          51 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1
Nghost:          39.25 ave          52 max           1 min
Histogram: 1 0 0 0 0 0 0 0 0 3
Neighs:           6.75 ave          27 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1

Total # of neighbors = 27
Ave neighs/atom = 0.52941176
Neighbor list builds = 164
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 43

#variable lat0 equal 1                    #
variable lat1 equal 3+(151*0.01)+(v_ind*0.01)  # .491+(v_ind*0.001)       # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 10*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.94                                                               
Lattice spacing in x,y,z = 4.94 4.94 4.94

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -74.1 ${n1e1} -100 100 -100 100 units box
region box block -74.1 74.1 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -74.1 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -74.1 74.1 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-74.1 -100 -100) to (74.1 100 100)
  1 by 2 by 2 MPI processor grid
create_atoms 1 region substrate
Created 29 atoms
  using lattice units in orthogonal box = (-74.1 -100 -100) to (74.1 100 100)
  create_atoms CPU = 0.000 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 30 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 21 atoms
  using lattice units in orthogonal box = (-74.1 -100 -100) to (74.1 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  29 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  29 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  21 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  21 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
29 atoms in group substrate
group slider1 region slider1
21 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 21 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_43_*.dump id type diameter mass xu yu zu fx fy fz

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 96 130 130
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 14.59 | 18.06 | 19.22 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   148.2          200            200            0              0              0              0              0              0              0              2.6109412e-16  0              6            
    100000   148.2          200            200            0.0028787645  -1.9952591e-37  0              0.0086362934   12276.065      0              6.5863028e+10  2.6109412e-16  0              3.3268235    
    200000   148.2          200            200            0.0010166782  -8.3098528e-39  0              0.0030500346   2976.7796      0              1.5970892e+10  2.6109412e-16  0              3.0751758    
    300000   148.2          200            200            7.0046131e-05  5.3555598e-37  0              0.00021013839  29.149913      0              1.5639389e+08  2.6109412e-16  0              3.0457214    
    400000   148.2          200            200            0.0025825766   8.6046415e-36  0              0.0077477298   207.14943      0              1.1113894e+09  2.6109412e-16  0              2.9963224    
    500000   148.2          200            200            0.00096267989 -1.4493643e-35  0              0.0028880397   7.6762878      0              41184496       2.6109412e-16  0              2.99804      
    600000   148.2          200            200            0.0028747826  -1.3238774e-37  0              0.0086243478   2.8022562      0              15034547       2.6109412e-16  0              2.9958137    
    700000   148.2          200            200            0.0032213418  -2.5007066e-36  0              0.0096640254   0.27008059     0              1449025        2.6109412e-16  0              2.9954984    
    800000   148.2          200            200            0.0034397275   2.1655708e-37  0              0.010319183    0.047933386    0              257170.18      2.6109412e-16  0              2.9953007    
    900000   148.2          200            200            0.0035084555   1.6324453e-37  0              0.010525367    0.0077520393   0              41590.915      2.6109412e-16  0              2.9952397    
   1000000   148.2          200            200            0.003529284    1.5360001e-38  0              0.010587852    0.0011858988   0              6362.5346      2.6109412e-16  0              2.9952215    
   1100000   148.2          200            200            0.003535181    2.1613163e-38  0              0.010605543    0.00017333624  0              929.97628      2.6109412e-16  0              2.9952164    
   1200000   148.2          200            200            0.0035366614   1.0785382e-39  0              0.010609984    2.4308686e-05  0              130.41994      2.6109412e-16  0              2.9952151    
   1300000   148.2          200            200            0.0035369424  -1.6171056e-39  0              0.010610827    3.2763547e-06  0              17.57816       2.6109412e-16  0              2.9952149    
   1400000   148.2          200            200            0.0035369468   1.7081045e-39  0              0.01061084     4.2435869e-07  0              2.2767514      2.6109412e-16  0              2.9952149    
   1500000   148.2          200            200            0.003536912    1.2431841e-39  0              0.010610736    5.2724477e-08  0              0.28287514     2.6109412e-16  0              2.995215     
   1600000   148.2          200            200            0.0035368861   7.7576838e-40  0              0.010610658    6.2603743e-09  0              0.033587897    2.6109412e-16  0              2.995215     
   1700000   148.2          200            200            0.0035368719   6.6343712e-39  0              0.010610616    7.0584694e-10  0              0.0037869803   2.6109412e-16  0              2.995215     
   1800000   148.2          200            200            0.0035368651   6.2011922e-40  0              0.010610595    7.4777022e-11  0              0.00040119053  2.6109412e-16  0              2.995215     
   1900000   148.2          200            200            0.003536862    4.0507728e-39  0              0.010610586    7.3135934e-12  0              3.9238584e-05  2.6109412e-16  0              2.995215     
   2000000   148.2          200            200            0.0035368607   5.502405e-39   0              0.010610582    6.3985306e-13  0              3.4329127e-06  2.6109412e-16  0              2.995215     
   2100000   148.2          200            200            0.0035368602   4.9803503e-39  0              0.010610581    4.6993533e-14  0              2.5212773e-07  2.6109412e-16  0              2.995215     
   2200000   148.2          200            200            0.00353686    -5.8229774e-39  0              0.01061058     2.4691398e-15  0              1.3247325e-08  2.6109412e-16  0              2.995215     
   2300000   148.2          200            200            0.0035368599   1.3102717e-40  0              0.01061058     4.6703163e-17  0              2.5056984e-10  2.6109412e-16  0              2.995215     
   2400000   148.2          200            200            0.0035368599   5.1779344e-39  0              0.01061058     3.4702728e-18  0              1.8618561e-11  2.6109412e-16  0              2.995215     
   2500000   148.2          200            200            0.0035368598  -6.2671246e-39  0              0.01061058     4.9532817e-18  0              2.6575139e-11  2.6109412e-16  0              2.995215     
   2600000   148.2          200            200            0.0035368598   1.1446375e-40  0              0.01061058     1.9617217e-18  0              1.0524947e-11  2.6109412e-16  0              2.995215     
   2700000   148.2          200            200            0.0035368598   7.6997552e-39  0              0.010610579    3.7429322e-19  0              2.0081422e-12  2.6109412e-16  0              2.995215     
   2800000   148.2          200            200            0.0035368598  -4.291901e-39   0              0.010610579    1.0022116e-19  0              5.3770236e-13  2.6109412e-16  0              2.995215     
   2900000   148.2          200            200            0.0035368598   6.7776692e-39  0              0.010610579    2.0604001e-20  0              1.1054372e-13  2.6109412e-16  0              2.995215     
   3000000   148.2          200            200            0.0035368598  -6.6310645e-40  0              0.010610579    1.5019037e-20  0              8.0579503e-14  2.6109412e-16  0              2.995215     
Loop time of 63.1683 on 4 procs for 3000000 steps with 50 atoms

Performance: 41033220.106 ns/day, 0.000 hours/ns, 47492.153 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 0.31633    | 1.5251     | 5.0028     | 162.7 |  2.41
Neigh   | 0.07512    | 0.07572    | 0.077243   |   0.3 |  0.12
Comm    | 25.244     | 31.589     | 37.181     |  82.0 | 50.01
Output  | 0.095554   | 0.095631   | 0.095688   |   0.0 |  0.15
Modify  | 15.159     | 20.803     | 27.817     | 117.8 | 32.93
Other   |            | 9.081      |            |       | 14.38

Nlocal:           12.5 ave          50 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1
Nghost:           37.5 ave          50 max           0 min
Histogram: 1 0 0 0 0 0 0 0 0 3
Neighs:           6.75 ave          27 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1

Total # of neighbors = 27
Ave neighs/atom = 0.54
Neighbor list builds = 164
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 44

#variable lat0 equal 1                    #
variable lat1 equal 3+(151*0.01)+(v_ind*0.01)  # .491+(v_ind*0.001)       # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 10*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.95                                                               
Lattice spacing in x,y,z = 4.95 4.95 4.95

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -74.25 ${n1e1} -100 100 -100 100 units box
region box block -74.25 74.25 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -74.25 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -74.25 74.25 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-74.25 -100 -100) to (74.25 100 100)
  1 by 2 by 2 MPI processor grid
create_atoms 1 region substrate
Created 30 atoms
  using lattice units in orthogonal box = (-74.25 -100 -100) to (74.25 100 100)
  create_atoms CPU = 0.000 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 30 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 21 atoms
  using lattice units in orthogonal box = (-74.25 -100 -100) to (74.25 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  30 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  30 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  21 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  21 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
30 atoms in group substrate
group slider1 region slider1
21 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 21 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_44_*.dump id type diameter mass xu yu zu fx fy fz

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 96 130 130
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 14.59 | 18.06 | 19.22 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   148.5          200            200            0              0              0              0              0              0              0              2.6109412e-16  0              6            
    100000   148.5          200            200            0.0028784388   2.0751735e-39  0              0.0086353164   12309.953      0              5.9440357e+10  2.6109412e-16  0              3.3259887    
    200000   148.5          200            200            0.0010313352  -2.0744713e-38  0              0.0030940057   3053.7394      0              1.4745415e+10  2.6109412e-16  0              3.0721939    
    300000   148.5          200            200            9.0985354e-05 -1.6534346e-38  0              0.00027295606  48.071126      0              2.3211826e+08  2.6109412e-16  0              3.045772     
    400000   148.5          200            200            0.013752163   -0.004030137    0              0.045286627    97.38518       0              4.7023818e+08  2.6109412e-16  0              2.991591     
    500000   148.5          200            200            0.00044324384  2.3219475e-36  0              0.0013297315   0.20431233     0              986551.13      2.6109412e-16  0              2.9987911    
    600000   148.5          200            200            0.0042758493  -0.0004700912   0              0.013297639    3.9146484      0              18902436       2.6109412e-16  0              2.995135     
    700000   148.5          200            200            0.0028924145  -0.00012265225  0              0.0087998957   0.066124209    0              319290.14      2.6109412e-16  0              2.995901     
    800000   148.5          200            200            0.0032972283  -0.00027166713  0              0.010163352    0.057433012    0              277323.46      2.6109412e-16  0              2.995639     
    900000   148.5          200            200            0.0034186687  -0.00027225027  0              0.010528256    0.011417446    0              55130.763      2.6109412e-16  0              2.9955748    
   1000000   148.5          200            200            0.0034434728  -0.00027358643  0              0.010604005    0.0015947651   0              7700.5499      2.6109412e-16  0              2.9955619    
   1100000   148.5          200            200            0.0034447682  -0.0002736384   0              0.010607943    0.0001655541   0              799.40149      2.6109412e-16  0              2.9955614    
   1200000   148.5          200            200            0.0034423497  -0.00027349968  0              0.010600549    1.1643981e-05  0              56.224615      2.6109412e-16  0              2.9955628    
   1300000   148.5          200            200            0.0034405239  -0.00027339757  0              0.010594969    3.5698925e-07  0              1.7237733      2.6109412e-16  0              2.9955637    
   1400000   148.5          200            200            0.0034396007  -0.00027334635  0              0.010592149    2.7303896e-09  0              0.013184074    2.6109412e-16  0              2.9955642    
   1500000   148.5          200            200            0.0034392152  -0.00027332508  0              0.010590971    1.3607121e-08  0              0.065703919    2.6109412e-16  0              2.9955645    
   1600000   148.5          200            200            0.003439076   -0.00027331744  0              0.010590545    5.3091506e-09  0              0.025635988    2.6109412e-16  0              2.9955645    
   1700000   148.5          200            200            0.0034390327  -0.00027331509  0              0.010590413    1.165946e-09   0              0.0056299362   2.6109412e-16  0              2.9955646    
   1800000   148.5          200            200            0.0034390219  -0.00027331451  0              0.01059038     1.8330381e-10  0              0.00088510849  2.6109412e-16  0              2.9955646    
   1900000   148.5          200            200            0.0034390204  -0.00027331443  0              0.010590376    2.1689469e-11  0              0.00010473068  2.6109412e-16  0              2.9955646    
   2000000   148.5          200            200            0.0034390208  -0.00027331445  0              0.010590377    1.8477638e-12  0              8.9221903e-06  2.6109412e-16  0              2.9955646    
   2100000   148.5          200            200            0.0034390213  -0.00027331448  0              0.010590378    9.0765955e-14  0              4.3827631e-07  2.6109412e-16  0              2.9955646    
   2200000   148.5          200            200            0.0034390216  -0.00027331449  0              0.010590379    5.077436e-16   0              2.4517121e-09  2.6109412e-16  0              2.9955646    
   2300000   148.5          200            200            0.0034390217  -0.0002733145   0              0.01059038     6.4765566e-16  0              3.1272974e-09  2.6109412e-16  0              2.9955646    
   2400000   148.5          200            200            0.0034390217  -0.0002733145   0              0.01059038     4.2213961e-16  0              2.0383611e-09  2.6109412e-16  0              2.9955646    
   2500000   148.5          200            200            0.0034390217  -0.0002733145   0              0.01059038     1.1250088e-16  0              5.4322647e-10  2.6109412e-16  0              2.9955646    
   2600000   148.5          200            200            0.0034390217  -0.0002733145   0              0.01059038     1.9761159e-17  0              9.5419566e-11  2.6109412e-16  0              2.9955646    
   2700000   148.5          200            200            0.0034390217  -0.0002733145   0              0.01059038     2.1660755e-18  0              1.0459203e-11  2.6109412e-16  0              2.9955646    
   2800000   148.5          200            200            0.0034390217  -0.0002733145   0              0.01059038     2.9270502e-20  0              1.4133678e-13  2.6109412e-16  0              2.9955646    
   2900000   148.5          200            200            0.0034390217  -0.0002733145   0              0.01059038     1.1716301e-19  0              5.6573825e-13  2.6109412e-16  0              2.9955646    
   3000000   148.5          200            200            0.0034390217  -0.0002733145   0              0.01059038     1.2083961e-19  0              5.8349122e-13  2.6109412e-16  0              2.9955646    
Loop time of 64.1839 on 4 procs for 3000000 steps with 51 atoms

Performance: 40383983.634 ns/day, 0.000 hours/ns, 46740.722 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 0.32161    | 1.6389     | 5.4142     | 170.3 |  2.55
Neigh   | 0.075197   | 0.075805   | 0.077339   |   0.3 |  0.12
Comm    | 25.684     | 32.153     | 37.912     |  82.9 | 50.09
Output  | 0.062659   | 0.062736   | 0.062791   |   0.0 |  0.10
Modify  | 15.351     | 21.1       | 28.285     | 119.8 | 32.87
Other   |            | 9.154      |            |       | 14.26

Nlocal:          12.75 ave          51 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1
Nghost:          39.25 ave          52 max           1 min
Histogram: 1 0 0 0 0 0 0 0 0 3
Neighs:           6.75 ave          27 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1

Total # of neighbors = 27
Ave neighs/atom = 0.52941176
Neighbor list builds = 164
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 45

#variable lat0 equal 1                    #
variable lat1 equal 3+(151*0.01)+(v_ind*0.01)  # .491+(v_ind*0.001)       # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 10*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.96                                                               
Lattice spacing in x,y,z = 4.96 4.96 4.96

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -74.4 ${n1e1} -100 100 -100 100 units box
region box block -74.4 74.4 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -74.4 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -74.4 74.4 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-74.4 -100 -100) to (74.4 100 100)
  1 by 2 by 2 MPI processor grid
create_atoms 1 region substrate
Created 30 atoms
  using lattice units in orthogonal box = (-74.4 -100 -100) to (74.4 100 100)
  create_atoms CPU = 0.000 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 30 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 21 atoms
  using lattice units in orthogonal box = (-74.4 -100 -100) to (74.4 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  30 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  30 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  21 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  21 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
30 atoms in group substrate
group slider1 region slider1
21 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 21 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_45_*.dump id type diameter mass xu yu zu fx fy fz

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 96 130 130
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 14.65 | 18.12 | 19.28 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   148.8          200            200            0              0              0              0              0              0              0              2.6109412e-16  0              6            
    100000   148.8          200            200            0.0028771409  -8.276845e-39   0              0.0086314227   12336.931      0              5.9570624e+10  2.6109412e-16  0              3.3256497    
    200000   148.8          200            200            0.0010413604  -2.484691e-38   0              0.0031240813   3109.3642      0              1.5014007e+10  2.6109412e-16  0              3.070611     
    300000   148.8          200            200            0.00012222389  2.0710469e-39  0              0.00036667167  83.876066      0              4.050075e+08   2.6109412e-16  0              3.0451307    
    400000   148.8          200            200            0.016397872   -0.004916712    0              0.054110327    44.528337      0              2.150114e+08   2.6109412e-16  0              2.9915827    
    500000   148.8          200            200            0.0071940915  -0.0020104448   0              0.023592719    17.593072      0              84950646       2.6109412e-16  0              2.9945309    
    600000   148.8          200            200            0.0022820241  -0.00036520139  0              0.0072112737   3.5198294      0              16995996       2.6109412e-16  0              2.9967896    
    700000   148.8          200            200            0.0026969298  -0.0005203179   0              0.0086111072   0.086744987    0              418860.5       2.6109412e-16  0              2.9965564    
    800000   148.8          200            200            0.0035053233  -0.00061112217  0              0.011127092    0.050739734    0              245004.02      2.6109412e-16  0              2.9961542    
    900000   148.8          200            200            0.003352649   -0.00060396354  0              0.01066191     0.011791609    0              56937.46       2.6109412e-16  0              2.9962233    
   1000000   148.8          200            200            0.0032883772  -0.00060050115  0              0.010465633    4.5040435e-05  0              217.48414      2.6109412e-16  0              2.9962543    
   1100000   148.8          200            200            0.0033308984  -0.00060275829  0              0.010595454    0.00015275725  0              737.61008      2.6109412e-16  0              2.9962343    
   1200000   148.8          200            200            0.0033249959  -0.00060246085  0              0.010577449    2.66757e-05    0              128.80741      2.6109412e-16  0              2.9962369    
   1300000   148.8          200            200            0.0033212683  -0.00060226133  0              0.010566066    1.1482356e-08  0              0.05544419     2.6109412e-16  0              2.9962387    
   1400000   148.8          200            200            0.0033233513  -0.00060237056  0              0.010572425    4.3814646e-07  0              2.1156524      2.6109412e-16  0              2.9962377    
   1500000   148.8          200            200            0.0033231382  -0.00060235996  0              0.010571775    5.8819257e-08  0              0.28401714     2.6109412e-16  0              2.9962378    
   1600000   148.8          200            200            0.0033229297  -0.00060234884  0              0.010571138    3.6245376e-11  0              0.00017501595  2.6109412e-16  0              2.9962379    
   1700000   148.8          200            200            0.0033230304  -0.0006023541   0              0.010571445    1.217438e-09   0              0.0058785723   2.6109412e-16  0              2.9962379    
   1800000   148.8          200            200            0.0033230239  -0.0006023538   0              0.010571426    1.2555606e-10  0              0.00060626528  2.6109412e-16  0              2.9962379    
   1900000   148.8          200            200            0.0033230125  -0.00060235319  0              0.010571391    7.4193129e-13  0              3.5825207e-06  2.6109412e-16  0              2.9962379    
   2000000   148.8          200            200            0.0033230173  -0.00060235344  0              0.010571405    3.2871086e-12  0              1.5872271e-05  2.6109412e-16  0              2.9962379    
   2100000   148.8          200            200            0.0033230172  -0.00060235344  0              0.010571405    2.5807843e-13  0              1.2461684e-06  2.6109412e-16  0              2.9962379    
   2200000   148.8          200            200            0.0033230166  -0.0006023534   0              0.010571403    4.9466532e-15  0              2.3885618e-08  2.6109412e-16  0              2.9962379    
   2300000   148.8          200            200            0.0033230168  -0.00060235342  0              0.010571404    8.6363519e-15  0              4.1701853e-08  2.6109412e-16  0              2.9962379    
   2400000   148.8          200            200            0.0033230168  -0.00060235342  0              0.010571404    5.0559221e-16  0              2.4413239e-09  2.6109412e-16  0              2.9962379    
   2500000   148.8          200            200            0.0033230168  -0.00060235341  0              0.010571404    2.3186183e-17  0              1.1195778e-10  2.6109412e-16  0              2.9962379    
   2600000   148.8          200            200            0.0033230168  -0.00060235341  0              0.010571404    2.2199832e-17  0              1.0719505e-10  2.6109412e-16  0              2.9962379    
   2700000   148.8          200            200            0.0033230168  -0.00060235341  0              0.010571404    2.5225431e-19  0              1.2180458e-12  2.6109412e-16  0              2.9962379    
   2800000   148.8          200            200            0.0033230168  -0.00060235341  0              0.010571404    3.7440405e-19  0              1.8078631e-12  2.6109412e-16  0              2.9962379    
   2900000   148.8          200            200            0.0033230168  -0.00060235341  0              0.010571404    7.6213799e-20  0              3.6800916e-13  2.6109412e-16  0              2.9962379    
   3000000   148.8          200            200            0.0033230168  -0.00060235342  0              0.010571404    2.7055563e-20  0              1.3064163e-13  2.6109412e-16  0              2.9962379    
Loop time of 63.9819 on 4 procs for 3000000 steps with 51 atoms

Performance: 40511440.289 ns/day, 0.000 hours/ns, 46888.241 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 0.32196    | 1.5887     | 5.2089     | 165.9 |  2.48
Neigh   | 0.078301   | 0.079225   | 0.080962   |   0.4 |  0.12
Comm    | 25.713     | 32.132     | 37.863     |  82.5 | 50.22
Output  | 0.060818   | 0.060897   | 0.060947   |   0.0 |  0.10
Modify  | 15.279     | 20.987     | 28.089     | 119.2 | 32.80
Other   |            | 9.135      |            |       | 14.28

Nlocal:          12.75 ave          51 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1
Nghost:          39.25 ave          52 max           1 min
Histogram: 1 0 0 0 0 0 0 0 0 3
Neighs:           6.25 ave          25 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1

Total # of neighbors = 25
Ave neighs/atom = 0.49019608
Neighbor list builds = 166
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 46

#variable lat0 equal 1                    #
variable lat1 equal 3+(151*0.01)+(v_ind*0.01)  # .491+(v_ind*0.001)       # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 10*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.97                                                               
Lattice spacing in x,y,z = 4.97 4.97 4.97

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -74.55 ${n1e1} -100 100 -100 100 units box
region box block -74.55 74.55 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -74.55 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -74.55 74.55 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-74.55 -100 -100) to (74.55 100 100)
  1 by 2 by 2 MPI processor grid
create_atoms 1 region substrate
Created 30 atoms
  using lattice units in orthogonal box = (-74.55 -100 -100) to (74.55 100 100)
  create_atoms CPU = 0.000 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 30 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 21 atoms
  using lattice units in orthogonal box = (-74.55 -100 -100) to (74.55 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  30 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  30 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  21 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  21 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
30 atoms in group substrate
group slider1 region slider1
21 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 21 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_46_*.dump id type diameter mass xu yu zu fx fy fz

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 97 130 130
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 14.61 | 18.08 | 19.24 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   149.1          200            200            0              0              0              0              0              0              0              2.6109412e-16  0              6            
    100000   149.1          200            200            0.0028748196   9.300585e-39   0              0.0086244589   12357.01       0              5.9667581e+10  2.6109412e-16  0              3.3256702    
    200000   149.1          200            200            0.0010463335  -2.0665848e-39  0              0.0031390004   3141.3348      0              1.5168381e+10  2.6109412e-16  0              3.0703783    
    300000   149.1          200            200            0.00014369897  4.133796e-38   0              0.00043109692  113.53115      0              5.4820129e+08  2.6109412e-16  0              3.0449534    
    400000   149.1          200            200           -0.00014026754  1.9928208e-37  0             -0.00042080262  173.25024      0              8.365634e+08   2.6109412e-16  0              3.0005421    
    500000   149.1          200            200            0.00024307814 -2.5869064e-37  0              0.00072923441  10.111656      0              48825567       2.6109412e-16  0              2.9992847    
    600000   149.1          200            200            0.0022907556  -0.00035180821  0              0.0072240749   3.741876       0              18068180       2.6109412e-16  0              2.997381     
    700000   149.1          200            200            0.0026696271  -0.0006308881   0              0.0086397695   0.18893079     0              912279.18      2.6109412e-16  0              2.9971331    
    800000   149.1          200            200            0.0033234517  -0.00066230347  0              0.010632658    0.10038822     0              484738.81      2.6109412e-16  0              2.9968285    
    900000   149.1          200            200            0.0033907647  -0.00066473224  0              0.010837026    0.0017824166   0              8606.6518      2.6109412e-16  0              2.9967999    
   1000000   149.1          200            200            0.0033251019  -0.00066219718  0              0.010637503    0.00080131713  0              3869.2736      2.6109412e-16  0              2.9968297    
   1100000   149.1          200            200            0.0032940876  -0.00066098502  0              0.010543248    0.00023871902  0              1152.6887      2.6109412e-16  0              2.9968436    
   1200000   149.1          200            200            0.003292235   -0.00066091852  0              0.010537623    2.288799e-06   0              11.051791      2.6109412e-16  0              2.9968443    
   1300000   149.1          200            200            0.0032957859  -0.00066106096  0              0.010548419    2.4582503e-06  0              11.870011      2.6109412e-16  0              2.9968427    
   1400000   149.1          200            200            0.0032972649  -0.00066111914  0              0.010552914    5.5751827e-07  0              2.6920562      2.6109412e-16  0              2.996842     
   1500000   149.1          200            200            0.0032972956  -0.00066112     0              0.010553007    2.1064846e-09  0              0.01017146     2.6109412e-16  0              2.996842     
   1600000   149.1          200            200            0.003297106   -0.00066111242  0              0.01055243     7.2544852e-09  0              0.035029313    2.6109412e-16  0              2.9968421    
   1700000   149.1          200            200            0.0032970363  -0.00066110969  0              0.010552219    1.2707996e-09  0              0.0061362367   2.6109412e-16  0              2.9968421    
   1800000   149.1          200            200            0.0032970379  -0.00066110977  0              0.010552223    6.3283731e-13  0              3.0557449e-06  2.6109412e-16  0              2.9968421    
   1900000   149.1          200            200            0.0032970479  -0.00066111017  0              0.010552254    2.0691499e-11  0              9.9911842e-05  2.6109412e-16  0              2.9968421    
   2000000   149.1          200            200            0.0032970511  -0.00066111029  0              0.010552264    2.8218942e-12  0              1.3625917e-05  2.6109412e-16  0              2.9968421    
   2100000   149.1          200            200            0.0032970509  -0.00066111028  0              0.010552263    1.2194109e-15  0              5.8880988e-09  2.6109412e-16  0              2.9968421    
   2200000   149.1          200            200            0.0032970504  -0.00066111026  0              0.010552261    5.7281766e-14  0              2.7659315e-07  2.6109412e-16  0              2.9968421    
   2300000   149.1          200            200            0.0032970502  -0.00066111026  0              0.010552261    6.0863239e-15  0              2.938868e-08   2.6109412e-16  0              2.9968421    
   2400000   149.1          200            200            0.0032970502  -0.00066111026  0              0.010552261    2.8092637e-17  0              1.3564929e-10  2.6109412e-16  0              2.9968421    
   2500000   149.1          200            200            0.0032970503  -0.00066111026  0              0.010552261    1.5566321e-16  0              7.5164194e-10  2.6109412e-16  0              2.9968421    
   2600000   149.1          200            200            0.0032970503  -0.00066111026  0              0.010552261    1.2078197e-17  0              5.8321291e-11  2.6109412e-16  0              2.9968421    
   2700000   149.1          200            200            0.0032970503  -0.00066111026  0              0.010552261    8.8574937e-19  0              4.2769667e-12  2.6109412e-16  0              2.9968421    
   2800000   149.1          200            200            0.0032970503  -0.00066111026  0              0.010552261    2.6482689e-20  0              1.2787543e-13  2.6109412e-16  0              2.9968421    
   2900000   149.1          200            200            0.0032970503  -0.00066111026  0              0.010552261    6.7396879e-22  0              3.2543541e-15  2.6109412e-16  0              2.9968421    
   3000000   149.1          200            200            0.0032970503  -0.00066111026  0              0.010552261    2.9350607e-23  0              1.4172358e-16  2.6109412e-16  0              2.9968421    
Loop time of 64.4777 on 4 procs for 3000000 steps with 51 atoms

Performance: 40199958.365 ns/day, 0.000 hours/ns, 46527.730 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 0.32519    | 1.6203     | 5.3435     | 168.9 |  2.51
Neigh   | 0.077739   | 0.078459   | 0.079943   |   0.3 |  0.12
Comm    | 25.704     | 32.249     | 38.079     |  84.2 | 50.02
Output  | 0.06262    | 0.062694   | 0.062746   |   0.0 |  0.10
Modify  | 15.402     | 21.239     | 28.487     | 120.4 | 32.94
Other   |            | 9.229      |            |       | 14.31

Nlocal:          12.75 ave          51 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1
Nghost:          39.25 ave          52 max           1 min
Histogram: 1 0 0 0 0 0 0 0 0 3
Neighs:           6.25 ave          25 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1

Total # of neighbors = 25
Ave neighs/atom = 0.49019608
Neighbor list builds = 168
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 47

#variable lat0 equal 1                    #
variable lat1 equal 3+(151*0.01)+(v_ind*0.01)  # .491+(v_ind*0.001)       # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 10*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.98                                                               
Lattice spacing in x,y,z = 4.98 4.98 4.98

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -74.7 ${n1e1} -100 100 -100 100 units box
region box block -74.7 74.7 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -74.7 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -74.7 74.7 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-74.7 -100 -100) to (74.7 100 100)
  1 by 2 by 2 MPI processor grid
create_atoms 1 region substrate
Created 30 atoms
  using lattice units in orthogonal box = (-74.7 -100 -100) to (74.7 100 100)
  create_atoms CPU = 0.000 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 30 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 21 atoms
  using lattice units in orthogonal box = (-74.7 -100 -100) to (74.7 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  30 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  30 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  21 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  21 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
30 atoms in group substrate
group slider1 region slider1
21 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 21 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_47_*.dump id type diameter mass xu yu zu fx fy fz

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 97 130 130
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 14.61 | 18.08 | 19.24 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   149.4          200            200            0              0              0              0              0              0              0              2.6109412e-16  0              6            
    100000   149.4          200            200            0.0028714735  -4.1232136e-39  0              0.0086144206   12370.53       0              5.9732863e+10  2.6109412e-16  0              3.3259002    
    200000   149.4          200            200            0.0010473629  -8.2497042e-39  0              0.0031420886   3154.8281      0              1.5233536e+10  2.6109412e-16  0              3.0709814    
    300000   149.4          200            200            0.00015110491 -3.2998322e-38  0              0.00045331474  124.90447      0              6.0311899e+08  2.6109412e-16  0              3.0456107    
    400000   149.4          200            200           -0.00010207545  2.3204105e-39  0             -0.00030622634  84.559796      0              4.0830899e+08  2.6109412e-16  0              3.0055839    
    500000   149.4          200            200           -2.8489548e-05 -1.6517842e-38  0             -8.5468645e-05  7.5867412      0              36633658       2.6109412e-16  0              2.9999474    
    600000   149.4          200            200            0.0029425077  -0.0005004915   0              0.0093280147   5.9435577      0              28699313       2.6109412e-16  0              2.997486     
    700000   149.4          200            200            0.0041487806  -0.00071907984  0              0.013165422    0.075779132    0              365910.31      2.6109412e-16  0              2.9970486    
    800000   149.4          200            200            0.0032558559  -0.00056499918  0              0.010332567    0.108442       0              523627.61      2.6109412e-16  0              2.9973683    
    900000   149.4          200            200            0.0032366275  -0.00054678332  0              0.010256666    0.0058144698   0              28075.994      2.6109412e-16  0              2.9973794    
   1000000   149.4          200            200            0.003367577   -0.00055400059  0              0.010656731    0.00022898179  0              1105.6711      2.6109412e-16  0              2.9973307    
   1100000   149.4          200            200            0.0033232508  -0.00055183981  0              0.010521592    0.00026365794  0              1273.1098      2.6109412e-16  0              2.9973468    
   1200000   149.4          200            200            0.0033229183  -0.00055180883  0              0.010520564    1.9275138e-05  0              93.072743      2.6109412e-16  0              2.997347     
   1300000   149.4          200            200            0.003329033   -0.00055212638  0              0.010539225    2.0802064e-07  0              1.0044572      2.6109412e-16  0              2.9973447    
   1400000   149.4          200            200            0.0033266548  -0.00055200525  0              0.01053197     6.0073161e-07  0              2.900718       2.6109412e-16  0              2.9973456    
   1500000   149.4          200            200            0.0033267705  -0.00055201053  0              0.010532322    6.0373365e-08  0              0.29152138     2.6109412e-16  0              2.9973455    
   1600000   149.4          200            200            0.0033270464  -0.00055202486  0              0.010533164    5.5086349e-11  0              0.00026599226  2.6109412e-16  0              2.9973454    
   1700000   149.4          200            200            0.0033269213  -0.00055201846  0              0.010532782    1.3098381e-09  0              0.0063247396   2.6109412e-16  0              2.9973455    
   1800000   149.4          200            200            0.0033269336  -0.00055201906  0              0.01053282     1.7823195e-10  0              0.00086061831  2.6109412e-16  0              2.9973455    
   1900000   149.4          200            200            0.0033269456  -0.00055201969  0              0.010532857    1.5828118e-13  0              7.6428317e-07  2.6109412e-16  0              2.9973455    
   2000000   149.4          200            200            0.0033269392  -0.00055201936  0              0.010532837    2.7183284e-12  0              1.3125835e-05  2.6109412e-16  0              2.9973455    
   2100000   149.4          200            200            0.0033269401  -0.0005520194   0              0.01053284     5.0076068e-13  0              2.4179941e-06  2.6109412e-16  0              2.9973455    
   2200000   149.4          200            200            0.0033269406  -0.00055201943  0              0.010532841    3.3085169e-15  0              1.5975644e-08  2.6109412e-16  0              2.9973455    
   2300000   149.4          200            200            0.0033269403  -0.00055201941  0              0.01053284     5.329033e-15   0              2.5731993e-08  2.6109412e-16  0              2.9973455    
   2400000   149.4          200            200            0.0033269404  -0.00055201942  0              0.01053284     1.3509967e-15  0              6.5234796e-09  2.6109412e-16  0              2.9973455    
   2500000   149.4          200            200            0.0033269404  -0.00055201942  0              0.010532841    2.1152001e-17  0              1.0213544e-10  2.6109412e-16  0              2.9973455    
   2600000   149.4          200            200            0.0033269404  -0.00055201942  0              0.01053284     1.0440862e-17  0              5.0415184e-11  2.6109412e-16  0              2.9973455    
   2700000   149.4          200            200            0.0033269404  -0.00055201942  0              0.01053284     3.2510677e-18  0              1.5698242e-11  2.6109412e-16  0              2.9973455    
   2800000   149.4          200            200            0.0033269404  -0.00055201942  0              0.01053284     4.3917857e-19  0              2.1206361e-12  2.6109412e-16  0              2.9973455    
   2900000   149.4          200            200            0.0033269404  -0.00055201942  0              0.01053284     5.7674979e-20  0              2.7849183e-13  2.6109412e-16  0              2.9973455    
   3000000   149.4          200            200            0.0033269404  -0.00055201942  0              0.01053284     3.6780392e-21  0              1.7759935e-14  2.6109412e-16  0              2.9973455    
Loop time of 64.1977 on 4 procs for 3000000 steps with 51 atoms

Performance: 40375274.058 ns/day, 0.000 hours/ns, 46730.641 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 0.33186    | 1.6801     | 5.6057     | 174.9 |  2.62
Neigh   | 0.077762   | 0.078354   | 0.079885   |   0.3 |  0.12
Comm    | 25.774     | 32.125     | 37.963     |  82.3 | 50.04
Output  | 0.062213   | 0.062292   | 0.062348   |   0.0 |  0.10
Modify  | 15.351     | 21.102     | 28.277     | 120.3 | 32.87
Other   |            | 9.151      |            |       | 14.25

Nlocal:          12.75 ave          51 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1
Nghost:          39.25 ave          52 max           1 min
Histogram: 1 0 0 0 0 0 0 0 0 3
Neighs:           6.25 ave          25 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1

Total # of neighbors = 25
Ave neighs/atom = 0.49019608
Neighbor list builds = 168
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 48

#variable lat0 equal 1                    #
variable lat1 equal 3+(151*0.01)+(v_ind*0.01)  # .491+(v_ind*0.001)       # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 10*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.99                                                               
Lattice spacing in x,y,z = 4.99 4.99 4.99

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -74.85 ${n1e1} -100 100 -100 100 units box
region box block -74.85 74.85 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -74.85 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -74.85 74.85 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-74.85 -100 -100) to (74.85 100 100)
  1 by 2 by 2 MPI processor grid
create_atoms 1 region substrate
Created 29 atoms
  using lattice units in orthogonal box = (-74.85 -100 -100) to (74.85 100 100)
  create_atoms CPU = 0.000 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 30 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 21 atoms
  using lattice units in orthogonal box = (-74.85 -100 -100) to (74.85 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  29 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  29 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  21 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  21 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
29 atoms in group substrate
group slider1 region slider1
21 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 21 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_48_*.dump id type diameter mass xu yu zu fx fy fz

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 97 130 130
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 14.61 | 18.08 | 19.24 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   149.7          200            200            0              0              0              0              0              0              0              2.6109412e-16  0              6            
    100000   149.7          200            200            0.0028671256   5.1461757e-39  0              0.0086013769   12377.971      0              6.6409769e+10  2.6109412e-16  0              3.3261918    
    200000   149.7          200            200            0.001045861    1.5439163e-39  0              0.0031375829   3156.6561      0              1.6935958e+10  2.6109412e-16  0              3.0718327    
    300000   149.7          200            200            0.000150321   -1.6455899e-38  0              0.00045096301  124.11371      0              6.6588965e+08  2.6109412e-16  0              3.0465302    
    400000   149.7          200            200           -9.6285065e-05 -1.5437963e-39  0             -0.00028885519  74.627999      0              4.00391e+08    2.6109412e-16  0              3.0068383    
    500000   149.7          200            200            4.5979556e-05 -8.2267642e-39  0              0.00013793867  13.606594      0              73001528       2.6109412e-16  0              3.0003515    
    600000   149.7          200            200            0.0027715811  -0.00060764855  0              0.0089223917   6.5134706      0              34945798       2.6109412e-16  0              2.998234     
    700000   149.7          200            200            0.0026837496  -0.00050621347  0              0.0085574624   0.50746539     0              2722631.9      2.6109412e-16  0              2.9982817    
    800000   149.7          200            200            0.0030214069  -0.00051497464  0              0.0095791952   0.030771106    0              165091.84      2.6109412e-16  0              2.998173     
    900000   149.7          200            200            0.003388712   -0.00052200931  0              0.010688145    0.013792451    0              73998.677      2.6109412e-16  0              2.9980555    
   1000000   149.7          200            200            0.0033765976  -0.00052184723  0              0.01065164     0.00030947635  0              1660.3895      2.6109412e-16  0              2.9980588    
   1100000   149.7          200            200            0.0033254371  -0.00052101826  0              0.010497329    0.0002797045   0              1500.6588      2.6109412e-16  0              2.9980748    
   1200000   149.7          200            200            0.003324635   -0.00052100094  0              0.010494906    2.4538122e-06  0              13.16509       2.6109412e-16  0              2.9980752    
   1300000   149.7          200            200            0.0033315076  -0.00052111506  0              0.010515638    5.4715566e-06  0              29.355765      2.6109412e-16  0              2.998073     
   1400000   149.7          200            200            0.0033319499  -0.00052112291  0              0.010516973    9.7968404e-09  0              0.052561596    2.6109412e-16  0              2.9980728    
   1500000   149.7          200            200            0.0033310411  -0.0005211079   0              0.010514231    1.0322333e-07  0              0.55380949     2.6109412e-16  0              2.9980731    
   1600000   149.7          200            200            0.0033309374  -0.00052110611  0              0.010513918    4.5412246e-12  0              2.4364387e-05  2.6109412e-16  0              2.9980732    
   1700000   149.7          200            200            0.0033310553  -0.00052110806  0              0.010514274    1.8809249e-09  0              0.010091459    2.6109412e-16  0              2.9980731    
   1800000   149.7          200            200            0.0033310751  -0.00052110839  0              0.010514334    5.6829756e-12  0              3.0490061e-05  2.6109412e-16  0              2.9980731    
   1900000   149.7          200            200            0.0033310601  -0.00052110815  0              0.010514288    3.3098124e-11  0              0.00017757666  2.6109412e-16  0              2.9980731    
   2000000   149.7          200            200            0.0033310567  -0.00052110809  0              0.010514278    3.6062094e-13  0              1.9347883e-06  2.6109412e-16  0              2.9980731    
   2100000   149.7          200            200            0.0033310585  -0.00052110812  0              0.010514284    5.6165534e-13  0              3.0133696e-06  2.6109412e-16  0              2.9980731    
   2200000   149.7          200            200            0.0033310591  -0.00052110813  0              0.010514285    1.3798809e-14  0              7.4032787e-08  2.6109412e-16  0              2.9980731    
   2300000   149.7          200            200            0.0033310589  -0.00052110812  0              0.010514285    9.1731003e-15  0              4.9215132e-08  2.6109412e-16  0              2.9980731    
   2400000   149.7          200            200            0.0033310588  -0.00052110812  0              0.010514284    4.2332021e-16  0              2.2711798e-09  2.6109412e-16  0              2.9980731    
   2500000   149.7          200            200            0.0033310588  -0.00052110812  0              0.010514285    1.4293974e-16  0              7.6689428e-10  2.6109412e-16  0              2.9980731    
   2600000   149.7          200            200            0.0033310588  -0.00052110812  0              0.010514285    1.0624342e-17  0              5.7001273e-11  2.6109412e-16  0              2.9980731    
   2700000   149.7          200            200            0.0033310588  -0.00052110812  0              0.010514285    2.5900333e-18  0              1.3895937e-11  2.6109412e-16  0              2.9980731    
   2800000   149.7          200            200            0.0033310588  -0.00052110812  0              0.010514285    7.4223536e-20  0              3.9822099e-13  2.6109412e-16  0              2.9980731    
   2900000   149.7          200            200            0.0033310588  -0.00052110812  0              0.010514285    4.7999431e-20  0              2.5752452e-13  2.6109412e-16  0              2.9980731    
   3000000   149.7          200            200            0.0033310588  -0.00052110812  0              0.010514285    1.4744429e-19  0              7.9106192e-13  2.6109412e-16  0              2.9980731    
Loop time of 63.1297 on 4 procs for 3000000 steps with 50 atoms

Performance: 41058306.695 ns/day, 0.000 hours/ns, 47521.188 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 0.31876    | 1.6509     | 5.4904     | 172.6 |  2.62
Neigh   | 0.077743   | 0.078344   | 0.079892   |   0.3 |  0.12
Comm    | 25.122     | 31.336     | 37.085     |  81.5 | 49.64
Output  | 0.060003   | 0.060078   | 0.060132   |   0.0 |  0.10
Modify  | 15.195     | 20.864     | 27.867     | 117.7 | 33.05
Other   |            | 9.141      |            |       | 14.48

Nlocal:           12.5 ave          50 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1
Nghost:           37.5 ave          50 max           0 min
Histogram: 1 0 0 0 0 0 0 0 0 3
Neighs:           6.25 ave          25 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1

Total # of neighbors = 25
Ave neighs/atom = 0.5
Neighbor list builds = 168
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 49

#variable lat0 equal 1                    #
variable lat1 equal 3+(151*0.01)+(v_ind*0.01)  # .491+(v_ind*0.001)       # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 10*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 5                                                               
Lattice spacing in x,y,z = 5 5 5

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -75 ${n1e1} -100 100 -100 100 units box
region box block -75 75 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -75 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -75 75 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-75 -100 -100) to (75 100 100)
  1 by 2 by 2 MPI processor grid
create_atoms 1 region substrate
Created 30 atoms
  using lattice units in orthogonal box = (-75 -100 -100) to (75 100 100)
  create_atoms CPU = 0.000 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 30 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 21 atoms
  using lattice units in orthogonal box = (-75 -100 -100) to (75 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  30 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  30 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  21 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  21 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
30 atoms in group substrate
group slider1 region slider1
21 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 21 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_49_*.dump id type diameter mass xu yu zu fx fy fz

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 97 130 130
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 14.61 | 18.08 | 19.24 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   150            200            200            0              0              0              0              0              0              0              2.6109412e-16  0              6            
    100000   150            200            200            0.0028618529  -3.2853207e-38  0              0.0085855587   12380.376      0              5.9780404e+10  2.6109412e-16  0              3.3263036    
    200000   150            200            200            0.0010438246  -6.5633132e-38  0              0.0031314737   3156.559       0              1.5241894e+10  2.6109412e-16  0              3.0721729    
    300000   150            200            200            0.00014912983 -1.6426686e-38  0              0.0004473895   122.74213      0              5.9267781e+08  2.6109412e-16  0              3.0469146    
    400000   150            200            200           -9.7594015e-05  6.574981e-38   0             -0.00029278204  77.197392      0              3.7275858e+08  2.6109412e-16  0              3.0070215    
    500000   150            200            200            4.7019767e-05 -1.2321833e-38  0              0.0001410593   14.26058       0              68859235       2.6109412e-16  0              3.0006106    
    600000   150            200            200            0.0014705563  -8.5544954e-41  0              0.004411669    2.3231856      0              11217832       2.6109412e-16  0              2.9990743    
    700000   150            200            200            0.0026363595   5.2567261e-37  0              0.0079090786   0.18792222     0              907409.14      2.6109412e-16  0              2.9986466    
    800000   150            200            200            0.0037686215   1.3168366e-37  0              0.011305865    0.059477095    0              287193.61      2.6109412e-16  0              2.9982811    
    900000   150            200            200            0.0035379801  -1.3129275e-37  0              0.01061394     0.015531981    0              74998.378      2.6109412e-16  0              2.9983507    
   1000000   150            200            200            0.0034490524   3.2985976e-38  0              0.010347157    4.6781462e-05  0              225.89094      2.6109412e-16  0              2.9983789    
   1100000   150            200            200            0.0035084464   1.9729607e-37  0              0.010525339    0.00021393159  0              1032.9991      2.6109412e-16  0              2.9983604    
   1200000   150            200            200            0.0035013907   3.2942056e-38  0              0.010504172    3.1890654e-05  0              153.98856      2.6109412e-16  0              2.9983625    
   1300000   150            200            200            0.0034956235   6.5813069e-38  0              0.01048687     2.4033266e-08  0              0.11604804     2.6109412e-16  0              2.9983643    
   1400000   150            200            200            0.003498441    7.7878547e-41  0              0.010495323    6.627721e-07   0              3.2002893      2.6109412e-16  0              2.9983635    
   1500000   150            200            200            0.0034983116   3.2949837e-38  0              0.010494935    5.8525024e-08  0              0.2825964      2.6109412e-16  0              2.9983635    
   1600000   150            200            200            0.0034979721   3.2952134e-38  0              0.010493916    1.0260691e-09  0              0.0049545204   2.6109412e-16  0              2.9983636    
   1700000   150            200            200            0.0034980993  -6.5653342e-38  0              0.010494298    1.8556961e-09  0              0.0089604925   2.6109412e-16  0              2.9983636    
   1800000   150            200            200            0.0034981041  -6.5651197e-38  0              0.010494312    9.1714036e-11  0              0.00044285426  2.6109412e-16  0              2.9983636    
   1900000   150            200            200            0.0034980854   6.5827812e-38  0              0.010494256    7.4868688e-12  0              3.615141e-05   2.6109412e-16  0              2.9983636    
   2000000   150            200            200            0.0034980908   9.164274e-41   0              0.010494272    4.7493931e-12  0              2.2933119e-05  2.6109412e-16  0              2.9983636    
   2100000   150            200            200            0.0034980916   9.3925158e-41  0              0.010494275    1.1131012e-13  0              5.3747675e-07  2.6109412e-16  0              2.9983636    
   2200000   150            200            200            0.0034980906   9.6248355e-41  0              0.010494272    3.502516e-14   0              1.6912396e-07  2.6109412e-16  0              2.9983636    
   2300000   150            200            200            0.0034980908  -6.5639797e-38  0              0.010494272    1.1154833e-14  0              5.3862694e-08  2.6109412e-16  0              2.9983636    
   2400000   150            200            200            0.0034980909   6.5839426e-38  0              0.010494273    7.5761904e-17  0              3.6582712e-10  2.6109412e-16  0              2.9983636    
   2500000   150            200            200            0.0034980908   1.034638e-40   0              0.010494272    1.3376381e-16  0              6.4589758e-10  2.6109412e-16  0              2.9983636    
   2600000   150            200            200            0.0034980908  -6.5632456e-38  0              0.010494272    2.3518182e-17  0              1.1356089e-10  2.6109412e-16  0              2.9983636    
   2700000   150            200            200            0.0034980908  -6.5629923e-38  0              0.010494272    1.1361044e-19  0              5.4858414e-13  2.6109412e-16  0              2.9983636    
   2800000   150            200            200            0.0034980908   1.1106272e-40  0              0.010494272    3.6099353e-19  0              1.7431086e-12  2.6109412e-16  0              2.9983636    
   2900000   150            200            200            0.0034980908   1.1368415e-40  0              0.010494272    6.054086e-20   0              2.9233015e-13  2.6109412e-16  0              2.9983636    
   3000000   150            200            200            0.0034980908   1.1635096e-40  0              0.010494272    8.1660707e-20  0              3.9431033e-13  2.6109412e-16  0              2.9983636    
Loop time of 64.1667 on 4 procs for 3000000 steps with 51 atoms

Performance: 40394791.366 ns/day, 0.000 hours/ns, 46753.231 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 0.31491    | 1.6933     | 5.6508     | 175.7 |  2.64
Neigh   | 0.077723   | 0.078331   | 0.079951   |   0.3 |  0.12
Comm    | 25.719     | 32.179     | 38.02      |  82.8 | 50.15
Output  | 0.059885   | 0.059958   | 0.06001    |   0.0 |  0.09
Modify  | 15.339     | 21.099     | 28.402     | 121.4 | 32.88
Other   |            | 9.057      |            |       | 14.11

Nlocal:          12.75 ave          51 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1
Nghost:          39.25 ave          52 max           1 min
Histogram: 1 0 0 0 0 0 0 0 0 3
Neighs:           6.25 ave          25 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1

Total # of neighbors = 25
Ave neighs/atom = 0.49019608
Neighbor list builds = 168
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 50

#variable lat0 equal 1                    #
variable lat1 equal 3+(151*0.01)+(v_ind*0.01)  # .491+(v_ind*0.001)       # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 10*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 5.01                                                               
Lattice spacing in x,y,z = 5.01 5.01 5.01

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -75.15 ${n1e1} -100 100 -100 100 units box
region box block -75.15 75.15 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -75.15 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -75.15 75.15 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-75.15 -100 -100) to (75.15 100 100)
  1 by 2 by 2 MPI processor grid
create_atoms 1 region substrate
Created 30 atoms
  using lattice units in orthogonal box = (-75.15 -100 -100) to (75.15 100 100)
  create_atoms CPU = 0.000 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 30 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 21 atoms
  using lattice units in orthogonal box = (-75.15 -100 -100) to (75.15 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  30 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  30 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  21 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  21 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
30 atoms in group substrate
group slider1 region slider1
21 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 21 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_50_*.dump id type diameter mass xu yu zu fx fy fz

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 97 130 130
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 14.61 | 18.08 | 19.24 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   150.3          200            200            0              0              0              0              0              0              0              2.6109412e-16  0              6            
    100000   150.3          200            200            0.00285568     5.1262483e-40  0              0.00856704     12377.971      0              5.9768792e+10  2.6109412e-16  0              3.3261918    
    200000   150.3          200            200            0.0010416859  -1.0247436e-39  0              0.0031250576   3156.6561      0              1.5242362e+10  2.6109412e-16  0              3.0718327    
    300000   150.3          200            200            0.00014972092  8.2124823e-39  0              0.00044916276  124.11371      0              5.9930068e+08  2.6109412e-16  0              3.0465302    
    400000   150.3          200            200           -9.5900693e-05  4.4848779e-40  0             -0.00028770208  74.627999      0              3.603519e+08   2.6109412e-16  0              3.0068383    
    500000   150.3          200            200            4.5796005e-05 -1.2296049e-38  0              0.00013738801  13.606594      0              65701375       2.6109412e-16  0              3.0003515    
    600000   150.3          200            200            0.0031648072   0.0006076482   0              0.0088867734   6.5134706      0              31451219       2.6109412e-16  0              2.998234     
    700000   150.3          200            200            0.0030098381   0.0005062134   0              0.0085233008   0.50746539     0              2450368.7      2.6109412e-16  0              2.9982817    
    800000   150.3          200            200            0.0033519765   0.00051497465  0              0.0095409549   0.030771106    0              148582.66      2.6109412e-16  0              2.998173     
    900000   150.3          200            200            0.0037224958   0.00052200932  0              0.010645478    0.013792451    0              66598.809      2.6109412e-16  0              2.9980555    
   1000000   150.3          200            200            0.0037103219   0.00052184723  0              0.010609119    0.00030947635  0              1494.3505      2.6109412e-16  0              2.9980588    
   1100000   150.3          200            200            0.0036588141   0.00052101826  0              0.010455424    0.0002797045   0              1350.5929      2.6109412e-16  0              2.9980748    
   1200000   150.3          200            200            0.0036580037   0.00052100094  0              0.01045301     2.4538122e-06  0              11.848581      2.6109412e-16  0              2.9980752    
   1300000   150.3          200            200            0.0036649248   0.00052111506  0              0.010473659    5.4715566e-06  0              26.420189      2.6109412e-16  0              2.998073     
   1400000   150.3          200            200            0.0036653705   0.00052112291  0              0.010474989    9.7968404e-09  0              0.047305436    2.6109412e-16  0              2.9980728    
   1500000   150.3          200            200            0.0036644554   0.0005211079   0              0.010472258    1.0322333e-07  0              0.49842854     2.6109412e-16  0              2.9980731    
   1600000   150.3          200            200            0.0036643509   0.00052110611  0              0.010471947    4.5412246e-12  0              2.1927948e-05  2.6109412e-16  0              2.9980732    
   1700000   150.3          200            200            0.0036644696   0.00052110806  0              0.010472301    1.8809249e-09  0              0.0090823133   2.6109412e-16  0              2.9980731    
   1800000   150.3          200            200            0.0036644895   0.00052110839  0              0.01047236     5.6829756e-12  0              2.7441055e-05  2.6109412e-16  0              2.9980731    
   1900000   150.3          200            200            0.0036644744   0.00052110815  0              0.010472315    3.3098124e-11  0              0.000159819    2.6109412e-16  0              2.9980731    
   2000000   150.3          200            200            0.003664471    0.00052110809  0              0.010472305    3.6062094e-13  0              1.7413095e-06  2.6109412e-16  0              2.9980731    
   2100000   150.3          200            200            0.0036644729   0.00052110812  0              0.010472311    5.6165534e-13  0              2.7120326e-06  2.6109412e-16  0              2.9980731    
   2200000   150.3          200            200            0.0036644734   0.00052110813  0              0.010472312    1.3798809e-14  0              6.6629508e-08  2.6109412e-16  0              2.9980731    
   2300000   150.3          200            200            0.0036644732   0.00052110812  0              0.010472311    9.1731003e-15  0              4.4293618e-08  2.6109412e-16  0              2.9980731    
   2400000   150.3          200            200            0.0036644731   0.00052110812  0              0.010472311    4.2332021e-16  0              2.0440618e-09  2.6109412e-16  0              2.9980731    
   2500000   150.3          200            200            0.0036644731   0.00052110812  0              0.010472311    1.4293974e-16  0              6.9020485e-10  2.6109412e-16  0              2.9980731    
   2600000   150.3          200            200            0.0036644732   0.00052110812  0              0.010472311    1.0624342e-17  0              5.1301147e-11  2.6109412e-16  0              2.9980731    
   2700000   150.3          200            200            0.0036644732   0.00052110812  0              0.010472311    2.5900333e-18  0              1.2506344e-11  2.6109412e-16  0              2.9980731    
   2800000   150.3          200            200            0.0036644732   0.00052110812  0              0.010472311    7.4223551e-20  0              3.5839896e-13  2.6109412e-16  0              2.9980731    
   2900000   150.3          200            200            0.0036644732   0.00052110812  0              0.010472311    4.7999424e-20  0              2.3177204e-13  2.6109412e-16  0              2.9980731    
   3000000   150.3          200            200            0.0036644732   0.00052110812  0              0.010472311    1.474443e-19   0              7.1195575e-13  2.6109412e-16  0              2.9980731    
Loop time of 64.3493 on 4 procs for 3000000 steps with 51 atoms

Performance: 40280149.929 ns/day, 0.000 hours/ns, 46620.544 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 0.32225    | 1.6955     | 5.6635     | 176.0 |  2.63
Neigh   | 0.077747   | 0.078337   | 0.079881   |   0.3 |  0.12
Comm    | 25.748     | 32.171     | 38.032     |  82.6 | 50.00
Output  | 0.060201   | 0.060278   | 0.060336   |   0.0 |  0.09
Modify  | 15.395     | 21.172     | 28.416     | 120.2 | 32.90
Other   |            | 9.172      |            |       | 14.25

Nlocal:          12.75 ave          51 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1
Nghost:          39.25 ave          52 max           1 min
Histogram: 1 0 0 0 0 0 0 0 0 3
Neighs:           6.25 ave          25 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1

Total # of neighbors = 25
Ave neighs/atom = 0.49019608
Neighbor list builds = 168
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 51

#variable lat0 equal 1                    #
variable lat1 equal 3+(151*0.01)+(v_ind*0.01)  # .491+(v_ind*0.001)       # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 10*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 5.02                                                               
Lattice spacing in x,y,z = 5.02 5.02 5.02

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -75.3 ${n1e1} -100 100 -100 100 units box
region box block -75.3 75.3 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -75.3 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -75.3 75.3 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-75.3 -100 -100) to (75.3 100 100)
  1 by 2 by 2 MPI processor grid
create_atoms 1 region substrate
Created 30 atoms
  using lattice units in orthogonal box = (-75.3 -100 -100) to (75.3 100 100)
  create_atoms CPU = 0.000 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 30 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 21 atoms
  using lattice units in orthogonal box = (-75.3 -100 -100) to (75.3 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  30 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  30 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  21 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  21 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
30 atoms in group substrate
group slider1 region slider1
21 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 21 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_51_*.dump id type diameter mass xu yu zu fx fy fz

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 98 130 130
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 14.63 | 18.1 | 19.26 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   150.6          200            200            0              0              0              0              0              0              0              2.6109412e-16  0              6            
    100000   150.6          200            200            0.0028485933  -4.0903897e-39  0              0.0085457798   12370.53       0              5.9732863e+10  2.6109412e-16  0              3.3259002    
    200000   150.6          200            200            0.0010390173  -4.0908525e-39  0              0.003117052    3154.8281      0              1.5233536e+10  2.6109412e-16  0              3.0709814    
    300000   150.6          200            200            0.00014990089 -2.4552655e-38  0              0.00044970267  124.90447      0              6.0311899e+08  2.6109412e-16  0              3.0456107    
    400000   150.6          200            200           -0.00010126209  4.0923733e-39  0             -0.00030378628  84.559796      0              4.0830899e+08  2.6109412e-16  0              3.0055839    
    500000   150.6          200            200           -2.826254e-05   4.0934834e-39  0             -8.478762e-05   7.5867412      0              36633658       2.6109412e-16  0              2.9999474    
    600000   150.6          200            200            0.0032513921   0.00050048846  0              0.0092536879   5.9435577      0              28699313       2.6109412e-16  0              2.997486     
    700000   150.6          200            200            0.0045931992   0.00071907976  0              0.013060518    0.075779132    0              365910.31      2.6109412e-16  0              2.9970486    
    800000   150.6          200            200            0.0036050781   0.00056499862  0              0.010250236    0.108442       0              523627.61      2.6109412e-16  0              2.9973683    
    900000   150.6          200            200            0.0035739076   0.00054678335  0              0.010174939    0.0058144698   0              28075.994      2.6109412e-16  0              2.9973794    
   1000000   150.6          200            200            0.003708606    0.0005540006   0              0.010571817    0.00022898179  0              1105.6711      2.6109412e-16  0              2.9973307    
   1100000   150.6          200            200            0.0036631982   0.0005518398   0              0.010437755    0.00026365794  0              1273.1098      2.6109412e-16  0              2.9973468    
   1200000   150.6          200            200            0.0036628478   0.00055180883  0              0.010436735    1.9275138e-05  0              93.072743      2.6109412e-16  0              2.997347     
   1300000   150.6          200            200            0.0036691246   0.00055212638  0              0.010455247    2.0802064e-07  0              1.0044572      2.6109412e-16  0              2.9973447    
   1400000   150.6          200            200            0.0036666849   0.00055200525  0              0.010448049    6.0073161e-07  0              2.900718       2.6109412e-16  0              2.9973456    
   1500000   150.6          200            200            0.0036668032   0.00055201053  0              0.010448399    6.0373365e-08  0              0.29152138     2.6109412e-16  0              2.9973455    
   1600000   150.6          200            200            0.0036670864   0.00055202486  0              0.010449234    5.5086349e-11  0              0.00026599226  2.6109412e-16  0              2.9973454    
   1700000   150.6          200            200            0.0036669581   0.00055201846  0              0.010448856    1.3098381e-09  0              0.0063247396   2.6109412e-16  0              2.9973455    
   1800000   150.6          200            200            0.0036669707   0.00055201906  0              0.010448893    1.7823195e-10  0              0.00086061831  2.6109412e-16  0              2.9973455    
   1900000   150.6          200            200            0.003666983    0.00055201969  0              0.010448929    1.5828118e-13  0              7.6428317e-07  2.6109412e-16  0              2.9973455    
   2000000   150.6          200            200            0.0036669764   0.00055201936  0              0.01044891     2.7183284e-12  0              1.3125835e-05  2.6109412e-16  0              2.9973455    
   2100000   150.6          200            200            0.0036669774   0.0005520194   0              0.010448913    5.0076068e-13  0              2.4179941e-06  2.6109412e-16  0              2.9973455    
   2200000   150.6          200            200            0.0036669779   0.00055201943  0              0.010448914    3.3085169e-15  0              1.5975644e-08  2.6109412e-16  0              2.9973455    
   2300000   150.6          200            200            0.0036669776   0.00055201941  0              0.010448913    5.329033e-15   0              2.5731993e-08  2.6109412e-16  0              2.9973455    
   2400000   150.6          200            200            0.0036669776   0.00055201942  0              0.010448913    1.3509967e-15  0              6.5234796e-09  2.6109412e-16  0              2.9973455    
   2500000   150.6          200            200            0.0036669776   0.00055201942  0              0.010448914    2.1152001e-17  0              1.0213544e-10  2.6109412e-16  0              2.9973455    
   2600000   150.6          200            200            0.0036669776   0.00055201942  0              0.010448913    1.0440862e-17  0              5.0415184e-11  2.6109412e-16  0              2.9973455    
   2700000   150.6          200            200            0.0036669776   0.00055201942  0              0.010448913    3.2510677e-18  0              1.5698242e-11  2.6109412e-16  0              2.9973455    
   2800000   150.6          200            200            0.0036669776   0.00055201942  0              0.010448913    4.3917855e-19  0              2.120636e-12   2.6109412e-16  0              2.9973455    
   2900000   150.6          200            200            0.0036669776   0.00055201942  0              0.010448913    5.7674975e-20  0              2.7849181e-13  2.6109412e-16  0              2.9973455    
   3000000   150.6          200            200            0.0036669776   0.00055201942  0              0.010448913    3.6780373e-21  0              1.7759926e-14  2.6109412e-16  0              2.9973455    
Loop time of 64.1591 on 4 procs for 3000000 steps with 51 atoms

Performance: 40399558.578 ns/day, 0.000 hours/ns, 46758.748 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 0.33815    | 1.7217     | 5.7016     | 175.2 |  2.68
Neigh   | 0.078548   | 0.079153   | 0.080697   |   0.3 |  0.12
Comm    | 25.731     | 32.145     | 38.033     |  82.7 | 50.10
Output  | 0.060323   | 0.0604     | 0.060455   |   0.0 |  0.09
Modify  | 15.285     | 21.036     | 28.261     | 120.6 | 32.79
Other   |            | 9.116      |            |       | 14.21

Nlocal:          12.75 ave          51 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1
Nghost:          39.25 ave          52 max           1 min
Histogram: 1 0 0 0 0 0 0 0 0 3
Neighs:           6.25 ave          25 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1

Total # of neighbors = 25
Ave neighs/atom = 0.49019608
Neighbor list builds = 168
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 52

#variable lat0 equal 1                    #
variable lat1 equal 3+(151*0.01)+(v_ind*0.01)  # .491+(v_ind*0.001)       # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 10*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 5.03                                                               
Lattice spacing in x,y,z = 5.03 5.03 5.03

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -75.45 ${n1e1} -100 100 -100 100 units box
region box block -75.45 75.45 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -75.45 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -75.45 75.45 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-75.45 -100 -100) to (75.45 100 100)
  1 by 2 by 2 MPI processor grid
create_atoms 1 region substrate
Created 30 atoms
  using lattice units in orthogonal box = (-75.45 -100 -100) to (75.45 100 100)
  create_atoms CPU = 0.000 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 30 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 21 atoms
  using lattice units in orthogonal box = (-75.45 -100 -100) to (75.45 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  30 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  30 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  21 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  21 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
30 atoms in group substrate
group slider1 region slider1
21 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 21 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_52_*.dump id type diameter mass xu yu zu fx fy fz

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 98 130 130
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 14.63 | 18.1 | 19.26 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   150.9          200            200            0              0              0              0              0              0              0              2.6109412e-16  0              6            
    100000   150.9          200            200            0.0028405275   2.0423629e-39  0              0.0085215826   12357.01       0              5.9667581e+10  2.6109412e-16  0              3.3256702    
    200000   150.9          200            200            0.0010338523   2.042632e-39   0              0.003101557    3141.3348      0              1.5168381e+10  2.6109412e-16  0              3.0703783    
    300000   150.9          200            200            0.00014198487 -1.0209203e-38  0              0.00042595461  113.53115      0              5.4820129e+08  2.6109412e-16  0              3.0449534    
    400000   150.9          200            200           -0.00013859437  1.3159954e-37  0             -0.0004157831   173.25024      0              8.365634e+08   2.6109412e-16  0              3.0005421    
    500000   150.9          200            200            0.0002401786   4.1767776e-36  0              0.00072053579  10.111656      0              48825567       2.6109412e-16  0              2.9992847    
    600000   150.9          200            200            0.0024965705   0.00035180859  0              0.0071379031   3.741876       0              18068180       2.6109412e-16  0              2.997381     
    700000   150.9          200            200            0.0030558662   0.00063088792  0              0.0085367106   0.18893079     0              912279.18      2.6109412e-16  0              2.9971331    
    800000   150.9          200            200            0.0037227103   0.00066230338  0              0.010505828    0.10038822     0              484738.81      2.6109412e-16  0              2.9968285    
    900000   150.9          200            200            0.00379083     0.00066473223  0              0.010707758    0.0017824166   0              8606.6518      2.6109412e-16  0              2.9967999    
   1000000   150.9          200            200            0.0037242704   0.00066219719  0              0.010510614    0.00080131713  0              3869.2736      2.6109412e-16  0              2.9968297    
   1100000   150.9          200            200            0.0036928228   0.00066098503  0              0.010417483    0.00023871902  0              1152.6887      2.6109412e-16  0              2.9968436    
   1200000   150.9          200            200            0.0036909482   0.00066091852  0              0.010411926    2.288799e-06   0              11.051791      2.6109412e-16  0              2.9968443    
   1300000   150.9          200            200            0.0036945511   0.00066106096  0              0.010422592    2.4582503e-06  0              11.870011      2.6109412e-16  0              2.9968427    
   1400000   150.9          200            200            0.0036960511   0.00066111914  0              0.010427034    5.5751827e-07  0              2.6920562      2.6109412e-16  0              2.996842     
   1500000   150.9          200            200            0.003696082    0.00066112     0              0.010427126    2.1064846e-09  0              0.01017146     2.6109412e-16  0              2.996842     
   1600000   150.9          200            200            0.0036958896   0.00066111242  0              0.010426556    7.2544852e-09  0              0.035029313    2.6109412e-16  0              2.9968421    
   1700000   150.9          200            200            0.003695819    0.00066110969  0              0.010426347    1.2707996e-09  0              0.0061362367   2.6109412e-16  0              2.9968421    
   1800000   150.9          200            200            0.0036958206   0.00066110977  0              0.010426352    6.3283731e-13  0              3.0557449e-06  2.6109412e-16  0              2.9968421    
   1900000   150.9          200            200            0.0036958307   0.00066111017  0              0.010426382    2.0691499e-11  0              9.9911842e-05  2.6109412e-16  0              2.9968421    
   2000000   150.9          200            200            0.003695834    0.00066111029  0              0.010426392    2.8218942e-12  0              1.3625917e-05  2.6109412e-16  0              2.9968421    
   2100000   150.9          200            200            0.0036958338   0.00066111028  0              0.010426391    1.2194109e-15  0              5.8880988e-09  2.6109412e-16  0              2.9968421    
   2200000   150.9          200            200            0.0036958332   0.00066111026  0              0.010426389    5.7281766e-14  0              2.7659315e-07  2.6109412e-16  0              2.9968421    
   2300000   150.9          200            200            0.0036958331   0.00066111026  0              0.010426389    6.0863239e-15  0              2.938868e-08   2.6109412e-16  0              2.9968421    
   2400000   150.9          200            200            0.0036958331   0.00066111026  0              0.010426389    2.8092637e-17  0              1.3564929e-10  2.6109412e-16  0              2.9968421    
   2500000   150.9          200            200            0.0036958331   0.00066111026  0              0.010426389    1.5566321e-16  0              7.5164195e-10  2.6109412e-16  0              2.9968421    
   2600000   150.9          200            200            0.0036958331   0.00066111026  0              0.010426389    1.2078197e-17  0              5.8321291e-11  2.6109412e-16  0              2.9968421    
   2700000   150.9          200            200            0.0036958331   0.00066111026  0              0.010426389    8.857494e-19   0              4.2769669e-12  2.6109412e-16  0              2.9968421    
   2800000   150.9          200            200            0.0036958331   0.00066111026  0              0.010426389    2.648269e-20   0              1.2787543e-13  2.6109412e-16  0              2.9968421    
   2900000   150.9          200            200            0.0036958331   0.00066111026  0              0.010426389    6.7396847e-22  0              3.2543525e-15  2.6109412e-16  0              2.9968421    
   3000000   150.9          200            200            0.0036958331   0.00066111026  0              0.010426389    2.9350772e-23  0              1.4172437e-16  2.6109412e-16  0              2.9968421    
Loop time of 64.1629 on 4 procs for 3000000 steps with 51 atoms

Performance: 40397158.418 ns/day, 0.000 hours/ns, 46755.970 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 0.32492    | 1.5933     | 5.2289     | 166.4 |  2.48
Neigh   | 0.078531   | 0.079154   | 0.080747   |   0.3 |  0.12
Comm    | 25.695     | 32.122     | 37.878     |  82.9 | 50.06
Output  | 0.061798   | 0.061874   | 0.061929   |   0.0 |  0.10
Modify  | 15.393     | 21.103     | 28.231     | 119.1 | 32.89
Other   |            | 9.203      |            |       | 14.34

Nlocal:          12.75 ave          51 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1
Nghost:          39.25 ave          52 max           1 min
Histogram: 1 0 0 0 0 0 0 0 0 3
Neighs:           6.25 ave          25 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1

Total # of neighbors = 25
Ave neighs/atom = 0.49019608
Neighbor list builds = 168
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 53

#variable lat0 equal 1                    #
variable lat1 equal 3+(151*0.01)+(v_ind*0.01)  # .491+(v_ind*0.001)       # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 10*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 5.04                                                               
Lattice spacing in x,y,z = 5.04 5.04 5.04

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -75.6 ${n1e1} -100 100 -100 100 units box
region box block -75.6 75.6 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -75.6 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -75.6 75.6 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-75.6 -100 -100) to (75.6 100 100)
  1 by 2 by 2 MPI processor grid
create_atoms 1 region substrate
Created 30 atoms
  using lattice units in orthogonal box = (-75.6 -100 -100) to (75.6 100 100)
  create_atoms CPU = 0.000 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 30 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 21 atoms
  using lattice units in orthogonal box = (-75.6 -100 -100) to (75.6 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  30 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  30 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  21 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  21 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
30 atoms in group substrate
group slider1 region slider1
21 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 21 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_53_*.dump id type diameter mass xu yu zu fx fy fz

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 98 130 130
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 14.63 | 18.1 | 19.26 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   151.2          200            200            0              0              0              0              0              0              0              2.6109412e-16  0              6            
    100000   151.2          200            200            0.002831472    2.4458981e-38  0              0.008494416    12336.931      0              5.9570624e+10  2.6109412e-16  0              3.3256497    
    200000   151.2          200            200            0.0010248309  -1.0189225e-38  0              0.0030744927   3109.3642      0              1.5014007e+10  2.6109412e-16  0              3.070611     
    300000   151.2          200            200            0.00012028383  4.8916161e-38  0              0.00036085149  83.876066      0              4.050075e+08   2.6109412e-16  0              3.0451307    
    400000   151.2          200            200            0.01938938     0.0049167067   0              0.053251432    44.528337      0              2.150114e+08   2.6109412e-16  0              2.9915827    
    500000   151.2          200            200            0.0084095578   0.0020104417   0              0.023218232    17.593072      0              84950646       2.6109412e-16  0              2.9945309    
    600000   151.2          200            200            0.0024873349   0.00036519576  0              0.0070968091   3.5198294      0              16995996       2.6109412e-16  0              2.9967896    
    700000   151.2          200            200            0.002998247    0.0005203181   0              0.0084744229   0.086744987    0              418860.5       2.6109412e-16  0              2.9965564    
    800000   151.2          200            200            0.0038538646   0.00061112227  0              0.010950471    0.050739734    0              245004.02      2.6109412e-16  0              2.9961542    
    900000   151.2          200            200            0.0036988791   0.00060396349  0              0.010492674    0.011791609    0              56937.46       2.6109412e-16  0              2.9962233    
   1000000   151.2          200            200            0.0036333376   0.00060050115  0              0.010299512    4.5040435e-05  0              217.48414      2.6109412e-16  0              2.9962543    
   1100000   151.2          200            200            0.0036766767   0.0006027583   0              0.010427272    0.00015275725  0              737.61008      2.6109412e-16  0              2.9962343    
   1200000   151.2          200            200            0.0036706712   0.00060246085  0              0.010409553    2.66757e-05    0              128.80741      2.6109412e-16  0              2.9962369    
   1300000   151.2          200            200            0.0036668708   0.00060226133  0              0.010398351    1.1482356e-08  0              0.05544419     2.6109412e-16  0              2.9962387    
   1400000   151.2          200            200            0.0036689929   0.00060237056  0              0.010404608    4.3814646e-07  0              2.1156524      2.6109412e-16  0              2.9962377    
   1500000   151.2          200            200            0.0036687762   0.00060235996  0              0.010403969    5.8819257e-08  0              0.28401714     2.6109412e-16  0              2.9962378    
   1600000   151.2          200            200            0.0036685637   0.00060234884  0              0.010403342    3.6245376e-11  0              0.00017501595  2.6109412e-16  0              2.9962379    
   1700000   151.2          200            200            0.0036686662   0.0006023541   0              0.010403645    1.217438e-09   0              0.0058785723   2.6109412e-16  0              2.9962379    
   1800000   151.2          200            200            0.0036686597   0.0006023538   0              0.010403625    1.2555606e-10  0              0.00060626528  2.6109412e-16  0              2.9962379    
   1900000   151.2          200            200            0.003668648    0.00060235319  0              0.010403591    7.4193129e-13  0              3.5825207e-06  2.6109412e-16  0              2.9962379    
   2000000   151.2          200            200            0.0036686529   0.00060235344  0              0.010403605    3.2871086e-12  0              1.5872271e-05  2.6109412e-16  0              2.9962379    
   2100000   151.2          200            200            0.0036686528   0.00060235344  0              0.010403605    2.5807843e-13  0              1.2461684e-06  2.6109412e-16  0              2.9962379    
   2200000   151.2          200            200            0.0036686522   0.0006023534   0              0.010403603    4.9466532e-15  0              2.3885618e-08  2.6109412e-16  0              2.9962379    
   2300000   151.2          200            200            0.0036686524   0.00060235342  0              0.010403604    8.6363519e-15  0              4.1701853e-08  2.6109412e-16  0              2.9962379    
   2400000   151.2          200            200            0.0036686524   0.00060235342  0              0.010403604    5.0559221e-16  0              2.4413239e-09  2.6109412e-16  0              2.9962379    
   2500000   151.2          200            200            0.0036686524   0.00060235341  0              0.010403604    2.3186183e-17  0              1.1195778e-10  2.6109412e-16  0              2.9962379    
   2600000   151.2          200            200            0.0036686524   0.00060235341  0              0.010403604    2.2199832e-17  0              1.0719505e-10  2.6109412e-16  0              2.9962379    
   2700000   151.2          200            200            0.0036686524   0.00060235341  0              0.010403604    2.5225431e-19  0              1.2180458e-12  2.6109412e-16  0              2.9962379    
   2800000   151.2          200            200            0.0036686524   0.00060235341  0              0.010403604    3.7440404e-19  0              1.8078631e-12  2.6109412e-16  0              2.9962379    
   2900000   151.2          200            200            0.0036686524   0.00060235341  0              0.010403604    7.6213797e-20  0              3.6800915e-13  2.6109412e-16  0              2.9962379    
   3000000   151.2          200            200            0.0036686524   0.00060235342  0              0.010403604    2.7055563e-20  0              1.3064163e-13  2.6109412e-16  0              2.9962379    
Loop time of 64.3955 on 4 procs for 3000000 steps with 51 atoms

Performance: 40251235.614 ns/day, 0.000 hours/ns, 46587.078 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 0.32945    | 1.6176     | 5.3121     | 167.8 |  2.51
Neigh   | 0.077566   | 0.078163   | 0.0797     |   0.3 |  0.12
Comm    | 25.705     | 32.183     | 37.925     |  83.0 | 49.98
Output  | 0.061349   | 0.061424   | 0.061475   |   0.0 |  0.10
Modify  | 15.486     | 21.234     | 28.402     | 119.0 | 32.97
Other   |            | 9.221      |            |       | 14.32

Nlocal:          12.75 ave          51 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1
Nghost:          39.25 ave          52 max           1 min
Histogram: 1 0 0 0 0 0 0 0 0 3
Neighs:           6.25 ave          25 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1

Total # of neighbors = 25
Ave neighs/atom = 0.49019608
Neighbor list builds = 166
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 54

#variable lat0 equal 1                    #
variable lat1 equal 3+(151*0.01)+(v_ind*0.01)  # .491+(v_ind*0.001)       # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 10*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 5.05                                                               
Lattice spacing in x,y,z = 5.05 5.05 5.05

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -75.75 ${n1e1} -100 100 -100 100 units box
region box block -75.75 75.75 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -75.75 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -75.75 75.75 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-75.75 -100 -100) to (75.75 100 100)
  1 by 2 by 2 MPI processor grid
create_atoms 1 region substrate
Created 30 atoms
  using lattice units in orthogonal box = (-75.75 -100 -100) to (75.75 100 100)
  create_atoms CPU = 0.000 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 30 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 21 atoms
  using lattice units in orthogonal box = (-75.75 -100 -100) to (75.75 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  30 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  30 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  21 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  21 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
30 atoms in group substrate
group slider1 region slider1
21 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 21 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_54_*.dump id type diameter mass xu yu zu fx fy fz

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 98 130 130
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 14.63 | 18.1 | 19.26 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   151.5          200            200            0              0              0              0              0              0              0              2.6109412e-16  0              6            
    100000   151.5          200            200            0.00282144    -2.0338905e-39  0              0.0084643201   12309.953      0              5.9440357e+10  2.6109412e-16  0              3.3259887    
    200000   151.5          200            200            0.0010109128  -6.1017372e-39  0              0.0030327383   3053.7394      0              1.4745415e+10  2.6109412e-16  0              3.0721939    
    300000   151.5          200            200            8.9183664e-05  1.627756e-37   0              0.00026755099  48.071126      0              2.3211826e+08  2.6109412e-16  0              3.045772     
    400000   151.5          200            200            0.016140024    0.0040302081   0              0.044389863    97.38518       0              4.7023818e+08  2.6109412e-16  0              2.991591     
    500000   151.5          200            200            0.00043446674  1.8645361e-36  0              0.0013034002   0.20431233     0              986551.13      2.6109412e-16  0              2.9987911    
    600000   151.5          200            200            0.0045014726   0.00047009814  0              0.01303432     3.9146484      0              18902436       2.6109412e-16  0              2.995135     
    700000   151.5          200            200            0.0029160973   0.00012265149  0              0.0086256404   0.066124209    0              319290.14      2.6109412e-16  0              2.995901     
    800000   151.5          200            200            0.0034112548   0.00027166696  0              0.0099620975   0.057433012    0              277323.46      2.6109412e-16  0              2.995639     
    900000   151.5          200            200            0.0035306754   0.00027225021  0              0.010319776    0.011417446    0              55130.763      2.6109412e-16  0              2.9955748    
   1000000   151.5          200            200            0.0035558703   0.00027358641  0              0.010394025    0.0015947651   0              7700.5499      2.6109412e-16  0              2.9955619    
   1100000   151.5          200            200            0.0035571743   0.00027363839  0              0.010397885    0.0001655541   0              799.40149      2.6109412e-16  0              2.9955614    
   1200000   151.5          200            200            0.0035547122   0.00027349968  0              0.010390637    1.1643981e-05  0              56.224615      2.6109412e-16  0              2.9955628    
   1300000   151.5          200            200            0.0035528551   0.00027339757  0              0.010385168    3.5698925e-07  0              1.7237733      2.6109412e-16  0              2.9955637    
   1400000   151.5          200            200            0.0035519165   0.00027334635  0              0.010382403    2.7303896e-09  0              0.013184074    2.6109412e-16  0              2.9955642    
   1500000   151.5          200            200            0.0035515246   0.00027332508  0              0.010381249    1.3607121e-08  0              0.065703919    2.6109412e-16  0              2.9955645    
   1600000   151.5          200            200            0.003551383    0.00027331744  0              0.010380832    5.3091506e-09  0              0.025635988    2.6109412e-16  0              2.9955645    
   1700000   151.5          200            200            0.0035513391   0.00027331509  0              0.010380702    1.165946e-09   0              0.0056299362   2.6109412e-16  0              2.9955646    
   1800000   151.5          200            200            0.0035513281   0.00027331451  0              0.01038067     1.8330381e-10  0              0.00088510849  2.6109412e-16  0              2.9955646    
   1900000   151.5          200            200            0.0035513265   0.00027331443  0              0.010380665    2.1689469e-11  0              0.00010473068  2.6109412e-16  0              2.9955646    
   2000000   151.5          200            200            0.0035513269   0.00027331445  0              0.010380666    1.8477638e-12  0              8.9221903e-06  2.6109412e-16  0              2.9955646    
   2100000   151.5          200            200            0.0035513274   0.00027331448  0              0.010380668    9.0765955e-14  0              4.3827631e-07  2.6109412e-16  0              2.9955646    
   2200000   151.5          200            200            0.0035513277   0.00027331449  0              0.010380669    5.077436e-16   0              2.4517121e-09  2.6109412e-16  0              2.9955646    
   2300000   151.5          200            200            0.0035513279   0.0002733145   0              0.010380669    6.4765566e-16  0              3.1272974e-09  2.6109412e-16  0              2.9955646    
   2400000   151.5          200            200            0.0035513279   0.0002733145   0              0.010380669    4.2213961e-16  0              2.0383611e-09  2.6109412e-16  0              2.9955646    
   2500000   151.5          200            200            0.0035513279   0.0002733145   0              0.010380669    1.1250088e-16  0              5.4322647e-10  2.6109412e-16  0              2.9955646    
   2600000   151.5          200            200            0.0035513279   0.0002733145   0              0.010380669    1.9761159e-17  0              9.5419566e-11  2.6109412e-16  0              2.9955646    
   2700000   151.5          200            200            0.0035513279   0.0002733145   0              0.010380669    2.1660754e-18  0              1.0459203e-11  2.6109412e-16  0              2.9955646    
   2800000   151.5          200            200            0.0035513279   0.0002733145   0              0.010380669    2.9270503e-20  0              1.4133678e-13  2.6109412e-16  0              2.9955646    
   2900000   151.5          200            200            0.0035513279   0.0002733145   0              0.010380669    1.1716301e-19  0              5.6573824e-13  2.6109412e-16  0              2.9955646    
   3000000   151.5          200            200            0.0035513279   0.0002733145   0              0.010380669    1.2083961e-19  0              5.8349121e-13  2.6109412e-16  0              2.9955646    
Loop time of 63.9989 on 4 procs for 3000000 steps with 51 atoms

Performance: 40500676.885 ns/day, 0.000 hours/ns, 46875.783 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 0.32979    | 1.5821     | 5.2158     | 166.8 |  2.47
Neigh   | 0.07665    | 0.077229   | 0.078759   |   0.3 |  0.12
Comm    | 25.704     | 32.094     | 37.827     |  82.4 | 50.15
Output  | 0.058078   | 0.058153   | 0.058202   |   0.0 |  0.09
Modify  | 15.328     | 21.037     | 28.154     | 119.3 | 32.87
Other   |            | 9.151      |            |       | 14.30

Nlocal:          12.75 ave          51 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1
Nghost:          39.25 ave          52 max           1 min
Histogram: 1 0 0 0 0 0 0 0 0 3
Neighs:           6.25 ave          25 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1

Total # of neighbors = 25
Ave neighs/atom = 0.49019608
Neighbor list builds = 164
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 55

#variable lat0 equal 1                    #
variable lat1 equal 3+(151*0.01)+(v_ind*0.01)  # .491+(v_ind*0.001)       # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 10*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 5.06                                                               
Lattice spacing in x,y,z = 5.06 5.06 5.06

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -75.9 ${n1e1} -100 100 -100 100 units box
region box block -75.9 75.9 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -75.9 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -75.9 75.9 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-75.9 -100 -100) to (75.9 100 100)
  1 by 2 by 2 MPI processor grid
create_atoms 1 region substrate
Created 30 atoms
  using lattice units in orthogonal box = (-75.9 -100 -100) to (75.9 100 100)
  create_atoms CPU = 0.000 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 30 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 21 atoms
  using lattice units in orthogonal box = (-75.9 -100 -100) to (75.9 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  30 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  30 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  21 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  21 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
30 atoms in group substrate
group slider1 region slider1
21 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 21 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_55_*.dump id type diameter mass xu yu zu fx fy fz

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 98 130 130
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 14.63 | 18.1 | 19.26 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   151.8          200            200            0              0              0              0              0              0              0              2.6109412e-16  0              6            
    100000   151.8          200            200            0.0028104934  -8.1115152e-38  0              0.0084314801   12276.065      0              5.9276725e+10  2.6109412e-16  0              3.3268235    
    200000   151.8          200            200            0.00099256726  1.218155e-38   0              0.0029777018   2976.7796      0              1.4373803e+10  2.6109412e-16  0              3.0751758    
    300000   151.8          200            200            6.8384958e-05  2.6029105e-37  0              0.00020515487  29.149913      0              1.407545e+08   2.6109412e-16  0              3.0457214    
    400000   151.8          200            200            0.0025213297  -4.2065013e-36  0              0.0075639892   207.14943      0              1.0002504e+09  2.6109412e-16  0              2.9963224    
    500000   151.8          200            200            0.00093984954  6.4575347e-36  0              0.0028195486   7.6762878      0              37066046       2.6109412e-16  0              2.99804      
    600000   151.8          200            200            0.0028066059   2.427784e-36   0              0.0084198178   2.8022562      0              13531093       2.6109412e-16  0              2.9958137    
    700000   151.8          200            200            0.0031449463   3.6585331e-37  0              0.009434839    0.27008059     0              1304122.5      2.6109412e-16  0              2.9954984    
    800000   151.8          200            200            0.0033581529   4.2711227e-37  0              0.010074459    0.047933386    0              231453.17      2.6109412e-16  0              2.9953007    
    900000   151.8          200            200            0.0034252511   1.7884609e-38  0              0.010275753    0.0077520393   0              37431.823      2.6109412e-16  0              2.9952397    
   1000000   151.8          200            200            0.0034455855  -6.8471716e-38  0              0.010336757    0.0011858988   0              5726.2811      2.6109412e-16  0              2.9952215    
   1100000   151.8          200            200            0.0034513427  -9.705279e-39   0              0.010354028    0.00017333624  0              836.97865      2.6109412e-16  0              2.9952164    
   1200000   151.8          200            200            0.003452788   -5.9931275e-39  0              0.010358364    2.4308686e-05  0              117.37795      2.6109412e-16  0              2.9952151    
   1300000   151.8          200            200            0.0034530623   5.8228552e-40  0              0.010359187    3.2763547e-06  0              15.820344      2.6109412e-16  0              2.9952149    
   1400000   151.8          200            200            0.0034530666  -4.7552054e-40  0              0.0103592      4.2435869e-07  0              2.0490762      2.6109412e-16  0              2.9952149    
   1500000   151.8          200            200            0.0034530327  -4.6332617e-39  0              0.010359098    5.2724477e-08  0              0.25458763     2.6109412e-16  0              2.995215     
   1600000   151.8          200            200            0.0034530074  -1.0579858e-39  0              0.010359022    6.2603743e-09  0              0.030229107    2.6109412e-16  0              2.995215     
   1700000   151.8          200            200            0.0034529935  -2.5093851e-39  0              0.010358981    7.0584694e-10  0              0.0034082823   2.6109412e-16  0              2.995215     
   1800000   151.8          200            200            0.0034529868   1.8275609e-40  0              0.010358961    7.4777022e-11  0              0.00036107148  2.6109412e-16  0              2.995215     
   1900000   151.8          200            200            0.0034529839   1.9413176e-39  0              0.010358952    7.3135934e-12  0              3.5314725e-05  2.6109412e-16  0              2.995215     
   2000000   151.8          200            200            0.0034529826   4.2992991e-39  0              0.010358948    6.3985306e-13  0              3.0896214e-06  2.6109412e-16  0              2.995215     
   2100000   151.8          200            200            0.0034529821  -4.4091552e-39  0              0.010358946    4.6993533e-14  0              2.2691495e-07  2.6109412e-16  0              2.995215     
   2200000   151.8          200            200            0.0034529819  -8.9515119e-39  0              0.010358946    2.4691398e-15  0              1.1922592e-08  2.6109412e-16  0              2.995215     
   2300000   151.8          200            200            0.0034529818  -1.8497826e-40  0              0.010358945    4.6703163e-17  0              2.2551286e-10  2.6109412e-16  0              2.995215     
   2400000   151.8          200            200            0.0034529818  -3.4756535e-39  0              0.010358945    3.4702728e-18  0              1.6756705e-11  2.6109412e-16  0              2.995215     
   2500000   151.8          200            200            0.0034529817   5.5451377e-39  0              0.010358945    4.9532817e-18  0              2.3917625e-11  2.6109412e-16  0              2.995215     
   2600000   151.8          200            200            0.0034529817  -8.6372827e-39  0              0.010358945    1.9617217e-18  0              9.4724519e-12  2.6109412e-16  0              2.995215     
   2700000   151.8          200            200            0.0034529817  -3.382426e-40   0              0.010358945    3.7429322e-19  0              1.807328e-12   2.6109412e-16  0              2.995215     
   2800000   151.8          200            200            0.0034529817   3.9791761e-42  0              0.010358945    1.0022116e-19  0              4.8393212e-13  2.6109412e-16  0              2.995215     
   2900000   151.8          200            200            0.0034529817   1.2701076e-38  0              0.010358945    2.0604001e-20  0              9.9489345e-14  2.6109412e-16  0              2.995215     
   3000000   151.8          200            200            0.0034529817   1.442136e-38   0              0.010358945    1.5019037e-20  0              7.2521553e-14  2.6109412e-16  0              2.995215     
Loop time of 64.4555 on 4 procs for 3000000 steps with 51 atoms

Performance: 40213814.309 ns/day, 0.000 hours/ns, 46543.767 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 0.31176    | 1.5725     | 5.1548     | 165.0 |  2.44
Neigh   | 0.076674   | 0.077239   | 0.078787   |   0.3 |  0.12
Comm    | 25.766     | 32.401     | 38.122     |  84.2 | 50.27
Output  | 0.062324   | 0.062401   | 0.062458   |   0.0 |  0.10
Modify  | 15.45      | 21.22      | 28.491     | 120.3 | 32.92
Other   |            | 9.122      |            |       | 14.15

Nlocal:          12.75 ave          51 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1
Nghost:          39.25 ave          52 max           1 min
Histogram: 1 0 0 0 0 0 0 0 0 3
Neighs:           6.75 ave          27 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1

Total # of neighbors = 27
Ave neighs/atom = 0.52941176
Neighbor list builds = 164
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 56

#variable lat0 equal 1                    #
variable lat1 equal 3+(151*0.01)+(v_ind*0.01)  # .491+(v_ind*0.001)       # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 10*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 5.07                                                               
Lattice spacing in x,y,z = 5.07 5.07 5.07

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -76.05 ${n1e1} -100 100 -100 100 units box
region box block -76.05 76.05 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -76.05 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -76.05 76.05 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-76.05 -100 -100) to (76.05 100 100)
  1 by 2 by 2 MPI processor grid
create_atoms 1 region substrate
Created 29 atoms
  using lattice units in orthogonal box = (-76.05 -100 -100) to (76.05 100 100)
  create_atoms CPU = 0.000 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 30 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 21 atoms
  using lattice units in orthogonal box = (-76.05 -100 -100) to (76.05 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  29 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  29 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  21 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  21 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
29 atoms in group substrate
group slider1 region slider1
21 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 21 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_56_*.dump id type diameter mass xu yu zu fx fy fz

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 99 130 130
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 14.65 | 18.12 | 19.28 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   152.1          200            200            0              0              0              0              0              0              0              2.6109412e-16  0              6            
    100000   152.1          200            200            0.0027988078  -1.1342605e-37  0              0.0083964235   12236.124      0              6.5648738e+10  2.6109412e-16  0              3.328219     
    200000   152.1          200            200            0.00097498247  7.9447079e-42  0              0.0029249474   2903.4943      0              1.5577705e+10  2.6109412e-16  0              3.0781466    
    300000   152.1          200            200            5.0230606e-05  5.215645e-37   0              0.00015069182  16.187602      0              86849040       2.6109412e-16  0              3.0454095    
    400000   152.1          200            200            0.00011871892  2.6624986e-38  0              0.00035615675  84.775323      0              4.5483299e+08  2.6109412e-16  0              3.0028112    
    500000   152.1          200            200            0.0011122146  -7.7205654e-36  0              0.0033366439   9.7565933      0              52345663       2.6109412e-16  0              2.9978016    
    600000   152.1          200            200            0.0023238226   1.5110847e-36  0              0.0069714679   0.1458888      0              782716.45      2.6109412e-16  0              2.9963166    
    700000   152.1          200            200            0.0030520014   6.9718214e-37  0              0.0091560041   0.094890343    0              509101.67      2.6109412e-16  0              2.9955841    
    800000   152.1          200            200            0.0033119226   7.8519805e-38  0              0.0099357678   0.022591577    0              121207.38      2.6109412e-16  0              2.9953386    
    900000   152.1          200            200            0.0034017882   1.690377e-37   0              0.010205365    0.0044342482   0              23790.442      2.6109412e-16  0              2.9952555    
   1000000   152.1          200            200            0.0034320199  -4.3704319e-38  0              0.01029606     0.00078899813  0              4233.0995      2.6109412e-16  0              2.9952278    
   1100000   152.1          200            200            0.0034418696  -2.1261859e-38  0              0.010325609    0.00013096754  0              702.66156      2.6109412e-16  0              2.9952189    
   1200000   152.1          200            200            0.0034449525  -8.8780597e-40  0              0.010334858    2.0566334e-05  0              110.34163      2.6109412e-16  0              2.9952161    
   1300000   152.1          200            200            0.0034458654   1.2523055e-38  0              0.010337596    3.0799515e-06  0              16.524426      2.6109412e-16  0              2.9952153    
   1400000   152.1          200            200            0.0034461133   1.8077637e-39  0              0.01033834     4.4194629e-07  0              2.3711117      2.6109412e-16  0              2.9952151    
   1500000   152.1          200            200            0.0034461704  -4.2901504e-39  0              0.010338511    6.0913435e-08  0              0.3268102      2.6109412e-16  0              2.995215     
   1600000   152.1          200            200            0.0034461784  -5.8201671e-39  0              0.010338535    8.0704812e-09  0              0.043299406    2.6109412e-16  0              2.995215     
   1700000   152.1          200            200            0.0034461765  -4.140933e-39   0              0.01033853     1.0269716e-09  0              0.005509865    2.6109412e-16  0              2.995215     
   1800000   152.1          200            200            0.0034461741   3.7231566e-39  0              0.010338522    1.2518979e-10  0              0.00067166301  2.6109412e-16  0              2.995215     
   1900000   152.1          200            200            0.0034461725   2.6067658e-39  0              0.010338518    1.4549564e-11  0              7.8060708e-05  2.6109412e-16  0              2.995215     
   2000000   152.1          200            200            0.0034461718   6.1697563e-40  0              0.010338515    1.5992969e-12  0              8.5804803e-06  2.6109412e-16  0              2.995215     
   2100000   152.1          200            200            0.0034461714   5.8700924e-39  0              0.010338514    1.6406679e-13  0              8.8024424e-07  2.6109412e-16  0              2.995215     
   2200000   152.1          200            200            0.0034461712   1.1565475e-39  0              0.010338514    1.5376628e-14  0              8.2498036e-08  2.6109412e-16  0              2.995215     
   2300000   152.1          200            200            0.0034461712   3.7091742e-39  0              0.010338513    1.2639769e-15  0              6.7814354e-09  2.6109412e-16  0              2.995215     
   2400000   152.1          200            200            0.0034461711   1.3852647e-39  0              0.010338513    8.5340139e-17  0              4.5786332e-10  2.6109412e-16  0              2.995215     
   2500000   152.1          200            200            0.0034461711  -6.8142703e-39  0              0.010338513    3.7928981e-18  0              2.0349497e-11  2.6109412e-16  0              2.995215     
   2600000   152.1          200            200            0.0034461711   1.411113e-39   0              0.010338513    4.7048226e-21  0              2.5242116e-14  2.6109412e-16  0              2.995215     
   2700000   152.1          200            200            0.0034461711  -7.3509273e-39  0              0.010338513    6.0447825e-20  0              3.2431212e-13  2.6109412e-16  0              2.995215     
   2800000   152.1          200            200            0.0034461711   9.462031e-39   0              0.010338513    5.8021297e-20  0              3.1129342e-13  2.6109412e-16  0              2.995215     
   2900000   152.1          200            200            0.0034461711   1.2194257e-39  0              0.010338513    7.7636854e-21  0              4.1653398e-14  2.6109412e-16  0              2.995215     
   3000000   152.1          200            200            0.0034461711   3.5649738e-40  0              0.010338513    1.2078421e-19  0              6.4802635e-13  2.6109412e-16  0              2.995215     
Loop time of 62.8491 on 4 procs for 3000000 steps with 50 atoms

Performance: 41241643.487 ns/day, 0.000 hours/ns, 47733.384 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 0.30589    | 1.5195     | 4.9738     | 161.9 |  2.42
Neigh   | 0.077398   | 0.077954   | 0.079551   |   0.3 |  0.12
Comm    | 25.196     | 31.428     | 36.968     |  81.1 | 50.01
Output  | 0.061986   | 0.062064   | 0.062118   |   0.0 |  0.10
Modify  | 15.065     | 20.679     | 27.53      | 116.3 | 32.90
Other   |            | 9.082      |            |       | 14.45

Nlocal:           12.5 ave          50 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1
Nghost:           37.5 ave          50 max           0 min
Histogram: 1 0 0 0 0 0 0 0 0 3
Neighs:           6.75 ave          27 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1

Total # of neighbors = 27
Ave neighs/atom = 0.54
Neighbor list builds = 164
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 57

#variable lat0 equal 1                    #
variable lat1 equal 3+(151*0.01)+(v_ind*0.01)  # .491+(v_ind*0.001)       # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 10*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 5.08                                                               
Lattice spacing in x,y,z = 5.08 5.08 5.08

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -76.2 ${n1e1} -100 100 -100 100 units box
region box block -76.2 76.2 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -76.2 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -76.2 76.2 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-76.2 -100 -100) to (76.2 100 100)
  1 by 2 by 2 MPI processor grid
create_atoms 1 region substrate
Created 30 atoms
  using lattice units in orthogonal box = (-76.2 -100 -100) to (76.2 100 100)
  create_atoms CPU = 0.000 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 30 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 21 atoms
  using lattice units in orthogonal box = (-76.2 -100 -100) to (76.2 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  30 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  30 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  21 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  21 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
30 atoms in group substrate
group slider1 region slider1
21 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 21 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_57_*.dump id type diameter mass xu yu zu fx fy fz

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 99 130 130
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 14.65 | 18.12 | 19.28 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   152.4          200            200            0              0              0              0              0              0              0              2.6109412e-16  0              6            
    100000   152.4          200            200            0.0027868233   2.9359925e-43  0              0.0083604698   12193.066      0              5.8875951e+10  2.6109412e-16  0              3.330044     
    200000   152.4          200            200            0.00096173388 -1.6162182e-37  0              0.0028852016   2850.8939      0              1.3765947e+10  2.6109412e-16  0              3.0799891    
    300000   152.4          200            200            2.8568102e-05 -7.6552487e-37  0              8.5704306e-05  5.4290645      0              26215010       2.6109412e-16  0              3.0450362    
    400000   152.4          200            200            8.1469823e-06  1.5967388e-36  0              2.4440947e-05  0.47202387     0              2279234.3      2.6109412e-16  0              3.0064435    
    500000   152.4          200            200            0.0067651861  -1.3846626e-35  0              0.020295558    2.5672582      0              12396371       2.6109412e-16  0              2.9924698    
    600000   152.4          200            200            0.0044203253  -2.40056e-35    0              0.013260976    1.4736964      0              7115952.7      2.6109412e-16  0              2.9943551    
    700000   152.4          200            200            0.0037255966   1.1893098e-36  0              0.01117679     0.32101577     0              1550070.3      2.6109412e-16  0              2.9949589    
    800000   152.4          200            200            0.0035249101   1.7009443e-36  0              0.01057473     0.05364896     0              259051.63      2.6109412e-16  0              2.9951385    
    900000   152.4          200            200            0.0034634963   1.7514904e-38  0              0.010390489    0.0083912106   0              40518.153      2.6109412e-16  0              2.9951937    
   1000000   152.4          200            200            0.003445396    5.3046625e-38  0              0.010336188    0.0012530807   0              6050.6784      2.6109412e-16  0              2.9952098    
   1100000   152.4          200            200            0.0034405007   1.9943844e-39  0              0.010321502    0.0001794469   0              866.48486      2.6109412e-16  0              2.9952141    
   1200000   152.4          200            200            0.0034393847   2.1727254e-39  0              0.010318154    2.4691136e-05  0              119.22466      2.6109412e-16  0              2.9952151    
   1300000   152.4          200            200            0.0034392347   1.0954054e-38  0              0.010317704    3.2659895e-06  0              15.770295      2.6109412e-16  0              2.9952152    
   1400000   152.4          200            200            0.0034392765  -2.1803859e-39  0              0.010317829    4.1489349e-07  0              2.0033722      2.6109412e-16  0              2.9952151    
   1500000   152.4          200            200            0.0034393272  -4.3554463e-39  0              0.010317982    5.0482782e-08  0              0.24376329     2.6109412e-16  0              2.9952151    
   1600000   152.4          200            200            0.0034393585   2.5050704e-42  0              0.010318076    5.8547682e-09  0              0.028270581    2.6109412e-16  0              2.995215     
   1700000   152.4          200            200            0.0034393745   5.5389622e-39  0              0.010318123    6.4196399e-10  0              0.0030998143   2.6109412e-16  0              2.995215     
   1800000   152.4          200            200            0.0034393819  -7.3210659e-40  0              0.010318146    6.5665615e-11  0              0.00031707575  2.6109412e-16  0              2.995215     
   1900000   152.4          200            200            0.0034393851  -7.7417618e-39  0              0.010318155    6.123676e-12   0              2.956904e-05   2.6109412e-16  0              2.995215     
   2000000   152.4          200            200            0.0034393864  -1.2932758e-39  0              0.010318159    4.9867245e-13  0              2.4079108e-06  2.6109412e-16  0              2.995215     
   2100000   152.4          200            200            0.003439387   -8.6727307e-39  0              0.010318161    3.2253491e-14  0              1.5574057e-07  2.6109412e-16  0              2.995215     
   2200000   152.4          200            200            0.0034393872  -1.1153488e-38  0              0.010318162    1.2444566e-15  0              6.0090355e-09  2.6109412e-16  0              2.995215     
   2300000   152.4          200            200            0.0034393873  -1.173762e-38   0              0.010318162    2.0454436e-18  0              9.8767153e-12  2.6109412e-16  0              2.995215     
   2400000   152.4          200            200            0.0034393873   1.4368726e-38  0              0.010318162    1.3088086e-17  0              6.3197683e-11  2.6109412e-16  0              2.995215     
   2500000   152.4          200            200            0.0034393873  -2.5815552e-38  0              0.010318162    7.7002593e-18  0              3.7181797e-11  2.6109412e-16  0              2.995215     
   2600000   152.4          200            200            0.0034393873   7.257781e-39   0              0.010318162    2.7884313e-18  0              1.3464337e-11  2.6109412e-16  0              2.995215     
   2700000   152.4          200            200            0.0034393873   1.6568406e-38  0              0.010318162    6.7501782e-19  0              3.2594195e-12  2.6109412e-16  0              2.995215     
   2800000   152.4          200            200            0.0034393873  -3.9126298e-39  0              0.010318162    1.920875e-19   0              9.275218e-13   2.6109412e-16  0              2.995215     
   2900000   152.4          200            200            0.0034393873   1.4601474e-38  0              0.010318162    3.1227738e-23  0              1.5078757e-16  2.6109412e-16  0              2.995215     
   3000000   152.4          200            200            0.0034393873  -8.7255855e-39  0              0.010318162    1.4521892e-19  0              7.0121021e-13  2.6109412e-16  0              2.995215     
Loop time of 64.0609 on 4 procs for 3000000 steps with 51 atoms

Performance: 40461468.473 ns/day, 0.000 hours/ns, 46830.403 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 0.33102    | 1.5618     | 5.1059     | 163.8 |  2.44
Neigh   | 0.077388   | 0.077969   | 0.079528   |   0.3 |  0.12
Comm    | 25.783     | 32.207     | 37.939     |  82.7 | 50.28
Output  | 0.059676   | 0.059752   | 0.059806   |   0.0 |  0.09
Modify  | 15.208     | 20.966     | 28.055     | 119.1 | 32.73
Other   |            | 9.189      |            |       | 14.34

Nlocal:          12.75 ave          51 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1
Nghost:          39.25 ave          52 max           1 min
Histogram: 1 0 0 0 0 0 0 0 0 3
Neighs:           6.75 ave          27 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1

Total # of neighbors = 27
Ave neighs/atom = 0.52941176
Neighbor list builds = 164
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 58

#variable lat0 equal 1                    #
variable lat1 equal 3+(151*0.01)+(v_ind*0.01)  # .491+(v_ind*0.001)       # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 10*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 5.09                                                               
Lattice spacing in x,y,z = 5.09 5.09 5.09

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -76.35 ${n1e1} -100 100 -100 100 units box
region box block -76.35 76.35 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -76.35 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -76.35 76.35 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-76.35 -100 -100) to (76.35 100 100)
  1 by 2 by 2 MPI processor grid
create_atoms 1 region substrate
Created 30 atoms
  using lattice units in orthogonal box = (-76.35 -100 -100) to (76.35 100 100)
  create_atoms CPU = 0.000 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 30 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 21 atoms
  using lattice units in orthogonal box = (-76.35 -100 -100) to (76.35 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  30 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  30 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  21 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  21 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
30 atoms in group substrate
group slider1 region slider1
21 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 21 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_58_*.dump id type diameter mass xu yu zu fx fy fz

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 99 130 130
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 14.65 | 18.12 | 19.28 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   152.7          200            200            0              0              0              0              0              0              0              2.6109412e-16  0              6            
    100000   152.7          200            200            0.0027755697  -1.4125366e-38  0              0.0083267091   12154.484      0              5.8689655e+10  2.6109412e-16  0              3.3317211    
    200000   152.7          200            200            0.00094988405  2.5876291e-37  0              0.0028496521   2804.9273      0              1.354399e+10   2.6109412e-16  0              3.0814639    
    300000   152.7          200            200            1.3202472e-06  3.1361565e-36  0              3.9607416e-06  0.013366935    0              64544.146      2.6109412e-16  0              3.0445066    
    400000   152.7          200            200           -9.3314012e-05  1.0997348e-36  0             -0.00027994204  73.005453      0              3.5251721e+08  2.6109412e-16  0              3.0027933    
    500000   152.7          200            200            0.0042858778   3.3061667e-36  0              0.012857633    27.746458      0              1.3397771e+08  2.6109412e-16  0              2.9945074    
    600000   152.7          200            200            0.002805794   -1.2800126e-35  0              0.0084173821   2.82129        0              13623000       2.6109412e-16  0              2.9958375    
    700000   152.7          200            200            0.0031266315  -4.3325359e-37  0              0.0093798946   0.26803297     0              1294235.3      2.6109412e-16  0              2.99551      
    800000   152.7          200            200            0.0033039846  -3.3449153e-37  0              0.0099119537   0.025629412    0              123755.26      2.6109412e-16  0              2.9953372    
    900000   152.7          200            200            0.0033807205   2.915302e-37   0              0.010142161    0.0022130331   0              10685.945      2.6109412e-16  0              2.9952639    
   1000000   152.7          200            200            0.0034122456   7.8051442e-37  0              0.010236737    0.00015900425  0              767.77461      2.6109412e-16  0              2.9952341    
   1100000   152.7          200            200            0.0034248076   3.8322739e-38  0              0.010274423    7.9371685e-06  0              38.325746      2.6109412e-16  0              2.9952223    
   1200000   152.7          200            200            0.0034296905  -2.321954e-38   0              0.010289071    1.1938235e-07  0              0.57645464     2.6109412e-16  0              2.9952178    
   1300000   152.7          200            200            0.0034315473  -2.8212503e-38  0              0.010294642    1.6795357e-08  0              0.08109877     2.6109412e-16  0              2.995216     
   1400000   152.7          200            200            0.0034322391   1.7905059e-38  0              0.010296717    1.9929877e-08  0              0.096234243    2.6109412e-16  0              2.9952154    
   1500000   152.7          200            200            0.0034324918  -1.6140451e-38  0              0.010297475    7.2773218e-09  0              0.035139583    2.6109412e-16  0              2.9952151    
   1600000   152.7          200            200            0.0034325823   6.5796934e-39  0              0.010297747    1.8526161e-09  0              0.0089456199   2.6109412e-16  0              2.9952151    
   1700000   152.7          200            200            0.003432614   -2.8702336e-39  0              0.010297842    3.9251068e-10  0              0.0018952936   2.6109412e-16  0              2.995215     
   1800000   152.7          200            200            0.0034326249   8.7790429e-39  0              0.010297875    7.4102385e-11  0              0.0003578139   2.6109412e-16  0              2.995215     
   1900000   152.7          200            200            0.0034326285  -5.3667589e-39  0              0.010297886    1.2889218e-11  0              6.2237419e-05  2.6109412e-16  0              2.995215     
   2000000   152.7          200            200            0.0034326297   1.1212675e-38  0              0.010297889    2.1040461e-12  0              1.0159686e-05  2.6109412e-16  0              2.995215     
   2100000   152.7          200            200            0.00343263     1.011006e-38   0              0.01029789     3.2585021e-13  0              1.5734141e-06  2.6109412e-16  0              2.995215     
   2200000   152.7          200            200            0.0034326301  -8.6381099e-39  0              0.01029789     4.822212e-14   0              2.3284736e-07  2.6109412e-16  0              2.995215     
   2300000   152.7          200            200            0.0034326302   9.4899996e-39  0              0.01029789     6.843726e-15   0              3.3045904e-08  2.6109412e-16  0              2.995215     
   2400000   152.7          200            200            0.0034326302   3.9956874e-39  0              0.010297891    9.332885e-16   0              4.5065162e-09  2.6109412e-16  0              2.995215     
   2500000   152.7          200            200            0.0034326302   3.174365e-39   0              0.010297891    1.2216287e-16  0              5.8988077e-10  2.6109412e-16  0              2.995215     
   2600000   152.7          200            200            0.0034326302  -1.1088846e-38  0              0.010297891    1.495364e-17   0              7.2205776e-11  2.6109412e-16  0              2.995215     
   2700000   152.7          200            200            0.0034326302   7.6705149e-39  0              0.010297891    1.8397029e-18  0              8.8832668e-12  2.6109412e-16  0              2.995215     
   2800000   152.7          200            200            0.0034326302   7.0386616e-39  0              0.010297891    1.0079675e-19  0              4.8671145e-13  2.6109412e-16  0              2.995215     
   2900000   152.7          200            200            0.0034326302   1.3307785e-38  0              0.010297891    5.4825358e-20  0              2.6473203e-13  2.6109412e-16  0              2.995215     
   3000000   152.7          200            200            0.0034326302  -2.1891586e-38  0              0.010297891    2.6944903e-20  0              1.301073e-13   2.6109412e-16  0              2.995215     
Loop time of 64.1863 on 4 procs for 3000000 steps with 51 atoms

Performance: 40382426.954 ns/day, 0.000 hours/ns, 46738.920 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 0.326      | 1.572      | 5.1632     | 165.4 |  2.45
Neigh   | 0.07837    | 0.078926   | 0.080475   |   0.3 |  0.12
Comm    | 25.776     | 32.237     | 37.935     |  82.8 | 50.22
Output  | 0.060985   | 0.061062   | 0.061116   |   0.0 |  0.10
Modify  | 15.389     | 21.095     | 28.239     | 119.4 | 32.87
Other   |            | 9.142      |            |       | 14.24

Nlocal:          12.75 ave          51 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1
Nghost:          39.25 ave          52 max           1 min
Histogram: 1 0 0 0 0 0 0 0 0 3
Neighs:           6.75 ave          27 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1

Total # of neighbors = 27
Ave neighs/atom = 0.52941176
Neighbor list builds = 166
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 59

#variable lat0 equal 1                    #
variable lat1 equal 3+(151*0.01)+(v_ind*0.01)  # .491+(v_ind*0.001)       # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 10*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 5.1                                                               
Lattice spacing in x,y,z = 5.1 5.1 5.1

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -76.5 ${n1e1} -100 100 -100 100 units box
region box block -76.5 76.5 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -76.5 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -76.5 76.5 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-76.5 -100 -100) to (76.5 100 100)
  1 by 2 by 2 MPI processor grid
create_atoms 1 region substrate
Created 30 atoms
  using lattice units in orthogonal box = (-76.5 -100 -100) to (76.5 100 100)
  create_atoms CPU = 0.000 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 30 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 21 atoms
  using lattice units in orthogonal box = (-76.5 -100 -100) to (76.5 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  30 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  30 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  21 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  21 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
30 atoms in group substrate
group slider1 region slider1
21 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 21 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_59_*.dump id type diameter mass xu yu zu fx fy fz

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 99 130 130
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 14.65 | 18.12 | 19.28 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   153            200            200            0              0              0              0              0              0              0              2.6109412e-16  0              6            
    100000   153            200            200            0.002766474   -4.0261754e-39  0              0.0082994219   12131.373      0              5.8578061e+10  2.6109412e-16  0              3.3322738    
    200000   153            200            200            0.00093797373  2.6322225e-37  0              0.0028139212   2758.6534      0              1.332055e+10   2.6109412e-16  0              3.082988     
    300000   153            200            200           -3.1478536e-05  2.6157008e-36  0             -9.4435608e-05  7.2187125      0              34856579       2.6109412e-16  0              3.0435401    
    400000   153            200            200            0.0014450687   1.8721237e-35  0              0.0043352061   182.6596       0              8.8199785e+08  2.6109412e-16  0              2.9971393    
    500000   153            200            200            0.0020620328  -1.6005909e-36  0              0.0061860985   23.423887      0              1.1310557e+08  2.6109412e-16  0              2.996656     
    600000   153            200            200            0.0023345536  -2.1652781e-36  0              0.0070036608   0.3216308      0              1553040        2.6109412e-16  0              2.9963026    
    700000   153            200            200            0.0029957587   4.8535376e-36  0              0.0089872762   0.0018375344   0              8872.7961      2.6109412e-16  0              2.9956253    
    800000   153            200            200            0.0032663626  -1.6990115e-36  0              0.0097990878   0.00065810243  0              3177.7411      2.6109412e-16  0              2.9953646    
    900000   153            200            200            0.0033683139   1.8603868e-36  0              0.010104942    0.00055085486  0              2659.881       2.6109412e-16  0              2.9952686    
   1000000   153            200            200            0.0034055862   9.4373243e-38  0              0.010216759    0.00018420785  0              889.47378      2.6109412e-16  0              2.9952338    
   1100000   153            200            200            0.0034189003   1.4766309e-37  0              0.010256701    4.4987653e-05  0              217.22927      2.6109412e-16  0              2.9952215    
   1200000   153            200            200            0.0034235503  -2.5895369e-39  0              0.010270651    9.2968917e-06  0              44.891363      2.6109412e-16  0              2.9952172    
   1300000   153            200            200            0.0034251353   4.9970174e-38  0              0.010275406    1.725319e-06   0              8.3309478      2.6109412e-16  0              2.9952157    
   1400000   153            200            200            0.0034256607  -4.6077253e-40  0              0.010276982    2.9622588e-07  0              1.4303688      2.6109412e-16  0              2.9952152    
   1500000   153            200            200            0.003425829    3.2324748e-39  0              0.010277487    4.7849555e-08  0              0.23104837     2.6109412e-16  0              2.9952151    
   1600000   153            200            200            0.0034258804   1.0924881e-38  0              0.010277641    7.3450151e-09  0              0.035466449    2.6109412e-16  0              2.995215     
   1700000   153            200            200            0.0034258952  -2.0824854e-38  0              0.010277686    1.0780069e-09  0              0.0052053096   2.6109412e-16  0              2.995215     
   1800000   153            200            200            0.0034258989  -1.8069938e-39  0              0.010277697    1.518096e-10   0              0.00073303422  2.6109412e-16  0              2.995215     
   1900000   153            200            200            0.0034258997  -1.4457821e-38  0              0.010277699    2.0546477e-11  0              9.9211585e-05  2.6109412e-16  0              2.995215     
   2000000   153            200            200            0.0034258997  -6.4219109e-39  0              0.010277699    2.672609e-12   0              1.2905072e-05  2.6109412e-16  0              2.995215     
   2100000   153            200            200            0.0034258996  -1.1888634e-38  0              0.010277699    3.3355909e-13  0              1.6106375e-06  2.6109412e-16  0              2.995215     
   2200000   153            200            200            0.0034258996   1.7520157e-38  0              0.010277699    3.9785401e-14  0              1.9210946e-07  2.6109412e-16  0              2.995215     
   2300000   153            200            200            0.0034258996  -6.7664894e-39  0              0.010277699    4.5093251e-15  0              2.1773917e-08  2.6109412e-16  0              2.995215     
   2400000   153            200            200            0.0034258995  -2.629048e-38   0              0.010277699    4.8136069e-16  0              2.3243185e-09  2.6109412e-16  0              2.995215     
   2500000   153            200            200            0.0034258995  -1.0787123e-38  0              0.010277699    4.6671548e-17  0              2.253602e-10   2.6109412e-16  0              2.995215     
   2600000   153            200            200            0.0034258995   2.7717673e-38  0              0.010277699    3.7017791e-18  0              1.7874567e-11  2.6109412e-16  0              2.995215     
   2700000   153            200            200            0.0034258995  -5.1696741e-38  0              0.010277699    3.4109386e-19  0              1.6470202e-12  2.6109412e-16  0              2.995215     
   2800000   153            200            200            0.0034258995   2.6960885e-38  0              0.010277699    1.903311e-21   0              9.1904077e-15  2.6109412e-16  0              2.995215     
   2900000   153            200            200            0.0034258995  -1.8203628e-38  0              0.010277699    1.1745322e-19  0              5.6713958e-13  2.6109412e-16  0              2.995215     
   3000000   153            200            200            0.0034258995   5.054439e-38   0              0.010277699    6.7206129e-21  0              3.2451434e-14  2.6109412e-16  0              2.995215     
Loop time of 64.101 on 4 procs for 3000000 steps with 51 atoms

Performance: 40436206.334 ns/day, 0.000 hours/ns, 46801.165 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 0.33501    | 1.5608     | 5.1157     | 164.3 |  2.43
Neigh   | 0.07829    | 0.078858   | 0.080402   |   0.3 |  0.12
Comm    | 25.749     | 32.154     | 37.877     |  82.7 | 50.16
Output  | 0.060745   | 0.060821   | 0.060876   |   0.0 |  0.09
Modify  | 15.393     | 21.089     | 28.18      | 119.0 | 32.90
Other   |            | 9.158      |            |       | 14.29

Nlocal:          12.75 ave          51 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1
Nghost:          39.25 ave          52 max           1 min
Histogram: 1 0 0 0 0 0 0 0 0 3
Neighs:           6.75 ave          27 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1

Total # of neighbors = 27
Ave neighs/atom = 0.52941176
Neighbor list builds = 166
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 60

#variable lat0 equal 1                    #
variable lat1 equal 3+(151*0.01)+(v_ind*0.01)  # .491+(v_ind*0.001)       # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 10*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 5.11                                                               
Lattice spacing in x,y,z = 5.11 5.11 5.11

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -76.65 ${n1e1} -100 100 -100 100 units box
region box block -76.65 76.65 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -76.65 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -76.65 76.65 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-76.65 -100 -100) to (76.65 100 100)
  1 by 2 by 2 MPI processor grid
create_atoms 1 region substrate
Created 30 atoms
  using lattice units in orthogonal box = (-76.65 -100 -100) to (76.65 100 100)
  create_atoms CPU = 0.000 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 30 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 21 atoms
  using lattice units in orthogonal box = (-76.65 -100 -100) to (76.65 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  30 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  30 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  21 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  21 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
30 atoms in group substrate
group slider1 region slider1
21 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 21 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_60_*.dump id type diameter mass xu yu zu fx fy fz

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 99 130 130
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 14.65 | 18.12 | 19.28 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   153.3          200            200            0              0              0              0              0              0              0              2.6109412e-16  0              6            
    100000   153.3          200            200            0.0027579242  -2.4108137e-38  0              0.0082737725   12112.102      0              5.8485008e+10  2.6109412e-16  0              3.332517     
    200000   153.3          200            200            0.00092440938 -3.0719222e-36  0              0.0027732282   2704.5748      0              1.3059424e+10  2.6109412e-16  0              3.0850346    
    300000   153.3          200            200           -6.6401616e-05 -5.0904788e-36  0             -0.00019920485  34.363909      0              1.6593102e+08  2.6109412e-16  0              3.041847     
    400000   153.3          200            200            0.0054232032   1.1951604e-35  0              0.01626961     184.66086      0              8.9166121e+08  2.6109412e-16  0              2.9933782    
    500000   153.3          200            200            0.0012521874  -5.1391534e-36  0              0.0037565623   12.84589       0              62028206       2.6109412e-16  0              2.9976091    
    600000   153.3          200            200            0.0022855034   1.5395826e-35  0              0.0068565103   0.041378032    0              199799.71      2.6109412e-16  0              2.9963403    
    700000   153.3          200            200            0.0030112678   2.7977245e-36  0              0.0090338033   0.06091329     0              294128.48      2.6109412e-16  0              2.9956011    
    800000   153.3          200            200            0.0032776475   3.0761116e-36  0              0.0098329425   0.016802346    0              81132.518      2.6109412e-16  0              2.9953467    
    900000   153.3          200            200            0.0033714467   7.0236158e-37  0              0.01011434     0.0035766017   0              17270.129      2.6109412e-16  0              2.995259     
   1000000   153.3          200            200            0.0034035893   3.4909351e-37  0              0.010210768    0.00067319997  0              3250.6417      2.6109412e-16  0              2.9952293    
   1100000   153.3          200            200            0.0034142906   1.9940644e-37  0              0.010242872    0.00011666972  0              563.35634      2.6109412e-16  0              2.9952195    
   1200000   153.3          200            200            0.0034177343   1.3304854e-38  0              0.010253203    1.8981644e-05  0              91.655567      2.6109412e-16  0              2.9952163    
   1300000   153.3          200            200            0.0034187946   1.1150422e-38  0              0.010256384    2.9313547e-06  0              14.154463      2.6109412e-16  0              2.9952154    
   1400000   153.3          200            200            0.0034191011   1.1494527e-38  0              0.010257303    4.3254802e-07  0              2.0886196      2.6109412e-16  0              2.9952151    
   1500000   153.3          200            200            0.0034191809  -2.8260921e-39  0              0.010257543    6.12211e-08    0              0.29561478     2.6109412e-16  0              2.995215     
   1600000   153.3          200            200            0.0034191975   4.7993542e-39  0              0.010257592    8.3267495e-09  0              0.040206893    2.6109412e-16  0              2.995215     
   1700000   153.3          200            200            0.0034191988   3.4110116e-39  0              0.010257596    1.0885443e-09  0              0.0052561909   2.6109412e-16  0              2.995215     
   1800000   153.3          200            200            0.0034191975   5.0624286e-40  0              0.010257593    1.3658505e-10  0              0.00065952031  2.6109412e-16  0              2.995215     
   1900000   153.3          200            200            0.0034191964   8.3836745e-39  0              0.010257589    1.6395875e-11  0              7.9169813e-05  2.6109412e-16  0              2.995215     
   2000000   153.3          200            200            0.0034191958   4.908264e-39   0              0.010257587    1.8720026e-12  0              9.0392304e-06  2.6109412e-16  0              2.995215     
   2100000   153.3          200            200            0.0034191955   2.2188996e-39  0              0.010257586    2.014022e-13   0              9.7249912e-07  2.6109412e-16  0              2.995215     
   2200000   153.3          200            200            0.0034191953   2.2477963e-38  0              0.010257586    2.0109099e-14  0              9.7099643e-08  2.6109412e-16  0              2.995215     
   2300000   153.3          200            200            0.0034191953   3.5598192e-38  0              0.010257586    1.8102288e-15  0              8.740947e-09   2.6109412e-16  0              2.995215     
   2400000   153.3          200            200            0.0034191952   1.7524843e-38  0              0.010257586    1.3734439e-16  0              6.6318691e-10  2.6109412e-16  0              2.995215     
   2500000   153.3          200            200            0.0034191952   1.6571948e-38  0              0.010257586    7.5124349e-18  0              3.627486e-11   2.6109412e-16  0              2.995215     
   2600000   153.3          200            200            0.0034191952  -1.1405889e-38  0              0.010257586    9.6841015e-20  0              4.6761061e-13  2.6109412e-16  0              2.995215     
   2700000   153.3          200            200            0.0034191952  -3.6174744e-38  0              0.010257586    8.218572e-22   0              3.9684543e-15  2.6109412e-16  0              2.995215     
   2800000   153.3          200            200            0.0034191952   2.8788352e-38  0              0.010257586    2.4160284e-20  0              1.1666137e-13  2.6109412e-16  0              2.995215     
   2900000   153.3          200            200            0.0034191952   1.8749936e-38  0              0.010257586    5.0239935e-20  0              2.4259067e-13  2.6109412e-16  0              2.995215     
   3000000   153.3          200            200            0.0034191952  -4.4076804e-38  0              0.010257586    3.4313723e-20  0              1.6568869e-13  2.6109412e-16  0              2.995215     
Loop time of 63.8009 on 4 procs for 3000000 steps with 51 atoms

Performance: 40626379.900 ns/day, 0.000 hours/ns, 47021.273 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 0.31983    | 1.5426     | 5.0485     | 163.0 |  2.42
Neigh   | 0.07837    | 0.079091   | 0.081004   |   0.4 |  0.12
Comm    | 25.686     | 32.063     | 37.803     |  82.6 | 50.26
Output  | 0.060192   | 0.060273   | 0.060325   |   0.0 |  0.09
Modify  | 15.209     | 20.929     | 28.022     | 119.3 | 32.80
Other   |            | 9.126      |            |       | 14.30

Nlocal:          12.75 ave          51 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1
Nghost:          39.25 ave          52 max           1 min
Histogram: 1 0 0 0 0 0 0 0 0 3
Neighs:           6.75 ave          27 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1

Total # of neighbors = 27
Ave neighs/atom = 0.52941176
Neighbor list builds = 166
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 61

#variable lat0 equal 1                    #
variable lat1 equal 3+(151*0.01)+(v_ind*0.01)  # .491+(v_ind*0.001)       # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 10*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 5.12                                                               
Lattice spacing in x,y,z = 5.12 5.12 5.12

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -76.8 ${n1e1} -100 100 -100 100 units box
region box block -76.8 76.8 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -76.8 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -76.8 76.8 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-76.8 -100 -100) to (76.8 100 100)
  1 by 2 by 2 MPI processor grid
create_atoms 1 region substrate
Created 30 atoms
  using lattice units in orthogonal box = (-76.8 -100 -100) to (76.8 100 100)
  create_atoms CPU = 0.000 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 30 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 21 atoms
  using lattice units in orthogonal box = (-76.8 -100 -100) to (76.8 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  30 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  30 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  21 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  21 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
30 atoms in group substrate
group slider1 region slider1
21 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 21 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_61_*.dump id type diameter mass xu yu zu fx fy fz

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 100 130 130
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 14.67 | 18.14 | 19.3 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   153.6          200            200            0              0              0              0              0              0              0              2.6109412e-16  0              6            
    100000   153.6          200            200            0.0027517418   5.5408914e-43  0              0.0082552254   12109.765      0              5.8473721e+10  2.6109412e-16  0              3.3315823    
    200000   153.6          200            200            0.00091041268  7.9051119e-37  0              0.002731238    2648.4437      0              1.2788387e+10  2.6109412e-16  0              3.0873289    
    300000   153.6          200            200           -9.1514615e-05 -4.4934956e-37  0             -0.00027454385  68.833759      0              3.3237359e+08  2.6109412e-16  0              3.0400113    
    400000   153.6          200            200            0.0080963516   1.3509086e-34  0              0.024289055    143.67202      0              6.9374075e+08  2.6109412e-16  0              2.9913935    
    500000   153.6          200            200            0.0009469938   3.171774e-36   0              0.0028409814   7.0157207      0              33876404       2.6109412e-16  0              2.9980114    
    600000   153.6          200            200            0.0023288994  -2.9323139e-35  0              0.0069866983   0.41411895     0              1999632.2      2.6109412e-16  0              2.9962838    
    700000   153.6          200            200            0.003047066    2.6902262e-36  0              0.0091411981   0.15993752     0              772281.02      2.6109412e-16  0              2.9955588    
    800000   153.6          200            200            0.0032920199  -2.8842085e-36  0              0.0098760597   0.032916907    0              158943.96      2.6109412e-16  0              2.9953264    
    900000   153.6          200            200            0.0033741119   7.2497635e-38  0              0.010122336    0.0058998466   0              28488.248      2.6109412e-16  0              2.9952502    
   1000000   153.6          200            200            0.003400844    2.2914882e-37  0              0.010202532    0.00098092282  0              4736.5253      2.6109412e-16  0              2.9952256    
   1100000   153.6          200            200            0.00340921    -1.6555248e-37  0              0.01022763     0.00015411449  0              744.1637       2.6109412e-16  0              2.995218     
   1200000   153.6          200            200            0.0034116873   1.5387712e-38  0              0.010235062    2.3084393e-05  0              111.46627      2.6109412e-16  0              2.9952157    
   1300000   153.6          200            200            0.0034123601   5.0380637e-38  0              0.01023708     3.3127972e-06  0              15.996312      2.6109412e-16  0              2.9952151    
   1400000   153.6          200            200            0.003412515    3.1139827e-39  0              0.010237545    4.5664464e-07  0              2.2049736      2.6109412e-16  0              2.995215     
   1500000   153.6          200            200            0.0034125368   2.7092311e-38  0              0.01023761     6.0506552e-08  0              0.29216448     2.6109412e-16  0              2.995215     
   1600000   153.6          200            200            0.0034125317  -6.3147952e-39  0              0.010237595    7.7001708e-09  0              0.037181369    2.6109412e-16  0              2.995215     
   1700000   153.6          200            200            0.0034125251  -5.1984023e-40  0              0.010237575    9.3874925e-10  0              0.0045328841   2.6109412e-16  0              2.995215     
   1800000   153.6          200            200            0.0034125209  -3.2310136e-38  0              0.010237563    1.0911475e-10  0              0.00052687606  2.6109412e-16  0              2.995215     
   1900000   153.6          200            200            0.0034125188   9.1680888e-40  0              0.010237556    1.1996136e-11  0              5.7925046e-05  2.6109412e-16  0              2.995215     
   2000000   153.6          200            200            0.0034125178   2.2898536e-38  0              0.010237554    1.2311935e-12  0              5.944993e-06   2.6109412e-16  0              2.995215     
   2100000   153.6          200            200            0.0034125174   7.6495472e-39  0              0.010237552    1.1534874e-13  0              5.5697781e-07  2.6109412e-16  0              2.995215     
   2200000   153.6          200            200            0.0034125172   5.380747e-39   0              0.010237552    9.4594581e-15  0              4.5676338e-08  2.6109412e-16  0              2.995215     
   2300000   153.6          200            200            0.0034125171  -1.3926702e-38  0              0.010237551    6.2312476e-16  0              3.0088464e-09  2.6109412e-16  0              2.995215     
   2400000   153.6          200            200            0.0034125171  -4.0560335e-39  0              0.010237551    2.3773182e-17  0              1.1479219e-10  2.6109412e-16  0              2.995215     
   2500000   153.6          200            200            0.0034125171  -1.1068409e-38  0              0.010237551    3.2755279e-20  0              1.5816352e-13  2.6109412e-16  0              2.995215     
   2600000   153.6          200            200            0.0034125171   1.7283424e-38  0              0.010237551    3.6301151e-19  0              1.7528526e-12  2.6109412e-16  0              2.995215     
   2700000   153.6          200            200            0.0034125171   8.4532119e-40  0              0.010237551    1.8424034e-19  0              8.8963064e-13  2.6109412e-16  0              2.995215     
   2800000   153.6          200            200            0.0034125171   2.1970386e-38  0              0.010237551    8.5538227e-20  0              4.1303348e-13  2.6109412e-16  0              2.995215     
   2900000   153.6          200            200            0.0034125171  -7.5060253e-39  0              0.010237551    3.4753816e-20  0              1.6781374e-13  2.6109412e-16  0              2.995215     
   3000000   153.6          200            200            0.0034125171   2.4877079e-38  0              0.010237551    3.6352959e-20  0              1.7553543e-13  2.6109412e-16  0              2.995215     
Loop time of 64.2341 on 4 procs for 3000000 steps with 51 atoms

Performance: 40352408.038 ns/day, 0.000 hours/ns, 46704.176 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 0.32694    | 1.6053     | 5.2866     | 167.8 |  2.50
Neigh   | 0.07905    | 0.079622   | 0.081181   |   0.3 |  0.12
Comm    | 25.815     | 32.245     | 38         |  82.6 | 50.20
Output  | 0.061423   | 0.0615     | 0.061558   |   0.0 |  0.10
Modify  | 15.337     | 21.08      | 28.212     | 119.8 | 32.82
Other   |            | 9.162      |            |       | 14.26

Nlocal:          12.75 ave          51 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1
Nghost:          39.25 ave          52 max           1 min
Histogram: 1 0 0 0 0 0 0 0 0 3
Neighs:           6.75 ave          27 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1

Total # of neighbors = 27
Ave neighs/atom = 0.52941176
Neighbor list builds = 166
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 62

#variable lat0 equal 1                    #
variable lat1 equal 3+(151*0.01)+(v_ind*0.01)  # .491+(v_ind*0.001)       # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 10*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 5.13                                                               
Lattice spacing in x,y,z = 5.13 5.13 5.13

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -76.95 ${n1e1} -100 100 -100 100 units box
region box block -76.95 76.95 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -76.95 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -76.95 76.95 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-76.95 -100 -100) to (76.95 100 100)
  1 by 2 by 2 MPI processor grid
create_atoms 1 region substrate
Created 30 atoms
  using lattice units in orthogonal box = (-76.95 -100 -100) to (76.95 100 100)
  create_atoms CPU = 0.000 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 30 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 21 atoms
  using lattice units in orthogonal box = (-76.95 -100 -100) to (76.95 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  30 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  30 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  21 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  21 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
30 atoms in group substrate
group slider1 region slider1
21 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 21 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_62_*.dump id type diameter mass xu yu zu fx fy fz

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 100 130 130
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 14.67 | 18.14 | 19.3 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   153.9          200            200            0              0              0              0              0              0              0              2.6109412e-16  0              6            
    100000   153.9          200            200            0.0027469622   1.6049823e-38  0              0.0082408867   12116.473      0              5.8506112e+10  2.6109412e-16  0              3.3303302    
    200000   153.9          200            200            0.00089776275  1.0456792e-36  0              0.0026932882   2598.4805      0              1.2547132e+10  2.6109412e-16  0              3.089482     
    300000   153.9          200            200           -0.00010457063 -5.5705601e-36  0             -0.0003137119   92.743314      0              4.4782427e+08  2.6109412e-16  0              3.038785     
    400000   153.9          200            200            0.0094960654   7.1831139e-36  0              0.028488196    111.6147       0              5.3894746e+08  2.6109412e-16  0              2.9904369    
    500000   153.9          200            200            0.00082454817 -5.0231034e-35  0              0.0024736445   4.3432237      0              20971873       2.6109412e-16  0              2.9981801    
    600000   153.9          200            200            0.0023738971  -1.273772e-35   0              0.0071216913   0.76845131     0              3710576.3      2.6109412e-16  0              2.9962285    
    700000   153.9          200            200            0.0030728116  -2.0347762e-36  0              0.0092184347   0.22719856     0              1097060.5      2.6109412e-16  0              2.9955272    
    800000   153.9          200            200            0.0033000383  -1.3448141e-36  0              0.0099001149   0.042537604    0              205398.86      2.6109412e-16  0              2.9953125    
    900000   153.9          200            200            0.00337361     5.6187804e-37  0              0.01012083     0.0071472894   0              34511.703      2.6109412e-16  0              2.9952444    
   1000000   153.9          200            200            0.0033966715   1.9631089e-37  0              0.010190015    0.0011286715   0              5449.951       2.6109412e-16  0              2.9952233    
   1100000   153.9          200            200            0.0034035302  -6.4547814e-39  0              0.01021059     0.00016968872  0              819.36609      2.6109412e-16  0              2.9952171    
   1200000   153.9          200            200            0.0034054077   1.391599e-38   0              0.010216223    2.4429951e-05  0              117.96349      2.6109412e-16  0              2.9952154    
   1300000   153.9          200            200            0.0034058478  -1.8795844e-38  0              0.010217543    3.3776836e-06  0              16.309626      2.6109412e-16  0              2.995215     
   1400000   153.9          200            200            0.0034059143  -3.0946579e-39  0              0.010217743    4.4889911e-07  0              2.1675732      2.6109412e-16  0              2.995215     
   1500000   153.9          200            200            0.0034059033  -6.8030683e-39  0              0.01021771     5.7306546e-08  0              0.2767128      2.6109412e-16  0              2.995215     
   1600000   153.9          200            200            0.0034058862  -3.7206094e-39  0              0.010217659    7.0101598e-09  0              0.033849553    2.6109412e-16  0              2.995215     
   1700000   153.9          200            200            0.0034058753  -3.5783054e-39  0              0.010217626    8.1794902e-10  0              0.0039495831   2.6109412e-16  0              2.995215     
   1800000   153.9          200            200            0.0034058696  -1.2908262e-38  0              0.010217609    9.0337858e-11  0              0.00043620919  2.6109412e-16  0              2.995215     
   1900000   153.9          200            200            0.003405867    2.8661073e-38  0              0.010217601    9.3262863e-12  0              4.5033299e-05  2.6109412e-16  0              2.995215     
   2000000   153.9          200            200            0.0034058658   4.9708355e-39  0              0.010217598    8.8089015e-13  0              4.2535033e-06  2.6109412e-16  0              2.995215     
   2100000   153.9          200            200            0.0034058653  -2.1807705e-38  0              0.010217596    7.3142496e-14  0              3.5317894e-07  2.6109412e-16  0              2.995215     
   2200000   153.9          200            200            0.0034058651   1.0453498e-38  0              0.010217595    4.8959905e-15  0              2.3640986e-08  2.6109412e-16  0              2.995215     
   2300000   153.9          200            200            0.0034058651   2.1740748e-38  0              0.010217595    2.1060329e-16  0              1.0169279e-09  2.6109412e-16  0              2.995215     
   2400000   153.9          200            200            0.003405865   -7.8915994e-39  0              0.010217595    9.056256e-19   0              4.3729419e-12  2.6109412e-16  0              2.995215     
   2500000   153.9          200            200            0.003405865    9.7399023e-39  0              0.010217595    1.6326806e-18  0              7.8836303e-12  2.6109412e-16  0              2.995215     
   2600000   153.9          200            200            0.003405865    3.868397e-38   0              0.010217595    1.3267058e-18  0              6.4061873e-12  2.6109412e-16  0              2.995215     
   2700000   153.9          200            200            0.003405865   -1.053992e-39   0              0.010217595    3.228414e-19   0              1.5588856e-12  2.6109412e-16  0              2.995215     
   2800000   153.9          200            200            0.003405865    7.5383603e-40  0              0.010217595    1.1771979e-19  0              5.6842673e-13  2.6109412e-16  0              2.995215     
   2900000   153.9          200            200            0.003405865    8.1773918e-39  0              0.010217595    2.7683476e-20  0              1.336736e-13   2.6109412e-16  0              2.995215     
   3000000   153.9          200            200            0.003405865    1.7331055e-38  0              0.010217595    6.6513722e-20  0              3.2117096e-13  2.6109412e-16  0              2.995215     
Loop time of 64.0181 on 4 procs for 3000000 steps with 51 atoms

Performance: 40488535.601 ns/day, 0.000 hours/ns, 46861.731 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 0.32655    | 1.5964     | 5.2623     | 167.6 |  2.49
Neigh   | 0.078147   | 0.0787     | 0.080208   |   0.3 |  0.12
Comm    | 25.726     | 32.144     | 37.933     |  82.9 | 50.21
Output  | 0.060831   | 0.060908   | 0.060961   |   0.0 |  0.10
Modify  | 15.212     | 20.962     | 28.056     | 119.2 | 32.74
Other   |            | 9.176      |            |       | 14.33

Nlocal:          12.75 ave          51 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1
Nghost:          39.25 ave          52 max           1 min
Histogram: 1 0 0 0 0 0 0 0 0 3
Neighs:           6.75 ave          27 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1

Total # of neighbors = 27
Ave neighs/atom = 0.52941176
Neighbor list builds = 164
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 63

#variable lat0 equal 1                    #
variable lat1 equal 3+(151*0.01)+(v_ind*0.01)  # .491+(v_ind*0.001)       # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 10*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 5.14                                                               
Lattice spacing in x,y,z = 5.14 5.14 5.14

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -77.1 ${n1e1} -100 100 -100 100 units box
region box block -77.1 77.1 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -77.1 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -77.1 77.1 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-77.1 -100 -100) to (77.1 100 100)
  1 by 2 by 2 MPI processor grid
create_atoms 1 region substrate
Created 30 atoms
  using lattice units in orthogonal box = (-77.1 -100 -100) to (77.1 100 100)
  create_atoms CPU = 0.000 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 30 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 21 atoms
  using lattice units in orthogonal box = (-77.1 -100 -100) to (77.1 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  30 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  30 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  21 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  21 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
30 atoms in group substrate
group slider1 region slider1
21 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 21 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_63_*.dump id type diameter mass xu yu zu fx fy fz

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 100 130 130
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 14.67 | 18.14 | 19.3 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   154.2          200            200            0              0              0              0              0              0              0              2.6109412e-16  0              6            
    100000   154.2          200            200            0.0027426221  -4.7900359e-38  0              0.0082278664   12124.623      0              5.8545467e+10  2.6109412e-16  0              3.3294971    
    200000   154.2          200            200            0.00089180545 -2.0251971e-36  0              0.0026754163   2579.245       0              1.2454251e+10  2.6109412e-16  0              3.090237     
    300000   154.2          200            200           -0.00010898763 -3.5120761e-36  0             -0.00032696288  102.14673      0              4.9323002e+08  2.6109412e-16  0              3.0383049    
    400000   154.2          200            200            0.0099326994   6.991986e-36   0              0.029798098    99.885344      0              4.8231058e+08  2.6109412e-16  0              2.9901395    
    500000   154.2          200            200            0.00078984118  3.081256e-36   0              0.0023695235   3.5704085      0              17240225       2.6109412e-16  0              2.9982271    
    600000   154.2          200            200            0.0023894241  -8.5318733e-36  0              0.0071682722   0.90583194     0              4373938.2      2.6109412e-16  0              2.9962063    
    700000   154.2          200            200            0.0030786757   6.5754019e-37  0              0.009236027    0.25061406     0              1210125.6      2.6109412e-16  0              2.9955154    
    800000   154.2          200            200            0.0032988468   5.31337e-36    0              0.0098965405   0.045704856    0              220692.39      2.6109412e-16  0              2.9953074    
    900000   154.2          200            200            0.0033692008   2.3444925e-37  0              0.010107602    0.0075363828   0              36390.495      2.6109412e-16  0              2.9952423    
   1000000   154.2          200            200            0.0033909197   5.1731896e-37  0              0.010172759    0.0011717604   0              5658.0114      2.6109412e-16  0              2.9952225    
   1100000   154.2          200            200            0.0033972403   1.4633567e-37  0              0.010191721    0.00017376983  0              839.0723       2.6109412e-16  0              2.9952167    
   1200000   154.2          200            200            0.0033989082   3.6265275e-38  0              0.010196725    2.470262e-05   0              119.28011      2.6109412e-16  0              2.9952153    
   1300000   154.2          200            200            0.0033992683   4.5826818e-38  0              0.010197805    3.3739089e-06  0              16.291398      2.6109412e-16  0              2.995215     
   1400000   154.2          200            200            0.003399305    3.9389065e-39  0              0.010197915    4.4292978e-07  0              2.1387494      2.6109412e-16  0              2.9952149    
   1500000   154.2          200            200            0.0033992831   1.4494408e-38  0              0.010197849    5.5823976e-08  0              0.269554       2.6109412e-16  0              2.995215     
   1600000   154.2          200            200            0.0033992621   1.8521479e-39  0              0.010197786    6.7339812e-09  0              0.032515985    2.6109412e-16  0              2.995215     
   1700000   154.2          200            200            0.0033992498   1.4259173e-38  0              0.010197749    7.7328752e-10  0              0.0037339287   2.6109412e-16  0              2.995215     
   1800000   154.2          200            200            0.0033992437   1.522553e-38   0              0.010197731    8.3782508e-11  0              0.00040455575  2.6109412e-16  0              2.995215     
   1900000   154.2          200            200            0.0033992409   2.9043738e-38  0              0.010197723    8.439694e-12   0              4.0752262e-05  2.6109412e-16  0              2.995215     
   2000000   154.2          200            200            0.0033992397  -1.2258132e-38  0              0.010197719    7.7027327e-13  0              3.719374e-06   2.6109412e-16  0              2.995215     
   2100000   154.2          200            200            0.0033992392   3.3331035e-39  0              0.010197717    6.0608573e-14  0              2.9265711e-07  2.6109412e-16  0              2.995215     
   2200000   154.2          200            200            0.003399239   -2.4042068e-38  0              0.010197717    3.6724484e-15  0              1.7732939e-08  2.6109412e-16  0              2.995215     
   2300000   154.2          200            200            0.0033992389  -4.3778902e-39  0              0.010197717    1.1888328e-16  0              5.7404482e-10  2.6109412e-16  0              2.995215     
   2400000   154.2          200            200            0.0033992388  -2.9520569e-38  0              0.010197717    9.8778264e-20  0              4.7696488e-13  2.6109412e-16  0              2.995215     
   2500000   154.2          200            200            0.0033992388   2.8511452e-38  0              0.010197716    2.9713325e-18  0              1.4347501e-11  2.6109412e-16  0              2.995215     
   2600000   154.2          200            200            0.0033992388  -3.4023957e-38  0              0.010197716    1.6653977e-18  0              8.0416093e-12  2.6109412e-16  0              2.995215     
   2700000   154.2          200            200            0.0033992388   3.4766358e-38  0              0.010197716    4.0325325e-19  0              1.9471656e-12  2.6109412e-16  0              2.995215     
   2800000   154.2          200            200            0.0033992388   9.1721897e-39  0              0.010197716    1.2925152e-19  0              6.2410934e-13  2.6109412e-16  0              2.995215     
   2900000   154.2          200            200            0.0033992388   1.2157637e-39  0              0.010197716    1.3642135e-20  0              6.5872988e-14  2.6109412e-16  0              2.995215     
   3000000   154.2          200            200            0.0033992388   3.1002617e-38  0              0.010197716    1.1105372e-19  0              5.3623865e-13  2.6109412e-16  0              2.995215     
Loop time of 63.9594 on 4 procs for 3000000 steps with 51 atoms

Performance: 40525721.469 ns/day, 0.000 hours/ns, 46904.770 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 0.32222    | 1.5582     | 5.107      | 164.2 |  2.44
Neigh   | 0.078157   | 0.078691   | 0.080213   |   0.3 |  0.12
Comm    | 25.711     | 32.124     | 37.875     |  82.7 | 50.23
Output  | 0.06192    | 0.061995   | 0.062045   |   0.0 |  0.10
Modify  | 15.215     | 20.96      | 28.064     | 119.1 | 32.77
Other   |            | 9.176      |            |       | 14.35

Nlocal:          12.75 ave          51 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1
Nghost:          39.25 ave          52 max           1 min
Histogram: 1 0 0 0 0 0 0 0 0 3
Neighs:           6.25 ave          25 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1

Total # of neighbors = 25
Ave neighs/atom = 0.49019608
Neighbor list builds = 164
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 64

#variable lat0 equal 1                    #
variable lat1 equal 3+(151*0.01)+(v_ind*0.01)  # .491+(v_ind*0.001)       # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 10*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 5.15                                                               
Lattice spacing in x,y,z = 5.15 5.15 5.15

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -77.25 ${n1e1} -100 100 -100 100 units box
region box block -77.25 77.25 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -77.25 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -77.25 77.25 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-77.25 -100 -100) to (77.25 100 100)
  1 by 2 by 2 MPI processor grid
create_atoms 1 region substrate
Created 30 atoms
  using lattice units in orthogonal box = (-77.25 -100 -100) to (77.25 100 100)
  create_atoms CPU = 0.000 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 30 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 21 atoms
  using lattice units in orthogonal box = (-77.25 -100 -100) to (77.25 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  30 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  30 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  21 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  21 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
30 atoms in group substrate
group slider1 region slider1
21 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 21 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_64_*.dump id type diameter mass xu yu zu fx fy fz

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 100 130 130
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 14.67 | 18.14 | 19.3 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   154.5          200            200            0              0              0              0              0              0              0              2.6109412e-16  0              6            
    100000   154.5          200            200            0.0027383109   1.5998427e-38  0              0.0082149328   12131.028      0              5.8576395e+10  2.6109412e-16  0              3.329371     
    200000   154.5          200            200            0.00089645226 -1.771443e-36   0              0.0026893568   2608.7178      0              1.2596564e+10  2.6109412e-16  0              3.0887952    
    300000   154.5          200            200           -0.00010463295  3.1297496e-36  0             -0.00031389886  93.673878      0              4.5231763e+08  2.6109412e-16  0              3.0387269    
    400000   154.5          200            200            0.0094525963  -1.749072e-35   0              0.028357789    111.73374      0              5.3952225e+08  2.6109412e-16  0              2.9904413    
    500000   154.5          200            200            0.00082442476  2.9537286e-36  0              0.0024732743   4.4072586      0              21281074       2.6109412e-16  0              2.9981757    
    600000   154.5          200            200            0.002363172    6.4776544e-35  0              0.007089516    0.75694698     0              3655026.1      2.6109412e-16  0              2.9962302    
    700000   154.5          200            200            0.003059934   -1.7020888e-39  0              0.0091798019   0.22514493     0              1087144.3      2.6109412e-16  0              2.9955281    
    800000   154.5          200            200            0.0032867966   1.1923368e-36  0              0.0098603899   0.042252394    0              204021.69      2.6109412e-16  0              2.9953129    
    900000   154.5          200            200            0.0033603307   6.1902573e-37  0              0.010080992    0.0071112405   0              34337.635      2.6109412e-16  0              2.9952445    
   1000000   154.5          200            200            0.003383409    1.9045821e-37  0              0.010150227    0.001124518    0              5429.8952      2.6109412e-16  0              2.9952233    
   1100000   154.5          200            200            0.0033902846   8.5501081e-38  0              0.010170854    0.00016926695  0              817.32951      2.6109412e-16  0              2.9952171    
   1200000   154.5          200            200            0.0033921722   1.9791061e-38  0              0.010176516    2.4396048e-05  0              117.79979      2.6109412e-16  0              2.9952154    
   1300000   154.5          200            200            0.0033926172   3.0838389e-38  0              0.010177852    3.3765524e-06  0              16.304163      2.6109412e-16  0              2.995215     
   1400000   154.5          200            200            0.003392686   -3.6826916e-39  0              0.010178058    4.4922072e-07  0              2.1691261      2.6109412e-16  0              2.995215     
   1500000   154.5          200            200            0.0033926759   8.2178966e-39  0              0.010178028    5.7410255e-08  0              0.27721357     2.6109412e-16  0              2.995215     
   1600000   154.5          200            200            0.0033926593  -1.0410469e-39  0              0.010177978    7.0311372e-09  0              0.033950845    2.6109412e-16  0              2.995215     
   1700000   154.5          200            200            0.0033926485   6.9572976e-40  0              0.010177946    8.2149501e-10  0              0.0039667054   2.6109412e-16  0              2.995215     
   1800000   154.5          200            200            0.0033926429  -1.0415094e-39  0              0.010177929    9.0874403e-11  0              0.00043879997  2.6109412e-16  0              2.995215     
   1900000   154.5          200            200            0.0033926403   1.7972767e-38  0              0.010177921    9.4002626e-12  0              4.5390504e-05  2.6109412e-16  0              2.995215     
   2000000   154.5          200            200            0.0033926392   1.1838632e-38  0              0.010177918    8.9028243e-13  0              4.2988552e-06  2.6109412e-16  0              2.995215     
   2100000   154.5          200            200            0.0033926387  -1.1369316e-38  0              0.010177916    7.4245298e-14  0              3.5850397e-07  2.6109412e-16  0              2.995215     
   2200000   154.5          200            200            0.0033926385   3.0178343e-38  0              0.010177915    5.0077253e-15  0              2.4180513e-08  2.6109412e-16  0              2.995215     
   2300000   154.5          200            200            0.0033926384  -3.297649e-38   0              0.010177915    2.1994402e-16  0              1.0620309e-09  2.6109412e-16  0              2.995215     
   2400000   154.5          200            200            0.0033926384   3.2595279e-38  0              0.010177915    1.2353267e-18  0              5.9649506e-12  2.6109412e-16  0              2.995215     
   2500000   154.5          200            200            0.0033926384   1.5557751e-38  0              0.010177915    1.4477229e-18  0              6.9905359e-12  2.6109412e-16  0              2.995215     
   2600000   154.5          200            200            0.0033926384  -4.2238117e-39  0              0.010177915    1.2220666e-18  0              5.9009221e-12  2.6109412e-16  0              2.995215     
   2700000   154.5          200            200            0.0033926384  -8.7070914e-39  0              0.010177915    3.5836124e-19  0              1.7303982e-12  2.6109412e-16  0              2.995215     
   2800000   154.5          200            200            0.0033926384   1.2179073e-38  0              0.010177915    1.067888e-19   0              5.1564488e-13  2.6109412e-16  0              2.995215     
   2900000   154.5          200            200            0.0033926384   2.6948885e-39  0              0.010177915    1.7974937e-20  0              8.6794537e-14  2.6109412e-16  0              2.995215     
   3000000   154.5          200            200            0.0033926384  -2.1089953e-38  0              0.010177915    8.7005574e-20  0              4.2011878e-13  2.6109412e-16  0              2.995215     
Loop time of 64.3334 on 4 procs for 3000000 steps with 51 atoms

Performance: 40290090.361 ns/day, 0.000 hours/ns, 46632.049 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 0.33123    | 1.6089     | 5.2798     | 167.2 |  2.50
Neigh   | 0.078218   | 0.078757   | 0.080268   |   0.3 |  0.12
Comm    | 25.832     | 32.395     | 38.135     |  83.6 | 50.36
Output  | 0.060424   | 0.0605     | 0.060553   |   0.0 |  0.09
Modify  | 15.375     | 21.107     | 28.36      | 120.6 | 32.81
Other   |            | 9.083      |            |       | 14.12

Nlocal:          12.75 ave          51 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1
Nghost:          39.25 ave          52 max           1 min
Histogram: 1 0 0 0 0 0 0 0 0 3
Neighs:           6.25 ave          25 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1

Total # of neighbors = 25
Ave neighs/atom = 0.49019608
Neighbor list builds = 164
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 65

#variable lat0 equal 1                    #
variable lat1 equal 3+(151*0.01)+(v_ind*0.01)  # .491+(v_ind*0.001)       # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 10*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 5.16                                                               
Lattice spacing in x,y,z = 5.16 5.16 5.16

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -77.4 ${n1e1} -100 100 -100 100 units box
region box block -77.4 77.4 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -77.4 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -77.4 77.4 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-77.4 -100 -100) to (77.4 100 100)
  1 by 2 by 2 MPI processor grid
create_atoms 1 region substrate
Created 30 atoms
  using lattice units in orthogonal box = (-77.4 -100 -100) to (77.4 100 100)
  create_atoms CPU = 0.000 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 30 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 21 atoms
  using lattice units in orthogonal box = (-77.4 -100 -100) to (77.4 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  30 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  30 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  21 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  21 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
30 atoms in group substrate
group slider1 region slider1
21 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 21 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_65_*.dump id type diameter mass xu yu zu fx fy fz

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 100 130 130
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 14.67 | 18.14 | 19.3 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   154.8          200            200            0              0              0              0              0              0              0              2.6109412e-16  0              6            
    100000   154.8          200            200            0.0027339757   3.9851924e-39  0              0.0082019271   12135.432      0              5.8597657e+10  2.6109412e-16  0              3.3299275    
    200000   154.8          200            200            0.000907946   -2.4070845e-37  0              0.002723838    2670.0066      0              1.2892506e+10  2.6109412e-16  0              3.0861221    
    300000   154.8          200            200           -8.855273e-05  -1.4678293e-36  0             -0.00026565819  65.162485      0              3.1464632e+08  2.6109412e-16  0              3.0401858    
    400000   154.8          200            200            0.0077004862   1.9687956e-35  0              0.023101459    150.19547      0              7.2524017e+08  2.6109412e-16  0              2.9916281    
    500000   154.8          200            200            0.00097675181 -1.1029462e-36  0              0.0029302554   7.7906314      0              37618171       2.6109412e-16  0              2.9979601    
    600000   154.8          200            200            0.002300756   -8.9778961e-36  0              0.006902268    0.33671525     0              1625877.4      2.6109412e-16  0              2.9962954    
    700000   154.8          200            200            0.0030161826   8.2590604e-36  0              0.0090485479   0.14324927     0              691699.48      2.6109412e-16  0              2.9955662    
    800000   154.8          200            200            0.0032630626   3.0545371e-36  0              0.0097891877   0.030391661    0              146750.45      2.6109412e-16  0              2.9953298    
    900000   154.8          200            200            0.003346473    6.7217097e-38  0              0.010039419    0.0055558163   0              26827.048      2.6109412e-16  0              2.9952516    
   1000000   154.8          200            200            0.0033738697   9.14161e-38    0              0.010121609    0.00093784958  0              4528.54        2.6109412e-16  0              2.9952262    
   1100000   154.8          200            200            0.0033825379  -1.118154e-38   0              0.010147614    0.0001492139   0              720.50052      2.6109412e-16  0              2.9952182    
   1200000   154.8          200            200            0.0033851451   2.7671073e-40  0              0.010155435    2.259823e-05   0              109.11876      2.6109412e-16  0              2.9952158    
   1300000   154.8          200            200            0.0033858715  -5.2774295e-39  0              0.010157614    3.276022e-06   0              15.818738      2.6109412e-16  0              2.9952152    
   1400000   154.8          200            200            0.0033860479   1.4914236e-38  0              0.010158144    4.5597196e-07  0              2.2017254      2.6109412e-16  0              2.995215     
   1500000   154.8          200            200            0.0033860781  -5.7375744e-39  0              0.010158234    6.1003534e-08  0              0.29456423     2.6109412e-16  0              2.995215     
   1600000   154.8          200            200            0.0033860762   1.4213571e-38  0              0.010158229    7.8415233e-09  0              0.037863909    2.6109412e-16  0              2.995215     
   1700000   154.8          200            200            0.0033860708   7.311268e-39   0              0.010158212    9.6638401e-10  0              0.0046663226   2.6109412e-16  0              2.995215     
   1800000   154.8          200            200            0.0033860671  -3.0809439e-39  0              0.010158201    1.1370712e-10  0              0.00054905099  2.6109412e-16  0              2.995215     
   1900000   154.8          200            200            0.0033860651   1.2167748e-39  0              0.010158195    1.2684219e-11  0              6.1247552e-05  2.6109412e-16  0              2.995215     
   2000000   154.8          200            200            0.0033860642   2.7215404e-40  0              0.010158193    1.3258614e-12  0              6.4021103e-06  2.6109412e-16  0              2.995215     
   2100000   154.8          200            200            0.0033860638   4.7918575e-38  0              0.010158191    1.2738579e-13  0              6.151004e-07   2.6109412e-16  0              2.995215     
   2200000   154.8          200            200            0.0033860636   1.2826935e-38  0              0.010158191    1.0861936e-14  0              5.2448401e-08  2.6109412e-16  0              2.995215     
   2300000   154.8          200            200            0.0033860635  -7.394382e-39   0              0.010158191    7.6556286e-16  0              3.696629e-09   2.6109412e-16  0              2.995215     
   2400000   154.8          200            200            0.0033860635  -1.6657825e-38  0              0.01015819     3.4856338e-17  0              1.6830878e-10  2.6109412e-16  0              2.995215     
   2500000   154.8          200            200            0.0033860635  -9.5458339e-40  0              0.01015819     3.1006571e-19  0              1.4971963e-12  2.6109412e-16  0              2.995215     
   2600000   154.8          200            200            0.0033860635   1.192635e-38   0              0.01015819     2.2913599e-19  0              1.1064157e-12  2.6109412e-16  0              2.995215     
   2700000   154.8          200            200            0.0033860635   1.7362902e-40  0              0.01015819     1.1346315e-19  0              5.4787296e-13  2.6109412e-16  0              2.995215     
   2800000   154.8          200            200            0.0033860635  -1.6214595e-38  0              0.01015819     6.8341305e-20  0              3.299957e-13   2.6109412e-16  0              2.995215     
   2900000   154.8          200            200            0.0033860635   6.0400923e-38  0              0.01015819     8.5787769e-20  0              4.1423844e-13  2.6109412e-16  0              2.995215     
   3000000   154.8          200            200            0.0033860635  -2.0692677e-38  0              0.01015819     1.059632e-20   0              5.1165836e-14  2.6109412e-16  0              2.995215     
Loop time of 64.0749 on 4 procs for 3000000 steps with 51 atoms

Performance: 40452667.177 ns/day, 0.000 hours/ns, 46820.217 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 0.32583    | 1.5558     | 5.119      | 165.0 |  2.43
Neigh   | 0.079135   | 0.079652   | 0.081127   |   0.3 |  0.12
Comm    | 25.737     | 32.165     | 37.89      |  82.6 | 50.20
Output  | 0.061749   | 0.061827   | 0.061887   |   0.0 |  0.10
Modify  | 15.246     | 21.008     | 28.12      | 119.6 | 32.79
Other   |            | 9.204      |            |       | 14.36

Nlocal:          12.75 ave          51 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1
Nghost:          39.25 ave          52 max           1 min
Histogram: 1 0 0 0 0 0 0 0 0 3
Neighs:           6.25 ave          25 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1

Total # of neighbors = 25
Ave neighs/atom = 0.49019608
Neighbor list builds = 166
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 66

#variable lat0 equal 1                    #
variable lat1 equal 3+(151*0.01)+(v_ind*0.01)  # .491+(v_ind*0.001)       # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 10*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 5.17                                                               
Lattice spacing in x,y,z = 5.17 5.17 5.17

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -77.55 ${n1e1} -100 100 -100 100 units box
region box block -77.55 77.55 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -77.55 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -77.55 77.55 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-77.55 -100 -100) to (77.55 100 100)
  1 by 2 by 2 MPI processor grid
create_atoms 1 region substrate
Created 30 atoms
  using lattice units in orthogonal box = (-77.55 -100 -100) to (77.55 100 100)
  create_atoms CPU = 0.000 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 30 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 21 atoms
  using lattice units in orthogonal box = (-77.55 -100 -100) to (77.55 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  30 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  30 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  21 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  21 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
30 atoms in group substrate
group slider1 region slider1
21 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 21 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_66_*.dump id type diameter mass xu yu zu fx fy fz

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 101 130 130
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 14.69 | 18.16 | 19.32 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   155.1          200            200            0              0              0              0              0              0              0              2.6109412e-16  0              6            
    100000   155.1          200            200            0.0027298485   6.3601152e-38  0              0.0081895455   12139.941      0              5.8619431e+10  2.6109412e-16  0              3.3308896    
    200000   155.1          200            200            0.0009202933  -1.2561509e-37  0              0.0027608799   2735.6302      0              1.3209379e+10  2.6109412e-16  0              3.0835951    
    300000   155.1          200            200           -5.2938025e-05  2.5829105e-36  0             -0.00015881408  21.833413      0              1.0542574e+08  2.6109412e-16  0              3.0425506    
    400000   155.1          200            200            0.0039403819  -3.0115334e-35  0              0.011821146    194.21139      0              9.3777729e+08  2.6109412e-16  0              2.9945726    
    500000   155.1          200            200            0.0014612224   1.8612369e-35  0              0.0043836672   16.461332      0              79485880       2.6109412e-16  0              2.9973267    
    600000   155.1          200            200            0.0022560306   1.8349153e-35  0              0.0067680919   0.0028979293   0              13993.064      2.6109412e-16  0              2.9963467    
    700000   155.1          200            200            0.0029621618  -4.1583786e-37  0              0.0088864853   0.023394342    0              112962.91      2.6109412e-16  0              2.9956162    
    800000   155.1          200            200            0.0032311839  -2.6963268e-36  0              0.0096935518   0.0093491246   0              45143.577      2.6109412e-16  0              2.9953551    
    900000   155.1          200            200            0.0033282084  -8.6532773e-37  0              0.0099846253   0.0023583054   0              11387.413      2.6109412e-16  0              2.9952631    
   1000000   155.1          200            200            0.0033622454  -2.3095802e-37  0              0.010086736    0.00049370044  0              2383.9027      2.6109412e-16  0              2.9952311    
   1100000   155.1          200            200            0.003373881    1.0787493e-38  0              0.010121643    9.2325457e-05  0              445.80659      2.6109412e-16  0              2.9952202    
   1200000   155.1          200            200            0.0033777477   2.131881e-38   0              0.010133243    1.5938112e-05  0              76.959437      2.6109412e-16  0              2.9952166    
   1300000   155.1          200            200            0.0033789896  -2.2042327e-38  0              0.010136969    2.5855628e-06  0              12.484758      2.6109412e-16  0              2.9952155    
   1400000   155.1          200            200            0.003379371    4.051597e-39   0              0.010138113    3.9833738e-07  0              1.9234287      2.6109412e-16  0              2.9952151    
   1500000   155.1          200            200            0.0033794808   1.6484069e-39  0              0.010138442    5.8653884e-08  0              0.28321861     2.6109412e-16  0              2.995215     
   1600000   155.1          200            200            0.0033795092   1.303043e-38   0              0.010138528    8.2852348e-09  0              0.040006434    2.6109412e-16  0              2.995215     
   1700000   155.1          200            200            0.003379515   -4.6168278e-39  0              0.010138545    1.1247131e-09  0              0.0054308371   2.6109412e-16  0              2.995215     
   1800000   155.1          200            200            0.0033795154   3.9282839e-39  0              0.010138546    1.4674538e-10  0              0.00070858091  2.6109412e-16  0              2.995215     
   1900000   155.1          200            200            0.0033795149  -4.8821856e-39  0              0.010138545    1.8375004e-11  0              8.8726319e-05  2.6109412e-16  0              2.995215     
   2000000   155.1          200            200            0.0033795145   7.2504921e-40  0              0.010138543    2.200495e-12   0              1.0625403e-05  2.6109412e-16  0              2.995215     
   2100000   155.1          200            200            0.0033795142   1.0868949e-38  0              0.010138543    2.5066021e-13  0              1.2103484e-06  2.6109412e-16  0              2.995215     
   2200000   155.1          200            200            0.0033795141   1.3666462e-38  0              0.010138542    2.6877366e-14  0              1.2978118e-07  2.6109412e-16  0              2.995215     
   2300000   155.1          200            200            0.0033795141   5.1894576e-39  0              0.010138542    2.667748e-15   0              1.28816e-08    2.6109412e-16  0              2.995215     
   2400000   155.1          200            200            0.0033795141  -1.6501008e-38  0              0.010138542    2.3815817e-16  0              1.1499806e-09  2.6109412e-16  0              2.995215     
   2500000   155.1          200            200            0.003379514    1.4209825e-38  0              0.010138542    1.7560876e-17  0              8.4795187e-11  2.6109412e-16  0              2.995215     
   2600000   155.1          200            200            0.003379514    7.9722084e-39  0              0.010138542    7.6950163e-19  0              3.715648e-12   2.6109412e-16  0              2.995215     
   2700000   155.1          200            200            0.003379514    1.4514548e-38  0              0.010138542    3.3512957e-20  0              1.6182208e-13  2.6109412e-16  0              2.995215     
   2800000   155.1          200            200            0.003379514    2.3966435e-38  0              0.010138542    8.2207575e-21  0              3.9695096e-14  2.6109412e-16  0              2.995215     
   2900000   155.1          200            200            0.003379514    2.4475295e-38  0              0.010138542    3.5138827e-20  0              1.6967282e-13  2.6109412e-16  0              2.995215     
   3000000   155.1          200            200            0.003379514   -9.7137915e-39  0              0.010138542    8.3803734e-20  0              4.0465824e-13  2.6109412e-16  0              2.995215     
Loop time of 64.0237 on 4 procs for 3000000 steps with 51 atoms

Performance: 40484986.673 ns/day, 0.000 hours/ns, 46857.623 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 0.32528    | 1.5406     | 5.0176     | 161.8 |  2.41
Neigh   | 0.079928   | 0.080465   | 0.081942   |   0.3 |  0.13
Comm    | 25.707     | 32.158     | 37.886     |  83.0 | 50.23
Output  | 0.060163   | 0.060238   | 0.060292   |   0.0 |  0.09
Modify  | 15.262     | 21.019     | 28.131     | 119.4 | 32.83
Other   |            | 9.166      |            |       | 14.32

Nlocal:          12.75 ave          51 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1
Nghost:          39.25 ave          52 max           1 min
Histogram: 1 0 0 0 0 0 0 0 0 3
Neighs:           6.25 ave          25 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1

Total # of neighbors = 25
Ave neighs/atom = 0.49019608
Neighbor list builds = 166
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 67

#variable lat0 equal 1                    #
variable lat1 equal 3+(151*0.01)+(v_ind*0.01)  # .491+(v_ind*0.001)       # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 10*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 5.18                                                               
Lattice spacing in x,y,z = 5.18 5.18 5.18

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -77.7 ${n1e1} -100 100 -100 100 units box
region box block -77.7 77.7 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -77.7 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -77.7 77.7 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-77.7 -100 -100) to (77.7 100 100)
  1 by 2 by 2 MPI processor grid
create_atoms 1 region substrate
Created 30 atoms
  using lattice units in orthogonal box = (-77.7 -100 -100) to (77.7 100 100)
  create_atoms CPU = 0.000 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 30 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 21 atoms
  using lattice units in orthogonal box = (-77.7 -100 -100) to (77.7 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  30 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  30 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  21 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  21 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
30 atoms in group substrate
group slider1 region slider1
21 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 21 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_67_*.dump id type diameter mass xu yu zu fx fy fz

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 101 130 130
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 14.69 | 18.16 | 19.32 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   155.4          200            200            0              0              0              0              0              0              0              2.6109412e-16  0              6            
    100000   155.4          200            200            0.0027264495  -1.9828633e-38  0              0.0081793486   12149.037      0              5.8663353e+10  2.6109412e-16  0              3.3317382    
    200000   155.4          200            200            0.0009305952   9.5528243e-38  0              0.0027917856   2791.94        0              1.3481279e+10  2.6109412e-16  0              3.0818257    
    300000   155.4          200            200           -8.6376203e-06  2.9187111e-38  0             -2.5912861e-05  0.5343765      0              2580312.9      2.6109412e-16  0              3.0442525    
    400000   155.4          200            200           -0.00011248046  1.4282914e-35  0             -0.00033744137  115.01233      0              5.5535339e+08  2.6109412e-16  0              3.0008069    
    500000   155.4          200            200            0.0032539914  -6.3895497e-36  0              0.0097619742   29.528659      0              1.4258333e+08  2.6109412e-16  0              2.995392     
    600000   155.4          200            200            0.0025185133  -3.010665e-36   0              0.0075555398   1.6962759      0              8190709.1      2.6109412e-16  0              2.9960785    
    700000   155.4          200            200            0.0029995378   6.2908757e-37  0              0.0089986133   0.11952871     0              577161.34      2.6109412e-16  0              2.9955794    
    800000   155.4          200            200            0.0032249036  -5.2813263e-37  0              0.0096747107   0.0081352864   0              39282.387      2.6109412e-16  0              2.9953573    
    900000   155.4          200            200            0.0033161027   6.7102697e-37  0              0.009948308    0.0003844726   0              1856.4806      2.6109412e-16  0              2.9952692    
   1000000   155.4          200            200            0.0033516281   1.364706e-37   0              0.010054884    4.4018266e-06  0              21.254845      2.6109412e-16  0              2.9952353    
   1100000   155.4          200            200            0.0033651316   1.3312046e-37  0              0.010095395    1.2670679e-06  0              6.1182174      2.6109412e-16  0              2.9952224    
   1200000   155.4          200            200            0.0033701567  -2.2807402e-38  0              0.01011047     1.2189904e-06  0              5.8860684      2.6109412e-16  0              2.9952177    
   1300000   155.4          200            200            0.0033719895   4.1380245e-39  0              0.010115968    4.250989e-07   0              2.0526504      2.6109412e-16  0              2.995216     
   1400000   155.4          200            200            0.0033726445   1.807502e-39   0              0.010117933    1.0599377e-07  0              0.511806       2.6109412e-16  0              2.9952153    
   1500000   155.4          200            200            0.0033728736   2.1101418e-40  0              0.010118621    2.2184137e-08  0              0.10711926     2.6109412e-16  0              2.9952151    
   1600000   155.4          200            200            0.0033729519   1.0647604e-38  0              0.010118856    4.1535275e-09  0              0.020055898    2.6109412e-16  0              2.995215     
   1700000   155.4          200            200            0.003372978    7.3582465e-39  0              0.010118934    7.1794523e-10  0              0.0034667006   2.6109412e-16  0              2.995215     
   1800000   155.4          200            200            0.0033729863  -1.0918646e-38  0              0.010118959    1.1660527e-10  0              0.00056304509  2.6109412e-16  0              2.995215     
   1900000   155.4          200            200            0.0033729889   6.9353098e-39  0              0.010118967    1.7983977e-11  0              8.6838188e-05  2.6109412e-16  0              2.995215     
   2000000   155.4          200            200            0.0033729897  -1.4425616e-38  0              0.010118969    2.6506053e-12  0              1.2798824e-05  2.6109412e-16  0              2.995215     
   2100000   155.4          200            200            0.0033729898   8.3118684e-39  0              0.01011897     3.7479793e-13  0              1.8097651e-06  2.6109412e-16  0              2.995215     
   2200000   155.4          200            200            0.0033729899  -6.1179093e-39  0              0.01011897     5.0910471e-14  0              2.4582844e-07  2.6109412e-16  0              2.995215     
   2300000   155.4          200            200            0.0033729899   1.8092486e-39  0              0.01011897     6.6471513e-15  0              3.2096715e-08  2.6109412e-16  0              2.995215     
   2400000   155.4          200            200            0.0033729899   4.3728901e-39  0              0.01011897     8.3316154e-16  0              4.0230389e-09  2.6109412e-16  0              2.995215     
   2500000   155.4          200            200            0.0033729899   7.5646963e-39  0              0.01011897     9.8680697e-17  0              4.7649377e-10  2.6109412e-16  0              2.995215     
   2600000   155.4          200            200            0.0033729899  -2.4494137e-39  0              0.01011897     1.0753377e-17  0              5.1924208e-11  2.6109412e-16  0              2.995215     
   2700000   155.4          200            200            0.0033729899  -9.7561883e-39  0              0.01011897     1.2184316e-18  0              5.8833703e-12  2.6109412e-16  0              2.995215     
   2800000   155.4          200            200            0.0033729899   2.1390785e-38  0              0.01011897     5.5237519e-20  0              2.6672221e-13  2.6109412e-16  0              2.995215     
   2900000   155.4          200            200            0.0033729899   2.9577756e-38  0              0.01011897     1.072942e-19   0              5.180853e-13   2.6109412e-16  0              2.995215     
   3000000   155.4          200            200            0.0033729899  -3.2724135e-38  0              0.01011897     2.7995806e-20  0              1.3518173e-13  2.6109412e-16  0              2.995215     
Loop time of 64.2246 on 4 procs for 3000000 steps with 51 atoms

Performance: 40358365.977 ns/day, 0.000 hours/ns, 46711.072 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 0.31455    | 1.5575     | 5.0924     | 163.6 |  2.43
Neigh   | 0.079875   | 0.080452   | 0.081982   |   0.3 |  0.13
Comm    | 25.772     | 32.428     | 38.162     |  84.4 | 50.49
Output  | 0.06023    | 0.060306   | 0.060358   |   0.0 |  0.09
Modify  | 15.274     | 21.05      | 28.386     | 121.6 | 32.78
Other   |            | 9.048      |            |       | 14.09

Nlocal:          12.75 ave          51 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1
Nghost:          39.25 ave          52 max           1 min
Histogram: 1 0 0 0 0 0 0 0 0 3
Neighs:           6.25 ave          25 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1

Total # of neighbors = 25
Ave neighs/atom = 0.49019608
Neighbor list builds = 166
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 68

#variable lat0 equal 1                    #
variable lat1 equal 3+(151*0.01)+(v_ind*0.01)  # .491+(v_ind*0.001)       # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 10*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 5.19                                                               
Lattice spacing in x,y,z = 5.19 5.19 5.19

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -77.85 ${n1e1} -100 100 -100 100 units box
region box block -77.85 77.85 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -77.85 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -77.85 77.85 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-77.85 -100 -100) to (77.85 100 100)
  1 by 2 by 2 MPI processor grid
create_atoms 1 region substrate
Created 29 atoms
  using lattice units in orthogonal box = (-77.85 -100 -100) to (77.85 100 100)
  create_atoms CPU = 0.000 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 30 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 21 atoms
  using lattice units in orthogonal box = (-77.85 -100 -100) to (77.85 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  29 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  29 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  21 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  21 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
29 atoms in group substrate
group slider1 region slider1
21 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 21 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_68_*.dump id type diameter mass xu yu zu fx fy fz

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 101 130 130
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 14.69 | 18.16 | 19.32 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   155.7          200            200            0              0              0              0              0              0              0              2.6109412e-16  0              6            
    100000   155.7          200            200            0.0027244033   7.4217926e-40  0              0.00817321     12168.144      0              6.5284012e+10  2.6109412e-16  0              3.3318438    
    200000   155.7          200            200            0.00093836298  5.5436998e-38  0              0.0028150889   2836.4571      0              1.521804e+10   2.6109412e-16  0              3.0808194    
    300000   155.7          200            200            2.6069289e-05  7.6292204e-37  0              7.8207868e-05  4.7333345      0              25395087       2.6109412e-16  0              3.0450682    
    400000   155.7          200            200            6.1959171e-06  5.4640077e-37  0              1.8587751e-05  0.28713154     0              1540506        2.6109412e-16  0              3.0064522    
    500000   155.7          200            200            0.0066523381  -1.3152984e-35  0              0.019957014    2.1199109      0              11373657       2.6109412e-16  0              2.9924479    
    600000   155.7          200            200            0.0043069269   1.5356666e-35  0              0.012920781    1.578526       0              8469041.3      2.6109412e-16  0              2.9943727    
    700000   155.7          200            200            0.0036379161  -3.1736503e-37  0              0.010913748    0.33511759     0              1797958.8      2.6109412e-16  0              2.9949671    
    800000   155.7          200            200            0.0034466954  -7.4884534e-38  0              0.010340086    0.055356881    0              296998.41      2.6109412e-16  0              2.9951418    
    900000   155.7          200            200            0.0033887085   6.0453733e-38  0              0.010166126    0.0085795331   0              46030.55       2.6109412e-16  0              2.995195     
   1000000   155.7          200            200            0.0033718391   7.8679153e-38  0              0.010115517    0.001270874    0              6818.4395      2.6109412e-16  0              2.9952103    
   1100000   155.7          200            200            0.0033673788  -2.8287862e-39  0              0.010102136    0.0001806288   0              969.10202      2.6109412e-16  0              2.9952143    
   1200000   155.7          200            200            0.0033664134  -1.5753647e-38  0              0.01009924     2.4672954e-05  0              132.37429      2.6109412e-16  0              2.9952151    
   1300000   155.7          200            200            0.0033663142   8.738734e-39   0              0.010098943    3.2396668e-06  0              17.381324      2.6109412e-16  0              2.9952152    
   1400000   155.7          200            200            0.0033663726   6.9489644e-39  0              0.010099118    4.0838862e-07  0              2.1910694      2.6109412e-16  0              2.9952151    
   1500000   155.7          200            200            0.0033664286  -4.9122114e-39  0              0.010099286    4.9274321e-08  0              0.26436451     2.6109412e-16  0              2.9952151    
   1600000   155.7          200            200            0.0033664615   9.3159361e-39  0              0.010099385    5.6597638e-09  0              0.030365526    2.6109412e-16  0              2.995215     
   1700000   155.7          200            200            0.0033664779  -4.0547427e-39  0              0.010099434    6.1340163e-10  0              0.0032909966   2.6109412e-16  0              2.995215     
   1800000   155.7          200            200            0.0033664854   9.5244282e-39  0              0.010099456    6.1811909e-11  0              0.00033163065  2.6109412e-16  0              2.995215     
   1900000   155.7          200            200            0.0033664886  -2.4346834e-39  0              0.010099466    5.6450302e-12  0              3.0286478e-05  2.6109412e-16  0              2.995215     
   2000000   155.7          200            200            0.00336649    -2.2974532e-39  0              0.01009947     4.4484767e-13  0              2.386678e-06   2.6109412e-16  0              2.995215     
   2100000   155.7          200            200            0.0033664905  -5.889842e-39   0              0.010099472    2.7002636e-14  0              1.4487341e-07  2.6109412e-16  0              2.995215     
   2200000   155.7          200            200            0.0033664907   3.6294261e-39  0              0.010099472    8.6993929e-16  0              4.6673617e-09  2.6109412e-16  0              2.995215     
   2300000   155.7          200            200            0.0033664908   2.0340038e-38  0              0.010099472    4.7470165e-19  0              2.5468493e-12  2.6109412e-16  0              2.995215     
   2400000   155.7          200            200            0.0033664908  -2.247686e-39   0              0.010099473    1.9054795e-17  0              1.0223199e-10  2.6109412e-16  0              2.995215     
   2500000   155.7          200            200            0.0033664909   2.1875726e-39  0              0.010099473    9.2515925e-18  0              4.9636255e-11  2.6109412e-16  0              2.995215     
   2600000   155.7          200            200            0.0033664909   1.5856228e-38  0              0.010099473    3.1018051e-18  0              1.6641674e-11  2.6109412e-16  0              2.995215     
   2700000   155.7          200            200            0.0033664909   6.6185248e-39  0              0.010099473    6.9492574e-19  0              3.7283863e-12  2.6109412e-16  0              2.995215     
   2800000   155.7          200            200            0.0033664909   1.606835e-38   0              0.010099473    1.8199196e-19  0              9.764156e-13   2.6109412e-16  0              2.995215     
   2900000   155.7          200            200            0.0033664909   2.9881717e-38  0              0.010099473    5.3816618e-21  0              2.8873465e-14  2.6109412e-16  0              2.995215     
   3000000   155.7          200            200            0.0033664909   8.5061747e-39  0              0.010099473    1.0704594e-19  0              5.7431835e-13  2.6109412e-16  0              2.995215     
Loop time of 62.9339 on 4 procs for 3000000 steps with 50 atoms

Performance: 41186092.469 ns/day, 0.000 hours/ns, 47669.089 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 0.32871    | 1.4802     | 4.8068     | 157.9 |  2.35
Neigh   | 0.0799     | 0.080426   | 0.081887   |   0.3 |  0.13
Comm    | 25.078     | 31.358     | 36.913     |  82.1 | 49.83
Output  | 0.06099    | 0.061066   | 0.061122   |   0.0 |  0.10
Modify  | 15.186     | 20.815     | 27.692     | 116.8 | 33.07
Other   |            | 9.139      |            |       | 14.52

Nlocal:           12.5 ave          50 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1
Nghost:           37.5 ave          50 max           0 min
Histogram: 1 0 0 0 0 0 0 0 0 3
Neighs:           6.25 ave          25 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1

Total # of neighbors = 25
Ave neighs/atom = 0.5
Neighbor list builds = 166
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 69

#variable lat0 equal 1                    #
variable lat1 equal 3+(151*0.01)+(v_ind*0.01)  # .491+(v_ind*0.001)       # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 10*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 5.2                                                               
Lattice spacing in x,y,z = 5.2 5.2 5.2

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -78 ${n1e1} -100 100 -100 100 units box
region box block -78 78 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -78 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -78 78 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-78 -100 -100) to (78 100 100)
  1 by 2 by 2 MPI processor grid
create_atoms 1 region substrate
Created 30 atoms
  using lattice units in orthogonal box = (-78 -100 -100) to (78 100 100)
  create_atoms CPU = 0.000 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 30 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 21 atoms
  using lattice units in orthogonal box = (-78 -100 -100) to (78 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  30 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  30 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  21 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  21 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
30 atoms in group substrate
group slider1 region slider1
21 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 21 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_69_*.dump id type diameter mass xu yu zu fx fy fz

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 101 130 130
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 14.69 | 18.16 | 19.32 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   156            200            200            0              0              0              0              0              0              0              2.6109412e-16  0              6            
    100000   156            200            200            0.0027223131   6.1729112e-41  0              0.0081669394   12187.241      0              5.8847827e+10  2.6109412e-16  0              3.331833     
    200000   156            200            200            0.00094333478 -1.9751978e-38  0              0.0028300043   2867.7718      0              1.3847444e+10  2.6109412e-16  0              3.0805433    
    300000   156            200            200            4.8157481e-05  1.2694093e-37  0              0.00014447244  15.667235      0              75651470       2.6109412e-16  0              3.045732     
    400000   156            200            200            0.00013993789  5.182235e-37   0              0.00041981368  120.36456      0              5.811974e+08   2.6109412e-16  0              3.0012498    
    500000   156            200            200            0.0060967182  -0.00015788172  0              0.018448036    11.33604       0              54737681       2.6109412e-16  0              2.9929729    
    600000   156            200            200            0.0038467222  -2.6384499e-37  0              0.011540167    3.3433377      0              16143781       2.6109412e-16  0              2.9947825    
    700000   156            200            200            0.0034494416   4.7425027e-37  0              0.010348325    0.51990583     0              2510439.2      2.6109412e-16  0              2.9951383    
    800000   156            200            200            0.0033703541  -1.4617297e-37  0              0.010111062    0.073038356    0              352676.08      2.6109412e-16  0              2.9952082    
    900000   156            200            200            0.0033558106   4.2875307e-38  0              0.010067432    0.0098467183   0              47546.279      2.6109412e-16  0              2.9952201    
   1000000   156            200            200            0.0033555424   6.3100672e-38  0              0.010066627    0.0012765119   0              6163.819       2.6109412e-16  0              2.9952197    
   1100000   156            200            200            0.0033573216   6.4678922e-39  0              0.010071965    0.00015877551  0              766.67012      2.6109412e-16  0              2.9952177    
   1200000   156            200            200            0.0033586581   2.4775752e-38  0              0.010075974    1.8875116e-05  0              91.141179      2.6109412e-16  0              2.9952164    
   1300000   156            200            200            0.0033593916   3.2413096e-39  0              0.010078175    2.1309932e-06  0              10.289804      2.6109412e-16  0              2.9952156    
   1400000   156            200            200            0.0033597452   7.1782797e-40  0              0.010079236    2.2612442e-07  0              1.0918739      2.6109412e-16  0              2.9952153    
   1500000   156            200            200            0.0033599036  -4.6952736e-39  0              0.010079711    2.2163147e-08  0              0.10701791     2.6109412e-16  0              2.9952151    
   1600000   156            200            200            0.0033599711   1.3098059e-39  0              0.010079913    1.94511e-09    0              0.0093922399   2.6109412e-16  0              2.9952151    
   1700000   156            200            200            0.0033599988   3.9207912e-39  0              0.010079997    1.4359546e-10  0              0.00069337109  2.6109412e-16  0              2.995215     
   1800000   156            200            200            0.0033600099  -1.3208196e-39  0              0.01008003     7.6257684e-12  0              3.6822106e-05  2.6109412e-16  0              2.995215     
   1900000   156            200            200            0.0033600142   3.3694057e-39  0              0.010080043    1.5219041e-13  0              7.3487302e-07  2.6109412e-16  0              2.995215     
   2000000   156            200            200            0.0033600159   3.1760816e-39  0              0.010080048    8.0189653e-15  0              3.8720714e-08  2.6109412e-16  0              2.995215     
   2100000   156            200            200            0.0033600165  -2.8836944e-39  0              0.010080049    1.3926361e-14  0              6.7245413e-08  2.6109412e-16  0              2.995215     
   2200000   156            200            200            0.0033600167  -4.9297987e-39  0              0.01008005     5.4583495e-15  0              2.6356416e-08  2.6109412e-16  0              2.995215     
   2300000   156            200            200            0.0033600168   1.9808051e-39  0              0.01008005     1.4261571e-15  0              6.8864021e-09  2.6109412e-16  0              2.995215     
   2400000   156            200            200            0.0033600168   5.5072941e-39  0              0.01008005     3.092057e-16   0              1.4930437e-09  2.6109412e-16  0              2.995215     
   2500000   156            200            200            0.0033600168   1.2105871e-39  0              0.010080051    5.9796752e-17  0              2.8873711e-10  2.6109412e-16  0              2.995215     
   2600000   156            200            200            0.0033600168   1.9359631e-39  0              0.010080051    1.0567018e-17  0              5.1024347e-11  2.6109412e-16  0              2.995215     
   2700000   156            200            200            0.0033600168   8.1834343e-39  0              0.010080051    1.6440555e-18  0              7.9385557e-12  2.6109412e-16  0              2.995215     
   2800000   156            200            200            0.0033600168  -2.8731387e-40  0              0.010080051    2.8763722e-19  0              1.3888972e-12  2.6109412e-16  0              2.995215     
   2900000   156            200            200            0.0033600168  -1.7407128e-39  0              0.010080051    4.5732828e-20  0              2.2082746e-13  2.6109412e-16  0              2.995215     
   3000000   156            200            200            0.0033600168  -3.0826954e-39  0              0.010080051    6.0247271e-21  0              2.9091251e-14  2.6109412e-16  0              2.995215     
Loop time of 64.1019 on 4 procs for 3000000 steps with 51 atoms

Performance: 40435613.108 ns/day, 0.000 hours/ns, 46800.478 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 0.31899    | 1.5318     | 5.0216     | 162.9 |  2.39
Neigh   | 0.078875   | 0.079418   | 0.080906   |   0.3 |  0.12
Comm    | 25.758     | 32.237     | 37.897     |  83.1 | 50.29
Output  | 0.059771   | 0.059849   | 0.059906   |   0.0 |  0.09
Modify  | 15.27      | 21         | 28.047     | 118.4 | 32.76
Other   |            | 9.194      |            |       | 14.34

Nlocal:          12.75 ave          51 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1
Nghost:          39.25 ave          52 max           1 min
Histogram: 1 0 0 0 0 0 0 0 0 3
Neighs:           6.25 ave          25 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1

Total # of neighbors = 25
Ave neighs/atom = 0.49019608
Neighbor list builds = 164
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 70

#variable lat0 equal 1                    #
variable lat1 equal 3+(151*0.01)+(v_ind*0.01)  # .491+(v_ind*0.001)       # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 10*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 5.21                                                               
Lattice spacing in x,y,z = 5.21 5.21 5.21

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -78.15 ${n1e1} -100 100 -100 100 units box
region box block -78.15 78.15 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -78.15 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -78.15 78.15 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-78.15 -100 -100) to (78.15 100 100)
  1 by 2 by 2 MPI processor grid
create_atoms 1 region substrate
Created 30 atoms
  using lattice units in orthogonal box = (-78.15 -100 -100) to (78.15 100 100)
  create_atoms CPU = 0.000 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 30 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 21 atoms
  using lattice units in orthogonal box = (-78.15 -100 -100) to (78.15 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  30 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  30 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  21 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  21 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
30 atoms in group substrate
group slider1 region slider1
21 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 21 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_70_*.dump id type diameter mass xu yu zu fx fy fz

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 101 130 130
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 14.69 | 18.16 | 19.32 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   156.3          200            200            0              0              0              0              0              0              0              2.6109412e-16  0              6            
    100000   156.3          200            200            0.0027196247  -5.390877e-41   0              0.008158874    12202.3        0              5.8920542e+10  2.6109412e-16  0              3.3319631    
    200000   156.3          200            200            0.00094571905 -9.8569397e-40  0              0.0028371572   2886.7823      0              1.3939239e+10  2.6109412e-16  0              3.0808518    
    300000   156.3          200            200            5.9694279e-05  1.1046187e-37  0              0.00017908284  23.756822      0              1.1471319e+08  2.6109412e-16  0              3.0465482    
    400000   156.3          200            200            0.005101743   -0.00087400357  0              0.016179233    212.76166      0              1.0273499e+09  2.6109412e-16  0              2.9944101    
    500000   156.3          200            200            0.0036353952  -0.00045592545  0              0.011362111    33.610212      0              1.6229168e+08  2.6109412e-16  0              2.9950693    
    600000   156.3          200            200            0.0025458946  -9.5172867e-36  0              0.0076376838   2.8076157      0              13556971       2.6109412e-16  0              2.9960392    
    700000   156.3          200            200            0.0035639819  -0.00022914857  0              0.010921094    0.50721899     0              2449179        2.6109412e-16  0              2.9951909    
    800000   156.3          200            200            0.0031499581  -0.00010331955  0              0.0095531939   0.028161768    0              135983.1       2.6109412e-16  0              2.9954645    
    900000   156.3          200            200            0.003230927   -0.00015306853  0              0.0098458494   0.0014308005   0              6908.8238      2.6109412e-16  0              2.9954       
   1000000   156.3          200            200            0.0032925889  -0.00015794637  0              0.010035713    0.0014221715   0              6867.1573      2.6109412e-16  0              2.9953604    
   1100000   156.3          200            200            0.0033066933  -0.00015889688  0              0.010078977    0.000140873    0              680.22528      2.6109412e-16  0              2.9953517    
   1200000   156.3          200            200            0.0033046427  -0.00015874918  0              0.010072677    7.8306517e-08  0              0.37811414     2.6109412e-16  0              2.9953531    
   1300000   156.3          200            200            0.0033018112  -0.00015855498  0              0.010063989    2.1841978e-06  0              10.54671       2.6109412e-16  0              2.9953549    
   1400000   156.3          200            200            0.0033008037  -0.00015848654  0              0.010060898    5.0328171e-07  0              2.4301673      2.6109412e-16  0              2.9953555    
   1500000   156.3          200            200            0.0033007287  -0.00015848187  0              0.010060668    1.4992486e-08  0              0.072393351    2.6109412e-16  0              2.9953556    
   1600000   156.3          200            200            0.003300831   -0.00015848903  0              0.010060982    1.6282747e-09  0              0.007862356    2.6109412e-16  0              2.9953555    
   1700000   156.3          200            200            0.0033008876  -0.00015849291  0              0.010061156    1.2185825e-09  0              0.0058840985   2.6109412e-16  0              2.9953555    
   1800000   156.3          200            200            0.0033008995  -0.00015849371  0              0.010061192    1.0824861e-10  0              0.00052269377  2.6109412e-16  0              2.9953554    
   1900000   156.3          200            200            0.0033008972  -0.00015849354  0              0.010061185    2.1875889e-17  0              1.0563084e-10  2.6109412e-16  0              2.9953554    
   2000000   156.3          200            200            0.0033008946  -0.00015849336  0              0.010061177    1.9760545e-12  0              9.54166e-06    2.6109412e-16  0              2.9953554    
   2100000   156.3          200            200            0.0033008937  -0.0001584933   0              0.010061174    4.0884787e-13  0              1.97418e-06    2.6109412e-16  0              2.9953554    
   2200000   156.3          200            200            0.0033008937  -0.0001584933   0              0.010061174    1.0073902e-14  0              4.8643267e-08  2.6109412e-16  0              2.9953554    
   2300000   156.3          200            200            0.0033008938  -0.00015849331  0              0.010061175    1.6690846e-15  0              8.059412e-09   2.6109412e-16  0              2.9953554    
   2400000   156.3          200            200            0.0033008938  -0.00015849331  0              0.010061175    1.0339616e-15  0              4.9926308e-09  2.6109412e-16  0              2.9953554    
   2500000   156.3          200            200            0.0033008938  -0.00015849331  0              0.010061175    8.3608296e-17  0              4.0371454e-10  2.6109412e-16  0              2.9953554    
   2600000   156.3          200            200            0.0033008938  -0.00015849331  0              0.010061175    2.2344921e-21  0              1.0789563e-14  2.6109412e-16  0              2.9953554    
   2700000   156.3          200            200            0.0033008938  -0.00015849331  0              0.010061175    2.235134e-18   0              1.0792662e-11  2.6109412e-16  0              2.9953554    
   2800000   156.3          200            200            0.0033008938  -0.00015849331  0              0.010061175    1.4397757e-19  0              6.9521614e-13  2.6109412e-16  0              2.9953554    
   2900000   156.3          200            200            0.0033008938  -0.00015849331  0              0.010061175    9.0292207e-20  0              4.3598875e-13  2.6109412e-16  0              2.9953554    
   3000000   156.3          200            200            0.0033008938  -0.00015849331  0              0.010061175    2.0990107e-20  0              1.0135372e-13  2.6109412e-16  0              2.9953554    
Loop time of 63.9991 on 4 procs for 3000000 steps with 51 atoms

Performance: 40500564.104 ns/day, 0.000 hours/ns, 46875.653 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 0.33328    | 1.58       | 5.2164     | 167.0 |  2.47
Neigh   | 0.078898   | 0.079478   | 0.081006   |   0.3 |  0.12
Comm    | 25.798     | 32.152     | 37.889     |  82.1 | 50.24
Output  | 0.057871   | 0.05795    | 0.058005   |   0.0 |  0.09
Modify  | 15.234     | 20.954     | 28.006     | 118.8 | 32.74
Other   |            | 9.175      |            |       | 14.34

Nlocal:          12.75 ave          51 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1
Nghost:          39.25 ave          52 max           1 min
Histogram: 1 0 0 0 0 0 0 0 0 3
Neighs:           6.25 ave          25 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1

Total # of neighbors = 25
Ave neighs/atom = 0.49019608
Neighbor list builds = 164
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 71

#variable lat0 equal 1                    #
variable lat1 equal 3+(151*0.01)+(v_ind*0.01)  # .491+(v_ind*0.001)       # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 10*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 5.22                                                               
Lattice spacing in x,y,z = 5.22 5.22 5.22

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -78.3 ${n1e1} -100 100 -100 100 units box
region box block -78.3 78.3 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -78.3 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -78.3 78.3 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-78.3 -100 -100) to (78.3 100 100)
  1 by 2 by 2 MPI processor grid
create_atoms 1 region substrate
Created 30 atoms
  using lattice units in orthogonal box = (-78.3 -100 -100) to (78.3 100 100)
  create_atoms CPU = 0.000 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 30 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 21 atoms
  using lattice units in orthogonal box = (-78.3 -100 -100) to (78.3 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  30 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  30 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  21 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  21 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
30 atoms in group substrate
group slider1 region slider1
21 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 21 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_71_*.dump id type diameter mass xu yu zu fx fy fz

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 102 130 130
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 14.71 | 18.18 | 19.34 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   156.6          200            200            0              0              0              0              0              0              0              2.6109412e-16  0              6            
    100000   156.6          200            200            0.0027163523  -2.8824381e-42  0              0.008149057    12213.531      0              5.8974769e+10  2.6109412e-16  0              3.3321773    
    200000   156.6          200            200            0.00094616047  6.1492077e-41  0              0.0028384814   2896.5764      0              1.3986531e+10  2.6109412e-16  0              3.0814873    
    300000   156.6          200            200            6.4014493e-05  1.9678183e-39  0              0.00019204348  27.240964      0              1.3153687e+08  2.6109412e-16  0              3.0474689    
    400000   156.6          200            200            0.013622455   -0.0051386692   0              0.046006035    87.890995      0              4.2439416e+08  2.6109412e-16  0              2.9921282    
    500000   156.6          200            200            0.0082073216  -0.0027672598   0              0.027389225    0.2791305      0              1347821.3      2.6109412e-16  0              2.9939774    
    600000   156.6          200            200            0.0030383863  -0.001111842    0              0.010227001    5.4361858      0              26249396       2.6109412e-16  0              2.9961954    
    700000   156.6          200            200            0.0024771793  -0.00070679982  0              0.0081383376   0.066718238    0              322158.5       2.6109412e-16  0              2.9965608    
    800000   156.6          200            200            0.0031006034  -0.00080396742  0              0.010105778    0.096826089    0              467538.53      2.6109412e-16  0              2.9962297    
    900000   156.6          200            200            0.0031572173  -0.00080832335  0              0.010279975    0.0037430451   0              18073.825      2.6109412e-16  0              2.9961995    
   1000000   156.6          200            200            0.0030517912  -0.00080062393  0              0.0099559976   0.00044640442  0              2155.5272      2.6109412e-16  0              2.9962523    
   1100000   156.6          200            200            0.0030803171  -0.00080273586  0              0.010043687    0.00024086425  0              1163.0473      2.6109412e-16  0              2.9962382    
   1200000   156.6          200            200            0.0030847369  -0.00080307964  0              0.01005729     6.1658173e-06  0              29.772525      2.6109412e-16  0              2.9962359    
   1300000   156.6          200            200            0.0030793513  -0.00080267916  0              0.010040733    1.5495011e-06  0              7.4819865      2.6109412e-16  0              2.9962386    
   1400000   156.6          200            200            0.0030806091  -0.0008027708   0              0.010044598    5.8490567e-07  0              2.8243001      2.6109412e-16  0              2.9962379    
   1500000   156.6          200            200            0.0030809045  -0.0008027935   0              0.010045507    9.0281471e-09  0              0.043593691    2.6109412e-16  0              2.9962378    
   1600000   156.6          200            200            0.0030806325  -0.00080277329  0              0.010044671    5.0065584e-09  0              0.024174879    2.6109412e-16  0              2.9962379    
   1700000   156.6          200            200            0.0030806862  -0.00080277718  0              0.010044836    1.3862649e-09  0              0.0066937769   2.6109412e-16  0              2.9962379    
   1800000   156.6          200            200            0.0030807045  -0.00080277858  0              0.010044892    1.0573595e-11  0              5.1056105e-05  2.6109412e-16  0              2.9962379    
   1900000   156.6          200            200            0.003080691   -0.00080277757  0              0.01004485     1.5350716e-11  0              7.4123112e-05  2.6109412e-16  0              2.9962379    
   2000000   156.6          200            200            0.0030806932  -0.00080277773  0              0.010044857    3.2032099e-12  0              1.5467154e-05  2.6109412e-16  0              2.9962379    
   2100000   156.6          200            200            0.0030806942  -0.00080277781  0              0.010044861    7.4687582e-15  0              3.606396e-08   2.6109412e-16  0              2.9962379    
   2200000   156.6          200            200            0.0030806936  -0.00080277776  0              0.010044858    4.5110751e-14  0              2.1782367e-07  2.6109412e-16  0              2.9962379    
   2300000   156.6          200            200            0.0030806937  -0.00080277776  0              0.010044859    7.1984674e-15  0              3.4758823e-08  2.6109412e-16  0              2.9962379    
   2400000   156.6          200            200            0.0030806937  -0.00080277777  0              0.010044859    1.6432532e-19  0              7.9346816e-13  2.6109412e-16  0              2.9962379    
   2500000   156.6          200            200            0.0030806937  -0.00080277777  0              0.010044859    1.2774852e-16  0              6.168519e-10   2.6109412e-16  0              2.9962379    
   2600000   156.6          200            200            0.0030806937  -0.00080277777  0              0.010044859    1.557025e-17   0              7.5183164e-11  2.6109412e-16  0              2.9962379    
   2700000   156.6          200            200            0.0030806937  -0.00080277777  0              0.010044859    4.4839461e-19  0              2.1651371e-12  2.6109412e-16  0              2.9962379    
   2800000   156.6          200            200            0.0030806937  -0.00080277777  0              0.010044859    2.2886099e-19  0              1.1050878e-12  2.6109412e-16  0              2.9962379    
   2900000   156.6          200            200            0.0030806937  -0.00080277777  0              0.010044859    6.7327475e-20  0              3.2510028e-13  2.6109412e-16  0              2.9962379    
   3000000   156.6          200            200            0.0030806937  -0.00080277777  0              0.010044859    2.2150665e-20  0              1.0695763e-13  2.6109412e-16  0              2.9962379    
Loop time of 64.0409 on 4 procs for 3000000 steps with 51 atoms

Performance: 40474160.803 ns/day, 0.000 hours/ns, 46845.094 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 0.3335     | 1.6144     | 5.3149     | 168.2 |  2.52
Neigh   | 0.08066    | 0.081247   | 0.082763   |   0.3 |  0.13
Comm    | 25.697     | 32.082     | 37.817     |  82.3 | 50.10
Output  | 0.061924   | 0.061997   | 0.062045   |   0.0 |  0.10
Modify  | 15.357     | 21.058     | 28.158     | 119.3 | 32.88
Other   |            | 9.143      |            |       | 14.28

Nlocal:          12.75 ave          51 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1
Nghost:          39.25 ave          52 max           1 min
Histogram: 1 0 0 0 0 0 0 0 0 3
Neighs:           6.75 ave          27 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1

Total # of neighbors = 27
Ave neighs/atom = 0.52941176
Neighbor list builds = 166
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 72

#variable lat0 equal 1                    #
variable lat1 equal 3+(151*0.01)+(v_ind*0.01)  # .491+(v_ind*0.001)       # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 10*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 5.23                                                               
Lattice spacing in x,y,z = 5.23 5.23 5.23

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -78.45 ${n1e1} -100 100 -100 100 units box
region box block -78.45 78.45 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -78.45 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -78.45 78.45 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-78.45 -100 -100) to (78.45 100 100)
  1 by 2 by 2 MPI processor grid
create_atoms 1 region substrate
Created 30 atoms
  using lattice units in orthogonal box = (-78.45 -100 -100) to (78.45 100 100)
  create_atoms CPU = 0.000 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 30 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 21 atoms
  using lattice units in orthogonal box = (-78.45 -100 -100) to (78.45 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  30 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  30 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  21 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  21 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
30 atoms in group substrate
group slider1 region slider1
21 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 21 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_72_*.dump id type diameter mass xu yu zu fx fy fz

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 102 130 130
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 14.71 | 18.18 | 19.34 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   156.9          200            200            0              0              0              0              0              0              0              2.6109412e-16  0              6            
    100000   156.9          200            200            0.0027125094   8.9903966e-44  0              0.0081375283   12221.119      0              5.9011412e+10  2.6109412e-16  0              3.3324261    
    200000   156.9          200            200            0.00094519089  4.295279e-50   0              0.0028355727   2899.7455      0              1.4001833e+10  2.6109412e-16  0              3.0822354    
    300000   156.9          200            200            6.4081829e-05  3.835903e-41   0              0.00019224549  27.38171       0              1.3221648e+08  2.6109412e-16  0              3.0483276    
    400000   156.9          200            200            0.016152877   -0.0037299025   0              0.052188534    47.649033      0              2.3008013e+08  2.6109412e-16  0              2.9924032    
    500000   156.9          200            200            0.00073866209 -0.00017539551  0              0.0023913818   28.452067      0              1.3738485e+08  2.6109412e-16  0              2.9984306    
    600000   156.9          200            200            0.0013956066  -0.00047790302  0              0.0046647227   0.16593969     0              801263.36      2.6109412e-16  0              2.9979501    
    700000   156.9          200            200            0.0027999296  -0.00081927149  0              0.0092190602   0.65993537     0              3186591.7      2.6109412e-16  0              2.9971375    
    800000   156.9          200            200            0.0031322799  -0.00083584177  0              0.010232681    0.096393653    0              465450.45      2.6109412e-16  0              2.9969817    
    900000   156.9          200            200            0.0031373057  -0.00083594285  0              0.01024786     0.0061279003   0              29589.437      2.6109412e-16  0              2.9969806    
   1000000   156.9          200            200            0.0031003112  -0.00083420091  0              0.010135134    4.3138004e-05  0              208.29798      2.6109412e-16  0              2.9969983    
   1100000   156.9          200            200            0.0030772082  -0.00083310882  0              0.010064734    4.2115119e-05  0              203.35884      2.6109412e-16  0              2.9970093    
   1200000   156.9          200            200            0.0030679172  -0.0008326688   0              0.01003642     2.4107829e-05  0              116.40808      2.6109412e-16  0              2.9970136    
   1300000   156.9          200            200            0.0030652794  -0.0008325447   0              0.010028383    4.6943616e-06  0              22.667392      2.6109412e-16  0              2.9970149    
   1400000   156.9          200            200            0.0030649002  -0.00083252748  0              0.010027228    4.6134107e-07  0              2.2276509      2.6109412e-16  0              2.997015     
   1500000   156.9          200            200            0.003065022   -0.0008325336   0              0.0100276      1.6388129e-08  0              0.079132408    2.6109412e-16  0              2.997015     
   1600000   156.9          200            200            0.0030651488  -0.00083253973  0              0.010027986    1.5688796e-10  0              0.0007575558   2.6109412e-16  0              2.9970149    
   1700000   156.9          200            200            0.003065211   -0.0008325427   0              0.010028176    6.2950438e-10  0              0.0030396514   2.6109412e-16  0              2.9970149    
   1800000   156.9          200            200            0.0030652324  -0.00083254372  0              0.010028241    1.9220311e-10  0              0.00092808003  2.6109412e-16  0              2.9970149    
   1900000   156.9          200            200            0.0030652372  -0.00083254394  0              0.010028256    2.7061133e-11  0              0.00013066853  2.6109412e-16  0              2.9970149    
   2000000   156.9          200            200            0.0030652373  -0.00083254395  0              0.010028256    1.8220683e-12  0              8.7981157e-06  2.6109412e-16  0              2.9970149    
   2100000   156.9          200            200            0.0030652368  -0.00083254392  0              0.010028254    1.7739216e-14  0              8.5656326e-08  2.6109412e-16  0              2.9970149    
   2200000   156.9          200            200            0.0030652364  -0.0008325439   0              0.010028253    1.0015811e-14  0              4.8362768e-08  2.6109412e-16  0              2.9970149    
   2300000   156.9          200            200            0.0030652362  -0.00083254389  0              0.010028253    6.4199477e-15  0              3.099963e-08   2.6109412e-16  0              2.9970149    
   2400000   156.9          200            200            0.0030652362  -0.00083254389  0              0.010028252    1.305275e-15   0              6.302706e-09   2.6109412e-16  0              2.9970149    
   2500000   156.9          200            200            0.0030652362  -0.00083254389  0              0.010028252    1.3241837e-16  0              6.3940094e-10  2.6109412e-16  0              2.9970149    
   2600000   156.9          200            200            0.0030652362  -0.00083254389  0              0.010028252    4.4719435e-18  0              2.1593415e-11  2.6109412e-16  0              2.9970149    
   2700000   156.9          200            200            0.0030652362  -0.00083254389  0              0.010028252    4.1310761e-19  0              1.9947488e-12  2.6109412e-16  0              2.9970149    
   2800000   156.9          200            200            0.0030652362  -0.00083254389  0              0.010028252    2.3953861e-19  0              1.1566462e-12  2.6109412e-16  0              2.9970149    
   2900000   156.9          200            200            0.0030652362  -0.00083254389  0              0.010028252    1.1349208e-19  0              5.4801263e-13  2.6109412e-16  0              2.9970149    
   3000000   156.9          200            200            0.0030652362  -0.00083254389  0              0.010028252    6.562682e-20   0              3.1688843e-13  2.6109412e-16  0              2.9970149    
Loop time of 64.0216 on 4 procs for 3000000 steps with 51 atoms

Performance: 40486338.466 ns/day, 0.000 hours/ns, 46859.188 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 0.32773    | 1.6136     | 5.3158     | 168.3 |  2.52
Neigh   | 0.080577   | 0.08113    | 0.082685   |   0.3 |  0.13
Comm    | 25.738     | 32.118     | 37.848     |  82.3 | 50.17
Output  | 0.061017   | 0.061095   | 0.06115    |   0.0 |  0.10
Modify  | 15.368     | 21.051     | 28.155     | 119.4 | 32.88
Other   |            | 9.097      |            |       | 14.21

Nlocal:          12.75 ave          51 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1
Nghost:          39.25 ave          52 max           1 min
Histogram: 1 0 0 0 0 0 0 0 0 3
Neighs:           6.75 ave          27 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1

Total # of neighbors = 27
Ave neighs/atom = 0.52941176
Neighbor list builds = 166
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 73

#variable lat0 equal 1                    #
variable lat1 equal 3+(151*0.01)+(v_ind*0.01)  # .491+(v_ind*0.001)       # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 10*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 5.24                                                               
Lattice spacing in x,y,z = 5.24 5.24 5.24

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -78.6 ${n1e1} -100 100 -100 100 units box
region box block -78.6 78.6 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -78.6 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -78.6 78.6 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-78.6 -100 -100) to (78.6 100 100)
  1 by 2 by 2 MPI processor grid
create_atoms 1 region substrate
Created 29 atoms
  using lattice units in orthogonal box = (-78.6 -100 -100) to (78.6 100 100)
  create_atoms CPU = 0.000 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 30 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 21 atoms
  using lattice units in orthogonal box = (-78.6 -100 -100) to (78.6 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  29 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  29 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  21 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  21 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
29 atoms in group substrate
group slider1 region slider1
21 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 21 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_73_*.dump id type diameter mass xu yu zu fx fy fz

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 102 130 130
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 14.71 | 18.18 | 19.34 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   157.2          200            200            0              0              0              0              0              0              0              2.6109412e-16  0              6            
    100000   157.2          200            200            0.0027081136   1.1216549e-44  0              0.0081243409   12225.299      0              6.5590659e+10  2.6109412e-16  0              3.3326533    
    200000   157.2          200            200            0.00094332163 -3.5892957e-43  0              0.0028299649   2898.8111      0              1.5552579e+10  2.6109412e-16  0              3.0828951    
    300000   157.2          200            200            6.2316153e-05 -5.7428721e-42  0              0.00018694846  26.042379      0              1.3972147e+08  2.6109412e-16  0              3.048955     
    400000   157.2          200            200            0.01663844    -0.0007754708   0              0.050690791    60.844693      0              3.2644139e+08  2.6109412e-16  0              2.9930583    
    500000   157.2          200            200            0.00015011501 -4.3657334e-05  0              0.00049400236  19.516795      0              1.0471069e+08  2.6109412e-16  0              2.9994651    
    600000   157.2          200            200            0.0026704255  -0.00030267942  0              0.0083139559   5.2914569      0              28389502       2.6109412e-16  0              2.9978049    
    700000   157.2          200            200            0.0029152723  -0.00030487784  0              0.0090506948   0.63065382     0              3383557.3      2.6109412e-16  0              2.9976775    
    800000   157.2          200            200            0.0031618802  -0.00030623117  0              0.0097918717   0.098369329    0              527766.98      2.6109412e-16  0              2.9975588    
    900000   157.2          200            200            0.0032297522  -0.00030649016  0              0.0099957468   0.014366334    0              77077.651      2.6109412e-16  0              2.9975264    
   1000000   157.2          200            200            0.0032411833  -0.00030653074  0              0.010030081    0.0018952172   0              10168.139      2.6109412e-16  0              2.9975207    
   1100000   157.2          200            200            0.0032400409  -0.00030652816  0              0.010026651    0.00022486157  0              1206.4178      2.6109412e-16  0              2.9975211    
   1200000   157.2          200            200            0.0032376785  -0.00030652089  0              0.010019556    2.3643374e-05  0              126.85043      2.6109412e-16  0              2.9975221    
   1300000   157.2          200            200            0.003236141   -0.00030651601  0              0.010014939    2.1255735e-06  0              11.404037      2.6109412e-16  0              2.9975228    
   1400000   157.2          200            200            0.0032353584  -0.00030651349  0              0.010012589    1.502158e-07   0              0.80593151     2.6109412e-16  0              2.9975231    
   1500000   157.2          200            200            0.0032350052  -0.00030651235  0              0.010011528    6.5065652e-09  0              0.03490875     2.6109412e-16  0              2.9975233    
   1600000   157.2          200            200            0.0032348578  -0.00030651187  0              0.010011085    2.9169586e-11  0              0.00015649943  2.6109412e-16  0              2.9975234    
   1700000   157.2          200            200            0.0032348     -0.00030651168  0              0.010010912    4.9586861e-11  0              0.00026604134  2.6109412e-16  0              2.9975234    
   1800000   157.2          200            200            0.0032347784  -0.0003065116   0              0.010010847    3.3415986e-11  0              0.00017928204  2.6109412e-16  0              2.9975234    
   1900000   157.2          200            200            0.0032347708  -0.00030651158  0              0.010010824    1.0192124e-11  0              5.4682356e-05  2.6109412e-16  0              2.9975234    
   2000000   157.2          200            200            0.0032347682  -0.00030651157  0              0.010010816    2.2719263e-12  0              1.2189243e-05  2.6109412e-16  0              2.9975234    
   2100000   157.2          200            200            0.0032347674  -0.00030651157  0              0.010010814    4.2110897e-13  0              2.2593161e-06  2.6109412e-16  0              2.9975234    
   2200000   157.2          200            200            0.0032347672  -0.00030651157  0              0.010010813    6.8317475e-14  0              3.6653404e-07  2.6109412e-16  0              2.9975234    
   2300000   157.2          200            200            0.0032347671  -0.00030651157  0              0.010010813    9.9294319e-15  0              5.327297e-08   2.6109412e-16  0              2.9975234    
   2400000   157.2          200            200            0.0032347671  -0.00030651157  0              0.010010813    1.3020902e-15  0              6.9859197e-09  2.6109412e-16  0              2.9975234    
   2500000   157.2          200            200            0.0032347671  -0.00030651157  0              0.010010813    1.5376888e-16  0              8.2499431e-10  2.6109412e-16  0              2.9975234    
   2600000   157.2          200            200            0.0032347671  -0.00030651157  0              0.010010813    1.6641288e-17  0              8.9283136e-11  2.6109412e-16  0              2.9975234    
   2700000   157.2          200            200            0.0032347671  -0.00030651157  0              0.010010813    2.3523857e-18  0              1.2620921e-11  2.6109412e-16  0              2.9975234    
   2800000   157.2          200            200            0.0032347671  -0.00030651157  0              0.010010813    2.2402193e-19  0              1.201913e-12   2.6109412e-16  0              2.9975234    
   2900000   157.2          200            200            0.0032347671  -0.00030651157  0              0.010010813    9.4788658e-22  0              5.0855612e-15  2.6109412e-16  0              2.9975234    
   3000000   157.2          200            200            0.0032347671  -0.00030651157  0              0.010010813    2.0429317e-22  0              1.0960651e-15  2.6109412e-16  0              2.9975234    
Loop time of 62.7504 on 4 procs for 3000000 steps with 50 atoms

Performance: 41306521.370 ns/day, 0.000 hours/ns, 47808.474 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 0.31316    | 1.5779     | 5.2069     | 166.9 |  2.51
Neigh   | 0.080588   | 0.081161   | 0.082679   |   0.3 |  0.13
Comm    | 25.038     | 31.257     | 36.896     |  81.1 | 49.81
Output  | 0.060762   | 0.060837   | 0.060893   |   0.0 |  0.10
Modify  | 15.044     | 20.694     | 27.603     | 117.1 | 32.98
Other   |            | 9.079      |            |       | 14.47

Nlocal:           12.5 ave          50 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1
Nghost:           37.5 ave          50 max           0 min
Histogram: 1 0 0 0 0 0 0 0 0 3
Neighs:           6.75 ave          27 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1

Total # of neighbors = 27
Ave neighs/atom = 0.54
Neighbor list builds = 166
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 74

#variable lat0 equal 1                    #
variable lat1 equal 3+(151*0.01)+(v_ind*0.01)  # .491+(v_ind*0.001)       # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 10*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 5.25                                                               
Lattice spacing in x,y,z = 5.25 5.25 5.25

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -78.75 ${n1e1} -100 100 -100 100 units box
region box block -78.75 78.75 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -78.75 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -78.75 78.75 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-78.75 -100 -100) to (78.75 100 100)
  1 by 2 by 2 MPI processor grid
create_atoms 1 region substrate
Created 30 atoms
  using lattice units in orthogonal box = (-78.75 -100 -100) to (78.75 100 100)
  create_atoms CPU = 0.000 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 30 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 21 atoms
  using lattice units in orthogonal box = (-78.75 -100 -100) to (78.75 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  30 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  30 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  21 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  21 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
30 atoms in group substrate
group slider1 region slider1
21 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 21 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_74_*.dump id type diameter mass xu yu zu fx fy fz

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 102 130 130
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 14.71 | 18.18 | 19.34 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   157.5          200            200            0              0              0              0              0              0              0              2.6109412e-16  0              6            
    100000   157.5          200            200            0.0027032173  -1.5285097e-41  0              0.0081096518   12226.737      0              5.9038536e+10  2.6109412e-16  0              3.332717     
    200000   157.5          200            200            0.00094157226  1.2228164e-39  0              0.0028247168   2898.8443      0              1.3997482e+10  2.6109412e-16  0              3.0830907    
    300000   157.5          200            200            6.1729965e-05  7.8181284e-44  0              0.00018518989  25.665943      0              1.2393165e+08  2.6109412e-16  0              3.049162     
    400000   157.5          200            200            0.016590596   -1.5650886e-38  0              0.049771788    67.483706      0              3.2585466e+08  2.6109412e-16  0              2.9933115    
    500000   157.5          200            200            0.0001968779  -6.260895e-38   0              0.0005906337   20.524298      0              99104490       2.6109412e-16  0              2.9995944    
    600000   157.5          200            200            0.0028508502  -7.51006e-37    0              0.0085525506   5.4552922      0              26341653       2.6109412e-16  0              2.9979397    
    700000   157.5          200            200            0.0030772696   1.5658814e-37  0              0.0092318088   0.69136297     0              3338344.4      2.6109412e-16  0              2.9978225    
    800000   157.5          200            200            0.0032987838   3.9169644e-38  0              0.0098963513   0.10528024     0              508360.6       2.6109412e-16  0              2.9977161    
    900000   157.5          200            200            0.0033465338  -1.757113e-38   0              0.010039602    0.014142706    0              68290.066      2.6109412e-16  0              2.997693     
   1000000   157.5          200            200            0.0033463712  -9.3929867e-40  0              0.010039114    0.0016157542   0              7801.8986      2.6109412e-16  0              2.9976927    
   1100000   157.5          200            200            0.003339664   -5.2784621e-38  0              0.010018992    0.00015213459  0              734.60347      2.6109412e-16  0              2.9976956    
   1200000   157.5          200            200            0.0033349503   1.0803344e-38  0              0.010004851    1.0791713e-05  0              52.10932       2.6109412e-16  0              2.9976977    
   1300000   157.5          200            200            0.0033325261   1.0804843e-38  0              0.0099975782   4.285668e-07   0              2.0693957      2.6109412e-16  0              2.9976988    
   1400000   157.5          200            200            0.0033314495   2.3340062e-38  0              0.0099943486   3.4361025e-10  0              0.0016591709   2.6109412e-16  0              2.9976993    
   1500000   157.5          200            200            0.0033310161   2.0314951e-38  0              0.0099930484   5.6956298e-09  0              0.027502158    2.6109412e-16  0              2.9976995    
   1600000   157.5          200            200            0.0033308553   9.8765395e-39  0              0.0099925659   3.1232821e-09  0              0.015081211    2.6109412e-16  0              2.9976996    
   1700000   157.5          200            200            0.0033308002  -7.9025498e-39  0              0.0099924005   8.5939213e-10  0              0.004149697    2.6109412e-16  0              2.9976996    
   1800000   157.5          200            200            0.0033307829  -2.4081445e-38  0              0.0099923488   1.7350526e-10  0              0.00083779481  2.6109412e-16  0              2.9976996    
   1900000   157.5          200            200            0.0033307782   5.0499183e-39  0              0.0099923347   2.8618166e-11  0              0.00013818688  2.6109412e-16  0              2.9976996    
   2000000   157.5          200            200            0.0033307772  -4.1797861e-38  0              0.0099923316   4.0050546e-12  0              1.9338975e-05  2.6109412e-16  0              2.9976996    
   2100000   157.5          200            200            0.0033307771  -3.6519152e-38  0              0.0099923314   4.7828683e-13  0              2.3094759e-06  2.6109412e-16  0              2.9976996    
   2200000   157.5          200            200            0.0033307772   1.6770278e-38  0              0.0099923317   4.7647618e-14  0              2.3007329e-07  2.6109412e-16  0              2.9976996    
   2300000   157.5          200            200            0.0033307773  -1.2652065e-38  0              0.0099923319   3.6989123e-15  0              1.7860724e-08  2.6109412e-16  0              2.9976996    
   2400000   157.5          200            200            0.0033307773  -1.7530225e-38  0              0.009992332    1.8474403e-16  0              8.920628e-10   2.6109412e-16  0              2.9976996    
   2500000   157.5          200            200            0.0033307773   2.414834e-38   0              0.009992332    1.5615552e-18  0              7.5401913e-12  2.6109412e-16  0              2.9976996    
   2600000   157.5          200            200            0.0033307773  -1.0092458e-37  0              0.009992332    6.8900494e-19  0              3.3269582e-12  2.6109412e-16  0              2.9976996    
   2700000   157.5          200            200            0.0033307774  -1.4031472e-38  0              0.0099923321   1.5954129e-19  0              7.7036778e-13  2.6109412e-16  0              2.9976996    
   2800000   157.5          200            200            0.0033307774   4.2569361e-38  0              0.0099923321   3.1159912e-19  0              1.5046006e-12  2.6109412e-16  0              2.9976996    
   2900000   157.5          200            200            0.0033307774   9.2275914e-39  0              0.0099923321   1.5778639e-19  0              7.6189398e-13  2.6109412e-16  0              2.9976996    
   3000000   157.5          200            200            0.0033307774   8.3534463e-38  0              0.0099923321   1.2862953e-19  0              6.2110599e-13  2.6109412e-16  0              2.9976996    
Loop time of 63.8887 on 4 procs for 3000000 steps with 51 atoms

Performance: 40570549.598 ns/day, 0.000 hours/ns, 46956.655 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 0.33362    | 1.6046     | 5.2976     | 168.4 |  2.51
Neigh   | 0.080706   | 0.081212   | 0.082699   |   0.3 |  0.13
Comm    | 25.748     | 32.048     | 37.804     |  81.7 | 50.16
Output  | 0.06264    | 0.062716   | 0.062773   |   0.0 |  0.10
Modify  | 15.223     | 20.933     | 27.98      | 118.8 | 32.76
Other   |            | 9.16       |            |       | 14.34

Nlocal:          12.75 ave          51 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1
Nghost:          39.25 ave          52 max           1 min
Histogram: 1 0 0 0 0 0 0 0 0 3
Neighs:           7.25 ave          29 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1

Total # of neighbors = 29
Ave neighs/atom = 0.56862745
Neighbor list builds = 166
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 75

#variable lat0 equal 1                    #
variable lat1 equal 3+(151*0.01)+(v_ind*0.01)  # .491+(v_ind*0.001)       # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 10*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 5.26                                                               
Lattice spacing in x,y,z = 5.26 5.26 5.26

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -78.9 ${n1e1} -100 100 -100 100 units box
region box block -78.9 78.9 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -78.9 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -78.9 78.9 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-78.9 -100 -100) to (78.9 100 100)
  1 by 2 by 2 MPI processor grid
create_atoms 1 region substrate
Created 30 atoms
  using lattice units in orthogonal box = (-78.9 -100 -100) to (78.9 100 100)
  create_atoms CPU = 0.000 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 30 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 21 atoms
  using lattice units in orthogonal box = (-78.9 -100 -100) to (78.9 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  30 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  30 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  21 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  21 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
30 atoms in group substrate
group slider1 region slider1
21 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 21 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_75_*.dump id type diameter mass xu yu zu fx fy fz

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 102 130 130
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 14.71 | 18.18 | 19.34 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   157.8          200            200            0              0              0              0              0              0              0              2.6109412e-16  0              6            
    100000   157.8          200            200            0.0026978166   1.1173901e-44  0              0.0080934498   12225.299      0              5.9031593e+10  2.6109412e-16  0              3.3326533    
    200000   157.8          200            200            0.00093973486 -3.5756482e-43  0              0.0028192046   2898.8111      0              1.3997321e+10  2.6109412e-16  0              3.0828951    
    300000   157.8          200            200            6.207921e-05  -5.7210361e-42  0              0.00018623763  26.042379      0              1.2574933e+08  2.6109412e-16  0              3.048955     
    400000   157.8          200            200            0.017091174    0.00077547224  0              0.050498051    60.844693      0              2.9379725e+08  2.6109412e-16  0              2.9930583    
    500000   157.8          200            200            0.00017859341  4.3656202e-05  0              0.00049212403  19.516795      0              94239618       2.6109412e-16  0              2.9994651    
    600000   157.8          200            200            0.0028616745   0.00030267947  0              0.0082823439   5.2914569      0              25550551       2.6109412e-16  0              2.9978049    
    700000   157.8          200            200            0.0031070531   0.00030487785  0              0.0090162816   0.63065382     0              3045201.6      2.6109412e-16  0              2.9976775    
    800000   157.8          200            200            0.0033536238   0.00030623118  0              0.0097546403   0.098369329    0              474990.28      2.6109412e-16  0              2.9975588    
    900000   157.8          200            200            0.0034214101   0.00030649016  0              0.0099577401   0.014366334    0              69369.886      2.6109412e-16  0              2.9975264    
   1000000   157.8          200            200            0.0034328247   0.00030653074  0              0.0099919435   0.0018952172   0              9151.3255      2.6109412e-16  0              2.9975207    
   1100000   157.8          200            200            0.0034316849   0.00030652816  0              0.0099885266   0.00022486157  0              1085.7761      2.6109412e-16  0              2.9975211    
   1200000   157.8          200            200            0.0034293267   0.00030652089  0              0.0099814593   2.3643374e-05  0              114.16539      2.6109412e-16  0              2.9975221    
   1300000   157.8          200            200            0.0034277918   0.00030651601  0              0.0099768594   2.1255735e-06  0              10.263634      2.6109412e-16  0              2.9975228    
   1400000   157.8          200            200            0.0034270105   0.00030651349  0              0.0099745179   1.502158e-07   0              0.72533836     2.6109412e-16  0              2.9975231    
   1500000   157.8          200            200            0.0034266579   0.00030651235  0              0.0099734613   6.5065652e-09  0              0.031417875    2.6109412e-16  0              2.9975233    
   1600000   157.8          200            200            0.0034265108   0.00030651187  0              0.0099730204   2.9169586e-11  0              0.00014084949  2.6109412e-16  0              2.9975234    
   1700000   157.8          200            200            0.003426453    0.00030651168  0              0.0099728473   4.9586861e-11  0              0.00023943721  2.6109412e-16  0              2.9975234    
   1800000   157.8          200            200            0.0034264314   0.0003065116   0              0.0099727827   3.3415986e-11  0              0.00016135384  2.6109412e-16  0              2.9975234    
   1900000   157.8          200            200            0.0034264238   0.00030651158  0              0.0099727599   1.0192124e-11  0              4.9214121e-05  2.6109412e-16  0              2.9975234    
   2000000   157.8          200            200            0.0034264213   0.00030651157  0              0.0099727522   2.2719263e-12  0              1.0970319e-05  2.6109412e-16  0              2.9975234    
   2100000   157.8          200            200            0.0034264205   0.00030651157  0              0.0099727498   4.2110897e-13  0              2.0333845e-06  2.6109412e-16  0              2.9975234    
   2200000   157.8          200            200            0.0034264202   0.00030651157  0              0.0099727492   6.8317475e-14  0              3.2988064e-07  2.6109412e-16  0              2.9975234    
   2300000   157.8          200            200            0.0034264202   0.00030651157  0              0.009972749    9.9294319e-15  0              4.7945673e-08  2.6109412e-16  0              2.9975234    
   2400000   157.8          200            200            0.0034264202   0.00030651157  0              0.009972749    1.3020902e-15  0              6.2873278e-09  2.6109412e-16  0              2.9975234    
   2500000   157.8          200            200            0.0034264202   0.00030651157  0              0.009972749    1.5376888e-16  0              7.4249489e-10  2.6109412e-16  0              2.9975234    
   2600000   157.8          200            200            0.0034264202   0.00030651157  0              0.009972749    1.6641288e-17  0              8.0354822e-11  2.6109412e-16  0              2.9975234    
   2700000   157.8          200            200            0.0034264202   0.00030651157  0              0.009972749    2.3523856e-18  0              1.1358828e-11  2.6109412e-16  0              2.9975234    
   2800000   157.8          200            200            0.0034264202   0.00030651157  0              0.009972749    2.2402196e-19  0              1.0817219e-12  2.6109412e-16  0              2.9975234    
   2900000   157.8          200            200            0.0034264202   0.00030651157  0              0.009972749    9.4788616e-22  0              4.577003e-15   2.6109412e-16  0              2.9975234    
   3000000   157.8          200            200            0.0034264202   0.00030651157  0              0.009972749    4.5572942e-22  0              2.2005543e-15  2.6109412e-16  0              2.9975234    
Loop time of 63.8877 on 4 procs for 3000000 steps with 51 atoms

Performance: 40571171.321 ns/day, 0.000 hours/ns, 46957.374 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 0.32455    | 1.5848     | 5.2389     | 167.6 |  2.48
Neigh   | 0.080631   | 0.0814     | 0.083241   |   0.4 |  0.13
Comm    | 25.782     | 32.067     | 37.795     |  81.6 | 50.19
Output  | 0.06011    | 0.060189   | 0.060242   |   0.0 |  0.09
Modify  | 15.264     | 20.971     | 28.025     | 119.5 | 32.82
Other   |            | 9.124      |            |       | 14.28

Nlocal:          12.75 ave          51 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1
Nghost:          39.25 ave          52 max           1 min
Histogram: 1 0 0 0 0 0 0 0 0 3
Neighs:           7.25 ave          29 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1

Total # of neighbors = 29
Ave neighs/atom = 0.56862745
Neighbor list builds = 166
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 76

#variable lat0 equal 1                    #
variable lat1 equal 3+(151*0.01)+(v_ind*0.01)  # .491+(v_ind*0.001)       # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 10*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 5.27                                                               
Lattice spacing in x,y,z = 5.27 5.27 5.27

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -79.05 ${n1e1} -100 100 -100 100 units box
region box block -79.05 79.05 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -79.05 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -79.05 79.05 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-79.05 -100 -100) to (79.05 100 100)
  1 by 2 by 2 MPI processor grid
create_atoms 1 region substrate
Created 30 atoms
  using lattice units in orthogonal box = (-79.05 -100 -100) to (79.05 100 100)
  create_atoms CPU = 0.000 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 30 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 21 atoms
  using lattice units in orthogonal box = (-79.05 -100 -100) to (79.05 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  30 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  30 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  21 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  21 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
30 atoms in group substrate
group slider1 region slider1
21 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 21 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_76_*.dump id type diameter mass xu yu zu fx fy fz

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 102 130 130
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 14.77 | 18.24 | 19.39 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   158.1          200            200            0              0              0              0              0              0              0              2.6109412e-16  0              6            
    100000   158.1          200            200            0.0026919211   8.9221583e-44  0              0.0080757633   12221.119      0              5.9011412e+10  2.6109412e-16  0              3.3324261    
    200000   158.1          200            200            0.00093801677  4.2626773e-50  0              0.0028140503   2899.7455      0              1.4001833e+10  2.6109412e-16  0              3.0822354    
    300000   158.1          200            200            6.359544e-05   3.8067911e-42  0              0.00019078632  27.38171       0              1.3221648e+08  2.6109412e-16  0              3.0483276    
    400000   158.1          200            200            0.018507444    0.003729915    0              0.051792416    47.649033      0              2.3008013e+08  2.6109412e-16  0              2.9924032    
    500000   158.1          200            200            0.00084954017  0.00017538964  0              0.0023732309   28.452067      0              1.3738485e+08  2.6109412e-16  0              2.9984306    
    600000   158.1          200            200            0.0017024064   0.00047790239  0              0.0046293169   0.16593969     0              801263.36      2.6109412e-16  0              2.9979501    
    700000   158.1          200            200            0.0033227859   0.00081927129  0              0.0091490863   0.65993537     0              3186591.7      2.6109412e-16  0              2.9971375    
    800000   158.1          200            200            0.0036636185   0.00083584171  0              0.010155014    0.096393653    0              465450.45      2.6109412e-16  0              2.9969817    
    900000   158.1          200            200            0.0036686734   0.00083594283  0              0.010170077    0.0061279003   0              29589.437      2.6109412e-16  0              2.9969806    
   1000000   158.1          200            200            0.0036308028   0.00083420091  0              0.010058207    4.3138004e-05  0              208.29798      2.6109412e-16  0              2.9969983    
   1100000   158.1          200            200            0.0036071499   0.00083310882  0              0.0099883409   4.2115119e-05  0              203.35884      2.6109412e-16  0              2.9970093    
   1200000   158.1          200            200            0.0035976371   0.0008326688   0              0.0099602426   2.4107829e-05  0              116.40808      2.6109412e-16  0              2.9970136    
   1300000   158.1          200            200            0.003594937    0.0008325447   0              0.0099522662   4.6943615e-06  0              22.667392      2.6109412e-16  0              2.9970149    
   1400000   158.1          200            200            0.0035945492   0.00083252748  0              0.0099511202   4.6134105e-07  0              2.2276508      2.6109412e-16  0              2.997015     
   1500000   158.1          200            200            0.0035946741   0.0008325336   0              0.0099514888   1.6388129e-08  0              0.07913241     2.6109412e-16  0              2.997015     
   1600000   158.1          200            200            0.0035948041   0.00083253973  0              0.0099518724   1.5688784e-10  0              0.00075755524  2.6109412e-16  0              2.9970149    
   1700000   158.1          200            200            0.0035948677   0.0008325427   0              0.0099520605   6.2950506e-10  0              0.0030396547   2.6109412e-16  0              2.9970149    
   1800000   158.1          200            200            0.0035948896   0.00083254372  0              0.0099521252   1.9220332e-10  0              0.00092808105  2.6109412e-16  0              2.9970149    
   1900000   158.1          200            200            0.0035948946   0.00083254394  0              0.0099521399   2.7061168e-11  0              0.00013066869  2.6109412e-16  0              2.9970149    
   2000000   158.1          200            200            0.0035948947   0.00083254395  0              0.0099521402   1.8221057e-12  0              8.7982962e-06  2.6109412e-16  0              2.9970149    
   2100000   158.1          200            200            0.0035948941   0.00083254392  0              0.0099521384   1.7740258e-14  0              8.5661358e-08  2.6109412e-16  0              2.9970149    
   2200000   158.1          200            200            0.0035948937   0.0008325439   0              0.0099521373   1.0008603e-14  0              4.8327962e-08  2.6109412e-16  0              2.9970149    
   2300000   158.1          200            200            0.0035948936   0.00083254389  0              0.0099521368   6.4224285e-15  0              3.1011609e-08  2.6109412e-16  0              2.9970149    
   2400000   158.1          200            200            0.0035948935   0.00083254389  0              0.0099521367   1.3043824e-15  0              6.2983959e-09  2.6109412e-16  0              2.9970149    
   2500000   158.1          200            200            0.0035948935   0.00083254389  0              0.0099521367   1.327488e-16   0              6.4099643e-10  2.6109412e-16  0              2.9970149    
   2600000   158.1          200            200            0.0035948935   0.00083254389  0              0.0099521367   4.3804916e-18  0              2.1151826e-11  2.6109412e-16  0              2.9970149    
   2700000   158.1          200            200            0.0035948935   0.00083254389  0              0.0099521367   4.151401e-19   0              2.004563e-12   2.6109412e-16  0              2.9970149    
   2800000   158.1          200            200            0.0035948935   0.00083254389  0              0.0099521367   2.329934e-19   0              1.1250417e-12  2.6109412e-16  0              2.9970149    
   2900000   158.1          200            200            0.0035948935   0.00083254389  0              0.0099521367   9.7081277e-20  0              4.6877074e-13  2.6109412e-16  0              2.9970149    
   3000000   158.1          200            200            0.0035948935   0.00083254389  0              0.0099521367   6.7364319e-20  0              3.2527819e-13  2.6109412e-16  0              2.9970149    
Loop time of 63.896 on 4 procs for 3000000 steps with 51 atoms

Performance: 40565908.527 ns/day, 0.000 hours/ns, 46951.283 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 0.32891    | 1.6181     | 5.3409     | 169.0 |  2.53
Neigh   | 0.082963   | 0.083775   | 0.085343   |   0.3 |  0.13
Comm    | 25.715     | 32.077     | 37.832     |  82.2 | 50.20
Output  | 0.059158   | 0.059238   | 0.059293   |   0.0 |  0.09
Modify  | 15.197     | 20.935     | 28.044     | 119.5 | 32.76
Other   |            | 9.123      |            |       | 14.28

Nlocal:          12.75 ave          51 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1
Nghost:          39.25 ave          52 max           1 min
Histogram: 1 0 0 0 0 0 0 0 0 3
Neighs:           6.75 ave          27 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1

Total # of neighbors = 27
Ave neighs/atom = 0.52941176
Neighbor list builds = 166
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 77

#variable lat0 equal 1                    #
variable lat1 equal 3+(151*0.01)+(v_ind*0.01)  # .491+(v_ind*0.001)       # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 10*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 5.28                                                               
Lattice spacing in x,y,z = 5.28 5.28 5.28

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -79.2 ${n1e1} -100 100 -100 100 units box
region box block -79.2 79.2 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -79.2 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -79.2 79.2 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-79.2 -100 -100) to (79.2 100 100)
  1 by 2 by 2 MPI processor grid
create_atoms 1 region substrate
Created 30 atoms
  using lattice units in orthogonal box = (-79.2 -100 -100) to (79.2 100 100)
  create_atoms CPU = 0.000 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 30 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 21 atoms
  using lattice units in orthogonal box = (-79.2 -100 -100) to (79.2 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  30 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  30 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  21 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  21 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
30 atoms in group substrate
group slider1 region slider1
21 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 21 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_77_*.dump id type diameter mass xu yu zu fx fy fz

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 103 130 130
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 14.73 | 18.2 | 19.35 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   158.4          200            200            0              0              0              0              0              0              0              2.6109412e-16  0              6            
    100000   158.4          200            200            0.0026854847  -2.8496831e-42  0              0.0080564541   12213.531      0              5.8974769e+10  2.6109412e-16  0              3.3321773    
    200000   158.4          200            200            0.00093540865  6.0793303e-41  0              0.0028062259   2896.5764      0              1.3986531e+10  2.6109412e-16  0              3.0814873    
    300000   158.4          200            200            6.3287055e-05 -6.322424e-39   0              0.00018986117  27.240964      0              1.3153687e+08  2.6109412e-16  0              3.0474689    
    400000   158.4          200            200            0.016873983    0.0051387111   0              0.045483239    87.890995      0              4.2439416e+08  2.6109412e-16  0              2.9921282    
    500000   158.4          200            200            0.009948415    0.0027672617   0              0.027077983    0.2791305      0              1347821.3      2.6109412e-16  0              2.9939774    
    600000   158.4          200            200            0.0037408728   0.0011118333   0              0.010110785    5.4361858      0              26249396       2.6109412e-16  0              2.9961954    
    700000   158.4          200            200            0.0029175518   0.00070679898  0              0.0080458565   0.066718238    0              322158.5       2.6109412e-16  0              2.9965608    
    800000   158.4          200            200            0.0035983023   0.00080396756  0              0.0099909392   0.096826089    0              467538.53      2.6109412e-16  0              2.9962297    
    900000   158.4          200            200            0.0036571602   0.00080832333  0              0.010163157    0.0037430451   0              18073.825      2.6109412e-16  0              2.9961995    
   1000000   158.4          200            200            0.0035478284   0.00080062392  0              0.0098428613   0.00044640442  0              2155.5272      2.6109412e-16  0              2.9962523    
   1100000   158.4          200            200            0.00357743     0.00080273587  0              0.0099295542   0.00024086425  0              1163.0473      2.6109412e-16  0              2.9962382    
   1200000   158.4          200            200            0.0035820276   0.00080307964  0              0.009943003    6.1658173e-06  0              29.772525      2.6109412e-16  0              2.9962359    
   1300000   158.4          200            200            0.0035764376   0.00080267916  0              0.0099266337   1.5495011e-06  0              7.4819865      2.6109412e-16  0              2.9962386    
   1400000   158.4          200            200            0.003577742    0.0008027708   0              0.009930455    5.8490567e-07  0              2.8243001      2.6109412e-16  0              2.9962379    
   1500000   158.4          200            200            0.003578049    0.0008027935   0              0.0099313535   9.0281471e-09  0              0.043593691    2.6109412e-16  0              2.9962378    
   1600000   158.4          200            200            0.0035777667   0.00080277329  0              0.0099305269   5.0065584e-09  0              0.024174879    2.6109412e-16  0              2.9962379    
   1700000   158.4          200            200            0.0035778224   0.00080277718  0              0.0099306901   1.3862649e-09  0              0.0066937769   2.6109412e-16  0              2.9962379    
   1800000   158.4          200            200            0.0035778414   0.00080277858  0              0.0099307457   1.0573595e-11  0              5.1056105e-05  2.6109412e-16  0              2.9962379    
   1900000   158.4          200            200            0.0035778273   0.00080277757  0              0.0099307044   1.5350716e-11  0              7.4123112e-05  2.6109412e-16  0              2.9962379    
   2000000   158.4          200            200            0.0035778296   0.00080277773  0              0.0099307111   3.2032099e-12  0              1.5467154e-05  2.6109412e-16  0              2.9962379    
   2100000   158.4          200            200            0.0035778307   0.00080277781  0              0.0099307144   7.4687582e-15  0              3.606396e-08   2.6109412e-16  0              2.9962379    
   2200000   158.4          200            200            0.00357783     0.00080277776  0              0.0099307124   4.5110751e-14  0              2.1782367e-07  2.6109412e-16  0              2.9962379    
   2300000   158.4          200            200            0.0035778301   0.00080277776  0              0.0099307126   7.1984674e-15  0              3.4758823e-08  2.6109412e-16  0              2.9962379    
   2400000   158.4          200            200            0.0035778302   0.00080277777  0              0.0099307128   1.6432533e-19  0              7.9346819e-13  2.6109412e-16  0              2.9962379    
   2500000   158.4          200            200            0.0035778302   0.00080277777  0              0.0099307127   1.2774852e-16  0              6.168519e-10   2.6109412e-16  0              2.9962379    
   2600000   158.4          200            200            0.0035778302   0.00080277777  0              0.0099307127   1.557025e-17   0              7.5183164e-11  2.6109412e-16  0              2.9962379    
   2700000   158.4          200            200            0.0035778302   0.00080277777  0              0.0099307127   4.4839461e-19  0              2.1651371e-12  2.6109412e-16  0              2.9962379    
   2800000   158.4          200            200            0.0035778302   0.00080277777  0              0.0099307127   2.2886099e-19  0              1.1050878e-12  2.6109412e-16  0              2.9962379    
   2900000   158.4          200            200            0.0035778302   0.00080277777  0              0.0099307127   6.7327473e-20  0              3.2510027e-13  2.6109412e-16  0              2.9962379    
   3000000   158.4          200            200            0.0035778302   0.00080277777  0              0.0099307127   2.2150665e-20  0              1.0695763e-13  2.6109412e-16  0              2.9962379    
Loop time of 64.2099 on 4 procs for 3000000 steps with 51 atoms

Performance: 40367625.797 ns/day, 0.000 hours/ns, 46721.789 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 0.32385    | 1.6325     | 5.3912     | 169.9 |  2.54
Neigh   | 0.081312   | 0.08205    | 0.083405   |   0.3 |  0.13
Comm    | 25.844     | 32.201     | 37.922     |  81.9 | 50.15
Output  | 0.059476   | 0.059553   | 0.05961    |   0.0 |  0.09
Modify  | 15.413     | 21.096     | 28.19      | 118.8 | 32.86
Other   |            | 9.138      |            |       | 14.23

Nlocal:          12.75 ave          51 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1
Nghost:          39.25 ave          52 max           1 min
Histogram: 1 0 0 0 0 0 0 0 0 3
Neighs:           6.75 ave          27 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1

Total # of neighbors = 27
Ave neighs/atom = 0.52941176
Neighbor list builds = 166
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 78

#variable lat0 equal 1                    #
variable lat1 equal 3+(151*0.01)+(v_ind*0.01)  # .491+(v_ind*0.001)       # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 10*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 5.29                                                               
Lattice spacing in x,y,z = 5.29 5.29 5.29

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -79.35 ${n1e1} -100 100 -100 100 units box
region box block -79.35 79.35 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -79.35 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -79.35 79.35 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-79.35 -100 -100) to (79.35 100 100)
  1 by 2 by 2 MPI processor grid
create_atoms 1 region substrate
Created 30 atoms
  using lattice units in orthogonal box = (-79.35 -100 -100) to (79.35 100 100)
  create_atoms CPU = 0.000 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 30 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 21 atoms
  using lattice units in orthogonal box = (-79.35 -100 -100) to (79.35 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  30 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  30 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  21 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  21 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
30 atoms in group substrate
group slider1 region slider1
21 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 21 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_78_*.dump id type diameter mass xu yu zu fx fy fz

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 103 130 130
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 14.73 | 18.2 | 19.35 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   158.7          200            200            0              0              0              0              0              0              0              2.6109412e-16  0              6            
    100000   158.7          200            200            0.0026784961  -5.3093514e-41  0              0.0080354884   12202.3        0              5.8920542e+10  2.6109412e-16  0              3.3319631    
    200000   158.7          200            200            0.00093141706 -9.7078744e-40  0              0.0027942512   2886.7823      0              1.3939239e+10  2.6109412e-16  0              3.0808518    
    300000   158.7          200            200            5.879153e-05  -3.101149e-38   0              0.00017637459  23.756822      0              1.1471319e+08  2.6109412e-16  0              3.0465482    
    400000   158.7          200            200            0.0056028737   0.00087406486  0              0.015934556    212.76166      0              1.0273499e+09  2.6109412e-16  0              2.9944101    
    500000   158.7          200            200            0.0038820611   0.00045590022  0              0.011190283    33.610212      0              1.6229168e+08  2.6109412e-16  0              2.9950693    
    600000   158.7          200            200            0.0025073934   1.580004e-35   0              0.0075221801   2.8076157      0              13556971       2.6109412e-16  0              2.9960392    
    700000   158.7          200            200            0.0036616955   0.00022915049  0              0.010755936    0.50721899     0              2449179        2.6109412e-16  0              2.9951909    
    800000   158.7          200            200            0.0031706806   0.00010331963  0              0.0094087222   0.028161768    0              135983.1       2.6109412e-16  0              2.9954645    
    900000   158.7          200            200            0.0032833401   0.00015306851  0              0.0096969519   0.0014308005   0              6908.8238      2.6109412e-16  0              2.9954       
   1000000   158.7          200            200            0.0033472969   0.00015794635  0              0.0098839442   0.0014221715   0              6867.1573      2.6109412e-16  0              2.9953604    
   1100000   158.7          200            200            0.0033618169   0.00015889688  0              0.0099265537   0.000140873    0              680.22528      2.6109412e-16  0              2.9953517    
   1200000   158.7          200            200            0.0033596995   0.00015874918  0              0.0099203493   7.8306517e-08  0              0.37811414     2.6109412e-16  0              2.9953531    
   1300000   158.7          200            200            0.0033567824   0.00015855498  0              0.0099117922   2.1841978e-06  0              10.54671       2.6109412e-16  0              2.9953549    
   1400000   158.7          200            200            0.0033557448   0.00015848654  0              0.009908748    5.0328171e-07  0              2.4301673      2.6109412e-16  0              2.9953555    
   1500000   158.7          200            200            0.0033556679   0.00015848187  0              0.0099085219   1.4992486e-08  0              0.072393351    2.6109412e-16  0              2.9953556    
   1600000   158.7          200            200            0.0033557733   0.00015848903  0              0.009908831    1.6282747e-09  0              0.007862356    2.6109412e-16  0              2.9953555    
   1700000   158.7          200            200            0.0033558317   0.00015849291  0              0.0099090021   1.2185825e-09  0              0.0058840985   2.6109412e-16  0              2.9953555    
   1800000   158.7          200            200            0.0033558439   0.00015849371  0              0.009909038    1.0824861e-10  0              0.00052269377  2.6109412e-16  0              2.9953554    
   1900000   158.7          200            200            0.0033558416   0.00015849354  0              0.0099090312   2.1875889e-17  0              1.0563084e-10  2.6109412e-16  0              2.9953554    
   2000000   158.7          200            200            0.0033558389   0.00015849336  0              0.0099090232   1.9760545e-12  0              9.54166e-06    2.6109412e-16  0              2.9953554    
   2100000   158.7          200            200            0.0033558379   0.0001584933   0              0.0099090205   4.0884787e-13  0              1.97418e-06    2.6109412e-16  0              2.9953554    
   2200000   158.7          200            200            0.0033558379   0.0001584933   0              0.0099090204   1.0073902e-14  0              4.8643267e-08  2.6109412e-16  0              2.9953554    
   2300000   158.7          200            200            0.003355838    0.00015849331  0              0.0099090207   1.6690846e-15  0              8.059412e-09   2.6109412e-16  0              2.9953554    
   2400000   158.7          200            200            0.0033558381   0.00015849331  0              0.0099090208   1.0339616e-15  0              4.9926308e-09  2.6109412e-16  0              2.9953554    
   2500000   158.7          200            200            0.0033558381   0.00015849331  0              0.0099090209   8.3608296e-17  0              4.0371454e-10  2.6109412e-16  0              2.9953554    
   2600000   158.7          200            200            0.0033558381   0.00015849331  0              0.0099090209   2.2344921e-21  0              1.0789562e-14  2.6109412e-16  0              2.9953554    
   2700000   158.7          200            200            0.0033558381   0.00015849331  0              0.0099090209   2.235134e-18   0              1.0792662e-11  2.6109412e-16  0              2.9953554    
   2800000   158.7          200            200            0.0033558381   0.00015849331  0              0.0099090209   1.4397757e-19  0              6.9521614e-13  2.6109412e-16  0              2.9953554    
   2900000   158.7          200            200            0.0033558381   0.00015849331  0              0.0099090209   9.0292207e-20  0              4.3598875e-13  2.6109412e-16  0              2.9953554    
   3000000   158.7          200            200            0.0033558381   0.00015849331  0              0.0099090209   2.0990107e-20  0              1.0135371e-13  2.6109412e-16  0              2.9953554    
Loop time of 63.9078 on 4 procs for 3000000 steps with 51 atoms

Performance: 40558461.213 ns/day, 0.000 hours/ns, 46942.663 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 0.34244    | 1.616      | 5.3067     | 167.7 |  2.53
Neigh   | 0.080359   | 0.08094    | 0.082435   |   0.3 |  0.13
Comm    | 25.676     | 32.07      | 37.846     |  82.4 | 50.18
Output  | 0.060608   | 0.060689   | 0.060744   |   0.0 |  0.09
Modify  | 15.204     | 20.935     | 28.037     | 119.3 | 32.76
Other   |            | 9.145      |            |       | 14.31

Nlocal:          12.75 ave          51 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1
Nghost:          39.25 ave          52 max           1 min
Histogram: 1 0 0 0 0 0 0 0 0 3
Neighs:           6.75 ave          27 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1

Total # of neighbors = 27
Ave neighs/atom = 0.52941176
Neighbor list builds = 164
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 79

#variable lat0 equal 1                    #
variable lat1 equal 3+(151*0.01)+(v_ind*0.01)  # .491+(v_ind*0.001)       # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 10*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 5.3                                                               
Lattice spacing in x,y,z = 5.3 5.3 5.3

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -79.5 ${n1e1} -100 100 -100 100 units box
region box block -79.5 79.5 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -79.5 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -79.5 79.5 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-79.5 -100 -100) to (79.5 100 100)
  1 by 2 by 2 MPI processor grid
create_atoms 1 region substrate
Created 30 atoms
  using lattice units in orthogonal box = (-79.5 -100 -100) to (79.5 100 100)
  create_atoms CPU = 0.000 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 30 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 21 atoms
  using lattice units in orthogonal box = (-79.5 -100 -100) to (79.5 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  30 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  30 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  21 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  21 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
30 atoms in group substrate
group slider1 region slider1
21 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 21 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_79_*.dump id type diameter mass xu yu zu fx fy fz

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 103 130 130
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 14.73 | 18.2 | 19.35 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   159            200            200            0              0              0              0              0              0              0              2.6109412e-16  0              6            
    100000   159            200            200            0.0026723112   3.8769897e-39  0              0.0080169337   12197.666      0              5.8898163e+10  2.6109412e-16  0              3.3310537    
    200000   159            200            200            0.00092679955  1.7443164e-38  0              0.0027803987   2874.0286      0              1.3877656e+10  2.6109412e-16  0              3.0801802    
    300000   159            200            200            4.809882e-05  -9.2660384e-38  0              0.00014429646  16.215898      0              78300767       2.6109412e-16  0              3.0457057    
    400000   159            200            200            0.00013820085  9.1897045e-39  0              0.00041460255  121.8229       0              5.8823921e+08  2.6109412e-16  0              3.0011776    
    500000   159            200            200            0.006129902    0.00017281636  0              0.01821689     10.952393      0              52885188       2.6109412e-16  0              2.9929511    
    600000   159            200            200            0.0037868826   2.930526e-36   0              0.011360648    3.3065793      0              15966288       2.6109412e-16  0              2.9947705    
    700000   159            200            200            0.0033892371   5.9801983e-37  0              0.010167711    0.51720158     0              2497381.3      2.6109412e-16  0              2.9951336    
    800000   159            200            200            0.0033085849   5.5200548e-38  0              0.0099257546   0.072914199    0              352076.57      2.6109412e-16  0              2.9952064    
    900000   159            200            200            0.003293164   -1.1496923e-38  0              0.0098794921   0.0098624527   0              47622.254      2.6109412e-16  0              2.9952195    
   1000000   159            200            200            0.0032924726  -2.3096529e-38  0              0.0098774178   0.0012828843   0              6194.589       2.6109412e-16  0              2.9952194    
   1100000   159            200            200            0.0032940618  -1.4740762e-38  0              0.0098821853   0.00016014586  0              773.28704      2.6109412e-16  0              2.9952176    
   1200000   159            200            200            0.0032953169  -5.0250675e-40  0              0.0098859508   1.9114745e-05  0              92.298263      2.6109412e-16  0              2.9952163    
   1300000   159            200            200            0.0032960169  -1.3486115e-39  0              0.0098880508   2.1681947e-06  0              10.469436      2.6109412e-16  0              2.9952156    
   1400000   159            200            200            0.0032963571   3.9952408e-39  0              0.0098890713   2.3140695e-07  0              1.1173814      2.6109412e-16  0              2.9952153    
   1500000   159            200            200            0.0032965102   1.5960754e-39  0              0.0098895306   2.285515e-08   0              0.11035934     2.6109412e-16  0              2.9952151    
   1600000   159            200            200            0.0032965757   5.5868288e-39  0              0.0098897271   2.028261e-09   0              0.0097937467   2.6109412e-16  0              2.9952151    
   1700000   159            200            200            0.0032966027   3.3307752e-39  0              0.0098898081   1.5253596e-10  0              0.00073654154  2.6109412e-16  0              2.995215     
   1800000   159            200            200            0.0032966135  -1.7773323e-39  0              0.0098898406   8.4270268e-12  0              4.0691096e-05  2.6109412e-16  0              2.995215     
   1900000   159            200            200            0.0032966177   1.4062924e-39  0              0.0098898532   1.9666616e-13  0              9.4963048e-07  2.6109412e-16  0              2.995215     
   2000000   159            200            200            0.0032966194  -8.4348779e-39  0              0.0098898581   4.869055e-15   0              2.3510924e-08  2.6109412e-16  0              2.995215     
   2100000   159            200            200            0.00329662    -3.6796843e-39  0              0.0098898599   1.2293223e-14  0              5.9359575e-08  2.6109412e-16  0              2.995215     
   2200000   159            200            200            0.0032966202   1.1404856e-39  0              0.0098898605   5.0847873e-15  0              2.4552618e-08  2.6109412e-16  0              2.995215     
   2300000   159            200            200            0.0032966203  -1.2372059e-39  0              0.0098898608   1.3600531e-15  0              6.5672098e-09  2.6109412e-16  0              2.995215     
   2400000   159            200            200            0.0032966203  -2.571035e-39   0              0.0098898608   2.9845889e-16  0              1.4411512e-09  2.6109412e-16  0              2.995215     
   2500000   159            200            200            0.0032966203   1.5051255e-39  0              0.0098898609   5.8018479e-17  0              2.8015047e-10  2.6109412e-16  0              2.995215     
   2600000   159            200            200            0.0032966203   7.6056157e-39  0              0.0098898609   1.0355322e-17  0              5.0002145e-11  2.6109412e-16  0              2.995215     
   2700000   159            200            200            0.0032966203   5.0775698e-39  0              0.0098898609   1.5364716e-18  0              7.4190715e-12  2.6109412e-16  0              2.995215     
   2800000   159            200            200            0.0032966203  -2.1960896e-39  0              0.0098898609   2.7347895e-19  0              1.320532e-12   2.6109412e-16  0              2.995215     
   2900000   159            200            200            0.0032966203   5.172405e-39   0              0.0098898609   3.8714843e-20  0              1.8694012e-13  2.6109412e-16  0              2.995215     
   3000000   159            200            200            0.0032966203   5.8724727e-39  0              0.0098898609   2.0441845e-20  0              9.8706354e-14  2.6109412e-16  0              2.995215     
Loop time of 64.208 on 4 procs for 3000000 steps with 51 atoms

Performance: 40368815.427 ns/day, 0.000 hours/ns, 46723.166 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 0.33355    | 1.5312     | 4.9787     | 160.9 |  2.38
Neigh   | 0.080417   | 0.080939   | 0.082409   |   0.3 |  0.13
Comm    | 25.757     | 32.3       | 38.003     |  83.9 | 50.31
Output  | 0.061279   | 0.061355   | 0.061407   |   0.0 |  0.10
Modify  | 15.362     | 21.112     | 28.304     | 120.3 | 32.88
Other   |            | 9.123      |            |       | 14.21

Nlocal:          12.75 ave          51 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1
Nghost:          39.25 ave          52 max           1 min
Histogram: 1 0 0 0 0 0 0 0 0 3
Neighs:           6.75 ave          27 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1

Total # of neighbors = 27
Ave neighs/atom = 0.52941176
Neighbor list builds = 164
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 80

#variable lat0 equal 1                    #
variable lat1 equal 3+(151*0.01)+(v_ind*0.01)  # .491+(v_ind*0.001)       # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 10*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 5.31                                                               
Lattice spacing in x,y,z = 5.31 5.31 5.31

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -79.65 ${n1e1} -100 100 -100 100 units box
region box block -79.65 79.65 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -79.65 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -79.65 79.65 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-79.65 -100 -100) to (79.65 100 100)
  1 by 2 by 2 MPI processor grid
create_atoms 1 region substrate
Created 30 atoms
  using lattice units in orthogonal box = (-79.65 -100 -100) to (79.65 100 100)
  create_atoms CPU = 0.000 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 30 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 21 atoms
  using lattice units in orthogonal box = (-79.65 -100 -100) to (79.65 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  30 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  30 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  21 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  21 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
30 atoms in group substrate
group slider1 region slider1
21 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 21 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_80_*.dump id type diameter mass xu yu zu fx fy fz

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 103 130 130
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 14.73 | 18.2 | 19.35 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   159.3          200            200            0              0              0              0              0              0              0              2.6109412e-16  0              6            
    100000   159.3          200            200            0.0026683554  -1.8134832e-40  0              0.0080050662   12209.764      0              5.8956578e+10  2.6109412e-16  0              3.3289507    
    200000   159.3          200            200            0.00092290512  1.5498792e-38  0              0.0027687154   2864.8883      0              1.3833521e+10  2.6109412e-16  0              3.0791968    
    300000   159.3          200            200            2.8989864e-05  2.5032618e-37  0              8.6969593e-05  6.0916686      0              29414488       2.6109412e-16  0              3.045007     
    400000   159.3          200            200            9.2967625e-06  3.7571453e-38  0              2.7890288e-05  0.66816303     0              3226320.1      2.6109412e-16  0              3.0064345    
    500000   159.3          200            200            0.0064446643   2.9399334e-36  0              0.019333993    2.9787017      0              14383085       2.6109412e-16  0              2.99249      
    600000   159.3          200            200            0.0042447617   3.0739423e-36  0              0.012734285    1.3856349      0              6690735        2.6109412e-16  0              2.9943405    
    700000   159.3          200            200            0.0035713397   6.6323326e-37  0              0.010714019    0.3089086      0              1491609.1      2.6109412e-16  0              2.9949521    
    800000   159.3          200            200            0.0033751063   1.6768956e-37  0              0.010125319    0.052160029    0              251862.11      2.6109412e-16  0              2.9951357    
    900000   159.3          200            200            0.0033146137   7.237131e-38   0              0.0099438411   0.0082238076   0              39709.824      2.6109412e-16  0              2.9951925    
   1000000   159.3          200            200            0.0032966012  -9.3438278e-38  0              0.0098898035   0.001236729    0              5971.7219      2.6109412e-16  0              2.9952094    
   1100000   159.3          200            200            0.0032916446  -2.8197201e-39  0              0.0098749337   0.00017825707  0              860.73959      2.6109412e-16  0              2.995214     
   1200000   159.3          200            200            0.0032904719  -4.8826684e-39  0              0.0098714157   2.46809e-05    0              119.17523      2.6109412e-16  0              2.995215     
   1300000   159.3          200            200            0.0032902887  -5.008649e-39   0              0.0098708662   3.2850765e-06  0              15.862459      2.6109412e-16  0              2.9952152    
   1400000   159.3          200            200            0.0032903141   4.0085581e-39  0              0.0098709422   4.2003841e-07  0              2.0282152      2.6109412e-16  0              2.9952151    
   1500000   159.3          200            200            0.0032903573   2.3708402e-40  0              0.009871072    5.1470319e-08  0              0.24853175     2.6109412e-16  0              2.9952151    
   1600000   159.3          200            200            0.0032903854   8.4339299e-39  0              0.0098711562   6.0172405e-09  0              0.029055101    2.6109412e-16  0              2.995215     
   1700000   159.3          200            200            0.0032904      6.0978945e-39  0              0.0098712      6.6611184e-10  0              0.0032164157   2.6109412e-16  0              2.995215     
   1800000   159.3          200            200            0.0032904069  -3.7417452e-39  0              0.0098712206   6.8967714e-11  0              0.00033302041  2.6109412e-16  0              2.995215     
   1900000   159.3          200            200            0.0032904099  -7.5855299e-39  0              0.0098712296   6.5400485e-12  0              3.1579554e-05  2.6109412e-16  0              2.995215     
   2000000   159.3          200            200            0.0032904111   2.3360581e-39  0              0.0098712334   5.4641928e-13  0              2.6384632e-06  2.6109412e-16  0              2.995215     
   2100000   159.3          200            200            0.0032904116  -4.9199542e-39  0              0.0098712349   3.7046226e-14  0              1.7888297e-07  2.6109412e-16  0              2.995215     
   2200000   159.3          200            200            0.0032904118   1.5156484e-38  0              0.0098712355   1.615608e-15   0              7.8011929e-09  2.6109412e-16  0              2.995215     
   2300000   159.3          200            200            0.0032904119  -2.850623e-40   0              0.0098712358   1.0838956e-17  0              5.2337442e-11  2.6109412e-16  0              2.995215     
   2400000   159.3          200            200            0.003290412   -9.3048953e-40  0              0.0098712359   8.4884913e-18  0              4.0987886e-11  2.6109412e-16  0              2.995215     
   2500000   159.3          200            200            0.003290412    3.5693875e-39  0              0.0098712359   6.3220512e-18  0              3.0526923e-11  2.6109412e-16  0              2.995215     
   2600000   159.3          200            200            0.003290412   -1.7573218e-39  0              0.0098712359   2.4187962e-18  0              1.1679501e-11  2.6109412e-16  0              2.995215     
   2700000   159.3          200            200            0.003290412   -2.3718561e-39  0              0.0098712359   5.5989269e-19  0              2.7035214e-12  2.6109412e-16  0              2.995215     
   2800000   159.3          200            200            0.003290412    3.1997391e-39  0              0.0098712359   1.6883198e-19  0              8.1522923e-13  2.6109412e-16  0              2.995215     
   2900000   159.3          200            200            0.003290412   -4.894197e-40   0              0.0098712359   1.4575709e-21  0              7.0380884e-15  2.6109412e-16  0              2.995215     
   3000000   159.3          200            200            0.003290412    9.8037396e-39  0              0.0098712359   1.5148764e-19  0              7.3147961e-13  2.6109412e-16  0              2.995215     
Loop time of 64.0195 on 4 procs for 3000000 steps with 51 atoms

Performance: 40487668.635 ns/day, 0.000 hours/ns, 46860.728 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 0.31867    | 1.5379     | 5.0254     | 162.5 |  2.40
Neigh   | 0.080368   | 0.08094    | 0.082472   |   0.3 |  0.13
Comm    | 25.717     | 32.205     | 37.909     |  83.1 | 50.30
Output  | 0.06113    | 0.061206   | 0.061262   |   0.0 |  0.10
Modify  | 15.231     | 20.992     | 28.112     | 119.5 | 32.79
Other   |            | 9.143      |            |       | 14.28

Nlocal:          12.75 ave          51 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1
Nghost:          39.25 ave          52 max           1 min
Histogram: 1 0 0 0 0 0 0 0 0 3
Neighs:           6.75 ave          27 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1

Total # of neighbors = 27
Ave neighs/atom = 0.52941176
Neighbor list builds = 164
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 81

#variable lat0 equal 1                    #
variable lat1 equal 3+(151*0.01)+(v_ind*0.01)  # .491+(v_ind*0.001)       # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 10*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 5.32                                                               
Lattice spacing in x,y,z = 5.32 5.32 5.32

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -79.8 ${n1e1} -100 100 -100 100 units box
region box block -79.8 79.8 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -79.8 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -79.8 79.8 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-79.8 -100 -100) to (79.8 100 100)
  1 by 2 by 2 MPI processor grid
create_atoms 1 region substrate
Created 29 atoms
  using lattice units in orthogonal box = (-79.8 -100 -100) to (79.8 100 100)
  create_atoms CPU = 0.000 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 30 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 21 atoms
  using lattice units in orthogonal box = (-79.8 -100 -100) to (79.8 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  29 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  29 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  21 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  21 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
29 atoms in group substrate
group slider1 region slider1
21 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 21 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_81_*.dump id type diameter mass xu yu zu fx fy fz

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 103 130 130
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 14.73 | 18.2 | 19.35 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   159.6          200            200            0              0              0              0              0              0              0              2.6109412e-16  0              6            
    100000   159.6          200            200            0.002664953   -1.4479967e-39  0              0.0079948591   12224.736      0              6.5587641e+10  2.6109412e-16  0              3.3270305    
    200000   159.6          200            200            0.00092399124  6.2163079e-38  0              0.0027719737   2880.3113      0              1.5453325e+10  2.6109412e-16  0              3.0769164    
    300000   159.6          200            200            9.227968e-07   1.5150467e-36  0              2.7683904e-06  0.0074053385   0              39730.81       2.6109412e-16  0              3.0443043    
    400000   159.6          200            200           -0.00010261862  2.5389188e-36  0             -0.00030785585  99.368233      0              5.3312626e+08  2.6109412e-16  0              3.0015297    
    500000   159.6          200            200            0.0035425752  -1.8225624e-35  0              0.010627726    29.382918      0              1.5764399e+08  2.6109412e-16  0              2.9950282    
    600000   159.6          200            200            0.0025409746   8.7227616e-37  0              0.0076229239   2.1646635      0              11613762       2.6109412e-16  0              2.9959859    
    700000   159.6          200            200            0.0029467763  -4.3324082e-36  0              0.0088403288   0.17708738     0              950101.78      2.6109412e-16  0              2.9955538    
    800000   159.6          200            200            0.0031474871   4.5664712e-37  0              0.0094424612   0.014466418    0              77614.616      2.6109412e-16  0              2.9953502    
    900000   159.6          200            200            0.0032306992  -8.2745245e-37  0              0.0096920976   0.00097768773  0              5245.4491      2.6109412e-16  0              2.9952675    
   1000000   159.6          200            200            0.0032637693   7.0599279e-38  0              0.0097913079   4.2431044e-05  0              227.64925      2.6109412e-16  0              2.995235     
   1100000   159.6          200            200            0.0032765716   6.8926668e-38  0              0.0098297149   2.6251683e-07  0              1.4084442      2.6109412e-16  0              2.9952225    
   1200000   159.6          200            200            0.0032814192  -1.3682291e-38  0              0.0098442576   2.5860274e-07  0              1.3874445      2.6109412e-16  0              2.9952177    
   1300000   159.6          200            200            0.0032832176   3.9596152e-38  0              0.0098496527   1.9344636e-07  0              1.0378703      2.6109412e-16  0              2.995216     
   1400000   159.6          200            200            0.0032838716   1.8031024e-38  0              0.0098516148   6.3300709e-08  0              0.3396183      2.6109412e-16  0              2.9952154    
   1500000   159.6          200            200            0.0032841047  -2.8217771e-39  0              0.0098523141   1.5318587e-08  0              0.082186636    2.6109412e-16  0              2.9952151    
   1600000   159.6          200            200            0.003284186    2.0909944e-38  0              0.009852558    3.1492132e-09  0              0.016896026    2.6109412e-16  0              2.9952151    
   1700000   159.6          200            200            0.0032842137  -3.4790324e-39  0              0.009852641    5.8240021e-10  0              0.0031246691   2.6109412e-16  0              2.995215     
   1800000   159.6          200            200            0.0032842228   1.5477513e-38  0              0.0098526685   9.9735046e-11  0              0.00053509427  2.6109412e-16  0              2.995215     
   1900000   159.6          200            200            0.0032842258   1.3625926e-38  0              0.0098526773   1.6076078e-11  0              8.6250696e-05  2.6109412e-16  0              2.995215     
   2000000   159.6          200            200            0.0032842267  -1.3011301e-39  0              0.00985268     2.4634745e-12  0              1.321693e-05   2.6109412e-16  0              2.995215     
   2100000   159.6          200            200            0.0032842269   1.8992453e-38  0              0.0098526807   3.6088357e-13  0              1.9361974e-06  2.6109412e-16  0              2.995215     
   2200000   159.6          200            200            0.003284227   -1.0411789e-38  0              0.0098526809   5.0735265e-14  0              2.7220271e-07  2.6109412e-16  0              2.995215     
   2300000   159.6          200            200            0.003284227   -6.4561088e-39  0              0.009852681    6.8569592e-15  0              3.6788669e-08  2.6109412e-16  0              2.995215     
   2400000   159.6          200            200            0.003284227   -1.1576986e-38  0              0.009852681    8.9111228e-16  0              4.7809581e-09  2.6109412e-16  0              2.995215     
   2500000   159.6          200            200            0.003284227    3.2291675e-39  0              0.009852681    1.1009938e-16  0              5.9070054e-10  2.6109412e-16  0              2.995215     
   2600000   159.6          200            200            0.003284227    5.1853327e-39  0              0.009852681    1.2657221e-17  0              6.790799e-11   2.6109412e-16  0              2.995215     
   2700000   159.6          200            200            0.003284227   -1.1451717e-38  0              0.009852681    1.4856644e-18  0              7.9708239e-12  2.6109412e-16  0              2.995215     
   2800000   159.6          200            200            0.003284227   -4.1525707e-39  0              0.009852681    7.5828918e-20  0              4.0683412e-13  2.6109412e-16  0              2.995215     
   2900000   159.6          200            200            0.003284227   -1.9198818e-38  0              0.009852681    1.3426777e-19  0              7.203678e-13   2.6109412e-16  0              2.995215     
   3000000   159.6          200            200            0.003284227    3.3238399e-39  0              0.009852681    2.1933604e-21  0              1.1767725e-14  2.6109412e-16  0              2.995215     
Loop time of 62.8696 on 4 procs for 3000000 steps with 50 atoms

Performance: 41228171.325 ns/day, 0.000 hours/ns, 47717.791 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 0.32978    | 1.5179     | 4.9377     | 160.3 |  2.41
Neigh   | 0.080357   | 0.080952   | 0.082474   |   0.3 |  0.13
Comm    | 25.063     | 31.304     | 36.918     |  81.7 | 49.79
Output  | 0.060501   | 0.060579   | 0.060634   |   0.0 |  0.10
Modify  | 15.052     | 20.72      | 27.603     | 116.5 | 32.96
Other   |            | 9.186      |            |       | 14.61

Nlocal:           12.5 ave          50 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1
Nghost:           37.5 ave          50 max           0 min
Histogram: 1 0 0 0 0 0 0 0 0 3
Neighs:           6.75 ave          27 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1

Total # of neighbors = 27
Ave neighs/atom = 0.54
Neighbor list builds = 164
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 82

#variable lat0 equal 1                    #
variable lat1 equal 3+(151*0.01)+(v_ind*0.01)  # .491+(v_ind*0.001)       # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 10*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 5.33                                                               
Lattice spacing in x,y,z = 5.33 5.33 5.33

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -79.95 ${n1e1} -100 100 -100 100 units box
region box block -79.95 79.95 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -79.95 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -79.95 79.95 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-79.95 -100 -100) to (79.95 100 100)
  1 by 2 by 2 MPI processor grid
create_atoms 1 region substrate
Created 30 atoms
  using lattice units in orthogonal box = (-79.95 -100 -100) to (79.95 100 100)
  create_atoms CPU = 0.000 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 30 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 21 atoms
  using lattice units in orthogonal box = (-79.95 -100 -100) to (79.95 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  30 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  30 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  21 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  21 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
30 atoms in group substrate
group slider1 region slider1
21 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 21 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_82_*.dump id type diameter mass xu yu zu fx fy fz

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 104 130 130
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 14.75 | 18.22 | 19.37 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   159.9          200            200            0              0              0              0              0              0              0              2.6109412e-16  0              6            
    100000   159.9          200            200            0.0026612293   5.7818964e-39  0              0.0079836879   12235.332      0              5.9080038e+10  2.6109412e-16  0              3.3260019    
    200000   159.9          200            200            0.00092969356  1.8610547e-37  0              0.0027890807   2918.1769      0              1.4090832e+10  2.6109412e-16  0              3.0740327    
    300000   159.9          200            200           -2.5332894e-05 -2.4299181e-36  0             -7.5998681e-05  5.060956       0              24437545       2.6109412e-16  0              3.0434962    
    400000   159.9          200            200            0.0014466901   3.7234086e-35  0              0.0043400704   183.12537      0              8.8424688e+08  2.6109412e-16  0              2.9970591    
    500000   159.9          200            200            0.0020269478   6.0559892e-36  0              0.0060808433   23.863614      0              1.1522885e+08  2.6109412e-16  0              2.9965942    
    600000   159.9          200            200            0.0022425483   7.4895293e-36  0              0.006727645    0.37322721     0              1802180.6      2.6109412e-16  0              2.9962935    
    700000   159.9          200            200            0.002867829    8.5038698e-36  0              0.0086034871   0.0036645326   0              17694.717      2.6109412e-16  0              2.9956241    
    800000   159.9          200            200            0.0031253554  -2.0043816e-37  0              0.0093760663   0.00036225114  0              1749.1811      2.6109412e-16  0              2.9953647    
    900000   159.9          200            200            0.0032227478  -1.6952391e-36  0              0.0096682434   0.00044351195  0              2141.5605      2.6109412e-16  0              2.9952688    
   1000000   159.9          200            200            0.0032584787   4.6062397e-38  0              0.0097754361   0.00016165504  0              780.57436      2.6109412e-16  0              2.995234     
   1100000   159.9          200            200            0.0032712883  -4.2439394e-37  0              0.0098138649   4.1072053e-05  0              198.32224      2.6109412e-16  0              2.9952215    
   1200000   159.9          200            200            0.0032757795   3.8169181e-38  0              0.0098273386   8.6891361e-06  0              41.956729      2.6109412e-16  0              2.9952172    
   1300000   159.9          200            200            0.0032773173   2.2491242e-38  0              0.0098319518   1.6386206e-06  0              7.9123123      2.6109412e-16  0              2.9952157    
   1400000   159.9          200            200            0.0032778297   3.2253275e-39  0              0.009833489    2.8476023e-07  0              1.3750053      2.6109412e-16  0              2.9952152    
   1500000   159.9          200            200            0.0032779948   5.9940218e-39  0              0.0098339845   4.6448799e-08  0              0.22428463     2.6109412e-16  0              2.9952151    
   1600000   159.9          200            200            0.0032780458  -5.2470435e-39  0              0.0098341374   7.1898166e-09  0              0.034717051    2.6109412e-16  0              2.995215     
   1700000   159.9          200            200            0.0032780606  -7.5995422e-39  0              0.0098341818   1.0631748e-09  0              0.0051336906   2.6109412e-16  0              2.995215     
   1800000   159.9          200            200            0.0032780645   3.8817847e-39  0              0.0098341934   1.5077679e-10  0              0.00072804717  2.6109412e-16  0              2.995215     
   1900000   159.9          200            200            0.0032780653   1.0038686e-38  0              0.0098341959   2.054796e-11   0              9.9218743e-05  2.6109412e-16  0              2.995215     
   2000000   159.9          200            200            0.0032780654   8.9368252e-39  0              0.0098341961   2.6915912e-12  0              1.2996731e-05  2.6109412e-16  0              2.995215     
   2100000   159.9          200            200            0.0032780653   2.5431507e-39  0              0.009834196    3.3840877e-13  0              1.6340549e-06  2.6109412e-16  0              2.995215     
   2200000   159.9          200            200            0.0032780653  -1.3997435e-39  0              0.0098341958   4.0706674e-14  0              1.9655796e-07  2.6109412e-16  0              2.995215     
   2300000   159.9          200            200            0.0032780652   6.7822876e-39  0              0.0098341957   4.6574293e-15  0              2.2489059e-08  2.6109412e-16  0              2.995215     
   2400000   159.9          200            200            0.0032780652  -1.3338757e-38  0              0.0098341957   5.0291999e-16  0              2.4284207e-09  2.6109412e-16  0              2.995215     
   2500000   159.9          200            200            0.0032780652  -5.0184578e-41  0              0.0098341956   4.948457e-17   0              2.3894328e-10  2.6109412e-16  0              2.995215     
   2600000   159.9          200            200            0.0032780652  -1.1118042e-38  0              0.0098341956   4.0235271e-18  0              1.9428173e-11  2.6109412e-16  0              2.995215     
   2700000   159.9          200            200            0.0032780652  -6.0211618e-39  0              0.0098341956   3.7542502e-19  0              1.812793e-12   2.6109412e-16  0              2.995215     
   2800000   159.9          200            200            0.0032780652  -2.0485284e-39  0              0.0098341956   3.0854217e-21  0              1.4898397e-14  2.6109412e-16  0              2.995215     
   2900000   159.9          200            200            0.0032780652   8.5907918e-40  0              0.0098341956   3.7607142e-20  0              1.8159143e-13  2.6109412e-16  0              2.995215     
   3000000   159.9          200            200            0.0032780652   2.0109532e-38  0              0.0098341956   6.6936997e-20  0              3.232148e-13   2.6109412e-16  0              2.995215     
Loop time of 64.0947 on 4 procs for 3000000 steps with 51 atoms

Performance: 40440170.106 ns/day, 0.000 hours/ns, 46805.752 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 0.33307    | 1.5729     | 5.1502     | 164.7 |  2.45
Neigh   | 0.081032   | 0.081607   | 0.083159   |   0.3 |  0.13
Comm    | 25.72      | 32.203     | 37.974     |  83.6 | 50.24
Output  | 0.060918   | 0.060998   | 0.061052   |   0.0 |  0.10
Modify  | 15.32      | 21.053     | 28.201     | 120.1 | 32.85
Other   |            | 9.123      |            |       | 14.23

Nlocal:          12.75 ave          51 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1
Nghost:          39.25 ave          52 max           1 min
Histogram: 1 0 0 0 0 0 0 0 0 3
Neighs:           6.75 ave          27 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1

Total # of neighbors = 27
Ave neighs/atom = 0.52941176
Neighbor list builds = 164
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 83

#variable lat0 equal 1                    #
variable lat1 equal 3+(151*0.01)+(v_ind*0.01)  # .491+(v_ind*0.001)       # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 10*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 5.34                                                               
Lattice spacing in x,y,z = 5.34 5.34 5.34

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -80.1 ${n1e1} -100 100 -100 100 units box
region box block -80.1 80.1 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -80.1 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -80.1 80.1 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-80.1 -100 -100) to (80.1 100 100)
  1 by 2 by 2 MPI processor grid
create_atoms 1 region substrate
Created 30 atoms
  using lattice units in orthogonal box = (-80.1 -100 -100) to (80.1 100 100)
  create_atoms CPU = 0.000 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 30 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 21 atoms
  using lattice units in orthogonal box = (-80.1 -100 -100) to (80.1 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  30 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  30 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  21 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  21 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
30 atoms in group substrate
group slider1 region slider1
21 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 21 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_83_*.dump id type diameter mass xu yu zu fx fy fz

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 104 130 130
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 14.75 | 18.22 | 19.37 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   160.2          200            200            0              0              0              0              0              0              0              2.6109412e-16  0              6            
    100000   160.2          200            200            0.0026568524   3.8476508e-39  0              0.0079705573   12238.883      0              5.9097185e+10  2.6109412e-16  0              3.3260896    
    200000   160.2          200            200            0.00092925952 -1.2277167e-37  0              0.0027877786   2924.3119      0              1.4120456e+10  2.6109412e-16  0              3.074095     
    300000   160.2          200            200           -9.587606e-06   3.479781e-36   0             -2.8762818e-05  0.70261785     0              3392690.1      2.6109412e-16  0              3.043947     
    400000   160.2          200            200            0.00017959252 -2.8619662e-35  0              0.00053877757  151.99343      0              7.3392189e+08  2.6109412e-16  0              2.9990217    
    500000   160.2          200            200            0.0025900567   1.7593026e-35  0              0.0077701701   27.85318       0              1.3449304e+08  2.6109412e-16  0              2.995972     
    600000   160.2          200            200            0.0023296553  -7.7562456e-37  0              0.0069889659   0.99468185     0              4802962.7      2.6109412e-16  0              2.9961978    
    700000   160.2          200            200            0.0028799965   5.8557648e-37  0              0.0086399895   0.0469778      0              226838.98      2.6109412e-16  0              2.9956081    
    800000   160.2          200            200            0.0031211793  -2.510858e-37   0              0.0093635378   0.0015987643   0              7719.8608      2.6109412e-16  0              2.9953637    
    900000   160.2          200            200            0.0032155972  -2.1957618e-37  0              0.0096467916   3.9669753e-07  0              1.9155104      2.6109412e-16  0              2.9952702    
   1000000   160.2          200            200            0.0032513367  -2.3417418e-38  0              0.00975401     2.4188825e-05  0              116.79918      2.6109412e-16  0              2.9952351    
   1100000   160.2          200            200            0.0032645557   4.6434436e-37  0              0.0097936672   1.3445434e-05  0              64.923187      2.6109412e-16  0              2.9952222    
   1200000   160.2          200            200            0.0032693441  -1.501033e-39   0              0.0098080322   4.0222549e-06  0              19.42203       2.6109412e-16  0              2.9952175    
   1300000   160.2          200            200            0.0032710428  -5.2224661e-38  0              0.0098131283   9.3084204e-07  0              4.4947031      2.6109412e-16  0              2.9952159    
   1400000   160.2          200            200            0.0032716322   7.0436524e-39  0              0.0098148965   1.8614799e-07  0              0.89884204     2.6109412e-16  0              2.9952153    
   1500000   160.2          200            200            0.0032718317  -1.1888367e-38  0              0.0098154951   3.3763151e-08  0              0.16303017     2.6109412e-16  0              2.9952151    
   1600000   160.2          200            200            0.0032718973   3.8442582e-39  0              0.0098156918   5.6963484e-09  0              0.027505628    2.6109412e-16  0              2.995215     
   1700000   160.2          200            200            0.003271918    2.4063657e-39  0              0.0098157541   9.0705528e-10  0              0.0043798453   2.6109412e-16  0              2.995215     
   1800000   160.2          200            200            0.0032719243   9.4788785e-39  0              0.0098157729   1.3752208e-10  0              0.00066404492  2.6109412e-16  0              2.995215     
   1900000   160.2          200            200            0.003271926    9.2682171e-39  0              0.0098157781   1.9957928e-11  0              9.636969e-05   2.6109412e-16  0              2.995215     
   2000000   160.2          200            200            0.0032719265  -3.9964033e-39  0              0.0098157794   2.7808245e-12  0              1.3427606e-05  2.6109412e-16  0              2.995215     
   2100000   160.2          200            200            0.0032719265   6.2634018e-39  0              0.0098157796   3.7233721e-13  0              1.7978831e-06  2.6109412e-16  0              2.995215     
   2200000   160.2          200            200            0.0032719265   1.6089356e-39  0              0.0098157796   4.7910791e-14  0              2.3134406e-07  2.6109412e-16  0              2.995215     
   2300000   160.2          200            200            0.0032719265   1.092715e-38   0              0.0098157796   5.910363e-15   0              2.8539028e-08  2.6109412e-16  0              2.995215     
   2400000   160.2          200            200            0.0032719265   9.2501326e-39  0              0.0098157796   6.96478e-16    0              3.363043e-09   2.6109412e-16  0              2.995215     
   2500000   160.2          200            200            0.0032719265   2.3884929e-39  0              0.0098157795   7.6283976e-17  0              3.6834802e-10  2.6109412e-16  0              2.995215     
   2600000   160.2          200            200            0.0032719265  -1.9202911e-39  0              0.0098157795   7.4200936e-18  0              3.5828976e-11  2.6109412e-16  0              2.995215     
   2700000   160.2          200            200            0.0032719265   1.1758383e-38  0              0.0098157795   7.7994825e-19  0              3.766091e-12   2.6109412e-16  0              2.995215     
   2800000   160.2          200            200            0.0032719265  -7.6666261e-40  0              0.0098157795   2.3836662e-20  0              1.1509871e-13  2.6109412e-16  0              2.995215     
   2900000   160.2          200            200            0.0032719265  -2.8949221e-39  0              0.0098157795   1.4523289e-19  0              7.0127766e-13  2.6109412e-16  0              2.995215     
   3000000   160.2          200            200            0.0032719265   9.2781966e-39  0              0.0098157795   3.1919484e-21  0              1.5412776e-14  2.6109412e-16  0              2.995215     
Loop time of 64.018 on 4 procs for 3000000 steps with 51 atoms

Performance: 40488594.709 ns/day, 0.000 hours/ns, 46861.799 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 0.32316    | 1.5471     | 5.0763     | 163.9 |  2.42
Neigh   | 0.081082   | 0.081666   | 0.083213   |   0.3 |  0.13
Comm    | 25.686     | 32.138     | 37.861     |  83.0 | 50.20
Output  | 0.061245   | 0.061326   | 0.061384   |   0.0 |  0.10
Modify  | 15.326     | 21.039     | 28.135     | 119.6 | 32.86
Other   |            | 9.151      |            |       | 14.29

Nlocal:          12.75 ave          51 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1
Nghost:          39.25 ave          52 max           1 min
Histogram: 1 0 0 0 0 0 0 0 0 3
Neighs:           6.75 ave          27 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1

Total # of neighbors = 27
Ave neighs/atom = 0.52941176
Neighbor list builds = 164
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 84

#variable lat0 equal 1                    #
variable lat1 equal 3+(151*0.01)+(v_ind*0.01)  # .491+(v_ind*0.001)       # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 10*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 5.35                                                               
Lattice spacing in x,y,z = 5.35 5.35 5.35

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -80.25 ${n1e1} -100 100 -100 100 units box
region box block -80.25 80.25 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -80.25 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -80.25 80.25 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-80.25 -100 -100) to (80.25 100 100)
  1 by 2 by 2 MPI processor grid
create_atoms 1 region substrate
Created 30 atoms
  using lattice units in orthogonal box = (-80.25 -100 -100) to (80.25 100 100)
  create_atoms CPU = 0.000 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 30 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 21 atoms
  using lattice units in orthogonal box = (-80.25 -100 -100) to (80.25 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  30 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  30 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  21 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  21 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
30 atoms in group substrate
group slider1 region slider1
21 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 21 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_84_*.dump id type diameter mass xu yu zu fx fy fz

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 104 130 130
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 14.75 | 18.22 | 19.37 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   160.5          200            200            0              0              0              0              0              0              0              2.6109412e-16  0              6            
    100000   160.5          200            200            0.0026518099  -4.7997441e-40  0              0.0079554296   12235.513      0              5.9080913e+10  2.6109412e-16  0              3.3272064    
    200000   160.5          200            200            0.00092337473 -7.6764302e-39  0              0.0027701242   2902.0599      0              1.4013009e+10  2.6109412e-16  0              3.076772     
    300000   160.5          200            200            2.6349428e-05 -4.8879914e-37  0              7.9048285e-05  5.1300119      0              24770992       2.6109412e-16  0              3.0447925    
    400000   160.5          200            200           -2.2372841e-05 -2.908289e-36   0             -6.7118524e-05  4.0581098      0              19595160       2.6109412e-16  0              3.0061661    
    500000   160.5          200            200            0.00644292     7.3316156e-36  0              0.01932876     2.5228283      0              12181835       2.6109412e-16  0              2.9924828    
    600000   160.5          200            200            0.0036890805   1.4251945e-36  0              0.011067241    3.4943972      0              16873193       2.6109412e-16  0              2.9948297    
    700000   160.5          200            200            0.0033334513   8.3719135e-37  0              0.010000354    0.53128815     0              2565400.3      2.6109412e-16  0              2.9951571    
    800000   160.5          200            200            0.0032686373   7.1025295e-37  0              0.0098059119   0.073606213    0              355418.06      2.6109412e-16  0              2.9952152    
    900000   160.5          200            200            0.0032590605   3.4928383e-37  0              0.0097771816   0.0097932003   0              47287.859      2.6109412e-16  0              2.9952227    
   1000000   160.5          200            200            0.0032604983   8.941352e-40   0              0.009781495    0.0012523603   0              6047.1996      2.6109412e-16  0              2.9952206    
   1100000   160.5          200            200            0.0032628494   4.2612897e-38  0              0.0097885483   0.0001534963   0              741.17868      2.6109412e-16  0              2.995218     
   1200000   160.5          200            200            0.0032643716  -1.2081279e-39  0              0.0097931148   1.7948311e-05  0              86.665972      2.6109412e-16  0              2.9952165    
   1300000   160.5          200            200            0.003265163   -1.6844817e-39  0              0.0097954889   1.9872247e-06  0              9.5955969      2.6109412e-16  0              2.9952157    
   1400000   160.5          200            200            0.0032655336  -7.8412709e-39  0              0.0097966008   2.0578969e-07  0              0.99368476     2.6109412e-16  0              2.9952153    
   1500000   160.5          200            200            0.0032656965   2.6669615e-39  0              0.0097970895   1.9518825e-08  0              0.094249421    2.6109412e-16  0              2.9952151    
   1600000   160.5          200            200            0.003265765   -9.021406e-40   0              0.0097972951   1.6313195e-09  0              0.0078770581   2.6109412e-16  0              2.9952151    
   1700000   160.5          200            200            0.0032657929   3.3715092e-39  0              0.0097973787   1.1062083e-10  0              0.00053414841  2.6109412e-16  0              2.995215     
   1800000   160.5          200            200            0.0032658039   2.1104098e-39  0              0.0097974118   4.8239216e-12  0              2.3292991e-05  2.6109412e-16  0              2.995215     
   1900000   160.5          200            200            0.0032658082  -8.5630415e-39  0              0.0097974246   3.1254134e-14  0              1.5091503e-07  2.6109412e-16  0              2.995215     
   2000000   160.5          200            200            0.0032658098  -2.7030268e-39  0              0.0097974295   2.8369709e-14  0              1.3698717e-07  2.6109412e-16  0              2.995215     
   2100000   160.5          200            200            0.0032658104   1.4564746e-39  0              0.0097974313   2.1490081e-14  0              1.0376791e-07  2.6109412e-16  0              2.995215     
   2200000   160.5          200            200            0.0032658106   9.6935429e-39  0              0.0097974319   7.0574754e-15  0              3.4078023e-08  2.6109412e-16  0              2.995215     
   2300000   160.5          200            200            0.0032658107   1.4344408e-38  0              0.0097974322   1.7126875e-15  0              8.2699552e-09  2.6109412e-16  0              2.995215     
   2400000   160.5          200            200            0.0032658107   6.8588254e-41  0              0.0097974322   3.5562719e-16  0              1.7171964e-09  2.6109412e-16  0              2.995215     
   2500000   160.5          200            200            0.0032658108  -1.2954728e-38  0              0.0097974323   6.5292371e-17  0              3.1527349e-10  2.6109412e-16  0              2.995215     
   2600000   160.5          200            200            0.0032658108  -2.6247409e-39  0              0.0097974323   1.1317059e-17  0              5.4646026e-11  2.6109412e-16  0              2.995215     
   2700000   160.5          200            200            0.0032658108   5.6395097e-39  0              0.0097974323   1.7566082e-18  0              8.4820325e-12  2.6109412e-16  0              2.995215     
   2800000   160.5          200            200            0.0032658108   1.0909218e-38  0              0.0097974323   3.0000328e-19  0              1.4486085e-12  2.6109412e-16  0              2.995215     
   2900000   160.5          200            200            0.0032658108   5.0482701e-39  0              0.0097974323   2.1205824e-20  0              1.0239533e-13  2.6109412e-16  0              2.995215     
   3000000   160.5          200            200            0.0032658108  -4.234893e-39   0              0.0097974323   2.4388535e-20  0              1.1776351e-13  2.6109412e-16  0              2.995215     
Loop time of 64.0885 on 4 procs for 3000000 steps with 51 atoms

Performance: 40444097.800 ns/day, 0.000 hours/ns, 46810.298 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 0.33256    | 1.5266     | 4.9695     | 160.9 |  2.38
Neigh   | 0.081065   | 0.081608   | 0.083124   |   0.3 |  0.13
Comm    | 25.731     | 32.171     | 37.855     |  82.9 | 50.20
Output  | 0.062476   | 0.062551   | 0.062603   |   0.0 |  0.10
Modify  | 15.343     | 21.09      | 28.172     | 118.9 | 32.91
Other   |            | 9.157      |            |       | 14.29

Nlocal:          12.75 ave          51 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1
Nghost:          39.25 ave          52 max           1 min
Histogram: 1 0 0 0 0 0 0 0 0 3
Neighs:           6.75 ave          27 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1

Total # of neighbors = 27
Ave neighs/atom = 0.52941176
Neighbor list builds = 164
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 85

#variable lat0 equal 1                    #
variable lat1 equal 3+(151*0.01)+(v_ind*0.01)  # .491+(v_ind*0.001)       # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 10*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 5.36                                                               
Lattice spacing in x,y,z = 5.36 5.36 5.36

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -80.4 ${n1e1} -100 100 -100 100 units box
region box block -80.4 80.4 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -80.4 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -80.4 80.4 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-80.4 -100 -100) to (80.4 100 100)
  1 by 2 by 2 MPI processor grid
create_atoms 1 region substrate
Created 30 atoms
  using lattice units in orthogonal box = (-80.4 -100 -100) to (80.4 100 100)
  create_atoms CPU = 0.000 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 30 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 21 atoms
  using lattice units in orthogonal box = (-80.4 -100 -100) to (80.4 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  30 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  30 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  21 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  21 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
30 atoms in group substrate
group slider1 region slider1
21 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 21 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_85_*.dump id type diameter mass xu yu zu fx fy fz

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 104 130 130
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 14.75 | 18.22 | 19.37 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   160.8          200            200            0              0              0              0              0              0              0              2.6109412e-16  0              6            
    100000   160.8          200            200            0.0026463351   3.8334277e-39  0              0.0079390054   12227.516      0              5.90423e+10    2.6109412e-16  0              3.3290221    
    200000   160.8          200            200            0.00092066251  8.9829036e-41  0              0.0027619875   2895.2597      0              1.3980173e+10  2.6109412e-16  0              3.0789711    
    300000   160.8          200            200            5.0161737e-05  5.5788677e-41  0              0.00015048521  17.969712      0              86769310       2.6109412e-16  0              3.0456245    
    400000   160.8          200            200            0.00013930244  2.4731013e-37  0              0.00041790732  126.19066      0              6.0932956e+08  2.6109412e-16  0              3.0009618    
    500000   160.8          200            200            0.0060247363  -0.00027168191  0              0.018345891    9.8392326      0              47510133       2.6109412e-16  0              2.9928894    
    600000   160.8          200            200            0.0037810135  -1.326224e-37   0              0.01134304     3.194862       0              15426845       2.6109412e-16  0              2.994736     
    700000   160.8          200            200            0.0033653465  -2.6773309e-37  0              0.01009604     0.5085158      0              2455440.8      2.6109412e-16  0              2.9951199    
    800000   160.8          200            200            0.0032768104   6.9326217e-39  0              0.0098304313   0.072436691    0              349770.86      2.6109412e-16  0              2.9952012    
    900000   160.8          200            200            0.0032582424   1.6111923e-38  0              0.0097747273   0.0098929214   0              47769.377      2.6109412e-16  0              2.9952176    
   1000000   160.8          200            200            0.0032563206  -4.2128411e-38  0              0.0097689619   0.0012995686   0              6275.1517      2.6109412e-16  0              2.9952187    
   1100000   160.8          200            200            0.0032574381   4.9976219e-39  0              0.0097723144   0.00016393069  0              791.56261      2.6109412e-16  0              2.9952174    
   1200000   160.8          200            200            0.003258516    1.4903498e-39  0              0.0097755481   1.9793389e-05  0              95.575192      2.6109412e-16  0              2.9952162    
   1300000   160.8          200            200            0.0032591507   4.4687068e-39  0              0.0097774521   2.2753135e-06  0              10.986674      2.6109412e-16  0              2.9952156    
   1400000   160.8          200            200            0.0032594673   4.2024763e-39  0              0.0097784019   2.4682623e-07  0              1.1918356      2.6109412e-16  0              2.9952153    
   1500000   160.8          200            200            0.0032596121   2.5420429e-39  0              0.0097788362   2.4901956e-08  0              0.12024263     2.6109412e-16  0              2.9952151    
   1600000   160.8          200            200            0.0032596747   9.0379021e-40  0              0.0097790241   2.2779849e-09  0              0.010999574    2.6109412e-16  0              2.9952151    
   1700000   160.8          200            200            0.0032597007  -7.0081814e-40  0              0.0097791021   1.7997081e-10  0              0.00086901465  2.6109412e-16  0              2.995215     
   1800000   160.8          200            200            0.0032597112   5.9123485e-40  0              0.0097791336   1.0984123e-11  0              5.3038399e-05  2.6109412e-16  0              2.995215     
   1900000   160.8          200            200            0.0032597153   2.8690758e-39  0              0.0097791459   3.5869904e-13  0              1.7320293e-06  2.6109412e-16  0              2.995215     
   2000000   160.8          200            200            0.0032597169   2.2988642e-39  0              0.0097791507   1.4903746e-16  0              7.1964854e-10  2.6109412e-16  0              2.995215     
   2100000   160.8          200            200            0.0032597175   1.2787176e-39  0              0.0097791525   8.0920464e-15  0              3.9073596e-08  2.6109412e-16  0              2.995215     
   2200000   160.8          200            200            0.0032597177  -2.1061005e-39  0              0.0097791531   4.0750696e-15  0              1.9677053e-08  2.6109412e-16  0              2.995215     
   2300000   160.8          200            200            0.0032597178   2.9125747e-40  0              0.0097791534   1.1775406e-15  0              5.6859224e-09  2.6109412e-16  0              2.995215     
   2400000   160.8          200            200            0.0032597178   2.2450306e-39  0              0.0097791534   2.6917123e-16  0              1.2997315e-09  2.6109412e-16  0              2.995215     
   2500000   160.8          200            200            0.0032597178   4.2369342e-39  0              0.0097791535   5.4111466e-17  0              2.612849e-10   2.6109412e-16  0              2.995215     
   2600000   160.8          200            200            0.0032597178  -3.7910536e-39  0              0.0097791535   9.870543e-18   0              4.766132e-11   2.6109412e-16  0              2.995215     
   2700000   160.8          200            200            0.0032597178  -1.2351687e-39  0              0.0097791535   1.4790967e-18  0              7.1420285e-12  2.6109412e-16  0              2.995215     
   2800000   160.8          200            200            0.0032597178   6.1587885e-39  0              0.0097791535   2.6782781e-19  0              1.2932446e-12  2.6109412e-16  0              2.995215     
   2900000   160.8          200            200            0.0032597178   4.5007757e-39  0              0.0097791535   3.5808223e-20  0              1.7290509e-13  2.6109412e-16  0              2.995215     
   3000000   160.8          200            200            0.0032597178  -3.3309421e-39  0              0.0097791535   3.3206265e-20  0              1.6034117e-13  2.6109412e-16  0              2.995215     
Loop time of 64.2097 on 4 procs for 3000000 steps with 51 atoms

Performance: 40367711.616 ns/day, 0.000 hours/ns, 46721.888 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 0.33019    | 1.5133     | 4.9225     | 160.1 |  2.36
Neigh   | 0.081142   | 0.081693   | 0.083219   |   0.3 |  0.13
Comm    | 25.791     | 32.245     | 37.907     |  83.2 | 50.22
Output  | 0.06029    | 0.06037    | 0.060428   |   0.0 |  0.09
Modify  | 15.482     | 21.189     | 28.285     | 119.4 | 33.00
Other   |            | 9.121      |            |       | 14.20

Nlocal:          12.75 ave          51 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1
Nghost:          39.25 ave          52 max           1 min
Histogram: 1 0 0 0 0 0 0 0 0 3
Neighs:           6.75 ave          27 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1

Total # of neighbors = 27
Ave neighs/atom = 0.52941176
Neighbor list builds = 164
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 86

#variable lat0 equal 1                    #
variable lat1 equal 3+(151*0.01)+(v_ind*0.01)  # .491+(v_ind*0.001)       # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 10*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 5.37                                                               
Lattice spacing in x,y,z = 5.37 5.37 5.37

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -80.55 ${n1e1} -100 100 -100 100 units box
region box block -80.55 80.55 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -80.55 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -80.55 80.55 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-80.55 -100 -100) to (80.55 100 100)
  1 by 2 by 2 MPI processor grid
create_atoms 1 region substrate
Created 30 atoms
  using lattice units in orthogonal box = (-80.55 -100 -100) to (80.55 100 100)
  create_atoms CPU = 0.000 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 30 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 21 atoms
  using lattice units in orthogonal box = (-80.55 -100 -100) to (80.55 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  30 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  30 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  21 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  21 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
30 atoms in group substrate
group slider1 region slider1
21 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 21 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_86_*.dump id type diameter mass xu yu zu fx fy fz

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 104 130 130
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 14.75 | 18.22 | 19.37 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   161.1          200            200            0              0              0              0              0              0              0              2.6109412e-16  0              6            
    100000   161.1          200            200            0.0026409218   1.9132787e-39  0              0.0079227654   12219.43       0              5.9003253e+10  2.6109412e-16  0              3.3309734    
    200000   161.1          200            200            0.00091988787 -4.7819391e-40  0              0.0027596636   2898.2546      0              1.3994634e+10  2.6109412e-16  0              3.0805096    
    300000   161.1          200            200            6.0637873e-05  3.8269412e-39  0              0.00018191362  25.938096      0              1.2524578e+08  2.6109412e-16  0              3.0467311    
    400000   161.1          200            200            0.0076274608  -0.0034222342   0              0.026304617    184.07063      0              8.888112e+08   2.6109412e-16  0              2.9932737    
    500000   161.1          200            200            0.00046668916 -9.8825963e-37  0              0.0014000675   2.6069584      0              12588069       2.6109412e-16  0              2.9986566    
    600000   161.1          200            200            0.0034035851  -0.00052128591  0              0.010732041    4.888881       0              23606657       2.6109412e-16  0              2.9953994    
    700000   161.1          200            200            0.0026879573  -0.00024574079  0              0.0083096126   0.21642397     0              1045033.9      2.6109412e-16  0              2.9958558    
    800000   161.1          200            200            0.0030247879  -0.00045955706  0              0.0095339208   0.079103656    0              381963.24      2.6109412e-16  0              2.9956065    
    900000   161.1          200            200            0.0031065089  -0.00045604201  0              0.0097755687   0.012041769    0              58145.393      2.6109412e-16  0              2.9955613    
   1000000   161.1          200            200            0.0031143657  -0.00045673745  0              0.0097998345   0.0013350516   0              6446.4866      2.6109412e-16  0              2.9955571    
   1100000   161.1          200            200            0.0031098819  -0.00045626259  0              0.0097859084   0.00010354331  0              499.97357      2.6109412e-16  0              2.99556      
   1200000   161.1          200            200            0.0031058113  -0.00045584614  0              0.0097732802   4.1232072e-06  0              19.909492      2.6109412e-16  0              2.9955624    
   1300000   161.1          200            200            0.0031036351  -0.00045562486  0              0.0097665302   2.2558503e-10  0              0.0010892694   2.6109412e-16  0              2.9955637    
   1400000   161.1          200            200            0.0031026951  -0.00045552968  0              0.0097636149   6.991425e-08   0              0.33759089     2.6109412e-16  0              2.9955643    
   1500000   161.1          200            200            0.0031023453  -0.00045549444  0              0.0097625305   3.3569221e-08  0              0.16209375     2.6109412e-16  0              2.9955645    
   1600000   161.1          200            200            0.0031022329  -0.00045548318  0              0.0097621819   8.0591623e-09  0              0.038914811    2.6109412e-16  0              2.9955645    
   1700000   161.1          200            200            0.0031022031  -0.00045548024  0              0.0097620897   1.3487183e-09  0              0.006512478    2.6109412e-16  0              2.9955646    
   1800000   161.1          200            200            0.003102198   -0.00045547975  0              0.0097620737   1.6947156e-10  0              0.00081831754  2.6109412e-16  0              2.9955646    
   1900000   161.1          200            200            0.0031021985  -0.00045547981  0              0.0097620752   1.5611893e-11  0              7.5384245e-05  2.6109412e-16  0              2.9955646    
   2000000   161.1          200            200            0.0031021995  -0.00045547991  0              0.0097620784   8.9500226e-13  0              4.3216456e-06  2.6109412e-16  0              2.9955646    
   2100000   161.1          200            200            0.0031022001  -0.00045547998  0              0.0097620804   1.2896245e-14  0              6.2271351e-08  2.6109412e-16  0              2.9955646    
   2200000   161.1          200            200            0.0031022004  -0.00045548001  0              0.0097620814   2.5184563e-15  0              1.2160724e-08  2.6109412e-16  0              2.9955646    
   2300000   161.1          200            200            0.0031022006  -0.00045548002  0              0.0097620817   2.4806543e-15  0              1.1978192e-08  2.6109412e-16  0              2.9955646    
   2400000   161.1          200            200            0.0031022006  -0.00045548003  0              0.0097620818   7.4581036e-16  0              3.6012513e-09  2.6109412e-16  0              2.9955646    
   2500000   161.1          200            200            0.0031022006  -0.00045548003  0              0.0097620819   1.4328737e-16  0              6.9188345e-10  2.6109412e-16  0              2.9955646    
   2600000   161.1          200            200            0.0031022006  -0.00045548003  0              0.0097620819   2.0544564e-17  0              9.9202346e-11  2.6109412e-16  0              2.9955646    
   2700000   161.1          200            200            0.0031022006  -0.00045548003  0              0.0097620819   1.5199972e-18  0              7.3395223e-12  2.6109412e-16  0              2.9955646    
   2800000   161.1          200            200            0.0031022006  -0.00045548003  0              0.0097620819   3.0960138e-21  0              1.4949542e-14  2.6109412e-16  0              2.9955646    
   2900000   161.1          200            200            0.0031022006  -0.00045548003  0              0.0097620819   1.5531975e-19  0              7.4998351e-13  2.6109412e-16  0              2.9955646    
   3000000   161.1          200            200            0.0031022006  -0.00045548003  0              0.0097620819   1.6030094e-19  0              7.7403588e-13  2.6109412e-16  0              2.9955646    
Loop time of 64.1317 on 4 procs for 3000000 steps with 51 atoms

Performance: 40416832.348 ns/day, 0.000 hours/ns, 46778.741 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 0.33162    | 1.6081     | 5.305      | 168.4 |  2.51
Neigh   | 0.081097   | 0.081704   | 0.083251   |   0.3 |  0.13
Comm    | 25.756     | 32.121     | 37.93      |  82.2 | 50.09
Output  | 0.058926   | 0.059004   | 0.05906    |   0.0 |  0.09
Modify  | 15.339     | 21.1       | 28.213     | 119.1 | 32.90
Other   |            | 9.162      |            |       | 14.29

Nlocal:          12.75 ave          51 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1
Nghost:          39.25 ave          52 max           1 min
Histogram: 1 0 0 0 0 0 0 0 0 3
Neighs:           6.75 ave          27 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1

Total # of neighbors = 27
Ave neighs/atom = 0.52941176
Neighbor list builds = 164
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 87

#variable lat0 equal 1                    #
variable lat1 equal 3+(151*0.01)+(v_ind*0.01)  # .491+(v_ind*0.001)       # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 10*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 5.38                                                               
Lattice spacing in x,y,z = 5.38 5.38 5.38

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -80.7 ${n1e1} -100 100 -100 100 units box
region box block -80.7 80.7 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -80.7 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -80.7 80.7 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-80.7 -100 -100) to (80.7 100 100)
  1 by 2 by 2 MPI processor grid
create_atoms 1 region substrate
Created 30 atoms
  using lattice units in orthogonal box = (-80.7 -100 -100) to (80.7 100 100)
  create_atoms CPU = 0.000 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 30 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 21 atoms
  using lattice units in orthogonal box = (-80.7 -100 -100) to (80.7 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  30 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  30 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  21 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  21 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
30 atoms in group substrate
group slider1 region slider1
21 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 21 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_87_*.dump id type diameter mass xu yu zu fx fy fz

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 105 130 130
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 14.77 | 18.24 | 19.39 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   161.4          200            200            0              0              0              0              0              0              0              2.6109412e-16  0              6            
    100000   161.4          200            200            0.0026363546   5.9663267e-41  0              0.0079090638   12218.232      0              5.8997468e+10  2.6109412e-16  0              3.3322647    
    200000   161.4          200            200            0.00091863153 -1.4915801e-41  0              0.0027558946   2899.1391      0              1.3998905e+10  2.6109412e-16  0              3.0818419    
    300000   161.4          200            200            6.2605088e-05  3.5798039e-40  0              0.00018781526  27.649455      0              1.3350932e+08  2.6109412e-16  0              3.0479153    
    400000   161.4          200            200            0.014443017   -0.0060173929   0              0.049346445    56.244585      0              2.7158497e+08  2.6109412e-16  0              2.992144     
    500000   161.4          200            200            0.0030075042  -0.0018925318   0              0.010915044    39.673709      0              1.9157014e+08  2.6109412e-16  0              2.9964373    
    600000   161.4          200            200            0.0046087696  -0.001600898    0              0.015427207    0.53174355     0              2567599.3      2.6109412e-16  0              2.9958082    
    700000   161.4          200            200            0.0025674474  -0.0010927366   0              0.0087950787   0.57807149     0              2791300.4      2.6109412e-16  0              2.9968154    
    800000   161.4          200            200            0.0026984268  -0.0011068198   0              0.0092021001   0.048891862    0              236081.3       2.6109412e-16  0              2.9967419    
    900000   161.4          200            200            0.0029525715  -0.0011283552   0              0.0099860697   0.0036828113   0              17782.978      2.6109412e-16  0              2.996615     
   1000000   161.4          200            200            0.002885276   -0.0011229025   0              0.0097787306   0.0016840921   0              8131.8782      2.6109412e-16  0              2.9966489    
   1100000   161.4          200            200            0.0028628873  -0.001121098    0              0.0097097599   9.7278451e-07  0              4.6972283      2.6109412e-16  0              2.9966599    
   1200000   161.4          200            200            0.0028758883  -0.0011221784   0              0.0097498432   3.2764708e-05  0              158.20905      2.6109412e-16  0              2.9966534    
   1300000   161.4          200            200            0.002876646   -0.0011222343   0              0.0097521724   7.5467139e-07  0              3.644038       2.6109412e-16  0              2.996653     
   1400000   161.4          200            200            0.0028747531  -0.0011220789   0              0.0097463381   3.8743104e-07  0              1.8707658      2.6109412e-16  0              2.996654     
   1500000   161.4          200            200            0.002874982   -0.0011220986   0              0.0097470447   5.1311151e-08  0              0.24776318     2.6109412e-16  0              2.9966538    
   1600000   161.4          200            200            0.0028751981  -0.0011221162   0              0.0097477104   1.9863834e-09  0              0.0095915345   2.6109412e-16  0              2.9966537    
   1700000   161.4          200            200            0.0028751293  -0.0011221104   0              0.0097474983   1.4787776e-09  0              0.0071404876   2.6109412e-16  0              2.9966538    
   1800000   161.4          200            200            0.0028751121  -0.001122109    0              0.0097474453   4.9237616e-13  0              2.3775083e-06  2.6109412e-16  0              2.9966538    
   1900000   161.4          200            200            0.0028751244  -0.0011221101   0              0.0097474833   2.5814039e-11  0              0.00012464676  2.6109412e-16  0              2.9966538    
   2000000   161.4          200            200            0.0028751246  -0.0011221101   0              0.0097474838   9.6935063e-13  0              4.6806473e-06  2.6109412e-16  0              2.9966538    
   2100000   161.4          200            200            0.0028751229  -0.0011221099   0              0.0097474786   2.6540649e-13  0              1.2815529e-06  2.6109412e-16  0              2.9966538    
   2200000   161.4          200            200            0.0028751232  -0.00112211     0              0.0097474794   4.9887961e-14  0              2.4089111e-07  2.6109412e-16  0              2.9966538    
   2300000   161.4          200            200            0.0028751233  -0.00112211     0              0.00974748     9.3795045e-16  0              4.529027e-09   2.6109412e-16  0              2.9966538    
   2400000   161.4          200            200            0.0028751233  -0.00112211     0              0.0097474798   1.2662175e-15  0              6.1141113e-09  2.6109412e-16  0              2.9966538    
   2500000   161.4          200            200            0.0028751233  -0.00112211     0              0.0097474797   4.5245107e-18  0              2.1847243e-11  2.6109412e-16  0              2.9966538    
   2600000   161.4          200            200            0.0028751233  -0.00112211     0              0.0097474798   1.9426421e-17  0              9.3803236e-11  2.6109412e-16  0              2.9966538    
   2700000   161.4          200            200            0.0028751233  -0.00112211     0              0.0097474798   2.0581812e-18  0              9.9382204e-12  2.6109412e-16  0              2.9966538    
   2800000   161.4          200            200            0.0028751233  -0.00112211     0              0.0097474798   1.4027848e-19  0              6.7735458e-13  2.6109412e-16  0              2.9966538    
   2900000   161.4          200            200            0.0028751233  -0.00112211     0              0.0097474798   1.5502664e-22  0              7.4856815e-16  2.6109412e-16  0              2.9966538    
   3000000   161.4          200            200            0.0028751233  -0.00112211     0              0.0097474798   1.4256715e-19  0              6.8840576e-13  2.6109412e-16  0              2.9966538    
Loop time of 63.8741 on 4 procs for 3000000 steps with 51 atoms

Performance: 40579848.153 ns/day, 0.000 hours/ns, 46967.417 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 0.32595    | 1.5505     | 5.11       | 165.1 |  2.43
Neigh   | 0.082866   | 0.083439   | 0.084966   |   0.3 |  0.13
Comm    | 25.72      | 32.028     | 37.776     |  82.0 | 50.14
Output  | 0.062032   | 0.062107   | 0.062158   |   0.0 |  0.10
Modify  | 15.296     | 21.019     | 28.07      | 119.0 | 32.91
Other   |            | 9.131      |            |       | 14.30

Nlocal:          12.75 ave          51 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1
Nghost:          39.25 ave          52 max           1 min
Histogram: 1 0 0 0 0 0 0 0 0 3
Neighs:           6.75 ave          27 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1

Total # of neighbors = 27
Ave neighs/atom = 0.52941176
Neighbor list builds = 166
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 88

#variable lat0 equal 1                    #
variable lat1 equal 3+(151*0.01)+(v_ind*0.01)  # .491+(v_ind*0.001)       # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 10*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 5.39                                                               
Lattice spacing in x,y,z = 5.39 5.39 5.39

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -80.85 ${n1e1} -100 100 -100 100 units box
region box block -80.85 80.85 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -80.85 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -80.85 80.85 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-80.85 -100 -100) to (80.85 100 100)
  1 by 2 by 2 MPI processor grid
create_atoms 1 region substrate
Created 30 atoms
  using lattice units in orthogonal box = (-80.85 -100 -100) to (80.85 100 100)
  create_atoms CPU = 0.000 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 30 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 21 atoms
  using lattice units in orthogonal box = (-80.85 -100 -100) to (80.85 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  30 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  30 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  21 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  21 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
30 atoms in group substrate
group slider1 region slider1
21 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 21 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_88_*.dump id type diameter mass xu yu zu fx fy fz

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 105 130 130
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 14.77 | 18.24 | 19.39 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   161.7          200            200            0              0              0              0              0              0              0              2.6109412e-16  0              6            
    100000   161.7          200            200            0.0026326093  -1.163136e-43   0              0.0078978278   12224.553      0              5.9027993e+10  2.6109412e-16  0              3.332603     
    200000   161.7          200            200            0.00091713368 -5.81568e-44    0              0.0027514011   2899.2534      0              1.3999457e+10  2.6109412e-16  0              3.0827519    
    300000   161.7          200            200            6.1024216e-05  2.5198929e-48  0              0.00018307265  26.409274      0              1.2752093e+08  2.6109412e-16  0              3.0488286    
    400000   161.7          200            200            0.015984109   -0.001934925    0              0.049887252    55.665154      0              2.6878711e+08  2.6109412e-16  0              2.9929017    
    500000   161.7          200            200            0.00015113103 -4.2916712e-05  0              0.00049630979  19.304944      0              93216665       2.6109412e-16  0              2.9993745    
    600000   161.7          200            200            0.0023118511  -0.00059087695  0              0.0075264301   4.8622615      0              23478121       2.6109412e-16  0              2.9978019    
    700000   161.7          200            200            0.0026226236  -0.00060282472  0              0.0084706956   0.49811573     0              2405222.6      2.6109412e-16  0              2.9976335    
    800000   161.7          200            200            0.0029063992  -0.0006109825   0              0.0093301801   0.077589469    0              374651.78      2.6109412e-16  0              2.9974911    
    900000   161.7          200            200            0.0030026395  -0.00061332802  0              0.0096212464   0.012183206    0              58828.341      2.6109412e-16  0              2.9974438    
   1000000   161.7          200            200            0.003030767   -0.00061398051  0              0.0097062815   0.0018230656   0              8802.9313      2.6109412e-16  0              2.99743      
   1100000   161.7          200            200            0.003038031   -0.00061414862  0              0.0097282416   0.00026006746  0              1255.7727      2.6109412e-16  0              2.9974264    
   1200000   161.7          200            200            0.003039506   -0.00061418386  0              0.0097327019   3.5464006e-05  0              171.24299      2.6109412e-16  0              2.9974256    
   1300000   161.7          200            200            0.0030395972  -0.00061418686  0              0.0097329784   4.6255157e-06  0              22.33496       2.6109412e-16  0              2.9974256    
   1400000   161.7          200            200            0.0030394641  -0.00061418428  0              0.0097325767   5.7610941e-07  0              2.7818262      2.6109412e-16  0              2.9974256    
   1500000   161.7          200            200            0.003039355   -0.000614182    0              0.0097322471   6.8246155e-08  0              0.32953626     2.6109412e-16  0              2.9974257    
   1600000   161.7          200            200            0.0030392937  -0.00061418069  0              0.0097320617   7.6337334e-09  0              0.036860566    2.6109412e-16  0              2.9974257    
   1700000   161.7          200            200            0.0030392638  -0.00061418005  0              0.0097319714   7.9646148e-10  0              0.0038458274   2.6109412e-16  0              2.9974257    
   1800000   161.7          200            200            0.0030392503  -0.00061417975  0              0.0097319308   7.5889293e-11  0              0.00036644224  2.6109412e-16  0              2.9974257    
   1900000   161.7          200            200            0.0030392446  -0.00061417963  0              0.0097319134   6.3485438e-12  0              3.0654846e-05  2.6109412e-16  0              2.9974257    
   2000000   161.7          200            200            0.0030392422  -0.00061417958  0              0.0097319063   4.2840519e-13  0              2.0686154e-06  2.6109412e-16  0              2.9974257    
   2100000   161.7          200            200            0.0030392413  -0.00061417956  0              0.0097319035   1.8285145e-14  0              8.8292422e-08  2.6109412e-16  0              2.9974257    
   2200000   161.7          200            200            0.0030392409  -0.00061417955  0              0.0097319024   9.5396878e-17  0              4.6063738e-10  2.6109412e-16  0              2.9974257    
   2300000   161.7          200            200            0.0030392408  -0.00061417955  0              0.009731902    1.2437829e-16  0              6.0057823e-10  2.6109412e-16  0              2.9974257    
   2400000   161.7          200            200            0.0030392408  -0.00061417954  0              0.0097319018   8.7838459e-17  0              4.2414048e-10  2.6109412e-16  0              2.9974257    
   2500000   161.7          200            200            0.0030392407  -0.00061417954  0              0.0097319018   2.9381676e-17  0              1.418736e-10   2.6109412e-16  0              2.9974257    
   2600000   161.7          200            200            0.0030392407  -0.00061417954  0              0.0097319017   6.4889564e-18  0              3.1332848e-11  2.6109412e-16  0              2.9974257    
   2700000   161.7          200            200            0.0030392407  -0.00061417954  0              0.0097319017   6.7104108e-19  0              3.2402172e-12  2.6109412e-16  0              2.9974257    
   2800000   161.7          200            200            0.0030392407  -0.00061417954  0              0.0097319017   2.3286538e-19  0              1.1244236e-12  2.6109412e-16  0              2.9974257    
   2900000   161.7          200            200            0.0030392407  -0.00061417954  0              0.0097319017   4.8953583e-20  0              2.3637933e-13  2.6109412e-16  0              2.9974257    
   3000000   161.7          200            200            0.0030392407  -0.00061417954  0              0.0097319017   4.8881533e-20  0              2.3603143e-13  2.6109412e-16  0              2.9974257    
Loop time of 64.0444 on 4 procs for 3000000 steps with 51 atoms

Performance: 40471917.241 ns/day, 0.000 hours/ns, 46842.497 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 0.33031    | 1.5849     | 5.2148     | 166.5 |  2.47
Neigh   | 0.082875   | 0.083446   | 0.084983   |   0.3 |  0.13
Comm    | 25.763     | 32.078     | 37.846     |  81.9 | 50.09
Output  | 0.059561   | 0.059636   | 0.059686   |   0.0 |  0.09
Modify  | 15.337     | 21.082     | 28.175     | 119.3 | 32.92
Other   |            | 9.156      |            |       | 14.30

Nlocal:          12.75 ave          51 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1
Nghost:          39.25 ave          52 max           1 min
Histogram: 1 0 0 0 0 0 0 0 0 3
Neighs:           6.75 ave          27 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1

Total # of neighbors = 27
Ave neighs/atom = 0.52941176
Neighbor list builds = 166
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 89

#variable lat0 equal 1                    #
variable lat1 equal 3+(151*0.01)+(v_ind*0.01)  # .491+(v_ind*0.001)       # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 10*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 5.4                                                               
Lattice spacing in x,y,z = 5.4 5.4 5.4

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -81 ${n1e1} -100 100 -100 100 units box
region box block -81 81 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -81 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -81 81 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-81 -100 -100) to (81 100 100)
  1 by 2 by 2 MPI processor grid
create_atoms 1 region substrate
Created 30 atoms
  using lattice units in orthogonal box = (-81 -100 -100) to (81 100 100)
  create_atoms CPU = 0.000 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 30 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 21 atoms
  using lattice units in orthogonal box = (-81 -100 -100) to (81 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  30 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  30 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  21 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  21 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
30 atoms in group substrate
group slider1 region slider1
21 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 21 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_89_*.dump id type diameter mass xu yu zu fx fy fz

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 105 130 130
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 14.77 | 18.24 | 19.39 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   162            200            200            0              0              0              0              0              0              0              2.6109412e-16  0              6            
    100000   162            200            200            0.0026281279  -5.944198e-41   0              0.0078843837   12226.737      0              5.9038536e+10  2.6109412e-16  0              3.332717     
    200000   162            200            200            0.00091541748 -1.4860528e-41  0              0.0027462524   2898.8443      0              1.3997482e+10  2.6109412e-16  0              3.0830907    
    300000   162            200            200            6.0015243e-05 -5.7063986e-39  0              0.00018004573  25.665943      0              1.2393165e+08  2.6109412e-16  0              3.049162     
    400000   162            200            200            0.016129746   -1.8260246e-37  0              0.048389238    67.483706      0              3.2585466e+08  2.6109412e-16  0              2.9933115    
    500000   162            200            200            0.00019140907  7.6090909e-39  0              0.00057422721  20.524298      0              99104490       2.6109412e-16  0              2.9995944    
    600000   162            200            200            0.0027716599  -2.4343453e-37  0              0.0083149797   5.4552922      0              26341653       2.6109412e-16  0              2.9979397    
    700000   162            200            200            0.0029917899   2.0005341e-41  0              0.0089753696   0.69136297     0              3338344.4      2.6109412e-16  0              2.9978225    
    800000   162            200            200            0.0032071509  -5.3247748e-38  0              0.0096214527   0.10528024     0              508360.6       2.6109412e-16  0              2.9977161    
    900000   162            200            200            0.0032535746   5.7171939e-39  0              0.0097607237   0.014142706    0              68290.066      2.6109412e-16  0              2.997693     
   1000000   162            200            200            0.0032534164   7.2378609e-40  0              0.0097602493   0.0016157542   0              7801.8986      2.6109412e-16  0              2.9976927    
   1100000   162            200            200            0.0032468956   1.4590982e-38  0              0.0097406867   0.00015213459  0              734.60347      2.6109412e-16  0              2.9976956    
   1200000   162            200            200            0.0032423128   4.0104808e-38  0              0.0097269383   1.0791713e-05  0              52.10932       2.6109412e-16  0              2.9976977    
   1300000   162            200            200            0.0032399559   2.4709605e-38  0              0.0097198677   4.2856693e-07  0              2.0693963      2.6109412e-16  0              2.9976988    
   1400000   162            200            200            0.0032389093   2.5824505e-38  0              0.0097167278   3.4361164e-10  0              0.0016591776   2.6109412e-16  0              2.9976993    
   1500000   162            200            200            0.0032384879   2.6089432e-39  0              0.0097154637   5.6956297e-09  0              0.027502158    2.6109412e-16  0              2.9976995    
   1600000   162            200            200            0.0032383315  -2.8588595e-38  0              0.0097149946   3.1232824e-09  0              0.015081213    2.6109412e-16  0              2.9976996    
   1700000   162            200            200            0.0032382779   1.8986509e-38  0              0.0097148338   8.5939175e-10  0              0.0041496952   2.6109412e-16  0              2.9976996    
   1800000   162            200            200            0.0032382612   3.7149932e-39  0              0.0097147836   1.7350543e-10  0              0.00083779563  2.6109412e-16  0              2.9976996    
   1900000   162            200            200            0.0032382566  -3.1496844e-38  0              0.0097147698   2.8618384e-11  0              0.00013818793  2.6109412e-16  0              2.9976996    
   2000000   162            200            200            0.0032382556  -1.2444253e-38  0              0.0097147669   4.0051997e-12  0              1.9339676e-05  2.6109412e-16  0              2.9976996    
   2100000   162            200            200            0.0032382555  -1.3171534e-38  0              0.0097147666   4.7829997e-13  0              2.3095394e-06  2.6109412e-16  0              2.9976996    
   2200000   162            200            200            0.0032382556   7.7972455e-40  0              0.0097147669   4.7660518e-14  0              2.3013559e-07  2.6109412e-16  0              2.9976996    
   2300000   162            200            200            0.0032382557  -3.323707e-38   0              0.0097147671   3.6978713e-15  0              1.7855697e-08  2.6109412e-16  0              2.9976996    
   2400000   162            200            200            0.0032382557  -3.2159222e-38  0              0.0097147672   1.8527847e-16  0              8.9464342e-10  2.6109412e-16  0              2.9976996    
   2500000   162            200            200            0.0032382557  -7.0690012e-39  0              0.0097147672   1.5944957e-18  0              7.6992489e-12  2.6109412e-16  0              2.9976996    
   2600000   162            200            200            0.0032382558  -2.4987582e-38  0              0.0097147673   6.8337925e-19  0              3.2997938e-12  2.6109412e-16  0              2.9976996    
   2700000   162            200            200            0.0032382558  -3.5318435e-38  0              0.0097147673   1.5802168e-19  0              7.6303012e-13  2.6109412e-16  0              2.9976996    
   2800000   162            200            200            0.0032382558   9.5526362e-39  0              0.0097147673   2.7790158e-19  0              1.3418873e-12  2.6109412e-16  0              2.9976996    
   2900000   162            200            200            0.0032382558   3.019031e-38   0              0.0097147673   1.5185225e-19  0              7.3324017e-13  2.6109412e-16  0              2.9976996    
   3000000   162            200            200            0.0032382558   3.732624e-38   0              0.0097147673   6.3833866e-20  0              3.0823089e-13  2.6109412e-16  0              2.9976996    
Loop time of 63.8661 on 4 procs for 3000000 steps with 51 atoms

Performance: 40584925.519 ns/day, 0.000 hours/ns, 46973.293 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 0.33227    | 1.5895     | 5.2166     | 166.1 |  2.49
Neigh   | 0.082867   | 0.083419   | 0.084958   |   0.3 |  0.13
Comm    | 25.631     | 32.063     | 37.843     |  82.8 | 50.20
Output  | 0.061074   | 0.061147   | 0.061202   |   0.0 |  0.10
Modify  | 15.178     | 20.926     | 28.062     | 119.8 | 32.77
Other   |            | 9.143      |            |       | 14.32

Nlocal:          12.75 ave          51 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1
Nghost:          39.25 ave          52 max           1 min
Histogram: 1 0 0 0 0 0 0 0 0 3
Neighs:           6.75 ave          27 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1

Total # of neighbors = 27
Ave neighs/atom = 0.52941176
Neighbor list builds = 166
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 90

#variable lat0 equal 1                    #
variable lat1 equal 3+(151*0.01)+(v_ind*0.01)  # .491+(v_ind*0.001)       # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 10*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 5.41                                                               
Lattice spacing in x,y,z = 5.41 5.41 5.41

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -81.15 ${n1e1} -100 100 -100 100 units box
region box block -81.15 81.15 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -81.15 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -81.15 81.15 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-81.15 -100 -100) to (81.15 100 100)
  1 by 2 by 2 MPI processor grid
create_atoms 1 region substrate
Created 30 atoms
  using lattice units in orthogonal box = (-81.15 -100 -100) to (81.15 100 100)
  create_atoms CPU = 0.000 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 30 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 21 atoms
  using lattice units in orthogonal box = (-81.15 -100 -100) to (81.15 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  30 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  30 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  21 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  21 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
30 atoms in group substrate
group slider1 region slider1
21 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 21 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_90_*.dump id type diameter mass xu yu zu fx fy fz

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 105 130 130
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 14.77 | 18.24 | 19.39 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   162.3          200            200            0              0              0              0              0              0              0              2.6109412e-16  0              6            
    100000   162.3          200            200            0.0026228769  -1.1588361e-43  0              0.0078686306   12224.553      0              5.9027993e+10  2.6109412e-16  0              3.332603     
    200000   162.3          200            200            0.00091374317 -5.7941803e-44  0              0.0027412295   2899.2534      0              1.3999457e+10  2.6109412e-16  0              3.0827519    
    300000   162.3          200            200            6.0798619e-05 -7.4165485e-42  0              0.00018239586  26.409274      0              1.2752093e+08  2.6109412e-16  0              3.0488286    
    400000   162.3          200            200            0.017212585    0.0019349283   0              0.049702825    55.665154      0              2.6878711e+08  2.6109412e-16  0              2.9929017    
    500000   162.3          200            200            0.00017913011  4.2915331e-05  0              0.00049447501  19.304944      0              93216665       2.6109412e-16  0              2.9993745    
    600000   162.3          200            200            0.0026964944   0.00059087712  0              0.007498606    4.8622615      0              23478121       2.6109412e-16  0              2.9978019    
    700000   162.3          200            200            0.0030140685   0.00060282476  0              0.0084393806   0.49811573     0              2405222.6      2.6109412e-16  0              2.9976335    
    800000   162.3          200            200            0.0033022234   0.00061098251  0              0.0092956878   0.077589469    0              374651.78      2.6109412e-16  0              2.9974911    
    900000   162.3          200            200            0.0033996687   0.00061332802  0              0.009585678    0.012183206    0              58828.341      2.6109412e-16  0              2.9974438    
   1000000   162.3          200            200            0.0034281264   0.00061398051  0              0.0096703987   0.0018230656   0              8802.9313      2.6109412e-16  0              2.99743      
   1100000   162.3          200            200            0.0034354754   0.00061414862  0              0.0096922777   0.00026006746  0              1255.7727      2.6109412e-16  0              2.9974264    
   1200000   162.3          200            200            0.0034369685   0.00061418386  0              0.0096967215   3.5464006e-05  0              171.24299      2.6109412e-16  0              2.9974256    
   1300000   162.3          200            200            0.0034370613   0.00061418686  0              0.009696997    4.6255157e-06  0              22.33496       2.6109412e-16  0              2.9974256    
   1400000   162.3          200            200            0.003436927    0.00061418428  0              0.0096965968   5.7610941e-07  0              2.7818262      2.6109412e-16  0              2.9974256    
   1500000   162.3          200            200            0.0034368168   0.000614182    0              0.0096962684   6.8246155e-08  0              0.32953626     2.6109412e-16  0              2.9974257    
   1600000   162.3          200            200            0.0034367548   0.00061418069  0              0.0096960837   7.6337334e-09  0              0.036860566    2.6109412e-16  0              2.9974257    
   1700000   162.3          200            200            0.0034367246   0.00061418005  0              0.0096959937   7.9646148e-10  0              0.0038458274   2.6109412e-16  0              2.9974257    
   1800000   162.3          200            200            0.003436711    0.00061417975  0              0.0096959532   7.5889293e-11  0              0.00036644224  2.6109412e-16  0              2.9974257    
   1900000   162.3          200            200            0.0034367052   0.00061417963  0              0.0096959359   6.3485438e-12  0              3.0654846e-05  2.6109412e-16  0              2.9974257    
   2000000   162.3          200            200            0.0034367028   0.00061417958  0              0.0096959289   4.2840519e-13  0              2.0686154e-06  2.6109412e-16  0              2.9974257    
   2100000   162.3          200            200            0.0034367019   0.00061417956  0              0.009695926    1.8285145e-14  0              8.8292422e-08  2.6109412e-16  0              2.9974257    
   2200000   162.3          200            200            0.0034367015   0.00061417955  0              0.0096959249   9.5396879e-17  0              4.6063739e-10  2.6109412e-16  0              2.9974257    
   2300000   162.3          200            200            0.0034367014   0.00061417955  0              0.0096959245   1.2437829e-16  0              6.0057823e-10  2.6109412e-16  0              2.9974257    
   2400000   162.3          200            200            0.0034367013   0.00061417954  0              0.0096959244   8.783846e-17   0              4.2414049e-10  2.6109412e-16  0              2.9974257    
   2500000   162.3          200            200            0.0034367013   0.00061417954  0              0.0096959243   2.9381675e-17  0              1.418736e-10   2.6109412e-16  0              2.9974257    
   2600000   162.3          200            200            0.0034367013   0.00061417954  0              0.0096959243   6.4889562e-18  0              3.1332847e-11  2.6109412e-16  0              2.9974257    
   2700000   162.3          200            200            0.0034367013   0.00061417954  0              0.0096959243   6.7104104e-19  0              3.240217e-12   2.6109412e-16  0              2.9974257    
   2800000   162.3          200            200            0.0034367013   0.00061417954  0              0.0096959243   2.3286538e-19  0              1.1244236e-12  2.6109412e-16  0              2.9974257    
   2900000   162.3          200            200            0.0034367013   0.00061417954  0              0.0096959243   4.8953554e-20  0              2.3637919e-13  2.6109412e-16  0              2.9974257    
   3000000   162.3          200            200            0.0034367013   0.00061417954  0              0.0096959243   4.8881538e-20  0              2.3603145e-13  2.6109412e-16  0              2.9974257    
Loop time of 64.0758 on 4 procs for 3000000 steps with 51 atoms

Performance: 40452063.774 ns/day, 0.000 hours/ns, 46819.518 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 0.33814    | 1.5767     | 5.1639     | 165.0 |  2.46
Neigh   | 0.08286    | 0.083427   | 0.084972   |   0.3 |  0.13
Comm    | 25.696     | 32.076     | 37.895     |  82.9 | 50.06
Output  | 0.060911   | 0.060988   | 0.061043   |   0.0 |  0.10
Modify  | 15.286     | 21.061     | 28.167     | 119.5 | 32.87
Other   |            | 9.217      |            |       | 14.39

Nlocal:          12.75 ave          51 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1
Nghost:          39.25 ave          52 max           1 min
Histogram: 1 0 0 0 0 0 0 0 0 3
Neighs:           6.75 ave          27 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1

Total # of neighbors = 27
Ave neighs/atom = 0.52941176
Neighbor list builds = 166
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 91

#variable lat0 equal 1                    #
variable lat1 equal 3+(151*0.01)+(v_ind*0.01)  # .491+(v_ind*0.001)       # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 10*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 5.42                                                               
Lattice spacing in x,y,z = 5.42 5.42 5.42

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -81.3 ${n1e1} -100 100 -100 100 units box
region box block -81.3 81.3 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -81.3 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -81.3 81.3 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-81.3 -100 -100) to (81.3 100 100)
  1 by 2 by 2 MPI processor grid
create_atoms 1 region substrate
Created 30 atoms
  using lattice units in orthogonal box = (-81.3 -100 -100) to (81.3 100 100)
  create_atoms CPU = 0.000 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 30 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 21 atoms
  using lattice units in orthogonal box = (-81.3 -100 -100) to (81.3 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  30 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  30 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  21 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  21 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
30 atoms in group substrate
group slider1 region slider1
21 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 21 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_91_*.dump id type diameter mass xu yu zu fx fy fz

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 105 130 130
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 14.77 | 18.24 | 19.39 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   162.6          200            200            0              0              0              0              0              0              0              2.6109412e-16  0              6            
    100000   162.6          200            200            0.0026168394   2.2591758e-45  0              0.0078505181   12217.768      0              5.899523e+10   2.6109412e-16  0              3.3323004    
    200000   162.6          200            200            0.0009117931   1.1104304e-41  0              0.0027353793   2898.8402      0              1.3997462e+10  2.6109412e-16  0              3.0818594    
    300000   162.6          200            200            6.2101672e-05 -4.1455934e-40  0              0.00018630502  27.614251      0              1.3333934e+08  2.6109412e-16  0              3.047917     
    400000   162.6          200            200            0.01832348     0.0060138461   0              0.048956593    56.452816      0              2.7259044e+08  2.6109412e-16  0              2.9921465    
    500000   162.6          200            200            0.0042477389   0.0018955736   0              0.010847643    39.668586      0              1.9154541e+08  2.6109412e-16  0              2.9964353    
    600000   162.6          200            200            0.0056386841   0.0016009237   0              0.015315129    0.52884853     0              2553620.3      2.6109412e-16  0              2.995808     
    700000   162.6          200            200            0.0032737982   0.0010926878   0              0.0087287068   0.57756447     0              2788852.1      2.6109412e-16  0              2.9968157    
    800000   162.6          200            200            0.003413815    0.0011068328   0              0.0091346122   0.048976239    0              236488.73      2.6109412e-16  0              2.9967418    
    900000   162.6          200            200            0.0036802848   0.0011283582   0              0.0099124962   0.0036726847   0              17734.08       2.6109412e-16  0              2.9966149    
   1000000   162.6          200            200            0.0036097939   0.0011229003   0              0.0097064815   0.0016849883   0              8136.2055      2.6109412e-16  0              2.996649     
   1100000   162.6          200            200            0.0035863989   0.0011210979   0              0.0096380988   9.4692806e-07  0              4.5723767      2.6109412e-16  0              2.9966599    
   1200000   162.6          200            200            0.0036000262   0.0011221787   0              0.0096779      3.275522e-05   0              158.16323      2.6109412e-16  0              2.9966534    
   1300000   162.6          200            200            0.003600811    0.0011222342   0              0.0096801989   7.5752596e-07  0              3.6578218      2.6109412e-16  0              2.996653     
   1400000   162.6          200            200            0.003598829    0.0011220788   0              0.0096744082   3.8693368e-07  0              1.8683642      2.6109412e-16  0              2.996654     
   1500000   162.6          200            200            0.0035990699   0.0011220985   0              0.0096751112   5.1380167e-08  0              0.24809644     2.6109412e-16  0              2.9966538    
   1600000   162.6          200            200            0.0035992959   0.0011221161   0              0.0096757717   1.9791927e-09  0              0.0095568133   2.6109412e-16  0              2.9966537    
   1700000   162.6          200            200            0.0035992238   0.0011221104   0              0.0096755609   1.4792852e-09  0              0.0071429391   2.6109412e-16  0              2.9966538    
   1800000   162.6          200            200            0.0035992058   0.001122109    0              0.0096755084   5.0944657e-13  0              2.4599352e-06  2.6109412e-16  0              2.9966538    
   1900000   162.6          200            200            0.0035992187   0.00112211     0              0.0096755462   2.5801751e-11  0              0.00012458742  2.6109412e-16  0              2.9966538    
   2000000   162.6          200            200            0.0035992189   0.00112211     0              0.0096755467   9.7195187e-13  0              4.6932077e-06  2.6109412e-16  0              2.9966538    
   2100000   162.6          200            200            0.0035992171   0.0011221099   0              0.0096755415   2.6498457e-13  0              1.2795157e-06  2.6109412e-16  0              2.9966538    
   2200000   162.6          200            200            0.0035992174   0.0011221099   0              0.0096755423   4.9979413e-14  0              2.413327e-07   2.6109412e-16  0              2.9966538    
   2300000   162.6          200            200            0.0035992176   0.0011221099   0              0.0096755429   9.3441558e-16  0              4.5119584e-09  2.6109412e-16  0              2.9966538    
   2400000   162.6          200            200            0.0035992175   0.0011221099   0              0.0096755426   1.2663514e-15  0              6.1147579e-09  2.6109412e-16  0              2.9966538    
   2500000   162.6          200            200            0.0035992175   0.0011221099   0              0.0096755426   4.737831e-18   0              2.287729e-11   2.6109412e-16  0              2.9966538    
   2600000   162.6          200            200            0.0035992175   0.0011221099   0              0.0096755426   1.9338248e-17  0              9.3377479e-11  2.6109412e-16  0              2.9966538    
   2700000   162.6          200            200            0.0035992175   0.0011221099   0              0.0096755426   2.0223985e-18  0              9.7654386e-12  2.6109412e-16  0              2.9966538    
   2800000   162.6          200            200            0.0035992175   0.0011221099   0              0.0096755426   9.1725438e-20  0              4.4290931e-13  2.6109412e-16  0              2.9966538    
   2900000   162.6          200            200            0.0035992175   0.0011221099   0              0.0096755426   8.4490115e-22  0              4.0797253e-15  2.6109412e-16  0              2.9966538    
   3000000   162.6          200            200            0.0035992175   0.0011221099   0              0.0096755426   1.515738e-19   0              7.3189561e-13  2.6109412e-16  0              2.9966538    
Loop time of 64.0752 on 4 procs for 3000000 steps with 51 atoms

Performance: 40452447.336 ns/day, 0.000 hours/ns, 46819.962 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 0.32553    | 1.6146     | 5.3299     | 168.9 |  2.52
Neigh   | 0.082828   | 0.083825   | 0.085491   |   0.4 |  0.13
Comm    | 25.743     | 32.144     | 37.927     |  82.4 | 50.17
Output  | 0.062557   | 0.062632   | 0.062681   |   0.0 |  0.10
Modify  | 15.309     | 21.055     | 28.215     | 119.7 | 32.86
Other   |            | 9.115      |            |       | 14.23

Nlocal:          12.75 ave          51 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1
Nghost:          39.25 ave          52 max           1 min
Histogram: 1 0 0 0 0 0 0 0 0 3
Neighs:           6.75 ave          27 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1

Total # of neighbors = 27
Ave neighs/atom = 0.52941176
Neighbor list builds = 166
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 92

#variable lat0 equal 1                    #
variable lat1 equal 3+(151*0.01)+(v_ind*0.01)  # .491+(v_ind*0.001)       # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 10*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 5.43                                                               
Lattice spacing in x,y,z = 5.43 5.43 5.43

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -81.45 ${n1e1} -100 100 -100 100 units box
region box block -81.45 81.45 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -81.45 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -81.45 81.45 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-81.45 -100 -100) to (81.45 100 100)
  1 by 2 by 2 MPI processor grid
create_atoms 1 region substrate
Created 30 atoms
  using lattice units in orthogonal box = (-81.45 -100 -100) to (81.45 100 100)
  create_atoms CPU = 0.000 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 30 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 21 atoms
  using lattice units in orthogonal box = (-81.45 -100 -100) to (81.45 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  30 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  30 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  21 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  21 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
30 atoms in group substrate
group slider1 region slider1
21 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 21 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_92_*.dump id type diameter mass xu yu zu fx fy fz

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 106 130 130
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 14.79 | 18.26 | 19.41 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   162.9          200            200            0              0              0              0              0              0              0              2.6109412e-16  0              6            
    100000   162.9          200            200            0.0026099562   4.6182715e-42  0              0.0078298685   12205.459      0              5.8935795e+10  2.6109412e-16  0              3.3320108    
    200000   162.9          200            200            0.00090809733  1.1822957e-40  0              0.002724292    2889.9864      0              1.395471e+10   2.6109412e-16  0              3.080989     
    300000   162.9          200            200            5.8868233e-05  4.1617919e-38  0              0.0001766047   25.034788      0              1.2088403e+08  2.6109412e-16  0              3.0467744    
    400000   162.9          200            200            0.0094265992   0.0032228093   0              0.025056988    188.08221      0              9.0818168e+08  2.6109412e-16  0              2.9933901    
    500000   162.9          200            200            0.00046824089 -2.4274778e-38  0              0.0014047227   2.8590624      0              13805389       2.6109412e-16  0              2.9986425    
    600000   162.9          200            200            0.0036715671   0.00050405449  0              0.010510647    4.9259128      0              23785470       2.6109412e-16  0              2.9954182    
    700000   162.9          200            200            0.00282835     0.00024951299  0              0.0082355371   0.22884677     0              1105019.1      2.6109412e-16  0              2.9958518    
    800000   162.9          200            200            0.0033002579   0.00046003676  0              0.0094407369   0.080246566    0              387481.95      2.6109412e-16  0              2.9956041    
    900000   162.9          200            200            0.0033761968   0.00045619927  0              0.0096723913   0.01200985     0              57991.266      2.6109412e-16  0              2.9955604    
   1000000   162.9          200            200            0.0033833184   0.00045678892  0              0.0096931663   0.0013094621   0              6322.9238      2.6109412e-16  0              2.9955568    
   1100000   162.9          200            200            0.0033781683   0.00045627684  0              0.009678228    9.9126007e-05  0              478.64401      2.6109412e-16  0              2.9955599    
   1200000   162.9          200            200            0.0033737425   0.00045584883  0              0.0096653787   3.7172182e-06  0              17.949116      2.6109412e-16  0              2.9955624    
   1300000   162.9          200            200            0.0033714129   0.00045562469  0              0.0096586139   6.5319767e-10  0              0.0031540578   2.6109412e-16  0              2.9955637    
   1400000   162.9          200            200            0.0033704158   0.00045552913  0              0.0096557181   7.7473928e-08  0              0.37409387     2.6109412e-16  0              2.9955643    
   1500000   162.9          200            200            0.0033700477   0.00045549402  0              0.0096546492   3.507121e-08   0              0.16934632     2.6109412e-16  0              2.9955645    
   1600000   162.9          200            200            0.0033699305   0.0004554829   0              0.0096543085   8.2203569e-09  0              0.039693161    2.6109412e-16  0              2.9955645    
   1700000   162.9          200            200            0.0033698999   0.00045548003  0              0.0096542197   1.3533918e-09  0              0.0065350446   2.6109412e-16  0              2.9955646    
   1800000   162.9          200            200            0.0033698948   0.00045547957  0              0.0096542049   1.674656e-10   0              0.00080863147  2.6109412e-16  0              2.9955646    
   1900000   162.9          200            200            0.0033698955   0.00045547965  0              0.0096542068   1.5128927e-11  0              7.3052176e-05  2.6109412e-16  0              2.9955646    
   2000000   162.9          200            200            0.0033698966   0.00045547976  0              0.0096542101   8.3599624e-13  0              4.0367267e-06  2.6109412e-16  0              2.9955646    
   2100000   162.9          200            200            0.0033698973   0.00045547983  0              0.0096542121   1.0050809e-14  0              4.853176e-08   2.6109412e-16  0              2.9955646    
   2200000   162.9          200            200            0.0033698976   0.00045547986  0              0.0096542131   3.0288662e-15  0              1.4625311e-08  2.6109412e-16  0              2.9955646    
   2300000   162.9          200            200            0.0033698978   0.00045547987  0              0.0096542134   2.6449657e-15  0              1.2771593e-08  2.6109412e-16  0              2.9955646    
   2400000   162.9          200            200            0.0033698978   0.00045547987  0              0.0096542135   7.7224857e-16  0              3.728912e-09   2.6109412e-16  0              2.9955646    
   2500000   162.9          200            200            0.0033698978   0.00045547987  0              0.0096542136   1.4517281e-16  0              7.0098754e-10  2.6109412e-16  0              2.9955646    
   2600000   162.9          200            200            0.0033698978   0.00045547987  0              0.0096542136   2.0394221e-17  0              9.8476394e-11  2.6109412e-16  0              2.9955646    
   2700000   162.9          200            200            0.0033698978   0.00045547987  0              0.0096542136   1.4537152e-18  0              7.0194702e-12  2.6109412e-16  0              2.9955646    
   2800000   162.9          200            200            0.0033698978   0.00045547987  0              0.0096542136   1.7357911e-21  0              8.381514e-15   2.6109412e-16  0              2.9955646    
   2900000   162.9          200            200            0.0033698978   0.00045547987  0              0.0096542136   1.5965568e-19  0              7.7092014e-13  2.6109412e-16  0              2.9955646    
   3000000   162.9          200            200            0.0033698978   0.00045547987  0              0.0096542136   9.9300756e-20  0              4.7948781e-13  2.6109412e-16  0              2.9955646    
Loop time of 63.9442 on 4 procs for 3000000 steps with 51 atoms

Performance: 40535318.053 ns/day, 0.000 hours/ns, 46915.877 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 0.32567    | 1.6058     | 5.289      | 167.9 |  2.51
Neigh   | 0.082544   | 0.0832     | 0.084687   |   0.3 |  0.13
Comm    | 25.73      | 32.1       | 37.873     |  82.3 | 50.20
Output  | 0.06012    | 0.060199   | 0.060256   |   0.0 |  0.09
Modify  | 15.2       | 20.95      | 28.036     | 119.2 | 32.76
Other   |            | 9.145      |            |       | 14.30

Nlocal:          12.75 ave          51 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1
Nghost:          39.25 ave          52 max           1 min
Histogram: 1 0 0 0 0 0 0 0 0 3
Neighs:           6.75 ave          27 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1

Total # of neighbors = 27
Ave neighs/atom = 0.52941176
Neighbor list builds = 164
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 93

#variable lat0 equal 1                    #
variable lat1 equal 3+(151*0.01)+(v_ind*0.01)  # .491+(v_ind*0.001)       # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 10*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 5.44                                                               
Lattice spacing in x,y,z = 5.44 5.44 5.44

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -81.6 ${n1e1} -100 100 -100 100 units box
region box block -81.6 81.6 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -81.6 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -81.6 81.6 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-81.6 -100 -100) to (81.6 100 100)
  1 by 2 by 2 MPI processor grid
create_atoms 1 region substrate
Created 29 atoms
  using lattice units in orthogonal box = (-81.6 -100 -100) to (81.6 100 100)
  create_atoms CPU = 0.000 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 30 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 21 atoms
  using lattice units in orthogonal box = (-81.6 -100 -100) to (81.6 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  29 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  29 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  21 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  21 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
29 atoms in group substrate
group slider1 region slider1
21 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 21 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_93_*.dump id type diameter mass xu yu zu fx fy fz

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 106 130 130
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 14.79 | 18.26 | 19.41 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   163.2          200            200            0              0              0              0              0              0              0              2.6109412e-16  0              6            
    100000   163.2          200            200            0.0026022111   9.2535332e-47  0              0.0078066333   12187.241      0              6.5386475e+10  2.6109412e-16  0              3.331833     
    200000   163.2          200            200            0.00090171707 -3.7761725e-39  0              0.0027051512   2867.7718      0              1.5386049e+10  2.6109412e-16  0              3.0805433    
    300000   163.2          200            200            4.6032886e-05  3.0268806e-38  0              0.00013809866  15.667235      0              84057189       2.6109412e-16  0              3.045732     
    400000   163.2          200            200            0.00013376416  3.6444647e-37  0              0.00040129249  120.36456      0              6.4577489e+08  2.6109412e-16  0              3.0012498    
    500000   163.2          200            200            0.0059438393   0.00019736545  0              0.017634152    11.33604       0              60819646       2.6109412e-16  0              2.9929729    
    600000   163.2          200            200            0.0036770139  -4.1435857e-36  0              0.011031042    3.3433377      0              17937535       2.6109412e-16  0              2.9947825    
    700000   163.2          200            200            0.0032972604   4.1686515e-37  0              0.0098917811   0.51990583     0              2789376.9      2.6109412e-16  0              2.9951383    
    800000   163.2          200            200            0.003221662    2.6141169e-38  0              0.0096649859   0.073038356    0              391862.31      2.6109412e-16  0              2.9952082    
    900000   163.2          200            200            0.0032077601  -5.4002123e-39  0              0.0096232803   0.0098467183   0              52829.198      2.6109412e-16  0              2.9952201    
   1000000   163.2          200            200            0.0032075037  -3.5313874e-39  0              0.0096225112   0.0012765119   0              6848.6878      2.6109412e-16  0              2.9952197    
   1100000   163.2          200            200            0.0032092045   6.030396e-39   0              0.0096276135   0.00015877551  0              851.85569      2.6109412e-16  0              2.9952177    
   1200000   163.2          200            200            0.003210482    1.745399e-39   0              0.0096314461   1.8875116e-05  0              101.26798      2.6109412e-16  0              2.9952164    
   1300000   163.2          200            200            0.0032111832   5.5200802e-39  0              0.0096335495   2.1309932e-06  0              11.433115      2.6109412e-16  0              2.9952156    
   1400000   163.2          200            200            0.0032115212  -3.4208705e-40  0              0.0096345635   2.2612442e-07  0              1.2131932      2.6109412e-16  0              2.9952153    
   1500000   163.2          200            200            0.0032116725   1.3128769e-39  0              0.0096350176   2.2163147e-08  0              0.11890878     2.6109412e-16  0              2.9952151    
   1600000   163.2          200            200            0.0032117371   3.0304918e-39  0              0.0096352112   1.9451105e-09  0              0.010435825    2.6109412e-16  0              2.9952151    
   1700000   163.2          200            200            0.0032117636   7.1272204e-39  0              0.0096352908   1.4359564e-10  0              0.0007704133   2.6109412e-16  0              2.995215     
   1800000   163.2          200            200            0.0032117742   8.6884341e-40  0              0.0096353225   7.6257516e-12  0              4.0913362e-05  2.6109412e-16  0              2.995215     
   1900000   163.2          200            200            0.0032117783  -6.4274421e-40  0              0.0096353349   1.5218147e-13  0              8.1647762e-07  2.6109412e-16  0              2.995215     
   2000000   163.2          200            200            0.0032117799  -1.18174e-39    0              0.0096353396   8.0216221e-15  0              4.3037269e-08  2.6109412e-16  0              2.995215     
   2100000   163.2          200            200            0.0032117805  -2.1626381e-39  0              0.0096353414   1.3925042e-14  0              7.4710047e-08  2.6109412e-16  0              2.995215     
   2200000   163.2          200            200            0.0032117807  -2.1672632e-39  0              0.0096353421   5.4549087e-15  0              2.9266446e-08  2.6109412e-16  0              2.995215     
   2300000   163.2          200            200            0.0032117808   1.1669579e-39  0              0.0096353423   1.4256049e-15  0              7.6485955e-09  2.6109412e-16  0              2.995215     
   2400000   163.2          200            200            0.0032117808   2.8985667e-40  0              0.0096353424   3.0898418e-16  0              1.6577489e-09  2.6109412e-16  0              2.995215     
   2500000   163.2          200            200            0.0032117808  -1.9635764e-39  0              0.0096353424   5.9926171e-17  0              3.2151337e-10  2.6109412e-16  0              2.995215     
   2600000   163.2          200            200            0.0032117808  -8.6999814e-40  0              0.0096353424   1.0617427e-17  0              5.696417e-11   2.6109412e-16  0              2.995215     
   2700000   163.2          200            200            0.0032117808   2.1576208e-39  0              0.0096353424   1.588806e-18   0              8.5241953e-12  2.6109412e-16  0              2.995215     
   2800000   163.2          200            200            0.0032117808   4.2904152e-39  0              0.0096353424   2.8200465e-19  0              1.5129995e-12  2.6109412e-16  0              2.995215     
   2900000   163.2          200            200            0.0032117808   1.7556861e-39  0              0.0096353424   4.8740678e-20  0              2.6150144e-13  2.6109412e-16  0              2.995215     
   3000000   163.2          200            200            0.0032117808  -3.0824524e-39  0              0.0096353424   1.1770335e-20  0              6.3149706e-14  2.6109412e-16  0              2.995215     
Loop time of 62.8406 on 4 procs for 3000000 steps with 50 atoms

Performance: 41247219.022 ns/day, 0.000 hours/ns, 47739.837 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 0.31686    | 1.4796     | 4.8206     | 158.6 |  2.35
Neigh   | 0.08256    | 0.083113   | 0.084637   |   0.3 |  0.13
Comm    | 25.188     | 31.44      | 37.012     |  81.9 | 50.03
Output  | 0.061544   | 0.061617   | 0.061669   |   0.0 |  0.10
Modify  | 14.995     | 20.667     | 27.535     | 117.2 | 32.89
Other   |            | 9.109      |            |       | 14.50

Nlocal:           12.5 ave          50 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1
Nghost:           37.5 ave          50 max           0 min
Histogram: 1 0 0 0 0 0 0 0 0 3
Neighs:           6.75 ave          27 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1

Total # of neighbors = 27
Ave neighs/atom = 0.54
Neighbor list builds = 164
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 94

#variable lat0 equal 1                    #
variable lat1 equal 3+(151*0.01)+(v_ind*0.01)  # .491+(v_ind*0.001)       # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 10*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 5.45                                                               
Lattice spacing in x,y,z = 5.45 5.45 5.45

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -81.75 ${n1e1} -100 100 -100 100 units box
region box block -81.75 81.75 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -81.75 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -81.75 81.75 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-81.75 -100 -100) to (81.75 100 100)
  1 by 2 by 2 MPI processor grid
create_atoms 1 region substrate
Created 30 atoms
  using lattice units in orthogonal box = (-81.75 -100 -100) to (81.75 100 100)
  create_atoms CPU = 0.000 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 30 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 21 atoms
  using lattice units in orthogonal box = (-81.75 -100 -100) to (81.75 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  30 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  30 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  21 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  21 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
30 atoms in group substrate
group slider1 region slider1
21 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 21 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_94_*.dump id type diameter mass xu yu zu fx fy fz

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 106 130 130
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 14.79 | 18.26 | 19.41 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   163.5          200            200            0              0              0              0              0              0              0              2.6109412e-16  0              6            
    100000   163.5          200            200            0.0025936554   8.2456084e-40  0              0.0077809663   12163.238      0              5.8731925e+10  2.6109412e-16  0              3.3318355    
    200000   163.5          200            200            0.00089158265  2.262968e-38   0              0.0026747479   2826.6357      0              1.3648812e+10  2.6109412e-16  0              3.0809944    
    300000   163.5          200            200            1.7708229e-05 -7.2101851e-37  0              5.3124687e-05  2.4402751      0              11783215       2.6109412e-16  0              3.0449014    
    400000   163.5          200            200           -2.8848888e-05 -9.2553854e-37  0             -8.6546663e-05  7.0988401      0              34277758       2.6109412e-16  0              3.0060198    
    500000   163.5          200            200            0.0061903703   1.5040374e-36  0              0.018571111    4.7730569      0              23047383       2.6109412e-16  0              2.9925956    
    600000   163.5          200            200            0.0035046591  -1.0115993e-35  0              0.010513977    3.7582806      0              18147392       2.6109412e-16  0              2.9949429    
    700000   163.5          200            200            0.0032284556  -1.0883978e-37  0              0.0096853669   0.54384415     0              2626028.8      2.6109412e-16  0              2.9952007    
    800000   163.5          200            200            0.0031925052  -1.3594307e-37  0              0.0095775156   0.073026516    0              352618.91      2.6109412e-16  0              2.9952313    
    900000   163.5          200            200            0.0031933981  -1.3209864e-37  0              0.0095801942   0.0094254569   0              45512.158      2.6109412e-16  0              2.9952285    
   1000000   163.5          200            200            0.0031985859  -1.0874014e-38  0              0.0095957576   0.001167204    0              5636.0102      2.6109412e-16  0              2.9952227    
   1100000   163.5          200            200            0.0032022539  -1.2827447e-39  0              0.0096067617   0.00013807124  0              666.6966       2.6109412e-16  0              2.9952188    
   1200000   163.5          200            200            0.0032042279   1.5166937e-38  0              0.0096126837   1.5496696e-05  0              74.828         2.6109412e-16  0              2.9952167    
   1300000   163.5          200            200            0.0032051702  -3.3977886e-40  0              0.0096155105   1.6323194e-06  0              7.8818863      2.6109412e-16  0              2.9952157    
   1400000   163.5          200            200            0.0032055896   8.6413511e-39  0              0.0096167687   1.5841981e-07  0              0.76495255     2.6109412e-16  0              2.9952153    
   1500000   163.5          200            200            0.0032057676   2.0773794e-39  0              0.0096173027   1.3703488e-08  0              0.066169241    2.6109412e-16  0              2.9952151    
   1600000   163.5          200            200            0.0032058405  -1.346141e-39   0              0.0096175215   9.8706007e-10  0              0.0047661598   2.6109412e-16  0              2.9952151    
   1700000   163.5          200            200            0.0032058695  -5.5290724e-39  0              0.0096176086   4.9649907e-11  0              0.00023974163  2.6109412e-16  0              2.995215     
   1800000   163.5          200            200            0.0032058808  -1.9445395e-39  0              0.0096176425   7.7727863e-13  0              3.7532003e-06  2.6109412e-16  0              2.995215     
   1900000   163.5          200            200            0.0032058851  -7.5899167e-39  0              0.0096176554   9.6856742e-14  0              4.6768654e-07  2.6109412e-16  0              2.995215     
   2000000   163.5          200            200            0.0032058867   4.8886807e-39  0              0.0096176602   1.1971865e-13  0              5.7807852e-07  2.6109412e-16  0              2.995215     
   2100000   163.5          200            200            0.0032058873   1.6649946e-38  0              0.0096176619   4.4092182e-14  0              2.1290537e-07  2.6109412e-16  0              2.995215     
   2200000   163.5          200            200            0.0032058875  -5.579713e-40   0              0.0096176625   1.125904e-14   0              5.4365872e-08  2.6109412e-16  0              2.995215     
   2300000   163.5          200            200            0.0032058876  -1.939056e-38   0              0.0096176628   2.3882089e-15  0              1.1531806e-08  2.6109412e-16  0              2.995215     
   2400000   163.5          200            200            0.0032058876  -3.0766759e-39  0              0.0096176628   4.5515633e-16  0              2.197787e-09   2.6109412e-16  0              2.995215     
   2500000   163.5          200            200            0.0032058876  -3.425211e-39   0              0.0096176629   7.8998559e-17  0              3.8145577e-10  2.6109412e-16  0              2.995215     
   2600000   163.5          200            200            0.0032058876  -9.5800499e-39  0              0.0096176629   1.2981891e-17  0              6.2684908e-11  2.6109412e-16  0              2.995215     
   2700000   163.5          200            200            0.0032058876   1.1051284e-39  0              0.0096176629   1.8996722e-18  0              9.172837e-12   2.6109412e-16  0              2.995215     
   2800000   163.5          200            200            0.0032058876   1.0276929e-38  0              0.0096176629   3.0097253e-19  0              1.4532886e-12  2.6109412e-16  0              2.995215     
   2900000   163.5          200            200            0.0032058876   1.0423936e-38  0              0.0096176629   1.7116968e-20  0              8.2651713e-14  2.6109412e-16  0              2.995215     
   3000000   163.5          200            200            0.0032058876   7.2297002e-39  0              0.0096176629   4.9146091e-20  0              2.3730888e-13  2.6109412e-16  0              2.995215     
Loop time of 64.1246 on 4 procs for 3000000 steps with 51 atoms

Performance: 40421327.657 ns/day, 0.000 hours/ns, 46783.944 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 0.3261     | 1.5386     | 5.0168     | 162.0 |  2.40
Neigh   | 0.083582   | 0.084158   | 0.085716   |   0.3 |  0.13
Comm    | 25.733     | 32.257     | 37.938     |  83.5 | 50.30
Output  | 0.060628   | 0.060705   | 0.060759   |   0.0 |  0.09
Modify  | 15.34      | 21.052     | 28.194     | 119.4 | 32.83
Other   |            | 9.132      |            |       | 14.24

Nlocal:          12.75 ave          51 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1
Nghost:          39.25 ave          52 max           1 min
Histogram: 1 0 0 0 0 0 0 0 0 3
Neighs:           6.25 ave          25 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1

Total # of neighbors = 25
Ave neighs/atom = 0.49019608
Neighbor list builds = 166
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 95

#variable lat0 equal 1                    #
variable lat1 equal 3+(151*0.01)+(v_ind*0.01)  # .491+(v_ind*0.001)       # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 10*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 5.46                                                               
Lattice spacing in x,y,z = 5.46 5.46 5.46

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -81.9 ${n1e1} -100 100 -100 100 units box
region box block -81.9 81.9 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -81.9 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -81.9 81.9 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-81.9 -100 -100) to (81.9 100 100)
  1 by 2 by 2 MPI processor grid
create_atoms 1 region substrate
Created 30 atoms
  using lattice units in orthogonal box = (-81.9 -100 -100) to (81.9 100 100)
  create_atoms CPU = 0.000 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 30 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 21 atoms
  using lattice units in orthogonal box = (-81.9 -100 -100) to (81.9 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  30 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  30 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  21 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  21 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
30 atoms in group substrate
group slider1 region slider1
21 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 21 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_95_*.dump id type diameter mass xu yu zu fx fy fz

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 106 130 130
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 14.79 | 18.26 | 19.41 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   163.8          200            200            0              0              0              0              0              0              0              2.6109412e-16  0              6            
    100000   163.8          200            200            0.0025848582  -9.4056448e-40  0              0.0077545746   12137.595      0              5.8608104e+10  2.6109412e-16  0              3.3318047    
    200000   163.8          200            200            0.00087687722  6.0565232e-38  0              0.0026306317   2762.4221      0              1.3338748e+10  2.6109412e-16  0              3.0827697    
    300000   163.8          200            200           -2.8940224e-05  3.3242105e-38  0             -8.6820673e-05  6.9870472      0              33737951       2.6109412e-16  0              3.0435511    
    400000   163.8          200            200            0.0013075354  -1.0096759e-35  0              0.0039226061   181.97735      0              8.787035e+08   2.6109412e-16  0              2.9971943    
    500000   163.8          200            200            0.0019428203   1.8886622e-36  0              0.0058284608   23.587987      0              1.1389795e+08  2.6109412e-16  0              2.9966363    
    600000   163.8          200            200            0.0021828336   7.1842938e-36  0              0.0065485008   0.33722809     0              1628353.8      2.6109412e-16  0              2.9963003    
    700000   163.8          200            200            0.0027984724   2.4751903e-36  0              0.0083954173   0.0023258426   0              11230.662      2.6109412e-16  0              2.9956251    
    800000   163.8          200            200            0.003050921    1.2249088e-36  0              0.009152763    0.00055999026  0              2703.9926      2.6109412e-16  0              2.9953647    
    900000   163.8          200            200            0.0031461416  -1.0236513e-37  0              0.0094384247   0.00051764536  0              2499.5242      2.6109412e-16  0              2.9952687    
   1000000   163.8          200            200            0.0031809902  -3.5278053e-37  0              0.0095429706   0.00017738868  0              856.54645      2.6109412e-16  0              2.9952339    
   1100000   163.8          200            200            0.0031934522   2.1211117e-37  0              0.0095803565   4.3822459e-05  0              211.60297      2.6109412e-16  0              2.9952215    
   1200000   163.8          200            200            0.0031978096  -6.1516978e-38  0              0.0095934289   9.1186716e-06  0              44.030802      2.6109412e-16  0              2.9952172    
   1300000   163.8          200            200            0.003199297   -9.365075e-39   0              0.0095978911   1.7002932e-06  0              8.2101072      2.6109412e-16  0              2.9952157    
   1400000   163.8          200            200            0.0031997908  -3.8564861e-39  0              0.0095993725   2.9297902e-07  0              1.4146909      2.6109412e-16  0              2.9952152    
   1500000   163.8          200            200            0.0031999493   4.1134801e-39  0              0.0095998478   4.7463077e-08  0              0.22918221     2.6109412e-16  0              2.9952151    
   1600000   163.8          200            200            0.0031999979   8.2885277e-39  0              0.0095999936   7.3039208e-09  0              0.035268019    2.6109412e-16  0              2.995215     
   1700000   163.8          200            200            0.0032000118   5.0846212e-39  0              0.0096000355   1.0743899e-09  0              0.0051878442   2.6109412e-16  0              2.995215     
   1800000   163.8          200            200            0.0032000154  -8.625904e-39   0              0.0096000463   1.5161975e-10  0              0.00073211752  2.6109412e-16  0              2.995215     
   1900000   163.8          200            200            0.0032000162  -3.1154254e-39  0              0.0096000485   2.0562746e-11  0              9.9290143e-05  2.6109412e-16  0              2.995215     
   2000000   163.8          200            200            0.0032000162   9.1627957e-40  0              0.0096000486   2.6804445e-12  0              1.2942907e-05  2.6109412e-16  0              2.995215     
   2100000   163.8          200            200            0.0032000161  -2.1389193e-39  0              0.0096000484   3.3528644e-13  0              1.6189782e-06  2.6109412e-16  0              2.995215     
   2200000   163.8          200            200            0.0032000161   2.7255775e-38  0              0.0096000483   4.0111895e-14  0              1.9368599e-07  2.6109412e-16  0              2.995215     
   2300000   163.8          200            200            0.0032000161   6.3597878e-39  0              0.0096000482   4.5585245e-15  0              2.2011483e-08  2.6109412e-16  0              2.995215     
   2400000   163.8          200            200            0.003200016    1.054316e-39   0              0.0096000481   4.8808612e-16  0              2.3567932e-09  2.6109412e-16  0              2.995215     
   2500000   163.8          200            200            0.003200016   -1.7896632e-39  0              0.0096000481   4.7470852e-17  0              2.2921976e-10  2.6109412e-16  0              2.995215     
   2600000   163.8          200            200            0.003200016   -2.1292016e-39  0              0.0096000481   3.7500361e-18  0              1.8107582e-11  2.6109412e-16  0              2.995215     
   2700000   163.8          200            200            0.003200016   -2.81371e-38    0              0.0096000481   3.3636233e-19  0              1.6241733e-12  2.6109412e-16  0              2.995215     
   2800000   163.8          200            200            0.003200016    1.053608e-38   0              0.0096000481   5.0155852e-22  0              2.4218466e-15  2.6109412e-16  0              2.995215     
   2900000   163.8          200            200            0.003200016    1.4237075e-38  0              0.0096000481   8.8336553e-20  0              4.265456e-13   2.6109412e-16  0              2.995215     
   3000000   163.8          200            200            0.003200016    5.5978648e-39  0              0.0096000481   2.5461152e-20  0              1.2294279e-13  2.6109412e-16  0              2.995215     
Loop time of 63.9625 on 4 procs for 3000000 steps with 51 atoms

Performance: 40523750.087 ns/day, 0.000 hours/ns, 46902.489 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 0.32184    | 1.567      | 5.1175     | 163.8 |  2.45
Neigh   | 0.08366    | 0.084222   | 0.08584    |   0.3 |  0.13
Comm    | 25.723     | 32.163     | 37.837     |  82.7 | 50.28
Output  | 0.06315    | 0.063225   | 0.063279   |   0.0 |  0.10
Modify  | 15.211     | 20.942     | 28.014     | 119.0 | 32.74
Other   |            | 9.143      |            |       | 14.29

Nlocal:          12.75 ave          51 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1
Nghost:          39.25 ave          52 max           1 min
Histogram: 1 0 0 0 0 0 0 0 0 3
Neighs:           6.25 ave          25 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1

Total # of neighbors = 25
Ave neighs/atom = 0.49019608
Neighbor list builds = 166
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 96

#variable lat0 equal 1                    #
variable lat1 equal 3+(151*0.01)+(v_ind*0.01)  # .491+(v_ind*0.001)       # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 10*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 5.47                                                               
Lattice spacing in x,y,z = 5.47 5.47 5.47

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -82.05 ${n1e1} -100 100 -100 100 units box
region box block -82.05 82.05 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -82.05 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -82.05 82.05 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-82.05 -100 -100) to (82.05 100 100)
  1 by 2 by 2 MPI processor grid
create_atoms 1 region substrate
Created 30 atoms
  using lattice units in orthogonal box = (-82.05 -100 -100) to (82.05 100 100)
  create_atoms CPU = 0.000 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 30 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 21 atoms
  using lattice units in orthogonal box = (-82.05 -100 -100) to (82.05 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  30 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  30 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  21 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  21 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
30 atoms in group substrate
group slider1 region slider1
21 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 21 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_96_*.dump id type diameter mass xu yu zu fx fy fz

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 106 130 130
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 14.79 | 18.26 | 19.41 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   164.1          200            200            0              0              0              0              0              0              0              2.6109412e-16  0              6            
    100000   164.1          200            200            0.0025759356  -1.8777005e-39  0              0.0077278069   12110.742      0              5.8478439e+10  2.6109412e-16  0              3.3318584    
    200000   164.1          200            200            0.00085625753 -2.3447267e-37  0              0.0025687726   2668.5992      0              1.2885711e+10  2.6109412e-16  0              3.0864626    
    300000   164.1          200            200           -7.9149573e-05 -4.2497258e-37  0             -0.00023744872  57.955856      0              2.7984809e+08  2.6109412e-16  0              3.0405777    
    400000   164.1          200            200            0.0068651743   2.5764005e-35  0              0.020595523    158.05243      0              7.6317861e+08  2.6109412e-16  0              2.9919309    
    500000   164.1          200            200            0.00095712214  2.1658393e-35  0              0.0028713664   8.5825127      0              41441882       2.6109412e-16  0              2.9979082    
    600000   164.1          200            200            0.0021618665  -1.263541e-36   0              0.0064855996   0.26934275     0              1300559.8      2.6109412e-16  0              2.9963058    
    700000   164.1          200            200            0.0028389172   9.9962459e-37  0              0.0085167516   0.12788216     0              617497.16      2.6109412e-16  0              2.995573     
    800000   164.1          200            200            0.0030751067  -1.0364104e-36  0              0.0092253201   0.028016948    0              135283.81      2.6109412e-16  0              2.9953329    
    900000   164.1          200            200            0.0031555032  -1.0649387e-37  0              0.0094665095   0.0052269277   0              25238.963      2.6109412e-16  0              2.9952529    
   1000000   164.1          200            200            0.0031821179   4.5660603e-37  0              0.0095463537   0.00089599727  0              4326.4501      2.6109412e-16  0              2.9952267    
   1100000   164.1          200            200            0.0031906215  -5.6562114e-38  0              0.0095718644   0.0001443591   0              697.05843      2.6109412e-16  0              2.9952184    
   1200000   164.1          200            200            0.0031932141  -5.3371331e-39  0              0.0095796422   2.2102354e-05  0              106.72436      2.6109412e-16  0              2.9952159    
   1300000   164.1          200            200            0.0031939521  -6.7724989e-38  0              0.0095818564   3.23598e-06    0              15.625389      2.6109412e-16  0              2.9952152    
   1400000   164.1          200            200            0.003194139    1.4266017e-38  0              0.0095824169   4.5464076e-07  0              2.1952975      2.6109412e-16  0              2.995215     
   1500000   164.1          200            200            0.0031941752  -8.2649709e-39  0              0.0095825256   6.1390793e-08  0              0.29643417     2.6109412e-16  0              2.995215     
   1600000   164.1          200            200            0.0031941763   1.883223e-39   0              0.009582529    7.9666549e-09  0              0.038468125    2.6109412e-16  0              2.995215     
   1700000   164.1          200            200            0.0031941722  -1.3429858e-38  0              0.0095825167   9.9184e-10     0              0.0047892404   2.6109412e-16  0              2.995215     
   1800000   164.1          200            200            0.0031941691   7.3297304e-39  0              0.0095825074   1.1803598e-10  0              0.00056995349  2.6109412e-16  0              2.995215     
   1900000   164.1          200            200            0.0031941674  -1.6372414e-38  0              0.0095825022   1.3343688e-11  0              6.4431896e-05  2.6109412e-16  0              2.995215     
   2000000   164.1          200            200            0.0031941666   1.6844492e-38  0              0.0095824997   1.4181388e-12  0              6.8476849e-06  2.6109412e-16  0              2.995215     
   2100000   164.1          200            200            0.0031941662   4.3203361e-38  0              0.0095824986   1.3931223e-13  0              6.7268892e-07  2.6109412e-16  0              2.995215     
   2200000   164.1          200            200            0.003194166   -1.7999683e-38  0              0.0095824981   1.2277263e-14  0              5.928251e-08   2.6109412e-16  0              2.995215     
   2300000   164.1          200            200            0.003194166    2.8581746e-38  0              0.0095824979   9.1301754e-16  0              4.408635e-09   2.6109412e-16  0              2.995215     
   2400000   164.1          200            200            0.0031941659  -1.0226902e-39  0              0.0095824978   4.716194e-17   0              2.2772813e-10  2.6109412e-16  0              2.995215     
   2500000   164.1          200            200            0.0031941659   2.2815523e-38  0              0.0095824978   8.569282e-19   0              4.1377996e-12  2.6109412e-16  0              2.995215     
   2600000   164.1          200            200            0.0031941659  -1.2415477e-39  0              0.0095824978   1.1873661e-19  0              5.733366e-13   2.6109412e-16  0              2.995215     
   2700000   164.1          200            200            0.0031941659  -1.8668913e-38  0              0.0095824978   7.2560515e-20  0              3.5036876e-13  2.6109412e-16  0              2.995215     
   2800000   164.1          200            200            0.0031941659   8.1632197e-39  0              0.0095824978   5.4558596e-20  0              2.6344394e-13  2.6109412e-16  0              2.995215     
   2900000   164.1          200            200            0.0031941659   2.487727e-38   0              0.0095824978   3.1850797e-20  0              1.537961e-13   2.6109412e-16  0              2.995215     
   3000000   164.1          200            200            0.0031941659  -2.2425622e-39  0              0.0095824978   6.5666579e-20  0              3.1708041e-13  2.6109412e-16  0              2.995215     
Loop time of 63.967 on 4 procs for 3000000 steps with 51 atoms

Performance: 40520881.035 ns/day, 0.000 hours/ns, 46899.168 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 0.31665    | 1.5786     | 5.1995     | 166.5 |  2.47
Neigh   | 0.083669   | 0.08422    | 0.08575    |   0.3 |  0.13
Comm    | 25.696     | 32.194     | 37.949     |  83.2 | 50.33
Output  | 0.061555   | 0.06163    | 0.061683   |   0.0 |  0.10
Modify  | 15.217     | 20.958     | 28.094     | 119.7 | 32.76
Other   |            | 9.09       |            |       | 14.21

Nlocal:          12.75 ave          51 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1
Nghost:          39.25 ave          52 max           1 min
Histogram: 1 0 0 0 0 0 0 0 0 3
Neighs:           6.25 ave          25 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1

Total # of neighbors = 25
Ave neighs/atom = 0.49019608
Neighbor list builds = 166
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 97

#variable lat0 equal 1                    #
variable lat1 equal 3+(151*0.01)+(v_ind*0.01)  # .491+(v_ind*0.001)       # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 10*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 5.48                                                               
Lattice spacing in x,y,z = 5.48 5.48 5.48

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -82.2 ${n1e1} -100 100 -100 100 units box
region box block -82.2 82.2 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -82.2 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -82.2 82.2 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-82.2 -100 -100) to (82.2 100 100)
  1 by 2 by 2 MPI processor grid
create_atoms 1 region substrate
Created 30 atoms
  using lattice units in orthogonal box = (-82.2 -100 -100) to (82.2 100 100)
  create_atoms CPU = 0.000 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 30 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 21 atoms
  using lattice units in orthogonal box = (-82.2 -100 -100) to (82.2 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  30 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  30 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  21 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  21 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
30 atoms in group substrate
group slider1 region slider1
21 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 21 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_97_*.dump id type diameter mass xu yu zu fx fy fz

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 107 130 130
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 14.81 | 18.27 | 19.43 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   164.4          200            200            0              0              0              0              0              0              0              2.6109412e-16  0              6            
    100000   164.4          200            200            0.002566825   -1.0492782e-37  0              0.0077004751   12081.61       0              5.8337772e+10  2.6109412e-16  0              3.3322563    
    200000   164.4          200            200            0.00082963805  1.4589872e-36  0              0.0024889142   2545.4236      0              1.229094e+10   2.6109412e-16  0              3.0922667    
    300000   164.4          200            200           -0.00010393801  5.4363629e-37  0             -0.00031181402  106.01527      0              5.1190979e+08  2.6109412e-16  0              3.0381392    
    400000   164.4          200            200            0.0096203362  -5.3147137e-36  0              0.028861009    91.277144      0              4.4074466e+08  2.6109412e-16  0              2.9899308    
    500000   164.4          200            200            0.00071401676  2.6690641e-36  0              0.0021420503   2.9123842      0              14062861       2.6109412e-16  0              2.998268     
    600000   164.4          200            200            0.0022602658  -5.5029374e-37  0              0.0067807973   1.0442022      0              5042078.8      2.6109412e-16  0              2.996184     
    700000   164.4          200            200            0.0028986198  -1.9997613e-36  0              0.0086958594   0.27323232     0              1319341.1      2.6109412e-16  0              2.9955038    
    800000   164.4          200            200            0.0030989622   3.0243425e-36  0              0.0092968865   0.048692322    0              235117.8       2.6109412e-16  0              2.9953025    
    900000   164.4          200            200            0.0031621209   4.4448582e-37  0              0.0094863628   0.007894685    0              38120.608      2.6109412e-16  0              2.9952403    
   1000000   164.4          200            200            0.003181308    2.9625914e-37  0              0.0095439241   0.0012102085   0              5843.6638      2.6109412e-16  0              2.9952217    
   1100000   164.4          200            200            0.0031867609  -1.2206876e-38  0              0.0095602827   0.00017721473  0              855.70653      2.6109412e-16  0              2.9952164    
   1200000   164.4          200            200            0.0031881395  -2.0453359e-39  0              0.0095644186   2.4895602e-05  0              120.21195      2.6109412e-16  0              2.9952152    
   1300000   164.4          200            200            0.0031884064  -8.6740297e-40  0              0.0095652192   3.3611617e-06  0              16.229847      2.6109412e-16  0              2.9952149    
   1400000   164.4          200            200            0.0031884143  -2.9016328e-39  0              0.009565243    4.3609979e-07  0              2.1057698      2.6109412e-16  0              2.9952149    
   1500000   164.4          200            200            0.003188384    4.6275914e-39  0              0.009565152    5.4283582e-08  0              0.26211599     2.6109412e-16  0              2.995215     
   1600000   164.4          200            200            0.0031883608  -1.896825e-38   0              0.0095650825   6.4587939e-09  0              0.031187204    2.6109412e-16  0              2.995215     
   1700000   164.4          200            200            0.0031883481   1.2722058e-38  0              0.0095650442   7.2997519e-10  0              0.0035247889   2.6109412e-16  0              2.995215     
   1800000   164.4          200            200            0.0031883419   1.1155812e-38  0              0.0095650257   7.7563594e-11  0              0.00037452684  2.6109412e-16  0              2.995215     
   1900000   164.4          200            200            0.0031883391   1.0349159e-38  0              0.0095650174   7.6163741e-12  0              3.6776745e-05  2.6109412e-16  0              2.995215     
   2000000   164.4          200            200            0.0031883379   1.4027388e-38  0              0.0095650138   6.7023938e-13  0              3.2363461e-06  2.6109412e-16  0              2.995215     
   2100000   164.4          200            200            0.0031883375  -2.0925538e-40  0              0.0095650124   4.9679777e-14  0              2.3988586e-07  2.6109412e-16  0              2.995215     
   2200000   164.4          200            200            0.0031883373   1.8299676e-38  0              0.0095650118   2.6575388e-15  0              1.2832304e-08  2.6109412e-16  0              2.995215     
   2300000   164.4          200            200            0.0031883372  -2.5969454e-38  0              0.0095650116   5.665285e-17   0              2.7355634e-10  2.6109412e-16  0              2.995215     
   2400000   164.4          200            200            0.0031883372  -1.4860818e-38  0              0.0095650115   2.5058366e-18  0              1.2099788e-11  2.6109412e-16  0              2.995215     
   2500000   164.4          200            200            0.0031883372  -2.1399592e-38  0              0.0095650115   4.8699155e-18  0              2.3515079e-11  2.6109412e-16  0              2.995215     
   2600000   164.4          200            200            0.0031883371   3.2291987e-39  0              0.0095650114   2.1664956e-18  0              1.0461232e-11  2.6109412e-16  0              2.995215     
   2700000   164.4          200            200            0.0031883371  -2.148605e-38   0              0.0095650114   5.3838324e-19  0              2.59966e-12    2.6109412e-16  0              2.995215     
   2800000   164.4          200            200            0.0031883371   3.200615e-38   0              0.0095650114   1.4690735e-19  0              7.0936302e-13  2.6109412e-16  0              2.995215     
   2900000   164.4          200            200            0.0031883371   4.5719787e-38  0              0.0095650114   1.2334654e-20  0              5.9559628e-14  2.6109412e-16  0              2.995215     
   3000000   164.4          200            200            0.0031883371  -1.3976472e-38  0              0.0095650114   1.1156413e-19  0              5.3870326e-13  2.6109412e-16  0              2.995215     
Loop time of 63.8726 on 4 procs for 3000000 steps with 51 atoms

Performance: 40580791.203 ns/day, 0.000 hours/ns, 46968.508 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 0.3328     | 1.5083     | 4.9235     | 160.6 |  2.36
Neigh   | 0.083385   | 0.083943   | 0.085473   |   0.3 |  0.13
Comm    | 25.772     | 32.102     | 37.824     |  82.4 | 50.26
Output  | 0.062353   | 0.062431   | 0.062488   |   0.0 |  0.10
Modify  | 15.215     | 20.955     | 28.011     | 119.5 | 32.81
Other   |            | 9.162      |            |       | 14.34

Nlocal:          12.75 ave          51 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1
Nghost:          39.25 ave          52 max           1 min
Histogram: 1 0 0 0 0 0 0 0 0 3
Neighs:           6.25 ave          25 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1

Total # of neighbors = 25
Ave neighs/atom = 0.49019608
Neighbor list builds = 164
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 98

#variable lat0 equal 1                    #
variable lat1 equal 3+(151*0.01)+(v_ind*0.01)  # .491+(v_ind*0.001)       # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 10*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 5.49                                                               
Lattice spacing in x,y,z = 5.49 5.49 5.49

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -82.35 ${n1e1} -100 100 -100 100 units box
region box block -82.35 82.35 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -82.35 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -82.35 82.35 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-82.35 -100 -100) to (82.35 100 100)
  1 by 2 by 2 MPI processor grid
create_atoms 1 region substrate
Created 29 atoms
  using lattice units in orthogonal box = (-82.35 -100 -100) to (82.35 100 100)
  create_atoms CPU = 0.000 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 30 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 21 atoms
  using lattice units in orthogonal box = (-82.35 -100 -100) to (82.35 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  29 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  29 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  21 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  21 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
29 atoms in group substrate
group slider1 region slider1
21 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 21 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_98_*.dump id type diameter mass xu yu zu fx fy fz

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 107 130 130
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 14.81 | 18.27 | 19.43 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   164.7          200            200            0              0              0              0              0              0              0              2.6109412e-16  0              6            
    100000   164.7          200            200            0.0025574993  -8.9570401e-38  0              0.0076724979   12049.414      0              6.4647009e+10  2.6109412e-16  0              3.3332376    
    200000   164.7          200            200            0.00080184973  3.3882913e-36  0              0.0024055492   2417.4986      0              1.2970261e+10  2.6109412e-16  0              3.0988935    
    300000   164.7          200            200           -0.00011554523 -4.2402144e-36  0             -0.00034663569  135.24917      0              7.2563313e+08  2.6109412e-16  0              3.0367154    
    400000   164.7          200            200            0.010817721   -2.8642097e-35  0              0.032453162    53.321318      0              2.8607729e+08  2.6109412e-16  0              2.9891184    
    500000   164.7          200            200            0.00063589943  2.2491655e-35  0              0.0019076983   0.95541408     0              5125947.4      2.6109412e-16  0              2.9983842    
    600000   164.7          200            200            0.0023440498  -2.2289365e-35  0              0.0070321493   1.6291759      0              8740785.7      2.6109412e-16  0              2.9960829    
    700000   164.7          200            200            0.0029402046   1.4436698e-36  0              0.0088206138   0.35906256     0              1926427.3      2.6109412e-16  0              2.9954546    
    800000   164.7          200            200            0.0031131812   3.1413682e-36  0              0.0093395437   0.059266681    0              317975.1       2.6109412e-16  0              2.9952822    
    900000   164.7          200            200            0.0031643101  -1.0199116e-37  0              0.0094929303   0.0090659398   0              48640.198      2.6109412e-16  0              2.9952323    
   1000000   164.7          200            200            0.0031785987   3.2976516e-37  0              0.0095357962   0.0013213444   0              7089.2216      2.6109412e-16  0              2.9952186    
   1100000   164.7          200            200            0.0031821264   1.3069877e-39  0              0.0095463792   0.00018469987  0              990.94394      2.6109412e-16  0              2.9952153    
   1200000   164.7          200            200            0.0031827671  -8.4293361e-40  0              0.0095483013   2.4810538e-05  0              133.11245      2.6109412e-16  0              2.9952147    
   1300000   164.7          200            200            0.0031827571   6.5354052e-39  0              0.0095482712   3.2023459e-06  0              17.181092      2.6109412e-16  0              2.9952148    
   1400000   164.7          200            200            0.0031826632   1.4537039e-38  0              0.0095479895   3.9639869e-07  0              2.1267416      2.6109412e-16  0              2.9952149    
   1500000   164.7          200            200            0.0031825961   9.3247866e-39  0              0.0095477884   4.687252e-08   0              0.25147847     2.6109412e-16  0              2.9952149    
   1600000   164.7          200            200            0.00318256     2.0793591e-38  0              0.00954768     5.2591732e-09  0              0.028216295    2.6109412e-16  0              2.995215     
   1700000   164.7          200            200            0.0031825427   7.2131432e-39  0              0.0095476282   5.5380981e-10  0              0.0029712771   2.6109412e-16  0              2.995215     
   1800000   164.7          200            200            0.0031825351   1.6746213e-38  0              0.0095476052   5.3730582e-11  0              0.00028827306  2.6109412e-16  0              2.995215     
   1900000   164.7          200            200            0.0031825318  -2.5078635e-38  0              0.0095475954   4.6458649e-12  0              2.4925799e-05  2.6109412e-16  0              2.995215     
   2000000   164.7          200            200            0.0031825305   7.0701922e-39  0              0.0095475914   3.3436912e-13  0              1.7939431e-06  2.6109412e-16  0              2.995215     
   2100000   164.7          200            200            0.0031825299   2.1644555e-38  0              0.0095475898   1.6798322e-14  0              9.0125653e-08  2.6109412e-16  0              2.995215     
   2200000   164.7          200            200            0.0031825297   2.9941208e-38  0              0.0095475892   2.6291358e-16  0              1.4105729e-09  2.6109412e-16  0              2.995215     
   2300000   164.7          200            200            0.0031825297   1.7089088e-38  0              0.009547589    3.2931256e-17  0              1.7668139e-10  2.6109412e-16  0              2.995215     
   2400000   164.7          200            200            0.0031825296  -6.7332911e-38  0              0.0095475889   4.0976329e-17  0              2.1984447e-10  2.6109412e-16  0              2.995215     
   2500000   164.7          200            200            0.0031825296   2.1876334e-38  0              0.0095475889   1.5232298e-17  0              8.1723681e-11  2.6109412e-16  0              2.995215     
   2600000   164.7          200            200            0.0031825296   1.1666045e-38  0              0.0095475888   4.1856679e-18  0              2.2456769e-11  2.6109412e-16  0              2.995215     
   2700000   164.7          200            200            0.0031825296  -2.2161674e-38  0              0.0095475888   8.3775063e-19  0              4.4946644e-12  2.6109412e-16  0              2.995215     
   2800000   164.7          200            200            0.0031825296  -1.0070482e-38  0              0.0095475888   2.1796384e-19  0              1.1694104e-12  2.6109412e-16  0              2.995215     
   2900000   164.7          200            200            0.0031825296  -1.4691898e-38  0              0.0095475888   6.6499794e-20  0              3.567819e-13   2.6109412e-16  0              2.995215     
   3000000   164.7          200            200            0.0031825296   4.2702196e-38  0              0.0095475888   5.9076144e-21  0              3.1695284e-14  2.6109412e-16  0              2.995215     
Loop time of 62.8505 on 4 procs for 3000000 steps with 50 atoms

Performance: 41240753.553 ns/day, 0.000 hours/ns, 47732.354 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 0.31399    | 1.5409     | 5.0538     | 163.5 |  2.45
Neigh   | 0.083349   | 0.083892   | 0.085386   |   0.3 |  0.13
Comm    | 25.084     | 31.321     | 36.944     |  81.6 | 49.83
Output  | 0.060505   | 0.06058    | 0.060633   |   0.0 |  0.10
Modify  | 15.063     | 20.735     | 27.676     | 117.3 | 32.99
Other   |            | 9.109      |            |       | 14.49

Nlocal:           12.5 ave          50 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1
Nghost:           37.5 ave          50 max           0 min
Histogram: 1 0 0 0 0 0 0 0 0 3
Neighs:           6.25 ave          25 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1

Total # of neighbors = 25
Ave neighs/atom = 0.5
Neighbor list builds = 164
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 99

#variable lat0 equal 1                    #
variable lat1 equal 3+(151*0.01)+(v_ind*0.01)  # .491+(v_ind*0.001)       # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 10*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 5.5                                                               
Lattice spacing in x,y,z = 5.5 5.5 5.5

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -82.5 ${n1e1} -100 100 -100 100 units box
region box block -82.5 82.5 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -82.5 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -82.5 82.5 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-82.5 -100 -100) to (82.5 100 100)
  1 by 2 by 2 MPI processor grid
create_atoms 1 region substrate
Created 30 atoms
  using lattice units in orthogonal box = (-82.5 -100 -100) to (82.5 100 100)
  create_atoms CPU = 0.000 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 30 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 21 atoms
  using lattice units in orthogonal box = (-82.5 -100 -100) to (82.5 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  30 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  30 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  21 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  21 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
30 atoms in group substrate
group slider1 region slider1
21 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 21 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_99_*.dump id type diameter mass xu yu zu fx fy fz

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 107 130 130
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 14.81 | 18.27 | 19.43 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   165            200            200            0              0              0              0              0              0              0              2.6109412e-16  0              6            
    100000   165            200            200            0.0025480911  -4.1745527e-37  0              0.0076442734   12014.743      0              5.8014896e+10  2.6109412e-16  0              3.3349048    
    200000   165            200            200            0.00078507714  3.4353132e-38  0              0.0023552314   2343.6804      0              1.1316794e+10  2.6109412e-16  0              3.1028566    
    300000   165            200            200           -0.00012141723  7.0546972e-38  0             -0.00036425169  152.16929      0              7.3477104e+08  2.6109412e-16  0              3.0359134    
    400000   165            200            200            0.011362301   -4.5255562e-36  0              0.034086904    34.123956      0              1.6477237e+08  2.6109412e-16  0              2.9887533    
    500000   165            200            200            0.00060726144 -1.5940122e-35  0              0.0018217843   0.28256333     0              1364397.2      2.6109412e-16  0              2.9984234    
    600000   165            200            200            0.0024024925  -3.3813507e-35  0              0.0072074776   2.0060182      0              9686344        2.6109412e-16  0              2.9960119    
    700000   165            200            200            0.0029660816   1.1919017e-36  0              0.0088982449   0.40764323     0              1968363.2      2.6109412e-16  0              2.995422     
    800000   165            200            200            0.0031203481   2.1442861e-36  0              0.0093610442   0.064682311    0              312327.73      2.6109412e-16  0              2.9952691    
    900000   165            200            200            0.0031635727   5.0596054e-38  0              0.0094907181   0.00958919     0              46302.767      2.6109412e-16  0              2.9952272    
   1000000   165            200            200            0.0031747283  -1.2382585e-37  0              0.0095241848   0.001358654    0              6560.4538      2.6109412e-16  0              2.9952166    
   1100000   165            200            200            0.0031770516  -2.1103062e-38  0              0.0095311547   0.00018485267  0              892.58741      2.6109412e-16  0              2.9952146    
   1200000   165            200            200            0.0031772397   8.0464179e-40  0              0.009531719    2.4169868e-05  0              116.70764      2.6109412e-16  0              2.9952145    
   1300000   165            200            200            0.003177063    5.0235154e-40  0              0.0095311891   3.0332123e-06  0              14.646297      2.6109412e-16  0              2.9952147    
   1400000   165            200            200            0.003176909    1.6962165e-39  0              0.009530727    3.6417715e-07  0              1.7584811      2.6109412e-16  0              2.9952148    
   1500000   165            200            200            0.0031768207   1.6248906e-38  0              0.0095304621   4.1594092e-08  0              0.20084298     2.6109412e-16  0              2.9952149    
   1600000   165            200            200            0.0031767772   2.040803e-38   0              0.0095303317   4.4770206e-09  0              0.02161793     2.6109412e-16  0              2.995215     
   1700000   165            200            200            0.0031767575  -4.2281495e-39  0              0.0095302725   4.4712617e-10  0              0.0021590122   2.6109412e-16  0              2.995215     
   1800000   165            200            200            0.003176749    5.4178477e-39  0              0.009530247    4.0319429e-11  0              0.00019468809  2.6109412e-16  0              2.995215     
   1900000   165            200            200            0.0031767455  -1.1919081e-38  0              0.0095302365   3.1128792e-12  0              1.503098e-05   2.6109412e-16  0              2.995215     
   2000000   165            200            200            0.0031767441   3.151823e-38   0              0.0095302322   1.8147499e-13  0              8.762778e-07   2.6109412e-16  0              2.995215     
   2100000   165            200            200            0.0031767435  -4.2065386e-39  0              0.0095302306   5.1285645e-15  0              2.4764002e-08  2.6109412e-16  0              2.995215     
   2200000   165            200            200            0.0031767433   4.2375295e-39  0              0.00953023     2.9341817e-17  0              1.4168113e-10  2.6109412e-16  0              2.995215     
   2300000   165            200            200            0.0031767432   1.2126582e-38  0              0.0095302297   1.8605518e-16  0              8.9839386e-10  2.6109412e-16  0              2.995215     
   2400000   165            200            200            0.0031767432   4.7569823e-38  0              0.0095302296   8.4884425e-17  0              4.0987651e-10  2.6109412e-16  0              2.995215     
   2500000   165            200            200            0.0031767432  -1.6322529e-38  0              0.0095302296   2.4086519e-17  0              1.1630518e-10  2.6109412e-16  0              2.995215     
   2600000   165            200            200            0.0031767432   5.5874811e-38  0              0.0095302296   5.7279011e-18  0              2.7657984e-11  2.6109412e-16  0              2.995215     
   2700000   165            200            200            0.0031767432   4.4751425e-38  0              0.0095302296   1.1072115e-18  0              5.346328e-12   2.6109412e-16  0              2.995215     
   2800000   165            200            200            0.0031767432   4.2129208e-38  0              0.0095302296   2.5134131e-19  0              1.2136372e-12  2.6109412e-16  0              2.995215     
   2900000   165            200            200            0.0031767432   4.3234566e-40  0              0.0095302296   2.8897368e-22  0              1.3953505e-15  2.6109412e-16  0              2.995215     
   3000000   165            200            200            0.0031767432   9.4525624e-39  0              0.0095302296   1.2444495e-19  0              6.0090014e-13  2.6109412e-16  0              2.995215     
Loop time of 64.0377 on 4 procs for 3000000 steps with 51 atoms

Performance: 40476156.831 ns/day, 0.000 hours/ns, 46847.404 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 0.33483    | 1.5737     | 5.1742     | 165.7 |  2.46
Neigh   | 0.084404   | 0.084983   | 0.086503   |   0.3 |  0.13
Comm    | 25.736     | 32.131     | 37.875     |  82.6 | 50.17
Output  | 0.059048   | 0.059123   | 0.059174   |   0.0 |  0.09
Modify  | 15.272     | 21.021     | 28.117     | 119.2 | 32.83
Other   |            | 9.168      |            |       | 14.32

Nlocal:          12.75 ave          51 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1
Nghost:          39.25 ave          52 max           1 min
Histogram: 1 0 0 0 0 0 0 0 0 3
Neighs:           6.25 ave          25 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1

Total # of neighbors = 25
Ave neighs/atom = 0.49019608
Neighbor list builds = 166
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop
Total wall time: 1:46:49
